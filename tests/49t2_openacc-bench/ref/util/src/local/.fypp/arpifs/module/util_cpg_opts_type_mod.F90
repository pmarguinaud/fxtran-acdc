MODULE UTIL_CPG_OPTS_TYPE_MOD

USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_CPG_OPTS_TYPE
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_CPG_OPTS_TYPE
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_CPG_OPTS_TYPE
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_CPG_OPTS_TYPE
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_CPG_OPTS_TYPE
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_CPG_OPTS_TYPE
END INTERFACE


CONTAINS

SUBROUTINE ACDC_SAVE_CPG_OPTS_TYPE (SELF, KLUN)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LXPNUDG
WRITE (KLUN) SELF%KLON
WRITE (KLUN) SELF%KFLEVG
WRITE (KLUN) SELF%KGPTOT
WRITE (KLUN) SELF%KGPBLKS
WRITE (KLUN) SELF%KGPCOMP
WRITE (KLUN) SELF%KGPTOTB
WRITE (KLUN) SELF%JBLKMIN
WRITE (KLUN) SELF%JBLKMAX
WRITE (KLUN) SELF%KGL1
WRITE (KLUN) SELF%KGL2
WRITE (KLUN) SELF%NSTEP
WRITE (KLUN) SELF%KTDIA
WRITE (KLUN) SELF%KVCLIS
WRITE (KLUN) SELF%NDTPREC
WRITE (KLUN) SELF%NDTPREC2
WRITE (KLUN) SELF%NDTPRECCUR
WRITE (KLUN) SELF%NDTPRECCUR2
WRITE (KLUN) SELF%KTSSG
WRITE (KLUN) SELF%KGRADIENTS
WRITE (KLUN) SELF%KMAXDRAFT
WRITE (KLUN) SELF%KSW
WRITE (KLUN) SELF%NPROC
WRITE (KLUN) SELF%NCONF
WRITE (KLUN) SELF%N2DINI
CALL ACDC_SAVE_CPG_OPTS_SURF_TYPE (SELF%YRSURF_OPTS, KLUN)
CALL ACDC_SAVE_CPG_DIMS_SURF_TYPE (SELF%YRSURF_DIMS, KLUN)
CALL ACDC_SAVE_CPG_DIMS_VARS_TYPE (SELF%YRVARS_DIMS, KLUN)
WRITE (KLUN) SELF%LCONFX
WRITE (KLUN) SELF%L_DFISTEP
WRITE (KLUN) SELF%LFSTEP
WRITE (KLUN) SELF%LDIAB
WRITE (KLUN) SELF%LSLPHY
WRITE (KLUN) SELF%LUSEPB1
WRITE (KLUN) SELF%ZDT
WRITE (KLUN) SELF%ZDTPHY
WRITE (KLUN) SELF%ZTE
WRITE (KLUN) SELF%ZBETADT
CALL ACDC_SAVE_TCLI (SELF%YRCLI, KLUN)
WRITE (KLUN) SELF%NSSSSS
WRITE (KLUN) SELF%NFNUDG
WRITE (KLUN) SELF%NINDAT
WRITE (KLUN) SELF%LAROME
WRITE (KLUN) SELF%LCALLSFX
WRITE (KLUN) SELF%LCORWAT
WRITE (KLUN) SELF%LECMWF
WRITE (KLUN) SELF%LINITER
WRITE (KLUN) SELF%LELAM
WRITE (KLUN) SELF%LFLASH
WRITE (KLUN) SELF%LWSNOW
WRITE (KLUN) SELF%LNUDG
WRITE (KLUN) SELF%LRPLANE
WRITE (KLUN) SELF%LSFORC
WRITE (KLUN) SELF%LSFORCS
WRITE (KLUN) SELF%LSOMEGA_FRC
WRITE (KLUN) SELF%LSPS_FRC
WRITE (KLUN) SELF%LSW_FRC
WRITE (KLUN) SELF%LXCLP
WRITE (KLUN) SELF%LXCLPMF
WRITE (KLUN) SELF%LXVMAXTH
WRITE (KLUN) SELF%LXTGST
WRITE (KLUN) SELF%LXXGST
WRITE (KLUN) SELF%RPLDARE
WRITE (KLUN) SELF%RPLRG
WRITE (KLUN) SELF%TOPPRES
WRITE (KLUN) SELF%RPSTRA
WRITE (KLUN) SELF%RPTROP
WRITE (KLUN) SELF%RTSUR
LXPNUDG = ALLOCATED (SELF%XPNUDG)
WRITE (KLUN) LXPNUDG
IF (LXPNUDG) THEN
  WRITE (KLUN) LBOUND (SELF%XPNUDG)
  WRITE (KLUN) UBOUND (SELF%XPNUDG)
  WRITE (KLUN) SELF%XPNUDG
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_CPG_OPTS_TYPE (SELF, KLUN)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LXPNUDG
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) SELF%KLON
READ (KLUN) SELF%KFLEVG
READ (KLUN) SELF%KGPTOT
READ (KLUN) SELF%KGPBLKS
READ (KLUN) SELF%KGPCOMP
READ (KLUN) SELF%KGPTOTB
READ (KLUN) SELF%JBLKMIN
READ (KLUN) SELF%JBLKMAX
READ (KLUN) SELF%KGL1
READ (KLUN) SELF%KGL2
READ (KLUN) SELF%NSTEP
READ (KLUN) SELF%KTDIA
READ (KLUN) SELF%KVCLIS
READ (KLUN) SELF%NDTPREC
READ (KLUN) SELF%NDTPREC2
READ (KLUN) SELF%NDTPRECCUR
READ (KLUN) SELF%NDTPRECCUR2
READ (KLUN) SELF%KTSSG
READ (KLUN) SELF%KGRADIENTS
READ (KLUN) SELF%KMAXDRAFT
READ (KLUN) SELF%KSW
READ (KLUN) SELF%NPROC
READ (KLUN) SELF%NCONF
READ (KLUN) SELF%N2DINI
CALL ACDC_LOAD_CPG_OPTS_SURF_TYPE (SELF%YRSURF_OPTS, KLUN)
CALL ACDC_LOAD_CPG_DIMS_SURF_TYPE (SELF%YRSURF_DIMS, KLUN)
CALL ACDC_LOAD_CPG_DIMS_VARS_TYPE (SELF%YRVARS_DIMS, KLUN)
READ (KLUN) SELF%LCONFX
READ (KLUN) SELF%L_DFISTEP
READ (KLUN) SELF%LFSTEP
READ (KLUN) SELF%LDIAB
READ (KLUN) SELF%LSLPHY
READ (KLUN) SELF%LUSEPB1
READ (KLUN) ZTMP0
SELF%ZDT = ZTMP0
READ (KLUN) ZTMP0
SELF%ZDTPHY = ZTMP0
READ (KLUN) ZTMP0
SELF%ZTE = ZTMP0
READ (KLUN) ZTMP0
SELF%ZBETADT = ZTMP0
CALL ACDC_LOAD_TCLI (SELF%YRCLI, KLUN)
READ (KLUN) SELF%NSSSSS
READ (KLUN) SELF%NFNUDG
READ (KLUN) SELF%NINDAT
READ (KLUN) SELF%LAROME
READ (KLUN) SELF%LCALLSFX
READ (KLUN) SELF%LCORWAT
READ (KLUN) SELF%LECMWF
READ (KLUN) SELF%LINITER
READ (KLUN) SELF%LELAM
READ (KLUN) SELF%LFLASH
READ (KLUN) SELF%LWSNOW
READ (KLUN) SELF%LNUDG
READ (KLUN) SELF%LRPLANE
READ (KLUN) SELF%LSFORC
READ (KLUN) SELF%LSFORCS
READ (KLUN) SELF%LSOMEGA_FRC
READ (KLUN) SELF%LSPS_FRC
READ (KLUN) SELF%LSW_FRC
READ (KLUN) SELF%LXCLP
READ (KLUN) SELF%LXCLPMF
READ (KLUN) SELF%LXVMAXTH
READ (KLUN) SELF%LXTGST
READ (KLUN) SELF%LXXGST
READ (KLUN) ZTMP0
SELF%RPLDARE = ZTMP0
READ (KLUN) ZTMP0
SELF%RPLRG = ZTMP0
READ (KLUN) ZTMP0
SELF%TOPPRES = ZTMP0
READ (KLUN) ZTMP0
SELF%RPSTRA = ZTMP0
READ (KLUN) ZTMP0
SELF%RPTROP = ZTMP0
READ (KLUN) ZTMP0
SELF%RTSUR = ZTMP0
READ (KLUN) LXPNUDG
IF (LXPNUDG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%XPNUDG (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%XPNUDG,1):UBOUND(SELF%XPNUDG,1)))
  READ (KLUN) ZTMP1
  SELF%XPNUDG = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_CPG_OPTS_TYPE (SELF, LDCREATED, LDFIELDAPI)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LXPNUDG
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

CALL ACDC_COPY_CPG_OPTS_SURF_TYPE (SELF%YRSURF_OPTS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_CPG_DIMS_SURF_TYPE (SELF%YRSURF_DIMS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_CPG_DIMS_VARS_TYPE (SELF%YRVARS_DIMS, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TCLI (SELF%YRCLI, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LXPNUDG = ALLOCATED (SELF%XPNUDG)
IF (LXPNUDG) THEN
  !$ACC ENTER DATA CREATE (SELF%XPNUDG)
  !$ACC UPDATE DEVICE (SELF%XPNUDG)
  !$ACC ENTER DATA ATTACH (SELF%XPNUDG)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_CPG_OPTS_TYPE (SELF)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), TARGET :: SELF
LOGICAL :: LXPNUDG

CALL ACDC_HOST_CPG_OPTS_SURF_TYPE (SELF%YRSURF_OPTS)

CALL ACDC_HOST_CPG_DIMS_SURF_TYPE (SELF%YRSURF_DIMS)

CALL ACDC_HOST_CPG_DIMS_VARS_TYPE (SELF%YRVARS_DIMS)

CALL ACDC_HOST_TCLI (SELF%YRCLI)

END SUBROUTINE



SUBROUTINE ACDC_CRC64_CPG_OPTS_TYPE (SELF, KLUN, CDPATH)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LXPNUDG
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KLON), CDPATH//'%KLON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KFLEVG), CDPATH//'%KFLEVG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KGPTOT), CDPATH//'%KGPTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KGPBLKS), CDPATH//'%KGPBLKS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KGPCOMP), CDPATH//'%KGPCOMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KGPTOTB), CDPATH//'%KGPTOTB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%JBLKMIN), CDPATH//'%JBLKMIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%JBLKMAX), CDPATH//'%JBLKMAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KGL1), CDPATH//'%KGL1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KGL2), CDPATH//'%KGL2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSTEP), CDPATH//'%NSTEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KTDIA), CDPATH//'%KTDIA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KVCLIS), CDPATH//'%KVCLIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDTPREC), CDPATH//'%NDTPREC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDTPREC2), CDPATH//'%NDTPREC2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDTPRECCUR), CDPATH//'%NDTPRECCUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDTPRECCUR2), CDPATH//'%NDTPRECCUR2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KTSSG), CDPATH//'%KTSSG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KGRADIENTS), CDPATH//'%KGRADIENTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KMAXDRAFT), CDPATH//'%KMAXDRAFT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KSW), CDPATH//'%KSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NPROC), CDPATH//'%NPROC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCONF), CDPATH//'%NCONF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%N2DINI), CDPATH//'%N2DINI'

CLIND = ''
CALL ACDC_CRC64_CPG_OPTS_SURF_TYPE (SELF%YRSURF_OPTS, KLUN, CDPATH//'%YRSURF_OPTS'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_CPG_DIMS_SURF_TYPE (SELF%YRSURF_DIMS, KLUN, CDPATH//'%YRSURF_DIMS'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_CPG_DIMS_VARS_TYPE (SELF%YRVARS_DIMS, KLUN, CDPATH//'%YRVARS_DIMS'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCONFX), CDPATH//'%LCONFX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%L_DFISTEP), CDPATH//'%L_DFISTEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LFSTEP), CDPATH//'%LFSTEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LDIAB), CDPATH//'%LDIAB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSLPHY), CDPATH//'%LSLPHY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LUSEPB1), CDPATH//'%LUSEPB1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZDT), CDPATH//'%ZDT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZDTPHY), CDPATH//'%ZDTPHY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZTE), CDPATH//'%ZTE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ZBETADT), CDPATH//'%ZBETADT'

CLIND = ''
CALL ACDC_CRC64_TCLI (SELF%YRCLI, KLUN, CDPATH//'%YRCLI'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSSSSS), CDPATH//'%NSSSSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NFNUDG), CDPATH//'%NFNUDG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NINDAT), CDPATH//'%NINDAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAROME), CDPATH//'%LAROME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCALLSFX), CDPATH//'%LCALLSFX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCORWAT), CDPATH//'%LCORWAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LECMWF), CDPATH//'%LECMWF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LINITER), CDPATH//'%LINITER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LELAM), CDPATH//'%LELAM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LFLASH), CDPATH//'%LFLASH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWSNOW), CDPATH//'%LWSNOW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LNUDG), CDPATH//'%LNUDG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRPLANE), CDPATH//'%LRPLANE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSFORC), CDPATH//'%LSFORC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSFORCS), CDPATH//'%LSFORCS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSOMEGA_FRC), CDPATH//'%LSOMEGA_FRC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSPS_FRC), CDPATH//'%LSPS_FRC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSW_FRC), CDPATH//'%LSW_FRC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LXCLP), CDPATH//'%LXCLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LXCLPMF), CDPATH//'%LXCLPMF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LXVMAXTH), CDPATH//'%LXVMAXTH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LXTGST), CDPATH//'%LXTGST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LXXGST), CDPATH//'%LXXGST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPLDARE), CDPATH//'%RPLDARE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPLRG), CDPATH//'%RPLRG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%TOPPRES), CDPATH//'%TOPPRES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPSTRA), CDPATH//'%RPSTRA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPTROP), CDPATH//'%RPTROP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTSUR), CDPATH//'%RTSUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%XPNUDG), CDPATH//'%XPNUDG'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_CPG_OPTS_TYPE (SELF, LDDELETED, LDFIELDAPI)
USE UTIL_CPG_DIMS_SURF_TYPE_MOD
USE UTIL_CPG_DIMS_VARS_TYPE_MOD
USE UTIL_CPG_OPTS_SURF_TYPE_MOD
USE UTIL_TCLI_MOD
IMPLICIT NONE
TYPE (CPG_OPTS_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LXPNUDG
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

CALL ACDC_WIPE_CPG_OPTS_SURF_TYPE (SELF%YRSURF_OPTS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_CPG_DIMS_SURF_TYPE (SELF%YRSURF_DIMS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_CPG_DIMS_VARS_TYPE (SELF%YRVARS_DIMS, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TCLI (SELF%YRCLI, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LXPNUDG = ALLOCATED (SELF%XPNUDG)
IF (LXPNUDG) THEN
  !$ACC EXIT DATA DETACH (SELF%XPNUDG)
  !$ACC EXIT DATA DELETE (SELF%XPNUDG)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE



END MODULE
