SUBROUTINE APL_ARPEGE_SURFACE_PARALLEL (YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS&
&, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YD_PALBD, YD_PALBP, YD_PALPHA1&
&, YD_PCDROV, YD_PCEROV, YD_PCFATH, YD_PCFAU, YD_PCFBTH, YD_PCFBU, YD_PCFBV, YD_PCHROV, YD_PCOEFA&
&, YD_PCOEFN, YD_PCP, YD_PDIFEXT, YD_PDIFWQ, YD_PDIFWS, YD_PDQSTS, YD_PDSA_CPS, YD_PDSA_LHS, PDTMSE&
&, YD_PEDMFQ, YD_PEDMFS, YD_PEDMFU, YD_PEDMFV, YD_PFLU_CD, YD_PFLU_CDN, YD_PFLU_EMIS, YD_PFLU_FEVI&
&, YD_PFLU_NEIJ, YD_PFLU_QSATS, YD_PFLU_VEG, YD_PHQ, YD_PHTR, YD_PHU, YD_PKQLROV, YD_PKQROV, YD_PKTROV&
&, YD_PKUROV, YD_PLVT, YD_PMF_UP, YD_PNEBCH, YD_PNEBDIFF, YD_PNEBS, YD_PPOID, YD_PQI, YD_PQICE,&
& YD_PQL, YD_PQV, YD_PRDG_MU0, YD_PRDG_MU0N, PRHGMT, YD_PSC_FCLL, YD_PSC_FCLN, YD_PSC_FEVI, YD_PSC_FEVN&
&, YD_PSFSWDIF, YD_PSFSWDIR, YD_PSGROUPEL, YD_PSRAIN, YD_PSSNOW, PSTATI, YD_PTSN, YD_PXDROV, YD_PXHROV&
&, YD_PXQRO, YD_PXTRO, YD_PXTROV, YD_PXURO, YD_PXUROV)
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK

USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE, CPG_GPAR_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE SURFACE_FIELDS_MIX,ONLY:TSURF
USE TYPE_MODEL,ONLY:MODEL
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_GPAR_TYPE), INTENT (INOUT)::YDCPG_GPAR
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL), INTENT (IN)::YDMODEL
CLASS (FIELD_3RB), POINTER :: YD_PALBD
REAL (KIND=JPRB), POINTER::PALBD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALBP
REAL (KIND=JPRB), POINTER::PALBP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALPHA1
REAL (KIND=JPRB), POINTER::PALPHA1 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCDROV
REAL (KIND=JPRB), POINTER::PCDROV (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCEROV
REAL (KIND=JPRB), POINTER::PCEROV (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFATH
REAL (KIND=JPRB), POINTER::PCFATH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFAU
REAL (KIND=JPRB), POINTER::PCFAU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFBTH
REAL (KIND=JPRB), POINTER::PCFBTH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFBU
REAL (KIND=JPRB), POINTER::PCFBU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFBV
REAL (KIND=JPRB), POINTER::PCFBV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCHROV
REAL (KIND=JPRB), POINTER::PCHROV (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCOEFA
REAL (KIND=JPRB), POINTER::PCOEFA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCOEFN
REAL (KIND=JPRB), POINTER::PCOEFN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCP
REAL (KIND=JPRB), POINTER::PCP (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PDIFEXT
REAL (KIND=JPRB), POINTER::PDIFEXT (:,:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDIFWQ
REAL (KIND=JPRB), POINTER::PDIFWQ (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDIFWS
REAL (KIND=JPRB), POINTER::PDIFWS (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDQSTS
REAL (KIND=JPRB), POINTER::PDQSTS (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDSA_CPS
REAL (KIND=JPRB), POINTER::PDSA_CPS (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDSA_LHS
REAL (KIND=JPRB), POINTER::PDSA_LHS (:,:)
REAL (KIND=JPRB), INTENT (IN)::PDTMSE
CLASS (FIELD_3RB), POINTER :: YD_PEDMFQ
REAL (KIND=JPRB), POINTER::PEDMFQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFS
REAL (KIND=JPRB), POINTER::PEDMFS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFU
REAL (KIND=JPRB), POINTER::PEDMFU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFV
REAL (KIND=JPRB), POINTER::PEDMFV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_CD
REAL (KIND=JPRB), POINTER::PFLU_CD (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_CDN
REAL (KIND=JPRB), POINTER::PFLU_CDN (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_EMIS
REAL (KIND=JPRB), POINTER::PFLU_EMIS (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFLU_FEVI
REAL (KIND=JPRB), POINTER::PFLU_FEVI (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_NEIJ
REAL (KIND=JPRB), POINTER::PFLU_NEIJ (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_QSATS
REAL (KIND=JPRB), POINTER::PFLU_QSATS (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_VEG
REAL (KIND=JPRB), POINTER::PFLU_VEG (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PHQ
REAL (KIND=JPRB), POINTER::PHQ (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PHTR
REAL (KIND=JPRB), POINTER::PHTR (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PHU
REAL (KIND=JPRB), POINTER::PHU (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKQLROV
REAL (KIND=JPRB), POINTER::PKQLROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKQROV
REAL (KIND=JPRB), POINTER::PKQROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKTROV
REAL (KIND=JPRB), POINTER::PKTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKUROV
REAL (KIND=JPRB), POINTER::PKUROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLVT
REAL (KIND=JPRB), POINTER::PLVT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMF_UP
REAL (KIND=JPRB), POINTER::PMF_UP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBCH
REAL (KIND=JPRB), POINTER::PNEBCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBDIFF
REAL (KIND=JPRB), POINTER::PNEBDIFF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBS
REAL (KIND=JPRB), POINTER::PNEBS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPOID
REAL (KIND=JPRB), POINTER::PPOID (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQI
REAL (KIND=JPRB), POINTER::PQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQICE
REAL (KIND=JPRB), POINTER::PQICE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQL
REAL (KIND=JPRB), POINTER::PQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQV
REAL (KIND=JPRB), POINTER::PQV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PRDG_MU0
REAL (KIND=JPRB), POINTER::PRDG_MU0 (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PRDG_MU0N
REAL (KIND=JPRB), POINTER::PRDG_MU0N (:,:)
REAL (KIND=JPRB), INTENT (IN)::PRHGMT
CLASS (FIELD_2RB), POINTER :: YD_PSC_FCLL
REAL (KIND=JPRB), POINTER::PSC_FCLL (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSC_FCLN
REAL (KIND=JPRB), POINTER::PSC_FCLN (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSC_FEVI
REAL (KIND=JPRB), POINTER::PSC_FEVI (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSC_FEVN
REAL (KIND=JPRB), POINTER::PSC_FEVN (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIF
REAL (KIND=JPRB), POINTER::PSFSWDIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIR
REAL (KIND=JPRB), POINTER::PSFSWDIR (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSGROUPEL
REAL (KIND=JPRB), POINTER::PSGROUPEL (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSRAIN
REAL (KIND=JPRB), POINTER::PSRAIN (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSSNOW
REAL (KIND=JPRB), POINTER::PSSNOW (:,:)
REAL (KIND=JPRB), INTENT (IN)::PSTATI
CLASS (FIELD_2RB), POINTER :: YD_PTSN
REAL (KIND=JPRB), POINTER::PTSN (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PXDROV
REAL (KIND=JPRB), POINTER::PXDROV (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PXHROV
REAL (KIND=JPRB), POINTER::PXHROV (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXQRO
REAL (KIND=JPRB), POINTER::PXQRO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXTRO
REAL (KIND=JPRB), POINTER::PXTRO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXTROV
REAL (KIND=JPRB), POINTER::PXTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXURO
REAL (KIND=JPRB), POINTER::PXURO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXUROV
REAL (KIND=JPRB), POINTER::PXUROV (:,:,:)
#include "acaa1.intfb.h"
#include "abor1.intfb.h"
#include "acdifv1.intfb.h"
#include "acdifv1_openacc.intfb.h"
#include "acdifv2.intfb.h"
#include "acdifv2_openacc.intfb.h"
#include "aro_ground_diag.h"
#include "aro_ground_diag_2isba.h"
#include "aro_ground_param.h"
#include "arp_ground_param.intfb.h"
#include "arp_ground_param_openacc.intfb.h"
CLASS (FIELD_2RB), POINTER :: YL_ZZS
REAL (KIND=JPRB), POINTER::ZZS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZTWSNOW
REAL (KIND=JPRB), POINTER::ZTWSNOW (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZTOWNS
REAL (KIND=JPRB), POINTER::ZTOWNS (:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZSVM
REAL (KIND=JPRB), POINTER::ZSVM (:,:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSSO_STDEV
REAL (KIND=JPRB), POINTER::ZSSO_STDEV (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSFSV
REAL (KIND=JPRB), POINTER::ZSFSV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSFCO2
REAL (KIND=JPRB), POINTER::ZSFCO2 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRHODREFM
REAL (KIND=JPRB), POINTER::ZRHODREFM (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQT
REAL (KIND=JPRB), POINTER::ZQT (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZHV2
REAL (KIND=JPRB), POINTER::ZHV2 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFMDV
REAL (KIND=JPRB), POINTER::ZFMDV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFMDU
REAL (KIND=JPRB), POINTER::ZFMDU (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFEVS
REAL (KIND=JPRB), POINTER::ZFEVS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFEV
REAL (KIND=JPRB), POINTER::ZFEV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFCLL
REAL (KIND=JPRB), POINTER::ZFCLL (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDSE
REAL (KIND=JPRB), POINTER::ZDSE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDEPTH_HEIGHT
REAL (KIND=JPRB), POINTER::ZDEPTH_HEIGHT (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZCFBSV
REAL (KIND=JPRB), POINTER::ZCFBSV (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBS
REAL (KIND=JPRB), POINTER::ZCFBS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBQ
REAL (KIND=JPRB), POINTER::ZCFBQ (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZCFASV
REAL (KIND=JPRB), POINTER::ZCFASV (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFAS
REAL (KIND=JPRB), POINTER::ZCFAS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFAQ
REAL (KIND=JPRB), POINTER::ZCFAQ (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCD
REAL (KIND=JPRB), POINTER::ZCD (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCH
REAL (KIND=JPRB), POINTER::ZCH (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZBUDTH
REAL (KIND=JPRB), POINTER::ZBUDTH (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZBUDSO
REAL (KIND=JPRB), POINTER::ZBUDSO (:,:)
REAL (KIND=JPRB)::ZCARDI
CLASS (FIELD_3RB), POINTER :: YL_ZDUMMY
REAL (KIND=JPRB), POINTER::ZDUMMY (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBU_G
REAL (KIND=JPRB), POINTER::ZCFBU_G (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBV_G
REAL (KIND=JPRB), POINTER::ZCFBV_G (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBS_G
REAL (KIND=JPRB), POINTER::ZCFBS_G (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBQ_G
REAL (KIND=JPRB), POINTER::ZCFBQ_G (:,:,:)
INTEGER (KIND=JPIM)::IRR
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JSG
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_ALBDIR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_ALBSCA(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_CD(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_GZ0(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_GZ0H(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_VEMIS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_VQS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_VTS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_NEB(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CT(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCHSP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCLL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCLN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVV(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSO(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTH(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTHDS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FTR(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0H(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NUCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NVCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_QCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_RHCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_SIC(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_SNWDE(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VCLS(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PQSH(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PSPSH(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PARG(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PD2(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PHV(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_RR_PFC_T1(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_RR_PIC_T1(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_RR_PW_T1(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_SB_PQ_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_SB_PTL_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_SB_PT_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_SG_PA_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_SG_PF_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_SG_PR_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GELAM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RINDX_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RINDY_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SHTUR_T0(:,:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZZS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTWSNOW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTOWNS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSVM, UBOUNDS=[YDCPG_OPTS%KLON, 1, 1, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSSO_STDEV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSFSV, UBOUNDS=[YDCPG_OPTS%KLON, 1, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSFCO2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRHODREFM, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZHV2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFMDV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFMDU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFEVS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFEV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFCLL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDUMMY, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDSE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDEPTH_HEIGHT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBV_G, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBU_G, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBS_G, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBSV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_GCONF%YGFL&
&%NGFL_EXT, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBQ_G, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFASV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_GCONF%YGFL&
&%NGFL_EXT, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFAS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFAQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZBUDTH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZBUDSO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)


IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
  PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
  PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
  PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
  PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
  PCP => GET_HOST_DATA_RDONLY (YD_PCP)
  PEDMFQ => GET_HOST_DATA_RDONLY (YD_PEDMFQ)
  PEDMFS => GET_HOST_DATA_RDONLY (YD_PEDMFS)
  PEDMFU => GET_HOST_DATA_RDONLY (YD_PEDMFU)
  PEDMFV => GET_HOST_DATA_RDONLY (YD_PEDMFV)
  PKQROV => GET_HOST_DATA_RDONLY (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDONLY (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDONLY (YD_PKUROV)
  PMF_UP => GET_HOST_DATA_RDONLY (YD_PMF_UP)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
  PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
  PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
  PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
  PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
  PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
  PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
  ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
  ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
  ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
  ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
  ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
  ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
  ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
  ZDUMMY => GET_HOST_DATA_RDONLY (YL_ZDUMMY)
  ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
  ZSVM => GET_HOST_DATA_RDONLY (YL_ZSVM)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL ACDIFV1 (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
    &%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, 0, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), PCP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
    &(:,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:,:, JBLK), PKUROV(:,:, JBLK), PQV(:,:, JBLK), PQL(:,:&
    &, JBLK), PQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), ZSVM(:&
    &,:,:, JBLK), PXTROV(:,:, JBLK), PXUROV(:,:, JBLK), PXDROV(:, JBLK), PXHROV(:, JBLK), PEDMFS(:&
    &,:, JBLK), PEDMFQ(:,:, JBLK), PEDMFU(:,:, JBLK), PEDMFV(:,:, JBLK), ZDUMMY(:,:, JBLK), PMF_UP&
    &(:,:, JBLK), PXURO(:,:, JBLK), PXQRO(:,:, JBLK), PXTRO(:,:, JBLK), ZCFAQ(:,:, JBLK), ZCFAS(:,&
    &:, JBLK), PCFATH(:,:, JBLK), PCFAU(:,:, JBLK), ZCFASV(:,:,:, JBLK), ZCFBQ(:,:, JBLK), ZCFBS(:&
    &,:, JBLK), PCFBTH(:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK), ZCFBSV(:,:,:, JBLK), ZDSE(:&
    &,:, JBLK), ZQT(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCP => GET_HOST_DATA_RDWR (YD_PCP)
    PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
    PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
    PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
    PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
    ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
    ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
    ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
    ZDUMMY => GET_HOST_DATA_RDWR (YL_ZDUMMY)
    ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
    ZSVM => GET_HOST_DATA_RDWR (YL_ZSVM)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PCFATH => NULL ()
  PCFAU => NULL ()
  PCFBTH => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCP => NULL ()
  PEDMFQ => NULL ()
  PEDMFS => NULL ()
  PEDMFU => NULL ()
  PEDMFV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PMF_UP => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQV => NULL ()
  PXDROV => NULL ()
  PXHROV => NULL ()
  PXQRO => NULL ()
  PXTRO => NULL ()
  PXTROV => NULL ()
  PXURO => NULL ()
  PXUROV => NULL ()
  ZCFAQ => NULL ()
  ZCFAS => NULL ()
  ZCFASV => NULL ()
  ZCFBQ => NULL ()
  ZCFBS => NULL ()
  ZCFBSV => NULL ()
  ZDSE => NULL ()
  ZDUMMY => NULL ()
  ZQT => NULL ()
  ZSVM => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
  PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
  PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
  PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
  PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
  PCP => GET_HOST_DATA_RDONLY (YD_PCP)
  PEDMFQ => GET_HOST_DATA_RDONLY (YD_PEDMFQ)
  PEDMFS => GET_HOST_DATA_RDONLY (YD_PEDMFS)
  PEDMFU => GET_HOST_DATA_RDONLY (YD_PEDMFU)
  PEDMFV => GET_HOST_DATA_RDONLY (YD_PEDMFV)
  PKQROV => GET_HOST_DATA_RDONLY (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDONLY (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDONLY (YD_PKUROV)
  PMF_UP => GET_HOST_DATA_RDONLY (YD_PMF_UP)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
  PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
  PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
  PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
  PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
  PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
  PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
  ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
  ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
  ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
  ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
  ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
  ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
  ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
  ZDUMMY => GET_HOST_DATA_RDONLY (YL_ZDUMMY)
  ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
  ZSVM => GET_HOST_DATA_RDONLY (YL_ZSVM)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACDIFV1_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, 0, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), PCP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:,:, JBLK), PKUROV(:,:, JBLK), PQV(:,:, JBLK), PQL(:,:, JBLK&
      &), PQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), ZSVM(:,:&
      &,:, JBLK), PXTROV(:,:, JBLK), PXUROV(:,:, JBLK), PXDROV(:, JBLK), PXHROV(:, JBLK), PEDMFS(:,:, JBLK&
      &), PEDMFQ(:,:, JBLK), PEDMFU(:,:, JBLK), PEDMFV(:,:, JBLK), ZDUMMY(:,:, JBLK), PMF_UP(:,:, JBLK&
      &), PXURO(:,:, JBLK), PXQRO(:,:, JBLK), PXTRO(:,:, JBLK), ZCFAQ(:,:, JBLK), ZCFAS(:,:, JBLK), PCFATH&
      &(:,:, JBLK), PCFAU(:,:, JBLK), ZCFASV(:,:,:, JBLK), ZCFBQ(:,:, JBLK), ZCFBS(:,:, JBLK), PCFBTH(&
      &:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK), ZCFBSV(:,:,:, JBLK), ZDSE(:,:, JBLK), ZQT(:,:, JBLK&
      &),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCP => GET_HOST_DATA_RDWR (YD_PCP)
    PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
    PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
    PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
    PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
    ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
    ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
    ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
    ZDUMMY => GET_HOST_DATA_RDWR (YL_ZDUMMY)
    ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
    ZSVM => GET_HOST_DATA_RDWR (YL_ZSVM)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PCFATH => NULL ()
  PCFAU => NULL ()
  PCFBTH => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCP => NULL ()
  PEDMFQ => NULL ()
  PEDMFS => NULL ()
  PEDMFU => NULL ()
  PEDMFV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PMF_UP => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQV => NULL ()
  PXDROV => NULL ()
  PXHROV => NULL ()
  PXQRO => NULL ()
  PXTRO => NULL ()
  PXTROV => NULL ()
  PXURO => NULL ()
  PXUROV => NULL ()
  ZCFAQ => NULL ()
  ZCFAS => NULL ()
  ZCFASV => NULL ()
  ZCFBQ => NULL ()
  ZCFBS => NULL ()
  ZCFBSV => NULL ()
  ZDSE => NULL ()
  ZDUMMY => NULL ()
  ZQT => NULL ()
  ZSVM => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PCFATH => GET_DEVICE_DATA_RDWR (YD_PCFATH)
  PCFAU => GET_DEVICE_DATA_RDWR (YD_PCFAU)
  PCFBTH => GET_DEVICE_DATA_RDWR (YD_PCFBTH)
  PCFBU => GET_DEVICE_DATA_RDWR (YD_PCFBU)
  PCFBV => GET_DEVICE_DATA_RDWR (YD_PCFBV)
  PCP => GET_DEVICE_DATA_RDONLY (YD_PCP)
  PEDMFQ => GET_DEVICE_DATA_RDONLY (YD_PEDMFQ)
  PEDMFS => GET_DEVICE_DATA_RDONLY (YD_PEDMFS)
  PEDMFU => GET_DEVICE_DATA_RDONLY (YD_PEDMFU)
  PEDMFV => GET_DEVICE_DATA_RDONLY (YD_PEDMFV)
  PKQROV => GET_DEVICE_DATA_RDONLY (YD_PKQROV)
  PKTROV => GET_DEVICE_DATA_RDONLY (YD_PKTROV)
  PKUROV => GET_DEVICE_DATA_RDONLY (YD_PKUROV)
  PMF_UP => GET_DEVICE_DATA_RDONLY (YD_PMF_UP)
  PQI => GET_DEVICE_DATA_RDONLY (YD_PQI)
  PQL => GET_DEVICE_DATA_RDONLY (YD_PQL)
  PQV => GET_DEVICE_DATA_RDONLY (YD_PQV)
  PXDROV => GET_DEVICE_DATA_RDWR (YD_PXDROV)
  PXHROV => GET_DEVICE_DATA_RDWR (YD_PXHROV)
  PXQRO => GET_DEVICE_DATA_RDWR (YD_PXQRO)
  PXTRO => GET_DEVICE_DATA_RDWR (YD_PXTRO)
  PXTROV => GET_DEVICE_DATA_RDWR (YD_PXTROV)
  PXURO => GET_DEVICE_DATA_RDWR (YD_PXURO)
  PXUROV => GET_DEVICE_DATA_RDWR (YD_PXUROV)
  ZCFAQ => GET_DEVICE_DATA_RDWR (YL_ZCFAQ)
  ZCFAS => GET_DEVICE_DATA_RDWR (YL_ZCFAS)
  ZCFASV => GET_DEVICE_DATA_RDWR (YL_ZCFASV)
  ZCFBQ => GET_DEVICE_DATA_RDWR (YL_ZCFBQ)
  ZCFBS => GET_DEVICE_DATA_RDWR (YL_ZCFBS)
  ZCFBSV => GET_DEVICE_DATA_RDWR (YL_ZCFBSV)
  ZDSE => GET_DEVICE_DATA_RDWR (YL_ZDSE)
  ZDUMMY => GET_DEVICE_DATA_RDONLY (YL_ZDUMMY)
  ZQT => GET_DEVICE_DATA_RDWR (YL_ZQT)
  ZSVM => GET_DEVICE_DATA_RDONLY (YL_ZSVM)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PCFATH, PCFAU, PCFBTH, PCFBU, PCFBV, PCP, PEDMFQ, PEDMFS, PEDMFU, PEDMFV, &
    !$ACC&         PKQROV, PKTROV, PKUROV, PMF_UP, PQI, PQL, PQV, PXDROV, PXHROV, PXQRO, PXTRO, &
    !$ACC&         PXTROV, PXURO, PXUROV, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZCFAQ, ZCFAS, ZCFASV, ZCFBQ, ZCFBS, ZCFBSV, ZDSE, ZDUMMY, ZQT, ZSVM, Z_YDMF_PHYS_BASE_STATE_T, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACDIFV1_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, 0, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), PCP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:,:, JBLK), PKUROV(:,:, JBLK), PQV(:,:, JBLK), PQL(:,:, JBLK&
      &), PQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), ZSVM(:,:&
      &,:, JBLK), PXTROV(:,:, JBLK), PXUROV(:,:, JBLK), PXDROV(:, JBLK), PXHROV(:, JBLK), PEDMFS(:,:, JBLK&
      &), PEDMFQ(:,:, JBLK), PEDMFU(:,:, JBLK), PEDMFV(:,:, JBLK), ZDUMMY(:,:, JBLK), PMF_UP(:,:, JBLK&
      &), PXURO(:,:, JBLK), PXQRO(:,:, JBLK), PXTRO(:,:, JBLK), ZCFAQ(:,:, JBLK), ZCFAS(:,:, JBLK), PCFATH&
      &(:,:, JBLK), PCFAU(:,:, JBLK), ZCFASV(:,:,:, JBLK), ZCFBQ(:,:, JBLK), ZCFBS(:,:, JBLK), PCFBTH(&
      &:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK), ZCFBSV(:,:,:, JBLK), ZDSE(:,:, JBLK), ZQT(:,:, JBLK&
      &),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCP => GET_HOST_DATA_RDWR (YD_PCP)
    PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
    PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
    PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
    PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
    ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
    ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
    ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
    ZDUMMY => GET_HOST_DATA_RDWR (YL_ZDUMMY)
    ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
    ZSVM => GET_HOST_DATA_RDWR (YL_ZSVM)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PCFATH => NULL ()
  PCFAU => NULL ()
  PCFBTH => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCP => NULL ()
  PEDMFQ => NULL ()
  PEDMFS => NULL ()
  PEDMFU => NULL ()
  PEDMFV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PMF_UP => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQV => NULL ()
  PXDROV => NULL ()
  PXHROV => NULL ()
  PXQRO => NULL ()
  PXTRO => NULL ()
  PXTROV => NULL ()
  PXURO => NULL ()
  PXUROV => NULL ()
  ZCFAQ => NULL ()
  ZCFAS => NULL ()
  ZCFASV => NULL ()
  ZCFBQ => NULL ()
  ZCFBS => NULL ()
  ZCFBSV => NULL ()
  ZDSE => NULL ()
  ZDUMMY => NULL ()
  ZQT => NULL ()
  ZSVM => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_SURFACE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV1',1,ZHOOK_HANDLE_PARALLEL)

IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE.AND.YDCPG_OPTS%LCALLSFX) THEN
  ZCARDI=YDMODEL%YRML_PHY_RAD%YRERDI%RCARDI
  IRR=2
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OpenMP','APL_ARPEGE_SURFACE_PARALLEL:1')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
    PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCFATH => GET_HOST_DATA_RDONLY (YD_PCFATH)
    PCFAU => GET_HOST_DATA_RDONLY (YD_PCFAU)
    PCFBTH => GET_HOST_DATA_RDONLY (YD_PCFBTH)
    PCFBU => GET_HOST_DATA_RDONLY (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDONLY (YD_PCFBV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PCOEFN => GET_HOST_DATA_RDONLY (YD_PCOEFN)
    PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PQI => GET_HOST_DATA_RDONLY (YD_PQI)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQL => GET_HOST_DATA_RDONLY (YD_PQL)
    PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
    PRDG_MU0N => GET_HOST_DATA_RDONLY (YD_PRDG_MU0N)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSGROUPEL => GET_HOST_DATA_RDONLY (YD_PSGROUPEL)
    PSRAIN => GET_HOST_DATA_RDONLY (YD_PSRAIN)
    PSSNOW => GET_HOST_DATA_RDONLY (YD_PSSNOW)
    PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
    ZBUDSO => GET_HOST_DATA_RDWR (YL_ZBUDSO)
    ZBUDTH => GET_HOST_DATA_RDWR (YL_ZBUDTH)
    ZCD => GET_HOST_DATA_RDWR (YL_ZCD)
    ZCFAQ => GET_HOST_DATA_RDONLY (YL_ZCFAQ)
    ZCFBQ => GET_HOST_DATA_RDONLY (YL_ZCFBQ)
    ZCH => GET_HOST_DATA_RDWR (YL_ZCH)
    ZDEPTH_HEIGHT => GET_HOST_DATA_RDWR (YL_ZDEPTH_HEIGHT)
    ZFCLL => GET_HOST_DATA_RDWR (YL_ZFCLL)
    ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
    ZFEVS => GET_HOST_DATA_RDWR (YL_ZFEVS)
    ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
    ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
    ZHV2 => GET_HOST_DATA_RDWR (YL_ZHV2)
    ZRHODREFM => GET_HOST_DATA_RDWR (YL_ZRHODREFM)
    ZSFCO2 => GET_HOST_DATA_RDWR (YL_ZSFCO2)
    ZSFSV => GET_HOST_DATA_RDWR (YL_ZSFSV)
    ZSSO_STDEV => GET_HOST_DATA_RDWR (YL_ZSSO_STDEV)
    ZSVM => GET_HOST_DATA_RDONLY (YL_ZSVM)
    ZTOWNS => GET_HOST_DATA_RDWR (YL_ZTOWNS)
    ZTWSNOW => GET_HOST_DATA_RDWR (YL_ZTWSNOW)
    ZZS => GET_HOST_DATA_RDWR (YL_ZZS)
    Z_YDCPG_GPAR_ALBDIR => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_ALBDIR)
    Z_YDCPG_GPAR_ALBSCA => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_ALBSCA)
    Z_YDCPG_GPAR_CD => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_CD)
    Z_YDCPG_GPAR_GZ0 => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_GZ0)
    Z_YDCPG_GPAR_GZ0H => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_GZ0H)
    Z_YDCPG_GPAR_VEMIS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VEMIS)
    Z_YDCPG_GPAR_VQS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VQS)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_FCLL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
    Z_YDMF_PHYS_OUT_FCLN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
    Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
    Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
    Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
    Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
    Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
    Z_YDMF_PHYS_OUT_SIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_SIC)
    Z_YDMF_PHYS_OUT_SNWDE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_SNWDE)
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_ARG)
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_D2)
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_SAB)
    Z_YDMF_PHYS_SURF_GSP_RR_PFC_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_RR%F_FC_T1)
    Z_YDMF_PHYS_SURF_GSP_RR_PIC_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_RR%F_IC_T1)
    Z_YDMF_PHYS_SURF_GSP_RR_PW_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_RR%F_W_T1)
    Z_YDMF_PHYS_SURF_GSP_SB_PQ_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SB%F_Q_T1)
    Z_YDMF_PHYS_SURF_GSP_SB_PTL_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SB%F_TL_T1)
    Z_YDMF_PHYS_SURF_GSP_SB_PT_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SB%F_T_T1)
    Z_YDMF_PHYS_SURF_GSP_SG_PA_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_A_T1)
    Z_YDMF_PHYS_SURF_GSP_SG_PR_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_R_T1)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_RINDX_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RINDX%FT0)
    Z_YDVARS_GEOMETRY_RINDY_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RINDY%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, JSG) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZRHODREFM (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF (JLON, YDCPG_OPTS&
        &%KFLEVG, JBLK)/(Z_YDMF_PHYS_BASE_STATE_T (JLON, YDCPG_OPTS%KFLEVG, JBLK)*Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK))
        ZZS (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK)/YDMODEL%YRCST%RG
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZDEPTH_HEIGHT (JLON, JLEV, JBLK)=(Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF (JLON, JLEV, JBLK)&
          &-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, YDCPG_OPTS%KFLEVG, JBLK))/YDMODEL%YRCST%RG
        ENDDO

      ENDDO

      CALL ARO_GROUND_PARAM (YLCPG_BNDS%KBL, YLCPG_BNDS%KFDIA-YLCPG_BNDS%KIDIA+1, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDCPG_OPTS%NSTEP, IRR, YDMODEL%YRML_PHY_RAD%YRERAD%NSW, YDMODEL%YRML_GCONF%YGFL%NGFL_EXT, YDGEOMETRY&
      &%YRDIM%NDGUNG, YDGEOMETRY%YRDIM%NDGUXG, YDGEOMETRY%YRDIM%NDLUNG, YDGEOMETRY%YRDIM%NDLUXG, YDMODEL%YRML_PHY_MF&
      &%YRARPHY%LMPA, YDMODEL%YRML_PHY_MF%YRARPHY%CCOUPLING, YDCPG_OPTS%LCONFX, YDCPG_OPTS%NINDAT, PRHGMT, PSTATI&
      &, YDMODEL%YRML_GCONF%YRRIP%RSOVR, YDMODEL%YRML_GCONF%YRRIP%RCODEC, YDMODEL%YRML_GCONF%YRRIP%RSIDEC, Z_YDVARS_GEOMETRY_RINDX_T0&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDVARS_GEOMETRY_RINDY_T0 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), Z_YDMF_PHYS_BASE_STATE_U (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
      &, JBLK), Z_YDMF_PHYS_BASE_STATE_V (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
      &, JBLK), Z_YDMF_PHYS_BASE_STATE_T (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
      &, JBLK), Z_YDMF_PHYS_BASE_STATE_Q (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
      &, JBLK), ZSVM(:,:,:, JBLK), ZCARDI, ZRHODREFM (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG, JBLK), PDTMSE, ZDEPTH_HEIGHT&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, JBLK), ZZS (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), YDMODEL%YRML_PHY_MF%YRMSE%XZSEPS, PRDG_MU0 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), PRDG_MU0N&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), YDMODEL%YRML_PHY_MF%YRPARAR&
      &%XSW_BANDS, PSRAIN (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), PSSNOW (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), PSGROUPEL (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_FRTHDS (YLCPG_BNDS%KIDIA&
      &:YLCPG_BNDS%KFDIA, JBLK), PSFSWDIF (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1:YDMODEL%YRML_PHY_RAD%YRERAD&
      &%NSW, JBLK), PSFSWDIR (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1:YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JBLK), ZCFAQ&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG, JBLK), PCFATH (YLCPG_BNDS%KIDIA&
      &:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG, JBLK), PCFAU (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG, JBLK), ZCFBQ (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG&
      &:YDCPG_OPTS%KFLEVG, JBLK), PCFBTH (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG&
      &, JBLK), PCFBU (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG, JBLK), PCFBV&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG:YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_FCS&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), ZFEV (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), ZSFSV&
      &(:,:, JBLK), ZSFCO2 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), ZFMDU (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), ZFMDV (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), PALBP (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1&
      &:YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JBLK), PALBD (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1:YDMODEL%YRML_PHY_RAD&
      &%YRERAD%NSW, JBLK), PFLU_EMIS (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), PTSN (YLCPG_BNDS%KIDIA:YLCPG_BNDS&
      &%KFDIA, JBLK), Z_YDMF_PHYS_OUT_FRTH (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, 1, JBLK),&
      & YDMODEL)
      ZFEVS (:, JBLK)=-ZFEV (:, JBLK)
      CALL ARO_GROUND_DIAG (YLCPG_BNDS%KBL, YLCPG_BNDS%KFDIA-YLCPG_BNDS%KIDIA+1, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDCPG_OPTS%KFLEVG,-1, YDGEOMETRY%YRDIM%NDGUNG, YDGEOMETRY%YRDIM%NDGUXG, YDGEOMETRY%YRDIM%NDLUNG&
      &, YDGEOMETRY%YRDIM%NDLUXG, ZZS (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), ZFEVS (YLCPG_BNDS%KIDIA&
      &:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_BASE_STATE_U (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1:YDCPG_OPTS&
      &%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_V (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1:YDCPG_OPTS%KFLEVG,&
      & JBLK), ZDEPTH_HEIGHT (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1:YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_FRTH&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, 1, JBLK), Z_YDMF_PHYS_OUT_FRSO (YLCPG_BNDS&
      &%KIDIA:YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, 1, JBLK), Z_YDVARS_GEOMETRY_RINDX_T0 (YLCPG_BNDS%KIDIA&
      &:YLCPG_BNDS%KFDIA, JBLK), Z_YDVARS_GEOMETRY_RINDY_T0 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDCPG_MISC_QS&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_GZ0 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), Z_YDMF_PHYS_OUT_GZ0H (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_TCLS (YLCPG_BNDS&
      &%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_QCLS (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_RHCLS&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_UCLS (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), Z_YDMF_PHYS_OUT_VCLS (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_NUCLS (YLCPG_BNDS&
      &%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_NVCLS (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_FCLL&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), Z_YDMF_PHYS_OUT_FCLN (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, 1, JBLK), Z_YDMF_PHYS_OUT_FEVL (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), Z_YDMF_PHYS_OUT_FEVN&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), ZSSO_STDEV (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK&
      &), ZTWSNOW (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_OUT_SNWDE (YLCPG_BNDS%KIDIA:YLCPG_BNDS&
      &%KFDIA, JBLK), ZBUDTH (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), ZBUDSO (YLCPG_BNDS%KIDIA:YLCPG_BNDS&
      &%KFDIA, JBLK), ZFCLL (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), ZTOWNS (YLCPG_BNDS%KIDIA:YLCPG_BNDS&
      &%KFDIA, JBLK), ZCD (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), ZCH (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA&
      &, JBLK), Z_YDMF_PHYS_OUT_SIC (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK))

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDCPG_GPAR_GZ0 (JLON, JBLK)=Z_YDMF_PHYS_OUT_GZ0 (JLON, JBLK)
        Z_YDCPG_GPAR_GZ0H (JLON, JBLK)=Z_YDMF_PHYS_OUT_GZ0H (JLON, JBLK)
        Z_YDCPG_GPAR_VEMIS (JLON, JBLK)=PFLU_EMIS (JLON, JBLK)
        Z_YDCPG_GPAR_VQS (JLON, JBLK)=Z_YDCPG_MISC_QS (JLON, JBLK)
        Z_YDCPG_GPAR_CD (JLON, JBLK)=ZCD (JLON, JBLK)
      ENDDO


      DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
        Z_YDCPG_GPAR_ALBSCA (:, JSG, JBLK)=PALBD (:, JSG, JBLK)
        Z_YDCPG_GPAR_ALBDIR (:, JSG, JBLK)=PALBP (:, JSG, JBLK)
      ENDDO


      DO JSG=1, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG+1

        DO JLEV=0, YDCPG_OPTS%KFLEVG

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDMF_PHYS_OUT_FRTH (JLON, JLEV, JSG, JBLK)=Z_YDMF_PHYS_OUT_FRTH&
            & (JLON, JLEV, JSG, JBLK)+ZBUDTH (JLON, JBLK)
          ENDDO

        ENDDO

      ENDDO

      CALL ARO_GROUND_DIAG_2ISBA (YLCPG_BNDS%KBL, YLCPG_BNDS%KFDIA-YLCPG_BNDS%KIDIA+1, YLCPG_BNDS%KIDIA,&
      & YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIM%NDGUNG, YDGEOMETRY%YRDIM%NDGUXG, YDGEOMETRY%YRDIM%NDLUNG, YDGEOMETRY&
      &%YRDIM%NDLUXG, Z_YDVARS_GEOMETRY_RINDX_T0 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDVARS_GEOMETRY_RINDY_T0&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PARG&
      &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, JBLK), PTSN(:, JBLK&
      &), ZTWSNOW(:, JBLK), Z_YDMF_PHYS_SURF_GSP_SB_PT_T1 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PW_T1&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_SURF_GSP_SB_PQ_T1 (YLCPG_BNDS%KIDIA:YLCPG_BNDS&
      &%KFDIA, 1, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PIC_T1 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, JBLK), Z_YDMF_PHYS_SURF_GSP_SB_PTL_T1&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PFC_T1 (YLCPG_BNDS%KIDIA:YLCPG_BNDS&
      &%KFDIA, JBLK), Z_YDMF_PHYS_SURF_GSP_SG_PA_T1 (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), Z_YDMF_PHYS_SURF_GSP_SG_PR_T1&
      & (YLCPG_BNDS%KIDIA:YLCPG_BNDS%KFDIA, 1, JBLK), ZHV2(:, JBLK))

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_SURF_GSD_VV_PHV (JLON, JBLK)=ZHV2 (JLON, JBLK)
      ENDDO


      IF (.NOT.YDMODEL%YRML_PHY_MF%YRPHY%LNODIFQC) THEN
        CALL ACAA1 (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), PCOEFN(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK)&
        &, PQL(:,:, JBLK), PQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), PALPHA1(:,&
        &:, JBLK), PCOEFA(:,:, JBLK), PLVT(:,:, JBLK), PQICE(:,:, JBLK))
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:1')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
      PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
      PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
      PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
      PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
      PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
      PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
      PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
      PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
      PCOEFN => GET_HOST_DATA_RDWR (YD_PCOEFN)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
      PQI => GET_HOST_DATA_RDWR (YD_PQI)
      PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
      PQL => GET_HOST_DATA_RDWR (YD_PQL)
      PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
      PRDG_MU0N => GET_HOST_DATA_RDWR (YD_PRDG_MU0N)
      PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
      PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
      PSGROUPEL => GET_HOST_DATA_RDWR (YD_PSGROUPEL)
      PSRAIN => GET_HOST_DATA_RDWR (YD_PSRAIN)
      PSSNOW => GET_HOST_DATA_RDWR (YD_PSSNOW)
      PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
      ZBUDSO => GET_HOST_DATA_RDWR (YL_ZBUDSO)
      ZBUDTH => GET_HOST_DATA_RDWR (YL_ZBUDTH)
      ZCD => GET_HOST_DATA_RDWR (YL_ZCD)
      ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
      ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
      ZCH => GET_HOST_DATA_RDWR (YL_ZCH)
      ZDEPTH_HEIGHT => GET_HOST_DATA_RDWR (YL_ZDEPTH_HEIGHT)
      ZFCLL => GET_HOST_DATA_RDWR (YL_ZFCLL)
      ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
      ZFEVS => GET_HOST_DATA_RDWR (YL_ZFEVS)
      ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
      ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
      ZHV2 => GET_HOST_DATA_RDWR (YL_ZHV2)
      ZRHODREFM => GET_HOST_DATA_RDWR (YL_ZRHODREFM)
      ZSFCO2 => GET_HOST_DATA_RDWR (YL_ZSFCO2)
      ZSFSV => GET_HOST_DATA_RDWR (YL_ZSFSV)
      ZSSO_STDEV => GET_HOST_DATA_RDWR (YL_ZSSO_STDEV)
      ZSVM => GET_HOST_DATA_RDWR (YL_ZSVM)
      ZTOWNS => GET_HOST_DATA_RDWR (YL_ZTOWNS)
      ZTWSNOW => GET_HOST_DATA_RDWR (YL_ZTWSNOW)
      ZZS => GET_HOST_DATA_RDWR (YL_ZZS)
      Z_YDCPG_GPAR_ALBDIR => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_ALBDIR)
      Z_YDCPG_GPAR_ALBSCA => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_ALBSCA)
      Z_YDCPG_GPAR_CD => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_CD)
      Z_YDCPG_GPAR_GZ0 => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_GZ0)
      Z_YDCPG_GPAR_GZ0H => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_GZ0H)
      Z_YDCPG_GPAR_VEMIS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VEMIS)
      Z_YDCPG_GPAR_VQS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VQS)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_FCLL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
      Z_YDMF_PHYS_OUT_FCLN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
      Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_OUT_SIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_SIC)
      Z_YDMF_PHYS_OUT_SNWDE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_SNWDE)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_D2)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_SURF_GSP_RR_PFC_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_RR%F_FC_T1)
      Z_YDMF_PHYS_SURF_GSP_RR_PIC_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_RR%F_IC_T1)
      Z_YDMF_PHYS_SURF_GSP_RR_PW_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_RR%F_W_T1)
      Z_YDMF_PHYS_SURF_GSP_SB_PQ_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SB%F_Q_T1)
      Z_YDMF_PHYS_SURF_GSP_SB_PTL_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SB%F_TL_T1)
      Z_YDMF_PHYS_SURF_GSP_SB_PT_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SB%F_T_T1)
      Z_YDMF_PHYS_SURF_GSP_SG_PA_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_A_T1)
      Z_YDMF_PHYS_SURF_GSP_SG_PR_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_R_T1)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_RINDX_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDX%FT0)
      Z_YDVARS_GEOMETRY_RINDY_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDY%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => NULL ()
    PALBP => NULL ()
    PALPHA1 => NULL ()
    PCFATH => NULL ()
    PCFAU => NULL ()
    PCFBTH => NULL ()
    PCFBU => NULL ()
    PCFBV => NULL ()
    PCOEFA => NULL ()
    PCOEFN => NULL ()
    PFLU_EMIS => NULL ()
    PLVT => NULL ()
    PQI => NULL ()
    PQICE => NULL ()
    PQL => NULL ()
    PRDG_MU0 => NULL ()
    PRDG_MU0N => NULL ()
    PSFSWDIF => NULL ()
    PSFSWDIR => NULL ()
    PSGROUPEL => NULL ()
    PSRAIN => NULL ()
    PSSNOW => NULL ()
    PTSN => NULL ()
    ZBUDSO => NULL ()
    ZBUDTH => NULL ()
    ZCD => NULL ()
    ZCFAQ => NULL ()
    ZCFBQ => NULL ()
    ZCH => NULL ()
    ZDEPTH_HEIGHT => NULL ()
    ZFCLL => NULL ()
    ZFEV => NULL ()
    ZFEVS => NULL ()
    ZFMDU => NULL ()
    ZFMDV => NULL ()
    ZHV2 => NULL ()
    ZRHODREFM => NULL ()
    ZSFCO2 => NULL ()
    ZSFSV => NULL ()
    ZSSO_STDEV => NULL ()
    ZSVM => NULL ()
    ZTOWNS => NULL ()
    ZTWSNOW => NULL ()
    ZZS => NULL ()
    Z_YDCPG_GPAR_ALBDIR => NULL ()
    Z_YDCPG_GPAR_ALBSCA => NULL ()
    Z_YDCPG_GPAR_CD => NULL ()
    Z_YDCPG_GPAR_GZ0 => NULL ()
    Z_YDCPG_GPAR_GZ0H => NULL ()
    Z_YDCPG_GPAR_VEMIS => NULL ()
    Z_YDCPG_GPAR_VQS => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_OUT_FCLL => NULL ()
    Z_YDMF_PHYS_OUT_FCLN => NULL ()
    Z_YDMF_PHYS_OUT_FCS => NULL ()
    Z_YDMF_PHYS_OUT_FEVL => NULL ()
    Z_YDMF_PHYS_OUT_FEVN => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
    Z_YDMF_PHYS_OUT_GZ0 => NULL ()
    Z_YDMF_PHYS_OUT_GZ0H => NULL ()
    Z_YDMF_PHYS_OUT_NUCLS => NULL ()
    Z_YDMF_PHYS_OUT_NVCLS => NULL ()
    Z_YDMF_PHYS_OUT_QCLS => NULL ()
    Z_YDMF_PHYS_OUT_RHCLS => NULL ()
    Z_YDMF_PHYS_OUT_SIC => NULL ()
    Z_YDMF_PHYS_OUT_SNWDE => NULL ()
    Z_YDMF_PHYS_OUT_TCLS => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL ()
    Z_YDMF_PHYS_SURF_GSP_RR_PFC_T1 => NULL ()
    Z_YDMF_PHYS_SURF_GSP_RR_PIC_T1 => NULL ()
    Z_YDMF_PHYS_SURF_GSP_RR_PW_T1 => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SB_PQ_T1 => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SB_PTL_T1 => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SB_PT_T1 => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SG_PA_T1 => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SG_PR_T1 => NULL ()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
    Z_YDVARS_GEOMETRY_RINDX_T0 => NULL ()
    Z_YDVARS_GEOMETRY_RINDY_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_SURFACE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
ELSEIF (.NOT.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_SURFACE_PARALLEL:LMSE_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCDROV => GET_HOST_DATA_RDONLY (YD_PCDROV)
    PCEROV => GET_HOST_DATA_RDONLY (YD_PCEROV)
    PCFAU => GET_HOST_DATA_RDONLY (YD_PCFAU)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCHROV => GET_HOST_DATA_RDONLY (YD_PCHROV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PCP => GET_HOST_DATA_RDONLY (YD_PCP)
    PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
    PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
    PDQSTS => GET_HOST_DATA_RDONLY (YD_PDQSTS)
    PDSA_CPS => GET_HOST_DATA_RDONLY (YD_PDSA_CPS)
    PDSA_LHS => GET_HOST_DATA_RDWR (YD_PDSA_LHS)
    PFLU_CD => GET_HOST_DATA_RDONLY (YD_PFLU_CD)
    PFLU_CDN => GET_HOST_DATA_RDONLY (YD_PFLU_CDN)
    PFLU_EMIS => GET_HOST_DATA_RDONLY (YD_PFLU_EMIS)
    PFLU_FEVI => GET_HOST_DATA_RDWR (YD_PFLU_FEVI)
    PFLU_NEIJ => GET_HOST_DATA_RDONLY (YD_PFLU_NEIJ)
    PFLU_QSATS => GET_HOST_DATA_RDONLY (YD_PFLU_QSATS)
    PFLU_VEG => GET_HOST_DATA_RDONLY (YD_PFLU_VEG)
    PHQ => GET_HOST_DATA_RDONLY (YD_PHQ)
    PHTR => GET_HOST_DATA_RDONLY (YD_PHTR)
    PHU => GET_HOST_DATA_RDONLY (YD_PHU)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PNEBCH => GET_HOST_DATA_RDONLY (YD_PNEBCH)
    PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
    PNEBS => GET_HOST_DATA_RDONLY (YD_PNEBS)
    PQI => GET_HOST_DATA_RDONLY (YD_PQI)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQL => GET_HOST_DATA_RDONLY (YD_PQL)
    PQV => GET_HOST_DATA_RDONLY (YD_PQV)
    PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
    PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
    PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
    PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
    PXDROV => GET_HOST_DATA_RDONLY (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDONLY (YD_PXHROV)
    PXQRO => GET_HOST_DATA_RDONLY (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDONLY (YD_PXTRO)
    PXURO => GET_HOST_DATA_RDONLY (YD_PXURO)
    ZCFAS => GET_HOST_DATA_RDONLY (YL_ZCFAS)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBQ_G => GET_HOST_DATA_RDWR (YL_ZCFBQ_G)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBS_G => GET_HOST_DATA_RDWR (YL_ZCFBS_G)
    ZCFBU_G => GET_HOST_DATA_RDWR (YL_ZCFBU_G)
    ZCFBV_G => GET_HOST_DATA_RDWR (YL_ZCFBV_G)
    ZDSE => GET_HOST_DATA_RDONLY (YL_ZDSE)
    ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
    ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_T)
    Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_CT)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCHSP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCHSP)
    Z_YDMF_PHYS_OUT_FCLL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
    Z_YDMF_PHYS_OUT_FCLN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FEVV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVV)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FTR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FTR)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VH_PQSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_QSH)
    Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VH%F_SPSH)
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_HV)
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      IF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==5) THEN
        PNEBDIFF (:,:, JBLK)=PNEBS (:,:, JBLK)
      ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==2) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            PNEBDIFF (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)
          ENDDO

        ENDDO

      ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==3) THEN
        PNEBDIFF (:,:, JBLK)=PNEBS (:,:, JBLK)+(1.0_JPRB-PNEBS (:,:, JBLK))*PNEBCH (:,:, JBLK)
      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI) THEN
        ZCFBS_G (:,:, JBLK)=ZCFBS (:,:, JBLK)
        ZCFBQ_G (:,:, JBLK)=ZCFBQ (:,:, JBLK)
        ZCFBU_G (:,:, JBLK)=PCFBU (:,:, JBLK)
        ZCFBV_G (:,:, JBLK)=PCFBV (:,:, JBLK)
      ENDIF

      CALL ARP_GROUND_PARAM (YDMODEL%YRCST, YDMODEL%YRML_AOC%YRMCC, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD&
      &%NLEVS, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), PCP(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,&
      &:, JBLK), PQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PXURO(:,:,&
      & JBLK), PXQRO(:,:, JBLK), PXTRO(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), PQL&
      &(:,:, JBLK), PQI(:,:, JBLK), PNEBDIFF(:,:, JBLK), PFLU_CD(:, JBLK), PFLU_CDN(:, JBLK), PCDROV(:, JBLK&
      &), PCHROV(:, JBLK), PCEROV(:, JBLK), PDSA_CPS(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), PDQSTS(:, JBLK&
      &), PFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PSPSH(:, JBLK), PHQ(:, JBLK), PHTR(:, JBLK), PHU(:&
      &, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG&
      &(:, JBLK), PFLU_NEIJ(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), PFLU_QSATS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), PFLU_VEG(:, JBLK), PXDROV(:, JBLK), PXHROV&
      &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK),&
      & ZDSE(:,:, JBLK), ZCFAS(:,:, JBLK), PCFAU(:,:, JBLK), ZCFBS(:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:&
      &,:, JBLK), ZCFBQ(:,:, JBLK), PCOEFA(:,:, JBLK), PALPHA1(:,:, JBLK), PLVT(:,:, JBLK), PQICE(:,:, JBLK&
      &), PDIFWQ(:, JBLK), PDIFWS(:, JBLK), ZFMDU(:, JBLK), ZFMDV(:, JBLK), PSC_FEVI(:, JBLK), PSC_FEVN(&
      &:, JBLK), PSC_FCLL(:, JBLK), PSC_FCLN(:, JBLK), Z_YDMF_PHYS_OUT_FCHSP(:,:, JBLK), Z_YDMF_PHYS_OUT_FCLL&
      & (:, 1, JBLK), Z_YDMF_PHYS_OUT_FCLN (:, 1, JBLK), Z_YDMF_PHYS_OUT_FCS (:, 1, JBLK), PFLU_FEVI (:,&
      & 1, JBLK), Z_YDMF_PHYS_OUT_FEVL (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVN (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVV&
      &(:, JBLK), Z_YDMF_PHYS_OUT_FTR(:, JBLK), PDSA_LHS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PQSH(:, JBLK)&
      &, Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H&
      &(:, JBLK))

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_OUT_DIFTQ (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PDIFWQ (JLON, JBLK)
        Z_YDMF_PHYS_OUT_DIFTS (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PDIFWS (JLON, JBLK)
      ENDDO


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI) THEN
        ZCFBQ (:,:, JBLK)=ZCFBQ_G (:,:, JBLK)
        ZCFBS (:,:, JBLK)=ZCFBS_G (:,:, JBLK)
        PCFBU (:, YDCPG_OPTS%KFLEVG, JBLK)=ZCFBU_G (:, YDCPG_OPTS%KFLEVG, JBLK)
        PCFBV (:, YDCPG_OPTS%KFLEVG, JBLK)=ZCFBV_G (:, YDCPG_OPTS%KFLEVG, JBLK)
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
      PCDROV => GET_HOST_DATA_RDWR (YD_PCDROV)
      PCEROV => GET_HOST_DATA_RDWR (YD_PCEROV)
      PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
      PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
      PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
      PCHROV => GET_HOST_DATA_RDWR (YD_PCHROV)
      PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
      PCP => GET_HOST_DATA_RDWR (YD_PCP)
      PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
      PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
      PDQSTS => GET_HOST_DATA_RDWR (YD_PDQSTS)
      PDSA_CPS => GET_HOST_DATA_RDWR (YD_PDSA_CPS)
      PDSA_LHS => GET_HOST_DATA_RDWR (YD_PDSA_LHS)
      PFLU_CD => GET_HOST_DATA_RDWR (YD_PFLU_CD)
      PFLU_CDN => GET_HOST_DATA_RDWR (YD_PFLU_CDN)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PFLU_FEVI => GET_HOST_DATA_RDWR (YD_PFLU_FEVI)
      PFLU_NEIJ => GET_HOST_DATA_RDWR (YD_PFLU_NEIJ)
      PFLU_QSATS => GET_HOST_DATA_RDWR (YD_PFLU_QSATS)
      PFLU_VEG => GET_HOST_DATA_RDWR (YD_PFLU_VEG)
      PHQ => GET_HOST_DATA_RDWR (YD_PHQ)
      PHTR => GET_HOST_DATA_RDWR (YD_PHTR)
      PHU => GET_HOST_DATA_RDWR (YD_PHU)
      PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
      PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
      PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
      PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
      PQI => GET_HOST_DATA_RDWR (YD_PQI)
      PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
      PQL => GET_HOST_DATA_RDWR (YD_PQL)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
      PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
      PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
      PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
      PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
      PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
      PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
      PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
      PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
      ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
      ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
      ZCFBQ_G => GET_HOST_DATA_RDWR (YL_ZCFBQ_G)
      ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
      ZCFBS_G => GET_HOST_DATA_RDWR (YL_ZCFBS_G)
      ZCFBU_G => GET_HOST_DATA_RDWR (YL_ZCFBU_G)
      ZCFBV_G => GET_HOST_DATA_RDWR (YL_ZCFBV_G)
      ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
      ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
      ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_T)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
      Z_YDMF_PHYS_OUT_FCHSP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCHSP)
      Z_YDMF_PHYS_OUT_FCLL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
      Z_YDMF_PHYS_OUT_FCLN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
      Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_OUT_FEVV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVV)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FTR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FTR)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VH_PQSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_QSH)
      Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_SPSH)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => NULL ()
    PCDROV => NULL ()
    PCEROV => NULL ()
    PCFAU => NULL ()
    PCFBU => NULL ()
    PCFBV => NULL ()
    PCHROV => NULL ()
    PCOEFA => NULL ()
    PCP => NULL ()
    PDIFWQ => NULL ()
    PDIFWS => NULL ()
    PDQSTS => NULL ()
    PDSA_CPS => NULL ()
    PDSA_LHS => NULL ()
    PFLU_CD => NULL ()
    PFLU_CDN => NULL ()
    PFLU_EMIS => NULL ()
    PFLU_FEVI => NULL ()
    PFLU_NEIJ => NULL ()
    PFLU_QSATS => NULL ()
    PFLU_VEG => NULL ()
    PHQ => NULL ()
    PHTR => NULL ()
    PHU => NULL ()
    PLVT => NULL ()
    PNEBCH => NULL ()
    PNEBDIFF => NULL ()
    PNEBS => NULL ()
    PQI => NULL ()
    PQICE => NULL ()
    PQL => NULL ()
    PQV => NULL ()
    PSC_FCLL => NULL ()
    PSC_FCLN => NULL ()
    PSC_FEVI => NULL ()
    PSC_FEVN => NULL ()
    PXDROV => NULL ()
    PXHROV => NULL ()
    PXQRO => NULL ()
    PXTRO => NULL ()
    PXURO => NULL ()
    ZCFAS => NULL ()
    ZCFBQ => NULL ()
    ZCFBQ_G => NULL ()
    ZCFBS => NULL ()
    ZCFBS_G => NULL ()
    ZCFBU_G => NULL ()
    ZCFBV_G => NULL ()
    ZDSE => NULL ()
    ZFMDU => NULL ()
    ZFMDV => NULL ()
    Z_YDCPG_MISC_NEB => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => NULL ()
    Z_YDMF_PHYS_OUT_CT => NULL ()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFTS => NULL ()
    Z_YDMF_PHYS_OUT_FCHSP => NULL ()
    Z_YDMF_PHYS_OUT_FCLL => NULL ()
    Z_YDMF_PHYS_OUT_FCLN => NULL ()
    Z_YDMF_PHYS_OUT_FCS => NULL ()
    Z_YDMF_PHYS_OUT_FEVL => NULL ()
    Z_YDMF_PHYS_OUT_FEVN => NULL ()
    Z_YDMF_PHYS_OUT_FEVV => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FTR => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PQSH => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
    &','APL_ARPEGE_SURFACE_PARALLEL:LMSE_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCDROV => GET_HOST_DATA_RDONLY (YD_PCDROV)
    PCEROV => GET_HOST_DATA_RDONLY (YD_PCEROV)
    PCFAU => GET_HOST_DATA_RDONLY (YD_PCFAU)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCHROV => GET_HOST_DATA_RDONLY (YD_PCHROV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PCP => GET_HOST_DATA_RDONLY (YD_PCP)
    PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
    PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
    PDQSTS => GET_HOST_DATA_RDONLY (YD_PDQSTS)
    PDSA_CPS => GET_HOST_DATA_RDONLY (YD_PDSA_CPS)
    PDSA_LHS => GET_HOST_DATA_RDWR (YD_PDSA_LHS)
    PFLU_CD => GET_HOST_DATA_RDONLY (YD_PFLU_CD)
    PFLU_CDN => GET_HOST_DATA_RDONLY (YD_PFLU_CDN)
    PFLU_EMIS => GET_HOST_DATA_RDONLY (YD_PFLU_EMIS)
    PFLU_FEVI => GET_HOST_DATA_RDWR (YD_PFLU_FEVI)
    PFLU_NEIJ => GET_HOST_DATA_RDONLY (YD_PFLU_NEIJ)
    PFLU_QSATS => GET_HOST_DATA_RDONLY (YD_PFLU_QSATS)
    PFLU_VEG => GET_HOST_DATA_RDONLY (YD_PFLU_VEG)
    PHQ => GET_HOST_DATA_RDONLY (YD_PHQ)
    PHTR => GET_HOST_DATA_RDONLY (YD_PHTR)
    PHU => GET_HOST_DATA_RDONLY (YD_PHU)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PNEBCH => GET_HOST_DATA_RDONLY (YD_PNEBCH)
    PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
    PNEBS => GET_HOST_DATA_RDONLY (YD_PNEBS)
    PQI => GET_HOST_DATA_RDONLY (YD_PQI)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQL => GET_HOST_DATA_RDONLY (YD_PQL)
    PQV => GET_HOST_DATA_RDONLY (YD_PQV)
    PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
    PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
    PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
    PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
    PXDROV => GET_HOST_DATA_RDONLY (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDONLY (YD_PXHROV)
    PXQRO => GET_HOST_DATA_RDONLY (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDONLY (YD_PXTRO)
    PXURO => GET_HOST_DATA_RDONLY (YD_PXURO)
    ZCFAS => GET_HOST_DATA_RDONLY (YL_ZCFAS)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBQ_G => GET_HOST_DATA_RDWR (YL_ZCFBQ_G)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBS_G => GET_HOST_DATA_RDWR (YL_ZCFBS_G)
    ZCFBU_G => GET_HOST_DATA_RDWR (YL_ZCFBU_G)
    ZCFBV_G => GET_HOST_DATA_RDWR (YL_ZCFBV_G)
    ZDSE => GET_HOST_DATA_RDONLY (YL_ZDSE)
    ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
    ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_T)
    Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_CT)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCHSP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCHSP)
    Z_YDMF_PHYS_OUT_FCLL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
    Z_YDMF_PHYS_OUT_FCLN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FEVV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVV)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FTR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FTR)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VH_PQSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_QSH)
    Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VH%F_SPSH)
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_HV)
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==5) THEN
          PNEBDIFF (JLON,:, JBLK)=PNEBS (JLON,:, JBLK)
        ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==2) THEN

          DO JLEV=1, YDCPG_OPTS%KFLEVG
            
            PNEBDIFF (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)
          
          ENDDO

        ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==3) THEN
          PNEBDIFF (JLON,:, JBLK)=PNEBS (JLON,:, JBLK)+(1.0_JPRB-PNEBS (JLON,:, JBLK))*PNEBCH (JLON,:, JBLK)
        ENDIF


        IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI) THEN
          ZCFBS_G (JLON,:, JBLK)=ZCFBS (JLON,:, JBLK)
          ZCFBQ_G (JLON,:, JBLK)=ZCFBQ (JLON,:, JBLK)
          ZCFBU_G (JLON,:, JBLK)=PCFBU (JLON,:, JBLK)
          ZCFBV_G (JLON,:, JBLK)=PCFBV (JLON,:, JBLK)
        ENDIF

        CALL ARP_GROUND_PARAM_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_AOC%YRMCC, YDMODEL%YRML_PHY_MF, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%YRSURF_DIMS&
        &%YSP_SBD%NLEVS, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), PCP(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
        &(:,:,:, JBLK), PQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PXURO(:,:, JBLK&
        &), PXQRO(:,:, JBLK), PXTRO(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), PQL(:,:,&
        & JBLK), PQI(:,:, JBLK), PNEBDIFF(:,:, JBLK), PFLU_CD(:, JBLK), PFLU_CDN(:, JBLK), PCDROV(:, JBLK),&
        & PCHROV(:, JBLK), PCEROV(:, JBLK), PDSA_CPS(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), PDQSTS(:, JBLK)&
        &, PFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PSPSH(:, JBLK), PHQ(:, JBLK), PHTR(:, JBLK), PHU(:, JBLK&
        &), Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG&
        &(:, JBLK), PFLU_NEIJ(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), PFLU_QSATS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), PFLU_VEG(:, JBLK), PXDROV(:, JBLK), PXHROV&
        &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), ZDSE&
        &(:,:, JBLK), ZCFAS(:,:, JBLK), PCFAU(:,:, JBLK), ZCFBS(:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK&
        &), ZCFBQ(:,:, JBLK), PCOEFA(:,:, JBLK), PALPHA1(:,:, JBLK), PLVT(:,:, JBLK), PQICE(:,:, JBLK), PDIFWQ&
        &(:, JBLK), PDIFWS(:, JBLK), ZFMDU(:, JBLK), ZFMDV(:, JBLK), PSC_FEVI(:, JBLK), PSC_FEVN(:, JBLK), PSC_FCLL&
        &(:, JBLK), PSC_FCLN(:, JBLK), Z_YDMF_PHYS_OUT_FCHSP(:,:, JBLK), Z_YDMF_PHYS_OUT_FCLL (:, 1, JBLK),&
        & Z_YDMF_PHYS_OUT_FCLN (:, 1, JBLK), Z_YDMF_PHYS_OUT_FCS (:, 1, JBLK), PFLU_FEVI (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVL&
        & (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVN (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVV(:, JBLK), Z_YDMF_PHYS_OUT_FTR&
        &(:, JBLK), PDSA_LHS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PQSH(:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK&
        &), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_DIFTQ (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PDIFWQ (JLON, JBLK)
        Z_YDMF_PHYS_OUT_DIFTS (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PDIFWS (JLON, JBLK)

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI) THEN
          ZCFBQ (JLON,:, JBLK)=ZCFBQ_G (JLON,:, JBLK)
          ZCFBS (JLON,:, JBLK)=ZCFBS_G (JLON,:, JBLK)
          PCFBU (JLON, YDCPG_OPTS%KFLEVG, JBLK)=ZCFBU_G (JLON, YDCPG_OPTS%KFLEVG, JBLK)
          PCFBV (JLON, YDCPG_OPTS%KFLEVG, JBLK)=ZCFBV_G (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
      PCDROV => GET_HOST_DATA_RDWR (YD_PCDROV)
      PCEROV => GET_HOST_DATA_RDWR (YD_PCEROV)
      PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
      PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
      PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
      PCHROV => GET_HOST_DATA_RDWR (YD_PCHROV)
      PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
      PCP => GET_HOST_DATA_RDWR (YD_PCP)
      PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
      PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
      PDQSTS => GET_HOST_DATA_RDWR (YD_PDQSTS)
      PDSA_CPS => GET_HOST_DATA_RDWR (YD_PDSA_CPS)
      PDSA_LHS => GET_HOST_DATA_RDWR (YD_PDSA_LHS)
      PFLU_CD => GET_HOST_DATA_RDWR (YD_PFLU_CD)
      PFLU_CDN => GET_HOST_DATA_RDWR (YD_PFLU_CDN)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PFLU_FEVI => GET_HOST_DATA_RDWR (YD_PFLU_FEVI)
      PFLU_NEIJ => GET_HOST_DATA_RDWR (YD_PFLU_NEIJ)
      PFLU_QSATS => GET_HOST_DATA_RDWR (YD_PFLU_QSATS)
      PFLU_VEG => GET_HOST_DATA_RDWR (YD_PFLU_VEG)
      PHQ => GET_HOST_DATA_RDWR (YD_PHQ)
      PHTR => GET_HOST_DATA_RDWR (YD_PHTR)
      PHU => GET_HOST_DATA_RDWR (YD_PHU)
      PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
      PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
      PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
      PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
      PQI => GET_HOST_DATA_RDWR (YD_PQI)
      PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
      PQL => GET_HOST_DATA_RDWR (YD_PQL)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
      PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
      PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
      PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
      PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
      PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
      PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
      PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
      PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
      ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
      ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
      ZCFBQ_G => GET_HOST_DATA_RDWR (YL_ZCFBQ_G)
      ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
      ZCFBS_G => GET_HOST_DATA_RDWR (YL_ZCFBS_G)
      ZCFBU_G => GET_HOST_DATA_RDWR (YL_ZCFBU_G)
      ZCFBV_G => GET_HOST_DATA_RDWR (YL_ZCFBV_G)
      ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
      ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
      ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_T)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
      Z_YDMF_PHYS_OUT_FCHSP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCHSP)
      Z_YDMF_PHYS_OUT_FCLL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
      Z_YDMF_PHYS_OUT_FCLN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
      Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_OUT_FEVV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVV)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FTR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FTR)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VH_PQSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_QSH)
      Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_SPSH)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => NULL ()
    PCDROV => NULL ()
    PCEROV => NULL ()
    PCFAU => NULL ()
    PCFBU => NULL ()
    PCFBV => NULL ()
    PCHROV => NULL ()
    PCOEFA => NULL ()
    PCP => NULL ()
    PDIFWQ => NULL ()
    PDIFWS => NULL ()
    PDQSTS => NULL ()
    PDSA_CPS => NULL ()
    PDSA_LHS => NULL ()
    PFLU_CD => NULL ()
    PFLU_CDN => NULL ()
    PFLU_EMIS => NULL ()
    PFLU_FEVI => NULL ()
    PFLU_NEIJ => NULL ()
    PFLU_QSATS => NULL ()
    PFLU_VEG => NULL ()
    PHQ => NULL ()
    PHTR => NULL ()
    PHU => NULL ()
    PLVT => NULL ()
    PNEBCH => NULL ()
    PNEBDIFF => NULL ()
    PNEBS => NULL ()
    PQI => NULL ()
    PQICE => NULL ()
    PQL => NULL ()
    PQV => NULL ()
    PSC_FCLL => NULL ()
    PSC_FCLN => NULL ()
    PSC_FEVI => NULL ()
    PSC_FEVN => NULL ()
    PXDROV => NULL ()
    PXHROV => NULL ()
    PXQRO => NULL ()
    PXTRO => NULL ()
    PXURO => NULL ()
    ZCFAS => NULL ()
    ZCFBQ => NULL ()
    ZCFBQ_G => NULL ()
    ZCFBS => NULL ()
    ZCFBS_G => NULL ()
    ZCFBU_G => NULL ()
    ZCFBV_G => NULL ()
    ZDSE => NULL ()
    ZFMDU => NULL ()
    ZFMDV => NULL ()
    Z_YDCPG_MISC_NEB => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => NULL ()
    Z_YDMF_PHYS_OUT_CT => NULL ()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFTS => NULL ()
    Z_YDMF_PHYS_OUT_FCHSP => NULL ()
    Z_YDMF_PHYS_OUT_FCLL => NULL ()
    Z_YDMF_PHYS_OUT_FCLN => NULL ()
    Z_YDMF_PHYS_OUT_FCS => NULL ()
    Z_YDMF_PHYS_OUT_FEVL => NULL ()
    Z_YDMF_PHYS_OUT_FEVN => NULL ()
    Z_YDMF_PHYS_OUT_FEVV => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FTR => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PQSH => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_SURFACE_PARALLEL:LMSE_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => GET_DEVICE_DATA_RDWR (YD_PALPHA1)
    PCDROV => GET_DEVICE_DATA_RDONLY (YD_PCDROV)
    PCEROV => GET_DEVICE_DATA_RDONLY (YD_PCEROV)
    PCFAU => GET_DEVICE_DATA_RDONLY (YD_PCFAU)
    PCFBU => GET_DEVICE_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_DEVICE_DATA_RDWR (YD_PCFBV)
    PCHROV => GET_DEVICE_DATA_RDONLY (YD_PCHROV)
    PCOEFA => GET_DEVICE_DATA_RDWR (YD_PCOEFA)
    PCP => GET_DEVICE_DATA_RDONLY (YD_PCP)
    PDIFWQ => GET_DEVICE_DATA_RDWR (YD_PDIFWQ)
    PDIFWS => GET_DEVICE_DATA_RDWR (YD_PDIFWS)
    PDQSTS => GET_DEVICE_DATA_RDONLY (YD_PDQSTS)
    PDSA_CPS => GET_DEVICE_DATA_RDONLY (YD_PDSA_CPS)
    PDSA_LHS => GET_DEVICE_DATA_RDWR (YD_PDSA_LHS)
    PFLU_CD => GET_DEVICE_DATA_RDONLY (YD_PFLU_CD)
    PFLU_CDN => GET_DEVICE_DATA_RDONLY (YD_PFLU_CDN)
    PFLU_EMIS => GET_DEVICE_DATA_RDONLY (YD_PFLU_EMIS)
    PFLU_FEVI => GET_DEVICE_DATA_RDWR (YD_PFLU_FEVI)
    PFLU_NEIJ => GET_DEVICE_DATA_RDONLY (YD_PFLU_NEIJ)
    PFLU_QSATS => GET_DEVICE_DATA_RDONLY (YD_PFLU_QSATS)
    PFLU_VEG => GET_DEVICE_DATA_RDONLY (YD_PFLU_VEG)
    PHQ => GET_DEVICE_DATA_RDONLY (YD_PHQ)
    PHTR => GET_DEVICE_DATA_RDONLY (YD_PHTR)
    PHU => GET_DEVICE_DATA_RDONLY (YD_PHU)
    PLVT => GET_DEVICE_DATA_RDWR (YD_PLVT)
    PNEBCH => GET_DEVICE_DATA_RDONLY (YD_PNEBCH)
    PNEBDIFF => GET_DEVICE_DATA_RDWR (YD_PNEBDIFF)
    PNEBS => GET_DEVICE_DATA_RDONLY (YD_PNEBS)
    PQI => GET_DEVICE_DATA_RDONLY (YD_PQI)
    PQICE => GET_DEVICE_DATA_RDWR (YD_PQICE)
    PQL => GET_DEVICE_DATA_RDONLY (YD_PQL)
    PQV => GET_DEVICE_DATA_RDONLY (YD_PQV)
    PSC_FCLL => GET_DEVICE_DATA_RDWR (YD_PSC_FCLL)
    PSC_FCLN => GET_DEVICE_DATA_RDWR (YD_PSC_FCLN)
    PSC_FEVI => GET_DEVICE_DATA_RDWR (YD_PSC_FEVI)
    PSC_FEVN => GET_DEVICE_DATA_RDWR (YD_PSC_FEVN)
    PXDROV => GET_DEVICE_DATA_RDONLY (YD_PXDROV)
    PXHROV => GET_DEVICE_DATA_RDONLY (YD_PXHROV)
    PXQRO => GET_DEVICE_DATA_RDONLY (YD_PXQRO)
    PXTRO => GET_DEVICE_DATA_RDONLY (YD_PXTRO)
    PXURO => GET_DEVICE_DATA_RDONLY (YD_PXURO)
    ZCFAS => GET_DEVICE_DATA_RDONLY (YL_ZCFAS)
    ZCFBQ => GET_DEVICE_DATA_RDWR (YL_ZCFBQ)
    ZCFBQ_G => GET_DEVICE_DATA_RDWR (YL_ZCFBQ_G)
    ZCFBS => GET_DEVICE_DATA_RDWR (YL_ZCFBS)
    ZCFBS_G => GET_DEVICE_DATA_RDWR (YL_ZCFBS_G)
    ZCFBU_G => GET_DEVICE_DATA_RDWR (YL_ZCFBU_G)
    ZCFBV_G => GET_DEVICE_DATA_RDWR (YL_ZCFBV_G)
    ZDSE => GET_DEVICE_DATA_RDONLY (YL_ZDSE)
    ZFMDU => GET_DEVICE_DATA_RDWR (YL_ZFMDU)
    ZFMDV => GET_DEVICE_DATA_RDWR (YL_ZFMDV)
    Z_YDCPG_MISC_NEB => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_T)
    Z_YDMF_PHYS_OUT_CT => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_CT)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCHSP => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCHSP)
    Z_YDMF_PHYS_OUT_FCLL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
    Z_YDMF_PHYS_OUT_FCLN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
    Z_YDMF_PHYS_OUT_FCS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    Z_YDMF_PHYS_OUT_FEVL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FEVV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FEVV)
    Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FTR => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FTR)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VH_PQSH => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_QSH)
    Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VH%F_SPSH)
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_HV)
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (PALPHA1, PCDROV, PCEROV, PCFAU, PCFBU, PCFBV, PCHROV, PCOEFA, PCP, PDIFWQ, &
      !$ACC&         PDIFWS, PDQSTS, PDSA_CPS, PDSA_LHS, PFLU_CD, PFLU_CDN, PFLU_EMIS, &
      !$ACC&         PFLU_FEVI, PFLU_NEIJ, PFLU_QSATS, PFLU_VEG, PHQ, PHTR, PHU, PLVT, PNEBCH, &
      !$ACC&         PNEBDIFF, PNEBS, PQI, PQICE, PQL, PQV, PSC_FCLL, PSC_FCLN, PSC_FEVI, &
      !$ACC&         PSC_FEVN, PXDROV, PXHROV, PXQRO, PXTRO, PXURO, YDCPG_OPTS, YDMODEL, &
      !$ACC&         YFXTRAN_ACDC_STACK, ZCFAS, ZCFBQ, ZCFBQ_G, ZCFBS, ZCFBS_G, ZCFBU_G, &
      !$ACC&         ZCFBV_G, ZDSE, ZFMDU, ZFMDV, Z_YDCPG_MISC_NEB, Z_YDCPG_MISC_QS, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T, Z_YDMF_PHYS_OUT_CT, Z_YDMF_PHYS_OUT_DIFTQ, &
      !$ACC&         Z_YDMF_PHYS_OUT_DIFTS, Z_YDMF_PHYS_OUT_FCHSP, Z_YDMF_PHYS_OUT_FCLL, &
      !$ACC&         Z_YDMF_PHYS_OUT_FCLN, Z_YDMF_PHYS_OUT_FCS, Z_YDMF_PHYS_OUT_FEVL, &
      !$ACC&         Z_YDMF_PHYS_OUT_FEVN, Z_YDMF_PHYS_OUT_FEVV, Z_YDMF_PHYS_OUT_FRSO, &
      !$ACC&         Z_YDMF_PHYS_OUT_FRTH, Z_YDMF_PHYS_OUT_FTR, Z_YDMF_PHYS_SURF_GSD_VF_PLSM, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VF_PZ0F, Z_YDMF_PHYS_SURF_GSD_VH_PQSH, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VH_PSPSH, Z_YDMF_PHYS_SURF_GSD_VV_PHV, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VV_PIVEG, Z_YDMF_PHYS_SURF_GSD_VV_PZ0H) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==5) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, PNEBDIFF (:,:, JBLK), PNEBS (:,:, JBLK))
        ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==2) THEN

          DO JLEV=1, YDCPG_OPTS%KFLEVG
            
            PNEBDIFF (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)
          
          ENDDO

        ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%NDIFFNEB==3) THEN
          PNEBDIFF (JLON,:, JBLK)=PNEBS (JLON,:, JBLK)+(1.0_JPRB-PNEBS (JLON,:, JBLK))*PNEBCH (JLON,:, JBLK)
        ENDIF


        IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZCFBS_G (:,:, JBLK), ZCFBS (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZCFBQ_G (:,:, JBLK), ZCFBQ (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZCFBU_G (:,:, JBLK), PCFBU (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZCFBV_G (:,:, JBLK), PCFBV (:,:, JBLK))
        ENDIF

        CALL ARP_GROUND_PARAM_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_AOC%YRMCC, YDMODEL%YRML_PHY_MF, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%YRSURF_DIMS&
        &%YSP_SBD%NLEVS, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), PCP(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
        &(:,:,:, JBLK), PQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PXURO(:,:, JBLK&
        &), PXQRO(:,:, JBLK), PXTRO(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), PQL(:,:,&
        & JBLK), PQI(:,:, JBLK), PNEBDIFF(:,:, JBLK), PFLU_CD(:, JBLK), PFLU_CDN(:, JBLK), PCDROV(:, JBLK),&
        & PCHROV(:, JBLK), PCEROV(:, JBLK), PDSA_CPS(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), PDQSTS(:, JBLK)&
        &, PFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PSPSH(:, JBLK), PHQ(:, JBLK), PHTR(:, JBLK), PHU(:, JBLK&
        &), Z_YDMF_PHYS_SURF_GSD_VV_PHV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG&
        &(:, JBLK), PFLU_NEIJ(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), PFLU_QSATS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), PFLU_VEG(:, JBLK), PXDROV(:, JBLK), PXHROV&
        &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), ZDSE&
        &(:,:, JBLK), ZCFAS(:,:, JBLK), PCFAU(:,:, JBLK), ZCFBS(:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK&
        &), ZCFBQ(:,:, JBLK), PCOEFA(:,:, JBLK), PALPHA1(:,:, JBLK), PLVT(:,:, JBLK), PQICE(:,:, JBLK), PDIFWQ&
        &(:, JBLK), PDIFWS(:, JBLK), ZFMDU(:, JBLK), ZFMDV(:, JBLK), PSC_FEVI(:, JBLK), PSC_FEVN(:, JBLK), PSC_FCLL&
        &(:, JBLK), PSC_FCLN(:, JBLK), Z_YDMF_PHYS_OUT_FCHSP(:,:, JBLK), Z_YDMF_PHYS_OUT_FCLL (:, 1, JBLK),&
        & Z_YDMF_PHYS_OUT_FCLN (:, 1, JBLK), Z_YDMF_PHYS_OUT_FCS (:, 1, JBLK), PFLU_FEVI (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVL&
        & (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVN (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVV(:, JBLK), Z_YDMF_PHYS_OUT_FTR&
        &(:, JBLK), PDSA_LHS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PQSH(:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK&
        &), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_DIFTQ (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PDIFWQ (JLON, JBLK)
        Z_YDMF_PHYS_OUT_DIFTS (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PDIFWS (JLON, JBLK)

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZCFBQ (:,:, JBLK), ZCFBQ_G (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZCFBS (:,:, JBLK), ZCFBS_G (:,:, JBLK))
          PCFBU (JLON, YDCPG_OPTS%KFLEVG, JBLK)=ZCFBU_G (JLON, YDCPG_OPTS%KFLEVG, JBLK)
          PCFBV (JLON, YDCPG_OPTS%KFLEVG, JBLK)=ZCFBV_G (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
      PCDROV => GET_HOST_DATA_RDWR (YD_PCDROV)
      PCEROV => GET_HOST_DATA_RDWR (YD_PCEROV)
      PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
      PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
      PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
      PCHROV => GET_HOST_DATA_RDWR (YD_PCHROV)
      PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
      PCP => GET_HOST_DATA_RDWR (YD_PCP)
      PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
      PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
      PDQSTS => GET_HOST_DATA_RDWR (YD_PDQSTS)
      PDSA_CPS => GET_HOST_DATA_RDWR (YD_PDSA_CPS)
      PDSA_LHS => GET_HOST_DATA_RDWR (YD_PDSA_LHS)
      PFLU_CD => GET_HOST_DATA_RDWR (YD_PFLU_CD)
      PFLU_CDN => GET_HOST_DATA_RDWR (YD_PFLU_CDN)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PFLU_FEVI => GET_HOST_DATA_RDWR (YD_PFLU_FEVI)
      PFLU_NEIJ => GET_HOST_DATA_RDWR (YD_PFLU_NEIJ)
      PFLU_QSATS => GET_HOST_DATA_RDWR (YD_PFLU_QSATS)
      PFLU_VEG => GET_HOST_DATA_RDWR (YD_PFLU_VEG)
      PHQ => GET_HOST_DATA_RDWR (YD_PHQ)
      PHTR => GET_HOST_DATA_RDWR (YD_PHTR)
      PHU => GET_HOST_DATA_RDWR (YD_PHU)
      PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
      PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
      PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
      PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
      PQI => GET_HOST_DATA_RDWR (YD_PQI)
      PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
      PQL => GET_HOST_DATA_RDWR (YD_PQL)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
      PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
      PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
      PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
      PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
      PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
      PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
      PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
      PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
      ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
      ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
      ZCFBQ_G => GET_HOST_DATA_RDWR (YL_ZCFBQ_G)
      ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
      ZCFBS_G => GET_HOST_DATA_RDWR (YL_ZCFBS_G)
      ZCFBU_G => GET_HOST_DATA_RDWR (YL_ZCFBU_G)
      ZCFBV_G => GET_HOST_DATA_RDWR (YL_ZCFBV_G)
      ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
      ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
      ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_T)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
      Z_YDMF_PHYS_OUT_FCHSP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCHSP)
      Z_YDMF_PHYS_OUT_FCLL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLL)
      Z_YDMF_PHYS_OUT_FCLN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCLN)
      Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_OUT_FEVV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVV)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FTR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FTR)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VH_PQSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_QSH)
      Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_SPSH)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => NULL ()
    PCDROV => NULL ()
    PCEROV => NULL ()
    PCFAU => NULL ()
    PCFBU => NULL ()
    PCFBV => NULL ()
    PCHROV => NULL ()
    PCOEFA => NULL ()
    PCP => NULL ()
    PDIFWQ => NULL ()
    PDIFWS => NULL ()
    PDQSTS => NULL ()
    PDSA_CPS => NULL ()
    PDSA_LHS => NULL ()
    PFLU_CD => NULL ()
    PFLU_CDN => NULL ()
    PFLU_EMIS => NULL ()
    PFLU_FEVI => NULL ()
    PFLU_NEIJ => NULL ()
    PFLU_QSATS => NULL ()
    PFLU_VEG => NULL ()
    PHQ => NULL ()
    PHTR => NULL ()
    PHU => NULL ()
    PLVT => NULL ()
    PNEBCH => NULL ()
    PNEBDIFF => NULL ()
    PNEBS => NULL ()
    PQI => NULL ()
    PQICE => NULL ()
    PQL => NULL ()
    PQV => NULL ()
    PSC_FCLL => NULL ()
    PSC_FCLN => NULL ()
    PSC_FEVI => NULL ()
    PSC_FEVN => NULL ()
    PXDROV => NULL ()
    PXHROV => NULL ()
    PXQRO => NULL ()
    PXTRO => NULL ()
    PXURO => NULL ()
    ZCFAS => NULL ()
    ZCFBQ => NULL ()
    ZCFBQ_G => NULL ()
    ZCFBS => NULL ()
    ZCFBS_G => NULL ()
    ZCFBU_G => NULL ()
    ZCFBV_G => NULL ()
    ZDSE => NULL ()
    ZFMDU => NULL ()
    ZFMDV => NULL ()
    Z_YDCPG_MISC_NEB => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_T => NULL ()
    Z_YDMF_PHYS_OUT_CT => NULL ()
    Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFTS => NULL ()
    Z_YDMF_PHYS_OUT_FCHSP => NULL ()
    Z_YDMF_PHYS_OUT_FCLL => NULL ()
    Z_YDMF_PHYS_OUT_FCLN => NULL ()
    Z_YDMF_PHYS_OUT_FCS => NULL ()
    Z_YDMF_PHYS_OUT_FEVL => NULL ()
    Z_YDMF_PHYS_OUT_FEVN => NULL ()
    Z_YDMF_PHYS_OUT_FEVV => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FTR => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PQSH => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PSPSH => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_SURFACE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F',1,ZHOOK_HANDLE_PARALLEL)
ELSEIF (.NOT.YDCPG_OPTS%LCALLSFX) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JSG) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JSG=1, YDCPG_OPTS%KTSSG+1
        Z_YDMF_PHYS_OUT_FCS (:, JSG, JBLK)=0.0_JPRB
      ENDDO

      ZFEV (:, JBLK)=0.0_JPRB
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
      Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZFEV => NULL ()
    Z_YDMF_PHYS_OUT_FCS => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
    &','APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, JSG, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        DO JSG=1, YDCPG_OPTS%KTSSG+1
          Z_YDMF_PHYS_OUT_FCS (JLON, JSG, JBLK)=0.0_JPRB
        ENDDO

        ZFEV (JLON, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
      Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZFEV => NULL ()
    Z_YDMF_PHYS_OUT_FCS => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZFEV => GET_DEVICE_DATA_RDWR (YL_ZFEV)
    Z_YDMF_PHYS_OUT_FCS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZFEV, Z_YDMF_PHYS_OUT_FCS) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, JSG, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        DO JSG=1, YDCPG_OPTS%KTSSG+1
          Z_YDMF_PHYS_OUT_FCS (JLON, JSG, JBLK)=0.0_JPRB
        ENDDO

        ZFEV (JLON, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
      Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZFEV => NULL ()
    Z_YDMF_PHYS_OUT_FCS => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_SURFACE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:CALLSFX_F',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PALPHA1 => GET_HOST_DATA_RDONLY (YD_PALPHA1)
  PCFAU => GET_HOST_DATA_RDONLY (YD_PCFAU)
  PCFBU => GET_HOST_DATA_RDONLY (YD_PCFBU)
  PCFBV => GET_HOST_DATA_RDONLY (YD_PCFBV)
  PCOEFA => GET_HOST_DATA_RDONLY (YD_PCOEFA)
  PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
  PKQLROV => GET_HOST_DATA_RDONLY (YD_PKQLROV)
  PKQROV => GET_HOST_DATA_RDONLY (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDONLY (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDONLY (YD_PKUROV)
  PLVT => GET_HOST_DATA_RDONLY (YD_PLVT)
  PPOID => GET_HOST_DATA_RDONLY (YD_PPOID)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQICE => GET_HOST_DATA_RDONLY (YD_PQICE)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PTSN => GET_HOST_DATA_RDONLY (YD_PTSN)
  PXHROV => GET_HOST_DATA_RDONLY (YD_PXHROV)
  ZCFAQ => GET_HOST_DATA_RDONLY (YL_ZCFAQ)
  ZCFAS => GET_HOST_DATA_RDONLY (YL_ZCFAS)
  ZCFASV => GET_HOST_DATA_RDONLY (YL_ZCFASV)
  ZCFBQ => GET_HOST_DATA_RDONLY (YL_ZCFBQ)
  ZCFBS => GET_HOST_DATA_RDONLY (YL_ZCFBS)
  ZCFBSV => GET_HOST_DATA_RDONLY (YL_ZCFBSV)
  ZDSE => GET_HOST_DATA_RDONLY (YL_ZDSE)
  ZFEV => GET_HOST_DATA_RDONLY (YL_ZFEV)
  ZFMDU => GET_HOST_DATA_RDONLY (YL_ZFMDU)
  ZFMDV => GET_HOST_DATA_RDONLY (YL_ZFMDV)
  ZQT => GET_HOST_DATA_RDONLY (YL_ZQT)
  ZSFSV => GET_HOST_DATA_RDONLY (YL_ZSFSV)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCS)
  Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
  Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
  Z_YDVARS_SHTUR_T0 => GET_HOST_DATA_RDWR (YDVARS%SHTUR%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL ACDIFV2 (YDCPG_OPTS%LSFORCS, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_MF, YLCPG_BNDS&
    &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, 0, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
    &(:,:, JBLK), ZCFAQ(:,:, JBLK), ZCFAS(:,:, JBLK), PCFAU(:,:, JBLK), ZCFASV(:,:,:, JBLK), ZCFBQ(:,&
    &:, JBLK), ZCFBS(:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK), ZCFBSV(:,:,:, JBLK), PKTROV(:,:,&
    & JBLK), PKQROV(:,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), ZDSE(:,:, JBLK), ZQT(:,:, JBLK&
    &), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PPOID(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
    &(:,:, JBLK), PQL(:,:, JBLK), PQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK&
    &), PCOEFA(:,:, JBLK), PALPHA1(:,:, JBLK), PLVT(:,:, JBLK), PQICE(:,:, JBLK), ZSFSV(:,:, JBLK), Z_YDMF_PHYS_OUT_FCS&
    & (:, 1, JBLK), ZFEV(:, JBLK), ZFMDU(:, JBLK), ZFMDV(:, JBLK), PTSN(:, JBLK), PXHROV(:, JBLK), PDIFEXT&
    &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTU&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTV(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), Z_YDVARS_SHTUR_T0(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
    ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
    ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
    ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
    ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
    ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
    ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
    ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
    ZSFSV => GET_HOST_DATA_RDWR (YL_ZSFSV)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    Z_YDVARS_SHTUR_T0 => GET_HOST_DATA_RDWR (YDVARS%SHTUR%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PALPHA1 => NULL ()
  PCFAU => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCOEFA => NULL ()
  PDIFEXT => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PLVT => NULL ()
  PPOID => NULL ()
  PQI => NULL ()
  PQICE => NULL ()
  PQL => NULL ()
  PTSN => NULL ()
  PXHROV => NULL ()
  ZCFAQ => NULL ()
  ZCFAS => NULL ()
  ZCFASV => NULL ()
  ZCFBQ => NULL ()
  ZCFBS => NULL ()
  ZCFBSV => NULL ()
  ZDSE => NULL ()
  ZFEV => NULL ()
  ZFMDU => NULL ()
  ZFMDV => NULL ()
  ZQT => NULL ()
  ZSFSV => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCS => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  Z_YDVARS_SHTUR_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PALPHA1 => GET_HOST_DATA_RDONLY (YD_PALPHA1)
  PCFAU => GET_HOST_DATA_RDONLY (YD_PCFAU)
  PCFBU => GET_HOST_DATA_RDONLY (YD_PCFBU)
  PCFBV => GET_HOST_DATA_RDONLY (YD_PCFBV)
  PCOEFA => GET_HOST_DATA_RDONLY (YD_PCOEFA)
  PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
  PKQLROV => GET_HOST_DATA_RDONLY (YD_PKQLROV)
  PKQROV => GET_HOST_DATA_RDONLY (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDONLY (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDONLY (YD_PKUROV)
  PLVT => GET_HOST_DATA_RDONLY (YD_PLVT)
  PPOID => GET_HOST_DATA_RDONLY (YD_PPOID)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQICE => GET_HOST_DATA_RDONLY (YD_PQICE)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PTSN => GET_HOST_DATA_RDONLY (YD_PTSN)
  PXHROV => GET_HOST_DATA_RDONLY (YD_PXHROV)
  ZCFAQ => GET_HOST_DATA_RDONLY (YL_ZCFAQ)
  ZCFAS => GET_HOST_DATA_RDONLY (YL_ZCFAS)
  ZCFASV => GET_HOST_DATA_RDONLY (YL_ZCFASV)
  ZCFBQ => GET_HOST_DATA_RDONLY (YL_ZCFBQ)
  ZCFBS => GET_HOST_DATA_RDONLY (YL_ZCFBS)
  ZCFBSV => GET_HOST_DATA_RDONLY (YL_ZCFBSV)
  ZDSE => GET_HOST_DATA_RDONLY (YL_ZDSE)
  ZFEV => GET_HOST_DATA_RDONLY (YL_ZFEV)
  ZFMDU => GET_HOST_DATA_RDONLY (YL_ZFMDU)
  ZFMDV => GET_HOST_DATA_RDONLY (YL_ZFMDV)
  ZQT => GET_HOST_DATA_RDONLY (YL_ZQT)
  ZSFSV => GET_HOST_DATA_RDONLY (YL_ZSFSV)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCS)
  Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
  Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
  Z_YDVARS_SHTUR_T0 => GET_HOST_DATA_RDWR (YDVARS%SHTUR%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACDIFV2_OPENACC (YDCPG_OPTS%LSFORCS, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_MF&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, 0, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(:,:, JBLK), ZCFAQ(:,:, JBLK), ZCFAS(:,:, JBLK), PCFAU(:,:, JBLK), ZCFASV(:,:,:, JBLK), ZCFBQ(:,:&
      &, JBLK), ZCFBS(:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK), ZCFBSV(:,:,:, JBLK), PKTROV(:,:, JBLK&
      &), PKQROV(:,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), ZDSE(:,:, JBLK), ZQT(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PPOID(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:,&
      & JBLK), PQL(:,:, JBLK), PQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), PCOEFA&
      &(:,:, JBLK), PALPHA1(:,:, JBLK), PLVT(:,:, JBLK), PQICE(:,:, JBLK), ZSFSV(:,:, JBLK), Z_YDMF_PHYS_OUT_FCS&
      & (:, 1, JBLK), ZFEV(:, JBLK), ZFMDU(:, JBLK), ZFMDV(:, JBLK), PTSN(:, JBLK), PXHROV(:, JBLK), PDIFEXT&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTV(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), Z_YDVARS_SHTUR_T0(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
    ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
    ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
    ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
    ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
    ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
    ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
    ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
    ZSFSV => GET_HOST_DATA_RDWR (YL_ZSFSV)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    Z_YDVARS_SHTUR_T0 => GET_HOST_DATA_RDWR (YDVARS%SHTUR%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PALPHA1 => NULL ()
  PCFAU => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCOEFA => NULL ()
  PDIFEXT => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PLVT => NULL ()
  PPOID => NULL ()
  PQI => NULL ()
  PQICE => NULL ()
  PQL => NULL ()
  PTSN => NULL ()
  PXHROV => NULL ()
  ZCFAQ => NULL ()
  ZCFAS => NULL ()
  ZCFASV => NULL ()
  ZCFBQ => NULL ()
  ZCFBS => NULL ()
  ZCFBSV => NULL ()
  ZDSE => NULL ()
  ZFEV => NULL ()
  ZFMDU => NULL ()
  ZFMDV => NULL ()
  ZQT => NULL ()
  ZSFSV => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCS => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  Z_YDVARS_SHTUR_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PALPHA1 => GET_DEVICE_DATA_RDONLY (YD_PALPHA1)
  PCFAU => GET_DEVICE_DATA_RDONLY (YD_PCFAU)
  PCFBU => GET_DEVICE_DATA_RDONLY (YD_PCFBU)
  PCFBV => GET_DEVICE_DATA_RDONLY (YD_PCFBV)
  PCOEFA => GET_DEVICE_DATA_RDONLY (YD_PCOEFA)
  PDIFEXT => GET_DEVICE_DATA_RDWR (YD_PDIFEXT)
  PKQLROV => GET_DEVICE_DATA_RDONLY (YD_PKQLROV)
  PKQROV => GET_DEVICE_DATA_RDONLY (YD_PKQROV)
  PKTROV => GET_DEVICE_DATA_RDONLY (YD_PKTROV)
  PKUROV => GET_DEVICE_DATA_RDONLY (YD_PKUROV)
  PLVT => GET_DEVICE_DATA_RDONLY (YD_PLVT)
  PPOID => GET_DEVICE_DATA_RDONLY (YD_PPOID)
  PQI => GET_DEVICE_DATA_RDONLY (YD_PQI)
  PQICE => GET_DEVICE_DATA_RDONLY (YD_PQICE)
  PQL => GET_DEVICE_DATA_RDONLY (YD_PQL)
  PTSN => GET_DEVICE_DATA_RDONLY (YD_PTSN)
  PXHROV => GET_DEVICE_DATA_RDONLY (YD_PXHROV)
  ZCFAQ => GET_DEVICE_DATA_RDONLY (YL_ZCFAQ)
  ZCFAS => GET_DEVICE_DATA_RDONLY (YL_ZCFAS)
  ZCFASV => GET_DEVICE_DATA_RDONLY (YL_ZCFASV)
  ZCFBQ => GET_DEVICE_DATA_RDONLY (YL_ZCFBQ)
  ZCFBS => GET_DEVICE_DATA_RDONLY (YL_ZCFBS)
  ZCFBSV => GET_DEVICE_DATA_RDONLY (YL_ZCFBSV)
  ZDSE => GET_DEVICE_DATA_RDONLY (YL_ZDSE)
  ZFEV => GET_DEVICE_DATA_RDONLY (YL_ZFEV)
  ZFMDU => GET_DEVICE_DATA_RDONLY (YL_ZFMDU)
  ZFMDV => GET_DEVICE_DATA_RDONLY (YL_ZFMDV)
  ZQT => GET_DEVICE_DATA_RDONLY (YL_ZQT)
  ZSFSV => GET_DEVICE_DATA_RDONLY (YL_ZSFSV)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCS)
  Z_YDMF_PHYS_OUT_STRCU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
  Z_YDMF_PHYS_OUT_STRTU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
  Z_YDVARS_SHTUR_T0 => GET_DEVICE_DATA_RDWR (YDVARS%SHTUR%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PALPHA1, PCFAU, PCFBU, PCFBV, PCOEFA, PDIFEXT, PKQLROV, PKQROV, PKTROV, &
    !$ACC&         PKUROV, PLVT, PPOID, PQI, PQICE, PQL, PTSN, PXHROV, YDCPG_OPTS, YDMODEL, &
    !$ACC&         YFXTRAN_ACDC_STACK, ZCFAQ, ZCFAS, ZCFASV, ZCFBQ, ZCFBS, ZCFBSV, ZDSE, &
    !$ACC&         ZFEV, ZFMDU, ZFMDV, ZQT, ZSFSV, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, Z_YDMF_PHYS_OUT_DIFCQ, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFCS, Z_YDMF_PHYS_OUT_DIFTQ, Z_YDMF_PHYS_OUT_DIFTQL, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFTQN, Z_YDMF_PHYS_OUT_DIFTS, Z_YDMF_PHYS_OUT_FCS, &
    !$ACC&         Z_YDMF_PHYS_OUT_STRCU, Z_YDMF_PHYS_OUT_STRCV, Z_YDMF_PHYS_OUT_STRTU, &
    !$ACC&         Z_YDMF_PHYS_OUT_STRTV, Z_YDVARS_SHTUR_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACDIFV2_OPENACC (YDCPG_OPTS%LSFORCS, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_MF&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, 0, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(:,:, JBLK), ZCFAQ(:,:, JBLK), ZCFAS(:,:, JBLK), PCFAU(:,:, JBLK), ZCFASV(:,:,:, JBLK), ZCFBQ(:,:&
      &, JBLK), ZCFBS(:,:, JBLK), PCFBU(:,:, JBLK), PCFBV(:,:, JBLK), ZCFBSV(:,:,:, JBLK), PKTROV(:,:, JBLK&
      &), PKQROV(:,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), ZDSE(:,:, JBLK), ZQT(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PPOID(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:,&
      & JBLK), PQL(:,:, JBLK), PQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), PCOEFA&
      &(:,:, JBLK), PALPHA1(:,:, JBLK), PLVT(:,:, JBLK), PQICE(:,:, JBLK), ZSFSV(:,:, JBLK), Z_YDMF_PHYS_OUT_FCS&
      & (:, 1, JBLK), ZFEV(:, JBLK), ZFMDU(:, JBLK), ZFMDV(:, JBLK), PTSN(:, JBLK), PXHROV(:, JBLK), PDIFEXT&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTV(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), Z_YDVARS_SHTUR_T0(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    ZCFAQ => GET_HOST_DATA_RDWR (YL_ZCFAQ)
    ZCFAS => GET_HOST_DATA_RDWR (YL_ZCFAS)
    ZCFASV => GET_HOST_DATA_RDWR (YL_ZCFASV)
    ZCFBQ => GET_HOST_DATA_RDWR (YL_ZCFBQ)
    ZCFBS => GET_HOST_DATA_RDWR (YL_ZCFBS)
    ZCFBSV => GET_HOST_DATA_RDWR (YL_ZCFBSV)
    ZDSE => GET_HOST_DATA_RDWR (YL_ZDSE)
    ZFEV => GET_HOST_DATA_RDWR (YL_ZFEV)
    ZFMDU => GET_HOST_DATA_RDWR (YL_ZFMDU)
    ZFMDV => GET_HOST_DATA_RDWR (YL_ZFMDV)
    ZQT => GET_HOST_DATA_RDWR (YL_ZQT)
    ZSFSV => GET_HOST_DATA_RDWR (YL_ZSFSV)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCS)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    Z_YDVARS_SHTUR_T0 => GET_HOST_DATA_RDWR (YDVARS%SHTUR%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PALPHA1 => NULL ()
  PCFAU => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCOEFA => NULL ()
  PDIFEXT => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PLVT => NULL ()
  PPOID => NULL ()
  PQI => NULL ()
  PQICE => NULL ()
  PQL => NULL ()
  PTSN => NULL ()
  PXHROV => NULL ()
  ZCFAQ => NULL ()
  ZCFAS => NULL ()
  ZCFASV => NULL ()
  ZCFBQ => NULL ()
  ZCFBS => NULL ()
  ZCFBSV => NULL ()
  ZDSE => NULL ()
  ZFEV => NULL ()
  ZFMDU => NULL ()
  ZFMDV => NULL ()
  ZQT => NULL ()
  ZSFSV => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCS => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  Z_YDVARS_SHTUR_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_SURFACE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:ACDIFV2',1,ZHOOK_HANDLE_PARALLEL)

IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDKF) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_SURFACE_PARALLEL:LEDKF')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_SFL%F_GROUP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP (JLON, 1, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP (JLON, 2, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
      Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_SFL%F_GROUP)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFTS => NULL ()
    Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_SURFACE_PARALLEL:LEDKF')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_SFL%F_GROUP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        
        Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP (JLON, 1, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP (JLON, 2, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK)
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
      Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_SFL%F_GROUP)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFTS => NULL ()
    Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_SURFACE_PARALLEL:LEDKF')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_SFL%F_GROUP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_OUT_DIFTQ, Z_YDMF_PHYS_OUT_DIFTS, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        
        Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP (JLON, 1, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP (JLON, 2, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
        & (JLON, YDCPG_OPTS%KFLEVG, JBLK)
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
      Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
      Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_SFL%F_GROUP)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFTS => NULL ()
    Z_YDMF_PHYS_SURF_GSD_SFL_PGROUP => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_SURFACE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LEDKF',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PTSN => GET_HOST_DATA_RDONLY (YD_PTSN)
    ZTWSNOW => GET_HOST_DATA_RDONLY (YL_ZTWSNOW)
    Z_YDCPG_GPAR_VTS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VTS)
    Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_F_T1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDCPG_GPAR_VTS (JLON, JBLK)=PTSN (JLON, JBLK)
        Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 (JLON, 1, JBLK)=ZTWSNOW (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
      ZTWSNOW => GET_HOST_DATA_RDWR (YL_ZTWSNOW)
      Z_YDCPG_GPAR_VTS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VTS)
      Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_F_T1)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PTSN => NULL ()
    ZTWSNOW => NULL ()
    Z_YDCPG_GPAR_VTS => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
    &','APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PTSN => GET_HOST_DATA_RDONLY (YD_PTSN)
    ZTWSNOW => GET_HOST_DATA_RDONLY (YL_ZTWSNOW)
    Z_YDCPG_GPAR_VTS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VTS)
    Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_F_T1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        
        Z_YDCPG_GPAR_VTS (JLON, JBLK)=PTSN (JLON, JBLK)
        Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 (JLON, 1, JBLK)=ZTWSNOW (JLON, JBLK)
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
      ZTWSNOW => GET_HOST_DATA_RDWR (YL_ZTWSNOW)
      Z_YDCPG_GPAR_VTS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VTS)
      Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_F_T1)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PTSN => NULL ()
    ZTWSNOW => NULL ()
    Z_YDCPG_GPAR_VTS => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PTSN => GET_DEVICE_DATA_RDONLY (YD_PTSN)
    ZTWSNOW => GET_DEVICE_DATA_RDONLY (YL_ZTWSNOW)
    Z_YDCPG_GPAR_VTS => GET_DEVICE_DATA_RDWR (YDCPG_GPAR%F_VTS)
    Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_F_T1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (PTSN, YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZTWSNOW, Z_YDCPG_GPAR_VTS, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSP_SG_PF_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        
        Z_YDCPG_GPAR_VTS (JLON, JBLK)=PTSN (JLON, JBLK)
        Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 (JLON, 1, JBLK)=ZTWSNOW (JLON, JBLK)
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PTSN => GET_HOST_DATA_RDWR (YD_PTSN)
      ZTWSNOW => GET_HOST_DATA_RDWR (YL_ZTWSNOW)
      Z_YDCPG_GPAR_VTS => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_VTS)
      Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_SG%F_F_T1)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PTSN => NULL ()
    ZTWSNOW => NULL ()
    Z_YDCPG_GPAR_VTS => NULL ()
    Z_YDMF_PHYS_SURF_GSP_SG_PF_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_SURFACE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL:LMSE_F2',1,ZHOOK_HANDLE_PARALLEL)
ENDIF




CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZBUDSO)) CALL FIELD_DELETE (YL_ZBUDSO)
IF (ASSOCIATED (YL_ZBUDTH)) CALL FIELD_DELETE (YL_ZBUDTH)
IF (ASSOCIATED (YL_ZCD)) CALL FIELD_DELETE (YL_ZCD)
IF (ASSOCIATED (YL_ZCFAQ)) CALL FIELD_DELETE (YL_ZCFAQ)
IF (ASSOCIATED (YL_ZCFAS)) CALL FIELD_DELETE (YL_ZCFAS)
IF (ASSOCIATED (YL_ZCFASV)) CALL FIELD_DELETE (YL_ZCFASV)
IF (ASSOCIATED (YL_ZCFBQ)) CALL FIELD_DELETE (YL_ZCFBQ)
IF (ASSOCIATED (YL_ZCFBQ_G)) CALL FIELD_DELETE (YL_ZCFBQ_G)
IF (ASSOCIATED (YL_ZCFBS)) CALL FIELD_DELETE (YL_ZCFBS)
IF (ASSOCIATED (YL_ZCFBSV)) CALL FIELD_DELETE (YL_ZCFBSV)
IF (ASSOCIATED (YL_ZCFBS_G)) CALL FIELD_DELETE (YL_ZCFBS_G)
IF (ASSOCIATED (YL_ZCFBU_G)) CALL FIELD_DELETE (YL_ZCFBU_G)
IF (ASSOCIATED (YL_ZCFBV_G)) CALL FIELD_DELETE (YL_ZCFBV_G)
IF (ASSOCIATED (YL_ZCH)) CALL FIELD_DELETE (YL_ZCH)
IF (ASSOCIATED (YL_ZDEPTH_HEIGHT)) CALL FIELD_DELETE (YL_ZDEPTH_HEIGHT)
IF (ASSOCIATED (YL_ZDSE)) CALL FIELD_DELETE (YL_ZDSE)
IF (ASSOCIATED (YL_ZDUMMY)) CALL FIELD_DELETE (YL_ZDUMMY)
IF (ASSOCIATED (YL_ZFCLL)) CALL FIELD_DELETE (YL_ZFCLL)
IF (ASSOCIATED (YL_ZFEV)) CALL FIELD_DELETE (YL_ZFEV)
IF (ASSOCIATED (YL_ZFEVS)) CALL FIELD_DELETE (YL_ZFEVS)
IF (ASSOCIATED (YL_ZFMDU)) CALL FIELD_DELETE (YL_ZFMDU)
IF (ASSOCIATED (YL_ZFMDV)) CALL FIELD_DELETE (YL_ZFMDV)
IF (ASSOCIATED (YL_ZHV2)) CALL FIELD_DELETE (YL_ZHV2)
IF (ASSOCIATED (YL_ZQT)) CALL FIELD_DELETE (YL_ZQT)
IF (ASSOCIATED (YL_ZRHODREFM)) CALL FIELD_DELETE (YL_ZRHODREFM)
IF (ASSOCIATED (YL_ZSFCO2)) CALL FIELD_DELETE (YL_ZSFCO2)
IF (ASSOCIATED (YL_ZSFSV)) CALL FIELD_DELETE (YL_ZSFSV)
IF (ASSOCIATED (YL_ZSSO_STDEV)) CALL FIELD_DELETE (YL_ZSSO_STDEV)
IF (ASSOCIATED (YL_ZSVM)) CALL FIELD_DELETE (YL_ZSVM)
IF (ASSOCIATED (YL_ZTOWNS)) CALL FIELD_DELETE (YL_ZTOWNS)
IF (ASSOCIATED (YL_ZTWSNOW)) CALL FIELD_DELETE (YL_ZTWSNOW)
IF (ASSOCIATED (YL_ZZS)) CALL FIELD_DELETE (YL_ZZS)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SURFACE_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_SURFACE_PARALLEL
