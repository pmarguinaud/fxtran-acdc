MODULE UTIL_TCHEM_MOD

USE YOMCHEM, ONLY : TCHEM

INTERFACE SAVE
MODULE PROCEDURE SAVE_TCHEM
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TCHEM
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TCHEM
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TCHEM
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TCHEM
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TCHEM
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TCHEM
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TCHEM (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TCHEM), INTENT (IN), TARGET :: YD
LOGICAL :: LTCO2DG, LTCOTOP
WRITE (KLUN) YD%CHEM_SCHEME
WRITE (KLUN) YD%LCHEM_DIAC
WRITE (KLUN) YD%LCHEM_BASCOE_JON
WRITE (KLUN) YD%LCHEM_BASCOE_HETCHEM
WRITE (KLUN) YD%LCHEM_EXTENDJNO2
WRITE (KLUN) YD%LMOZART_RSF_DUMMY
WRITE (KLUN) YD%LCHEM_JOUT
WRITE (KLUN) YD%LCHEM_LIGHT
WRITE (KLUN) YD%RCHEM_LINOX_SCALING
WRITE (KLUN) YD%LCHEM_ACNOX
WRITE (KLUN) YD%KCHEM_NOXADV
WRITE (KLUN) YD%KCHEM_WETDEP
WRITE (KLUN) YD%KCHEM_DRYDEP
WRITE (KLUN) YD%LCHEM_REVCHEM
WRITE (KLUN) YD%LCHEM_STMA
WRITE (KLUN) YD%LCHEM_ANAO3
WRITE (KLUN) YD%SMASSCOR
WRITE (KLUN) YD%LCHEM_0NOX
WRITE (KLUN) YD%LCHEM_ANACH4
WRITE (KLUN) YD%LCHEM_WEAK_CH4_RELAXATION
WRITE (KLUN) YD%LCHEM_CONVSCAV
WRITE (KLUN) YD%LCHEM_CSHAPE
WRITE (KLUN) YD%LCHEM_CSHAPE98
WRITE (KLUN) YD%LCHEM_WDFR
WRITE (KLUN) YD%LCHEM_HTAP
WRITE (KLUN) YD%KCHEM_YEARPI
WRITE (KLUN) YD%RCH4CONST
WRITE (KLUN) YD%KCHEM_SOLVE
WRITE (KLUN) YD%LCHEM_O3RAD
WRITE (KLUN) YD%LCHEM_TL
WRITE (KLUN) YD%LCHEM_AEROI
WRITE (KLUN) YD%IEXTR_FREE
WRITE (KLUN) YD%NUCOCH1
WRITE (KLUN) YD%NUCOCH2
WRITE (KLUN) YD%NCHEM_LCOCOEF
WRITE (KLUN) YD%CHEM_LCOVERS
WRITE (KLUN) YD%LCHEM_LCOMESO
WRITE (KLUN) YD%LCHEM_LCOCSTCLIM
WRITE (KLUN) YD%RCHEM_LCOTAUTOP
WRITE (KLUN) YD%RCHEM_LCOCLIMTOP
WRITE (KLUN) YD%LCHEM_LCOLIMIT
WRITE (KLUN) YD%RCHEM_LCOCOEFA1
WRITE (KLUN) YD%CSOLMET_ASIS
WRITE (KLUN) YD%M_SOLITER_ASIS
WRITE (KLUN) YD%SOLCV_ASIS
WRITE (KLUN) YD%RTOL_ASIS
WRITE (KLUN) YD%ATOL_ASIS
WRITE (KLUN) YD%N_F_RTOL_ASIS
WRITE (KLUN) YD%N_F_ATOL_ASIS
LTCO2DG = ALLOCATED (YD%TCO2DG)
WRITE (KLUN) LTCO2DG
IF (LTCO2DG) THEN
  WRITE (KLUN) LBOUND (YD%TCO2DG)
  WRITE (KLUN) UBOUND (YD%TCO2DG)
  WRITE (KLUN) YD%TCO2DG
ENDIF
LTCOTOP = ALLOCATED (YD%TCOTOP)
WRITE (KLUN) LTCOTOP
IF (LTCOTOP) THEN
  WRITE (KLUN) LBOUND (YD%TCOTOP)
  WRITE (KLUN) UBOUND (YD%TCOTOP)
  WRITE (KLUN) YD%TCOTOP
ENDIF
WRITE (KLUN) YD%LCHEM_ARPCLIM
WRITE (KLUN) YD%LCHEM_EMICH4
END SUBROUTINE

SUBROUTINE LOAD_TCHEM (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TCHEM), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2)
LOGICAL :: LTCO2DG, LTCOTOP
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) YD%CHEM_SCHEME
READ (KLUN) YD%LCHEM_DIAC
READ (KLUN) YD%LCHEM_BASCOE_JON
READ (KLUN) YD%LCHEM_BASCOE_HETCHEM
READ (KLUN) YD%LCHEM_EXTENDJNO2
READ (KLUN) YD%LMOZART_RSF_DUMMY
READ (KLUN) YD%LCHEM_JOUT
READ (KLUN) YD%LCHEM_LIGHT
READ (KLUN) ZTMP0
YD%RCHEM_LINOX_SCALING = ZTMP0
READ (KLUN) YD%LCHEM_ACNOX
READ (KLUN) YD%KCHEM_NOXADV
READ (KLUN) YD%KCHEM_WETDEP
READ (KLUN) YD%KCHEM_DRYDEP
READ (KLUN) YD%LCHEM_REVCHEM
READ (KLUN) YD%LCHEM_STMA
READ (KLUN) YD%LCHEM_ANAO3
ALLOCATE (ZTMP2(LBOUND(YD%SMASSCOR,1):UBOUND(YD%SMASSCOR,1), LBOUND(YD%SMASSCOR,2):UBOUND(YD%SMASSCOR,2)))
READ (KLUN) ZTMP2
YD%SMASSCOR = ZTMP2
DEALLOCATE (ZTMP2)
READ (KLUN) YD%LCHEM_0NOX
READ (KLUN) YD%LCHEM_ANACH4
READ (KLUN) YD%LCHEM_WEAK_CH4_RELAXATION
READ (KLUN) YD%LCHEM_CONVSCAV
READ (KLUN) YD%LCHEM_CSHAPE
READ (KLUN) YD%LCHEM_CSHAPE98
READ (KLUN) YD%LCHEM_WDFR
READ (KLUN) YD%LCHEM_HTAP
READ (KLUN) YD%KCHEM_YEARPI
READ (KLUN) ZTMP0
YD%RCH4CONST = ZTMP0
READ (KLUN) YD%KCHEM_SOLVE
READ (KLUN) YD%LCHEM_O3RAD
READ (KLUN) YD%LCHEM_TL
READ (KLUN) YD%LCHEM_AEROI
READ (KLUN) YD%IEXTR_FREE
READ (KLUN) YD%NUCOCH1
READ (KLUN) YD%NUCOCH2
READ (KLUN) YD%NCHEM_LCOCOEF
READ (KLUN) YD%CHEM_LCOVERS
READ (KLUN) YD%LCHEM_LCOMESO
READ (KLUN) YD%LCHEM_LCOCSTCLIM
READ (KLUN) ZTMP0
YD%RCHEM_LCOTAUTOP = ZTMP0
READ (KLUN) ZTMP0
YD%RCHEM_LCOCLIMTOP = ZTMP0
READ (KLUN) YD%LCHEM_LCOLIMIT
READ (KLUN) ZTMP0
YD%RCHEM_LCOCOEFA1 = ZTMP0
READ (KLUN) YD%CSOLMET_ASIS
READ (KLUN) YD%M_SOLITER_ASIS
READ (KLUN) ZTMP0
YD%SOLCV_ASIS = ZTMP0
READ (KLUN) ZTMP0
YD%RTOL_ASIS = ZTMP0
READ (KLUN) ZTMP0
YD%ATOL_ASIS = ZTMP0
READ (KLUN) YD%N_F_RTOL_ASIS
READ (KLUN) YD%N_F_ATOL_ASIS
READ (KLUN) LTCO2DG
IF (LTCO2DG) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%TCO2DG (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%TCO2DG,1):UBOUND(YD%TCO2DG,1), LBOUND(YD%TCO2DG,2):UBOUND(YD%TCO2DG,2)))
  READ (KLUN) ZTMP2
  YD%TCO2DG = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LTCOTOP
IF (LTCOTOP) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%TCOTOP (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%TCOTOP,1):UBOUND(YD%TCOTOP,1)))
  READ (KLUN) ZTMP1
  YD%TCOTOP = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) YD%LCHEM_ARPCLIM
READ (KLUN) YD%LCHEM_EMICH4
END SUBROUTINE


SUBROUTINE COPY_TCHEM (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCHEM), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LTCO2DG, LTCOTOP

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF

















































LTCO2DG = ALLOCATED (YD%TCO2DG)
IF (LTCO2DG) THEN
  !$ACC ENTER DATA CREATE (YD%TCO2DG)
  !$ACC UPDATE DEVICE (YD%TCO2DG)
  !$ACC ENTER DATA ATTACH (YD%TCO2DG)
ENDIF

LTCOTOP = ALLOCATED (YD%TCOTOP)
IF (LTCOTOP) THEN
  !$ACC ENTER DATA CREATE (YD%TCOTOP)
  !$ACC UPDATE DEVICE (YD%TCOTOP)
  !$ACC ENTER DATA ATTACH (YD%TCOTOP)
ENDIF



END SUBROUTINE

SUBROUTINE HOST_TCHEM (YD)

IMPLICIT NONE
TYPE (TCHEM), TARGET :: YD
LOGICAL :: LTCO2DG, LTCOTOP





















































END SUBROUTINE

     

SUBROUTINE CRC64_TCHEM (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TCHEM), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LTCO2DG, LTCOTOP
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_SCHEME), CDPATH//'%CHEM_SCHEME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_DIAC), CDPATH//'%LCHEM_DIAC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_BASCOE_JON), CDPATH//'%LCHEM_BASCOE_JON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_BASCOE_HETCHEM), CDPATH//'%LCHEM_BASCOE_HETCHEM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_EXTENDJNO2), CDPATH//'%LCHEM_EXTENDJNO2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMOZART_RSF_DUMMY), CDPATH//'%LMOZART_RSF_DUMMY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_JOUT), CDPATH//'%LCHEM_JOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_LIGHT), CDPATH//'%LCHEM_LIGHT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCHEM_LINOX_SCALING), CDPATH//'%RCHEM_LINOX_SCALING'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_ACNOX), CDPATH//'%LCHEM_ACNOX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KCHEM_NOXADV), CDPATH//'%KCHEM_NOXADV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KCHEM_WETDEP), CDPATH//'%KCHEM_WETDEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KCHEM_DRYDEP), CDPATH//'%KCHEM_DRYDEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_REVCHEM), CDPATH//'%LCHEM_REVCHEM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_STMA), CDPATH//'%LCHEM_STMA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_ANAO3), CDPATH//'%LCHEM_ANAO3'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SMASSCOR), CDPATH//'%SMASSCOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_0NOX), CDPATH//'%LCHEM_0NOX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_ANACH4), CDPATH//'%LCHEM_ANACH4'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_WEAK_CH4_RELAXATION), CDPATH//'%LCHEM_WEAK_CH4_RELAXATION'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_CONVSCAV), CDPATH//'%LCHEM_CONVSCAV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_CSHAPE), CDPATH//'%LCHEM_CSHAPE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_CSHAPE98), CDPATH//'%LCHEM_CSHAPE98'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_WDFR), CDPATH//'%LCHEM_WDFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_HTAP), CDPATH//'%LCHEM_HTAP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KCHEM_YEARPI), CDPATH//'%KCHEM_YEARPI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCH4CONST), CDPATH//'%RCH4CONST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KCHEM_SOLVE), CDPATH//'%KCHEM_SOLVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_O3RAD), CDPATH//'%LCHEM_O3RAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_TL), CDPATH//'%LCHEM_TL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_AEROI), CDPATH//'%LCHEM_AEROI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IEXTR_FREE), CDPATH//'%IEXTR_FREE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NUCOCH1), CDPATH//'%NUCOCH1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NUCOCH2), CDPATH//'%NUCOCH2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCHEM_LCOCOEF), CDPATH//'%NCHEM_LCOCOEF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CHEM_LCOVERS), CDPATH//'%CHEM_LCOVERS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_LCOMESO), CDPATH//'%LCHEM_LCOMESO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_LCOCSTCLIM), CDPATH//'%LCHEM_LCOCSTCLIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCHEM_LCOTAUTOP), CDPATH//'%RCHEM_LCOTAUTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCHEM_LCOCLIMTOP), CDPATH//'%RCHEM_LCOCLIMTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_LCOLIMIT), CDPATH//'%LCHEM_LCOLIMIT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCHEM_LCOCOEFA1), CDPATH//'%RCHEM_LCOCOEFA1'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CSOLMET_ASIS), CDPATH//'%CSOLMET_ASIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%M_SOLITER_ASIS), CDPATH//'%M_SOLITER_ASIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%SOLCV_ASIS), CDPATH//'%SOLCV_ASIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RTOL_ASIS), CDPATH//'%RTOL_ASIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%ATOL_ASIS), CDPATH//'%ATOL_ASIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%N_F_RTOL_ASIS), CDPATH//'%N_F_RTOL_ASIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%N_F_ATOL_ASIS), CDPATH//'%N_F_ATOL_ASIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TCO2DG), CDPATH//'%TCO2DG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TCOTOP), CDPATH//'%TCOTOP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_ARPCLIM), CDPATH//'%LCHEM_ARPCLIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCHEM_EMICH4), CDPATH//'%LCHEM_EMICH4'

END SUBROUTINE

SUBROUTINE WIPE_TCHEM (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCHEM), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LTCO2DG, LTCOTOP

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

















































LTCO2DG = ALLOCATED (YD%TCO2DG)
IF (LTCO2DG) THEN
  !$ACC EXIT DATA DETACH (YD%TCO2DG)
  !$ACC EXIT DATA DETACH (YD%TCO2DG)
ENDIF

LTCOTOP = ALLOCATED (YD%TCOTOP)
IF (LTCOTOP) THEN
  !$ACC EXIT DATA DETACH (YD%TCOTOP)
  !$ACC EXIT DATA DETACH (YD%TCOTOP)
ENDIF



LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TCHEM (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TCHEM),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LTCO2DG, LTCOTOP

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%CHEM_SCHEME) * LEN (YD%CHEM_SCHEME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_SCHEME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_DIAC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_DIAC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_BASCOE_JON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_BASCOE_JON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_BASCOE_HETCHEM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_BASCOE_HETCHEM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_EXTENDJNO2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_EXTENDJNO2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMOZART_RSF_DUMMY)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMOZART_RSF_DUMMY'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_JOUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_JOUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_LIGHT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_LIGHT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCHEM_LINOX_SCALING)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCHEM_LINOX_SCALING'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_ACNOX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_ACNOX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%KCHEM_NOXADV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KCHEM_NOXADV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%KCHEM_WETDEP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KCHEM_WETDEP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%KCHEM_DRYDEP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KCHEM_DRYDEP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_REVCHEM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_REVCHEM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_STMA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_STMA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_ANAO3)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_ANAO3'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%SMASSCOR) * SIZE (YD%SMASSCOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SMASSCOR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_0NOX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_0NOX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_ANACH4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_ANACH4'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_WEAK_CH4_RELAXATION)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_WEAK_CH4_RELAXATION'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_CONVSCAV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_CONVSCAV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_CSHAPE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_CSHAPE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_CSHAPE98)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_CSHAPE98'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_WDFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_WDFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_HTAP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_HTAP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%KCHEM_YEARPI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KCHEM_YEARPI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCH4CONST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCH4CONST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%KCHEM_SOLVE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KCHEM_SOLVE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_O3RAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_O3RAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_TL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_TL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_AEROI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_AEROI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IEXTR_FREE) * SIZE (YD%IEXTR_FREE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IEXTR_FREE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NUCOCH1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUCOCH1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NUCOCH2)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUCOCH2'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCHEM_LCOCOEF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCHEM_LCOCOEF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CHEM_LCOVERS) * LEN (YD%CHEM_LCOVERS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CHEM_LCOVERS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_LCOMESO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_LCOMESO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_LCOCSTCLIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_LCOCSTCLIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCHEM_LCOTAUTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCHEM_LCOTAUTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCHEM_LCOCLIMTOP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCHEM_LCOCLIMTOP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_LCOLIMIT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_LCOLIMIT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCHEM_LCOCOEFA1)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCHEM_LCOCOEFA1'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CSOLMET_ASIS) * LEN (YD%CSOLMET_ASIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CSOLMET_ASIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%M_SOLITER_ASIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%M_SOLITER_ASIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%SOLCV_ASIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%SOLCV_ASIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RTOL_ASIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTOL_ASIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%ATOL_ASIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%ATOL_ASIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%N_F_RTOL_ASIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%N_F_RTOL_ASIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%N_F_ATOL_ASIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%N_F_ATOL_ASIS'
ENDIF
KSIZE = KSIZE + ISIZE
LTCO2DG = ALLOCATED (YD%TCO2DG)
IF (LTCO2DG) THEN
  ISIZE = KIND (YD%TCO2DG) * SIZE (YD%TCO2DG)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TCO2DG'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTCOTOP = ALLOCATED (YD%TCOTOP)
IF (LTCOTOP) THEN
  ISIZE = KIND (YD%TCOTOP) * SIZE (YD%TCOTOP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TCOTOP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%LCHEM_ARPCLIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_ARPCLIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCHEM_EMICH4)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCHEM_EMICH4'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
