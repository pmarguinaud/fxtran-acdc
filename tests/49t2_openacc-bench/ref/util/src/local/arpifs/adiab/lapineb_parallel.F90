SUBROUTINE LAPINEB_PARALLEL (YDMODEL, YDGEOMETRY, YDCPG_OPTS, YDCPG_BNDS, YDSL, LDSLPHY, YDCPG_GMV9&
&, YDCPG_GMV9_SI, YDCPG_GMV9_NL, YDCPG_GFL9, YDA_KNOWENO, YDA_KL0, YDA_KLH0, YDA_PLSCAW, YDA_PRSCAW&
&, YDA_KL0H, YDA_PLSCAWH, YDA_PRSCAWH, YDA_PUF, YDA_PVF, YDCPG_SL1, YDA_PSCO, YDA_PCCO, YDCPG_SL2&
&, YDVARS, YDA_PGFLPC, YDCPG_DDH_TND, YDA_PUP9, YDA_PVP9, YDA_PTP9, YDCPG_GFLP9)
USE TYPE_MODEL,ONLY:MODEL
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE YOMGMV,ONLY:TGMV

USE YOMCST,ONLY:TCST
USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE EINT_MOD,ONLY:SL_STRUCT
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1F_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_DDH_TND_TYPE_MOD,ONLY:CPG_DDH_TND_TYPE
USE CPG_GMV_TYPE_MOD,ONLY:CPG_GMV_TYPE
USE CPG_GFL_TYPE_MOD,ONLY:CPG_GFL_TYPE, CPG_GFLSL_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE FIELD_ARRAY_MODULE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (SL_STRUCT), INTENT (IN)::YDSL
LOGICAL, INTENT (IN)::LDSLPHY
TYPE (CPG_GMV_TYPE), INTENT (INOUT)::YDCPG_GMV9
TYPE (CPG_GMV_TYPE), INTENT (INOUT)::YDCPG_GMV9_SI
TYPE (CPG_GMV_TYPE), INTENT (INOUT)::YDCPG_GMV9_NL
TYPE (CPG_GFL_TYPE), INTENT (INOUT)::YDCPG_GFL9
TYPE (FIELD_3IM_ARRAY), INTENT (IN)::YDA_KNOWENO
TYPE (FIELD_4IM_ARRAY), INTENT (IN)::YDA_KL0
TYPE (FIELD_4IM_ARRAY), INTENT (IN)::YDA_KLH0
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PLSCAW
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PRSCAW
TYPE (FIELD_4IM_ARRAY), INTENT (IN)::YDA_KL0H
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PLSCAWH
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PRSCAWH
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PUF
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PVF
TYPE (CPG_SL1F_TYPE), INTENT (IN)::YDCPG_SL1
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PSCO
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PCCO
TYPE (CPG_SL2_TYPE), INTENT (IN)::YDCPG_SL2
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PGFLPC
TYPE (CPG_DDH_TND_TYPE), INTENT (INOUT)::YDCPG_DDH_TND
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PUP9
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PVP9
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PTP9
TYPE (CPG_GFLSL_TYPE), INTENT (INOUT)::YDCPG_GFLP9
INTEGER (KIND=JPIM)::IVDVAR
INTEGER (KIND=JPIM)::IHVIO
INTEGER (KIND=JPIM)::JFLD
INTEGER (KIND=JPIM)::JGFL
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
LOGICAL::LL2TLFFO
LOGICAL::LLUPDATE_NHX
LOGICAL::LLDER
LOGICAL::LLSLINLC2
LOGICAL::LLNHEE
CLASS (FIELD_3RB), POINTER :: YL_ZVT1
REAL (KIND=JPRB), POINTER::ZVT1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUT1
REAL (KIND=JPRB), POINTER::ZUT1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVZ9
REAL (KIND=JPRB), POINTER::ZVZ9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUZ9
REAL (KIND=JPRB), POINTER::ZUZ9 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSPTO
REAL (KIND=JPRB), POINTER::ZSPTO (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSPT1
REAL (KIND=JPRB), POINTER::ZSPT1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDP9
REAL (KIND=JPRB), POINTER::ZDP9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZC9
REAL (KIND=JPRB), POINTER::ZC9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZC9_SI
REAL (KIND=JPRB), POINTER::ZC9_SI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZC9_NL
REAL (KIND=JPRB), POINTER::ZC9_NL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUP9
REAL (KIND=JPRB), POINTER::ZUP9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVP9
REAL (KIND=JPRB), POINTER::ZVP9 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZOROGL_SR
REAL (KIND=JPRB), POINTER::ZOROGL_SR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZOROGM_SR
REAL (KIND=JPRB), POINTER::ZOROGM_SR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZUST1
REAL (KIND=JPRB), POINTER::ZUST1 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZVST1
REAL (KIND=JPRB), POINTER::ZVST1 (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVWVT1
REAL (KIND=JPRB), POINTER::ZVWVT1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVWVT0
REAL (KIND=JPRB), POINTER::ZVWVT0 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZVWVT1S
REAL (KIND=JPRB), POINTER::ZVWVT1S (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSVDT1
REAL (KIND=JPRB), POINTER::ZSVDT1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNHYT0
REAL (KIND=JPRB), POINTER::ZNHYT0 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDBBC9
REAL (KIND=JPRB), POINTER::ZDBBC9 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDPHI9
REAL (KIND=JPRB), POINTER::ZDPHI9 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGWS9
REAL (KIND=JPRB), POINTER::ZGWS9 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGMDTX
REAL (KIND=JPRB), POINTER::ZGMDTX (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGMDTY
REAL (KIND=JPRB), POINTER::ZGMDTY (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZINEZV
REAL (KIND=JPRB), POINTER::ZINEZV (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQ2
REAL (KIND=JPRB), POINTER::ZQ2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZP2
REAL (KIND=JPRB), POINTER::ZP2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVWEI
REAL (KIND=JPRB), POINTER::ZVWEI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZR1
REAL (KIND=JPRB), POINTER::ZR1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRT1
REAL (KIND=JPRB), POINTER::ZRT1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZP
REAL (KIND=JPRB), POINTER::ZP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQ
REAL (KIND=JPRB), POINTER::ZQ (:,:,:)
REAL (KIND=JPRB)::ZCOPHI
REAL (KIND=JPRB)::ZDEPI
REAL (KIND=JPRB)::ZDGUN
REAL (KIND=JPRB)::ZDGUX
REAL (KIND=JPRB)::ZDLUN
REAL (KIND=JPRB)::ZDLUX
REAL (KIND=JPRB)::ZDSTRET
REAL (KIND=JPRB)::ZPHI
REAL (KIND=JPRB)::ZPP
REAL (KIND=JPRB)::ZPP1
REAL (KIND=JPRB)::ZPP9
REAL (KIND=JPRB)::ZQQ
REAL (KIND=JPRB)::ZQQ1
REAL (KIND=JPRB)::ZQQ9
REAL (KIND=JPRB)::ZSINX
REAL (KIND=JPRB)::ZTXO
REAL (KIND=JPRB)::ZTYO
REAL (KIND=JPRB)::ZCMSLP
REAL (KIND=JPRB)::ZTAUD_NL
#include "abor1.intfb.h"
#include "lacone.intfb.h"
#include "lacone_openacc.intfb.h"
#include "larche.intfb.h"
#include "larche_openacc.intfb.h"
#include "larcinb_parallel.intfb.h"
#include "verdisint.intfb.h"
#include "verdisint_openacc.intfb.h"
#include "mcoords.intfb.h"
#include "mcoords_openacc.intfb.h"
#include "rotuv.intfb.h"
#include "rotuv_openacc.intfb.h"
#include "rotuvgeo.intfb.h"
#include "rotuvgeo_openacc.intfb.h"
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL(KIND=JPRB), POINTER :: Z_YDA_PCCO_P(:,:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDA_PSCO_P(:,:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDA_PUP9_P(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDA_PVP9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GFL9_GFL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_GMV_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_NL_GMV_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_SI_GMV_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_SI_T_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_SI_U_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_SI_V_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_T_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_U_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMV9_V_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_DBBC1(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_DPHI1(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_SPSI(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_TSI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_USI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_VSI(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GECLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GESLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GM_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDL_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDL_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDM_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GSQM2_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROG_P(:,:)
REAL(KIND=JPRD), POINTER :: Z_YDVARS_GEOMETRY_RCOLON_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RINDX_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RINDY_P(:,:)
REAL(KIND=JPRD), POINTER :: Z_YDVARS_GEOMETRY_RSILON_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GFL_PTR_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_PCF_U_PC_PH(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_PCF_V_PC_PH(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_T1(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T1(:,:,:)
IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZVZ9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVWVT1S, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVWVT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVWVT0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVWEI, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVST1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVP9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUZ9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUST1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUP9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSVDT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPTO, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&+1, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZR1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQ2, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQ, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZP2, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZP, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZOROGM_SR, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZOROGL_SR, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNHYT0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZINEZV, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGWS9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMDTY, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMDTX, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDPHI9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDP9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDBBC9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZC9_SI, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZC9_NL, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZC9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)


LLUPDATE_NHX=YDMODEL%YRML_DYN%YRDYNA%LNHX.AND.(YDMODEL%YRML_DYN%YRDYNA%NVDVAR==4.OR.YDMODEL%YRML_DYN&
&%YRDYNA%NVDVAR==5).AND.(.NOT.YDMODEL%YRML_DYN%YRDYNA%LGWADV.OR.(YDMODEL%YRML_DYN%YRDYNA%ND4SYS&
&==2.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER<YDMODEL%YRML_DYN%YRDYN%NSITER))
ZDEPI=2.0_JPRB*YDMODEL%YRCST%RPI
ZDSTRET=2.0_JPRB*YDGEOMETRY%YRGEM%RSTRET

DO JFLD=1, SIZE (YDCPG_GMV9%GMV)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ZERO_GMV9')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%GMV (JFLD)%F_P)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      Z_YDCPG_GMV9_GMV_P(:,:, JBLK)=0.0_JPRB
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_GMV_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_GMV9')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%GMV (JFLD)%F_P)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        Z_YDCPG_GMV9_GMV_P(JROF,:, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_GMV_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_GMV9')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_GMV_P => GET_DEVICE_DATA_RDWR (YDCPG_GMV9%GMV (JFLD)%F_P)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDCPG_GMV9_GMV_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        Z_YDCPG_GMV9_GMV_P(JROF,:, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_GMV_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9',1,ZHOOK_HANDLE_PARALLEL)
ENDDO


IF (YDMODEL%YRML_DYN%YRDYNA%LSLINL) THEN

  DO JFLD=1, SIZE (YDCPG_GMV9_SI%GMV)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ZERO_GMV9_SI')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_SI_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        Z_YDCPG_GMV9_SI_GMV_P(:,:, JBLK)=0.0_JPRB
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9_SI')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GMV9_SI_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%GMV (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_SI_GMV_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_GMV9_SI')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_SI_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          
          Z_YDCPG_GMV9_SI_GMV_P(JROF,:, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9_SI')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GMV9_SI_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%GMV (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_SI_GMV_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_GMV9_SI')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_SI_GMV_P => GET_DEVICE_DATA_RDWR (YDCPG_GMV9_SI%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDCPG_GMV9_SI_GMV_P) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          
          Z_YDCPG_GMV9_SI_GMV_P(JROF,:, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9_SI')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GMV9_SI_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%GMV (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_SI_GMV_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SI',1,ZHOOK_HANDLE_PARALLEL)
  ENDDO

ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.YDMODEL%YRML_DYN%YRDYNA%LSETTLS) THEN

  DO JFLD=1, SIZE (YDCPG_GMV9_NL%GMV)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ZERO_GMV9_SL')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_NL_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_NL%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        Z_YDCPG_GMV9_NL_GMV_P(:,:, JBLK)=0.0_JPRB
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9_SL')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GMV9_NL_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_NL%GMV (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_NL_GMV_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_GMV9_SL')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_NL_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_NL%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          
          Z_YDCPG_GMV9_NL_GMV_P(JROF,:, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9_SL')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GMV9_NL_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_NL%GMV (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_NL_GMV_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_GMV9_SL')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_NL_GMV_P => GET_DEVICE_DATA_RDWR (YDCPG_GMV9_NL%GMV (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDCPG_GMV9_NL_GMV_P) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          
          Z_YDCPG_GMV9_NL_GMV_P(JROF,:, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_GMV9_SL')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GMV9_NL_GMV_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_NL%GMV (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GMV9_NL_GMV_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_GMV9_SL',1,ZHOOK_HANDLE_PARALLEL)
  ENDDO

ENDIF


IF (LDSLPHY) THEN
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ZERO_UV9')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
    ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      ZUP9 (:,:, JBLK)=0.0_JPRB
      ZVP9 (:,:, JBLK)=0.0_JPRB
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_UV9')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
      ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZUP9 => NULL ()
    ZVP9 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_UV9')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
    ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        ZUP9 (JROF,:, JBLK)=0.0_JPRB
        ZVP9 (JROF,:, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_UV9')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
      ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZUP9 => NULL ()
    ZVP9 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ZERO_UV9')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZUP9 => GET_DEVICE_DATA_RDWR (YL_ZUP9)
    ZVP9 => GET_DEVICE_DATA_RDWR (YL_ZVP9)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZUP9, ZVP9) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        ZUP9 (JROF,:, JBLK)=0.0_JPRB
        ZVP9 (JROF,:, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZERO_UV9')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
      ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZUP9 => NULL ()
    ZVP9 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZERO_UV9',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ROTUVGEO')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZP => GET_HOST_DATA_RDWR (YL_ZP)
  ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
  Z_YDA_PCCO_P => GET_HOST_DATA_RDONLY (YDA_PCCO%F_P)
  Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL ROTUVGEO (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
    &%KFDIA, Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P(:, JBLK), Z_YDA_PCCO_P&
    & (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO&
    &%M_RQY, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), LDIR=.TRUE.)
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUVGEO')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_HOST_DATA_RDWR (YL_ZP)
    ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZP => NULL ()
  ZQ => NULL ()
  Z_YDA_PCCO_P => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ROTUVGEO')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZP => GET_HOST_DATA_RDWR (YL_ZP)
  ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
  Z_YDA_PCCO_P => GET_HOST_DATA_RDONLY (YDA_PCCO%F_P)
  Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ROTUVGEO_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA,&
      & YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P(:, JBLK&
      &), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
      &%YYTCCO%M_RQY, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), LDIR=.TRUE.,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUVGEO')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_HOST_DATA_RDWR (YL_ZP)
    ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZP => NULL ()
  ZQ => NULL ()
  Z_YDA_PCCO_P => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ROTUVGEO')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZP => GET_DEVICE_DATA_RDWR (YL_ZP)
  ZQ => GET_DEVICE_DATA_RDWR (YL_ZQ)
  Z_YDA_PCCO_P => GET_DEVICE_DATA_RDONLY (YDA_PCCO%F_P)
  Z_YDVARS_GEOMETRY_GNORDL_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZP, ZQ, Z_YDA_PCCO_P, &
    !$ACC&         Z_YDVARS_GEOMETRY_GNORDL_P, Z_YDVARS_GEOMETRY_GNORDM_P) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ROTUVGEO_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA,&
      & YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P(:, JBLK&
      &), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
      &%YYTCCO%M_RQY, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), LDIR=.TRUE.,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUVGEO')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_HOST_DATA_RDWR (YL_ZP)
    ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZP => NULL ()
  ZQ => NULL ()
  Z_YDA_PCCO_P => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO',1,ZHOOK_HANDLE_PARALLEL)
IHVIO=0

DO JGFL=1, YDMODEL%YRML_GCONF%YGFL%NUMFLDS

  IF (YDMODEL%YRML_GCONF%YGFL%YCOMP(JGFL)%CSLINT=='LAIHVT      '.OR.YDMODEL%YRML_GCONF%YGFL%YCOMP(JGFL&
    &)%CSLINT=='LAIHVTQM    '.OR.YDMODEL%YRML_GCONF%YGFL%YCOMP(JGFL)%CSLINT=='LAIHVTQMH   ') THEN
    IHVIO=1
  ENDIF

ENDDO

LL2TLFFO=YDMODEL%YRML_DYN%YRDYN%L2TLFF.AND.(YDMODEL%YRML_PHY_MF%YRPHY%LMPHYS.OR.YDMODEL&
&%YRML_PHY_EC%YREPHY%LEPHYS).AND.(.NOT.YDMODEL%YRML_PHY_EC%YREPHY%LAGPHY)

IF (YDCPG_OPTS%LRPLANE) THEN
  ZDLUN=REAL (YDSL%NDLUNG, JPRB)
  ZDLUX=REAL (YDSL%NDLUXG, JPRB)
  ZDGUN=REAL (YDSL%NDGUNG, JPRB)
  ZDGUX=REAL (YDSL%NDGUXG, JPRB)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:LRPLANE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZGMDTX => GET_HOST_DATA_RDWR (YL_ZGMDTX)
    ZGMDTY => GET_HOST_DATA_RDWR (YL_ZGMDTY)
    ZINEZV => GET_HOST_DATA_RDWR (YL_ZINEZV)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDA_PSCO_P => GET_HOST_DATA_RDONLY (YDA_PSCO%F_P)
    Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
    Z_YDVARS_GEOMETRY_RINDX_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RINDX%FT0)
    Z_YDVARS_GEOMETRY_RINDY_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RINDY%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZGMDTX (JROF, JBLK)=0.5_JPRB*Z_YDVARS_GEOMETRY_GM_P (JROF, JBLK&
        &)*YDMODEL%YRML_GCONF%YRRIP%RTDT/YDGEOMETRY%YREGEO%EDELX
        ZGMDTY (JROF, JBLK)=0.5_JPRB*Z_YDVARS_GEOMETRY_GM_P (JROF, JBLK&
        &)*YDMODEL%YRML_GCONF%YRRIP%RTDT/YDGEOMETRY%YREGEO%EDELY
        ZINEZV (JROF, JBLK)=MAX (0.0_JPRB, SIGN (1.0_JPRB,(Z_YDVARS_GEOMETRY_RINDX_P (JROF, JBLK)-ZDLUN&
        &)*(ZDLUX-Z_YDVARS_GEOMETRY_RINDX_P (JROF, JBLK))))*MAX (0.0_JPRB, SIGN (1.0_JPRB,(Z_YDVARS_GEOMETRY_RINDY_P&
        & (JROF, JBLK)-ZDGUN)*(ZDGUX-Z_YDVARS_GEOMETRY_RINDY_P (JROF, JBLK))))
      ENDDO

      Z_YDA_PCCO_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK)=Z_YDA_PSCO_P&
      & (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTSCO%M_SINLA, JBLK)
      Z_YDA_PCCO_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK)=Z_YDA_PSCO_P&
      & (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTSCO%M_COPHI, JBLK)
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LRPLANE')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZGMDTX => GET_HOST_DATA_RDWR (YL_ZGMDTX)
      ZGMDTY => GET_HOST_DATA_RDWR (YL_ZGMDTY)
      ZINEZV => GET_HOST_DATA_RDWR (YL_ZINEZV)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
      Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
      Z_YDVARS_GEOMETRY_RINDX_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDX%FT0)
      Z_YDVARS_GEOMETRY_RINDY_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDY%FT0)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZGMDTX => NULL ()
    ZGMDTY => NULL ()
    ZINEZV => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDA_PSCO_P => NULL ()
    Z_YDVARS_GEOMETRY_GM_P => NULL ()
    Z_YDVARS_GEOMETRY_RINDX_P => NULL ()
    Z_YDVARS_GEOMETRY_RINDY_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:LRPLANE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZGMDTX => GET_HOST_DATA_RDWR (YL_ZGMDTX)
    ZGMDTY => GET_HOST_DATA_RDWR (YL_ZGMDTY)
    ZINEZV => GET_HOST_DATA_RDWR (YL_ZINEZV)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDA_PSCO_P => GET_HOST_DATA_RDONLY (YDA_PSCO%F_P)
    Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
    Z_YDVARS_GEOMETRY_RINDX_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RINDX%FT0)
    Z_YDVARS_GEOMETRY_RINDY_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RINDY%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        
        ZGMDTX (JROF, JBLK)=0.5_JPRB*Z_YDVARS_GEOMETRY_GM_P (JROF, JBLK&
        &)*YDMODEL%YRML_GCONF%YRRIP%RTDT/YDGEOMETRY%YREGEO%EDELX
        ZGMDTY (JROF, JBLK)=0.5_JPRB*Z_YDVARS_GEOMETRY_GM_P (JROF, JBLK&
        &)*YDMODEL%YRML_GCONF%YRRIP%RTDT/YDGEOMETRY%YREGEO%EDELY
        ZINEZV (JROF, JBLK)=MAX (0.0_JPRB, SIGN (1.0_JPRB,(Z_YDVARS_GEOMETRY_RINDX_P (JROF, JBLK)-ZDLUN&
        &)*(ZDLUX-Z_YDVARS_GEOMETRY_RINDX_P (JROF, JBLK))))*MAX (0.0_JPRB, SIGN (1.0_JPRB,(Z_YDVARS_GEOMETRY_RINDY_P&
        & (JROF, JBLK)-ZDGUN)*(ZDGUX-Z_YDVARS_GEOMETRY_RINDY_P (JROF, JBLK))))
        
        Z_YDA_PCCO_P (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK)=Z_YDA_PSCO_P&
        & (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTSCO%M_SINLA, JBLK)
        Z_YDA_PCCO_P (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK)=Z_YDA_PSCO_P&
        & (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTSCO%M_COPHI, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LRPLANE')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZGMDTX => GET_HOST_DATA_RDWR (YL_ZGMDTX)
      ZGMDTY => GET_HOST_DATA_RDWR (YL_ZGMDTY)
      ZINEZV => GET_HOST_DATA_RDWR (YL_ZINEZV)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
      Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
      Z_YDVARS_GEOMETRY_RINDX_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDX%FT0)
      Z_YDVARS_GEOMETRY_RINDY_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDY%FT0)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZGMDTX => NULL ()
    ZGMDTY => NULL ()
    ZINEZV => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDA_PSCO_P => NULL ()
    Z_YDVARS_GEOMETRY_GM_P => NULL ()
    Z_YDVARS_GEOMETRY_RINDX_P => NULL ()
    Z_YDVARS_GEOMETRY_RINDY_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:LRPLANE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZGMDTX => GET_DEVICE_DATA_RDWR (YL_ZGMDTX)
    ZGMDTY => GET_DEVICE_DATA_RDWR (YL_ZGMDTY)
    ZINEZV => GET_DEVICE_DATA_RDWR (YL_ZINEZV)
    Z_YDA_PCCO_P => GET_DEVICE_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDA_PSCO_P => GET_DEVICE_DATA_RDONLY (YDA_PSCO%F_P)
    Z_YDVARS_GEOMETRY_GM_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
    Z_YDVARS_GEOMETRY_RINDX_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RINDX%FT0)
    Z_YDVARS_GEOMETRY_RINDY_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RINDY%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZGMDTX, &
      !$ACC&         ZGMDTY, ZINEZV, Z_YDA_PCCO_P, Z_YDA_PSCO_P, Z_YDVARS_GEOMETRY_GM_P, &
      !$ACC&         Z_YDVARS_GEOMETRY_RINDX_P, Z_YDVARS_GEOMETRY_RINDY_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        
        ZGMDTX (JROF, JBLK)=0.5_JPRB*Z_YDVARS_GEOMETRY_GM_P (JROF, JBLK&
        &)*YDMODEL%YRML_GCONF%YRRIP%RTDT/YDGEOMETRY%YREGEO%EDELX
        ZGMDTY (JROF, JBLK)=0.5_JPRB*Z_YDVARS_GEOMETRY_GM_P (JROF, JBLK&
        &)*YDMODEL%YRML_GCONF%YRRIP%RTDT/YDGEOMETRY%YREGEO%EDELY
        ZINEZV (JROF, JBLK)=MAX (0.0_JPRB, SIGN (1.0_JPRB,(Z_YDVARS_GEOMETRY_RINDX_P (JROF, JBLK)-ZDLUN&
        &)*(ZDLUX-Z_YDVARS_GEOMETRY_RINDX_P (JROF, JBLK))))*MAX (0.0_JPRB, SIGN (1.0_JPRB,(Z_YDVARS_GEOMETRY_RINDY_P&
        & (JROF, JBLK)-ZDGUN)*(ZDGUX-Z_YDVARS_GEOMETRY_RINDY_P (JROF, JBLK))))
        
        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDA_PCCO_P (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK), Z_YDA_PSCO_P (:, 1:YDGEOMETRY&
        &%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTSCO%M_SINLA, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDA_PCCO_P (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK), Z_YDA_PSCO_P (:, 1:YDGEOMETRY&
        &%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTSCO%M_COPHI, JBLK))
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LRPLANE')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZGMDTX => GET_HOST_DATA_RDWR (YL_ZGMDTX)
      ZGMDTY => GET_HOST_DATA_RDWR (YL_ZGMDTY)
      ZINEZV => GET_HOST_DATA_RDWR (YL_ZINEZV)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
      Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
      Z_YDVARS_GEOMETRY_RINDX_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDX%FT0)
      Z_YDVARS_GEOMETRY_RINDY_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RINDY%FT0)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZGMDTX => NULL ()
    ZGMDTY => NULL ()
    ZINEZV => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDA_PSCO_P => NULL ()
    Z_YDVARS_GEOMETRY_GM_P => NULL ()
    Z_YDVARS_GEOMETRY_RINDX_P => NULL ()
    Z_YDVARS_GEOMETRY_RINDY_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRPLANE',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ZVWEI')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      ZVWEI (:, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZVWEI')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZVWEI => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ZVWEI')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        ZVWEI (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZVWEI')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZVWEI => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ZVWEI')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZVWEI => GET_DEVICE_DATA_RDWR (YL_ZVWEI)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YFXTRAN_ACDC_STACK, ZVWEI) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        ZVWEI (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ZVWEI')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZVWEI => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ZVWEI',1,ZHOOK_HANDLE_PARALLEL)

IF (.NOT.(YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER>0))) THEN
  CALL LARCINB_PARALLEL (YDGEOMETRY, YDVARS, YDMODEL%YRML_DIAG%YRLDDH, YDMODEL%YRML_DIAG%YRMDDH, YDMODEL&
  &%YRML_GCONF, YDMODEL%YRML_DYN, YDCPG_OPTS, YDCPG_BNDS, YDSL%NASLB1, IHVIO, LDSLPHY, LL2TLFFO, YDA_KL0&
  &%F_P, YDA_KLH0%F_P, YDA_PLSCAW%F_P, YDA_PRSCAW%F_P, YDCPG_SL1, YDA_KNOWENO%F_P, YDCPG_DDH_TND, YDCPG_GMV9&
  &, YDCPG_GMV9_SI, YDCPG_GMV9_NL, YDCPG_GFL9, YL_ZDP9, YL_ZC9, YL_ZC9_SI, YL_ZC9_NL, YL_ZUZ9, YL_ZVZ9&
  &, YL_ZUP9, YL_ZVP9, YDA_PTP9%F_P, YDCPG_GFLP9, YL_ZDBBC9, YL_ZDPHI9, YL_ZGWS9)

  IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN.AND.YDMODEL%YRML_DYN%YRDYNA%LGWADV&
    &.AND.(.NOT.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVFE_GW)) THEN
    
    
    CALL ABOR1 ("ERROR: WRONG SETTINGS")
    
  ENDIF

ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN
  
  
  
  
  
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER>0)) THEN
  
  
  
  
  
  
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.YDMODEL%YRML_DYN%YRDYNA&
  &%LSETTLS.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYN%NVLAG==2) THEN

  IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
    CALL ABOR1 (' LAPINEB 2.2.1: LVERTFE=.T. NOT CODED WITH NVLAG == 2')
  ELSE
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:NVLAG2')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => GET_HOST_DATA_RDONLY (YL_ZC9)
      ZDP9 => GET_HOST_DATA_RDONLY (YL_ZDP9)
      ZVWEI => GET_HOST_DATA_RDONLY (YL_ZVWEI)
      Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZVWEI (JROF&
            &, JLEV, JBLK)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          ENDDO

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:NVLAG2')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZC9 => GET_HOST_DATA_RDWR (YL_ZC9)
        ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
        ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
        Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => NULL ()
      ZDP9 => NULL ()
      ZVWEI => NULL ()
      Z_YDVARS_SP_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:NVLAG2')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => GET_HOST_DATA_RDONLY (YL_ZC9)
      ZDP9 => GET_HOST_DATA_RDONLY (YL_ZDP9)
      ZVWEI => GET_HOST_DATA_RDONLY (YL_ZVWEI)
      Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZVWEI (JROF&
            &, JLEV, JBLK)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          
          ENDDO

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:NVLAG2')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZC9 => GET_HOST_DATA_RDWR (YL_ZC9)
        ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
        ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
        Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => NULL ()
      ZDP9 => NULL ()
      ZVWEI => NULL ()
      Z_YDVARS_SP_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:NVLAG2')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => GET_DEVICE_DATA_RDONLY (YL_ZC9)
      ZDP9 => GET_DEVICE_DATA_RDONLY (YL_ZDP9)
      ZVWEI => GET_DEVICE_DATA_RDONLY (YL_ZVWEI)
      Z_YDVARS_SP_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SP%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YFXTRAN_ACDC_STACK, ZC9, ZDP9, ZVWEI, Z_YDVARS_SP_T1) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZVWEI (JROF&
            &, JLEV, JBLK)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          
          ENDDO

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:NVLAG2')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZC9 => GET_HOST_DATA_RDWR (YL_ZC9)
        ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
        ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
        Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => NULL ()
      ZDP9 => NULL ()
      ZVWEI => NULL ()
      Z_YDVARS_SP_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG2',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF

ELSEIF (YDMODEL%YRML_DYN%YRDYN%NVLAG==3) THEN
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:NVLAG3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZC9 => GET_HOST_DATA_RDONLY (YL_ZC9)
    ZC9_SI => GET_HOST_DATA_RDONLY (YL_ZC9_SI)
    ZDP9 => GET_HOST_DATA_RDONLY (YL_ZDP9)
    ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
    ZSPTO => GET_HOST_DATA_RDWR (YL_ZSPTO)
    ZVWEI => GET_HOST_DATA_RDONLY (YL_ZVWEI)
    Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, LLSLINLC2) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZSPT1 (JROF, JLEV, JBLK)=ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA&
            &%VFE_RDETAH (JLEV)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          ENDDO

        ENDDO

        ZSPT1 (:, 0, JBLK)=0.0_JPRB
        ZSPT1 (:, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
        CALL VERDISINT (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
        &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, ZSPT1(:,:, JBLK), POUTS=ZSPTO(:, JBLK))
        Z_YDVARS_SP_T1 (:, JBLK)=Z_YDVARS_SP_T1 (:, JBLK)+ZSPTO (:, JBLK)
      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          Z_YDVARS_SP_T1 (:, JBLK)=Z_YDVARS_SP_T1 (:, JBLK)+ZVWEI (:,&
          & JLEV, JBLK)*(ZDP9 (:, JLEV, JBLK)+ZC9 (:, JLEV, JBLK))
        ENDDO

      ENDIF

      LLSLINLC2=YDMODEL%YRML_DYN%YRDYNA%LSLINLC2.AND.YDMODEL%YRML_DYN%YRDYNA&
      &%NGWADVSI==1.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)

      IF (LLSLINLC2.AND..NOT.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDCPG_SL2_SPSI (JROF, JBLK)=Z_YDCPG_SL2_SPSI (JROF, JBLK&
            &)+ZVWEI (JROF, JLEV, JBLK)*ZC9_SI (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

      ELSEIF (LLSLINLC2.AND.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZSPT1 (JROF, JLEV, JBLK)=ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM&
            &%YRVETA%VFE_RDETAH (JLEV)*ZC9_SI (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

        ZSPT1 (:, 0, JBLK)=0.0_JPRB
        ZSPT1 (:, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
        CALL VERDISINT (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
        &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, ZSPT1(:,:, JBLK), POUTS=ZSPTO(:, JBLK))

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=Z_YDCPG_SL2_SPSI (JROF, JBLK)+ZSPTO (JROF, JBLK)
        ENDDO

      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:NVLAG3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => GET_HOST_DATA_RDWR (YL_ZC9)
      ZC9_SI => GET_HOST_DATA_RDWR (YL_ZC9_SI)
      ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
      ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
      ZSPTO => GET_HOST_DATA_RDWR (YL_ZSPTO)
      ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
      Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
      Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZC9 => NULL ()
    ZC9_SI => NULL ()
    ZDP9 => NULL ()
    ZSPT1 => NULL ()
    ZSPTO => NULL ()
    ZVWEI => NULL ()
    Z_YDCPG_SL2_SPSI => NULL ()
    Z_YDVARS_SP_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:NVLAG3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZC9 => GET_HOST_DATA_RDONLY (YL_ZC9)
    ZC9_SI => GET_HOST_DATA_RDONLY (YL_ZC9_SI)
    ZDP9 => GET_HOST_DATA_RDONLY (YL_ZDP9)
    ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
    ZSPTO => GET_HOST_DATA_RDWR (YL_ZSPTO)
    ZVWEI => GET_HOST_DATA_RDONLY (YL_ZVWEI)
    Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, LLSLINLC2, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPT1 (JROF, JLEV, JBLK)=ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA&
            &%VFE_RDETAH (JLEV)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          
          ENDDO

          ZSPT1 (JROF, 0, JBLK)=0.0_JPRB
          ZSPT1 (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
          CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
          &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, ZSPT1(:,:, JBLK), POUTS=ZSPTO(:, JBLK),YDSTACK=YLSTACK)
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPTO (JROF, JBLK)
        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZVWEI (JROF&
            &, JLEV, JBLK)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          ENDDO

        ENDIF

        LLSLINLC2=YDMODEL%YRML_DYN%YRDYNA%LSLINLC2.AND.YDMODEL%YRML_DYN%YRDYNA&
        &%NGWADVSI==1.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)

        IF (LLSLINLC2.AND..NOT.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDCPG_SL2_SPSI (JROF, JBLK)=Z_YDCPG_SL2_SPSI (JROF, JBLK&
            &)+ZVWEI (JROF, JLEV, JBLK)*ZC9_SI (JROF, JLEV, JBLK)
          
          ENDDO

        ELSEIF (LLSLINLC2.AND.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPT1 (JROF, JLEV, JBLK)=ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM&
            &%YRVETA%VFE_RDETAH (JLEV)*ZC9_SI (JROF, JLEV, JBLK)
          
          ENDDO

          ZSPT1 (JROF, 0, JBLK)=0.0_JPRB
          ZSPT1 (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
          CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
          &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, ZSPT1(:,:, JBLK), POUTS=ZSPTO(:, JBLK),YDSTACK=YLSTACK)
          
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=Z_YDCPG_SL2_SPSI (JROF, JBLK)+ZSPTO (JROF, JBLK)
        
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:NVLAG3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => GET_HOST_DATA_RDWR (YL_ZC9)
      ZC9_SI => GET_HOST_DATA_RDWR (YL_ZC9_SI)
      ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
      ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
      ZSPTO => GET_HOST_DATA_RDWR (YL_ZSPTO)
      ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
      Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
      Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZC9 => NULL ()
    ZC9_SI => NULL ()
    ZDP9 => NULL ()
    ZSPT1 => NULL ()
    ZSPTO => NULL ()
    ZVWEI => NULL ()
    Z_YDCPG_SL2_SPSI => NULL ()
    Z_YDVARS_SP_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:NVLAG3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZC9 => GET_DEVICE_DATA_RDONLY (YL_ZC9)
    ZC9_SI => GET_DEVICE_DATA_RDONLY (YL_ZC9_SI)
    ZDP9 => GET_DEVICE_DATA_RDONLY (YL_ZDP9)
    ZSPT1 => GET_DEVICE_DATA_RDWR (YL_ZSPT1)
    ZSPTO => GET_DEVICE_DATA_RDWR (YL_ZSPTO)
    ZVWEI => GET_DEVICE_DATA_RDONLY (YL_ZVWEI)
    Z_YDCPG_SL2_SPSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_SPSI)
    Z_YDVARS_SP_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SP%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZC9, ZC9_SI, &
      !$ACC&         ZDP9, ZSPT1, ZSPTO, ZVWEI, Z_YDCPG_SL2_SPSI, Z_YDVARS_SP_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JROF, LLSLINLC2, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPT1 (JROF, JLEV, JBLK)=ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA&
            &%VFE_RDETAH (JLEV)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          
          ENDDO

          ZSPT1 (JROF, 0, JBLK)=0.0_JPRB
          ZSPT1 (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
          CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
          &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, ZSPT1(:,:, JBLK), POUTS=ZSPTO(:, JBLK),YDSTACK=YLSTACK)
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPTO (JROF, JBLK)
        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZVWEI (JROF&
            &, JLEV, JBLK)*(ZDP9 (JROF, JLEV, JBLK)+ZC9 (JROF, JLEV, JBLK))
          ENDDO

        ENDIF

        LLSLINLC2=YDMODEL%YRML_DYN%YRDYNA%LSLINLC2.AND.YDMODEL%YRML_DYN%YRDYNA&
        &%NGWADVSI==1.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)

        IF (LLSLINLC2.AND..NOT.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDCPG_SL2_SPSI (JROF, JBLK)=Z_YDCPG_SL2_SPSI (JROF, JBLK&
            &)+ZVWEI (JROF, JLEV, JBLK)*ZC9_SI (JROF, JLEV, JBLK)
          
          ENDDO

        ELSEIF (LLSLINLC2.AND.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPT1 (JROF, JLEV, JBLK)=ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM&
            &%YRVETA%VFE_RDETAH (JLEV)*ZC9_SI (JROF, JLEV, JBLK)
          
          ENDDO

          ZSPT1 (JROF, 0, JBLK)=0.0_JPRB
          ZSPT1 (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
          CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
          &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, ZSPT1(:,:, JBLK), POUTS=ZSPTO(:, JBLK),YDSTACK=YLSTACK)
          
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=Z_YDCPG_SL2_SPSI (JROF, JBLK)+ZSPTO (JROF, JBLK)
        
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:NVLAG3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZC9 => GET_HOST_DATA_RDWR (YL_ZC9)
      ZC9_SI => GET_HOST_DATA_RDWR (YL_ZC9_SI)
      ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
      ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
      ZSPTO => GET_HOST_DATA_RDWR (YL_ZSPTO)
      ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
      Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
      Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZC9 => NULL ()
    ZC9_SI => NULL ()
    ZDP9 => NULL ()
    ZSPT1 => NULL ()
    ZSPTO => NULL ()
    ZVWEI => NULL ()
    Z_YDCPG_SL2_SPSI => NULL ()
    Z_YDVARS_SP_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:NVLAG3',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.YDMODEL%YRML_DYN%YRDYNA&
  &%LSETTLS.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF ((YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN&
  &%NCURRENT_ITER>0)).OR.YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSE
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ROTUV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_HOST_DATA_RDONLY (YL_ZP)
    ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
    ZUP9 => GET_HOST_DATA_RDONLY (YL_ZUP9)
    ZVP9 => GET_HOST_DATA_RDONLY (YL_ZVP9)
    Z_YDA_PUP9_P => GET_HOST_DATA_RDWR (YDA_PUP9%F_P)
    Z_YDA_PVP9_P => GET_HOST_DATA_RDWR (YDA_PVP9%F_P)
    Z_YDCPG_GMV9_SI_U_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9_SI%U%F_P)
    Z_YDCPG_GMV9_SI_V_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9_SI%V%F_P)
    Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%V%F_P)
    Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
    Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK&
      &), Z_YDVARS_U_T1(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.)

      IF (LDSLPHY) THEN
        CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
        &, YLCPG_BNDS%KFDIA, ZUP9(:,:, JBLK), ZVP9(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:,&
        & JBLK), Z_YDA_PUP9_P(:,:, JBLK), Z_YDA_PVP9_P(:,:, JBLK), LDIR=.FALSE.)
      ENDIF


      IF (YDMODEL%YRML_DYN%YRDYNA%LSLINL.AND.YDMODEL%YRML_DYN%YRDYNA%NGWADVSI&
        &==1.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN
        CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, Z_YDCPG_GMV9_SI_U_P(:,:, JBLK), Z_YDCPG_GMV9_SI_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK&
        &), Z_YDCPG_SL2_USI(:,:, JBLK), Z_YDCPG_SL2_VSI(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.)
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDWR (YL_ZP)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
      ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
      Z_YDA_PUP9_P => GET_HOST_DATA_RDWR (YDA_PUP9%F_P)
      Z_YDA_PVP9_P => GET_HOST_DATA_RDWR (YDA_PVP9%F_P)
      Z_YDCPG_GMV9_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%U%F_P)
      Z_YDCPG_GMV9_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%V%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
      Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP => NULL ()
    ZQ => NULL ()
    ZUP9 => NULL ()
    ZVP9 => NULL ()
    Z_YDA_PUP9_P => NULL ()
    Z_YDA_PVP9_P => NULL ()
    Z_YDCPG_GMV9_SI_U_P => NULL ()
    Z_YDCPG_GMV9_SI_V_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDCPG_SL2_USI => NULL ()
    Z_YDCPG_SL2_VSI => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ROTUV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_HOST_DATA_RDONLY (YL_ZP)
    ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
    ZUP9 => GET_HOST_DATA_RDONLY (YL_ZUP9)
    ZVP9 => GET_HOST_DATA_RDONLY (YL_ZVP9)
    Z_YDA_PUP9_P => GET_HOST_DATA_RDWR (YDA_PUP9%F_P)
    Z_YDA_PVP9_P => GET_HOST_DATA_RDWR (YDA_PVP9%F_P)
    Z_YDCPG_GMV9_SI_U_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9_SI%U%F_P)
    Z_YDCPG_GMV9_SI_V_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9_SI%V%F_P)
    Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%V%F_P)
    Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
    Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_U_T1&
        &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)

        IF (LDSLPHY) THEN
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
          &, YLCPG_BNDS%KFDIA, ZUP9(:,:, JBLK), ZVP9(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDA_PUP9_P&
          &(:,:, JBLK), Z_YDA_PVP9_P(:,:, JBLK), LDIR=.FALSE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDMODEL%YRML_DYN%YRDYNA%LSLINL.AND.YDMODEL%YRML_DYN%YRDYNA%NGWADVSI&
          &==1.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, Z_YDCPG_GMV9_SI_U_P(:,:, JBLK), Z_YDCPG_GMV9_SI_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDCPG_SL2_USI&
          &(:,:, JBLK), Z_YDCPG_SL2_VSI(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDWR (YL_ZP)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
      ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
      Z_YDA_PUP9_P => GET_HOST_DATA_RDWR (YDA_PUP9%F_P)
      Z_YDA_PVP9_P => GET_HOST_DATA_RDWR (YDA_PVP9%F_P)
      Z_YDCPG_GMV9_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%U%F_P)
      Z_YDCPG_GMV9_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%V%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
      Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP => NULL ()
    ZQ => NULL ()
    ZUP9 => NULL ()
    ZVP9 => NULL ()
    Z_YDA_PUP9_P => NULL ()
    Z_YDA_PVP9_P => NULL ()
    Z_YDCPG_GMV9_SI_U_P => NULL ()
    Z_YDCPG_GMV9_SI_V_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDCPG_SL2_USI => NULL ()
    Z_YDCPG_SL2_VSI => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ROTUV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_DEVICE_DATA_RDONLY (YL_ZP)
    ZQ => GET_DEVICE_DATA_RDONLY (YL_ZQ)
    ZUP9 => GET_DEVICE_DATA_RDONLY (YL_ZUP9)
    ZVP9 => GET_DEVICE_DATA_RDONLY (YL_ZVP9)
    Z_YDA_PUP9_P => GET_DEVICE_DATA_RDWR (YDA_PUP9%F_P)
    Z_YDA_PVP9_P => GET_DEVICE_DATA_RDWR (YDA_PVP9%F_P)
    Z_YDCPG_GMV9_SI_U_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9_SI%U%F_P)
    Z_YDCPG_GMV9_SI_V_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9_SI%V%F_P)
    Z_YDCPG_GMV9_U_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9%V%F_P)
    Z_YDCPG_SL2_USI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_USI)
    Z_YDCPG_SL2_VSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_VSI)
    Z_YDVARS_U_T1 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZP, ZQ, ZUP9, &
      !$ACC&         ZVP9, Z_YDA_PUP9_P, Z_YDA_PVP9_P, Z_YDCPG_GMV9_SI_U_P, Z_YDCPG_GMV9_SI_V_P, &
      !$ACC&         Z_YDCPG_GMV9_U_P, Z_YDCPG_GMV9_V_P, Z_YDCPG_SL2_USI, Z_YDCPG_SL2_VSI, &
      !$ACC&         Z_YDVARS_U_T1, Z_YDVARS_V_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_U_T1&
        &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)

        IF (LDSLPHY) THEN
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
          &, YLCPG_BNDS%KFDIA, ZUP9(:,:, JBLK), ZVP9(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDA_PUP9_P&
          &(:,:, JBLK), Z_YDA_PVP9_P(:,:, JBLK), LDIR=.FALSE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDMODEL%YRML_DYN%YRDYNA%LSLINL.AND.YDMODEL%YRML_DYN%YRDYNA%NGWADVSI&
          &==1.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, Z_YDCPG_GMV9_SI_U_P(:,:, JBLK), Z_YDCPG_GMV9_SI_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDCPG_SL2_USI&
          &(:,:, JBLK), Z_YDCPG_SL2_VSI(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDWR (YL_ZP)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      ZUP9 => GET_HOST_DATA_RDWR (YL_ZUP9)
      ZVP9 => GET_HOST_DATA_RDWR (YL_ZVP9)
      Z_YDA_PUP9_P => GET_HOST_DATA_RDWR (YDA_PUP9%F_P)
      Z_YDA_PVP9_P => GET_HOST_DATA_RDWR (YDA_PVP9%F_P)
      Z_YDCPG_GMV9_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%U%F_P)
      Z_YDCPG_GMV9_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%V%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
      Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP => NULL ()
    ZQ => NULL ()
    ZUP9 => NULL ()
    ZVP9 => NULL ()
    Z_YDA_PUP9_P => NULL ()
    Z_YDA_PVP9_P => NULL ()
    Z_YDCPG_GMV9_SI_U_P => NULL ()
    Z_YDCPG_GMV9_SI_V_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDCPG_SL2_USI => NULL ()
    Z_YDCPG_SL2_VSI => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUV',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:TEMP_EQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_GMV9_SI_T_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9_SI%T%F_P)
  Z_YDCPG_GMV9_T_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%T%F_P)
  Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
  Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDVARS_T_T1 (JROF, JLEV, JBLK)=Z_YDVARS_T_T1 (JROF&
        &, JLEV, JBLK)+Z_YDCPG_GMV9_T_P (JROF, JLEV, JBLK)
      ENDDO

    ENDDO


    IF (YDMODEL%YRML_DYN%YRDYNA%LSLINL.AND.YDMODEL%YRML_DYN%YRDYNA%NGWADVSI&
      &==1.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_SL2_TSI (JROF, JLEV, JBLK)=Z_YDCPG_SL2_TSI (JROF&
          &, JLEV, JBLK)+Z_YDCPG_GMV9_SI_T_P (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:TEMP_EQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%T%F_P)
    Z_YDCPG_GMV9_T_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%T%F_P)
    Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_GMV9_SI_T_P => NULL ()
  Z_YDCPG_GMV9_T_P => NULL ()
  Z_YDCPG_SL2_TSI => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:TEMP_EQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_GMV9_SI_T_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9_SI%T%F_P)
  Z_YDCPG_GMV9_T_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%T%F_P)
  Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
  Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDVARS_T_T1 (JROF, JLEV, JBLK)=Z_YDVARS_T_T1 (JROF&
        &, JLEV, JBLK)+Z_YDCPG_GMV9_T_P (JROF, JLEV, JBLK)
      
      ENDDO


      IF (YDMODEL%YRML_DYN%YRDYNA%LSLINL.AND.YDMODEL%YRML_DYN%YRDYNA%NGWADVSI&
        &==1.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_TSI (JROF, JLEV, JBLK)=Z_YDCPG_SL2_TSI (JROF&
          &, JLEV, JBLK)+Z_YDCPG_GMV9_SI_T_P (JROF, JLEV, JBLK)
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:TEMP_EQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%T%F_P)
    Z_YDCPG_GMV9_T_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%T%F_P)
    Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_GMV9_SI_T_P => NULL ()
  Z_YDCPG_GMV9_T_P => NULL ()
  Z_YDCPG_SL2_TSI => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:TEMP_EQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_GMV9_SI_T_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9_SI%T%F_P)
  Z_YDCPG_GMV9_T_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9%T%F_P)
  Z_YDCPG_SL2_TSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_TSI)
  Z_YDVARS_T_T1 => GET_DEVICE_DATA_RDWR (YDVARS%T%FT1)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDCPG_GMV9_SI_T_P, &
    !$ACC&         Z_YDCPG_GMV9_T_P, Z_YDCPG_SL2_TSI, Z_YDVARS_T_T1) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDVARS_T_T1 (JROF, JLEV, JBLK)=Z_YDVARS_T_T1 (JROF&
        &, JLEV, JBLK)+Z_YDCPG_GMV9_T_P (JROF, JLEV, JBLK)
      
      ENDDO


      IF (YDMODEL%YRML_DYN%YRDYNA%LSLINL.AND.YDMODEL%YRML_DYN%YRDYNA%NGWADVSI&
        &==1.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_TSI (JROF, JLEV, JBLK)=Z_YDCPG_SL2_TSI (JROF&
          &, JLEV, JBLK)+Z_YDCPG_GMV9_SI_T_P (JROF, JLEV, JBLK)
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:TEMP_EQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_GMV9_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMV9_SI%T%F_P)
    Z_YDCPG_GMV9_T_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%T%F_P)
    Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_GMV9_SI_T_P => NULL ()
  Z_YDCPG_GMV9_T_P => NULL ()
  Z_YDCPG_SL2_TSI => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:TEMP_EQ',1,ZHOOK_HANDLE_PARALLEL)

DO JFLD=1, SIZE (YDVARS%GFL_PTR)

  IF (YDMODEL%YRML_DYN%YRDYNA%LSLDIA.AND.(YDVARS%GFL_PTR (JFLD)%YCOMP%CNAME&
    &=='DPDETA0         ').AND.YDVARS%GFL_PTR (JFLD)%YCOMP%LGP) THEN
    ZCMSLP=YDMODEL%YRML_DYN%YRDYN%RCMSLP0/(YDMODEL%YRCST%RD*YDCPG_OPTS%RTSUR)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:DPDETA0')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZDP9 => GET_HOST_DATA_RDONLY (YL_ZDP9)
      Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
      Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELA (JLEV)+EXP (ZDP9 (JROF, JLEV&
              &, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK))*YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
            ENDDO

          ENDDO

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=(YDGEOMETRY%YRVERT_GEOM%YRVAB%VAH (JLEV)-YDGEOMETRY&
              &%YRVERT_GEOM%YRVAB%VAH (JLEV-1))+EXP (ZDP9 (JROF, JLEV, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P&
              & (JROF, JBLK))*YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
            ENDDO

          ENDDO

        ENDIF

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:DPDETA0')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
        Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZDP9 => NULL ()
      Z_YDVARS_GEOMETRY_OROG_P => NULL ()
      Z_YDVARS_GFL_PTR_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:DPDETA0')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZDP9 => GET_HOST_DATA_RDONLY (YL_ZDP9)
      Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
      Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELA (JLEV)+EXP (ZDP9 (JROF, JLEV&
              &, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK))*YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
            
            ENDDO

          ELSE

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=(YDGEOMETRY%YRVERT_GEOM%YRVAB%VAH (JLEV)-YDGEOMETRY&
              &%YRVERT_GEOM%YRVAB%VAH (JLEV-1))+EXP (ZDP9 (JROF, JLEV, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P&
              & (JROF, JBLK))*YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:DPDETA0')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
        Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZDP9 => NULL ()
      Z_YDVARS_GEOMETRY_OROG_P => NULL ()
      Z_YDVARS_GFL_PTR_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:DPDETA0')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZDP9 => GET_DEVICE_DATA_RDONLY (YL_ZDP9)
      Z_YDVARS_GEOMETRY_OROG_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
      Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YFXTRAN_ACDC_STACK, ZDP9, Z_YDVARS_GEOMETRY_OROG_P, &
        !$ACC&         Z_YDVARS_GFL_PTR_T1) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELA (JLEV)+EXP (ZDP9 (JROF, JLEV&
              &, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK))*YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
            
            ENDDO

          ELSE

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=(YDGEOMETRY%YRVERT_GEOM%YRVAB%VAH (JLEV)-YDGEOMETRY&
              &%YRVERT_GEOM%YRVAB%VAH (JLEV-1))+EXP (ZDP9 (JROF, JLEV, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P&
              & (JROF, JBLK))*YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:DPDETA0')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZDP9 => GET_HOST_DATA_RDWR (YL_ZDP9)
        Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZDP9 => NULL ()
      Z_YDVARS_GEOMETRY_OROG_P => NULL ()
      Z_YDVARS_GFL_PTR_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:DPDETA0',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF


  IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LADV) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:CVGQ')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GFL9_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_GFL9%GFL (JFLD)%F_P)
      Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
      Z_YDVARS_Q_T0 => GET_HOST_DATA_RDONLY (YDVARS%Q%FT0)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        IF ((YDVARS%GFL_PTR (JFLD)%YCOMP%CNAME=='CVGQ       &
          &     ').AND.YDVARS%GFL_PTR (JFLD)%YCOMP%LGP) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDCPG_GFL9_GFL_P&
              &  (JROF, JLEV, JBLK)-Z_YDVARS_Q_T0 (JROF, JLEV, JBLK)
            ENDDO

          ENDDO

        ELSEIF (.NOT.YDVARS%GFL_PTR (JFLD)%YCOMP%LMGRID) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T1  &
              &(JROF, JLEV, JBLK)+Z_YDCPG_GFL9_GFL_P  (JROF, JLEV, JBLK)
            ENDDO

          ENDDO

        ENDIF

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:CVGQ')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GFL9_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFL9%GFL (JFLD)%F_P)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
        Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR (YDVARS%Q%FT0)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GFL9_GFL_P => NULL ()
      Z_YDVARS_GFL_PTR_T1 => NULL ()
      Z_YDVARS_Q_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:CVGQ')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GFL9_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_GFL9%GFL (JFLD)%F_P)
      Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
      Z_YDVARS_Q_T0 => GET_HOST_DATA_RDONLY (YDVARS%Q%FT0)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          IF ((YDVARS%GFL_PTR (JFLD)%YCOMP%CNAME=='CVGQ       &
            &     ').AND.YDVARS%GFL_PTR (JFLD)%YCOMP%LGP) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDCPG_GFL9_GFL_P&
              &  (JROF, JLEV, JBLK)-Z_YDVARS_Q_T0 (JROF, JLEV, JBLK)
            
            ENDDO

          ELSEIF (.NOT.YDVARS%GFL_PTR (JFLD)%YCOMP%LMGRID) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T1  &
              &(JROF, JLEV, JBLK)+Z_YDCPG_GFL9_GFL_P  (JROF, JLEV, JBLK)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:CVGQ')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GFL9_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFL9%GFL (JFLD)%F_P)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
        Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR (YDVARS%Q%FT0)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GFL9_GFL_P => NULL ()
      Z_YDVARS_GFL_PTR_T1 => NULL ()
      Z_YDVARS_Q_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:CVGQ')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GFL9_GFL_P => GET_DEVICE_DATA_RDONLY (YDCPG_GFL9%GFL (JFLD)%F_P)
      Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
      Z_YDVARS_Q_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%Q%FT0)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDVARS, YFXTRAN_ACDC_STACK, Z_YDCPG_GFL9_GFL_P, &
        !$ACC&         Z_YDVARS_GFL_PTR_T1, Z_YDVARS_Q_T0) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          IF ((YDVARS%GFL_PTR (JFLD)%YCOMP%CNAME=='CVGQ       &
            &     ').AND.YDVARS%GFL_PTR (JFLD)%YCOMP%LGP) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDCPG_GFL9_GFL_P&
              &  (JROF, JLEV, JBLK)-Z_YDVARS_Q_T0 (JROF, JLEV, JBLK)
            
            ENDDO

          ELSEIF (.NOT.YDVARS%GFL_PTR (JFLD)%YCOMP%LMGRID) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T1  &
              &(JROF, JLEV, JBLK)+Z_YDCPG_GFL9_GFL_P  (JROF, JLEV, JBLK)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:CVGQ')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_GFL9_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFL9%GFL (JFLD)%F_P)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
        Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR (YDVARS%Q%FT0)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_GFL9_GFL_P => NULL ()
      Z_YDVARS_GFL_PTR_T1 => NULL ()
      Z_YDVARS_Q_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:CVGQ',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF

ENDDO


IF (YDMODEL%YRML_GCONF%YGFL%YCVGQ%LSP) THEN
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:YCVGQ')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVGQ_T1 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT1)
    Z_YDVARS_Q_T1 => GET_HOST_DATA_RDONLY (YDVARS%Q%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      Z_YDVARS_CVGQ_T1 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_Q_T1&
      & (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:YCVGQ')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVGQ_T1 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT1)
      Z_YDVARS_Q_T1 => GET_HOST_DATA_RDWR (YDVARS%Q%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVGQ_T1 => NULL ()
    Z_YDVARS_Q_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:YCVGQ')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVGQ_T1 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT1)
    Z_YDVARS_Q_T1 => GET_HOST_DATA_RDONLY (YDVARS%Q%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        Z_YDVARS_CVGQ_T1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_Q_T1&
        & (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:YCVGQ')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVGQ_T1 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT1)
      Z_YDVARS_Q_T1 => GET_HOST_DATA_RDWR (YDVARS%Q%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVGQ_T1 => NULL ()
    Z_YDVARS_Q_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:YCVGQ')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVGQ_T1 => GET_DEVICE_DATA_RDWR (YDVARS%CVGQ%FT1)
    Z_YDVARS_Q_T1 => GET_DEVICE_DATA_RDONLY (YDVARS%Q%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YFXTRAN_ACDC_STACK, Z_YDVARS_CVGQ_T1, &
      !$ACC&         Z_YDVARS_Q_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDVARS_CVGQ_T1 (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, JBLK), Z_YDVARS_Q_T1 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:YCVGQ')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVGQ_T1 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT1)
      Z_YDVARS_Q_T1 => GET_HOST_DATA_RDWR (YDVARS%Q%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVGQ_T1 => NULL ()
    Z_YDVARS_Q_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:YCVGQ',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN) THEN
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN) THEN
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:L_RDRY_VD')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRT1 => GET_HOST_DATA_RDWR (YL_ZRT1)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDONLY (YDVARS%T%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZRT1 (JROF, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDVARS_T_T1 (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:L_RDRY_VD')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRT1 => GET_HOST_DATA_RDWR (YL_ZRT1)
      Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRT1 => NULL ()
    Z_YDVARS_T_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:L_RDRY_VD')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRT1 => GET_HOST_DATA_RDWR (YL_ZRT1)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDONLY (YDVARS%T%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF

        

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZRT1 (JROF, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDVARS_T_T1 (JROF, JLEV, JBLK)
        
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:L_RDRY_VD')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRT1 => GET_HOST_DATA_RDWR (YL_ZRT1)
      Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRT1 => NULL ()
    Z_YDVARS_T_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:L_RDRY_VD')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRT1 => GET_DEVICE_DATA_RDWR (YL_ZRT1)
    Z_YDVARS_T_T1 => GET_DEVICE_DATA_RDONLY (YDVARS%T%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZRT1, Z_YDVARS_T_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF

        

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZRT1 (JROF, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDVARS_T_T1 (JROF, JLEV, JBLK)
        
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:L_RDRY_VD')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRT1 => GET_HOST_DATA_RDWR (YL_ZRT1)
      Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRT1 => NULL ()
    Z_YDVARS_T_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:L_RDRY_VD',1,ZHOOK_HANDLE_PARALLEL)
ELSE
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYN%LADVF.AND..NOT.(YDMODEL%YRML_DYN%YRDYNA&
  &%LPC_CHEAP.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER>0)) THEN
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:LACONE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_HOST_DATA_RDONLY (YL_ZP)
    ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDONLY (YDA_PCCO%F_P)
    Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
    Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
    Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      IF (YDCPG_OPTS%LRPLANE) THEN
        Z_YDCPG_GMV9_U_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDA_PCCO_P (:&
        &, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK)
        Z_YDCPG_GMV9_V_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDA_PCCO_P (:&
        &, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK)
      ELSE
        CALL LACONE (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG,&
        & YDGEOMETRY%YRGEM%NSTTYP, YDCPG_OPTS%N2DINI, YDMODEL%YRML_DYN%YRDYN%YRSWE, YDMODEL%YRCST%ROMEGA, ZDSTRET&
        &, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDGEOMETRY%YRGEM%RMUCEN, YDMODEL%YRCST%RA, YDMODEL&
        &%YRCST%RPI, Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
        &%YYTCCO%M_RLAT, JBLK), Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK))
      ENDIF


      IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF&
            &, JLEV, JBLK)+Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
            Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF&
            &, JLEV, JBLK)+Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

      ELSE
        CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK&
        &), Z_YDVARS_U_T1(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.)
      ENDIF


      IF (.NOT.YDMODEL%YRML_DYN%YRDYN%L2TLFF.AND.YDMODEL%YRML_DYN%YRDYNA&
        &%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN

        IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_PCF_U_PC_PH (JROF, JLEV, JBLK)=Z_YDVARS_PCF_U_PC_PH&
              & (JROF, JLEV, JBLK)+Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              Z_YDVARS_PCF_V_PC_PH (JROF, JLEV, JBLK)=Z_YDVARS_PCF_V_PC_PH&
              & (JROF, JLEV, JBLK)+Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            ENDDO

          ENDDO

        ELSE
          CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_PCF_U_PC_PH&
          &(:,:, JBLK), Z_YDVARS_PCF_V_PC_PH(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.)
        ENDIF

      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LACONE')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDWR (YL_ZP)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
      Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP => NULL ()
    ZQ => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDVARS_PCF_U_PC_PH => NULL ()
    Z_YDVARS_PCF_V_PC_PH => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:LACONE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_HOST_DATA_RDONLY (YL_ZP)
    ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDONLY (YDA_PCCO%F_P)
    Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
    Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
    Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDCPG_OPTS%LRPLANE) THEN
          Z_YDCPG_GMV9_U_P (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDA_PCCO_P (JROF&
          &, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK)
          Z_YDCPG_GMV9_V_P (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDA_PCCO_P (JROF&
          &, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK)
        ELSE
          CALL LACONE_OPENACC (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP, YDCPG_OPTS%N2DINI, YDMODEL%YRML_DYN%YRDYN%YRSWE&
          &, YDMODEL%YRCST%ROMEGA, ZDSTRET, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDGEOMETRY&
          &%YRGEM%RMUCEN, YDMODEL%YRCST%RA, YDMODEL%YRCST%RPI, Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
          &%YYTCCO%M_RLON, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK), Z_YDCPG_GMV9_U_P&
          &(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF&
            &, JLEV, JBLK)+Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
            Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF&
            &, JLEV, JBLK)+Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
          
          ENDDO

        ELSE
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_U_T1&
          &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (.NOT.YDMODEL%YRML_DYN%YRDYN%L2TLFF.AND.YDMODEL%YRML_DYN%YRDYNA&
          &%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN

          IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_PCF_U_PC_PH (JROF, JLEV, JBLK)=Z_YDVARS_PCF_U_PC_PH&
              & (JROF, JLEV, JBLK)+Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              Z_YDVARS_PCF_V_PC_PH (JROF, JLEV, JBLK)=Z_YDVARS_PCF_V_PC_PH&
              & (JROF, JLEV, JBLK)+Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            
            ENDDO

          ELSE
            CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
            &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK&
            &), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_PCF_U_PC_PH(:,:, JBLK), Z_YDVARS_PCF_V_PC_PH&
            &(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDIF

        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LACONE')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDWR (YL_ZP)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
      Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP => NULL ()
    ZQ => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDVARS_PCF_U_PC_PH => NULL ()
    Z_YDVARS_PCF_V_PC_PH => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:LACONE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP => GET_DEVICE_DATA_RDONLY (YL_ZP)
    ZQ => GET_DEVICE_DATA_RDONLY (YL_ZQ)
    Z_YDA_PCCO_P => GET_DEVICE_DATA_RDONLY (YDA_PCCO%F_P)
    Z_YDCPG_GMV9_U_P => GET_DEVICE_DATA_RDWR (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_DEVICE_DATA_RDWR (YDCPG_GMV9%V%F_P)
    Z_YDVARS_PCF_U_PC_PH => GET_DEVICE_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
    Z_YDVARS_PCF_V_PC_PH => GET_DEVICE_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
    Z_YDVARS_U_T1 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZP, ZQ, Z_YDA_PCCO_P, &
      !$ACC&         Z_YDCPG_GMV9_U_P, Z_YDCPG_GMV9_V_P, Z_YDVARS_PCF_U_PC_PH, &
      !$ACC&         Z_YDVARS_PCF_V_PC_PH, Z_YDVARS_U_T1, Z_YDVARS_V_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDCPG_OPTS%LRPLANE) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDCPG_GMV9_U_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)&
          &, Z_YDA_PCCO_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDCPG_GMV9_V_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)&
          &, Z_YDA_PCCO_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK))
        ELSE
          CALL LACONE_OPENACC (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP, YDCPG_OPTS%N2DINI, YDMODEL%YRML_DYN%YRDYN%YRSWE&
          &, YDMODEL%YRCST%ROMEGA, ZDSTRET, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDGEOMETRY&
          &%YRGEM%RMUCEN, YDMODEL%YRCST%RA, YDMODEL%YRCST%RPI, Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
          &%YYTCCO%M_RLON, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK), Z_YDCPG_GMV9_U_P&
          &(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF&
            &, JLEV, JBLK)+Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
            Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF&
            &, JLEV, JBLK)+Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
          
          ENDDO

        ELSE
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_U_T1&
          &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (.NOT.YDMODEL%YRML_DYN%YRDYN%L2TLFF.AND.YDMODEL%YRML_DYN%YRDYNA&
          &%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN

          IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_PCF_U_PC_PH (JROF, JLEV, JBLK)=Z_YDVARS_PCF_U_PC_PH&
              & (JROF, JLEV, JBLK)+Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              Z_YDVARS_PCF_V_PC_PH (JROF, JLEV, JBLK)=Z_YDVARS_PCF_V_PC_PH&
              & (JROF, JLEV, JBLK)+Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            
            ENDDO

          ELSE
            CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
            &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK&
            &), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_PCF_U_PC_PH(:,:, JBLK), Z_YDVARS_PCF_V_PC_PH&
            &(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDIF

        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LACONE')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDWR (YL_ZP)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
      Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP => NULL ()
    ZQ => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDVARS_PCF_U_PC_PH => NULL ()
    Z_YDVARS_PCF_V_PC_PH => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LACONE',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_DYN%YRDYN%L2TLFF.AND..NOT.(YDMODEL%YRML_DYN%YRDYNA&
  &%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER>0))) THEN

  IF (YDCPG_OPTS%LRPLANE) THEN
    
    
    
    
    
    
    CALL ABOR1 ("ERROR: WRONG SETTINGS")
    
  ELSE
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:LARCHE')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDONLY (YL_ZP)
      ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
      ZUT1 => GET_HOST_DATA_RDWR (YL_ZUT1)
      ZUZ9 => GET_HOST_DATA_RDONLY (YL_ZUZ9)
      ZVT1 => GET_HOST_DATA_RDWR (YL_ZVT1)
      ZVZ9 => GET_HOST_DATA_RDONLY (YL_ZVZ9)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
      Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
      Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
      Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCOLON%FT0)
      Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RSILON%FT0)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, ZPP1, ZPP9, ZQQ1, ZQQ9) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

            IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN
              ZUT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(Z_YDVARS_U_T1 (JROF, JLEV, JBLK)+ZUZ9&
              & (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              ZVT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(Z_YDVARS_V_T1 (JROF, JLEV, JBLK)+ZVZ9&
              & (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            ELSE
              ZPP9=Z_YDA_PCCO_P (JROF, JLEV, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK)
              ZQQ9=Z_YDA_PCCO_P (JROF, JLEV, YDMODEL%YRML_DYN%YYTCCO%M_RQY, JBLK)
              ZPP1=Z_YDVARS_GEOMETRY_GNORDM_T0 (JROF, JBLK)
              ZQQ1=-Z_YDVARS_GEOMETRY_GNORDL_T0 (JROF, JBLK)
              ZUT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(ZPP1*Z_YDVARS_U_T1&
              & (JROF, JLEV, JBLK)+ZQQ1*Z_YDVARS_V_T1 (JROF, JLEV, JBLK)+ZPP9*ZUZ9 (JROF, JLEV, JBLK&
              &)+ZQQ9*ZVZ9 (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*(ZPP1*Z_YDCPG_GMV9_U_P&
              & (JROF, JLEV, JBLK)+ZQQ1*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK))
              ZVT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(-ZQQ1*Z_YDVARS_U_T1&
              & (JROF, JLEV, JBLK)+ZPP1*Z_YDVARS_V_T1 (JROF, JLEV, JBLK)-ZQQ9*ZUZ9 (JROF, JLEV, JBLK&
              &)+ZPP9*ZVZ9 (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*(-ZQQ1*Z_YDCPG_GMV9_U_P&
              & (JROF, JLEV, JBLK)+ZPP1*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK))
            ENDIF

          ENDDO

        ENDDO

        CALL MCOORDS (YDMODEL%YRML_DYN%YYTSCO, YDMODEL%YRML_GCONF%YRRIP, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDMODEL%YRCST%RA, Z_YDVARS_GEOMETRY_GEMU_P&
        &(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P&
        &(:, JBLK), ZUT1(:,:, JBLK), ZVT1(:,:, JBLK), Z_YDA_PSCO_P(:,:,:, JBLK), YDMODEL%YRML_DYN&
        &%YRDYNA%LTWOTL, LD2TLM=.FALSE.)

        IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF&
              &, JLEV, JBLK)-Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF&
              &, JLEV, JBLK)-Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            ENDDO

          ENDDO

        ELSE
          CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK&
          &), Z_YDVARS_U_T1(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDSUB=.TRUE.)
        ENDIF

        CALL LARCHE (YDMODEL%YRML_DYN%YYTCCO, YDMODEL%YRML_DYN%YYTSCO, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP, ZDSTRET, YDGEOMETRY%YRGEM&
        &%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDMODEL%YRCST%RPI, ZDEPI, YDGEOMETRY%YRGEM%RLOCEN, YDGEOMETRY%YRGEM&
        &%RMUCEN, Z_YDA_PSCO_P(:,:,:, JBLK), 1, Z_YDA_PCCO_P(:,:,:, JBLK), Z_YDVARS_GEOMETRY_RCOLON_P(:, JBLK&
        &), Z_YDVARS_GEOMETRY_RSILON_P(:, JBLK), Z_YDVARS_GEOMETRY_GECLO_P(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_P&
        &(:, JBLK), Z_YDVARS_GEOMETRY_GESLO_P(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P(:, JBLK))
        CALL LACONE (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG,&
        & YDGEOMETRY%YRGEM%NSTTYP, YDCPG_OPTS%N2DINI, YDMODEL%YRML_DYN%YRDYN%YRSWE, YDMODEL%YRCST%ROMEGA, ZDSTRET&
        &, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDGEOMETRY%YRGEM%RMUCEN, YDMODEL%YRCST%RA, YDMODEL&
        &%YRCST%RPI, Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RLON, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
        &%YYTCCO%M_RLAT, JBLK), Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK))
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LARCHE')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZP => GET_HOST_DATA_RDWR (YL_ZP)
        ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
        ZUT1 => GET_HOST_DATA_RDWR (YL_ZUT1)
        ZUZ9 => GET_HOST_DATA_RDWR (YL_ZUZ9)
        ZVT1 => GET_HOST_DATA_RDWR (YL_ZVT1)
        ZVZ9 => GET_HOST_DATA_RDWR (YL_ZVZ9)
        Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
        Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
        Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
        Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
        Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
        Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
        Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
        Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
        Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
        Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
        Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
        Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCOLON%FT0)
        Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RSILON%FT0)
        Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
        Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZP => NULL ()
      ZQ => NULL ()
      ZUT1 => NULL ()
      ZUZ9 => NULL ()
      ZVT1 => NULL ()
      ZVZ9 => NULL ()
      Z_YDA_PCCO_P => NULL ()
      Z_YDA_PSCO_P => NULL ()
      Z_YDCPG_GMV9_U_P => NULL ()
      Z_YDCPG_GMV9_V_P => NULL ()
      Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
      Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
      Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
      Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
      Z_YDVARS_GEOMETRY_RCOLON_P => NULL ()
      Z_YDVARS_GEOMETRY_RSILON_P => NULL ()
      Z_YDVARS_U_T1 => NULL ()
      Z_YDVARS_V_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:LARCHE')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_HOST_DATA_RDONLY (YL_ZP)
      ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
      ZUT1 => GET_HOST_DATA_RDWR (YL_ZUT1)
      ZUZ9 => GET_HOST_DATA_RDONLY (YL_ZUZ9)
      ZVT1 => GET_HOST_DATA_RDWR (YL_ZVT1)
      ZVZ9 => GET_HOST_DATA_RDONLY (YL_ZVZ9)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
      Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
      Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
      Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCOLON%FT0)
      Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RSILON%FT0)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK, ZPP1, ZPP9, ZQQ1, ZQQ9)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

          

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            

            IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN
              ZUT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(Z_YDVARS_U_T1 (JROF, JLEV, JBLK)+ZUZ9&
              & (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              ZVT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(Z_YDVARS_V_T1 (JROF, JLEV, JBLK)+ZVZ9&
              & (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            ELSE
              ZPP9=Z_YDA_PCCO_P (JROF, JLEV, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK)
              ZQQ9=Z_YDA_PCCO_P (JROF, JLEV, YDMODEL%YRML_DYN%YYTCCO%M_RQY, JBLK)
              ZPP1=Z_YDVARS_GEOMETRY_GNORDM_T0 (JROF, JBLK)
              ZQQ1=-Z_YDVARS_GEOMETRY_GNORDL_T0 (JROF, JBLK)
              ZUT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(ZPP1*Z_YDVARS_U_T1&
              & (JROF, JLEV, JBLK)+ZQQ1*Z_YDVARS_V_T1 (JROF, JLEV, JBLK)+ZPP9*ZUZ9 (JROF, JLEV, JBLK&
              &)+ZQQ9*ZVZ9 (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*(ZPP1*Z_YDCPG_GMV9_U_P&
              & (JROF, JLEV, JBLK)+ZQQ1*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK))
              ZVT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(-ZQQ1*Z_YDVARS_U_T1&
              & (JROF, JLEV, JBLK)+ZPP1*Z_YDVARS_V_T1 (JROF, JLEV, JBLK)-ZQQ9*ZUZ9 (JROF, JLEV, JBLK&
              &)+ZPP9*ZVZ9 (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*(-ZQQ1*Z_YDCPG_GMV9_U_P&
              & (JROF, JLEV, JBLK)+ZPP1*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK))
            ENDIF

          
          ENDDO

          CALL MCOORDS_OPENACC (YDMODEL%YRML_DYN%YYTSCO, YDMODEL%YRML_GCONF%YRRIP, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDMODEL%YRCST%RA, Z_YDVARS_GEOMETRY_GEMU_P&
          &(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P&
          &(:, JBLK), ZUT1(:,:, JBLK), ZVT1(:,:, JBLK), Z_YDA_PSCO_P(:,:,:, JBLK), YDMODEL%YRML_DYN%YRDYNA&
          &%LTWOTL, LD2TLM=.FALSE.,YDSTACK=YLSTACK)

          IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF&
              &, JLEV, JBLK)-Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF&
              &, JLEV, JBLK)-Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            
            ENDDO

          ELSE
            CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
            &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_U_T1&
            &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDSUB=.TRUE.,YDSTACK=YLSTACK)
          ENDIF

          CALL LARCHE_OPENACC (YDMODEL%YRML_DYN%YYTCCO, YDMODEL%YRML_DYN%YYTSCO, YDGEOMETRY%YRDIM%NPROMA&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP&
          &, ZDSTRET, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDMODEL%YRCST%RPI, ZDEPI, YDGEOMETRY&
          &%YRGEM%RLOCEN, YDGEOMETRY%YRGEM%RMUCEN, Z_YDA_PSCO_P(:,:,:, JBLK), 1, Z_YDA_PCCO_P(:,:,&
          &:, JBLK), Z_YDVARS_GEOMETRY_RCOLON_P(:, JBLK), Z_YDVARS_GEOMETRY_RSILON_P(:, JBLK), Z_YDVARS_GEOMETRY_GECLO_P&
          &(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_P(:, JBLK), Z_YDVARS_GEOMETRY_GESLO_P(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P&
          &(:, JBLK),YDSTACK=YLSTACK)
          CALL LACONE_OPENACC (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP, YDCPG_OPTS%N2DINI, YDMODEL%YRML_DYN%YRDYN%YRSWE&
          &, YDMODEL%YRCST%ROMEGA, ZDSTRET, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDGEOMETRY&
          &%YRGEM%RMUCEN, YDMODEL%YRCST%RA, YDMODEL%YRCST%RPI, Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
          &%YYTCCO%M_RLON, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK), Z_YDCPG_GMV9_U_P&
          &(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LARCHE')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZP => GET_HOST_DATA_RDWR (YL_ZP)
        ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
        ZUT1 => GET_HOST_DATA_RDWR (YL_ZUT1)
        ZUZ9 => GET_HOST_DATA_RDWR (YL_ZUZ9)
        ZVT1 => GET_HOST_DATA_RDWR (YL_ZVT1)
        ZVZ9 => GET_HOST_DATA_RDWR (YL_ZVZ9)
        Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
        Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
        Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
        Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
        Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
        Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
        Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
        Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
        Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
        Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
        Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
        Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCOLON%FT0)
        Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RSILON%FT0)
        Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
        Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZP => NULL ()
      ZQ => NULL ()
      ZUT1 => NULL ()
      ZUZ9 => NULL ()
      ZVT1 => NULL ()
      ZVZ9 => NULL ()
      Z_YDA_PCCO_P => NULL ()
      Z_YDA_PSCO_P => NULL ()
      Z_YDCPG_GMV9_U_P => NULL ()
      Z_YDCPG_GMV9_V_P => NULL ()
      Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
      Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
      Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
      Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
      Z_YDVARS_GEOMETRY_RCOLON_P => NULL ()
      Z_YDVARS_GEOMETRY_RSILON_P => NULL ()
      Z_YDVARS_U_T1 => NULL ()
      Z_YDVARS_V_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:LARCHE')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZP => GET_DEVICE_DATA_RDONLY (YL_ZP)
      ZQ => GET_DEVICE_DATA_RDONLY (YL_ZQ)
      ZUT1 => GET_DEVICE_DATA_RDWR (YL_ZUT1)
      ZUZ9 => GET_DEVICE_DATA_RDONLY (YL_ZUZ9)
      ZVT1 => GET_DEVICE_DATA_RDWR (YL_ZVT1)
      ZVZ9 => GET_DEVICE_DATA_RDONLY (YL_ZVZ9)
      Z_YDA_PCCO_P => GET_DEVICE_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDA_PSCO_P => GET_DEVICE_DATA_RDWR (YDA_PSCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_DEVICE_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_DEVICE_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_GEOMETRY_GECLO_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
      Z_YDVARS_GEOMETRY_GEMU_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GESLO_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
      Z_YDVARS_GEOMETRY_GNORDL_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_GEOMETRY_GSQM2_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
      Z_YDVARS_GEOMETRY_RCOLON_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RCOLON%FT0)
      Z_YDVARS_GEOMETRY_RSILON_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RSILON%FT0)
      Z_YDVARS_U_T1 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZP, ZQ, ZUT1, &
        !$ACC&         ZUZ9, ZVT1, ZVZ9, Z_YDA_PCCO_P, Z_YDA_PSCO_P, Z_YDCPG_GMV9_U_P, &
        !$ACC&         Z_YDCPG_GMV9_V_P, Z_YDVARS_GEOMETRY_GECLO_P, Z_YDVARS_GEOMETRY_GEMU_P, &
        !$ACC&         Z_YDVARS_GEOMETRY_GESLO_P, Z_YDVARS_GEOMETRY_GNORDL_P, &
        !$ACC&         Z_YDVARS_GEOMETRY_GNORDL_T0, Z_YDVARS_GEOMETRY_GNORDM_P, &
        !$ACC&         Z_YDVARS_GEOMETRY_GNORDM_T0, Z_YDVARS_GEOMETRY_GSQM2_P, &
        !$ACC&         Z_YDVARS_GEOMETRY_RCOLON_P, Z_YDVARS_GEOMETRY_RSILON_P, &
        !$ACC&         Z_YDVARS_U_T1, Z_YDVARS_V_T1) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK, ZPP1, ZPP9, ZQQ1, ZQQ9) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

          

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            

            IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN
              ZUT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(Z_YDVARS_U_T1 (JROF, JLEV, JBLK)+ZUZ9&
              & (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              ZVT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(Z_YDVARS_V_T1 (JROF, JLEV, JBLK)+ZVZ9&
              & (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            ELSE
              ZPP9=Z_YDA_PCCO_P (JROF, JLEV, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK)
              ZQQ9=Z_YDA_PCCO_P (JROF, JLEV, YDMODEL%YRML_DYN%YYTCCO%M_RQY, JBLK)
              ZPP1=Z_YDVARS_GEOMETRY_GNORDM_T0 (JROF, JBLK)
              ZQQ1=-Z_YDVARS_GEOMETRY_GNORDL_T0 (JROF, JBLK)
              ZUT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(ZPP1*Z_YDVARS_U_T1&
              & (JROF, JLEV, JBLK)+ZQQ1*Z_YDVARS_V_T1 (JROF, JLEV, JBLK)+ZPP9*ZUZ9 (JROF, JLEV, JBLK&
              &)+ZQQ9*ZVZ9 (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*(ZPP1*Z_YDCPG_GMV9_U_P&
              & (JROF, JLEV, JBLK)+ZQQ1*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK))
              ZVT1 (JROF, JLEV, JBLK)=YDMODEL%YRML_DYN%YRDYN%RW2TLFF*0.5_JPRB*(-ZQQ1*Z_YDVARS_U_T1&
              & (JROF, JLEV, JBLK)+ZPP1*Z_YDVARS_V_T1 (JROF, JLEV, JBLK)-ZQQ9*ZUZ9 (JROF, JLEV, JBLK&
              &)+ZPP9*ZVZ9 (JROF, JLEV, JBLK))+(1.0_JPRB-YDMODEL%YRML_DYN%YRDYN%RW2TLFF)*(-ZQQ1*Z_YDCPG_GMV9_U_P&
              & (JROF, JLEV, JBLK)+ZPP1*Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK))
            ENDIF

          
          ENDDO

          CALL MCOORDS_OPENACC (YDMODEL%YRML_DYN%YYTSCO, YDMODEL%YRML_GCONF%YRRIP, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDMODEL%YRCST%RA, Z_YDVARS_GEOMETRY_GEMU_P&
          &(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P&
          &(:, JBLK), ZUT1(:,:, JBLK), ZVT1(:,:, JBLK), Z_YDA_PSCO_P(:,:,:, JBLK), YDMODEL%YRML_DYN%YRDYNA&
          &%LTWOTL, LD2TLM=.FALSE.,YDSTACK=YLSTACK)

          IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF&
              &, JLEV, JBLK)-Z_YDCPG_GMV9_U_P (JROF, JLEV, JBLK)
              Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF&
              &, JLEV, JBLK)-Z_YDCPG_GMV9_V_P (JROF, JLEV, JBLK)
            
            ENDDO

          ELSE
            CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
            &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP(:,:, JBLK), ZQ(:,:, JBLK), Z_YDVARS_U_T1&
            &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDSUB=.TRUE.,YDSTACK=YLSTACK)
          ENDIF

          CALL LARCHE_OPENACC (YDMODEL%YRML_DYN%YYTCCO, YDMODEL%YRML_DYN%YYTSCO, YDGEOMETRY%YRDIM%NPROMA&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP&
          &, ZDSTRET, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDMODEL%YRCST%RPI, ZDEPI, YDGEOMETRY&
          &%YRGEM%RLOCEN, YDGEOMETRY%YRGEM%RMUCEN, Z_YDA_PSCO_P(:,:,:, JBLK), 1, Z_YDA_PCCO_P(:,:,&
          &:, JBLK), Z_YDVARS_GEOMETRY_RCOLON_P(:, JBLK), Z_YDVARS_GEOMETRY_RSILON_P(:, JBLK), Z_YDVARS_GEOMETRY_GECLO_P&
          &(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_P(:, JBLK), Z_YDVARS_GEOMETRY_GESLO_P(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P&
          &(:, JBLK),YDSTACK=YLSTACK)
          CALL LACONE_OPENACC (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP, YDCPG_OPTS%N2DINI, YDMODEL%YRML_DYN%YRDYN%YRSWE&
          &, YDMODEL%YRCST%ROMEGA, ZDSTRET, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY%YRGEM%RC2P1, YDGEOMETRY&
          &%YRGEM%RMUCEN, YDMODEL%YRCST%RA, YDMODEL%YRCST%RPI, Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
          &%YYTCCO%M_RLON, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RLAT, JBLK), Z_YDCPG_GMV9_U_P&
          &(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LARCHE')) THEN
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZP => GET_HOST_DATA_RDWR (YL_ZP)
        ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
        ZUT1 => GET_HOST_DATA_RDWR (YL_ZUT1)
        ZUZ9 => GET_HOST_DATA_RDWR (YL_ZUZ9)
        ZVT1 => GET_HOST_DATA_RDWR (YL_ZVT1)
        ZVZ9 => GET_HOST_DATA_RDWR (YL_ZVZ9)
        Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
        Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
        Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
        Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
        Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
        Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
        Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
        Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
        Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
        Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
        Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
        Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCOLON%FT0)
        Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RSILON%FT0)
        Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
        Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
        IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZP => NULL ()
      ZQ => NULL ()
      ZUT1 => NULL ()
      ZUZ9 => NULL ()
      ZVT1 => NULL ()
      ZVZ9 => NULL ()
      Z_YDA_PCCO_P => NULL ()
      Z_YDA_PSCO_P => NULL ()
      Z_YDCPG_GMV9_U_P => NULL ()
      Z_YDCPG_GMV9_V_P => NULL ()
      Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
      Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
      Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
      Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
      Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
      Z_YDVARS_GEOMETRY_RCOLON_P => NULL ()
      Z_YDVARS_GEOMETRY_RSILON_P => NULL ()
      Z_YDVARS_U_T1 => NULL ()
      Z_YDVARS_V_T1 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LARCHE',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:ROTUVGEO')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP2 => GET_HOST_DATA_RDWR (YL_ZP2)
    ZQ2 => GET_HOST_DATA_RDWR (YL_ZQ2)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDONLY (YDA_PCCO%F_P)
    Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%V%F_P)
    Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
    Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL ROTUVGEO (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P(:, JBLK), Z_YDA_PCCO_P&
      & (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO&
      &%M_RQY, JBLK), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), LDIR=.TRUE.)
      CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP2(:,:, JBLK), ZQ2(:,:,&
      & JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.)

      IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN
        CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), Z_YDVARS_PCF_U_PC_PH&
        &(:,:, JBLK), Z_YDVARS_PCF_V_PC_PH(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.)
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUVGEO')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP2 => GET_HOST_DATA_RDWR (YL_ZP2)
      ZQ2 => GET_HOST_DATA_RDWR (YL_ZQ2)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
      Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP2 => NULL ()
    ZQ2 => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
    Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
    Z_YDVARS_PCF_U_PC_PH => NULL ()
    Z_YDVARS_PCF_V_PC_PH => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:ROTUVGEO')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP2 => GET_HOST_DATA_RDWR (YL_ZP2)
    ZQ2 => GET_HOST_DATA_RDWR (YL_ZQ2)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDONLY (YDA_PCCO%F_P)
    Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDONLY (YDCPG_GMV9%V%F_P)
    Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
    Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ROTUVGEO_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA,&
        & YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P(:, JBLK&
        &), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
        &%YYTCCO%M_RQY, JBLK), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), LDIR=.TRUE.,YDSTACK=YLSTACK)
        CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), Z_YDVARS_U_T1&
        &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)

        IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
          &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK&
          &), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), Z_YDVARS_PCF_U_PC_PH(:,:, JBLK), Z_YDVARS_PCF_V_PC_PH&
          &(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUVGEO')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP2 => GET_HOST_DATA_RDWR (YL_ZP2)
      ZQ2 => GET_HOST_DATA_RDWR (YL_ZQ2)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
      Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP2 => NULL ()
    ZQ2 => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
    Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
    Z_YDVARS_PCF_U_PC_PH => NULL ()
    Z_YDVARS_PCF_V_PC_PH => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:ROTUVGEO')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZP2 => GET_DEVICE_DATA_RDWR (YL_ZP2)
    ZQ2 => GET_DEVICE_DATA_RDWR (YL_ZQ2)
    Z_YDA_PCCO_P => GET_DEVICE_DATA_RDONLY (YDA_PCCO%F_P)
    Z_YDCPG_GMV9_U_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9%U%F_P)
    Z_YDCPG_GMV9_V_P => GET_DEVICE_DATA_RDONLY (YDCPG_GMV9%V%F_P)
    Z_YDVARS_GEOMETRY_GNORDL_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_PCF_U_PC_PH => GET_DEVICE_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
    Z_YDVARS_PCF_V_PC_PH => GET_DEVICE_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
    Z_YDVARS_U_T1 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_V_T1 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZP2, ZQ2, &
      !$ACC&         Z_YDA_PCCO_P, Z_YDCPG_GMV9_U_P, Z_YDCPG_GMV9_V_P, Z_YDVARS_GEOMETRY_GNORDL_P, &
      !$ACC&         Z_YDVARS_GEOMETRY_GNORDM_P, Z_YDVARS_PCF_U_PC_PH, Z_YDVARS_PCF_V_PC_PH, &
      !$ACC&         Z_YDVARS_U_T1, Z_YDVARS_V_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ROTUVGEO_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA,&
        & YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_GNORDM_P(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_P(:, JBLK&
        &), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN%YYTCCO%M_RQX, JBLK), Z_YDA_PCCO_P (:,:, YDMODEL%YRML_DYN&
        &%YYTCCO%M_RQY, JBLK), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), LDIR=.TRUE.,YDSTACK=YLSTACK)
        CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), Z_YDVARS_U_T1&
        &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)

        IF (YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.AND.(YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN
          CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
          &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_GMV9_U_P(:,:, JBLK), Z_YDCPG_GMV9_V_P(:,:, JBLK&
          &), ZP2(:,:, JBLK), ZQ2(:,:, JBLK), Z_YDVARS_PCF_U_PC_PH(:,:, JBLK), Z_YDVARS_PCF_V_PC_PH&
          &(:,:, JBLK), LDIR=.FALSE., LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:ROTUVGEO')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZP2 => GET_HOST_DATA_RDWR (YL_ZP2)
      ZQ2 => GET_HOST_DATA_RDWR (YL_ZQ2)
      Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
      Z_YDCPG_GMV9_U_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%U%F_P)
      Z_YDCPG_GMV9_V_P => GET_HOST_DATA_RDWR (YDCPG_GMV9%V%F_P)
      Z_YDVARS_GEOMETRY_GNORDL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
      Z_YDVARS_GEOMETRY_GNORDM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
      Z_YDVARS_PCF_U_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_U%FPC_PH)
      Z_YDVARS_PCF_V_PC_PH => GET_HOST_DATA_RDWR (YDVARS%PCF_V%FPC_PH)
      Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
      Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZP2 => NULL ()
    ZQ2 => NULL ()
    Z_YDA_PCCO_P => NULL ()
    Z_YDCPG_GMV9_U_P => NULL ()
    Z_YDCPG_GMV9_V_P => NULL ()
    Z_YDVARS_GEOMETRY_GNORDL_P => NULL ()
    Z_YDVARS_GEOMETRY_GNORDM_P => NULL ()
    Z_YDVARS_PCF_U_PC_PH => NULL ()
    Z_YDVARS_PCF_V_PC_PH => NULL ()
    Z_YDVARS_U_T1 => NULL ()
    Z_YDVARS_V_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:ROTUVGEO',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LGWADV.OR.YDMODEL%YRML_DYN%YRDYNA%LRDBBC) THEN
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LGWADV) THEN
  
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LRDBBC) THEN
  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEB_PARALLEL:LRDBBC')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDBBC9 => GET_HOST_DATA_RDONLY (YL_ZDBBC9)
    ZDPHI9 => GET_HOST_DATA_RDONLY (YL_ZDPHI9)
    ZGWS9 => GET_HOST_DATA_RDONLY (YL_ZGWS9)
    ZOROGL_SR => GET_HOST_DATA_RDONLY (YL_ZOROGL_SR)
    ZOROGM_SR => GET_HOST_DATA_RDONLY (YL_ZOROGM_SR)
    ZUST1 => GET_HOST_DATA_RDONLY (YL_ZUST1)
    ZVST1 => GET_HOST_DATA_RDONLY (YL_ZVST1)
    Z_YDCPG_SL2_DBBC1 => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_DBBC1)
    Z_YDCPG_SL2_DPHI1 => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_DPHI1)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDVARS_SVD_T1 (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_SVD_T1 (JROF, YDGEOMETRY&
        &%YRDIMV%NFLEVG, JBLK)-0.5_JPRB*(ZDPHI9 (JROF, JBLK)+Z_YDCPG_SL2_DPHI1 (JROF, JBLK))&
        &*(ZUST1 (JROF, JBLK)*ZOROGL_SR (JROF, JBLK)+ZVST1 (JROF, JBLK)*ZOROGM_SR (JROF, JBLK&
        &)-ZGWS9 (JROF, JBLK))-(ZDBBC9 (JROF, JBLK)+Z_YDCPG_SL2_DBBC1 (JROF, JBLK))
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LRDBBC')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDBBC9 => GET_HOST_DATA_RDWR (YL_ZDBBC9)
      ZDPHI9 => GET_HOST_DATA_RDWR (YL_ZDPHI9)
      ZGWS9 => GET_HOST_DATA_RDWR (YL_ZGWS9)
      ZOROGL_SR => GET_HOST_DATA_RDWR (YL_ZOROGL_SR)
      ZOROGM_SR => GET_HOST_DATA_RDWR (YL_ZOROGM_SR)
      ZUST1 => GET_HOST_DATA_RDWR (YL_ZUST1)
      ZVST1 => GET_HOST_DATA_RDWR (YL_ZVST1)
      Z_YDCPG_SL2_DBBC1 => GET_HOST_DATA_RDWR (YDCPG_SL2%F_DBBC1)
      Z_YDCPG_SL2_DPHI1 => GET_HOST_DATA_RDWR (YDCPG_SL2%F_DPHI1)
      Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDBBC9 => NULL ()
    ZDPHI9 => NULL ()
    ZGWS9 => NULL ()
    ZOROGL_SR => NULL ()
    ZOROGM_SR => NULL ()
    ZUST1 => NULL ()
    ZVST1 => NULL ()
    Z_YDCPG_SL2_DBBC1 => NULL ()
    Z_YDCPG_SL2_DPHI1 => NULL ()
    Z_YDVARS_SVD_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEB_PARALLEL:LRDBBC')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDBBC9 => GET_HOST_DATA_RDONLY (YL_ZDBBC9)
    ZDPHI9 => GET_HOST_DATA_RDONLY (YL_ZDPHI9)
    ZGWS9 => GET_HOST_DATA_RDONLY (YL_ZGWS9)
    ZOROGL_SR => GET_HOST_DATA_RDONLY (YL_ZOROGL_SR)
    ZOROGM_SR => GET_HOST_DATA_RDONLY (YL_ZOROGM_SR)
    ZUST1 => GET_HOST_DATA_RDONLY (YL_ZUST1)
    ZVST1 => GET_HOST_DATA_RDONLY (YL_ZVST1)
    Z_YDCPG_SL2_DBBC1 => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_DBBC1)
    Z_YDCPG_SL2_DPHI1 => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_DPHI1)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        
        Z_YDVARS_SVD_T1 (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_SVD_T1 (JROF, YDGEOMETRY&
        &%YRDIMV%NFLEVG, JBLK)-0.5_JPRB*(ZDPHI9 (JROF, JBLK)+Z_YDCPG_SL2_DPHI1 (JROF, JBLK))&
        &*(ZUST1 (JROF, JBLK)*ZOROGL_SR (JROF, JBLK)+ZVST1 (JROF, JBLK)*ZOROGM_SR (JROF, JBLK&
        &)-ZGWS9 (JROF, JBLK))-(ZDBBC9 (JROF, JBLK)+Z_YDCPG_SL2_DBBC1 (JROF, JBLK))
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LRDBBC')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDBBC9 => GET_HOST_DATA_RDWR (YL_ZDBBC9)
      ZDPHI9 => GET_HOST_DATA_RDWR (YL_ZDPHI9)
      ZGWS9 => GET_HOST_DATA_RDWR (YL_ZGWS9)
      ZOROGL_SR => GET_HOST_DATA_RDWR (YL_ZOROGL_SR)
      ZOROGM_SR => GET_HOST_DATA_RDWR (YL_ZOROGM_SR)
      ZUST1 => GET_HOST_DATA_RDWR (YL_ZUST1)
      ZVST1 => GET_HOST_DATA_RDWR (YL_ZVST1)
      Z_YDCPG_SL2_DBBC1 => GET_HOST_DATA_RDWR (YDCPG_SL2%F_DBBC1)
      Z_YDCPG_SL2_DPHI1 => GET_HOST_DATA_RDWR (YDCPG_SL2%F_DPHI1)
      Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDBBC9 => NULL ()
    ZDPHI9 => NULL ()
    ZGWS9 => NULL ()
    ZOROGL_SR => NULL ()
    ZOROGM_SR => NULL ()
    ZUST1 => NULL ()
    ZVST1 => NULL ()
    Z_YDCPG_SL2_DBBC1 => NULL ()
    Z_YDCPG_SL2_DPHI1 => NULL ()
    Z_YDVARS_SVD_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEB_PARALLEL:LRDBBC')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDBBC9 => GET_DEVICE_DATA_RDONLY (YL_ZDBBC9)
    ZDPHI9 => GET_DEVICE_DATA_RDONLY (YL_ZDPHI9)
    ZGWS9 => GET_DEVICE_DATA_RDONLY (YL_ZGWS9)
    ZOROGL_SR => GET_DEVICE_DATA_RDONLY (YL_ZOROGL_SR)
    ZOROGM_SR => GET_DEVICE_DATA_RDONLY (YL_ZOROGM_SR)
    ZUST1 => GET_DEVICE_DATA_RDONLY (YL_ZUST1)
    ZVST1 => GET_DEVICE_DATA_RDONLY (YL_ZVST1)
    Z_YDCPG_SL2_DBBC1 => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_DBBC1)
    Z_YDCPG_SL2_DPHI1 => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_DPHI1)
    Z_YDVARS_SVD_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SVD%FT1)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YFXTRAN_ACDC_STACK, ZDBBC9, ZDPHI9, ZGWS9, &
      !$ACC&         ZOROGL_SR, ZOROGM_SR, ZUST1, ZVST1, Z_YDCPG_SL2_DBBC1, Z_YDCPG_SL2_DPHI1, &
      !$ACC&         Z_YDVARS_SVD_T1) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        
        Z_YDVARS_SVD_T1 (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_SVD_T1 (JROF, YDGEOMETRY&
        &%YRDIMV%NFLEVG, JBLK)-0.5_JPRB*(ZDPHI9 (JROF, JBLK)+Z_YDCPG_SL2_DPHI1 (JROF, JBLK))&
        &*(ZUST1 (JROF, JBLK)*ZOROGL_SR (JROF, JBLK)+ZVST1 (JROF, JBLK)*ZOROGM_SR (JROF, JBLK&
        &)-ZGWS9 (JROF, JBLK))-(ZDBBC9 (JROF, JBLK)+Z_YDCPG_SL2_DBBC1 (JROF, JBLK))
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEB_PARALLEL:LRDBBC')) THEN
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDBBC9 => GET_HOST_DATA_RDWR (YL_ZDBBC9)
      ZDPHI9 => GET_HOST_DATA_RDWR (YL_ZDPHI9)
      ZGWS9 => GET_HOST_DATA_RDWR (YL_ZGWS9)
      ZOROGL_SR => GET_HOST_DATA_RDWR (YL_ZOROGL_SR)
      ZOROGM_SR => GET_HOST_DATA_RDWR (YL_ZOROGM_SR)
      ZUST1 => GET_HOST_DATA_RDWR (YL_ZUST1)
      ZVST1 => GET_HOST_DATA_RDWR (YL_ZVST1)
      Z_YDCPG_SL2_DBBC1 => GET_HOST_DATA_RDWR (YDCPG_SL2%F_DBBC1)
      Z_YDCPG_SL2_DPHI1 => GET_HOST_DATA_RDWR (YDCPG_SL2%F_DPHI1)
      Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
      IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDBBC9 => NULL ()
    ZDPHI9 => NULL ()
    ZGWS9 => NULL ()
    ZOROGL_SR => NULL ()
    ZOROGM_SR => NULL ()
    ZUST1 => NULL ()
    ZVST1 => NULL ()
    Z_YDCPG_SL2_DBBC1 => NULL ()
    Z_YDCPG_SL2_DPHI1 => NULL ()
    Z_YDVARS_SVD_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LAPINEB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL:LRDBBC',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN.AND.YDMODEL%YRML_DYN%YRDYNA%LGWADV.AND.YDMODEL&
  &%YRML_DYN%YRDYNA%NGWADVSI==2.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF




CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZC9)) CALL FIELD_DELETE (YL_ZC9)
IF (ASSOCIATED (YL_ZC9_NL)) CALL FIELD_DELETE (YL_ZC9_NL)
IF (ASSOCIATED (YL_ZC9_SI)) CALL FIELD_DELETE (YL_ZC9_SI)
IF (ASSOCIATED (YL_ZDBBC9)) CALL FIELD_DELETE (YL_ZDBBC9)
IF (ASSOCIATED (YL_ZDP9)) CALL FIELD_DELETE (YL_ZDP9)
IF (ASSOCIATED (YL_ZDPHI9)) CALL FIELD_DELETE (YL_ZDPHI9)
IF (ASSOCIATED (YL_ZGMDTX)) CALL FIELD_DELETE (YL_ZGMDTX)
IF (ASSOCIATED (YL_ZGMDTY)) CALL FIELD_DELETE (YL_ZGMDTY)
IF (ASSOCIATED (YL_ZGWS9)) CALL FIELD_DELETE (YL_ZGWS9)
IF (ASSOCIATED (YL_ZINEZV)) CALL FIELD_DELETE (YL_ZINEZV)
IF (ASSOCIATED (YL_ZNHYT0)) CALL FIELD_DELETE (YL_ZNHYT0)
IF (ASSOCIATED (YL_ZOROGL_SR)) CALL FIELD_DELETE (YL_ZOROGL_SR)
IF (ASSOCIATED (YL_ZOROGM_SR)) CALL FIELD_DELETE (YL_ZOROGM_SR)
IF (ASSOCIATED (YL_ZP)) CALL FIELD_DELETE (YL_ZP)
IF (ASSOCIATED (YL_ZP2)) CALL FIELD_DELETE (YL_ZP2)
IF (ASSOCIATED (YL_ZQ)) CALL FIELD_DELETE (YL_ZQ)
IF (ASSOCIATED (YL_ZQ2)) CALL FIELD_DELETE (YL_ZQ2)
IF (ASSOCIATED (YL_ZR1)) CALL FIELD_DELETE (YL_ZR1)
IF (ASSOCIATED (YL_ZRT1)) CALL FIELD_DELETE (YL_ZRT1)
IF (ASSOCIATED (YL_ZSPT1)) CALL FIELD_DELETE (YL_ZSPT1)
IF (ASSOCIATED (YL_ZSPTO)) CALL FIELD_DELETE (YL_ZSPTO)
IF (ASSOCIATED (YL_ZSVDT1)) CALL FIELD_DELETE (YL_ZSVDT1)
IF (ASSOCIATED (YL_ZUP9)) CALL FIELD_DELETE (YL_ZUP9)
IF (ASSOCIATED (YL_ZUST1)) CALL FIELD_DELETE (YL_ZUST1)
IF (ASSOCIATED (YL_ZUT1)) CALL FIELD_DELETE (YL_ZUT1)
IF (ASSOCIATED (YL_ZUZ9)) CALL FIELD_DELETE (YL_ZUZ9)
IF (ASSOCIATED (YL_ZVP9)) CALL FIELD_DELETE (YL_ZVP9)
IF (ASSOCIATED (YL_ZVST1)) CALL FIELD_DELETE (YL_ZVST1)
IF (ASSOCIATED (YL_ZVT1)) CALL FIELD_DELETE (YL_ZVT1)
IF (ASSOCIATED (YL_ZVWEI)) CALL FIELD_DELETE (YL_ZVWEI)
IF (ASSOCIATED (YL_ZVWVT0)) CALL FIELD_DELETE (YL_ZVWVT0)
IF (ASSOCIATED (YL_ZVWVT1)) CALL FIELD_DELETE (YL_ZVWVT1)
IF (ASSOCIATED (YL_ZVWVT1S)) CALL FIELD_DELETE (YL_ZVWVT1S)
IF (ASSOCIATED (YL_ZVZ9)) CALL FIELD_DELETE (YL_ZVZ9)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('LAPINEB_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE LAPINEB_PARALLEL
