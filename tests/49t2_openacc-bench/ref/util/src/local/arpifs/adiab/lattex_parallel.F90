SUBROUTINE LATTEX_PARALLEL (YDCST, YDGEOMETRY, YDVARS, YDCPG_TND, YDCPG_SL1, YDCPG_SL2,&
& YDCPG_BNDS, YDCPG_OPTS, YDLDDH, YDMDDH, YDML_GCONF, YDML_DYN, PDTS2, PBT, YD_PBDT, PESGP&
&, PESGM, YD_POROGL, YD_POROGM, YD_PHIF0, YD_PGAGT0L, YD_PGAGT0M, YD_PTOD0, YD_PSPDS0, YD_PLPD0&
&, YD_PGAGT9L, YD_PGAGT9M, YD_PTOD9, YD_PSPDS9, YD_PLPD9, YD_PRDELP, YD_PEVEL, YD_PNHXT0&
&, YD_PGWT0, YD_PGWFT0, YD_PNHXT9, YD_PGWT9, YD_PMIXNL, YDCPG_TNDSI_DDH)
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE MODEL_GENERAL_CONF_MOD,ONLY:MODEL_GENERAL_CONF_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY

USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE YOMCST,ONLY:TCST
USE YOMMDDH,ONLY:TMDDH
USE YOMLDDH,ONLY:TLDDH
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_TND_TYPE
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1B_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_DDH_TND_TYPE_MOD,ONLY:CPG_TNDSI_DDH_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (CPG_TND_TYPE), INTENT (INOUT)::YDCPG_TND
TYPE (CPG_SL1B_TYPE), INTENT (INOUT)::YDCPG_SL1
TYPE (CPG_SL2_TYPE), INTENT (INOUT)::YDCPG_SL2
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (TLDDH), INTENT (IN)::YDLDDH
TYPE (TMDDH), INTENT (IN)::YDMDDH
TYPE (MODEL_GENERAL_CONF_TYPE), INTENT (IN)::YDML_GCONF
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
REAL (KIND=JPRB), INTENT (IN)::PDTS2
REAL (KIND=JPRB), INTENT (IN)::PBT
CLASS (FIELD_2RB), POINTER :: YD_PBDT
REAL (KIND=JPRB), POINTER::PBDT (:,:)
REAL (KIND=JPRB), INTENT (IN)::PESGP
REAL (KIND=JPRB), INTENT (IN)::PESGM
CLASS (FIELD_2RB), POINTER :: YD_POROGL
REAL (KIND=JPRB), POINTER::POROGL (:,:)
CLASS (FIELD_2RB), POINTER :: YD_POROGM
REAL (KIND=JPRB), POINTER::POROGM (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PHIF0
REAL (KIND=JPRB), POINTER::PHIF0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGAGT0L
REAL (KIND=JPRB), POINTER::PGAGT0L (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGAGT0M
REAL (KIND=JPRB), POINTER::PGAGT0M (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTOD0
REAL (KIND=JPRB), POINTER::PTOD0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSPDS0
REAL (KIND=JPRB), POINTER::PSPDS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLPD0
REAL (KIND=JPRB), POINTER::PLPD0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGAGT9L
REAL (KIND=JPRB), POINTER::PGAGT9L (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGAGT9M
REAL (KIND=JPRB), POINTER::PGAGT9M (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTOD9
REAL (KIND=JPRB), POINTER::PTOD9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSPDS9
REAL (KIND=JPRB), POINTER::PSPDS9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLPD9
REAL (KIND=JPRB), POINTER::PLPD9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PRDELP
REAL (KIND=JPRB), POINTER::PRDELP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEVEL
REAL (KIND=JPRB), POINTER::PEVEL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNHXT0
REAL (KIND=JPRB), POINTER::PNHXT0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGWT0
REAL (KIND=JPRB), POINTER::PGWT0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGWFT0
REAL (KIND=JPRB), POINTER::PGWFT0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNHXT9
REAL (KIND=JPRB), POINTER::PNHXT9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGWT9
REAL (KIND=JPRB), POINTER::PGWT9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMIXNL
REAL (KIND=JPRB), POINTER::PMIXNL (:,:,:)
TYPE (CPG_TNDSI_DDH_TYPE), INTENT (INOUT)::YDCPG_TNDSI_DDH
CLASS (FIELD_2RB), POINTER :: YL_ZWT0
REAL (KIND=JPRB), POINTER::ZWT0 (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUSI9
REAL (KIND=JPRB), POINTER::ZUSI9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVSI9
REAL (KIND=JPRB), POINTER::ZVSI9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTSI9
REAL (KIND=JPRB), POINTER::ZTSI9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSPDSI9
REAL (KIND=JPRB), POINTER::ZSPDSI9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVWVSI9
REAL (KIND=JPRB), POINTER::ZVWVSI9 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMOY1U
REAL (KIND=JPRB), POINTER::ZMOY1U (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMOY1V
REAL (KIND=JPRB), POINTER::ZMOY1V (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMOY1T
REAL (KIND=JPRB), POINTER::ZMOY1T (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMOY1SPD
REAL (KIND=JPRB), POINTER::ZMOY1SPD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMOY1VWV
REAL (KIND=JPRB), POINTER::ZMOY1VWV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUSELESS
REAL (KIND=JPRB), POINTER::ZUSELESS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUCOMP
REAL (KIND=JPRB), POINTER::ZUCOMP (:,:,:)
INTEGER (KIND=JPIM)::IPX
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JGFL
INTEGER (KIND=JPIM)::JLEV
LOGICAL::LLCTC
LOGICAL::LLCT
LOGICAL::LLSETTLSW
LOGICAL::LLTDIABLIN
REAL (KIND=JPRB)::ZRGOM
REAL (KIND=JPRB)::ZRTWORGRA
REAL (KIND=JPRB)::ZCMSLP
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
#include "lattex_dnt.intfb.h"
#include "abor1.intfb.h"
#include "lattex_dnt_openacc.intfb.h"
#include "lattex_tnt.intfb.h"
#include "lattex_tnt_openacc.intfb.h"
#include "lattex_expl_2tl_parallel.intfb.h"
#include "lattex_expl_vspltrans_parallel.intfb.h"
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_NHX9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_PD0_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_PD9_NL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_PD9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_PD9_SI_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T0_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T9_NL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T9_SI_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_TF9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U0_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U9_NL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U9_SI_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_UF9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V0_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V9_NL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V9_SI_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VD0_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VD9_NL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VD9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VD9_SI_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VDF9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VF9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_Z0_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_Z9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_PDSI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_TSI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_USI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_VDSI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_VSI(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_PD_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_PD_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_T_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_T_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_U_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_VD_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_VD_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_V_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_TNDSI_DDH_V_T9(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDGW(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDPD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDU_NOC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDVD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDV_NOC(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CSPDNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CTNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CUNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVWVNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GECLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GESLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GOMVRL_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GOMVRM_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GSQM2_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROG_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RCORI_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RCORI_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GW_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_NHX_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_NHX_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPDNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_TNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_UNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_VNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_VWVNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T9(:,:,:)
IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZWT0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVWVSI9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMNH, MERGE (0, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN&
&%YRDYNA%LTWOTL), YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVSI9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, MERGE (0, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN&
&%YRDYNA%LTWOTL), YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUSI9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, MERGE (0, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN&
&%YRDYNA%LTWOTL), YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUSELESS, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEN, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDGEOMETRY%YRDIMV%NFLSA, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUCOMP, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTSI9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, MERGE (0, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN&
&%YRDYNA%LTWOTL), YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPDSI9, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMNH, MERGE (0, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN&
&%YRDYNA%LTWOTL), YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMOY1VWV, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMNH, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMOY1V, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMOY1U, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMOY1T, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMOY1SPD, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMNH, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)



LLCT=YDML_DYN%YRDYNA%LPC_FULL.AND.YDML_DYN%YRDYN%NCURRENT_ITER>0
LLCTC=YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER>0
ZCMSLP=YDML_DYN%YRDYN%RCMSLP0/(YDCST%RD*YDCPG_OPTS%RTSUR)

IF (YDLDDH%LRSIDDH) THEN
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LATTEX_PARALLEL:LRSIDDH')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
    Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
    Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
    Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
    Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
    Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      Z_YDCPG_TNDSI_DDH_U_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
      Z_YDCPG_TNDSI_DDH_V_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
      Z_YDCPG_TNDSI_DDH_T_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        Z_YDCPG_SL1_U9_SI_P (:, JLEV, JBLK)=0.0_JPRB
        Z_YDCPG_SL1_V9_SI_P (:, JLEV, JBLK)=0.0_JPRB
        Z_YDCPG_SL1_T9_SI_P (:, JLEV, JBLK)=0.0_JPRB
      ENDDO


      IF (YDML_DYN%YRDYNA%LNHDYN) THEN
        Z_YDCPG_TNDSI_DDH_PD_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
        Z_YDCPG_TNDSI_DDH_VD_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
      ENDIF


      IF (YDML_DYN%YRDYNA%LNHDYN) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          Z_YDCPG_SL1_PD9_SI_P (:, JLEV, JBLK)=0.0_JPRB
          Z_YDCPG_SL1_VD9_SI_P (:, JLEV, JBLK)=0.0_JPRB
        ENDDO

      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:LRSIDDH')) THEN
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
      Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
      Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
      Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
      Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
      Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
      Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
      Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
      Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
      Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_SL1_PD9_SI_P => NULL ()
    Z_YDCPG_SL1_T9_SI_P => NULL ()
    Z_YDCPG_SL1_U9_SI_P => NULL ()
    Z_YDCPG_SL1_V9_SI_P => NULL ()
    Z_YDCPG_SL1_VD9_SI_P => NULL ()
    Z_YDCPG_TNDSI_DDH_PD_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_T_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_U_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_VD_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_V_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LATTEX_PARALLEL:LRSIDDH')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
    Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
    Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
    Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
    Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
    Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        Z_YDCPG_TNDSI_DDH_U_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
        Z_YDCPG_TNDSI_DDH_V_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
        Z_YDCPG_TNDSI_DDH_T_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          Z_YDCPG_SL1_U9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
          Z_YDCPG_SL1_V9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
          Z_YDCPG_SL1_T9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
        ENDDO


        IF (YDML_DYN%YRDYNA%LNHDYN) THEN
          Z_YDCPG_TNDSI_DDH_PD_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
          Z_YDCPG_TNDSI_DDH_VD_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
        ENDIF


        IF (YDML_DYN%YRDYNA%LNHDYN) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            Z_YDCPG_SL1_PD9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
            Z_YDCPG_SL1_VD9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
          ENDDO

        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:LRSIDDH')) THEN
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
      Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
      Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
      Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
      Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
      Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
      Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
      Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
      Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
      Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_SL1_PD9_SI_P => NULL ()
    Z_YDCPG_SL1_T9_SI_P => NULL ()
    Z_YDCPG_SL1_U9_SI_P => NULL ()
    Z_YDCPG_SL1_V9_SI_P => NULL ()
    Z_YDCPG_SL1_VD9_SI_P => NULL ()
    Z_YDCPG_TNDSI_DDH_PD_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_T_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_U_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_VD_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_V_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LATTEX_PARALLEL:LRSIDDH')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_SL1_PD9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VD9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
    Z_YDCPG_TNDSI_DDH_PD_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
    Z_YDCPG_TNDSI_DDH_T_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
    Z_YDCPG_TNDSI_DDH_U_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
    Z_YDCPG_TNDSI_DDH_VD_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
    Z_YDCPG_TNDSI_DDH_V_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YFXTRAN_ACDC_STACK, Z_YDCPG_SL1_PD9_SI_P, &
      !$ACC&         Z_YDCPG_SL1_T9_SI_P, Z_YDCPG_SL1_U9_SI_P, Z_YDCPG_SL1_V9_SI_P, &
      !$ACC&         Z_YDCPG_SL1_VD9_SI_P, Z_YDCPG_TNDSI_DDH_PD_T0, Z_YDCPG_TNDSI_DDH_T_T0, &
      !$ACC&         Z_YDCPG_TNDSI_DDH_U_T0, Z_YDCPG_TNDSI_DDH_VD_T0, Z_YDCPG_TNDSI_DDH_V_T0) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        
        Z_YDCPG_TNDSI_DDH_U_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
        Z_YDCPG_TNDSI_DDH_V_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
        Z_YDCPG_TNDSI_DDH_T_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          Z_YDCPG_SL1_U9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
          Z_YDCPG_SL1_V9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
          Z_YDCPG_SL1_T9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
        ENDDO


        IF (YDML_DYN%YRDYNA%LNHDYN) THEN
          Z_YDCPG_TNDSI_DDH_PD_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
          Z_YDCPG_TNDSI_DDH_VD_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=0.0_JPRB
        ENDIF


        IF (YDML_DYN%YRDYNA%LNHDYN) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            Z_YDCPG_SL1_PD9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
            Z_YDCPG_SL1_VD9_SI_P (JROF, JLEV, JBLK)=0.0_JPRB
          ENDDO

        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:LRSIDDH')) THEN
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
      Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
      Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
      Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
      Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
      Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
      Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
      Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
      Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
      Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_SL1_PD9_SI_P => NULL ()
    Z_YDCPG_SL1_T9_SI_P => NULL ()
    Z_YDCPG_SL1_U9_SI_P => NULL ()
    Z_YDCPG_SL1_V9_SI_P => NULL ()
    Z_YDCPG_SL1_VD9_SI_P => NULL ()
    Z_YDCPG_TNDSI_DDH_PD_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_T_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_U_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_VD_T0 => NULL ()
    Z_YDCPG_TNDSI_DDH_V_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LATTEX_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRSIDDH',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (PESGP>PESGM) THEN
  LLSETTLSW=.FALSE.
ELSE
  LLSETTLSW=YDML_DYN%YRDYNA%LSETTLS
ENDIF

ZRTWORGRA=2._JPRB/(YDCST%RG*YDCST%RA)
ZRGOM=2._JPRB*YDCST%ROMEGA/YDCST%RG
IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LATTEX_PARALLEL:MAIN')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => GET_HOST_DATA_RDONLY (YD_PBDT)
  PEVEL => GET_HOST_DATA_RDONLY (YD_PEVEL)
  PGAGT0L => GET_HOST_DATA_RDONLY (YD_PGAGT0L)
  PGAGT0M => GET_HOST_DATA_RDONLY (YD_PGAGT0M)
  PGAGT9L => GET_HOST_DATA_RDONLY (YD_PGAGT9L)
  PGAGT9M => GET_HOST_DATA_RDONLY (YD_PGAGT9M)
  PGWFT0 => GET_HOST_DATA_RDONLY (YD_PGWFT0)
  PGWT0 => GET_HOST_DATA_RDONLY (YD_PGWT0)
  PGWT9 => GET_HOST_DATA_RDONLY (YD_PGWT9)
  PHIF0 => GET_HOST_DATA_RDONLY (YD_PHIF0)
  PLPD0 => GET_HOST_DATA_RDONLY (YD_PLPD0)
  PLPD9 => GET_HOST_DATA_RDONLY (YD_PLPD9)
  PMIXNL => GET_HOST_DATA_RDONLY (YD_PMIXNL)
  PNHXT0 => GET_HOST_DATA_RDONLY (YD_PNHXT0)
  PNHXT9 => GET_HOST_DATA_RDONLY (YD_PNHXT9)
  POROGL => GET_HOST_DATA_RDONLY (YD_POROGL)
  POROGM => GET_HOST_DATA_RDONLY (YD_POROGM)
  PRDELP => GET_HOST_DATA_RDONLY (YD_PRDELP)
  PSPDS0 => GET_HOST_DATA_RDONLY (YD_PSPDS0)
  PSPDS9 => GET_HOST_DATA_RDONLY (YD_PSPDS9)
  PTOD0 => GET_HOST_DATA_RDONLY (YD_PTOD0)
  PTOD9 => GET_HOST_DATA_RDONLY (YD_PTOD9)
  ZMOY1SPD => GET_HOST_DATA_RDWR (YL_ZMOY1SPD)
  ZMOY1T => GET_HOST_DATA_RDWR (YL_ZMOY1T)
  ZMOY1U => GET_HOST_DATA_RDWR (YL_ZMOY1U)
  ZMOY1V => GET_HOST_DATA_RDWR (YL_ZMOY1V)
  ZMOY1VWV => GET_HOST_DATA_RDWR (YL_ZMOY1VWV)
  ZSPDSI9 => GET_HOST_DATA_RDWR (YL_ZSPDSI9)
  ZTSI9 => GET_HOST_DATA_RDWR (YL_ZTSI9)
  ZUSELESS => GET_HOST_DATA_RDWR (YL_ZUSELESS)
  ZUSI9 => GET_HOST_DATA_RDWR (YL_ZUSI9)
  ZVSI9 => GET_HOST_DATA_RDWR (YL_ZVSI9)
  ZVWVSI9 => GET_HOST_DATA_RDWR (YL_ZVWVSI9)
  ZWT0 => GET_HOST_DATA_RDWR (YL_ZWT0)
  Z_YDCPG_SL1_NHX9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%NHX9%F_P)
  Z_YDCPG_SL1_PD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD0%F_P)
  Z_YDCPG_SL1_PD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_NL%F_P)
  Z_YDCPG_SL1_PD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9%F_P)
  Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
  Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
  Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
  Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
  Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
  Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
  Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
  Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
  Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
  Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
  Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
  Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
  Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
  Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
  Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
  Z_YDCPG_SL1_VD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD0%F_P)
  Z_YDCPG_SL1_VD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_NL%F_P)
  Z_YDCPG_SL1_VD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9%F_P)
  Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
  Z_YDCPG_SL1_VDF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VDF9%F_P)
  Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
  Z_YDCPG_SL2_PDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_PDSI)
  Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
  Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
  Z_YDCPG_SL2_VDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VDSI)
  Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
  Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
  Z_YDCPG_TNDSI_DDH_PD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT9)
  Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
  Z_YDCPG_TNDSI_DDH_T_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT9)
  Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
  Z_YDCPG_TNDSI_DDH_U_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT9)
  Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
  Z_YDCPG_TNDSI_DDH_VD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT9)
  Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
  Z_YDCPG_TNDSI_DDH_V_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT9)
  Z_YDCPG_TND_TNDGW => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDGW)
  Z_YDCPG_TND_TNDPD => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDPD)
  Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDT)
  Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDU_NOC)
  Z_YDCPG_TND_TNDVD => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDVD)
  Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDV_NOC)
  Z_YDVARS_CSPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPDNL%FT9)
  Z_YDVARS_CTNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CTNL%FT9)
  Z_YDVARS_CUNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CUNL%FT9)
  Z_YDVARS_CVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVNL%FT9)
  Z_YDVARS_CVWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVWVNL%FT9)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_GEOMETRY_GOMVRL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GOMVRL%FT0)
  Z_YDVARS_GEOMETRY_GOMVRM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GOMVRM%FT0)
  Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_GEOMETRY_RCORI_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_GW_T9 => GET_HOST_DATA_RDWR (YDVARS%GW%FT9)
  Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
  Z_YDVARS_NHX_T9 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT9)
  Z_YDVARS_SPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPDNL%FT9)
  Z_YDVARS_SPD_T0 => GET_HOST_DATA_RDONLY (YDVARS%SPD%FT0)
  Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
  Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SPD%FT9)
  Z_YDVARS_SVD_T0 => GET_HOST_DATA_RDONLY (YDVARS%SVD%FT0)
  Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
  Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SVD%FT9)
  Z_YDVARS_TNL_T9 => GET_HOST_DATA_RDWR (YDVARS%TNL%FT9)
  Z_YDVARS_T_T0 => GET_HOST_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
  Z_YDVARS_T_T9 => GET_HOST_DATA_RDONLY (YDVARS%T%FT9)
  Z_YDVARS_UNL_T9 => GET_HOST_DATA_RDWR (YDVARS%UNL%FT9)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
  Z_YDVARS_U_T9 => GET_HOST_DATA_RDONLY (YDVARS%U%FT9)
  Z_YDVARS_VNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VNL%FT9)
  Z_YDVARS_VWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VWVNL%FT9)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
  Z_YDVARS_V_T9 => GET_HOST_DATA_RDONLY (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDCPG_SL2_USI (JROF, JLEV, JBLK)=PBT*PGAGT0L (JROF, JLEV, JBLK)
        Z_YDCPG_SL2_VSI (JROF, JLEV, JBLK)=PBT*PGAGT0M (JROF, JLEV, JBLK)
      ENDDO


      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZMOY1U (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDU_NOC (JROF, JLEV, JBLK)
        ZMOY1V (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDV_NOC (JROF, JLEV, JBLK)
      ENDDO


      IF (.NOT.YDML_DYN%YRDYN%LADVF) THEN

        IF (YDML_DYN%YRDYNA%LSACC) THEN

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZMOY1U (JROF, JLEV, JBLK)=ZMOY1U (JROF, JLEV, JBLK)+PDTS2*Z_YDVARS_GEOMETRY_RCORI_T0 (JROF, JBLK&
            &)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)+PDTS2*ZRTWORGRA*Z_YDVARS_GEOMETRY_RCORI_T0 (JROF, JBLK)*Z_YDVARS_V_T0&
            & (JROF, JLEV, JBLK)*PHIF0 (JROF, JLEV, JBLK)-PDTS2*ZRGOM*PGWFT0 (JROF, JLEV, JBLK)*(1._JPRB-Z_YDVARS_GEOMETRY_GEMU_T0&
            & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_T0 (JROF, JBLK))
            ZMOY1V (JROF, JLEV, JBLK)=ZMOY1V (JROF, JLEV, JBLK)-PDTS2*Z_YDVARS_GEOMETRY_RCORI_T0&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)-PDTS2*ZRTWORGRA*Z_YDVARS_GEOMETRY_RCORI_T0&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)*PHIF0 (JROF, JLEV, JBLK)
          ENDDO

        ELSE

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZMOY1U (JROF, JLEV, JBLK)=ZMOY1U (JROF, JLEV, JBLK)+PDTS2*Z_YDVARS_GEOMETRY_RCORI_P&
            & (JROF, JBLK)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)
            ZMOY1V (JROF, JLEV, JBLK)=ZMOY1V (JROF, JLEV, JBLK)-PDTS2*Z_YDVARS_GEOMETRY_RCORI_P&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)
          ENDDO

        ENDIF

      ENDIF

    ENDDO


    IF (YDML_DYN%YRDYNA%LTWOTL) THEN
      CALL LATTEX_DNT (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
      &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLSETTLSW, YDML_DYN%YRDYN%NWLAG, PESGP, PESGM&
      &, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_U_T9(:,:, JBLK), ZMOY1U(:,:, JBLK), PMIXNL(:,:, JBLK&
      &), Z_YDCPG_SL2_USI(:,:, JBLK), Z_YDVARS_UNL_T9(:,:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDCPG_SL1_U0_P&
      &(:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:, JBLK), Z_YDCPG_SL1_UF9_P(:,:, JBLK), Z_YDVARS_CUNL_T9&
      &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_U_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_U_T9(:,:, JBLK), Z_YDCPG_SL1_U9_SI_P&
      &(:,:, JBLK), Z_YDCPG_SL1_U9_NL_P(:,:, JBLK))
      CALL LATTEX_DNT (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
      &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLSETTLSW, YDML_DYN%YRDYN%NWLAG, PESGP, PESGM&
      &, Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_V_T9(:,:, JBLK), ZMOY1V(:,:, JBLK), PMIXNL(:,:, JBLK&
      &), Z_YDCPG_SL2_VSI(:,:, JBLK), Z_YDVARS_VNL_T9(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), Z_YDCPG_SL1_V0_P&
      &(:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:, JBLK), Z_YDCPG_SL1_VF9_P(:,:, JBLK), Z_YDVARS_CVNL_T9&
      &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_V_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_V_T9(:,:, JBLK), Z_YDCPG_SL1_V9_SI_P&
      &(:,:, JBLK), Z_YDCPG_SL1_V9_NL_P(:,:, JBLK))
    ELSE

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZUSI9 (JROF, JLEV, JBLK)=PBT*PGAGT9L (JROF, JLEV, JBLK)
          ZVSI9 (JROF, JLEV, JBLK)=PBT*PGAGT9M (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

      CALL LATTEX_TNT (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYN&
      &%NWLAG, PESGP, PESGM, Z_YDVARS_U_T9(:,:, JBLK), ZMOY1U(:,:, JBLK), ZUSI9(:,:, JBLK), Z_YDCPG_SL2_USI&
      &(:,:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDCPG_SL1_U0_P(:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:, JBLK), Z_YDCPG_SL1_UF9_P&
      &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_U_T0(:,:, JBLK), Z_YDCPG_SL1_U9_SI_P(:,:, JBLK))
      CALL LATTEX_TNT (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYN&
      &%NWLAG, PESGP, PESGM, Z_YDVARS_V_T9(:,:, JBLK), ZMOY1V(:,:, JBLK), ZVSI9(:,:, JBLK), Z_YDCPG_SL2_VSI&
      &(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), Z_YDCPG_SL1_V0_P(:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:, JBLK), Z_YDCPG_SL1_VF9_P&
      &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_V_T0(:,:, JBLK), Z_YDCPG_SL1_V9_SI_P(:,:, JBLK))
    ENDIF


    IF (YDML_DYN%YRDYN%LADVF) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF, JLEV&
          &, JBLK)-Z_YDVARS_GEOMETRY_GOMVRL_P (JROF, JBLK)
          Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF, JLEV&
          &, JBLK)-Z_YDVARS_GEOMETRY_GOMVRM_P (JROF, JBLK)
        ENDDO

      ENDDO

    ENDIF


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDCPG_SL2_TSI (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PTOD0 (JROF, JLEV, JBLK)
      ENDDO


      IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZWT0 (JROF, JBLK)=PEVEL (JROF, JLEV, JBLK)*PRDELP (JROF, JLEV, JBLK)
        ENDDO

      ELSE

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZWT0 (JROF, JBLK)=0.5_JPRB*(PEVEL (JROF, JLEV, JBLK)+PEVEL&
          & (JROF, JLEV-1, JBLK))*PRDELP (JROF, JLEV, JBLK)
        ENDDO

      ENDIF


      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZMOY1T (JROF, JLEV, JBLK)=PDTS2*ZCMSLP*YDML_DYN%YRDYN%RCORDIF(JLEV)*Z_YDVARS_U_T0&
        & (JROF, JLEV, JBLK)*POROGL (JROF, JBLK)+PDTS2*ZCMSLP*YDML_DYN%YRDYN%RCORDIF&
        &(JLEV)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)*POROGM (JROF, JBLK)
      ENDDO


      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZMOY1T (JROF, JLEV, JBLK)=ZMOY1T (JROF, JLEV, JBLK)+PDTS2*Z_YDCPG_TND_TNDT (JROF&
        &, JLEV, JBLK)+PDTS2*ZCMSLP*(YDML_DYN%YRDYN%RCORDIH(JLEV)-YDML_DYN%YRDYN%RCORDIH&
        &(JLEV-1))*ZWT0 (JROF, JBLK)*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)
      ENDDO

    ENDDO


    IF (YDML_DYN%YRDYNA%LTWOTL) THEN
      CALL LATTEX_DNT (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
      &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NTLAG&
      &, PESGP, PESGM, Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_T9(:,:, JBLK), ZMOY1T(:,:, JBLK), PMIXNL&
      &(:,:, JBLK), Z_YDCPG_SL2_TSI(:,:, JBLK), Z_YDVARS_TNL_T9(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK&
      &), Z_YDCPG_SL1_T0_P(:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:, JBLK), Z_YDCPG_SL1_TF9_P(:,:, JBLK),&
      & Z_YDVARS_CTNL_T9(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T9(:,&
      &:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:, JBLK), Z_YDCPG_SL1_T9_NL_P(:,:, JBLK))
    ELSE

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZTSI9 (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PTOD9 (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

      CALL LATTEX_TNT (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYN&
      &%NTLAG, PESGP, PESGM, Z_YDVARS_T_T9(:,:, JBLK), ZMOY1T(:,:, JBLK), ZTSI9(:,:, JBLK), Z_YDCPG_SL2_TSI&
      &(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK), Z_YDCPG_SL1_T0_P(:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:, JBLK), Z_YDCPG_SL1_TF9_P&
      &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T0(:,:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:, JBLK))
    ENDIF


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDVARS_T_T1 (JROF, JLEV, JBLK)=Z_YDVARS_T_T1 (JROF, JLEV, JBLK)-YDML_DYN&
        &%YRDYN%RCORDIF(JLEV)*ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)
      ENDDO


      IF (.NOT.LLCTC) THEN

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_SL1_T9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_T9_P (JROF, JLEV, JBLK)+YDML_DYN&
          &%YRDYN%RCORDIF(JLEV)*ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)
        ENDDO

      ENDIF

    ENDDO


    IF (YDML_DYN%YRDYNA%LNHDYN) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_SL2_PDSI (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PSPDS0 (JROF, JLEV, JBLK)
          ZMOY1SPD (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDPD (JROF, JLEV, JBLK)
        ENDDO

      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN
        CALL LATTEX_DNT (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
        &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSPDLAG&
        &, PESGP, PESGM, Z_YDVARS_SPD_T0(:,:, JBLK), Z_YDVARS_SPD_T9(:,:, JBLK), ZMOY1SPD(:,:, JBLK),&
        & PMIXNL(:,:, JBLK), Z_YDCPG_SL2_PDSI(:,:, JBLK), Z_YDVARS_SPDNL_T9(:,:, JBLK), Z_YDVARS_SPD_T1&
        &(:,:, JBLK), Z_YDCPG_SL1_PD0_P(:,:, JBLK), Z_YDCPG_SL1_PD9_P(:,:, JBLK), ZUSELESS(:,:, JBLK)&
        &, Z_YDVARS_CSPDNL_T9(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T9&
        &(:,:, JBLK), Z_YDCPG_SL1_PD9_SI_P(:,:, JBLK), Z_YDCPG_SL1_PD9_NL_P(:,:, JBLK))
      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZSPDSI9 (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PSPDS9 (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

        CALL LATTEX_TNT (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDML_DYN%YRDYN%NSPDLAG, PESGP, PESGM, Z_YDVARS_SPD_T9(:,:, JBLK), ZMOY1SPD(:,:,&
        & JBLK), ZSPDSI9(:,:, JBLK), Z_YDCPG_SL2_PDSI(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK&
        &), Z_YDCPG_SL1_PD0_P(:,:, JBLK), Z_YDCPG_SL1_PD9_P(:,:, JBLK), ZUSELESS(:,:, JBLK&
        &), Z_YDCPG_TNDSI_DDH_PD_T0(:,:, JBLK), Z_YDCPG_SL1_PD9_SI_P(:,:, JBLK))
      ENDIF

    ENDIF


    IF (YDML_DYN%YRDYNA%LNHDYN.AND.(.NOT.YDML_DYN%YRDYNA%LGWADV)) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_SL2_VDSI (JROF, JLEV, JBLK)=PBT*PLPD0 (JROF, JLEV, JBLK)
          ZMOY1VWV (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDVD (JROF, JLEV, JBLK)
        ENDDO

      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN
        CALL LATTEX_DNT (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
        &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSVDLAG,&
        & PESGP, PESGM, Z_YDVARS_SVD_T0(:,:, JBLK), Z_YDVARS_SVD_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), PMIXNL&
        &(:,:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_VWVNL_T9(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK&
        &), Z_YDCPG_SL1_VD0_P(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK),&
        & Z_YDVARS_CVWVNL_T9(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T9(:&
        &,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK), Z_YDCPG_SL1_VD9_NL_P(:,:, JBLK))

        IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==1) THEN

          IF (.NOT.LLCT) THEN

            IF (YDML_DYN%YRDYNA%LNESC.OR.(YDCPG_OPTS%NSTEP<=YDML_GCONF%YRRIP%NFOST)) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                ENDDO

              ENDDO

            ELSEIF (.NOT.YDML_DYN%YRDYNA%LNESC.AND.(YDCPG_OPTS%NSTEP>YDML_GCONF&
              &%YRRIP%NFOST).AND.YDML_DYN%YRDYNA%LSETTLS) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                ENDDO

              ENDDO

            ELSE

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+1.5_JPRB&
                  &*PNHXT0 (JROF, JLEV, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=1.5_JPRB*PNHXT0 (JROF, JLEV&
                  &, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-0.5_JPRB&
                  &*PNHXT0 (JROF, JLEV, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.5_JPRB*(PNHXT0 (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK))
                ENDDO

              ENDDO

            ENDIF

            Z_YDVARS_NHX_T9 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=PNHXT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
          ELSE

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              ENDDO


              IF (.NOT.LLCTC) THEN

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                ENDDO

              ENDIF

            ENDDO

          ENDIF

        ELSEIF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

          IF (.NOT.LLCT) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT0 (JROF, JLEV, JBLK)
                Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
              ENDDO

            ENDDO

            Z_YDVARS_NHX_T9 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=PNHXT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
          ELSE

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF&
                &, JLEV, JBLK)+Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              ENDDO


              IF (.NOT.LLCTC) THEN

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                ENDDO

              ENDIF

            ENDDO

          ENDIF

        ENDIF

      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZVWVSI9 (JROF, JLEV, JBLK)=PBT*PLPD9 (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

        CALL LATTEX_TNT (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDML_DYN%YRDYN%NSVDLAG, PESGP, PESGM, Z_YDVARS_SVD_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK&
        &), ZVWVSI9(:,:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK))

        IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==1) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
              Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK&
              &)+PNHXT0 (JROF, JLEV, JBLK)-2.0_JPRB*PNHXT9 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
            ENDDO

          ENDDO

        ELSEIF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT9 (JROF, JLEV, JBLK)
              Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT9 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
            ENDDO

          ENDDO

        ENDIF

      ENDIF

    ENDIF


    IF (YDML_DYN%YRDYNA%LNHDYN.AND.YDML_DYN%YRDYNA%LGWADV) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_SL2_VDSI (JROF, JLEV, JBLK)=PBT*PLPD0 (JROF, JLEV, JBLK)
          ZMOY1VWV (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDGW (JROF, JLEV, JBLK)
        ENDDO

      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN

        IF (YDML_DYN%YRDYNA%LPC_FULL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          Z_YDVARS_GW_T9 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=PGWT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
        ENDIF

        CALL LATTEX_DNT (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
        &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSVDLAG&
        &, PESGP, PESGM, PGWT0(:,:, JBLK), Z_YDVARS_GW_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), PMIXNL(:,&
        &:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_VWVNL_T9(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK&
        &), Z_YDCPG_SL1_VD0_P(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK&
        &), Z_YDVARS_CVWVNL_T9(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T9&
        &(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK), Z_YDCPG_SL1_VD9_NL_P(:,:, JBLK))

        IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

          IF (.NOT.LLCT) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              Z_YDCPG_SL1_NHX9_P (:, JLEV, JBLK)=PNHXT0 (:, JLEV, JBLK)
            ENDDO

            Z_YDVARS_NHX_T9 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=PNHXT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
          ELSE

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              Z_YDCPG_SL1_NHX9_P (:, JLEV, JBLK)=Z_YDVARS_NHX_T9 (:, JLEV, JBLK)
            ENDDO

          ENDIF

        ENDIF

      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZVWVSI9 (JROF, JLEV, JBLK)=PBT*PLPD9 (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

        CALL LATTEX_TNT (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDML_DYN%YRDYN%NSVDLAG, PESGP, PESGM, PGWT9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), ZVWVSI9&
        &(:,:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK))

        IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            Z_YDCPG_SL1_NHX9_P (:, JLEV, JBLK)=PNHXT9 (:, JLEV, JBLK)
          ENDDO

        ENDIF

      ENDIF

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:MAIN')) THEN
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PBDT => GET_HOST_DATA_RDWR (YD_PBDT)
    PEVEL => GET_HOST_DATA_RDWR (YD_PEVEL)
    PGAGT0L => GET_HOST_DATA_RDWR (YD_PGAGT0L)
    PGAGT0M => GET_HOST_DATA_RDWR (YD_PGAGT0M)
    PGAGT9L => GET_HOST_DATA_RDWR (YD_PGAGT9L)
    PGAGT9M => GET_HOST_DATA_RDWR (YD_PGAGT9M)
    PGWFT0 => GET_HOST_DATA_RDWR (YD_PGWFT0)
    PGWT0 => GET_HOST_DATA_RDWR (YD_PGWT0)
    PGWT9 => GET_HOST_DATA_RDWR (YD_PGWT9)
    PHIF0 => GET_HOST_DATA_RDWR (YD_PHIF0)
    PLPD0 => GET_HOST_DATA_RDWR (YD_PLPD0)
    PLPD9 => GET_HOST_DATA_RDWR (YD_PLPD9)
    PMIXNL => GET_HOST_DATA_RDWR (YD_PMIXNL)
    PNHXT0 => GET_HOST_DATA_RDWR (YD_PNHXT0)
    PNHXT9 => GET_HOST_DATA_RDWR (YD_PNHXT9)
    POROGL => GET_HOST_DATA_RDWR (YD_POROGL)
    POROGM => GET_HOST_DATA_RDWR (YD_POROGM)
    PRDELP => GET_HOST_DATA_RDWR (YD_PRDELP)
    PSPDS0 => GET_HOST_DATA_RDWR (YD_PSPDS0)
    PSPDS9 => GET_HOST_DATA_RDWR (YD_PSPDS9)
    PTOD0 => GET_HOST_DATA_RDWR (YD_PTOD0)
    PTOD9 => GET_HOST_DATA_RDWR (YD_PTOD9)
    ZMOY1SPD => GET_HOST_DATA_RDWR (YL_ZMOY1SPD)
    ZMOY1T => GET_HOST_DATA_RDWR (YL_ZMOY1T)
    ZMOY1U => GET_HOST_DATA_RDWR (YL_ZMOY1U)
    ZMOY1V => GET_HOST_DATA_RDWR (YL_ZMOY1V)
    ZMOY1VWV => GET_HOST_DATA_RDWR (YL_ZMOY1VWV)
    ZSPDSI9 => GET_HOST_DATA_RDWR (YL_ZSPDSI9)
    ZTSI9 => GET_HOST_DATA_RDWR (YL_ZTSI9)
    ZUSELESS => GET_HOST_DATA_RDWR (YL_ZUSELESS)
    ZUSI9 => GET_HOST_DATA_RDWR (YL_ZUSI9)
    ZVSI9 => GET_HOST_DATA_RDWR (YL_ZVSI9)
    ZVWVSI9 => GET_HOST_DATA_RDWR (YL_ZVWVSI9)
    ZWT0 => GET_HOST_DATA_RDWR (YL_ZWT0)
    Z_YDCPG_SL1_NHX9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%NHX9%F_P)
    Z_YDCPG_SL1_PD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD0%F_P)
    Z_YDCPG_SL1_PD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_NL%F_P)
    Z_YDCPG_SL1_PD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9%F_P)
    Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
    Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
    Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
    Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
    Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
    Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
    Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
    Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
    Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD0%F_P)
    Z_YDCPG_SL1_VD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_NL%F_P)
    Z_YDCPG_SL1_VD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9%F_P)
    Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
    Z_YDCPG_SL1_VDF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VDF9%F_P)
    Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
    Z_YDCPG_SL2_PDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_PDSI)
    Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
    Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
    Z_YDCPG_SL2_VDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VDSI)
    Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
    Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
    Z_YDCPG_TNDSI_DDH_PD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT9)
    Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
    Z_YDCPG_TNDSI_DDH_T_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT9)
    Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
    Z_YDCPG_TNDSI_DDH_U_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT9)
    Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
    Z_YDCPG_TNDSI_DDH_VD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT9)
    Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
    Z_YDCPG_TNDSI_DDH_V_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT9)
    Z_YDCPG_TND_TNDGW => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDGW)
    Z_YDCPG_TND_TNDPD => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDPD)
    Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
    Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
    Z_YDCPG_TND_TNDVD => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDVD)
    Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
    Z_YDVARS_CSPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPDNL%FT9)
    Z_YDVARS_CTNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CTNL%FT9)
    Z_YDVARS_CUNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CUNL%FT9)
    Z_YDVARS_CVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVNL%FT9)
    Z_YDVARS_CVWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVWVNL%FT9)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GOMVRL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GOMVRL%FT0)
    Z_YDVARS_GEOMETRY_GOMVRM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GOMVRM%FT0)
    Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_GEOMETRY_RCORI_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_GW_T9 => GET_HOST_DATA_RDWR (YDVARS%GW%FT9)
    Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
    Z_YDVARS_NHX_T9 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT9)
    Z_YDVARS_SPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPDNL%FT9)
    Z_YDVARS_SPD_T0 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT0)
    Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
    Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT9)
    Z_YDVARS_SVD_T0 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT0)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT9)
    Z_YDVARS_TNL_T9 => GET_HOST_DATA_RDWR (YDVARS%TNL%FT9)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    Z_YDVARS_T_T9 => GET_HOST_DATA_RDWR (YDVARS%T%FT9)
    Z_YDVARS_UNL_T9 => GET_HOST_DATA_RDWR (YDVARS%UNL%FT9)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_VNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VNL%FT9)
    Z_YDVARS_VWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VWVNL%FT9)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => NULL ()
  PEVEL => NULL ()
  PGAGT0L => NULL ()
  PGAGT0M => NULL ()
  PGAGT9L => NULL ()
  PGAGT9M => NULL ()
  PGWFT0 => NULL ()
  PGWT0 => NULL ()
  PGWT9 => NULL ()
  PHIF0 => NULL ()
  PLPD0 => NULL ()
  PLPD9 => NULL ()
  PMIXNL => NULL ()
  PNHXT0 => NULL ()
  PNHXT9 => NULL ()
  POROGL => NULL ()
  POROGM => NULL ()
  PRDELP => NULL ()
  PSPDS0 => NULL ()
  PSPDS9 => NULL ()
  PTOD0 => NULL ()
  PTOD9 => NULL ()
  ZMOY1SPD => NULL ()
  ZMOY1T => NULL ()
  ZMOY1U => NULL ()
  ZMOY1V => NULL ()
  ZMOY1VWV => NULL ()
  ZSPDSI9 => NULL ()
  ZTSI9 => NULL ()
  ZUSELESS => NULL ()
  ZUSI9 => NULL ()
  ZVSI9 => NULL ()
  ZVWVSI9 => NULL ()
  ZWT0 => NULL ()
  Z_YDCPG_SL1_NHX9_P => NULL ()
  Z_YDCPG_SL1_PD0_P => NULL ()
  Z_YDCPG_SL1_PD9_NL_P => NULL ()
  Z_YDCPG_SL1_PD9_P => NULL ()
  Z_YDCPG_SL1_PD9_SI_P => NULL ()
  Z_YDCPG_SL1_T0_P => NULL ()
  Z_YDCPG_SL1_T9_NL_P => NULL ()
  Z_YDCPG_SL1_T9_P => NULL ()
  Z_YDCPG_SL1_T9_SI_P => NULL ()
  Z_YDCPG_SL1_TF9_P => NULL ()
  Z_YDCPG_SL1_U0_P => NULL ()
  Z_YDCPG_SL1_U9_NL_P => NULL ()
  Z_YDCPG_SL1_U9_P => NULL ()
  Z_YDCPG_SL1_U9_SI_P => NULL ()
  Z_YDCPG_SL1_UF9_P => NULL ()
  Z_YDCPG_SL1_V0_P => NULL ()
  Z_YDCPG_SL1_V9_NL_P => NULL ()
  Z_YDCPG_SL1_V9_P => NULL ()
  Z_YDCPG_SL1_V9_SI_P => NULL ()
  Z_YDCPG_SL1_VD0_P => NULL ()
  Z_YDCPG_SL1_VD9_NL_P => NULL ()
  Z_YDCPG_SL1_VD9_P => NULL ()
  Z_YDCPG_SL1_VD9_SI_P => NULL ()
  Z_YDCPG_SL1_VDF9_P => NULL ()
  Z_YDCPG_SL1_VF9_P => NULL ()
  Z_YDCPG_SL2_PDSI => NULL ()
  Z_YDCPG_SL2_TSI => NULL ()
  Z_YDCPG_SL2_USI => NULL ()
  Z_YDCPG_SL2_VDSI => NULL ()
  Z_YDCPG_SL2_VSI => NULL ()
  Z_YDCPG_TNDSI_DDH_PD_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_PD_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_T_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_T_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_U_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_U_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_VD_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_VD_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_V_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_V_T9 => NULL ()
  Z_YDCPG_TND_TNDGW => NULL ()
  Z_YDCPG_TND_TNDPD => NULL ()
  Z_YDCPG_TND_TNDT => NULL ()
  Z_YDCPG_TND_TNDU_NOC => NULL ()
  Z_YDCPG_TND_TNDVD => NULL ()
  Z_YDCPG_TND_TNDV_NOC => NULL ()
  Z_YDVARS_CSPDNL_T9 => NULL ()
  Z_YDVARS_CTNL_T9 => NULL ()
  Z_YDVARS_CUNL_T9 => NULL ()
  Z_YDVARS_CVNL_T9 => NULL ()
  Z_YDVARS_CVWVNL_T9 => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GOMVRL_P => NULL ()
  Z_YDVARS_GEOMETRY_GOMVRM_P => NULL ()
  Z_YDVARS_GEOMETRY_OROG_P => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_P => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  Z_YDVARS_GW_T9 => NULL ()
  Z_YDVARS_NHX_T1 => NULL ()
  Z_YDVARS_NHX_T9 => NULL ()
  Z_YDVARS_SPDNL_T9 => NULL ()
  Z_YDVARS_SPD_T0 => NULL ()
  Z_YDVARS_SPD_T1 => NULL ()
  Z_YDVARS_SPD_T9 => NULL ()
  Z_YDVARS_SVD_T0 => NULL ()
  Z_YDVARS_SVD_T1 => NULL ()
  Z_YDVARS_SVD_T9 => NULL ()
  Z_YDVARS_TNL_T9 => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  Z_YDVARS_T_T9 => NULL ()
  Z_YDVARS_UNL_T9 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_U_T1 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_VNL_T9 => NULL ()
  Z_YDVARS_VWVNL_T9 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  Z_YDVARS_V_T1 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LATTEX_PARALLEL:MAIN')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => GET_HOST_DATA_RDONLY (YD_PBDT)
  PEVEL => GET_HOST_DATA_RDONLY (YD_PEVEL)
  PGAGT0L => GET_HOST_DATA_RDONLY (YD_PGAGT0L)
  PGAGT0M => GET_HOST_DATA_RDONLY (YD_PGAGT0M)
  PGAGT9L => GET_HOST_DATA_RDONLY (YD_PGAGT9L)
  PGAGT9M => GET_HOST_DATA_RDONLY (YD_PGAGT9M)
  PGWFT0 => GET_HOST_DATA_RDONLY (YD_PGWFT0)
  PGWT0 => GET_HOST_DATA_RDONLY (YD_PGWT0)
  PGWT9 => GET_HOST_DATA_RDONLY (YD_PGWT9)
  PHIF0 => GET_HOST_DATA_RDONLY (YD_PHIF0)
  PLPD0 => GET_HOST_DATA_RDONLY (YD_PLPD0)
  PLPD9 => GET_HOST_DATA_RDONLY (YD_PLPD9)
  PMIXNL => GET_HOST_DATA_RDONLY (YD_PMIXNL)
  PNHXT0 => GET_HOST_DATA_RDONLY (YD_PNHXT0)
  PNHXT9 => GET_HOST_DATA_RDONLY (YD_PNHXT9)
  POROGL => GET_HOST_DATA_RDONLY (YD_POROGL)
  POROGM => GET_HOST_DATA_RDONLY (YD_POROGM)
  PRDELP => GET_HOST_DATA_RDONLY (YD_PRDELP)
  PSPDS0 => GET_HOST_DATA_RDONLY (YD_PSPDS0)
  PSPDS9 => GET_HOST_DATA_RDONLY (YD_PSPDS9)
  PTOD0 => GET_HOST_DATA_RDONLY (YD_PTOD0)
  PTOD9 => GET_HOST_DATA_RDONLY (YD_PTOD9)
  ZMOY1SPD => GET_HOST_DATA_RDWR (YL_ZMOY1SPD)
  ZMOY1T => GET_HOST_DATA_RDWR (YL_ZMOY1T)
  ZMOY1U => GET_HOST_DATA_RDWR (YL_ZMOY1U)
  ZMOY1V => GET_HOST_DATA_RDWR (YL_ZMOY1V)
  ZMOY1VWV => GET_HOST_DATA_RDWR (YL_ZMOY1VWV)
  ZSPDSI9 => GET_HOST_DATA_RDWR (YL_ZSPDSI9)
  ZTSI9 => GET_HOST_DATA_RDWR (YL_ZTSI9)
  ZUSELESS => GET_HOST_DATA_RDWR (YL_ZUSELESS)
  ZUSI9 => GET_HOST_DATA_RDWR (YL_ZUSI9)
  ZVSI9 => GET_HOST_DATA_RDWR (YL_ZVSI9)
  ZVWVSI9 => GET_HOST_DATA_RDWR (YL_ZVWVSI9)
  ZWT0 => GET_HOST_DATA_RDWR (YL_ZWT0)
  Z_YDCPG_SL1_NHX9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%NHX9%F_P)
  Z_YDCPG_SL1_PD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD0%F_P)
  Z_YDCPG_SL1_PD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_NL%F_P)
  Z_YDCPG_SL1_PD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9%F_P)
  Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
  Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
  Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
  Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
  Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
  Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
  Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
  Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
  Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
  Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
  Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
  Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
  Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
  Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
  Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
  Z_YDCPG_SL1_VD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD0%F_P)
  Z_YDCPG_SL1_VD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_NL%F_P)
  Z_YDCPG_SL1_VD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9%F_P)
  Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
  Z_YDCPG_SL1_VDF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VDF9%F_P)
  Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
  Z_YDCPG_SL2_PDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_PDSI)
  Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
  Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
  Z_YDCPG_SL2_VDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VDSI)
  Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
  Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
  Z_YDCPG_TNDSI_DDH_PD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT9)
  Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
  Z_YDCPG_TNDSI_DDH_T_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT9)
  Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
  Z_YDCPG_TNDSI_DDH_U_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT9)
  Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
  Z_YDCPG_TNDSI_DDH_VD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT9)
  Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
  Z_YDCPG_TNDSI_DDH_V_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT9)
  Z_YDCPG_TND_TNDGW => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDGW)
  Z_YDCPG_TND_TNDPD => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDPD)
  Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDT)
  Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDU_NOC)
  Z_YDCPG_TND_TNDVD => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDVD)
  Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDONLY (YDCPG_TND%F_TNDV_NOC)
  Z_YDVARS_CSPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPDNL%FT9)
  Z_YDVARS_CTNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CTNL%FT9)
  Z_YDVARS_CUNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CUNL%FT9)
  Z_YDVARS_CVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVNL%FT9)
  Z_YDVARS_CVWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVWVNL%FT9)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_GEOMETRY_GOMVRL_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GOMVRL%FT0)
  Z_YDVARS_GEOMETRY_GOMVRM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GOMVRM%FT0)
  Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_GEOMETRY_RCORI_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_GW_T9 => GET_HOST_DATA_RDWR (YDVARS%GW%FT9)
  Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
  Z_YDVARS_NHX_T9 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT9)
  Z_YDVARS_SPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPDNL%FT9)
  Z_YDVARS_SPD_T0 => GET_HOST_DATA_RDONLY (YDVARS%SPD%FT0)
  Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
  Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SPD%FT9)
  Z_YDVARS_SVD_T0 => GET_HOST_DATA_RDONLY (YDVARS%SVD%FT0)
  Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
  Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SVD%FT9)
  Z_YDVARS_TNL_T9 => GET_HOST_DATA_RDWR (YDVARS%TNL%FT9)
  Z_YDVARS_T_T0 => GET_HOST_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
  Z_YDVARS_T_T9 => GET_HOST_DATA_RDONLY (YDVARS%T%FT9)
  Z_YDVARS_UNL_T9 => GET_HOST_DATA_RDWR (YDVARS%UNL%FT9)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
  Z_YDVARS_U_T9 => GET_HOST_DATA_RDONLY (YDVARS%U%FT9)
  Z_YDVARS_VNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VNL%FT9)
  Z_YDVARS_VWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VWVNL%FT9)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
  Z_YDVARS_V_T9 => GET_HOST_DATA_RDONLY (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_SL2_USI (JROF, JLEV, JBLK)=PBT*PGAGT0L (JROF, JLEV, JBLK)
        Z_YDCPG_SL2_VSI (JROF, JLEV, JBLK)=PBT*PGAGT0M (JROF, JLEV, JBLK)
        
        
        ZMOY1U (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDU_NOC (JROF, JLEV, JBLK)
        ZMOY1V (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDV_NOC (JROF, JLEV, JBLK)

        

        IF (.NOT.YDML_DYN%YRDYN%LADVF) THEN

          IF (YDML_DYN%YRDYNA%LSACC) THEN
            
            ZMOY1U (JROF, JLEV, JBLK)=ZMOY1U (JROF, JLEV, JBLK)+PDTS2*Z_YDVARS_GEOMETRY_RCORI_T0 (JROF, JBLK&
            &)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)+PDTS2*ZRTWORGRA*Z_YDVARS_GEOMETRY_RCORI_T0 (JROF, JBLK)*Z_YDVARS_V_T0&
            & (JROF, JLEV, JBLK)*PHIF0 (JROF, JLEV, JBLK)-PDTS2*ZRGOM*PGWFT0 (JROF, JLEV, JBLK)*(1._JPRB-Z_YDVARS_GEOMETRY_GEMU_T0&
            & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_T0 (JROF, JBLK))
            ZMOY1V (JROF, JLEV, JBLK)=ZMOY1V (JROF, JLEV, JBLK)-PDTS2*Z_YDVARS_GEOMETRY_RCORI_T0&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)-PDTS2*ZRTWORGRA*Z_YDVARS_GEOMETRY_RCORI_T0&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)*PHIF0 (JROF, JLEV, JBLK)
          
          ELSE
            
            ZMOY1U (JROF, JLEV, JBLK)=ZMOY1U (JROF, JLEV, JBLK)+PDTS2*Z_YDVARS_GEOMETRY_RCORI_P&
            & (JROF, JBLK)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)
            ZMOY1V (JROF, JLEV, JBLK)=ZMOY1V (JROF, JLEV, JBLK)-PDTS2*Z_YDVARS_GEOMETRY_RCORI_P&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)
          
          ENDIF

        ENDIF

      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN
        CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN&
        &, YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLSETTLSW, YDML_DYN%YRDYN%NWLAG, PESGP&
        &, PESGM, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_U_T9(:,:, JBLK), ZMOY1U(:,:, JBLK), PMIXNL(:,:,&
        & JBLK), Z_YDCPG_SL2_USI(:,:, JBLK), Z_YDVARS_UNL_T9(:,:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDCPG_SL1_U0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:, JBLK), Z_YDCPG_SL1_UF9_P(:,:, JBLK), Z_YDVARS_CUNL_T9(:,&
        &:, JBLK), Z_YDCPG_TNDSI_DDH_U_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_U_T9(:,:, JBLK), Z_YDCPG_SL1_U9_SI_P&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
        CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN&
        &, YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLSETTLSW, YDML_DYN%YRDYN%NWLAG, PESGP&
        &, PESGM, Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_V_T9(:,:, JBLK), ZMOY1V(:,:, JBLK), PMIXNL(:,:,&
        & JBLK), Z_YDCPG_SL2_VSI(:,:, JBLK), Z_YDVARS_VNL_T9(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), Z_YDCPG_SL1_V0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:, JBLK), Z_YDCPG_SL1_VF9_P(:,:, JBLK), Z_YDVARS_CVNL_T9(:,&
        &:, JBLK), Z_YDCPG_TNDSI_DDH_V_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_V_T9(:,:, JBLK), Z_YDCPG_SL1_V9_SI_P&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZUSI9 (JROF, JLEV, JBLK)=PBT*PGAGT9L (JROF, JLEV, JBLK)
          ZVSI9 (JROF, JLEV, JBLK)=PBT*PGAGT9M (JROF, JLEV, JBLK)
        
        ENDDO

        CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDML_DYN%YRDYN%NWLAG, PESGP, PESGM, Z_YDVARS_U_T9(:,:, JBLK), ZMOY1U(:,:, JBLK&
        &), ZUSI9(:,:, JBLK), Z_YDCPG_SL2_USI(:,:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDCPG_SL1_U0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:, JBLK), Z_YDCPG_SL1_UF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_U_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
        CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDML_DYN%YRDYN%NWLAG, PESGP, PESGM, Z_YDVARS_V_T9(:,:, JBLK), ZMOY1V(:,:, JBLK&
        &), ZVSI9(:,:, JBLK), Z_YDCPG_SL2_VSI(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), Z_YDCPG_SL1_V0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:, JBLK), Z_YDCPG_SL1_VF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_V_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (YDML_DYN%YRDYN%LADVF) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF, JLEV&
          &, JBLK)-Z_YDVARS_GEOMETRY_GOMVRL_P (JROF, JBLK)
          Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF, JLEV&
          &, JBLK)-Z_YDVARS_GEOMETRY_GOMVRM_P (JROF, JBLK)
        
        ENDDO

      ENDIF


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_SL2_TSI (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PTOD0 (JROF, JLEV, JBLK)

        

        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
          
          ZWT0 (JROF, JBLK)=PEVEL (JROF, JLEV, JBLK)*PRDELP (JROF, JLEV, JBLK)
        
        ELSE
          
          ZWT0 (JROF, JBLK)=0.5_JPRB*(PEVEL (JROF, JLEV, JBLK)+PEVEL&
          & (JROF, JLEV-1, JBLK))*PRDELP (JROF, JLEV, JBLK)
        
        ENDIF

        
        ZMOY1T (JROF, JLEV, JBLK)=PDTS2*ZCMSLP*YDML_DYN%YRDYN%RCORDIF(JLEV)*Z_YDVARS_U_T0&
        & (JROF, JLEV, JBLK)*POROGL (JROF, JBLK)+PDTS2*ZCMSLP*YDML_DYN%YRDYN%RCORDIF&
        &(JLEV)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)*POROGM (JROF, JBLK)
        
        
        ZMOY1T (JROF, JLEV, JBLK)=ZMOY1T (JROF, JLEV, JBLK)+PDTS2*Z_YDCPG_TND_TNDT (JROF&
        &, JLEV, JBLK)+PDTS2*ZCMSLP*(YDML_DYN%YRDYN%RCORDIH(JLEV)-YDML_DYN%YRDYN%RCORDIH&
        &(JLEV-1))*ZWT0 (JROF, JBLK)*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)
      
      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN
        CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN&
        &, YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN&
        &%NTLAG, PESGP, PESGM, Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_T9(:,:, JBLK), ZMOY1T(:,:, JBLK), PMIXNL&
        &(:,:, JBLK), Z_YDCPG_SL2_TSI(:,:, JBLK), Z_YDVARS_TNL_T9(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK)&
        &, Z_YDCPG_SL1_T0_P(:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:, JBLK), Z_YDCPG_SL1_TF9_P(:,:, JBLK), Z_YDVARS_CTNL_T9&
        &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T9(:,:, JBLK), Z_YDCPG_SL1_T9_SI_P&
        &(:,:, JBLK), Z_YDCPG_SL1_T9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZTSI9 (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PTOD9 (JROF, JLEV, JBLK)
        
        ENDDO

        CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDML_DYN%YRDYN%NTLAG, PESGP, PESGM, Z_YDVARS_T_T9(:,:, JBLK), ZMOY1T(:,:, JBLK&
        &), ZTSI9(:,:, JBLK), Z_YDCPG_SL2_TSI(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK), Z_YDCPG_SL1_T0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:, JBLK), Z_YDCPG_SL1_TF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDVARS_T_T1 (JROF, JLEV, JBLK)=Z_YDVARS_T_T1 (JROF, JLEV, JBLK)-YDML_DYN&
        &%YRDYN%RCORDIF(JLEV)*ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)

        

        IF (.NOT.LLCTC) THEN
          
          Z_YDCPG_SL1_T9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_T9_P (JROF, JLEV, JBLK)+YDML_DYN&
          &%YRDYN%RCORDIF(JLEV)*ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)
        
        ENDIF

      ENDDO


      IF (YDML_DYN%YRDYNA%LNHDYN) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_PDSI (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PSPDS0 (JROF, JLEV, JBLK)
          ZMOY1SPD (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDPD (JROF, JLEV, JBLK)
        
        ENDDO


        IF (YDML_DYN%YRDYNA%LTWOTL) THEN
          CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN,&
          & YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSPDLAG&
          &, PESGP, PESGM, Z_YDVARS_SPD_T0(:,:, JBLK), Z_YDVARS_SPD_T9(:,:, JBLK), ZMOY1SPD(:,:, JBLK), PMIXNL&
          &(:,:, JBLK), Z_YDCPG_SL2_PDSI(:,:, JBLK), Z_YDVARS_SPDNL_T9(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK&
          &), Z_YDCPG_SL1_PD0_P(:,:, JBLK), Z_YDCPG_SL1_PD9_P(:,:, JBLK), ZUSELESS(:,:, JBLK), Z_YDVARS_CSPDNL_T9&
          &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T9(:,:, JBLK), Z_YDCPG_SL1_PD9_SI_P&
          &(:,:, JBLK), Z_YDCPG_SL1_PD9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPDSI9 (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PSPDS9 (JROF, JLEV, JBLK)
          
          ENDDO

          CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDML_DYN%YRDYN%NSPDLAG, PESGP, PESGM, Z_YDVARS_SPD_T9(:,:, JBLK), ZMOY1SPD(:,:&
          &, JBLK), ZSPDSI9(:,:, JBLK), Z_YDCPG_SL2_PDSI(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK), Z_YDCPG_SL1_PD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_PD9_P(:,:, JBLK), ZUSELESS(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T0&
          &(:,:, JBLK), Z_YDCPG_SL1_PD9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDIF


      IF (YDML_DYN%YRDYNA%LNHDYN.AND.(.NOT.YDML_DYN%YRDYNA%LGWADV)) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_VDSI (JROF, JLEV, JBLK)=PBT*PLPD0 (JROF, JLEV, JBLK)
          ZMOY1VWV (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDVD (JROF, JLEV, JBLK)
        
        ENDDO


        IF (YDML_DYN%YRDYNA%LTWOTL) THEN
          CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
          &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSVDLAG, PESGP&
          &, PESGM, Z_YDVARS_SVD_T0(:,:, JBLK), Z_YDVARS_SVD_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), PMIXNL(:,:&
          &, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_VWVNL_T9(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDVARS_CVWVNL_T9(:,:&
          &, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T9(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==1) THEN

            IF (.NOT.LLCT) THEN

              IF (YDML_DYN%YRDYNA%LNESC.OR.(YDCPG_OPTS%NSTEP<=YDML_GCONF%YRRIP%NFOST)) THEN

                DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                  
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                
                ENDDO

              ELSEIF (.NOT.YDML_DYN%YRDYNA%LNESC.AND.(YDCPG_OPTS%NSTEP>YDML_GCONF&
                &%YRRIP%NFOST).AND.YDML_DYN%YRDYNA%LSETTLS) THEN

                DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                  
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                
                ENDDO

              ELSE

                DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                  
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+1.5_JPRB&
                  &*PNHXT0 (JROF, JLEV, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=1.5_JPRB*PNHXT0 (JROF, JLEV&
                  &, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-0.5_JPRB&
                  &*PNHXT0 (JROF, JLEV, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.5_JPRB*(PNHXT0 (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK))
                
                ENDDO

              ENDIF

              Z_YDVARS_NHX_T9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
              &)=PNHXT0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
            ELSE

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)

                

                IF (.NOT.LLCTC) THEN
                  
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                
                ENDIF

              ENDDO

            ENDIF

          ELSEIF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            IF (.NOT.LLCT) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT0 (JROF, JLEV, JBLK)
                Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
              
              ENDDO

              Z_YDVARS_NHX_T9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
              &)=PNHXT0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
            ELSE

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF&
                &, JLEV, JBLK)+Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)

                

                IF (.NOT.LLCTC) THEN
                  
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                
                ENDIF

              ENDDO

            ENDIF

          ENDIF

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZVWVSI9 (JROF, JLEV, JBLK)=PBT*PLPD9 (JROF, JLEV, JBLK)
          
          ENDDO

          CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDML_DYN%YRDYN%NSVDLAG, PESGP, PESGM, Z_YDVARS_SVD_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK&
          &), ZVWVSI9(:,:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==1) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
              Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK&
              &)+PNHXT0 (JROF, JLEV, JBLK)-2.0_JPRB*PNHXT9 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
            
            ENDDO

          ELSEIF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT9 (JROF, JLEV, JBLK)
              Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT9 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
            
            ENDDO

          ENDIF

        ENDIF

      ENDIF


      IF (YDML_DYN%YRDYNA%LNHDYN.AND.YDML_DYN%YRDYNA%LGWADV) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_VDSI (JROF, JLEV, JBLK)=PBT*PLPD0 (JROF, JLEV, JBLK)
          ZMOY1VWV (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDGW (JROF, JLEV, JBLK)
        
        ENDDO


        IF (YDML_DYN%YRDYNA%LTWOTL) THEN

          IF (YDML_DYN%YRDYNA%LPC_FULL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            Z_YDVARS_GW_T9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
            &)=PGWT0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
          ENDIF

          CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN,&
          & YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSVDLAG&
          &, PESGP, PESGM, PGWT0(:,:, JBLK), Z_YDVARS_GW_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), PMIXNL(:,:, JBLK&
          &), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_VWVNL_T9(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDVARS_CVWVNL_T9(:,&
          &:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T9(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            IF (.NOT.LLCT) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              ENDDO

              Z_YDVARS_NHX_T9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
              &)=PNHXT0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
            ELSE

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
              ENDDO

            ENDIF

          ENDIF

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZVWVSI9 (JROF, JLEV, JBLK)=PBT*PLPD9 (JROF, JLEV, JBLK)
          
          ENDDO

          CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDML_DYN%YRDYN%NSVDLAG, PESGP, PESGM, PGWT9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), ZVWVSI9&
          &(:,:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=PNHXT9 (JROF, JLEV, JBLK)
            ENDDO

          ENDIF

        ENDIF

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:MAIN')) THEN
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PBDT => GET_HOST_DATA_RDWR (YD_PBDT)
    PEVEL => GET_HOST_DATA_RDWR (YD_PEVEL)
    PGAGT0L => GET_HOST_DATA_RDWR (YD_PGAGT0L)
    PGAGT0M => GET_HOST_DATA_RDWR (YD_PGAGT0M)
    PGAGT9L => GET_HOST_DATA_RDWR (YD_PGAGT9L)
    PGAGT9M => GET_HOST_DATA_RDWR (YD_PGAGT9M)
    PGWFT0 => GET_HOST_DATA_RDWR (YD_PGWFT0)
    PGWT0 => GET_HOST_DATA_RDWR (YD_PGWT0)
    PGWT9 => GET_HOST_DATA_RDWR (YD_PGWT9)
    PHIF0 => GET_HOST_DATA_RDWR (YD_PHIF0)
    PLPD0 => GET_HOST_DATA_RDWR (YD_PLPD0)
    PLPD9 => GET_HOST_DATA_RDWR (YD_PLPD9)
    PMIXNL => GET_HOST_DATA_RDWR (YD_PMIXNL)
    PNHXT0 => GET_HOST_DATA_RDWR (YD_PNHXT0)
    PNHXT9 => GET_HOST_DATA_RDWR (YD_PNHXT9)
    POROGL => GET_HOST_DATA_RDWR (YD_POROGL)
    POROGM => GET_HOST_DATA_RDWR (YD_POROGM)
    PRDELP => GET_HOST_DATA_RDWR (YD_PRDELP)
    PSPDS0 => GET_HOST_DATA_RDWR (YD_PSPDS0)
    PSPDS9 => GET_HOST_DATA_RDWR (YD_PSPDS9)
    PTOD0 => GET_HOST_DATA_RDWR (YD_PTOD0)
    PTOD9 => GET_HOST_DATA_RDWR (YD_PTOD9)
    ZMOY1SPD => GET_HOST_DATA_RDWR (YL_ZMOY1SPD)
    ZMOY1T => GET_HOST_DATA_RDWR (YL_ZMOY1T)
    ZMOY1U => GET_HOST_DATA_RDWR (YL_ZMOY1U)
    ZMOY1V => GET_HOST_DATA_RDWR (YL_ZMOY1V)
    ZMOY1VWV => GET_HOST_DATA_RDWR (YL_ZMOY1VWV)
    ZSPDSI9 => GET_HOST_DATA_RDWR (YL_ZSPDSI9)
    ZTSI9 => GET_HOST_DATA_RDWR (YL_ZTSI9)
    ZUSELESS => GET_HOST_DATA_RDWR (YL_ZUSELESS)
    ZUSI9 => GET_HOST_DATA_RDWR (YL_ZUSI9)
    ZVSI9 => GET_HOST_DATA_RDWR (YL_ZVSI9)
    ZVWVSI9 => GET_HOST_DATA_RDWR (YL_ZVWVSI9)
    ZWT0 => GET_HOST_DATA_RDWR (YL_ZWT0)
    Z_YDCPG_SL1_NHX9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%NHX9%F_P)
    Z_YDCPG_SL1_PD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD0%F_P)
    Z_YDCPG_SL1_PD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_NL%F_P)
    Z_YDCPG_SL1_PD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9%F_P)
    Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
    Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
    Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
    Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
    Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
    Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
    Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
    Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
    Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD0%F_P)
    Z_YDCPG_SL1_VD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_NL%F_P)
    Z_YDCPG_SL1_VD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9%F_P)
    Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
    Z_YDCPG_SL1_VDF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VDF9%F_P)
    Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
    Z_YDCPG_SL2_PDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_PDSI)
    Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
    Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
    Z_YDCPG_SL2_VDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VDSI)
    Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
    Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
    Z_YDCPG_TNDSI_DDH_PD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT9)
    Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
    Z_YDCPG_TNDSI_DDH_T_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT9)
    Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
    Z_YDCPG_TNDSI_DDH_U_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT9)
    Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
    Z_YDCPG_TNDSI_DDH_VD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT9)
    Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
    Z_YDCPG_TNDSI_DDH_V_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT9)
    Z_YDCPG_TND_TNDGW => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDGW)
    Z_YDCPG_TND_TNDPD => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDPD)
    Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
    Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
    Z_YDCPG_TND_TNDVD => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDVD)
    Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
    Z_YDVARS_CSPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPDNL%FT9)
    Z_YDVARS_CTNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CTNL%FT9)
    Z_YDVARS_CUNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CUNL%FT9)
    Z_YDVARS_CVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVNL%FT9)
    Z_YDVARS_CVWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVWVNL%FT9)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GOMVRL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GOMVRL%FT0)
    Z_YDVARS_GEOMETRY_GOMVRM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GOMVRM%FT0)
    Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_GEOMETRY_RCORI_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_GW_T9 => GET_HOST_DATA_RDWR (YDVARS%GW%FT9)
    Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
    Z_YDVARS_NHX_T9 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT9)
    Z_YDVARS_SPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPDNL%FT9)
    Z_YDVARS_SPD_T0 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT0)
    Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
    Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT9)
    Z_YDVARS_SVD_T0 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT0)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT9)
    Z_YDVARS_TNL_T9 => GET_HOST_DATA_RDWR (YDVARS%TNL%FT9)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    Z_YDVARS_T_T9 => GET_HOST_DATA_RDWR (YDVARS%T%FT9)
    Z_YDVARS_UNL_T9 => GET_HOST_DATA_RDWR (YDVARS%UNL%FT9)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_VNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VNL%FT9)
    Z_YDVARS_VWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VWVNL%FT9)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => NULL ()
  PEVEL => NULL ()
  PGAGT0L => NULL ()
  PGAGT0M => NULL ()
  PGAGT9L => NULL ()
  PGAGT9M => NULL ()
  PGWFT0 => NULL ()
  PGWT0 => NULL ()
  PGWT9 => NULL ()
  PHIF0 => NULL ()
  PLPD0 => NULL ()
  PLPD9 => NULL ()
  PMIXNL => NULL ()
  PNHXT0 => NULL ()
  PNHXT9 => NULL ()
  POROGL => NULL ()
  POROGM => NULL ()
  PRDELP => NULL ()
  PSPDS0 => NULL ()
  PSPDS9 => NULL ()
  PTOD0 => NULL ()
  PTOD9 => NULL ()
  ZMOY1SPD => NULL ()
  ZMOY1T => NULL ()
  ZMOY1U => NULL ()
  ZMOY1V => NULL ()
  ZMOY1VWV => NULL ()
  ZSPDSI9 => NULL ()
  ZTSI9 => NULL ()
  ZUSELESS => NULL ()
  ZUSI9 => NULL ()
  ZVSI9 => NULL ()
  ZVWVSI9 => NULL ()
  ZWT0 => NULL ()
  Z_YDCPG_SL1_NHX9_P => NULL ()
  Z_YDCPG_SL1_PD0_P => NULL ()
  Z_YDCPG_SL1_PD9_NL_P => NULL ()
  Z_YDCPG_SL1_PD9_P => NULL ()
  Z_YDCPG_SL1_PD9_SI_P => NULL ()
  Z_YDCPG_SL1_T0_P => NULL ()
  Z_YDCPG_SL1_T9_NL_P => NULL ()
  Z_YDCPG_SL1_T9_P => NULL ()
  Z_YDCPG_SL1_T9_SI_P => NULL ()
  Z_YDCPG_SL1_TF9_P => NULL ()
  Z_YDCPG_SL1_U0_P => NULL ()
  Z_YDCPG_SL1_U9_NL_P => NULL ()
  Z_YDCPG_SL1_U9_P => NULL ()
  Z_YDCPG_SL1_U9_SI_P => NULL ()
  Z_YDCPG_SL1_UF9_P => NULL ()
  Z_YDCPG_SL1_V0_P => NULL ()
  Z_YDCPG_SL1_V9_NL_P => NULL ()
  Z_YDCPG_SL1_V9_P => NULL ()
  Z_YDCPG_SL1_V9_SI_P => NULL ()
  Z_YDCPG_SL1_VD0_P => NULL ()
  Z_YDCPG_SL1_VD9_NL_P => NULL ()
  Z_YDCPG_SL1_VD9_P => NULL ()
  Z_YDCPG_SL1_VD9_SI_P => NULL ()
  Z_YDCPG_SL1_VDF9_P => NULL ()
  Z_YDCPG_SL1_VF9_P => NULL ()
  Z_YDCPG_SL2_PDSI => NULL ()
  Z_YDCPG_SL2_TSI => NULL ()
  Z_YDCPG_SL2_USI => NULL ()
  Z_YDCPG_SL2_VDSI => NULL ()
  Z_YDCPG_SL2_VSI => NULL ()
  Z_YDCPG_TNDSI_DDH_PD_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_PD_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_T_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_T_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_U_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_U_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_VD_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_VD_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_V_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_V_T9 => NULL ()
  Z_YDCPG_TND_TNDGW => NULL ()
  Z_YDCPG_TND_TNDPD => NULL ()
  Z_YDCPG_TND_TNDT => NULL ()
  Z_YDCPG_TND_TNDU_NOC => NULL ()
  Z_YDCPG_TND_TNDVD => NULL ()
  Z_YDCPG_TND_TNDV_NOC => NULL ()
  Z_YDVARS_CSPDNL_T9 => NULL ()
  Z_YDVARS_CTNL_T9 => NULL ()
  Z_YDVARS_CUNL_T9 => NULL ()
  Z_YDVARS_CVNL_T9 => NULL ()
  Z_YDVARS_CVWVNL_T9 => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GOMVRL_P => NULL ()
  Z_YDVARS_GEOMETRY_GOMVRM_P => NULL ()
  Z_YDVARS_GEOMETRY_OROG_P => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_P => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  Z_YDVARS_GW_T9 => NULL ()
  Z_YDVARS_NHX_T1 => NULL ()
  Z_YDVARS_NHX_T9 => NULL ()
  Z_YDVARS_SPDNL_T9 => NULL ()
  Z_YDVARS_SPD_T0 => NULL ()
  Z_YDVARS_SPD_T1 => NULL ()
  Z_YDVARS_SPD_T9 => NULL ()
  Z_YDVARS_SVD_T0 => NULL ()
  Z_YDVARS_SVD_T1 => NULL ()
  Z_YDVARS_SVD_T9 => NULL ()
  Z_YDVARS_TNL_T9 => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  Z_YDVARS_T_T9 => NULL ()
  Z_YDVARS_UNL_T9 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_U_T1 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_VNL_T9 => NULL ()
  Z_YDVARS_VWVNL_T9 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  Z_YDVARS_V_T1 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LATTEX_PARALLEL:MAIN')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => GET_DEVICE_DATA_RDONLY (YD_PBDT)
  PEVEL => GET_DEVICE_DATA_RDONLY (YD_PEVEL)
  PGAGT0L => GET_DEVICE_DATA_RDONLY (YD_PGAGT0L)
  PGAGT0M => GET_DEVICE_DATA_RDONLY (YD_PGAGT0M)
  PGAGT9L => GET_DEVICE_DATA_RDONLY (YD_PGAGT9L)
  PGAGT9M => GET_DEVICE_DATA_RDONLY (YD_PGAGT9M)
  PGWFT0 => GET_DEVICE_DATA_RDONLY (YD_PGWFT0)
  PGWT0 => GET_DEVICE_DATA_RDONLY (YD_PGWT0)
  PGWT9 => GET_DEVICE_DATA_RDONLY (YD_PGWT9)
  PHIF0 => GET_DEVICE_DATA_RDONLY (YD_PHIF0)
  PLPD0 => GET_DEVICE_DATA_RDONLY (YD_PLPD0)
  PLPD9 => GET_DEVICE_DATA_RDONLY (YD_PLPD9)
  PMIXNL => GET_DEVICE_DATA_RDONLY (YD_PMIXNL)
  PNHXT0 => GET_DEVICE_DATA_RDONLY (YD_PNHXT0)
  PNHXT9 => GET_DEVICE_DATA_RDONLY (YD_PNHXT9)
  POROGL => GET_DEVICE_DATA_RDONLY (YD_POROGL)
  POROGM => GET_DEVICE_DATA_RDONLY (YD_POROGM)
  PRDELP => GET_DEVICE_DATA_RDONLY (YD_PRDELP)
  PSPDS0 => GET_DEVICE_DATA_RDONLY (YD_PSPDS0)
  PSPDS9 => GET_DEVICE_DATA_RDONLY (YD_PSPDS9)
  PTOD0 => GET_DEVICE_DATA_RDONLY (YD_PTOD0)
  PTOD9 => GET_DEVICE_DATA_RDONLY (YD_PTOD9)
  ZMOY1SPD => GET_DEVICE_DATA_RDWR (YL_ZMOY1SPD)
  ZMOY1T => GET_DEVICE_DATA_RDWR (YL_ZMOY1T)
  ZMOY1U => GET_DEVICE_DATA_RDWR (YL_ZMOY1U)
  ZMOY1V => GET_DEVICE_DATA_RDWR (YL_ZMOY1V)
  ZMOY1VWV => GET_DEVICE_DATA_RDWR (YL_ZMOY1VWV)
  ZSPDSI9 => GET_DEVICE_DATA_RDWR (YL_ZSPDSI9)
  ZTSI9 => GET_DEVICE_DATA_RDWR (YL_ZTSI9)
  ZUSELESS => GET_DEVICE_DATA_RDWR (YL_ZUSELESS)
  ZUSI9 => GET_DEVICE_DATA_RDWR (YL_ZUSI9)
  ZVSI9 => GET_DEVICE_DATA_RDWR (YL_ZVSI9)
  ZVWVSI9 => GET_DEVICE_DATA_RDWR (YL_ZVWVSI9)
  ZWT0 => GET_DEVICE_DATA_RDWR (YL_ZWT0)
  Z_YDCPG_SL1_NHX9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%NHX9%F_P)
  Z_YDCPG_SL1_PD0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%PD0%F_P)
  Z_YDCPG_SL1_PD9_NL_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%PD9_NL%F_P)
  Z_YDCPG_SL1_PD9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%PD9%F_P)
  Z_YDCPG_SL1_PD9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
  Z_YDCPG_SL1_T0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%T0%F_P)
  Z_YDCPG_SL1_T9_NL_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
  Z_YDCPG_SL1_T9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%T9%F_P)
  Z_YDCPG_SL1_T9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
  Z_YDCPG_SL1_TF9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%TF9%F_P)
  Z_YDCPG_SL1_U0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%U0%F_P)
  Z_YDCPG_SL1_U9_NL_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
  Z_YDCPG_SL1_U9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%U9%F_P)
  Z_YDCPG_SL1_U9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
  Z_YDCPG_SL1_UF9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%UF9%F_P)
  Z_YDCPG_SL1_V0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%V0%F_P)
  Z_YDCPG_SL1_V9_NL_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
  Z_YDCPG_SL1_V9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%V9%F_P)
  Z_YDCPG_SL1_V9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
  Z_YDCPG_SL1_VD0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%VD0%F_P)
  Z_YDCPG_SL1_VD9_NL_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%VD9_NL%F_P)
  Z_YDCPG_SL1_VD9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%VD9%F_P)
  Z_YDCPG_SL1_VD9_SI_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
  Z_YDCPG_SL1_VDF9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%VDF9%F_P)
  Z_YDCPG_SL1_VF9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%VF9%F_P)
  Z_YDCPG_SL2_PDSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_PDSI)
  Z_YDCPG_SL2_TSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_TSI)
  Z_YDCPG_SL2_USI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_USI)
  Z_YDCPG_SL2_VDSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_VDSI)
  Z_YDCPG_SL2_VSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_VSI)
  Z_YDCPG_TNDSI_DDH_PD_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
  Z_YDCPG_TNDSI_DDH_PD_T9 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT9)
  Z_YDCPG_TNDSI_DDH_T_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
  Z_YDCPG_TNDSI_DDH_T_T9 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT9)
  Z_YDCPG_TNDSI_DDH_U_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
  Z_YDCPG_TNDSI_DDH_U_T9 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT9)
  Z_YDCPG_TNDSI_DDH_VD_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
  Z_YDCPG_TNDSI_DDH_VD_T9 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT9)
  Z_YDCPG_TNDSI_DDH_V_T0 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
  Z_YDCPG_TNDSI_DDH_V_T9 => GET_DEVICE_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT9)
  Z_YDCPG_TND_TNDGW => GET_DEVICE_DATA_RDONLY (YDCPG_TND%F_TNDGW)
  Z_YDCPG_TND_TNDPD => GET_DEVICE_DATA_RDONLY (YDCPG_TND%F_TNDPD)
  Z_YDCPG_TND_TNDT => GET_DEVICE_DATA_RDONLY (YDCPG_TND%F_TNDT)
  Z_YDCPG_TND_TNDU_NOC => GET_DEVICE_DATA_RDONLY (YDCPG_TND%F_TNDU_NOC)
  Z_YDCPG_TND_TNDVD => GET_DEVICE_DATA_RDONLY (YDCPG_TND%F_TNDVD)
  Z_YDCPG_TND_TNDV_NOC => GET_DEVICE_DATA_RDONLY (YDCPG_TND%F_TNDV_NOC)
  Z_YDVARS_CSPDNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%CSPDNL%FT9)
  Z_YDVARS_CTNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%CTNL%FT9)
  Z_YDVARS_CUNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%CUNL%FT9)
  Z_YDVARS_CVNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%CVNL%FT9)
  Z_YDVARS_CVWVNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%CVWVNL%FT9)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_GEOMETRY_GOMVRL_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GOMVRL%FT0)
  Z_YDVARS_GEOMETRY_GOMVRM_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GOMVRM%FT0)
  Z_YDVARS_GEOMETRY_OROG_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_GEOMETRY_RCORI_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_GW_T9 => GET_DEVICE_DATA_RDWR (YDVARS%GW%FT9)
  Z_YDVARS_NHX_T1 => GET_DEVICE_DATA_RDWR (YDVARS%NHX%FT1)
  Z_YDVARS_NHX_T9 => GET_DEVICE_DATA_RDWR (YDVARS%NHX%FT9)
  Z_YDVARS_SPDNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%SPDNL%FT9)
  Z_YDVARS_SPD_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%SPD%FT0)
  Z_YDVARS_SPD_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SPD%FT1)
  Z_YDVARS_SPD_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SPD%FT9)
  Z_YDVARS_SVD_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%SVD%FT0)
  Z_YDVARS_SVD_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SVD%FT1)
  Z_YDVARS_SVD_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SVD%FT9)
  Z_YDVARS_TNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%TNL%FT9)
  Z_YDVARS_T_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_T_T1 => GET_DEVICE_DATA_RDWR (YDVARS%T%FT1)
  Z_YDVARS_T_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%T%FT9)
  Z_YDVARS_UNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%UNL%FT9)
  Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_U_T1 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT1)
  Z_YDVARS_U_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%U%FT9)
  Z_YDVARS_VNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%VNL%FT9)
  Z_YDVARS_VWVNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%VWVNL%FT9)
  Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%V%FT0)
  Z_YDVARS_V_T1 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT1)
  Z_YDVARS_V_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PBDT, PEVEL, PGAGT0L, PGAGT0M, PGAGT9L, PGAGT9M, PGWFT0, PGWT0, PGWT9, &
    !$ACC&         PHIF0, PLPD0, PLPD9, PMIXNL, PNHXT0, PNHXT9, POROGL, POROGM, PRDELP, &
    !$ACC&         PSPDS0, PSPDS9, PTOD0, PTOD9, YDCPG_OPTS, YDGEOMETRY, YDLDDH, YDML_DYN, &
    !$ACC&         YDML_GCONF, YFXTRAN_ACDC_STACK, ZMOY1SPD, ZMOY1T, ZMOY1U, ZMOY1V, &
    !$ACC&         ZMOY1VWV, ZSPDSI9, ZTSI9, ZUSELESS, ZUSI9, ZVSI9, ZVWVSI9, ZWT0, Z_YDCPG_SL1_NHX9_P, &
    !$ACC&         Z_YDCPG_SL1_PD0_P, Z_YDCPG_SL1_PD9_NL_P, Z_YDCPG_SL1_PD9_P, &
    !$ACC&         Z_YDCPG_SL1_PD9_SI_P, Z_YDCPG_SL1_T0_P, Z_YDCPG_SL1_T9_NL_P, &
    !$ACC&         Z_YDCPG_SL1_T9_P, Z_YDCPG_SL1_T9_SI_P, Z_YDCPG_SL1_TF9_P, &
    !$ACC&         Z_YDCPG_SL1_U0_P, Z_YDCPG_SL1_U9_NL_P, Z_YDCPG_SL1_U9_P, &
    !$ACC&         Z_YDCPG_SL1_U9_SI_P, Z_YDCPG_SL1_UF9_P, Z_YDCPG_SL1_V0_P, &
    !$ACC&         Z_YDCPG_SL1_V9_NL_P, Z_YDCPG_SL1_V9_P, Z_YDCPG_SL1_V9_SI_P, &
    !$ACC&         Z_YDCPG_SL1_VD0_P, Z_YDCPG_SL1_VD9_NL_P, Z_YDCPG_SL1_VD9_P, &
    !$ACC&         Z_YDCPG_SL1_VD9_SI_P, Z_YDCPG_SL1_VDF9_P, Z_YDCPG_SL1_VF9_P, &
    !$ACC&         Z_YDCPG_SL2_PDSI, Z_YDCPG_SL2_TSI, Z_YDCPG_SL2_USI, Z_YDCPG_SL2_VDSI, &
    !$ACC&         Z_YDCPG_SL2_VSI, Z_YDCPG_TNDSI_DDH_PD_T0, Z_YDCPG_TNDSI_DDH_PD_T9, &
    !$ACC&         Z_YDCPG_TNDSI_DDH_T_T0, Z_YDCPG_TNDSI_DDH_T_T9, Z_YDCPG_TNDSI_DDH_U_T0, &
    !$ACC&         Z_YDCPG_TNDSI_DDH_U_T9, Z_YDCPG_TNDSI_DDH_VD_T0, Z_YDCPG_TNDSI_DDH_VD_T9, &
    !$ACC&         Z_YDCPG_TNDSI_DDH_V_T0, Z_YDCPG_TNDSI_DDH_V_T9, Z_YDCPG_TND_TNDGW, &
    !$ACC&         Z_YDCPG_TND_TNDPD, Z_YDCPG_TND_TNDT, Z_YDCPG_TND_TNDU_NOC, &
    !$ACC&         Z_YDCPG_TND_TNDVD, Z_YDCPG_TND_TNDV_NOC, Z_YDVARS_CSPDNL_T9, &
    !$ACC&         Z_YDVARS_CTNL_T9, Z_YDVARS_CUNL_T9, Z_YDVARS_CVNL_T9, Z_YDVARS_CVWVNL_T9, &
    !$ACC&         Z_YDVARS_GEOMETRY_GEMU_T0, Z_YDVARS_GEOMETRY_GOMVRL_P, &
    !$ACC&         Z_YDVARS_GEOMETRY_GOMVRM_P, Z_YDVARS_GEOMETRY_OROG_P, Z_YDVARS_GEOMETRY_RCORI_P, &
    !$ACC&         Z_YDVARS_GEOMETRY_RCORI_T0, Z_YDVARS_GW_T9, Z_YDVARS_NHX_T1, &
    !$ACC&         Z_YDVARS_NHX_T9, Z_YDVARS_SPDNL_T9, Z_YDVARS_SPD_T0, Z_YDVARS_SPD_T1, &
    !$ACC&         Z_YDVARS_SPD_T9, Z_YDVARS_SVD_T0, Z_YDVARS_SVD_T1, Z_YDVARS_SVD_T9, &
    !$ACC&         Z_YDVARS_TNL_T9, Z_YDVARS_T_T0, Z_YDVARS_T_T1, Z_YDVARS_T_T9, &
    !$ACC&         Z_YDVARS_UNL_T9, Z_YDVARS_U_T0, Z_YDVARS_U_T1, Z_YDVARS_U_T9, &
    !$ACC&         Z_YDVARS_VNL_T9, Z_YDVARS_VWVNL_T9, Z_YDVARS_V_T0, Z_YDVARS_V_T1, &
    !$ACC&         Z_YDVARS_V_T9) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_SL2_USI (JROF, JLEV, JBLK)=PBT*PGAGT0L (JROF, JLEV, JBLK)
        Z_YDCPG_SL2_VSI (JROF, JLEV, JBLK)=PBT*PGAGT0M (JROF, JLEV, JBLK)
        
        
        ZMOY1U (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDU_NOC (JROF, JLEV, JBLK)
        ZMOY1V (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDV_NOC (JROF, JLEV, JBLK)

        

        IF (.NOT.YDML_DYN%YRDYN%LADVF) THEN

          IF (YDML_DYN%YRDYNA%LSACC) THEN
            
            ZMOY1U (JROF, JLEV, JBLK)=ZMOY1U (JROF, JLEV, JBLK)+PDTS2*Z_YDVARS_GEOMETRY_RCORI_T0 (JROF, JBLK&
            &)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)+PDTS2*ZRTWORGRA*Z_YDVARS_GEOMETRY_RCORI_T0 (JROF, JBLK)*Z_YDVARS_V_T0&
            & (JROF, JLEV, JBLK)*PHIF0 (JROF, JLEV, JBLK)-PDTS2*ZRGOM*PGWFT0 (JROF, JLEV, JBLK)*(1._JPRB-Z_YDVARS_GEOMETRY_GEMU_T0&
            & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_T0 (JROF, JBLK))
            ZMOY1V (JROF, JLEV, JBLK)=ZMOY1V (JROF, JLEV, JBLK)-PDTS2*Z_YDVARS_GEOMETRY_RCORI_T0&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)-PDTS2*ZRTWORGRA*Z_YDVARS_GEOMETRY_RCORI_T0&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)*PHIF0 (JROF, JLEV, JBLK)
          
          ELSE
            
            ZMOY1U (JROF, JLEV, JBLK)=ZMOY1U (JROF, JLEV, JBLK)+PDTS2*Z_YDVARS_GEOMETRY_RCORI_P&
            & (JROF, JBLK)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)
            ZMOY1V (JROF, JLEV, JBLK)=ZMOY1V (JROF, JLEV, JBLK)-PDTS2*Z_YDVARS_GEOMETRY_RCORI_P&
            & (JROF, JBLK)*Z_YDVARS_U_T0 (JROF, JLEV, JBLK)
          
          ENDIF

        ENDIF

      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN
        CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN&
        &, YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLSETTLSW, YDML_DYN%YRDYN%NWLAG, PESGP&
        &, PESGM, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_U_T9(:,:, JBLK), ZMOY1U(:,:, JBLK), PMIXNL(:,:,&
        & JBLK), Z_YDCPG_SL2_USI(:,:, JBLK), Z_YDVARS_UNL_T9(:,:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDCPG_SL1_U0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:, JBLK), Z_YDCPG_SL1_UF9_P(:,:, JBLK), Z_YDVARS_CUNL_T9(:,&
        &:, JBLK), Z_YDCPG_TNDSI_DDH_U_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_U_T9(:,:, JBLK), Z_YDCPG_SL1_U9_SI_P&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
        CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN&
        &, YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLSETTLSW, YDML_DYN%YRDYN%NWLAG, PESGP&
        &, PESGM, Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_V_T9(:,:, JBLK), ZMOY1V(:,:, JBLK), PMIXNL(:,:,&
        & JBLK), Z_YDCPG_SL2_VSI(:,:, JBLK), Z_YDVARS_VNL_T9(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), Z_YDCPG_SL1_V0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:, JBLK), Z_YDCPG_SL1_VF9_P(:,:, JBLK), Z_YDVARS_CVNL_T9(:,&
        &:, JBLK), Z_YDCPG_TNDSI_DDH_V_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_V_T9(:,:, JBLK), Z_YDCPG_SL1_V9_SI_P&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZUSI9 (JROF, JLEV, JBLK)=PBT*PGAGT9L (JROF, JLEV, JBLK)
          ZVSI9 (JROF, JLEV, JBLK)=PBT*PGAGT9M (JROF, JLEV, JBLK)
        
        ENDDO

        CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDML_DYN%YRDYN%NWLAG, PESGP, PESGM, Z_YDVARS_U_T9(:,:, JBLK), ZMOY1U(:,:, JBLK&
        &), ZUSI9(:,:, JBLK), Z_YDCPG_SL2_USI(:,:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDCPG_SL1_U0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:, JBLK), Z_YDCPG_SL1_UF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_U_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_U9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
        CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDML_DYN%YRDYN%NWLAG, PESGP, PESGM, Z_YDVARS_V_T9(:,:, JBLK), ZMOY1V(:,:, JBLK&
        &), ZVSI9(:,:, JBLK), Z_YDCPG_SL2_VSI(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), Z_YDCPG_SL1_V0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:, JBLK), Z_YDCPG_SL1_VF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_V_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_V9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (YDML_DYN%YRDYN%LADVF) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDVARS_U_T1 (JROF, JLEV, JBLK)=Z_YDVARS_U_T1 (JROF, JLEV&
          &, JBLK)-Z_YDVARS_GEOMETRY_GOMVRL_P (JROF, JBLK)
          Z_YDVARS_V_T1 (JROF, JLEV, JBLK)=Z_YDVARS_V_T1 (JROF, JLEV&
          &, JBLK)-Z_YDVARS_GEOMETRY_GOMVRM_P (JROF, JBLK)
        
        ENDDO

      ENDIF


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_SL2_TSI (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PTOD0 (JROF, JLEV, JBLK)

        

        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
          
          ZWT0 (JROF, JBLK)=PEVEL (JROF, JLEV, JBLK)*PRDELP (JROF, JLEV, JBLK)
        
        ELSE
          
          ZWT0 (JROF, JBLK)=0.5_JPRB*(PEVEL (JROF, JLEV, JBLK)+PEVEL&
          & (JROF, JLEV-1, JBLK))*PRDELP (JROF, JLEV, JBLK)
        
        ENDIF

        
        ZMOY1T (JROF, JLEV, JBLK)=PDTS2*ZCMSLP*YDML_DYN%YRDYN%RCORDIF(JLEV)*Z_YDVARS_U_T0&
        & (JROF, JLEV, JBLK)*POROGL (JROF, JBLK)+PDTS2*ZCMSLP*YDML_DYN%YRDYN%RCORDIF&
        &(JLEV)*Z_YDVARS_V_T0 (JROF, JLEV, JBLK)*POROGM (JROF, JBLK)
        
        
        ZMOY1T (JROF, JLEV, JBLK)=ZMOY1T (JROF, JLEV, JBLK)+PDTS2*Z_YDCPG_TND_TNDT (JROF&
        &, JLEV, JBLK)+PDTS2*ZCMSLP*(YDML_DYN%YRDYN%RCORDIH(JLEV)-YDML_DYN%YRDYN%RCORDIH&
        &(JLEV-1))*ZWT0 (JROF, JBLK)*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)
      
      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN
        CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN&
        &, YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN&
        &%NTLAG, PESGP, PESGM, Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_T9(:,:, JBLK), ZMOY1T(:,:, JBLK), PMIXNL&
        &(:,:, JBLK), Z_YDCPG_SL2_TSI(:,:, JBLK), Z_YDVARS_TNL_T9(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK)&
        &, Z_YDCPG_SL1_T0_P(:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:, JBLK), Z_YDCPG_SL1_TF9_P(:,:, JBLK), Z_YDVARS_CTNL_T9&
        &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T9(:,:, JBLK), Z_YDCPG_SL1_T9_SI_P&
        &(:,:, JBLK), Z_YDCPG_SL1_T9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZTSI9 (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PTOD9 (JROF, JLEV, JBLK)
        
        ENDDO

        CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDML_DYN%YRDYN%NTLAG, PESGP, PESGM, Z_YDVARS_T_T9(:,:, JBLK), ZMOY1T(:,:, JBLK&
        &), ZTSI9(:,:, JBLK), Z_YDCPG_SL2_TSI(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK), Z_YDCPG_SL1_T0_P&
        &(:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:, JBLK), Z_YDCPG_SL1_TF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_T_T0&
        &(:,:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDVARS_T_T1 (JROF, JLEV, JBLK)=Z_YDVARS_T_T1 (JROF, JLEV, JBLK)-YDML_DYN&
        &%YRDYN%RCORDIF(JLEV)*ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)

        

        IF (.NOT.LLCTC) THEN
          
          Z_YDCPG_SL1_T9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_T9_P (JROF, JLEV, JBLK)+YDML_DYN&
          &%YRDYN%RCORDIF(JLEV)*ZCMSLP*Z_YDVARS_GEOMETRY_OROG_P (JROF, JBLK)
        
        ENDIF

      ENDDO


      IF (YDML_DYN%YRDYNA%LNHDYN) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_PDSI (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PSPDS0 (JROF, JLEV, JBLK)
          ZMOY1SPD (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDPD (JROF, JLEV, JBLK)
        
        ENDDO


        IF (YDML_DYN%YRDYNA%LTWOTL) THEN
          CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN,&
          & YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSPDLAG&
          &, PESGP, PESGM, Z_YDVARS_SPD_T0(:,:, JBLK), Z_YDVARS_SPD_T9(:,:, JBLK), ZMOY1SPD(:,:, JBLK), PMIXNL&
          &(:,:, JBLK), Z_YDCPG_SL2_PDSI(:,:, JBLK), Z_YDVARS_SPDNL_T9(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK&
          &), Z_YDCPG_SL1_PD0_P(:,:, JBLK), Z_YDCPG_SL1_PD9_P(:,:, JBLK), ZUSELESS(:,:, JBLK), Z_YDVARS_CSPDNL_T9&
          &(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T9(:,:, JBLK), Z_YDCPG_SL1_PD9_SI_P&
          &(:,:, JBLK), Z_YDCPG_SL1_PD9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)
        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPDSI9 (JROF, JLEV, JBLK)=PBDT (JROF, JBLK)*PSPDS9 (JROF, JLEV, JBLK)
          
          ENDDO

          CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDML_DYN%YRDYN%NSPDLAG, PESGP, PESGM, Z_YDVARS_SPD_T9(:,:, JBLK), ZMOY1SPD(:,:&
          &, JBLK), ZSPDSI9(:,:, JBLK), Z_YDCPG_SL2_PDSI(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK), Z_YDCPG_SL1_PD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_PD9_P(:,:, JBLK), ZUSELESS(:,:, JBLK), Z_YDCPG_TNDSI_DDH_PD_T0&
          &(:,:, JBLK), Z_YDCPG_SL1_PD9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDIF


      IF (YDML_DYN%YRDYNA%LNHDYN.AND.(.NOT.YDML_DYN%YRDYNA%LGWADV)) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_VDSI (JROF, JLEV, JBLK)=PBT*PLPD0 (JROF, JLEV, JBLK)
          ZMOY1VWV (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDVD (JROF, JLEV, JBLK)
        
        ENDDO


        IF (YDML_DYN%YRDYNA%LTWOTL) THEN
          CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN, YDML_DYN&
          &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSVDLAG, PESGP&
          &, PESGM, Z_YDVARS_SVD_T0(:,:, JBLK), Z_YDVARS_SVD_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), PMIXNL(:,:&
          &, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_VWVNL_T9(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDVARS_CVWVNL_T9(:,:&
          &, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T9(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==1) THEN

            IF (.NOT.LLCT) THEN

              IF (YDML_DYN%YRDYNA%LNESC.OR.(YDCPG_OPTS%NSTEP<=YDML_GCONF%YRRIP%NFOST)) THEN

                DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                  
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                
                ENDDO

              ELSEIF (.NOT.YDML_DYN%YRDYNA%LNESC.AND.(YDCPG_OPTS%NSTEP>YDML_GCONF&
                &%YRRIP%NFOST).AND.YDML_DYN%YRDYNA%LSETTLS) THEN

                DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                  
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                
                ENDDO

              ELSE

                DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                  
                  Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+1.5_JPRB&
                  &*PNHXT0 (JROF, JLEV, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=1.5_JPRB*PNHXT0 (JROF, JLEV&
                  &, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-0.5_JPRB&
                  &*PNHXT0 (JROF, JLEV, JBLK)-0.5_JPRB*Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.5_JPRB*(PNHXT0 (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK))
                
                ENDDO

              ENDIF

              CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDVARS_NHX_T9 (:, 1:YDGEOMETRY%YRDIMV&
              &%NFLEVG, JBLK), PNHXT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
            ELSE

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)

                

                IF (.NOT.LLCTC) THEN
                  
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                
                ENDIF

              ENDDO

            ENDIF

          ELSEIF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            IF (.NOT.LLCT) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
                Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT0 (JROF, JLEV, JBLK)
                Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
              
              ENDDO

              CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDVARS_NHX_T9 (:, 1:YDGEOMETRY%YRDIMV&
              &%NFLEVG, JBLK), PNHXT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
            ELSE

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF&
                &, JLEV, JBLK)+Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)

                

                IF (.NOT.LLCTC) THEN
                  
                  Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF&
                  &, JLEV, JBLK)-Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
                
                ENDIF

              ENDDO

            ENDIF

          ENDIF

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZVWVSI9 (JROF, JLEV, JBLK)=PBT*PLPD9 (JROF, JLEV, JBLK)
          
          ENDDO

          CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDML_DYN%YRDYN%NSVDLAG, PESGP, PESGM, Z_YDVARS_SVD_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK&
          &), ZVWVSI9(:,:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==1) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT0 (JROF, JLEV, JBLK)
              Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK&
              &)+PNHXT0 (JROF, JLEV, JBLK)-2.0_JPRB*PNHXT9 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
            
            ENDDO

          ELSEIF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)=Z_YDVARS_SVD_T1 (JROF, JLEV, JBLK)+PNHXT9 (JROF, JLEV, JBLK)
              Z_YDVARS_NHX_T1 (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_VD9_P (JROF, JLEV, JBLK)-PNHXT9 (JROF, JLEV, JBLK)
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=0.0_JPRB
            
            ENDDO

          ENDIF

        ENDIF

      ENDIF


      IF (YDML_DYN%YRDYNA%LNHDYN.AND.YDML_DYN%YRDYNA%LGWADV) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_SL2_VDSI (JROF, JLEV, JBLK)=PBT*PLPD0 (JROF, JLEV, JBLK)
          ZMOY1VWV (JROF, JLEV, JBLK)=PDTS2*Z_YDCPG_TND_TNDGW (JROF, JLEV, JBLK)
        
        ENDDO


        IF (YDML_DYN%YRDYNA%LTWOTL) THEN

          IF (YDML_DYN%YRDYNA%LPC_FULL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDVARS_GW_T9 (:, 1:YDGEOMETRY%YRDIMV&
            &%NFLEVG, JBLK), PGWT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
          ENDIF

          CALL LATTEX_DNT_OPENACC (YDCPG_OPTS%NSTEP, YDGEOMETRY, YDLDDH, YDML_GCONF%YRRIP, YDML_DYN%YRDYN,&
          & YDML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDML_DYN%YRDYNA%LSETTLS, YDML_DYN%YRDYN%NSVDLAG&
          &, PESGP, PESGM, PGWT0(:,:, JBLK), Z_YDVARS_GW_T9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), PMIXNL(:,:, JBLK&
          &), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_VWVNL_T9(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDVARS_CVWVNL_T9(:,&
          &:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T9(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_NL_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            IF (.NOT.LLCT) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=PNHXT0 (JROF, JLEV, JBLK)
              ENDDO

              CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDVARS_NHX_T9 (:, 1:YDGEOMETRY%YRDIMV&
              &%NFLEVG, JBLK), PNHXT0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
            ELSE

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=Z_YDVARS_NHX_T9 (JROF, JLEV, JBLK)
              ENDDO

            ENDIF

          ENDIF

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZVWVSI9 (JROF, JLEV, JBLK)=PBT*PLPD9 (JROF, JLEV, JBLK)
          
          ENDDO

          CALL LATTEX_TNT_OPENACC (YDGEOMETRY, YDLDDH, YDML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDML_DYN%YRDYN%NSVDLAG, PESGP, PESGM, PGWT9(:,:, JBLK), ZMOY1VWV(:,:, JBLK), ZVWVSI9&
          &(:,:, JBLK), Z_YDCPG_SL2_VDSI(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDCPG_SL1_VD0_P&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_P(:,:, JBLK), Z_YDCPG_SL1_VDF9_P(:,:, JBLK), Z_YDCPG_TNDSI_DDH_VD_T0&
          &(:,:, JBLK), Z_YDCPG_SL1_VD9_SI_P(:,:, JBLK),YDSTACK=YLSTACK)

          IF ((YDML_DYN%YRDYNA%NVDVAR==4.OR.YDML_DYN%YRDYNA%NVDVAR==5).AND.YDML_DYN%YRDYNA%ND4SYS==2) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              Z_YDCPG_SL1_NHX9_P (JROF, JLEV, JBLK)=PNHXT9 (JROF, JLEV, JBLK)
            ENDDO

          ENDIF

        ENDIF

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:MAIN')) THEN
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PBDT => GET_HOST_DATA_RDWR (YD_PBDT)
    PEVEL => GET_HOST_DATA_RDWR (YD_PEVEL)
    PGAGT0L => GET_HOST_DATA_RDWR (YD_PGAGT0L)
    PGAGT0M => GET_HOST_DATA_RDWR (YD_PGAGT0M)
    PGAGT9L => GET_HOST_DATA_RDWR (YD_PGAGT9L)
    PGAGT9M => GET_HOST_DATA_RDWR (YD_PGAGT9M)
    PGWFT0 => GET_HOST_DATA_RDWR (YD_PGWFT0)
    PGWT0 => GET_HOST_DATA_RDWR (YD_PGWT0)
    PGWT9 => GET_HOST_DATA_RDWR (YD_PGWT9)
    PHIF0 => GET_HOST_DATA_RDWR (YD_PHIF0)
    PLPD0 => GET_HOST_DATA_RDWR (YD_PLPD0)
    PLPD9 => GET_HOST_DATA_RDWR (YD_PLPD9)
    PMIXNL => GET_HOST_DATA_RDWR (YD_PMIXNL)
    PNHXT0 => GET_HOST_DATA_RDWR (YD_PNHXT0)
    PNHXT9 => GET_HOST_DATA_RDWR (YD_PNHXT9)
    POROGL => GET_HOST_DATA_RDWR (YD_POROGL)
    POROGM => GET_HOST_DATA_RDWR (YD_POROGM)
    PRDELP => GET_HOST_DATA_RDWR (YD_PRDELP)
    PSPDS0 => GET_HOST_DATA_RDWR (YD_PSPDS0)
    PSPDS9 => GET_HOST_DATA_RDWR (YD_PSPDS9)
    PTOD0 => GET_HOST_DATA_RDWR (YD_PTOD0)
    PTOD9 => GET_HOST_DATA_RDWR (YD_PTOD9)
    ZMOY1SPD => GET_HOST_DATA_RDWR (YL_ZMOY1SPD)
    ZMOY1T => GET_HOST_DATA_RDWR (YL_ZMOY1T)
    ZMOY1U => GET_HOST_DATA_RDWR (YL_ZMOY1U)
    ZMOY1V => GET_HOST_DATA_RDWR (YL_ZMOY1V)
    ZMOY1VWV => GET_HOST_DATA_RDWR (YL_ZMOY1VWV)
    ZSPDSI9 => GET_HOST_DATA_RDWR (YL_ZSPDSI9)
    ZTSI9 => GET_HOST_DATA_RDWR (YL_ZTSI9)
    ZUSELESS => GET_HOST_DATA_RDWR (YL_ZUSELESS)
    ZUSI9 => GET_HOST_DATA_RDWR (YL_ZUSI9)
    ZVSI9 => GET_HOST_DATA_RDWR (YL_ZVSI9)
    ZVWVSI9 => GET_HOST_DATA_RDWR (YL_ZVWVSI9)
    ZWT0 => GET_HOST_DATA_RDWR (YL_ZWT0)
    Z_YDCPG_SL1_NHX9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%NHX9%F_P)
    Z_YDCPG_SL1_PD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD0%F_P)
    Z_YDCPG_SL1_PD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_NL%F_P)
    Z_YDCPG_SL1_PD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9%F_P)
    Z_YDCPG_SL1_PD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%PD9_SI%F_P)
    Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
    Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
    Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
    Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
    Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
    Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
    Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
    Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VD0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD0%F_P)
    Z_YDCPG_SL1_VD9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_NL%F_P)
    Z_YDCPG_SL1_VD9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9%F_P)
    Z_YDCPG_SL1_VD9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VD9_SI%F_P)
    Z_YDCPG_SL1_VDF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VDF9%F_P)
    Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
    Z_YDCPG_SL2_PDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_PDSI)
    Z_YDCPG_SL2_TSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_TSI)
    Z_YDCPG_SL2_USI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_USI)
    Z_YDCPG_SL2_VDSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VDSI)
    Z_YDCPG_SL2_VSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VSI)
    Z_YDCPG_TNDSI_DDH_PD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT0)
    Z_YDCPG_TNDSI_DDH_PD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%PD%FT9)
    Z_YDCPG_TNDSI_DDH_T_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT0)
    Z_YDCPG_TNDSI_DDH_T_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%T%FT9)
    Z_YDCPG_TNDSI_DDH_U_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT0)
    Z_YDCPG_TNDSI_DDH_U_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%U%FT9)
    Z_YDCPG_TNDSI_DDH_VD_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT0)
    Z_YDCPG_TNDSI_DDH_VD_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%VD%FT9)
    Z_YDCPG_TNDSI_DDH_V_T0 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT0)
    Z_YDCPG_TNDSI_DDH_V_T9 => GET_HOST_DATA_RDWR (YDCPG_TNDSI_DDH%V%FT9)
    Z_YDCPG_TND_TNDGW => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDGW)
    Z_YDCPG_TND_TNDPD => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDPD)
    Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
    Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
    Z_YDCPG_TND_TNDVD => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDVD)
    Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
    Z_YDVARS_CSPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPDNL%FT9)
    Z_YDVARS_CTNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CTNL%FT9)
    Z_YDVARS_CUNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CUNL%FT9)
    Z_YDVARS_CVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVNL%FT9)
    Z_YDVARS_CVWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CVWVNL%FT9)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GOMVRL_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GOMVRL%FT0)
    Z_YDVARS_GEOMETRY_GOMVRM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GOMVRM%FT0)
    Z_YDVARS_GEOMETRY_OROG_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_GEOMETRY_RCORI_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_GW_T9 => GET_HOST_DATA_RDWR (YDVARS%GW%FT9)
    Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
    Z_YDVARS_NHX_T9 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT9)
    Z_YDVARS_SPDNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPDNL%FT9)
    Z_YDVARS_SPD_T0 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT0)
    Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
    Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT9)
    Z_YDVARS_SVD_T0 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT0)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT9)
    Z_YDVARS_TNL_T9 => GET_HOST_DATA_RDWR (YDVARS%TNL%FT9)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    Z_YDVARS_T_T9 => GET_HOST_DATA_RDWR (YDVARS%T%FT9)
    Z_YDVARS_UNL_T9 => GET_HOST_DATA_RDWR (YDVARS%UNL%FT9)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_VNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VNL%FT9)
    Z_YDVARS_VWVNL_T9 => GET_HOST_DATA_RDWR (YDVARS%VWVNL%FT9)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => NULL ()
  PEVEL => NULL ()
  PGAGT0L => NULL ()
  PGAGT0M => NULL ()
  PGAGT9L => NULL ()
  PGAGT9M => NULL ()
  PGWFT0 => NULL ()
  PGWT0 => NULL ()
  PGWT9 => NULL ()
  PHIF0 => NULL ()
  PLPD0 => NULL ()
  PLPD9 => NULL ()
  PMIXNL => NULL ()
  PNHXT0 => NULL ()
  PNHXT9 => NULL ()
  POROGL => NULL ()
  POROGM => NULL ()
  PRDELP => NULL ()
  PSPDS0 => NULL ()
  PSPDS9 => NULL ()
  PTOD0 => NULL ()
  PTOD9 => NULL ()
  ZMOY1SPD => NULL ()
  ZMOY1T => NULL ()
  ZMOY1U => NULL ()
  ZMOY1V => NULL ()
  ZMOY1VWV => NULL ()
  ZSPDSI9 => NULL ()
  ZTSI9 => NULL ()
  ZUSELESS => NULL ()
  ZUSI9 => NULL ()
  ZVSI9 => NULL ()
  ZVWVSI9 => NULL ()
  ZWT0 => NULL ()
  Z_YDCPG_SL1_NHX9_P => NULL ()
  Z_YDCPG_SL1_PD0_P => NULL ()
  Z_YDCPG_SL1_PD9_NL_P => NULL ()
  Z_YDCPG_SL1_PD9_P => NULL ()
  Z_YDCPG_SL1_PD9_SI_P => NULL ()
  Z_YDCPG_SL1_T0_P => NULL ()
  Z_YDCPG_SL1_T9_NL_P => NULL ()
  Z_YDCPG_SL1_T9_P => NULL ()
  Z_YDCPG_SL1_T9_SI_P => NULL ()
  Z_YDCPG_SL1_TF9_P => NULL ()
  Z_YDCPG_SL1_U0_P => NULL ()
  Z_YDCPG_SL1_U9_NL_P => NULL ()
  Z_YDCPG_SL1_U9_P => NULL ()
  Z_YDCPG_SL1_U9_SI_P => NULL ()
  Z_YDCPG_SL1_UF9_P => NULL ()
  Z_YDCPG_SL1_V0_P => NULL ()
  Z_YDCPG_SL1_V9_NL_P => NULL ()
  Z_YDCPG_SL1_V9_P => NULL ()
  Z_YDCPG_SL1_V9_SI_P => NULL ()
  Z_YDCPG_SL1_VD0_P => NULL ()
  Z_YDCPG_SL1_VD9_NL_P => NULL ()
  Z_YDCPG_SL1_VD9_P => NULL ()
  Z_YDCPG_SL1_VD9_SI_P => NULL ()
  Z_YDCPG_SL1_VDF9_P => NULL ()
  Z_YDCPG_SL1_VF9_P => NULL ()
  Z_YDCPG_SL2_PDSI => NULL ()
  Z_YDCPG_SL2_TSI => NULL ()
  Z_YDCPG_SL2_USI => NULL ()
  Z_YDCPG_SL2_VDSI => NULL ()
  Z_YDCPG_SL2_VSI => NULL ()
  Z_YDCPG_TNDSI_DDH_PD_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_PD_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_T_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_T_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_U_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_U_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_VD_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_VD_T9 => NULL ()
  Z_YDCPG_TNDSI_DDH_V_T0 => NULL ()
  Z_YDCPG_TNDSI_DDH_V_T9 => NULL ()
  Z_YDCPG_TND_TNDGW => NULL ()
  Z_YDCPG_TND_TNDPD => NULL ()
  Z_YDCPG_TND_TNDT => NULL ()
  Z_YDCPG_TND_TNDU_NOC => NULL ()
  Z_YDCPG_TND_TNDVD => NULL ()
  Z_YDCPG_TND_TNDV_NOC => NULL ()
  Z_YDVARS_CSPDNL_T9 => NULL ()
  Z_YDVARS_CTNL_T9 => NULL ()
  Z_YDVARS_CUNL_T9 => NULL ()
  Z_YDVARS_CVNL_T9 => NULL ()
  Z_YDVARS_CVWVNL_T9 => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GOMVRL_P => NULL ()
  Z_YDVARS_GEOMETRY_GOMVRM_P => NULL ()
  Z_YDVARS_GEOMETRY_OROG_P => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_P => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  Z_YDVARS_GW_T9 => NULL ()
  Z_YDVARS_NHX_T1 => NULL ()
  Z_YDVARS_NHX_T9 => NULL ()
  Z_YDVARS_SPDNL_T9 => NULL ()
  Z_YDVARS_SPD_T0 => NULL ()
  Z_YDVARS_SPD_T1 => NULL ()
  Z_YDVARS_SPD_T9 => NULL ()
  Z_YDVARS_SVD_T0 => NULL ()
  Z_YDVARS_SVD_T1 => NULL ()
  Z_YDVARS_SVD_T9 => NULL ()
  Z_YDVARS_TNL_T9 => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  Z_YDVARS_T_T9 => NULL ()
  Z_YDVARS_UNL_T9 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_U_T1 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_VNL_T9 => NULL ()
  Z_YDVARS_VWVNL_T9 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  Z_YDVARS_V_T1 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LATTEX_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:MAIN',1,ZHOOK_HANDLE_PARALLEL)

IF (YDML_DYN%YRDYNA%LTWOTL) THEN
  CALL LATTEX_EXPL_2TL_PARALLEL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS&
  &, YDML_DYN, YDCPG_SL1, YDVARS, LLCT, LLCTC)
ELSE
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDML_DYN%YRDYN%RINTOPT/=1._JPRB) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (.NOT.LLCTC) THEN
  CALL LATTEX_EXPL_VSPLTRANS_PARALLEL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDML_DYN, YDCPG_SL1)
ENDIF


IF (YDML_DYN%YRDYN%LRHS_CURV) THEN
  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LATTEX_PARALLEL:LRHS_CURV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZUCOMP => GET_HOST_DATA_RDWR (YL_ZUCOMP)
    Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_Z0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z0%F_P)
    Z_YDCPG_SL1_Z9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z9%F_P)
    Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
    Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
    Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        ZUCOMP (:, JLEV, JBLK)=Z_YDCPG_SL1_U9_P (:, JLEV, JBLK)
        Z_YDCPG_SL1_Z9_P (:, JLEV, JBLK)=Z_YDCPG_SL1_V9_P (:&
        &, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GSQM2_P (:, JBLK)
        Z_YDCPG_SL1_U9_P (:, JLEV, JBLK)=-Z_YDCPG_SL1_U9_P (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
        & (:, JBLK)-Z_YDCPG_SL1_V9_P (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
        & (:, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (:, JBLK)
        Z_YDCPG_SL1_V9_P (:, JLEV, JBLK)=ZUCOMP (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P (:, JBLK)-Z_YDCPG_SL1_V9_P&
        & (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P (:, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (:, JBLK)
      ENDDO


      IF ((YDML_DYN%YRDYN%NWLAG>=3).OR.(YDML_DYN%YRDYN%NSPLTHOI/=0)) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          ZUCOMP (:, JLEV, JBLK)=Z_YDCPG_SL1_U0_P (:, JLEV, JBLK)
          Z_YDCPG_SL1_Z0_P (:, JLEV, JBLK)=Z_YDCPG_SL1_V0_P (:&
          &, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GSQM2_P (:, JBLK)
          Z_YDCPG_SL1_U0_P (:, JLEV, JBLK)=-Z_YDCPG_SL1_U0_P (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
          & (:, JBLK)-Z_YDCPG_SL1_V0_P (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
          & (:, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (:, JBLK)
          Z_YDCPG_SL1_V0_P (:, JLEV, JBLK)=ZUCOMP (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P (:, JBLK)-Z_YDCPG_SL1_V0_P&
          & (:, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P (:, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (:, JBLK)
        ENDDO

      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:LRHS_CURV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZUCOMP => GET_HOST_DATA_RDWR (YL_ZUCOMP)
      Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
      Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
      Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
      Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
      Z_YDCPG_SL1_Z0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z0%F_P)
      Z_YDCPG_SL1_Z9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z9%F_P)
      Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
      Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
      Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZUCOMP => NULL ()
    Z_YDCPG_SL1_U0_P => NULL ()
    Z_YDCPG_SL1_U9_P => NULL ()
    Z_YDCPG_SL1_V0_P => NULL ()
    Z_YDCPG_SL1_V9_P => NULL ()
    Z_YDCPG_SL1_Z0_P => NULL ()
    Z_YDCPG_SL1_Z9_P => NULL ()
    Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
    Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
    Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LATTEX_PARALLEL:LRHS_CURV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZUCOMP => GET_HOST_DATA_RDWR (YL_ZUCOMP)
    Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_Z0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z0%F_P)
    Z_YDCPG_SL1_Z9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z9%F_P)
    Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
    Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
    Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF

        

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          ZUCOMP (JROF, JLEV, JBLK)=Z_YDCPG_SL1_U9_P (JROF, JLEV, JBLK)
          Z_YDCPG_SL1_Z9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_V9_P (JROF&
          &, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GSQM2_P (JROF, JBLK)
          Z_YDCPG_SL1_U9_P (JROF, JLEV, JBLK)=-Z_YDCPG_SL1_U9_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
          & (JROF, JBLK)-Z_YDCPG_SL1_V9_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
          & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
          Z_YDCPG_SL1_V9_P (JROF, JLEV, JBLK)=ZUCOMP (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
          & (JROF, JBLK)-Z_YDCPG_SL1_V9_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
          & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
        ENDDO


        IF ((YDML_DYN%YRDYN%NWLAG>=3).OR.(YDML_DYN%YRDYN%NSPLTHOI/=0)) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            ZUCOMP (JROF, JLEV, JBLK)=Z_YDCPG_SL1_U0_P (JROF, JLEV, JBLK)
            Z_YDCPG_SL1_Z0_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_V0_P (JROF&
            &, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GSQM2_P (JROF, JBLK)
            Z_YDCPG_SL1_U0_P (JROF, JLEV, JBLK)=-Z_YDCPG_SL1_U0_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
            & (JROF, JBLK)-Z_YDCPG_SL1_V0_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
            & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
            Z_YDCPG_SL1_V0_P (JROF, JLEV, JBLK)=ZUCOMP (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
            & (JROF, JBLK)-Z_YDCPG_SL1_V0_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
            & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
          ENDDO

        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:LRHS_CURV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZUCOMP => GET_HOST_DATA_RDWR (YL_ZUCOMP)
      Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
      Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
      Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
      Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
      Z_YDCPG_SL1_Z0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z0%F_P)
      Z_YDCPG_SL1_Z9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z9%F_P)
      Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
      Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
      Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZUCOMP => NULL ()
    Z_YDCPG_SL1_U0_P => NULL ()
    Z_YDCPG_SL1_U9_P => NULL ()
    Z_YDCPG_SL1_V0_P => NULL ()
    Z_YDCPG_SL1_V9_P => NULL ()
    Z_YDCPG_SL1_Z0_P => NULL ()
    Z_YDCPG_SL1_Z9_P => NULL ()
    Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
    Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
    Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LATTEX_PARALLEL:LRHS_CURV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZUCOMP => GET_DEVICE_DATA_RDWR (YL_ZUCOMP)
    Z_YDCPG_SL1_U0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_V0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_Z0_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%Z0%F_P)
    Z_YDCPG_SL1_Z9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%Z9%F_P)
    Z_YDVARS_GEOMETRY_GECLO_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
    Z_YDVARS_GEOMETRY_GEMU_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GESLO_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
    Z_YDVARS_GEOMETRY_GSQM2_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YFXTRAN_ACDC_STACK, ZUCOMP, &
      !$ACC&         Z_YDCPG_SL1_U0_P, Z_YDCPG_SL1_U9_P, Z_YDCPG_SL1_V0_P, Z_YDCPG_SL1_V9_P, &
      !$ACC&         Z_YDCPG_SL1_Z0_P, Z_YDCPG_SL1_Z9_P, Z_YDVARS_GEOMETRY_GECLO_P, &
      !$ACC&         Z_YDVARS_GEOMETRY_GEMU_P, Z_YDVARS_GEOMETRY_GESLO_P, Z_YDVARS_GEOMETRY_GSQM2_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF

        

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          ZUCOMP (JROF, JLEV, JBLK)=Z_YDCPG_SL1_U9_P (JROF, JLEV, JBLK)
          Z_YDCPG_SL1_Z9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_V9_P (JROF&
          &, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GSQM2_P (JROF, JBLK)
          Z_YDCPG_SL1_U9_P (JROF, JLEV, JBLK)=-Z_YDCPG_SL1_U9_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
          & (JROF, JBLK)-Z_YDCPG_SL1_V9_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
          & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
          Z_YDCPG_SL1_V9_P (JROF, JLEV, JBLK)=ZUCOMP (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
          & (JROF, JBLK)-Z_YDCPG_SL1_V9_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
          & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
        ENDDO


        IF ((YDML_DYN%YRDYN%NWLAG>=3).OR.(YDML_DYN%YRDYN%NSPLTHOI/=0)) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            ZUCOMP (JROF, JLEV, JBLK)=Z_YDCPG_SL1_U0_P (JROF, JLEV, JBLK)
            Z_YDCPG_SL1_Z0_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_V0_P (JROF&
            &, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GSQM2_P (JROF, JBLK)
            Z_YDCPG_SL1_U0_P (JROF, JLEV, JBLK)=-Z_YDCPG_SL1_U0_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
            & (JROF, JBLK)-Z_YDCPG_SL1_V0_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
            & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
            Z_YDCPG_SL1_V0_P (JROF, JLEV, JBLK)=ZUCOMP (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GECLO_P&
            & (JROF, JBLK)-Z_YDCPG_SL1_V0_P (JROF, JLEV, JBLK)*Z_YDVARS_GEOMETRY_GESLO_P&
            & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GEMU_P (JROF, JBLK)
          ENDDO

        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LATTEX_PARALLEL:LRHS_CURV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZUCOMP => GET_HOST_DATA_RDWR (YL_ZUCOMP)
      Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
      Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
      Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
      Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
      Z_YDCPG_SL1_Z0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z0%F_P)
      Z_YDCPG_SL1_Z9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%Z9%F_P)
      Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
      Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
      Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
      IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZUCOMP => NULL ()
    Z_YDCPG_SL1_U0_P => NULL ()
    Z_YDCPG_SL1_U9_P => NULL ()
    Z_YDCPG_SL1_V0_P => NULL ()
    Z_YDCPG_SL1_V9_P => NULL ()
    Z_YDCPG_SL1_Z0_P => NULL ()
    Z_YDCPG_SL1_Z9_P => NULL ()
    Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
    Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
    Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LATTEX_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL:LRHS_CURV',1,ZHOOK_HANDLE_PARALLEL)
ENDIF





CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZMOY1SPD)) CALL FIELD_DELETE (YL_ZMOY1SPD)
IF (ASSOCIATED (YL_ZMOY1T)) CALL FIELD_DELETE (YL_ZMOY1T)
IF (ASSOCIATED (YL_ZMOY1U)) CALL FIELD_DELETE (YL_ZMOY1U)
IF (ASSOCIATED (YL_ZMOY1V)) CALL FIELD_DELETE (YL_ZMOY1V)
IF (ASSOCIATED (YL_ZMOY1VWV)) CALL FIELD_DELETE (YL_ZMOY1VWV)
IF (ASSOCIATED (YL_ZSPDSI9)) CALL FIELD_DELETE (YL_ZSPDSI9)
IF (ASSOCIATED (YL_ZTSI9)) CALL FIELD_DELETE (YL_ZTSI9)
IF (ASSOCIATED (YL_ZUCOMP)) CALL FIELD_DELETE (YL_ZUCOMP)
IF (ASSOCIATED (YL_ZUSELESS)) CALL FIELD_DELETE (YL_ZUSELESS)
IF (ASSOCIATED (YL_ZUSI9)) CALL FIELD_DELETE (YL_ZUSI9)
IF (ASSOCIATED (YL_ZVSI9)) CALL FIELD_DELETE (YL_ZVSI9)
IF (ASSOCIATED (YL_ZVWVSI9)) CALL FIELD_DELETE (YL_ZVWVSI9)
IF (ASSOCIATED (YL_ZWT0)) CALL FIELD_DELETE (YL_ZWT0)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('LATTEX_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE LATTEX_PARALLEL
