SUBROUTINE LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, KPROMA, KST, KEND, KFLEV,&
& KFLDN, KFLDX, KWK, LDLIN, LDCOMAD, LDSLHD, LDVWENO, PWENOALPHA, LDMOM, LDQM&
&, LDQMH, KNOWENO, KL0, PLSCAW, PRSCAW, PXSL, POUT, LDADD, YDSTACK)
!$ACC ROUTINE (LAITRE_GMV_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB

USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
INTEGER (KIND=JPIM), INTENT (IN)::KASLB1
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KFLDN
INTEGER (KIND=JPIM), INTENT (IN)::KFLDX
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
INTEGER (KIND=JPIM), INTENT (IN)::KWK
LOGICAL, INTENT (IN)::LDLIN
LOGICAL, INTENT (IN)::LDCOMAD
LOGICAL, INTENT (IN)::LDSLHD
LOGICAL, INTENT (IN)::LDVWENO
REAL (KIND=JPRB), INTENT (IN)::PWENOALPHA
LOGICAL, INTENT (IN)::LDMOM
LOGICAL, INTENT (IN)::LDQM
LOGICAL, INTENT (IN)::LDQMH
LOGICAL, OPTIONAL, INTENT (IN)::LDADD
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
INTEGER (KIND=JPIM), INTENT (IN)::KNOWENO (KPROMA, KFLEV)
INTEGER (KIND=JPIM), INTENT (IN)::KL0 (KPROMA, KFLEV, 0:3)
REAL (KIND=JPRB), INTENT (IN)::PLSCAW (KPROMA, KFLEV, YDML_DYN%YYTLSCAW%NDIM)
REAL (KIND=JPRB), INTENT (IN)::PRSCAW (KPROMA, KFLEV, YDML_DYN%YYTRSCAW%NDIM)
REAL (KIND=JPRB), INTENT (IN)::PXSL (KASLB1, KFLDN:KFLDX)
REAL (KIND=JPRB), INTENT (OUT)::POUT (KPROMA, KFLEV)
INTEGER (KIND=JPIM)::IM_VERT
INTEGER (KIND=JPIM)::IQM

#include "laitlif_openacc.intfb.h"
#include "laitri_openacc.intfb.h"
#include "laitri_weno_openacc.intfb.h"
INTEGER (KIND=JPIM) :: JROF

YLSTACK = YDSTACK



JROF = KST





IF ((.NOT.LDMOM).AND.YDML_DYN%YRDYNA%LSLVF) THEN
  IM_VERT=YDML_DYN%YYTRSCAW%M_WVINTWSLVF
ELSE
  IM_VERT=YDML_DYN%YYTRSCAW%M_WVINTW
ENDIF


IF (LDQM) THEN
  IQM=2
ELSEIF (LDQMH) THEN
  IQM=1
ELSE
  IQM=YDML_DYN%YRDYNA%NQMGMV
ENDIF


IF (LDLIN) THEN
  CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, KPROMA, KST, KEND, KFLEV&
  &, KL0, LDCOMAD, PLSCAW, PXSL, POUT, LDADD, YDSTACK=YLSTACK)
ELSEIF (LDSLHD) THEN

  IF (LDMOM) THEN

    IF (LDVWENO) THEN
      CALL LAITRI_WENO_OPENACC (YDML_DYN%YRDYN, KASLB1, KPROMA, KST, KEND, KFLEV, KFLDN, KFLDX, IQM,&
      & YDML_DYN%YRDYN%CLAITRI_WENO_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN&
      &%YYTRSCAW%M_WCLASLD (KWK)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
      &%M_WCLOSLD (KWK)), KL0, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
      &%M_WVINTW), PXSL, POUT, PALPHA=PWENOALPHA, LDADD=LDADD, YDSTACK=YLSTACK)
    ELSE
      CALL LAITRI_OPENACC (KASLB1, KPROMA, KST, KEND, KFLEV, KFLDN, KFLDX, IQM, YDML_DYN%YRDYN%CLAITRI_TYPE&
      &, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLASLD (KWK)), PLSCAW&
      & (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOSLD (KWK)), KL0, PRSCAW&
      & (:,:, YDML_DYN%YYTRSCAW%M_WVINTWSLD), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
    ENDIF

  ELSE

    IF (LDVWENO) THEN
      CALL LAITRI_WENO_OPENACC (YDML_DYN%YRDYN, KASLB1, KPROMA, KST, KEND, KFLEV, KFLDN, KFLDX&
      &, IQM, YDML_DYN%YRDYN%CLAITRI_WENO_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW&
      & (:,:, YDML_DYN%YYTRSCAW%M_WCLASLT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,&
      &:, YDML_DYN%YYTRSCAW%M_WCLOSLT), KL0, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PRSCAW&
      & (:,:, IM_VERT), PXSL, POUT, PALPHA=PWENOALPHA, LDADD=LDADD, YDSTACK=YLSTACK)
    ELSE
      CALL LAITRI_OPENACC (KASLB1, KPROMA, KST, KEND, KFLEV, KFLDN, KFLDX, IQM, YDML_DYN%YRDYN%CLAITRI_TYPE&
      &, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLASLT), PLSCAW&
      & (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOSLT), KL0, PRSCAW &
      &(:,:, YDML_DYN%YYTRSCAW%M_WVINTWSLT), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
    ENDIF

  ENDIF

ELSEIF (LDCOMAD) THEN
  CALL LAITRI_OPENACC (KASLB1, KPROMA, KST, KEND, KFLEV, KFLDN, KFLDX, IQM, YDML_DYN%YRDYN%CLAITRI_TYPE&
  &, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAMAD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLAMAD (KWK)), PLSCAW&
  & (:,:, YDML_DYN%YYTLSCAW%M_WDLOMAD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOMAD (KWK)), KL0, PRSCAW&
  & (:,:, YDML_DYN%YYTRSCAW%M_WVINTWMAD), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
ELSEIF (LDVWENO) THEN
  CALL LAITRI_WENO_OPENACC (YDML_DYN%YRDYN, KASLB1, KPROMA, KST, KEND, KFLEV, KFLDN, KFLDX,&
  & IQM, YDML_DYN%YRDYN%CLAITRI_WENO_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW &
  &(:,:, YDML_DYN%YYTRSCAW%M_WCLA (KWK)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:&
  &,:, YDML_DYN%YYTRSCAW%M_WCLO (KWK)), KL0, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW),&
  & PRSCAW (:,:, IM_VERT), PXSL, POUT, PALPHA=PWENOALPHA, LDADD=LDADD, YDSTACK=YLSTACK)
ELSE
  CALL LAITRI_OPENACC (KASLB1, KPROMA, KST, KEND, KFLEV, KFLDN, KFLDX, IQM, YDML_DYN%YRDYN&
  &%CLAITRI_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
  &%M_WCLA (KWK)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
  &%M_WCLO (KWK)), KL0, PRSCAW (:,:, IM_VERT), PXSL, POUT, LDADD, YDSTACK=YLSTACK)
ENDIF




END SUBROUTINE LAITRE_GMV_OPENACC
