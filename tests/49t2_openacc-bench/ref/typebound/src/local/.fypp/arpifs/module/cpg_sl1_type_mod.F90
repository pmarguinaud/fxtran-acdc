MODULE CPG_SL1_TYPE_MOD

!$ACDC methods --methods-list=host,wipe,copy --skip-components cpg --field-api --field-api-class cpg


USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_REGISTRY_MOD
USE PARKIND1, ONLY : JPRB, JPIM, JPIB
USE YOM_YGFL, ONLY : TYPE_GFL_COMP

IMPLICIT NONE




ABSTRACT INTERFACE 
  LOGICAL FUNCTION FUN_GREP (YDCOMP, YDMODEL)
    USE YOM_YGFL, ONLY : TYPE_GFL_COMP
    USE TYPE_MODEL, ONLY : MODEL
    TYPE (TYPE_GFL_COMP), INTENT (IN) :: YDCOMP
    TYPE (MODEL),  INTENT (IN) :: YDMODEL
  END FUNCTION
END INTERFACE

PRIVATE :: FUN_GREP



PRIVATE :: GREPVARSB

TYPE CPG_SL1B_2D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_P => NULL ()

CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1B_2D_TYPE
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1B_2D_TYPE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1B_2D_TYPE
END TYPE

TYPE CPG_SL1B_3D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_P_P => NULL ()

  TYPE (TYPE_GFL_COMP) :: YCOMP
CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1B_3D_TYPE
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1B_3D_TYPE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1B_3D_TYPE
END TYPE


TYPE CPG_SL1B_TYPE
  LOGICAL :: LOWNED = .FALSE.
  INTEGER (KIND=JPIM) :: NLEV = -1
  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_DATA => NULL ()
  TYPE (CPG_SL1B_3D_TYPE) :: U9
  TYPE (CPG_SL1B_3D_TYPE) :: V9
  TYPE (CPG_SL1B_3D_TYPE) :: T9
  TYPE (CPG_SL1B_3D_TYPE) :: PD9
  TYPE (CPG_SL1B_3D_TYPE) :: VD9
  TYPE (CPG_SL1B_3D_TYPE) :: NHX9
  TYPE (CPG_SL1B_3D_TYPE) :: UR0
  TYPE (CPG_SL1B_3D_TYPE) :: VR0
  TYPE (CPG_SL1B_3D_TYPE) :: ZR0
  TYPE (CPG_SL1B_3D_TYPE) :: WR0
  TYPE (CPG_SL1B_3D_TYPE) :: UR00
  TYPE (CPG_SL1B_3D_TYPE) :: VR00
  TYPE (CPG_SL1B_3D_TYPE) :: ZR00
  TYPE (CPG_SL1B_3D_TYPE) :: WR00
  TYPE (CPG_SL1B_3D_TYPE) :: WRA
  TYPE (CPG_SL1B_3D_TYPE) :: UR9
  TYPE (CPG_SL1B_3D_TYPE) :: VR9
  TYPE (CPG_SL1B_3D_TYPE) :: DBBC9
  TYPE (CPG_SL1B_3D_TYPE) :: DPHI9
  TYPE (CPG_SL1B_2D_TYPE) :: GWS9
  TYPE (CPG_SL1B_3D_TYPE) :: U0
  TYPE (CPG_SL1B_3D_TYPE) :: V0
  TYPE (CPG_SL1B_3D_TYPE) :: T0
  TYPE (CPG_SL1B_3D_TYPE) :: PD0
  TYPE (CPG_SL1B_3D_TYPE) :: VD0
  TYPE (CPG_SL1B_3D_TYPE) :: C9
  TYPE (CPG_SL1B_2D_TYPE) :: SP9
  TYPE (CPG_SL1B_2D_TYPE) :: SP0
  TYPE (CPG_SL1B_3D_TYPE) :: C0
  TYPE (CPG_SL1B_3D_TYPE) :: UP9
  TYPE (CPG_SL1B_3D_TYPE) :: VP9
  TYPE (CPG_SL1B_3D_TYPE) :: TP9
  TYPE (CPG_SL1B_3D_TYPE) :: U9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: V9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: T9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: PD9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: VD9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: C9_SI
  TYPE (CPG_SL1B_3D_TYPE) :: UF9
  TYPE (CPG_SL1B_3D_TYPE) :: VF9
  TYPE (CPG_SL1B_3D_TYPE) :: TF9
  TYPE (CPG_SL1B_3D_TYPE) :: VDF9
  TYPE (CPG_SL1B_3D_TYPE) :: U9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: V9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: T9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: PD9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: VD9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: C9_NL
  TYPE (CPG_SL1B_3D_TYPE) :: ZR9
  TYPE (CPG_SL1B_3D_TYPE) :: Z9
  TYPE (CPG_SL1B_3D_TYPE) :: Z0
  TYPE (CPG_SL1B_3D_TYPE) :: ZP9

  TYPE (CPG_SL1B_3D_TYPE) :: Q
  TYPE (CPG_SL1B_3D_TYPE) :: I
  TYPE (CPG_SL1B_3D_TYPE) :: L
  TYPE (CPG_SL1B_3D_TYPE) :: IMF
  TYPE (CPG_SL1B_3D_TYPE) :: LMF
  TYPE (CPG_SL1B_3D_TYPE) :: LCONV
  TYPE (CPG_SL1B_3D_TYPE) :: ICONV
  TYPE (CPG_SL1B_3D_TYPE) :: RCONV
  TYPE (CPG_SL1B_3D_TYPE) :: SCONV
  TYPE (CPG_SL1B_3D_TYPE) :: IRAD
  TYPE (CPG_SL1B_3D_TYPE) :: LRAD
  TYPE (CPG_SL1B_3D_TYPE) :: S
  TYPE (CPG_SL1B_3D_TYPE) :: R
  TYPE (CPG_SL1B_3D_TYPE) :: G
  TYPE (CPG_SL1B_3D_TYPE) :: H
  TYPE (CPG_SL1B_3D_TYPE) :: TKE
  TYPE (CPG_SL1B_3D_TYPE) :: TTE
  TYPE (CPG_SL1B_3D_TYPE) :: EFB1
  TYPE (CPG_SL1B_3D_TYPE) :: EFB2
  TYPE (CPG_SL1B_3D_TYPE) :: EFB3
  TYPE (CPG_SL1B_3D_TYPE) :: A
  TYPE (CPG_SL1B_3D_TYPE) :: AMF
  TYPE (CPG_SL1B_3D_TYPE) :: O3
  TYPE (CPG_SL1B_3D_TYPE) :: SRC
  TYPE (CPG_SL1B_3D_TYPE) :: MXL
  TYPE (CPG_SL1B_3D_TYPE) :: SHTUR
  TYPE (CPG_SL1B_3D_TYPE) :: FQTUR
  TYPE (CPG_SL1B_3D_TYPE) :: FSTUR
  TYPE (CPG_SL1B_3D_TYPE) :: CPF
  TYPE (CPG_SL1B_3D_TYPE) :: SPF
  TYPE (CPG_SL1B_3D_TYPE) :: CVGQ
  TYPE (CPG_SL1B_3D_TYPE) :: QVA
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: GHG (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: CHEM (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AERO (:)
  TYPE (CPG_SL1B_3D_TYPE) :: LRCH4
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: FORC (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EZDIAG (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: ERA40 (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: NOGW (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EMIS3D (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EDRP (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: SLDIA (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AERAOT (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AERLISI (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AEROUT (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: AEROCLIM (:)
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: UVP (:)
  TYPE (CPG_SL1B_3D_TYPE) :: PHYCTY
  TYPE (CPG_SL1B_3D_TYPE) :: RSPEC
  TYPE (CPG_SL1B_3D_TYPE) :: SDSAT
  TYPE (CPG_SL1B_3D_TYPE) :: CVV
  TYPE (CPG_SL1B_3D_TYPE) :: RKTH
  TYPE (CPG_SL1B_3D_TYPE) :: RKTQV
  TYPE (CPG_SL1B_3D_TYPE) :: RKTQC
  TYPE (CPG_SL1B_3D_TYPE) :: UOM
  TYPE (CPG_SL1B_3D_TYPE) :: UAL
  TYPE (CPG_SL1B_3D_TYPE) :: DOM
  TYPE (CPG_SL1B_3D_TYPE) :: DAL
  TYPE (CPG_SL1B_3D_TYPE) :: UEN
  TYPE (CPG_SL1B_3D_TYPE) :: UNEBH
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: LIMA (:)
  TYPE (CPG_SL1B_3D_TYPE) :: FSD
  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: EXT (:)

  TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: GFL (:)


CONTAINS
  PROCEDURE :: INIT => CPG_SL1B_TYPE_INIT
  PROCEDURE :: FINAL => CPG_SL1B_TYPE_FINAL
  PROCEDURE :: SYNC_HOST => CPG_SL1B_TYPE_SYNC_HOST

  PROCEDURE :: UPDATE_VIEW => CPG_SL1B_TYPE_UPDATE_VIEW

  PROCEDURE :: SET_HOST_PARALLEL => CPG_SL1B_TYPE_SET_HOST_PARALLEL
  PROCEDURE :: SET_DEVICE_PARALLEL => CPG_SL1B_TYPE_SET_DEVICE_PARALLEL


  PROCEDURE :: SET => CPG_SL1B_TYPE_SET
  PROCEDURE :: SHUFFLE => CPG_SL1B_TYPE_SHUFFLE
  PROCEDURE :: SHUFFLE_HOST_PARALLEL => CPG_SL1B_TYPE_SHUFFLE_HOST_PARALLEL
  PROCEDURE :: SHUFFLE_DEVICE_PARALLEL => CPG_SL1B_TYPE_SHUFFLE_DEVICE_PARALLEL


PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1B_TYPE
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1B_TYPE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1B_TYPE
END TYPE CPG_SL1B_TYPE


PRIVATE :: GREPVARSF

TYPE CPG_SL1F_2D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:) => NULL ()
  CLASS (FIELD_1RB), POINTER :: F_P_P => NULL ()

CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1F_2D_TYPE
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1F_2D_TYPE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1F_2D_TYPE
END TYPE

TYPE CPG_SL1F_3D_TYPE
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_F (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_F => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SPF (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SPF => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_SP (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_SP => NULL ()

  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: P_P (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_P_P => NULL ()

  TYPE (TYPE_GFL_COMP) :: YCOMP
CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1F_3D_TYPE
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1F_3D_TYPE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1F_3D_TYPE
END TYPE


TYPE CPG_SL1F_1RB
  CLASS (FIELD_1RB), POINTER :: F_P => NULL ()
  REAL (KIND=JPRB) :: PARITY = 1._JPRB
  INTEGER (KIND=JPIM) :: JFLD1 = -1, JFLD2 = -1
CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1F_1RB
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1F_1RB
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1F_1RB
END TYPE

TYPE CPG_SL1F_2RB
  CLASS (FIELD_2RB), POINTER :: F_P => NULL ()
  REAL (KIND=JPRB) :: PARITY = 1._JPRB
  INTEGER (KIND=JPIM) :: JFLD1 = -1, JFLD2 = -1
CONTAINS
PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1F_2RB
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1F_2RB
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1F_2RB
END TYPE

TYPE CPG_SL1F_TYPE
  LOGICAL :: LOWNED = .FALSE.
  INTEGER (KIND=JPIM) :: NLEV = -1
  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_DATA => NULL ()
  TYPE (CPG_SL1F_3D_TYPE) :: U9
  TYPE (CPG_SL1F_3D_TYPE) :: V9
  TYPE (CPG_SL1F_3D_TYPE) :: T9
  TYPE (CPG_SL1F_3D_TYPE) :: PD9
  TYPE (CPG_SL1F_3D_TYPE) :: VD9
  TYPE (CPG_SL1F_3D_TYPE) :: NHX9
  TYPE (CPG_SL1F_3D_TYPE) :: UR0
  TYPE (CPG_SL1F_3D_TYPE) :: VR0
  TYPE (CPG_SL1F_3D_TYPE) :: ZR0
  TYPE (CPG_SL1F_3D_TYPE) :: WR0
  TYPE (CPG_SL1F_3D_TYPE) :: UR00
  TYPE (CPG_SL1F_3D_TYPE) :: VR00
  TYPE (CPG_SL1F_3D_TYPE) :: ZR00
  TYPE (CPG_SL1F_3D_TYPE) :: WR00
  TYPE (CPG_SL1F_3D_TYPE) :: WRA
  TYPE (CPG_SL1F_3D_TYPE) :: UR9
  TYPE (CPG_SL1F_3D_TYPE) :: VR9
  TYPE (CPG_SL1F_3D_TYPE) :: DBBC9
  TYPE (CPG_SL1F_3D_TYPE) :: DPHI9
  TYPE (CPG_SL1F_2D_TYPE) :: GWS9
  TYPE (CPG_SL1F_3D_TYPE) :: U0
  TYPE (CPG_SL1F_3D_TYPE) :: V0
  TYPE (CPG_SL1F_3D_TYPE) :: T0
  TYPE (CPG_SL1F_3D_TYPE) :: PD0
  TYPE (CPG_SL1F_3D_TYPE) :: VD0
  TYPE (CPG_SL1F_3D_TYPE) :: C9
  TYPE (CPG_SL1F_2D_TYPE) :: SP9
  TYPE (CPG_SL1F_2D_TYPE) :: SP0
  TYPE (CPG_SL1F_3D_TYPE) :: C0
  TYPE (CPG_SL1F_3D_TYPE) :: UP9
  TYPE (CPG_SL1F_3D_TYPE) :: VP9
  TYPE (CPG_SL1F_3D_TYPE) :: TP9
  TYPE (CPG_SL1F_3D_TYPE) :: U9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: V9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: T9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: PD9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: VD9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: C9_SI
  TYPE (CPG_SL1F_3D_TYPE) :: UF9
  TYPE (CPG_SL1F_3D_TYPE) :: VF9
  TYPE (CPG_SL1F_3D_TYPE) :: TF9
  TYPE (CPG_SL1F_3D_TYPE) :: VDF9
  TYPE (CPG_SL1F_3D_TYPE) :: U9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: V9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: T9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: PD9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: VD9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: C9_NL
  TYPE (CPG_SL1F_3D_TYPE) :: ZR9
  TYPE (CPG_SL1F_3D_TYPE) :: Z9
  TYPE (CPG_SL1F_3D_TYPE) :: Z0
  TYPE (CPG_SL1F_3D_TYPE) :: ZP9

  TYPE (CPG_SL1F_3D_TYPE) :: Q
  TYPE (CPG_SL1F_3D_TYPE) :: I
  TYPE (CPG_SL1F_3D_TYPE) :: L
  TYPE (CPG_SL1F_3D_TYPE) :: IMF
  TYPE (CPG_SL1F_3D_TYPE) :: LMF
  TYPE (CPG_SL1F_3D_TYPE) :: LCONV
  TYPE (CPG_SL1F_3D_TYPE) :: ICONV
  TYPE (CPG_SL1F_3D_TYPE) :: RCONV
  TYPE (CPG_SL1F_3D_TYPE) :: SCONV
  TYPE (CPG_SL1F_3D_TYPE) :: IRAD
  TYPE (CPG_SL1F_3D_TYPE) :: LRAD
  TYPE (CPG_SL1F_3D_TYPE) :: S
  TYPE (CPG_SL1F_3D_TYPE) :: R
  TYPE (CPG_SL1F_3D_TYPE) :: G
  TYPE (CPG_SL1F_3D_TYPE) :: H
  TYPE (CPG_SL1F_3D_TYPE) :: TKE
  TYPE (CPG_SL1F_3D_TYPE) :: TTE
  TYPE (CPG_SL1F_3D_TYPE) :: EFB1
  TYPE (CPG_SL1F_3D_TYPE) :: EFB2
  TYPE (CPG_SL1F_3D_TYPE) :: EFB3
  TYPE (CPG_SL1F_3D_TYPE) :: A
  TYPE (CPG_SL1F_3D_TYPE) :: AMF
  TYPE (CPG_SL1F_3D_TYPE) :: O3
  TYPE (CPG_SL1F_3D_TYPE) :: SRC
  TYPE (CPG_SL1F_3D_TYPE) :: MXL
  TYPE (CPG_SL1F_3D_TYPE) :: SHTUR
  TYPE (CPG_SL1F_3D_TYPE) :: FQTUR
  TYPE (CPG_SL1F_3D_TYPE) :: FSTUR
  TYPE (CPG_SL1F_3D_TYPE) :: CPF
  TYPE (CPG_SL1F_3D_TYPE) :: SPF
  TYPE (CPG_SL1F_3D_TYPE) :: CVGQ
  TYPE (CPG_SL1F_3D_TYPE) :: QVA
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: GHG (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: CHEM (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AERO (:)
  TYPE (CPG_SL1F_3D_TYPE) :: LRCH4
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: FORC (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EZDIAG (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: ERA40 (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: NOGW (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EMIS3D (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EDRP (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: SLDIA (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AERAOT (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AERLISI (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AEROUT (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: AEROCLIM (:)
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: UVP (:)
  TYPE (CPG_SL1F_3D_TYPE) :: PHYCTY
  TYPE (CPG_SL1F_3D_TYPE) :: RSPEC
  TYPE (CPG_SL1F_3D_TYPE) :: SDSAT
  TYPE (CPG_SL1F_3D_TYPE) :: CVV
  TYPE (CPG_SL1F_3D_TYPE) :: RKTH
  TYPE (CPG_SL1F_3D_TYPE) :: RKTQV
  TYPE (CPG_SL1F_3D_TYPE) :: RKTQC
  TYPE (CPG_SL1F_3D_TYPE) :: UOM
  TYPE (CPG_SL1F_3D_TYPE) :: UAL
  TYPE (CPG_SL1F_3D_TYPE) :: DOM
  TYPE (CPG_SL1F_3D_TYPE) :: DAL
  TYPE (CPG_SL1F_3D_TYPE) :: UEN
  TYPE (CPG_SL1F_3D_TYPE) :: UNEBH
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: LIMA (:)
  TYPE (CPG_SL1F_3D_TYPE) :: FSD
  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: EXT (:)

  TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: GFL (:)


! First part of on-demand SL
  TYPE (CPG_SL1F_1RB), ALLOCATABLE :: Y2FSL (:)  
  TYPE (CPG_SL1F_2RB), ALLOCATABLE :: Y3FSL (:)

! Second part of on-demand SL
  TYPE (CPG_SL1F_1RB), ALLOCATABLE :: Y2FSLA (:)
  TYPE (CPG_SL1F_2RB), ALLOCATABLE :: Y3FSLA (:)

! All for regular SL (not on-demand)
  TYPE (CPG_SL1F_1RB), ALLOCATABLE :: Y2FSLB (:)
  TYPE (CPG_SL1F_2RB), ALLOCATABLE :: Y3FSLB (:)


CONTAINS
  PROCEDURE :: INIT => CPG_SL1F_TYPE_INIT
  PROCEDURE :: FINAL => CPG_SL1F_TYPE_FINAL
  PROCEDURE :: SYNC_HOST => CPG_SL1F_TYPE_SYNC_HOST

  PROCEDURE :: CONFORM => CPG_SL1F_TYPE_CONFORM
  PROCEDURE :: RESIZE => CPG_SL1F_TYPE_RESIZE
  PROCEDURE, PRIVATE :: SET_POINTERS => CPG_SL1F_TYPE_SET_POINTERS

  PROCEDURE :: SET_HOST_PARALLEL => CPG_SL1F_TYPE_SET_HOST_PARALLEL
  PROCEDURE :: SET_DEVICE_PARALLEL => CPG_SL1F_TYPE_SET_DEVICE_PARALLEL


PROCEDURE :: ACDC_COPY => ACDC_COPY_CPG_SL1F_TYPE
PROCEDURE :: ACDC_HOST => ACDC_HOST_CPG_SL1F_TYPE
PROCEDURE :: ACDC_WIPE => ACDC_WIPE_CPG_SL1F_TYPE
END TYPE CPG_SL1F_TYPE


REAL(KIND=JPRB), PRIVATE, SAVE, TARGET :: ZDUM1 (1), ZDUM2 (1, 1)

INTERFACE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1B_2D_TYPE (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1B_2D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1B_2D_TYPE (SELF)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1B_2D_TYPE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1B_2D_TYPE (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1B_2D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1B_3D_TYPE (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1B_3D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1B_3D_TYPE (SELF)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1B_3D_TYPE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1B_3D_TYPE (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1B_3D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1B_TYPE (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (CPG_SL1B_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1B_TYPE (SELF)

IMPLICIT NONE
CLASS (CPG_SL1B_TYPE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1B_TYPE (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (CPG_SL1B_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1F_2D_TYPE (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_2D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1F_2D_TYPE (SELF)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_2D_TYPE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1F_2D_TYPE (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_2D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1F_3D_TYPE (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_3D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1F_3D_TYPE (SELF)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_3D_TYPE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1F_3D_TYPE (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_3D_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1F_1RB (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_1RB), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1F_1RB (SELF)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_1RB), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1F_1RB (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_1RB), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1F_2RB (SELF, LDCREATED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_2RB), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1F_2RB (SELF)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_2RB), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1F_2RB (SELF, LDDELETED, LDFIELDAPI)
USE FIELD_UTIL_MODULE
IMPLICIT NONE
CLASS (CPG_SL1F_2RB), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_COPY_CPG_SL1F_TYPE (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
CLASS (CPG_SL1F_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
END SUBROUTINE

MODULE SUBROUTINE ACDC_HOST_CPG_SL1F_TYPE (SELF)

IMPLICIT NONE
CLASS (CPG_SL1F_TYPE), TARGET :: SELF
END SUBROUTINE

MODULE SUBROUTINE ACDC_WIPE_CPG_SL1F_TYPE (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (CPG_SL1F_TYPE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
END SUBROUTINE


END INTERFACE

CONTAINS



SUBROUTINE GREPVARSB (YDCPG_SL1B, YDMODEL, COND, YDVARS_LIST)
USE TYPE_MODEL, ONLY : MODEL
TYPE(CPG_SL1B_TYPE), INTENT(INOUT) :: YDCPG_SL1B
TYPE(MODEL), INTENT(IN) :: YDMODEL
PROCEDURE (FUN_GREP) :: COND
TYPE (CPG_SL1B_3D_TYPE), ALLOCATABLE :: YDVARS_LIST (:)

INTEGER (KIND=JPIM) :: ISIZE, JFLD, IPNTR

ISIZE = 0

IF (COND (YDMODEL%YRML_GCONF%YGFL%YQ, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YI, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIMF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLMF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLCONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YICONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRCONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSCONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIRAD, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRAD, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YS, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YG, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YH, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTKE, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTTE, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB1, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB2, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB3, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YA, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YAMF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YO3, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSRC, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YMXL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSHTUR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFQTUR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSTUR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCPF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSPF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVGQ, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YQVA, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1B%GHG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%GHG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YGHG(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%CHEM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%CHEM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YCHEM(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AERO)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AERO)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERO(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRCH4, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1B%FORC)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%FORC)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YFORC(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%EZDIAG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EZDIAG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEZDIAG(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%ERA40)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%ERA40)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YERA40(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%NOGW)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%NOGW)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YNOGW(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%EMIS3D)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EMIS3D)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEMIS3D(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%EDRP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EDRP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEDRP(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%SLDIA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%SLDIA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YSLDIA(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AERAOT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AERAOT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERAOT(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AERLISI)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AERLISI)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERLISI(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AEROUT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AEROUT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROUT(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AEROCLIM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AEROCLIM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROCLIM(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%UVP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%UVP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YUVP(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YPHYCTY, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRSPEC, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSDSAT, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTH, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQC, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUOM, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUAL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDOM, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDAL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUEN, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUNEBH, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1B%LIMA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%LIMA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YLIMA(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSD, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1B%EXT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EXT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEXT(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF

ALLOCATE (YDVARS_LIST (ISIZE))

IPNTR = 1

IF (COND (YDMODEL%YRML_GCONF%YGFL%YQ, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%Q
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YI, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%I
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%L
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIMF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%IMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLMF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%LMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLCONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%LCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YICONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%ICONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRCONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%RCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSCONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%SCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIRAD, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%IRAD
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRAD, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%LRAD
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YS, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%S
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%R
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YG, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%G
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YH, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%H
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTKE, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%TKE
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTTE, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%TTE
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB1, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%EFB1
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB2, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%EFB2
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB3, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%EFB3
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YA, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%A
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YAMF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%AMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YO3, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%O3
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSRC, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%SRC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YMXL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%MXL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSHTUR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%SHTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFQTUR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%FQTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSTUR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%FSTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCPF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%CPF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSPF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%SPF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVGQ, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%CVGQ
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YQVA, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%QVA
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1B%GHG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%GHG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YGHG(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%GHG(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%CHEM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%CHEM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YCHEM(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%CHEM(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AERO)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AERO)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERO(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%AERO(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRCH4, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%LRCH4
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1B%FORC)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%FORC)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YFORC(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%FORC(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%EZDIAG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EZDIAG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEZDIAG(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%EZDIAG(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%ERA40)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%ERA40)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YERA40(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%ERA40(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%NOGW)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%NOGW)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YNOGW(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%NOGW(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%EMIS3D)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EMIS3D)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEMIS3D(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%EMIS3D(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%EDRP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EDRP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEDRP(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%EDRP(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%SLDIA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%SLDIA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YSLDIA(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%SLDIA(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AERAOT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AERAOT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERAOT(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%AERAOT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AERLISI)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AERLISI)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERLISI(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%AERLISI(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AEROUT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AEROUT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROUT(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%AEROUT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%AEROCLIM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%AEROCLIM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROCLIM(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%AEROCLIM(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1B%UVP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%UVP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YUVP(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%UVP(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YPHYCTY, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%PHYCTY
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRSPEC, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%RSPEC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSDSAT, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%SDSAT
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%CVV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTH, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%RKTH
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%RKTQV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQC, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%RKTQC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUOM, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%UOM
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUAL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%UAL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDOM, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%DOM
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDAL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%DAL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUEN, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%UEN
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUNEBH, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%UNEBH
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1B%LIMA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%LIMA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YLIMA(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%LIMA(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSD, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1B%FSD
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1B%EXT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1B%EXT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEXT(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1B%EXT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
    
END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB1 &
                                 & , YDMODEL &
                                 & , YGFL &
                                 & , PERSISTENT &
                                 & , PB1 &
                                 & , KBLKMIN &
                                 & , KBLKMAX &
                                 & )

USE PTRSLB1, ONLY : TPTRSLB1
USE OML_MOD, ONLY: OML_MAX_THREADS

USE YOM_YGFL  , ONLY : TYPE_GFLD
USE TYPE_MODEL, ONLY : MODEL
USE EINT_MOD  , ONLY : SL_STRUCT

USE FIELD_DEFAULTS_MODULE

CLASS (CPG_SL1B_TYPE),TARGET                 :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),                    INTENT (IN)    :: YDTPTRSLB1
TYPE (TYPE_GFLD),                   INTENT (IN)    :: YGFL
TYPE (MODEL),               TARGET, INTENT (IN)    :: YDMODEL
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB1 (:,:,:)
INTEGER (KIND=JPIM), OPTIONAL,      INTENT (IN)    :: KBLKMIN, KBLKMAX

INTEGER (KIND=JPIM) :: JFLD
INTEGER (KIND=JPIM) :: JGFL
INTEGER (KIND=JPIM) :: ISIZE, IPNTR
INTEGER (KIND=JPIM) :: ISIZE_1, IPNTR_1
INTEGER (KIND=JPIM) :: ISIZE_2, IPNTR_2

LOGICAL :: LLPERSISTENT
LOGICAL :: LLINITIALIZED

INTEGER (KIND=JPIM) :: IBLKMIN, IBLKMAX

TYPE(SL_STRUCT),  POINTER :: YLSL
TYPE(TYPE_GFL_COMP), POINTER :: YDGFC


SELF%NLEV = NLEV

LLINITIALIZED = .FALSE.


LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IBLKMIN = 1
IF (PRESENT (KBLKMIN)) IBLKMIN = KBLKMIN
IBLKMAX = REGISTRY%GEOM%YRDIM%NGPBLKS
IF (PRESENT (KBLKMAX)) IBLKMAX = KBLKMAX

IF (PRESENT (PB1)) THEN
  SELF%ZDATA => PB1
  SELF%LOWNED  = .FALSE.
  LLPERSISTENT = .TRUE.
  LLINITIALIZED = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB1%NFLDSLB1, IBLKMIN:IBLKMAX))
  IF (USE_INIT_DEBUG_VALUE) THEN
    SELF%ZDATA = INIT_DEBUG_VALUE_JPRB
    LLINITIALIZED = .TRUE.
  ENDIF
  SELF%LOWNED  = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB1%NFLDSLB1, OML_MAX_THREADS ()))
  IF (USE_INIT_DEBUG_VALUE) THEN
    SELF%ZDATA = INIT_DEBUG_VALUE_JPRB
    LLINITIALIZED = .TRUE.
  ENDIF
  SELF%LOWNED = .TRUE.
ENDIF


CALL FIELD_NEW (SELF%F_DATA, DATA=SELF%ZDATA, PERSISTENT=LLPERSISTENT, LBOUNDS=LBOUND (SELF%ZDATA), &
              & INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)




IF (YDTPTRSLB1%MSLB1U9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9

  CALL FIELD_NEW (SELF%U9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%U9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9

  CALL FIELD_NEW (SELF%V9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%V9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9

  CALL FIELD_NEW (SELF%T9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%T9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9

  CALL FIELD_NEW (SELF%PD9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%PD9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9

  CALL FIELD_NEW (SELF%VD9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VD9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1NHX9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1NHX9

  CALL FIELD_NEW (SELF%NHX9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%NHX9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR0

  CALL FIELD_NEW (SELF%UR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%UR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR0

  CALL FIELD_NEW (SELF%VR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR0

  CALL FIELD_NEW (SELF%ZR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%ZR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR0

  CALL FIELD_NEW (SELF%WR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%WR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR00

  CALL FIELD_NEW (SELF%UR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%UR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR00

  CALL FIELD_NEW (SELF%VR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR00

  CALL FIELD_NEW (SELF%ZR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%ZR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR00

  CALL FIELD_NEW (SELF%WR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%WR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WRA > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WRA

  CALL FIELD_NEW (SELF%WRA%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%WRA%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR9

  CALL FIELD_NEW (SELF%UR9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%UR9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR9

  CALL FIELD_NEW (SELF%VR9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VR9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1DBBC9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DBBC9

  CALL FIELD_NEW (SELF%DBBC9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%DBBC9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1DPHI9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DPHI9

  CALL FIELD_NEW (SELF%DPHI9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%DPHI9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1GWS9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GWS9

  CALL FIELD_NEW (SELF%GWS9%F_P, DATA=SELF%ZDATA (:, JFLD, :),                         PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1               , IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%GWS9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U0

  CALL FIELD_NEW (SELF%U0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%U0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V0

  CALL FIELD_NEW (SELF%V0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%V0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T0

  CALL FIELD_NEW (SELF%T0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%T0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD0

  CALL FIELD_NEW (SELF%PD0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%PD0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD0

  CALL FIELD_NEW (SELF%VD0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VD0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9

  CALL FIELD_NEW (SELF%C9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%C9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1SP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP9

  CALL FIELD_NEW (SELF%SP9%F_P, DATA=SELF%ZDATA (:, JFLD, :),                         PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1               , IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%SP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1SP0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP0

  CALL FIELD_NEW (SELF%SP0%F_P, DATA=SELF%ZDATA (:, JFLD, :),                         PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1               , IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%SP0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C0

  CALL FIELD_NEW (SELF%C0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%C0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UP9

  CALL FIELD_NEW (SELF%UP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%UP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VP9

  CALL FIELD_NEW (SELF%VP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1TP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TP9

  CALL FIELD_NEW (SELF%TP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%TP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_SI

  CALL FIELD_NEW (SELF%U9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%U9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_SI

  CALL FIELD_NEW (SELF%V9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%V9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_SI

  CALL FIELD_NEW (SELF%T9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%T9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_SI

  CALL FIELD_NEW (SELF%PD9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%PD9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_SI

  CALL FIELD_NEW (SELF%VD9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VD9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_SI

  CALL FIELD_NEW (SELF%C9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%C9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UF9

  CALL FIELD_NEW (SELF%UF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%UF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VF9

  CALL FIELD_NEW (SELF%VF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1TF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TF9

  CALL FIELD_NEW (SELF%TF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%TF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VDF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VDF9

  CALL FIELD_NEW (SELF%VDF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VDF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_NL

  CALL FIELD_NEW (SELF%U9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%U9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_NL

  CALL FIELD_NEW (SELF%V9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%V9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_NL

  CALL FIELD_NEW (SELF%T9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%T9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_NL

  CALL FIELD_NEW (SELF%PD9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%PD9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_NL

  CALL FIELD_NEW (SELF%VD9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%VD9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_NL

  CALL FIELD_NEW (SELF%C9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%C9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR9

  CALL FIELD_NEW (SELF%ZR9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%ZR9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1Z9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1Z9

  CALL FIELD_NEW (SELF%Z9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%Z9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1Z0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1Z0

  CALL FIELD_NEW (SELF%Z0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%Z0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZP9

  CALL FIELD_NEW (SELF%ZP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)


ELSE
  SELF%ZP9%F_P => NULL ()
ENDIF

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%Q, YGFL%YQ)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%I, YGFL%YI)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%L, YGFL%YL)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%IMF, YGFL%YIMF)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%LMF, YGFL%YLMF)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%LCONV, YGFL%YLCONV)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%ICONV, YGFL%YICONV)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%RCONV, YGFL%YRCONV)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%SCONV, YGFL%YSCONV)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%IRAD, YGFL%YIRAD)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%LRAD, YGFL%YLRAD)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%S, YGFL%YS)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%R, YGFL%YR)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%G, YGFL%YG)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%H, YGFL%YH)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%TKE, YGFL%YTKE)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%TTE, YGFL%YTTE)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%EFB1, YGFL%YEFB1)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%EFB2, YGFL%YEFB2)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%EFB3, YGFL%YEFB3)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%A, YGFL%YA)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%AMF, YGFL%YAMF)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%O3, YGFL%YO3)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%SRC, YGFL%YSRC)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%MXL, YGFL%YMXL)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%SHTUR, YGFL%YSHTUR)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%FQTUR, YGFL%YFQTUR)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%FSTUR, YGFL%YFSTUR)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%CPF, YGFL%YCPF)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%SPF, YGFL%YSPF)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%CVGQ, YGFL%YCVGQ)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%QVA, YGFL%YQVA)



IF (ASSOCIATED (YGFL%YGHG)) THEN
  ALLOCATE (SELF%GHG (SIZE (YGFL%YGHG)))

  DO JGFL = 1, SIZE (YGFL%YGHG)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%GHG(JGFL), YGFL%YGHG(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YCHEM)) THEN
  ALLOCATE (SELF%CHEM (SIZE (YGFL%YCHEM)))

  DO JGFL = 1, SIZE (YGFL%YCHEM)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%CHEM(JGFL), YGFL%YCHEM(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAERO)) THEN
  ALLOCATE (SELF%AERO (SIZE (YGFL%YAERO)))

  DO JGFL = 1, SIZE (YGFL%YAERO)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%AERO(JGFL), YGFL%YAERO(JGFL))
  ENDDO
ENDIF

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%LRCH4, YGFL%YLRCH4)



IF (ASSOCIATED (YGFL%YFORC)) THEN
  ALLOCATE (SELF%FORC (SIZE (YGFL%YFORC)))

  DO JGFL = 1, SIZE (YGFL%YFORC)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%FORC(JGFL), YGFL%YFORC(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YEZDIAG)) THEN
  ALLOCATE (SELF%EZDIAG (SIZE (YGFL%YEZDIAG)))

  DO JGFL = 1, SIZE (YGFL%YEZDIAG)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%EZDIAG(JGFL), YGFL%YEZDIAG(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YERA40)) THEN
  ALLOCATE (SELF%ERA40 (SIZE (YGFL%YERA40)))

  DO JGFL = 1, SIZE (YGFL%YERA40)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%ERA40(JGFL), YGFL%YERA40(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YNOGW)) THEN
  ALLOCATE (SELF%NOGW (SIZE (YGFL%YNOGW)))

  DO JGFL = 1, SIZE (YGFL%YNOGW)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%NOGW(JGFL), YGFL%YNOGW(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YEMIS3D)) THEN
  ALLOCATE (SELF%EMIS3D (SIZE (YGFL%YEMIS3D)))

  DO JGFL = 1, SIZE (YGFL%YEMIS3D)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%EMIS3D(JGFL), YGFL%YEMIS3D(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YEDRP)) THEN
  ALLOCATE (SELF%EDRP (SIZE (YGFL%YEDRP)))

  DO JGFL = 1, SIZE (YGFL%YEDRP)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%EDRP(JGFL), YGFL%YEDRP(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YSLDIA)) THEN
  ALLOCATE (SELF%SLDIA (SIZE (YGFL%YSLDIA)))

  DO JGFL = 1, SIZE (YGFL%YSLDIA)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%SLDIA(JGFL), YGFL%YSLDIA(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAERAOT)) THEN
  ALLOCATE (SELF%AERAOT (SIZE (YGFL%YAERAOT)))

  DO JGFL = 1, SIZE (YGFL%YAERAOT)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%AERAOT(JGFL), YGFL%YAERAOT(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAERLISI)) THEN
  ALLOCATE (SELF%AERLISI (SIZE (YGFL%YAERLISI)))

  DO JGFL = 1, SIZE (YGFL%YAERLISI)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%AERLISI(JGFL), YGFL%YAERLISI(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAEROUT)) THEN
  ALLOCATE (SELF%AEROUT (SIZE (YGFL%YAEROUT)))

  DO JGFL = 1, SIZE (YGFL%YAEROUT)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%AEROUT(JGFL), YGFL%YAEROUT(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAEROCLIM)) THEN
  ALLOCATE (SELF%AEROCLIM (SIZE (YGFL%YAEROCLIM)))

  DO JGFL = 1, SIZE (YGFL%YAEROCLIM)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%AEROCLIM(JGFL), YGFL%YAEROCLIM(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YUVP)) THEN
  ALLOCATE (SELF%UVP (SIZE (YGFL%YUVP)))

  DO JGFL = 1, SIZE (YGFL%YUVP)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%UVP(JGFL), YGFL%YUVP(JGFL))
  ENDDO
ENDIF

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%PHYCTY, YGFL%YPHYCTY)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%RSPEC, YGFL%YRSPEC)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%SDSAT, YGFL%YSDSAT)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%CVV, YGFL%YCVV)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%RKTH, YGFL%YRKTH)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%RKTQV, YGFL%YRKTQV)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%RKTQC, YGFL%YRKTQC)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%UOM, YGFL%YUOM)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%UAL, YGFL%YUAL)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%DOM, YGFL%YDOM)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%DAL, YGFL%YDAL)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%UEN, YGFL%YUEN)

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%UNEBH, YGFL%YUNEBH)



IF (ASSOCIATED (YGFL%YLIMA)) THEN
  ALLOCATE (SELF%LIMA (SIZE (YGFL%YLIMA)))

  DO JGFL = 1, SIZE (YGFL%YLIMA)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%LIMA(JGFL), YGFL%YLIMA(JGFL))
  ENDDO
ENDIF

CALL CPG_SL1B_TYPE_INIT_F3D (SELF%FSD, YGFL%YFSD)



IF (ASSOCIATED (YGFL%YEXT)) THEN
  ALLOCATE (SELF%EXT (SIZE (YGFL%YEXT)))

  DO JGFL = 1, SIZE (YGFL%YEXT)
    CALL CPG_SL1B_TYPE_INIT_F3D (SELF%EXT(JGFL), YGFL%YEXT(JGFL))
  ENDDO
ENDIF



CALL GREPVARSB (SELF, YDMODEL, COND_GFL, SELF%GFL)



CONTAINS


LOGICAL FUNCTION COND_GFL (YDCOMP, YDMODEL)
  USE YOM_YGFL, ONLY : TYPE_GFL_COMP
  TYPE (TYPE_GFL_COMP), INTENT (IN) :: YDCOMP
  TYPE (MODEL), INTENT(IN) :: YDMODEL
  COND_GFL = .TRUE.
END FUNCTION

SUBROUTINE CPG_SL1B_TYPE_INIT_F3D (YDF3D, YDGFC)

USE YOM_YGFL, ONLY : TYPE_GFL_COMP

TYPE (CPG_SL1B_3D_TYPE), INTENT (INOUT) :: YDF3D
TYPE(TYPE_GFL_COMP),           INTENT (IN)    :: YDGFC

YDF3D%YCOMP = YDGFC

IF (YDGFC%MP_SL1 > 0 .AND. YDGFC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9     + (YDGFC%MP_SL1-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  YDF3D%F_P => NULL ()
ENDIF

IF ((YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) .AND. YDGFC%MP_SL1 > 0 .AND. YDGFC%MP1 > 0)&
    & THEN
  JFLD = YDTPTRSLB1%MSLB1GFLF9    + (YDGFC%MP_SL1-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_F, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  YDF3D%F_P_F => NULL ()
ENDIF

IF (YDTPTRSLB1%MSLB1GFLSPF9 >= 0 .AND. YDGFC%MP_SPL > 0 .AND. YDGFC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFLSPF9  + (YDGFC%MP_SPL-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_SPF, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  YDF3D%F_P_SPF => NULL ()
ENDIF

IF (YDGFC%MP_SPL > 0 .AND. YDGFC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFLSP9   + (YDGFC%MP_SPL-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_SP, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  YDF3D%F_P_SP => NULL ()
ENDIF

IF (YDGFC%LPHY) THEN
  JFLD = YDTPTRSLB1%MSLB1GFLP9    + (YDGFC%MPSLP -1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1, :), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0, IBLKMIN], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  YDF3D%F_P_P => NULL ()
ENDIF


END SUBROUTINE CPG_SL1B_TYPE_INIT_F3D

END SUBROUTINE CPG_SL1B_TYPE_INIT

SUBROUTINE CPG_SL1B_TYPE_FINAL (SELF)
CLASS (CPG_SL1B_TYPE)          :: SELF

INTEGER (KIND=JPIM) :: JGFL


IF (ASSOCIATED (SELF%ZP9%F_P)) CALL FIELD_DELETE (SELF%ZP9%F_P)
SELF%ZP9%F_P => NULL ()
SELF%ZP9%P => NULL ()
IF (ASSOCIATED (SELF%Z0%F_P)) CALL FIELD_DELETE (SELF%Z0%F_P)
SELF%Z0%F_P => NULL ()
SELF%Z0%P => NULL ()
IF (ASSOCIATED (SELF%Z9%F_P)) CALL FIELD_DELETE (SELF%Z9%F_P)
SELF%Z9%F_P => NULL ()
SELF%Z9%P => NULL ()
IF (ASSOCIATED (SELF%ZR9%F_P)) CALL FIELD_DELETE (SELF%ZR9%F_P)
SELF%ZR9%F_P => NULL ()
SELF%ZR9%P => NULL ()
IF (ASSOCIATED (SELF%C9_NL%F_P)) CALL FIELD_DELETE (SELF%C9_NL%F_P)
SELF%C9_NL%F_P => NULL ()
SELF%C9_NL%P => NULL ()
IF (ASSOCIATED (SELF%VD9_NL%F_P)) CALL FIELD_DELETE (SELF%VD9_NL%F_P)
SELF%VD9_NL%F_P => NULL ()
SELF%VD9_NL%P => NULL ()
IF (ASSOCIATED (SELF%PD9_NL%F_P)) CALL FIELD_DELETE (SELF%PD9_NL%F_P)
SELF%PD9_NL%F_P => NULL ()
SELF%PD9_NL%P => NULL ()
IF (ASSOCIATED (SELF%T9_NL%F_P)) CALL FIELD_DELETE (SELF%T9_NL%F_P)
SELF%T9_NL%F_P => NULL ()
SELF%T9_NL%P => NULL ()
IF (ASSOCIATED (SELF%V9_NL%F_P)) CALL FIELD_DELETE (SELF%V9_NL%F_P)
SELF%V9_NL%F_P => NULL ()
SELF%V9_NL%P => NULL ()
IF (ASSOCIATED (SELF%U9_NL%F_P)) CALL FIELD_DELETE (SELF%U9_NL%F_P)
SELF%U9_NL%F_P => NULL ()
SELF%U9_NL%P => NULL ()
IF (ASSOCIATED (SELF%VDF9%F_P)) CALL FIELD_DELETE (SELF%VDF9%F_P)
SELF%VDF9%F_P => NULL ()
SELF%VDF9%P => NULL ()
IF (ASSOCIATED (SELF%TF9%F_P)) CALL FIELD_DELETE (SELF%TF9%F_P)
SELF%TF9%F_P => NULL ()
SELF%TF9%P => NULL ()
IF (ASSOCIATED (SELF%VF9%F_P)) CALL FIELD_DELETE (SELF%VF9%F_P)
SELF%VF9%F_P => NULL ()
SELF%VF9%P => NULL ()
IF (ASSOCIATED (SELF%UF9%F_P)) CALL FIELD_DELETE (SELF%UF9%F_P)
SELF%UF9%F_P => NULL ()
SELF%UF9%P => NULL ()
IF (ASSOCIATED (SELF%C9_SI%F_P)) CALL FIELD_DELETE (SELF%C9_SI%F_P)
SELF%C9_SI%F_P => NULL ()
SELF%C9_SI%P => NULL ()
IF (ASSOCIATED (SELF%VD9_SI%F_P)) CALL FIELD_DELETE (SELF%VD9_SI%F_P)
SELF%VD9_SI%F_P => NULL ()
SELF%VD9_SI%P => NULL ()
IF (ASSOCIATED (SELF%PD9_SI%F_P)) CALL FIELD_DELETE (SELF%PD9_SI%F_P)
SELF%PD9_SI%F_P => NULL ()
SELF%PD9_SI%P => NULL ()
IF (ASSOCIATED (SELF%T9_SI%F_P)) CALL FIELD_DELETE (SELF%T9_SI%F_P)
SELF%T9_SI%F_P => NULL ()
SELF%T9_SI%P => NULL ()
IF (ASSOCIATED (SELF%V9_SI%F_P)) CALL FIELD_DELETE (SELF%V9_SI%F_P)
SELF%V9_SI%F_P => NULL ()
SELF%V9_SI%P => NULL ()
IF (ASSOCIATED (SELF%U9_SI%F_P)) CALL FIELD_DELETE (SELF%U9_SI%F_P)
SELF%U9_SI%F_P => NULL ()
SELF%U9_SI%P => NULL ()
IF (ASSOCIATED (SELF%TP9%F_P)) CALL FIELD_DELETE (SELF%TP9%F_P)
SELF%TP9%F_P => NULL ()
SELF%TP9%P => NULL ()
IF (ASSOCIATED (SELF%VP9%F_P)) CALL FIELD_DELETE (SELF%VP9%F_P)
SELF%VP9%F_P => NULL ()
SELF%VP9%P => NULL ()
IF (ASSOCIATED (SELF%UP9%F_P)) CALL FIELD_DELETE (SELF%UP9%F_P)
SELF%UP9%F_P => NULL ()
SELF%UP9%P => NULL ()
IF (ASSOCIATED (SELF%C0%F_P)) CALL FIELD_DELETE (SELF%C0%F_P)
SELF%C0%F_P => NULL ()
SELF%C0%P => NULL ()
IF (ASSOCIATED (SELF%SP0%F_P)) CALL FIELD_DELETE (SELF%SP0%F_P)
SELF%SP0%F_P => NULL ()
SELF%SP0%P => NULL ()
IF (ASSOCIATED (SELF%SP9%F_P)) CALL FIELD_DELETE (SELF%SP9%F_P)
SELF%SP9%F_P => NULL ()
SELF%SP9%P => NULL ()
IF (ASSOCIATED (SELF%C9%F_P)) CALL FIELD_DELETE (SELF%C9%F_P)
SELF%C9%F_P => NULL ()
SELF%C9%P => NULL ()
IF (ASSOCIATED (SELF%VD0%F_P)) CALL FIELD_DELETE (SELF%VD0%F_P)
SELF%VD0%F_P => NULL ()
SELF%VD0%P => NULL ()
IF (ASSOCIATED (SELF%PD0%F_P)) CALL FIELD_DELETE (SELF%PD0%F_P)
SELF%PD0%F_P => NULL ()
SELF%PD0%P => NULL ()
IF (ASSOCIATED (SELF%T0%F_P)) CALL FIELD_DELETE (SELF%T0%F_P)
SELF%T0%F_P => NULL ()
SELF%T0%P => NULL ()
IF (ASSOCIATED (SELF%V0%F_P)) CALL FIELD_DELETE (SELF%V0%F_P)
SELF%V0%F_P => NULL ()
SELF%V0%P => NULL ()
IF (ASSOCIATED (SELF%U0%F_P)) CALL FIELD_DELETE (SELF%U0%F_P)
SELF%U0%F_P => NULL ()
SELF%U0%P => NULL ()
IF (ASSOCIATED (SELF%GWS9%F_P)) CALL FIELD_DELETE (SELF%GWS9%F_P)
SELF%GWS9%F_P => NULL ()
SELF%GWS9%P => NULL ()
IF (ASSOCIATED (SELF%DPHI9%F_P)) CALL FIELD_DELETE (SELF%DPHI9%F_P)
SELF%DPHI9%F_P => NULL ()
SELF%DPHI9%P => NULL ()
IF (ASSOCIATED (SELF%DBBC9%F_P)) CALL FIELD_DELETE (SELF%DBBC9%F_P)
SELF%DBBC9%F_P => NULL ()
SELF%DBBC9%P => NULL ()
IF (ASSOCIATED (SELF%VR9%F_P)) CALL FIELD_DELETE (SELF%VR9%F_P)
SELF%VR9%F_P => NULL ()
SELF%VR9%P => NULL ()
IF (ASSOCIATED (SELF%UR9%F_P)) CALL FIELD_DELETE (SELF%UR9%F_P)
SELF%UR9%F_P => NULL ()
SELF%UR9%P => NULL ()
IF (ASSOCIATED (SELF%WRA%F_P)) CALL FIELD_DELETE (SELF%WRA%F_P)
SELF%WRA%F_P => NULL ()
SELF%WRA%P => NULL ()
IF (ASSOCIATED (SELF%WR00%F_P)) CALL FIELD_DELETE (SELF%WR00%F_P)
SELF%WR00%F_P => NULL ()
SELF%WR00%P => NULL ()
IF (ASSOCIATED (SELF%ZR00%F_P)) CALL FIELD_DELETE (SELF%ZR00%F_P)
SELF%ZR00%F_P => NULL ()
SELF%ZR00%P => NULL ()
IF (ASSOCIATED (SELF%VR00%F_P)) CALL FIELD_DELETE (SELF%VR00%F_P)
SELF%VR00%F_P => NULL ()
SELF%VR00%P => NULL ()
IF (ASSOCIATED (SELF%UR00%F_P)) CALL FIELD_DELETE (SELF%UR00%F_P)
SELF%UR00%F_P => NULL ()
SELF%UR00%P => NULL ()
IF (ASSOCIATED (SELF%WR0%F_P)) CALL FIELD_DELETE (SELF%WR0%F_P)
SELF%WR0%F_P => NULL ()
SELF%WR0%P => NULL ()
IF (ASSOCIATED (SELF%ZR0%F_P)) CALL FIELD_DELETE (SELF%ZR0%F_P)
SELF%ZR0%F_P => NULL ()
SELF%ZR0%P => NULL ()
IF (ASSOCIATED (SELF%VR0%F_P)) CALL FIELD_DELETE (SELF%VR0%F_P)
SELF%VR0%F_P => NULL ()
SELF%VR0%P => NULL ()
IF (ASSOCIATED (SELF%UR0%F_P)) CALL FIELD_DELETE (SELF%UR0%F_P)
SELF%UR0%F_P => NULL ()
SELF%UR0%P => NULL ()
IF (ASSOCIATED (SELF%NHX9%F_P)) CALL FIELD_DELETE (SELF%NHX9%F_P)
SELF%NHX9%F_P => NULL ()
SELF%NHX9%P => NULL ()
IF (ASSOCIATED (SELF%VD9%F_P)) CALL FIELD_DELETE (SELF%VD9%F_P)
SELF%VD9%F_P => NULL ()
SELF%VD9%P => NULL ()
IF (ASSOCIATED (SELF%PD9%F_P)) CALL FIELD_DELETE (SELF%PD9%F_P)
SELF%PD9%F_P => NULL ()
SELF%PD9%P => NULL ()
IF (ASSOCIATED (SELF%T9%F_P)) CALL FIELD_DELETE (SELF%T9%F_P)
SELF%T9%F_P => NULL ()
SELF%T9%P => NULL ()
IF (ASSOCIATED (SELF%V9%F_P)) CALL FIELD_DELETE (SELF%V9%F_P)
SELF%V9%F_P => NULL ()
SELF%V9%P => NULL ()
IF (ASSOCIATED (SELF%U9%F_P)) CALL FIELD_DELETE (SELF%U9%F_P)
SELF%U9%F_P => NULL ()
SELF%U9%P => NULL ()

IF (ALLOCATED (SELF%EXT)) THEN
  DO JGFL = 1, SIZE (SELF%EXT)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%EXT(JGFL))
  ENDDO
  DEALLOCATE (SELF%EXT)
ENDIF
CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%FSD)

IF (ALLOCATED (SELF%LIMA)) THEN
  DO JGFL = 1, SIZE (SELF%LIMA)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%LIMA(JGFL))
  ENDDO
  DEALLOCATE (SELF%LIMA)
ENDIF
CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%UNEBH)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%UEN)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%DAL)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%DOM)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%UAL)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%UOM)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%RKTQC)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%RKTQV)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%RKTH)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%CVV)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%SDSAT)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%RSPEC)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%PHYCTY)

IF (ALLOCATED (SELF%UVP)) THEN
  DO JGFL = 1, SIZE (SELF%UVP)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%UVP(JGFL))
  ENDDO
  DEALLOCATE (SELF%UVP)
ENDIF
IF (ALLOCATED (SELF%AEROCLIM)) THEN
  DO JGFL = 1, SIZE (SELF%AEROCLIM)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%AEROCLIM(JGFL))
  ENDDO
  DEALLOCATE (SELF%AEROCLIM)
ENDIF
IF (ALLOCATED (SELF%AEROUT)) THEN
  DO JGFL = 1, SIZE (SELF%AEROUT)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%AEROUT(JGFL))
  ENDDO
  DEALLOCATE (SELF%AEROUT)
ENDIF
IF (ALLOCATED (SELF%AERLISI)) THEN
  DO JGFL = 1, SIZE (SELF%AERLISI)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%AERLISI(JGFL))
  ENDDO
  DEALLOCATE (SELF%AERLISI)
ENDIF
IF (ALLOCATED (SELF%AERAOT)) THEN
  DO JGFL = 1, SIZE (SELF%AERAOT)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%AERAOT(JGFL))
  ENDDO
  DEALLOCATE (SELF%AERAOT)
ENDIF
IF (ALLOCATED (SELF%SLDIA)) THEN
  DO JGFL = 1, SIZE (SELF%SLDIA)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%SLDIA(JGFL))
  ENDDO
  DEALLOCATE (SELF%SLDIA)
ENDIF
IF (ALLOCATED (SELF%EDRP)) THEN
  DO JGFL = 1, SIZE (SELF%EDRP)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%EDRP(JGFL))
  ENDDO
  DEALLOCATE (SELF%EDRP)
ENDIF
IF (ALLOCATED (SELF%EMIS3D)) THEN
  DO JGFL = 1, SIZE (SELF%EMIS3D)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%EMIS3D(JGFL))
  ENDDO
  DEALLOCATE (SELF%EMIS3D)
ENDIF
IF (ALLOCATED (SELF%NOGW)) THEN
  DO JGFL = 1, SIZE (SELF%NOGW)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%NOGW(JGFL))
  ENDDO
  DEALLOCATE (SELF%NOGW)
ENDIF
IF (ALLOCATED (SELF%ERA40)) THEN
  DO JGFL = 1, SIZE (SELF%ERA40)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%ERA40(JGFL))
  ENDDO
  DEALLOCATE (SELF%ERA40)
ENDIF
IF (ALLOCATED (SELF%EZDIAG)) THEN
  DO JGFL = 1, SIZE (SELF%EZDIAG)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%EZDIAG(JGFL))
  ENDDO
  DEALLOCATE (SELF%EZDIAG)
ENDIF
IF (ALLOCATED (SELF%FORC)) THEN
  DO JGFL = 1, SIZE (SELF%FORC)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%FORC(JGFL))
  ENDDO
  DEALLOCATE (SELF%FORC)
ENDIF
CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%LRCH4)

IF (ALLOCATED (SELF%AERO)) THEN
  DO JGFL = 1, SIZE (SELF%AERO)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%AERO(JGFL))
  ENDDO
  DEALLOCATE (SELF%AERO)
ENDIF
IF (ALLOCATED (SELF%CHEM)) THEN
  DO JGFL = 1, SIZE (SELF%CHEM)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%CHEM(JGFL))
  ENDDO
  DEALLOCATE (SELF%CHEM)
ENDIF
IF (ALLOCATED (SELF%GHG)) THEN
  DO JGFL = 1, SIZE (SELF%GHG)
    CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%GHG(JGFL))
  ENDDO
  DEALLOCATE (SELF%GHG)
ENDIF
CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%QVA)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%CVGQ)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%SPF)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%CPF)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%FSTUR)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%FQTUR)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%SHTUR)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%MXL)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%SRC)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%O3)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%AMF)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%A)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%EFB3)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%EFB2)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%EFB1)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%TTE)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%TKE)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%H)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%G)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%R)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%S)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%LRAD)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%IRAD)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%SCONV)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%RCONV)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%ICONV)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%LCONV)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%LMF)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%IMF)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%L)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%I)

CALL CPG_SL1B_TYPE_FINAL_F3D (SELF%Q)


IF (ALLOCATED (SELF%GFL)) DEALLOCATE (SELF%GFL)

IF (ASSOCIATED (SELF%F_DATA)) CALL FIELD_DELETE (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  IF (ASSOCIATED (SELF%ZDATA)) DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()

SELF%ZVIEW => NULL ()

CONTAINS

SUBROUTINE CPG_SL1B_TYPE_FINAL_F3D (YDF3D)

TYPE (CPG_SL1B_3D_TYPE), INTENT (INOUT) :: YDF3D

IF (ASSOCIATED (YDF3D%F_P)) CALL FIELD_DELETE (YDF3D%F_P)
YDF3D%F_P => NULL ()
YDF3D%P => NULL ()
IF (ASSOCIATED (YDF3D%F_P_F)) CALL FIELD_DELETE (YDF3D%F_P_F)
YDF3D%F_P_F => NULL ()
YDF3D%P_F => NULL ()
IF (ASSOCIATED (YDF3D%F_P_SPF)) CALL FIELD_DELETE (YDF3D%F_P_SPF)
YDF3D%F_P_SPF => NULL ()
YDF3D%P_SPF => NULL ()
IF (ASSOCIATED (YDF3D%F_P_SP)) CALL FIELD_DELETE (YDF3D%F_P_SP)
YDF3D%F_P_SP => NULL ()
YDF3D%P_SP => NULL ()
IF (ASSOCIATED (YDF3D%F_P_P)) CALL FIELD_DELETE (YDF3D%F_P_P)
YDF3D%F_P_P => NULL ()
YDF3D%P_P => NULL ()

END SUBROUTINE CPG_SL1B_TYPE_FINAL_F3D

END SUBROUTINE CPG_SL1B_TYPE_FINAL

SUBROUTINE CPG_SL1B_TYPE_SYNC_HOST (YDCPG_SL1B)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B

INTEGER (KIND=JPIM) :: JGFL

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SYNC_HOST', 0, ZHOOK_HANDLE)

CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%U9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%V9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%T9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%PD9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VD9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%NHX9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%UR0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VR0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%ZR0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%WR0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%UR00)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VR00)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%ZR00)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%WR00)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%WRA)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%UR9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VR9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%DBBC9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%DPHI9)
CALL CPG_SL1B_2D_TYPE_SYNC_HOST (YDCPG_SL1B%GWS9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%U0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%V0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%T0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%PD0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VD0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%C9)
CALL CPG_SL1B_2D_TYPE_SYNC_HOST (YDCPG_SL1B%SP9)
CALL CPG_SL1B_2D_TYPE_SYNC_HOST (YDCPG_SL1B%SP0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%C0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%UP9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VP9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%TP9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%U9_SI)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%V9_SI)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%T9_SI)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%PD9_SI)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VD9_SI)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%C9_SI)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%UF9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VF9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%TF9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VDF9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%U9_NL)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%V9_NL)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%T9_NL)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%PD9_NL)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%VD9_NL)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%C9_NL)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%ZR9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%Z9)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%Z0)
CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%ZP9)

DO JGFL = 1, SIZE (YDCPG_SL1B%GFL)
  CALL CPG_SL1B_3D_TYPE_SYNC_HOST (YDCPG_SL1B%GFL (JGFL))
ENDDO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SYNC_HOST', 1, ZHOOK_HANDLE)

CONTAINS

SUBROUTINE CPG_SL1B_2D_TYPE_SYNC_HOST (YDF2D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1B_2D_TYPE) :: YDF2D

REAL (KIND=JPRB), POINTER :: PTR (:,:)

IF (ASSOCIATED (YDF2D%F_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_F)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_F)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SPF)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_SPF)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SP)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_SP)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_P)
ENDIF

END SUBROUTINE

SUBROUTINE CPG_SL1B_3D_TYPE_SYNC_HOST (YDF3D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1B_3D_TYPE) :: YDF3D

REAL (KIND=JPRB), POINTER :: PTR (:,:,:)

IF (ASSOCIATED (YDF3D%F_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_F)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_F)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SPF)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_SPF)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SP)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_SP)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_P)
ENDIF

END SUBROUTINE

END SUBROUTINE CPG_SL1B_TYPE_SYNC_HOST

SUBROUTINE CPG_SL1B_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)
CLASS (CPG_SL1B_TYPE)     :: SELF
INTEGER(KIND=JPIM), INTENT (IN) :: BLOCK_INDEX

INTEGER (KIND=JPIM) :: JGFL

#include "abor1.intfb.h"

IF (ASSOCIATED (SELF%F_DATA)) THEN

  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)


  IF (ASSOCIATED (SELF%U9%F_P)) THEN
    IF ((.NOT. SELF%U9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U9%P))) THEN
      SELF%U9%P => SELF%U9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U9%P)) THEN
    SELF%U9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V9%F_P)) THEN
    IF ((.NOT. SELF%V9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V9%P))) THEN
      SELF%V9%P => SELF%V9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V9%P)) THEN
    SELF%V9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T9%F_P)) THEN
    IF ((.NOT. SELF%T9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T9%P))) THEN
      SELF%T9%P => SELF%T9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T9%P)) THEN
    SELF%T9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD9%F_P)) THEN
    IF ((.NOT. SELF%PD9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD9%P))) THEN
      SELF%PD9%P => SELF%PD9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD9%P)) THEN
    SELF%PD9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD9%F_P)) THEN
    IF ((.NOT. SELF%VD9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD9%P))) THEN
      SELF%VD9%P => SELF%VD9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD9%P)) THEN
    SELF%VD9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%NHX9%F_P)) THEN
    IF ((.NOT. SELF%NHX9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%NHX9%P))) THEN
      SELF%NHX9%P => SELF%NHX9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%NHX9%P)) THEN
    SELF%NHX9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UR0%F_P)) THEN
    IF ((.NOT. SELF%UR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UR0%P))) THEN
      SELF%UR0%P => SELF%UR0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UR0%P)) THEN
    SELF%UR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VR0%F_P)) THEN
    IF ((.NOT. SELF%VR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VR0%P))) THEN
      SELF%VR0%P => SELF%VR0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VR0%P)) THEN
    SELF%VR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZR0%F_P)) THEN
    IF ((.NOT. SELF%ZR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZR0%P))) THEN
      SELF%ZR0%P => SELF%ZR0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZR0%P)) THEN
    SELF%ZR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%WR0%F_P)) THEN
    IF ((.NOT. SELF%WR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WR0%P))) THEN
      SELF%WR0%P => SELF%WR0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WR0%P)) THEN
    SELF%WR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UR00%F_P)) THEN
    IF ((.NOT. SELF%UR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UR00%P))) THEN
      SELF%UR00%P => SELF%UR00%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UR00%P)) THEN
    SELF%UR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VR00%F_P)) THEN
    IF ((.NOT. SELF%VR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VR00%P))) THEN
      SELF%VR00%P => SELF%VR00%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VR00%P)) THEN
    SELF%VR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZR00%F_P)) THEN
    IF ((.NOT. SELF%ZR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZR00%P))) THEN
      SELF%ZR00%P => SELF%ZR00%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZR00%P)) THEN
    SELF%ZR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%WR00%F_P)) THEN
    IF ((.NOT. SELF%WR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WR00%P))) THEN
      SELF%WR00%P => SELF%WR00%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WR00%P)) THEN
    SELF%WR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%WRA%F_P)) THEN
    IF ((.NOT. SELF%WRA%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WRA%P))) THEN
      SELF%WRA%P => SELF%WRA%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WRA%P)) THEN
    SELF%WRA%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UR9%F_P)) THEN
    IF ((.NOT. SELF%UR9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UR9%P))) THEN
      SELF%UR9%P => SELF%UR9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UR9%P)) THEN
    SELF%UR9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VR9%F_P)) THEN
    IF ((.NOT. SELF%VR9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VR9%P))) THEN
      SELF%VR9%P => SELF%VR9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VR9%P)) THEN
    SELF%VR9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%DBBC9%F_P)) THEN
    IF ((.NOT. SELF%DBBC9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DBBC9%P))) THEN
      SELF%DBBC9%P => SELF%DBBC9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%DBBC9%P)) THEN
    SELF%DBBC9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%DPHI9%F_P)) THEN
    IF ((.NOT. SELF%DPHI9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DPHI9%P))) THEN
      SELF%DPHI9%P => SELF%DPHI9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%DPHI9%P)) THEN
    SELF%DPHI9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%GWS9%F_P)) THEN
    IF ((.NOT. SELF%GWS9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GWS9%P))) THEN
      SELF%GWS9%P => SELF%GWS9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%GWS9%P)) THEN
    SELF%GWS9%P => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%U0%F_P)) THEN
    IF ((.NOT. SELF%U0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U0%P))) THEN
      SELF%U0%P => SELF%U0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U0%P)) THEN
    SELF%U0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V0%F_P)) THEN
    IF ((.NOT. SELF%V0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V0%P))) THEN
      SELF%V0%P => SELF%V0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V0%P)) THEN
    SELF%V0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T0%F_P)) THEN
    IF ((.NOT. SELF%T0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T0%P))) THEN
      SELF%T0%P => SELF%T0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T0%P)) THEN
    SELF%T0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD0%F_P)) THEN
    IF ((.NOT. SELF%PD0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD0%P))) THEN
      SELF%PD0%P => SELF%PD0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD0%P)) THEN
    SELF%PD0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD0%F_P)) THEN
    IF ((.NOT. SELF%VD0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD0%P))) THEN
      SELF%VD0%P => SELF%VD0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD0%P)) THEN
    SELF%VD0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%C9%F_P)) THEN
    IF ((.NOT. SELF%C9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C9%P))) THEN
      SELF%C9%P => SELF%C9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C9%P)) THEN
    SELF%C9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%SP9%F_P)) THEN
    IF ((.NOT. SELF%SP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%SP9%P))) THEN
      SELF%SP9%P => SELF%SP9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%SP9%P)) THEN
    SELF%SP9%P => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%SP0%F_P)) THEN
    IF ((.NOT. SELF%SP0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%SP0%P))) THEN
      SELF%SP0%P => SELF%SP0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%SP0%P)) THEN
    SELF%SP0%P => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%C0%F_P)) THEN
    IF ((.NOT. SELF%C0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C0%P))) THEN
      SELF%C0%P => SELF%C0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C0%P)) THEN
    SELF%C0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UP9%F_P)) THEN
    IF ((.NOT. SELF%UP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UP9%P))) THEN
      SELF%UP9%P => SELF%UP9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UP9%P)) THEN
    SELF%UP9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VP9%F_P)) THEN
    IF ((.NOT. SELF%VP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VP9%P))) THEN
      SELF%VP9%P => SELF%VP9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VP9%P)) THEN
    SELF%VP9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%TP9%F_P)) THEN
    IF ((.NOT. SELF%TP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TP9%P))) THEN
      SELF%TP9%P => SELF%TP9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%TP9%P)) THEN
    SELF%TP9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%U9_SI%F_P)) THEN
    IF ((.NOT. SELF%U9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U9_SI%P))) THEN
      SELF%U9_SI%P => SELF%U9_SI%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U9_SI%P)) THEN
    SELF%U9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V9_SI%F_P)) THEN
    IF ((.NOT. SELF%V9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V9_SI%P))) THEN
      SELF%V9_SI%P => SELF%V9_SI%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V9_SI%P)) THEN
    SELF%V9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T9_SI%F_P)) THEN
    IF ((.NOT. SELF%T9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T9_SI%P))) THEN
      SELF%T9_SI%P => SELF%T9_SI%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T9_SI%P)) THEN
    SELF%T9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD9_SI%F_P)) THEN
    IF ((.NOT. SELF%PD9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD9_SI%P))) THEN
      SELF%PD9_SI%P => SELF%PD9_SI%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD9_SI%P)) THEN
    SELF%PD9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD9_SI%F_P)) THEN
    IF ((.NOT. SELF%VD9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD9_SI%P))) THEN
      SELF%VD9_SI%P => SELF%VD9_SI%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD9_SI%P)) THEN
    SELF%VD9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%C9_SI%F_P)) THEN
    IF ((.NOT. SELF%C9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C9_SI%P))) THEN
      SELF%C9_SI%P => SELF%C9_SI%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C9_SI%P)) THEN
    SELF%C9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UF9%F_P)) THEN
    IF ((.NOT. SELF%UF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UF9%P))) THEN
      SELF%UF9%P => SELF%UF9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UF9%P)) THEN
    SELF%UF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VF9%F_P)) THEN
    IF ((.NOT. SELF%VF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VF9%P))) THEN
      SELF%VF9%P => SELF%VF9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VF9%P)) THEN
    SELF%VF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%TF9%F_P)) THEN
    IF ((.NOT. SELF%TF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TF9%P))) THEN
      SELF%TF9%P => SELF%TF9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%TF9%P)) THEN
    SELF%TF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VDF9%F_P)) THEN
    IF ((.NOT. SELF%VDF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VDF9%P))) THEN
      SELF%VDF9%P => SELF%VDF9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VDF9%P)) THEN
    SELF%VDF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%U9_NL%F_P)) THEN
    IF ((.NOT. SELF%U9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U9_NL%P))) THEN
      SELF%U9_NL%P => SELF%U9_NL%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U9_NL%P)) THEN
    SELF%U9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V9_NL%F_P)) THEN
    IF ((.NOT. SELF%V9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V9_NL%P))) THEN
      SELF%V9_NL%P => SELF%V9_NL%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V9_NL%P)) THEN
    SELF%V9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T9_NL%F_P)) THEN
    IF ((.NOT. SELF%T9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T9_NL%P))) THEN
      SELF%T9_NL%P => SELF%T9_NL%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T9_NL%P)) THEN
    SELF%T9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD9_NL%F_P)) THEN
    IF ((.NOT. SELF%PD9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD9_NL%P))) THEN
      SELF%PD9_NL%P => SELF%PD9_NL%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD9_NL%P)) THEN
    SELF%PD9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD9_NL%F_P)) THEN
    IF ((.NOT. SELF%VD9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD9_NL%P))) THEN
      SELF%VD9_NL%P => SELF%VD9_NL%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD9_NL%P)) THEN
    SELF%VD9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%C9_NL%F_P)) THEN
    IF ((.NOT. SELF%C9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C9_NL%P))) THEN
      SELF%C9_NL%P => SELF%C9_NL%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C9_NL%P)) THEN
    SELF%C9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZR9%F_P)) THEN
    IF ((.NOT. SELF%ZR9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZR9%P))) THEN
      SELF%ZR9%P => SELF%ZR9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZR9%P)) THEN
    SELF%ZR9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%Z9%F_P)) THEN
    IF ((.NOT. SELF%Z9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%Z9%P))) THEN
      SELF%Z9%P => SELF%Z9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%Z9%P)) THEN
    SELF%Z9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%Z0%F_P)) THEN
    IF ((.NOT. SELF%Z0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%Z0%P))) THEN
      SELF%Z0%P => SELF%Z0%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%Z0%P)) THEN
    SELF%Z0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZP9%F_P)) THEN
    IF ((.NOT. SELF%ZP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZP9%P))) THEN
      SELF%ZP9%P => SELF%ZP9%F_P%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZP9%P)) THEN
    SELF%ZP9%P => ZDUM2
  ENDIF

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%Q)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%I)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%L)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%IMF)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%LMF)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%LCONV)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%ICONV)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%RCONV)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%SCONV)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%IRAD)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%LRAD)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%S)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%R)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%G)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%H)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%TKE)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%TTE)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%EFB1)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%EFB2)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%EFB3)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%A)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%AMF)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%O3)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%SRC)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%MXL)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%SHTUR)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%FQTUR)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%FSTUR)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%CPF)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%SPF)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%CVGQ)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%QVA)

  IF (ALLOCATED (SELF%GHG)) THEN
    DO JGFL = 1, SIZE (SELF%GHG)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%GHG(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%CHEM)) THEN
    DO JGFL = 1, SIZE (SELF%CHEM)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%CHEM(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AERO)) THEN
    DO JGFL = 1, SIZE (SELF%AERO)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%AERO(JGFL))
    ENDDO
  ENDIF

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%LRCH4)

  IF (ALLOCATED (SELF%FORC)) THEN
    DO JGFL = 1, SIZE (SELF%FORC)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%FORC(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%EZDIAG)) THEN
    DO JGFL = 1, SIZE (SELF%EZDIAG)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%EZDIAG(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%ERA40)) THEN
    DO JGFL = 1, SIZE (SELF%ERA40)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%ERA40(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%NOGW)) THEN
    DO JGFL = 1, SIZE (SELF%NOGW)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%NOGW(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%EMIS3D)) THEN
    DO JGFL = 1, SIZE (SELF%EMIS3D)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%EMIS3D(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%EDRP)) THEN
    DO JGFL = 1, SIZE (SELF%EDRP)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%EDRP(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%SLDIA)) THEN
    DO JGFL = 1, SIZE (SELF%SLDIA)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%SLDIA(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AERAOT)) THEN
    DO JGFL = 1, SIZE (SELF%AERAOT)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%AERAOT(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AERLISI)) THEN
    DO JGFL = 1, SIZE (SELF%AERLISI)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%AERLISI(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AEROUT)) THEN
    DO JGFL = 1, SIZE (SELF%AEROUT)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%AEROUT(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AEROCLIM)) THEN
    DO JGFL = 1, SIZE (SELF%AEROCLIM)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%AEROCLIM(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%UVP)) THEN
    DO JGFL = 1, SIZE (SELF%UVP)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%UVP(JGFL))
    ENDDO
  ENDIF

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%PHYCTY)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%RSPEC)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%SDSAT)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%CVV)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%RKTH)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%RKTQV)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%RKTQC)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%UOM)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%UAL)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%DOM)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%DAL)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%UEN)

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%UNEBH)

  IF (ALLOCATED (SELF%LIMA)) THEN
    DO JGFL = 1, SIZE (SELF%LIMA)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%LIMA(JGFL))
    ENDDO
  ENDIF

    CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%FSD)

  IF (ALLOCATED (SELF%EXT)) THEN
    DO JGFL = 1, SIZE (SELF%EXT)
      CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%EXT(JGFL))
    ENDDO
  ENDIF


ELSE

  SELF%ZVIEW => ZDUM2

  IF (.NOT. ASSOCIATED (SELF%U9%F_P)) SELF%U9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V9%F_P)) SELF%V9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T9%F_P)) SELF%T9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD9%F_P)) SELF%PD9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD9%F_P)) SELF%VD9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%NHX9%F_P)) SELF%NHX9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UR0%F_P)) SELF%UR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VR0%F_P)) SELF%VR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZR0%F_P)) SELF%ZR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WR0%F_P)) SELF%WR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UR00%F_P)) SELF%UR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VR00%F_P)) SELF%VR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZR00%F_P)) SELF%ZR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WR00%F_P)) SELF%WR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WRA%F_P)) SELF%WRA%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UR9%F_P)) SELF%UR9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VR9%F_P)) SELF%VR9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%DBBC9%F_P)) SELF%DBBC9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%DPHI9%F_P)) SELF%DPHI9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%GWS9%F_P)) SELF%GWS9%P => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%U0%F_P)) SELF%U0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V0%F_P)) SELF%V0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T0%F_P)) SELF%T0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD0%F_P)) SELF%PD0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD0%F_P)) SELF%VD0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%C9%F_P)) SELF%C9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%SP9%F_P)) SELF%SP9%P => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%SP0%F_P)) SELF%SP0%P => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%C0%F_P)) SELF%C0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UP9%F_P)) SELF%UP9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VP9%F_P)) SELF%VP9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%TP9%F_P)) SELF%TP9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%U9_SI%F_P)) SELF%U9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V9_SI%F_P)) SELF%V9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T9_SI%F_P)) SELF%T9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD9_SI%F_P)) SELF%PD9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD9_SI%F_P)) SELF%VD9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%C9_SI%F_P)) SELF%C9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UF9%F_P)) SELF%UF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VF9%F_P)) SELF%VF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%TF9%F_P)) SELF%TF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VDF9%F_P)) SELF%VDF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%U9_NL%F_P)) SELF%U9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V9_NL%F_P)) SELF%V9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T9_NL%F_P)) SELF%T9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD9_NL%F_P)) SELF%PD9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD9_NL%F_P)) SELF%VD9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%C9_NL%F_P)) SELF%C9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZR9%F_P)) SELF%ZR9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%Z9%F_P)) SELF%Z9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%Z0%F_P)) SELF%Z0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZP9%F_P)) SELF%ZP9%P => ZDUM2

  CALL NULLIFY_F3DB (SELF%Q)
  CALL NULLIFY_F3DB (SELF%I)
  CALL NULLIFY_F3DB (SELF%L)
  CALL NULLIFY_F3DB (SELF%IMF)
  CALL NULLIFY_F3DB (SELF%LMF)
  CALL NULLIFY_F3DB (SELF%LCONV)
  CALL NULLIFY_F3DB (SELF%ICONV)
  CALL NULLIFY_F3DB (SELF%RCONV)
  CALL NULLIFY_F3DB (SELF%SCONV)
  CALL NULLIFY_F3DB (SELF%IRAD)
  CALL NULLIFY_F3DB (SELF%LRAD)
  CALL NULLIFY_F3DB (SELF%S)
  CALL NULLIFY_F3DB (SELF%R)
  CALL NULLIFY_F3DB (SELF%G)
  CALL NULLIFY_F3DB (SELF%H)
  CALL NULLIFY_F3DB (SELF%TKE)
  CALL NULLIFY_F3DB (SELF%TTE)
  CALL NULLIFY_F3DB (SELF%EFB1)
  CALL NULLIFY_F3DB (SELF%EFB2)
  CALL NULLIFY_F3DB (SELF%EFB3)
  CALL NULLIFY_F3DB (SELF%A)
  CALL NULLIFY_F3DB (SELF%AMF)
  CALL NULLIFY_F3DB (SELF%O3)
  CALL NULLIFY_F3DB (SELF%SRC)
  CALL NULLIFY_F3DB (SELF%MXL)
  CALL NULLIFY_F3DB (SELF%SHTUR)
  CALL NULLIFY_F3DB (SELF%FQTUR)
  CALL NULLIFY_F3DB (SELF%FSTUR)
  CALL NULLIFY_F3DB (SELF%CPF)
  CALL NULLIFY_F3DB (SELF%SPF)
  CALL NULLIFY_F3DB (SELF%CVGQ)
  CALL NULLIFY_F3DB (SELF%QVA)
  IF (ALLOCATED (SELF%GHG)) THEN
    DO JGFL = 1, SIZE (SELF%GHG)
      CALL NULLIFY_F3DB (SELF%GHG(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%CHEM)) THEN
    DO JGFL = 1, SIZE (SELF%CHEM)
      CALL NULLIFY_F3DB (SELF%CHEM(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AERO)) THEN
    DO JGFL = 1, SIZE (SELF%AERO)
      CALL NULLIFY_F3DB (SELF%AERO(JGFL))
    ENDDO
  ENDIF
  CALL NULLIFY_F3DB (SELF%LRCH4)
  IF (ALLOCATED (SELF%FORC)) THEN
    DO JGFL = 1, SIZE (SELF%FORC)
      CALL NULLIFY_F3DB (SELF%FORC(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%EZDIAG)) THEN
    DO JGFL = 1, SIZE (SELF%EZDIAG)
      CALL NULLIFY_F3DB (SELF%EZDIAG(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%ERA40)) THEN
    DO JGFL = 1, SIZE (SELF%ERA40)
      CALL NULLIFY_F3DB (SELF%ERA40(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%NOGW)) THEN
    DO JGFL = 1, SIZE (SELF%NOGW)
      CALL NULLIFY_F3DB (SELF%NOGW(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%EMIS3D)) THEN
    DO JGFL = 1, SIZE (SELF%EMIS3D)
      CALL NULLIFY_F3DB (SELF%EMIS3D(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%EDRP)) THEN
    DO JGFL = 1, SIZE (SELF%EDRP)
      CALL NULLIFY_F3DB (SELF%EDRP(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%SLDIA)) THEN
    DO JGFL = 1, SIZE (SELF%SLDIA)
      CALL NULLIFY_F3DB (SELF%SLDIA(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AERAOT)) THEN
    DO JGFL = 1, SIZE (SELF%AERAOT)
      CALL NULLIFY_F3DB (SELF%AERAOT(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AERLISI)) THEN
    DO JGFL = 1, SIZE (SELF%AERLISI)
      CALL NULLIFY_F3DB (SELF%AERLISI(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AEROUT)) THEN
    DO JGFL = 1, SIZE (SELF%AEROUT)
      CALL NULLIFY_F3DB (SELF%AEROUT(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AEROCLIM)) THEN
    DO JGFL = 1, SIZE (SELF%AEROCLIM)
      CALL NULLIFY_F3DB (SELF%AEROCLIM(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%UVP)) THEN
    DO JGFL = 1, SIZE (SELF%UVP)
      CALL NULLIFY_F3DB (SELF%UVP(JGFL))
    ENDDO
  ENDIF
  CALL NULLIFY_F3DB (SELF%PHYCTY)
  CALL NULLIFY_F3DB (SELF%RSPEC)
  CALL NULLIFY_F3DB (SELF%SDSAT)
  CALL NULLIFY_F3DB (SELF%CVV)
  CALL NULLIFY_F3DB (SELF%RKTH)
  CALL NULLIFY_F3DB (SELF%RKTQV)
  CALL NULLIFY_F3DB (SELF%RKTQC)
  CALL NULLIFY_F3DB (SELF%UOM)
  CALL NULLIFY_F3DB (SELF%UAL)
  CALL NULLIFY_F3DB (SELF%DOM)
  CALL NULLIFY_F3DB (SELF%DAL)
  CALL NULLIFY_F3DB (SELF%UEN)
  CALL NULLIFY_F3DB (SELF%UNEBH)
  IF (ALLOCATED (SELF%LIMA)) THEN
    DO JGFL = 1, SIZE (SELF%LIMA)
      CALL NULLIFY_F3DB (SELF%LIMA(JGFL))
    ENDDO
  ENDIF
  CALL NULLIFY_F3DB (SELF%FSD)
  IF (ALLOCATED (SELF%EXT)) THEN
    DO JGFL = 1, SIZE (SELF%EXT)
      CALL NULLIFY_F3DB (SELF%EXT(JGFL))
    ENDDO
  ENDIF

ENDIF

DO JGFL = 1, SIZE (SELF%GFL)
  CALL CPG_SL1B_TYPE_UPDATE_VIEW_F3D (SELF%GFL(JGFL))
ENDDO

CONTAINS

SUBROUTINE NULLIFY_F3DB (YDF3D)

TYPE (CPG_SL1B_3D_TYPE), INTENT (INOUT) :: YDF3D

IF (.NOT. ASSOCIATED (YDF3D%F_P)) YDF3D%P => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_F)) YDF3D%P_F => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_SPF)) YDF3D%P_SPF => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_SP)) YDF3D%P_SP => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_P)) YDF3D%P_P => ZDUM2

END SUBROUTINE NULLIFY_F3DB

SUBROUTINE CPG_SL1B_TYPE_UPDATE_VIEW_F3D (YDF3D)

TYPE (CPG_SL1B_3D_TYPE), INTENT (INOUT) :: YDF3D

IF (ASSOCIATED (YDF3D%F_P)) THEN
  IF ((.NOT. YDF3D%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P))) THEN
    YDF3D%P => YDF3D%F_P%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P)) THEN
  YDF3D%P => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_F)) THEN
  IF ((.NOT. YDF3D%F_P_F%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_F))) THEN
    YDF3D%P_F => YDF3D%F_P_F%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_F)) THEN
  YDF3D%P_F => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_SPF)) THEN
  IF ((.NOT. YDF3D%F_P_SPF%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_SPF))) THEN
    YDF3D%P_SPF => YDF3D%F_P_SPF%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_SPF)) THEN
  YDF3D%P_SPF => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_SP)) THEN
  IF ((.NOT. YDF3D%F_P_SP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_SP))) THEN
    YDF3D%P_SP => YDF3D%F_P_SP%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_SP)) THEN
  YDF3D%P_SP => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_P)) THEN
  IF ((.NOT. YDF3D%F_P_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_P))) THEN
    YDF3D%P_P => YDF3D%F_P_P%GET_VIEW (BLOCK_INDEX)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_P)) THEN
  YDF3D%P_P => ZDUM2
ENDIF


END SUBROUTINE CPG_SL1B_TYPE_UPDATE_VIEW_F3D

END SUBROUTINE CPG_SL1B_TYPE_UPDATE_VIEW


SUBROUTINE GREPVARSF (YDCPG_SL1F, YDMODEL, COND, YDVARS_LIST)
USE TYPE_MODEL, ONLY : MODEL
TYPE(CPG_SL1F_TYPE), INTENT(INOUT) :: YDCPG_SL1F
TYPE(MODEL), INTENT(IN) :: YDMODEL
PROCEDURE (FUN_GREP) :: COND
TYPE (CPG_SL1F_3D_TYPE), ALLOCATABLE :: YDVARS_LIST (:)

INTEGER (KIND=JPIM) :: ISIZE, JFLD, IPNTR

ISIZE = 0

IF (COND (YDMODEL%YRML_GCONF%YGFL%YQ, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YI, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIMF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLMF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLCONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YICONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRCONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSCONV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIRAD, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRAD, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YS, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YG, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YH, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTKE, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTTE, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB1, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB2, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB3, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YA, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YAMF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YO3, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSRC, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YMXL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSHTUR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFQTUR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSTUR, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCPF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSPF, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVGQ, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YQVA, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1F%GHG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%GHG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YGHG(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%CHEM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%CHEM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YCHEM(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AERO)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AERO)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERO(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRCH4, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1F%FORC)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%FORC)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YFORC(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%EZDIAG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EZDIAG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEZDIAG(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%ERA40)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%ERA40)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YERA40(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%NOGW)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%NOGW)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YNOGW(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%EMIS3D)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EMIS3D)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEMIS3D(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%EDRP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EDRP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEDRP(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%SLDIA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%SLDIA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YSLDIA(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AERAOT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AERAOT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERAOT(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AERLISI)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AERLISI)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERLISI(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AEROUT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AEROUT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROUT(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AEROCLIM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AEROCLIM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROCLIM(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%UVP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%UVP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YUVP(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YPHYCTY, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRSPEC, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSDSAT, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTH, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQV, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQC, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUOM, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUAL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDOM, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDAL, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUEN, YDMODEL)) ISIZE = ISIZE + 1
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUNEBH, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1F%LIMA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%LIMA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YLIMA(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSD, YDMODEL)) ISIZE = ISIZE + 1
IF (ALLOCATED (YDCPG_SL1F%EXT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EXT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEXT(JFLD), YDMODEL)) ISIZE = ISIZE + 1
  ENDDO
ENDIF

ALLOCATE (YDVARS_LIST (ISIZE))

IPNTR = 1

IF (COND (YDMODEL%YRML_GCONF%YGFL%YQ, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%Q
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YI, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%I
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%L
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIMF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%IMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLMF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%LMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLCONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%LCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YICONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%ICONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRCONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%RCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSCONV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%SCONV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YIRAD, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%IRAD
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRAD, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%LRAD
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YS, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%S
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%R
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YG, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%G
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YH, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%H
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTKE, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%TKE
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YTTE, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%TTE
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB1, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%EFB1
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB2, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%EFB2
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YEFB3, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%EFB3
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YA, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%A
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YAMF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%AMF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YO3, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%O3
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSRC, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%SRC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YMXL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%MXL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSHTUR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%SHTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFQTUR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%FQTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSTUR, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%FSTUR
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCPF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%CPF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSPF, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%SPF
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVGQ, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%CVGQ
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YQVA, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%QVA
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1F%GHG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%GHG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YGHG(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%GHG(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%CHEM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%CHEM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YCHEM(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%CHEM(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AERO)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AERO)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERO(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%AERO(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YLRCH4, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%LRCH4
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1F%FORC)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%FORC)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YFORC(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%FORC(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%EZDIAG)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EZDIAG)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEZDIAG(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%EZDIAG(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%ERA40)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%ERA40)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YERA40(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%ERA40(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%NOGW)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%NOGW)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YNOGW(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%NOGW(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%EMIS3D)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EMIS3D)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEMIS3D(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%EMIS3D(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%EDRP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EDRP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEDRP(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%EDRP(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%SLDIA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%SLDIA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YSLDIA(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%SLDIA(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AERAOT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AERAOT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERAOT(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%AERAOT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AERLISI)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AERLISI)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAERLISI(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%AERLISI(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AEROUT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AEROUT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROUT(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%AEROUT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%AEROCLIM)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%AEROCLIM)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YAEROCLIM(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%AEROCLIM(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (ALLOCATED (YDCPG_SL1F%UVP)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%UVP)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YUVP(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%UVP(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YPHYCTY, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%PHYCTY
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRSPEC, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%RSPEC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YSDSAT, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%SDSAT
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YCVV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%CVV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTH, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%RKTH
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQV, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%RKTQV
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YRKTQC, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%RKTQC
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUOM, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%UOM
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUAL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%UAL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDOM, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%DOM
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YDAL, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%DAL
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUEN, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%UEN
  IPNTR = IPNTR + 1
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YUNEBH, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%UNEBH
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1F%LIMA)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%LIMA)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YLIMA(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%LIMA(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
IF (COND (YDMODEL%YRML_GCONF%YGFL%YFSD, YDMODEL)) THEN
  YDVARS_LIST (IPNTR) = YDCPG_SL1F%FSD
  IPNTR = IPNTR + 1
ENDIF
IF (ALLOCATED (YDCPG_SL1F%EXT)) THEN
  DO JFLD = 1, SIZE (YDCPG_SL1F%EXT)
    IF (COND (YDMODEL%YRML_GCONF%YGFL%YEXT(JFLD), YDMODEL)) THEN
      YDVARS_LIST (IPNTR) = YDCPG_SL1F%EXT(JFLD)
      IPNTR = IPNTR + 1
    ENDIF
  ENDDO
ENDIF
    
END SUBROUTINE

SUBROUTINE CPG_SL1F_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB1 &
                                 & , YDMODEL &
                                 & , YGFL &
                                 & , YDSL &
                                 & , PB1 &
                                 & )

USE PTRSLB1, ONLY : TPTRSLB1
USE OML_MOD, ONLY: OML_MAX_THREADS

USE YOM_YGFL  , ONLY : TYPE_GFLD
USE TYPE_MODEL, ONLY : MODEL
USE EINT_MOD  , ONLY : SL_STRUCT

USE FIELD_DEFAULTS_MODULE

CLASS (CPG_SL1F_TYPE),TARGET                 :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),                    INTENT (IN)    :: YDTPTRSLB1
TYPE (TYPE_GFLD),                   INTENT (IN)    :: YGFL
TYPE (MODEL),               TARGET, INTENT (IN)    :: YDMODEL
TYPE(SL_STRUCT),  OPTIONAL, TARGET, INTENT (IN)    :: YDSL
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB1 (:,:)

INTEGER (KIND=JPIM) :: JFLD
INTEGER (KIND=JPIM) :: JGFL
INTEGER (KIND=JPIM) :: ISIZE, IPNTR
INTEGER (KIND=JPIM) :: ISIZE_1, IPNTR_1
INTEGER (KIND=JPIM) :: ISIZE_2, IPNTR_2

LOGICAL :: LLPERSISTENT
LOGICAL :: LLINITIALIZED


TYPE(SL_STRUCT),  POINTER :: YLSL
TYPE(TYPE_GFL_COMP), POINTER :: YDGFC


INTEGER (KIND=JPIM) :: IPTRSL (8)
INTEGER (KIND=JPIM) :: I2FSL, I2FSLA, I2FSLB
INTEGER (KIND=JPIM) :: I3FSL, I3FSLA, I3FSLB

IPTRSL = -1
IPTRSL (1:4) = [YDTPTRSLB1%MSLB1UR0, YDTPTRSLB1%MSLB1VR0, YDTPTRSLB1%MSLB1ZR0, YDTPTRSLB1%MSLB1WR0]
IF (YDMODEL%YRML_DYN%YRDYN%LSLDP_RK) THEN
  IPTRSL (5:8) = [YDTPTRSLB1%MSLB1UR00, YDTPTRSLB1%MSLB1VR00, YDTPTRSLB1%MSLB1ZR00, YDTPTRSLB1%MSLB1WR00]
ENDIF

!WRITE (0, *) " IPTRSL = ", IPTRSL


SELF%NLEV = NLEV

LLINITIALIZED = .FALSE.


LLPERSISTENT = .TRUE.

YLSL => YDMODEL%YRML_DYN%YRSL
IF (PRESENT (YDSL)) YLSL => YDSL

IF (PRESENT (PB1)) THEN
  SELF%ZDATA => PB1
  SELF%LOWNED  = .FALSE.
ELSE
  ALLOCATE (SELF%ZDATA (YLSL%NASLB1, YDTPTRSLB1%NFLDSLB1))
  IF (USE_INIT_DEBUG_VALUE) THEN
    SELF%ZDATA = INIT_DEBUG_VALUE_JPRB
    LLINITIALIZED = .TRUE.
  ENDIF
  SELF%LOWNED  = .TRUE.
ENDIF


CALL FIELD_NEW (SELF%F_DATA, DATA=SELF%ZDATA, PERSISTENT=LLPERSISTENT, LBOUNDS=LBOUND (SELF%ZDATA), &
              & INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)



I2FSL = 0
I3FSL = 0 
I2FSLA = 0
I3FSLA = 0

IF (YDTPTRSLB1%MSLB1U9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9

  CALL FIELD_NEW (SELF%U9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "U9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%U9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9

  CALL FIELD_NEW (SELF%V9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "V9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%V9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9

  CALL FIELD_NEW (SELF%T9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "T9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%T9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9

  CALL FIELD_NEW (SELF%PD9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "PD9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%PD9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9

  CALL FIELD_NEW (SELF%VD9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VD9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VD9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1NHX9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1NHX9

  CALL FIELD_NEW (SELF%NHX9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "NHX9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%NHX9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR0

  CALL FIELD_NEW (SELF%UR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "UR0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%UR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR0

  CALL FIELD_NEW (SELF%VR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VR0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR0

  CALL FIELD_NEW (SELF%ZR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "ZR0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%ZR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR0

  CALL FIELD_NEW (SELF%WR0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "WR0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%WR0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR00

  CALL FIELD_NEW (SELF%UR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "UR00", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%UR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR00

  CALL FIELD_NEW (SELF%VR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VR00", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR00

  CALL FIELD_NEW (SELF%ZR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "ZR00", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%ZR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR00

  CALL FIELD_NEW (SELF%WR00%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "WR00", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%WR00%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1WRA > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WRA

  CALL FIELD_NEW (SELF%WRA%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "WRA", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%WRA%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR9

  CALL FIELD_NEW (SELF%UR9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "UR9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%UR9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR9

  CALL FIELD_NEW (SELF%VR9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VR9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VR9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1DBBC9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DBBC9

  CALL FIELD_NEW (SELF%DBBC9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "DBBC9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%DBBC9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1DPHI9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DPHI9

  CALL FIELD_NEW (SELF%DPHI9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "DPHI9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%DPHI9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1GWS9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GWS9

  CALL FIELD_NEW (SELF%GWS9%F_P, DATA=SELF%ZDATA (:, JFLD),                         PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1               ], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I2FSL = I2FSL + 1
  ELSE
    I2FSLA = I2FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "GWS9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%GWS9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U0

  CALL FIELD_NEW (SELF%U0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "U0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%U0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V0

  CALL FIELD_NEW (SELF%V0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "V0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%V0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T0

  CALL FIELD_NEW (SELF%T0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "T0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%T0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD0

  CALL FIELD_NEW (SELF%PD0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "PD0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%PD0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD0

  CALL FIELD_NEW (SELF%VD0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VD0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VD0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9

  CALL FIELD_NEW (SELF%C9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "C9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%C9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1SP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP9

  CALL FIELD_NEW (SELF%SP9%F_P, DATA=SELF%ZDATA (:, JFLD),                         PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1               ], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I2FSL = I2FSL + 1
  ELSE
    I2FSLA = I2FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "SP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%SP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1SP0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP0

  CALL FIELD_NEW (SELF%SP0%F_P, DATA=SELF%ZDATA (:, JFLD),                         PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1               ], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I2FSL = I2FSL + 1
  ELSE
    I2FSLA = I2FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "SP0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%SP0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C0

  CALL FIELD_NEW (SELF%C0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "C0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%C0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UP9

  CALL FIELD_NEW (SELF%UP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "UP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%UP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VP9

  CALL FIELD_NEW (SELF%VP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1TP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TP9

  CALL FIELD_NEW (SELF%TP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "TP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%TP9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_SI

  CALL FIELD_NEW (SELF%U9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "U9_SI", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%U9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_SI

  CALL FIELD_NEW (SELF%V9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "V9_SI", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%V9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_SI

  CALL FIELD_NEW (SELF%T9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "T9_SI", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%T9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_SI

  CALL FIELD_NEW (SELF%PD9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "PD9_SI", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%PD9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_SI

  CALL FIELD_NEW (SELF%VD9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VD9_SI", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VD9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_SI

  CALL FIELD_NEW (SELF%C9_SI%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "C9_SI", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%C9_SI%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1UF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UF9

  CALL FIELD_NEW (SELF%UF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "UF9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%UF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VF9

  CALL FIELD_NEW (SELF%VF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VF9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1TF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TF9

  CALL FIELD_NEW (SELF%TF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "TF9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%TF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VDF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VDF9

  CALL FIELD_NEW (SELF%VDF9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VDF9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VDF9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1U9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_NL

  CALL FIELD_NEW (SELF%U9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "U9_NL", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%U9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1V9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_NL

  CALL FIELD_NEW (SELF%V9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "V9_NL", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%V9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1T9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_NL

  CALL FIELD_NEW (SELF%T9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "T9_NL", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%T9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1PD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_NL

  CALL FIELD_NEW (SELF%PD9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "PD9_NL", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%PD9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1VD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_NL

  CALL FIELD_NEW (SELF%VD9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "VD9_NL", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%VD9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1C9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_NL

  CALL FIELD_NEW (SELF%C9_NL%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "C9_NL", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%C9_NL%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR9

  CALL FIELD_NEW (SELF%ZR9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "ZR9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%ZR9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1Z9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1Z9

  CALL FIELD_NEW (SELF%Z9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "Z9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%Z9%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1Z0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1Z0

  CALL FIELD_NEW (SELF%Z0%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "Z0", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%Z0%F_P => NULL ()
ENDIF
IF (YDTPTRSLB1%MSLB1ZP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZP9

  CALL FIELD_NEW (SELF%ZP9%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  IF (ANY (IPTRSL == JFLD)) THEN
    I3FSL = I3FSL + 1
  ELSE
    I3FSLA = I3FSLA + 1
  ENDIF

! WRITE (0, *) " JFLD = ", JFLD, "ZP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA

ELSE
  SELF%ZP9%F_P => NULL ()
ENDIF

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%Q, YGFL%YQ)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%I, YGFL%YI)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%L, YGFL%YL)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%IMF, YGFL%YIMF)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%LMF, YGFL%YLMF)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%LCONV, YGFL%YLCONV)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%ICONV, YGFL%YICONV)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%RCONV, YGFL%YRCONV)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%SCONV, YGFL%YSCONV)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%IRAD, YGFL%YIRAD)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%LRAD, YGFL%YLRAD)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%S, YGFL%YS)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%R, YGFL%YR)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%G, YGFL%YG)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%H, YGFL%YH)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%TKE, YGFL%YTKE)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%TTE, YGFL%YTTE)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%EFB1, YGFL%YEFB1)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%EFB2, YGFL%YEFB2)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%EFB3, YGFL%YEFB3)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%A, YGFL%YA)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%AMF, YGFL%YAMF)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%O3, YGFL%YO3)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%SRC, YGFL%YSRC)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%MXL, YGFL%YMXL)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%SHTUR, YGFL%YSHTUR)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%FQTUR, YGFL%YFQTUR)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%FSTUR, YGFL%YFSTUR)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%CPF, YGFL%YCPF)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%SPF, YGFL%YSPF)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%CVGQ, YGFL%YCVGQ)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%QVA, YGFL%YQVA)



IF (ASSOCIATED (YGFL%YGHG)) THEN
  ALLOCATE (SELF%GHG (SIZE (YGFL%YGHG)))

  DO JGFL = 1, SIZE (YGFL%YGHG)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%GHG(JGFL), YGFL%YGHG(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YCHEM)) THEN
  ALLOCATE (SELF%CHEM (SIZE (YGFL%YCHEM)))

  DO JGFL = 1, SIZE (YGFL%YCHEM)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%CHEM(JGFL), YGFL%YCHEM(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAERO)) THEN
  ALLOCATE (SELF%AERO (SIZE (YGFL%YAERO)))

  DO JGFL = 1, SIZE (YGFL%YAERO)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%AERO(JGFL), YGFL%YAERO(JGFL))
  ENDDO
ENDIF

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%LRCH4, YGFL%YLRCH4)



IF (ASSOCIATED (YGFL%YFORC)) THEN
  ALLOCATE (SELF%FORC (SIZE (YGFL%YFORC)))

  DO JGFL = 1, SIZE (YGFL%YFORC)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%FORC(JGFL), YGFL%YFORC(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YEZDIAG)) THEN
  ALLOCATE (SELF%EZDIAG (SIZE (YGFL%YEZDIAG)))

  DO JGFL = 1, SIZE (YGFL%YEZDIAG)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%EZDIAG(JGFL), YGFL%YEZDIAG(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YERA40)) THEN
  ALLOCATE (SELF%ERA40 (SIZE (YGFL%YERA40)))

  DO JGFL = 1, SIZE (YGFL%YERA40)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%ERA40(JGFL), YGFL%YERA40(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YNOGW)) THEN
  ALLOCATE (SELF%NOGW (SIZE (YGFL%YNOGW)))

  DO JGFL = 1, SIZE (YGFL%YNOGW)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%NOGW(JGFL), YGFL%YNOGW(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YEMIS3D)) THEN
  ALLOCATE (SELF%EMIS3D (SIZE (YGFL%YEMIS3D)))

  DO JGFL = 1, SIZE (YGFL%YEMIS3D)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%EMIS3D(JGFL), YGFL%YEMIS3D(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YEDRP)) THEN
  ALLOCATE (SELF%EDRP (SIZE (YGFL%YEDRP)))

  DO JGFL = 1, SIZE (YGFL%YEDRP)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%EDRP(JGFL), YGFL%YEDRP(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YSLDIA)) THEN
  ALLOCATE (SELF%SLDIA (SIZE (YGFL%YSLDIA)))

  DO JGFL = 1, SIZE (YGFL%YSLDIA)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%SLDIA(JGFL), YGFL%YSLDIA(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAERAOT)) THEN
  ALLOCATE (SELF%AERAOT (SIZE (YGFL%YAERAOT)))

  DO JGFL = 1, SIZE (YGFL%YAERAOT)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%AERAOT(JGFL), YGFL%YAERAOT(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAERLISI)) THEN
  ALLOCATE (SELF%AERLISI (SIZE (YGFL%YAERLISI)))

  DO JGFL = 1, SIZE (YGFL%YAERLISI)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%AERLISI(JGFL), YGFL%YAERLISI(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAEROUT)) THEN
  ALLOCATE (SELF%AEROUT (SIZE (YGFL%YAEROUT)))

  DO JGFL = 1, SIZE (YGFL%YAEROUT)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%AEROUT(JGFL), YGFL%YAEROUT(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YAEROCLIM)) THEN
  ALLOCATE (SELF%AEROCLIM (SIZE (YGFL%YAEROCLIM)))

  DO JGFL = 1, SIZE (YGFL%YAEROCLIM)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%AEROCLIM(JGFL), YGFL%YAEROCLIM(JGFL))
  ENDDO
ENDIF



IF (ASSOCIATED (YGFL%YUVP)) THEN
  ALLOCATE (SELF%UVP (SIZE (YGFL%YUVP)))

  DO JGFL = 1, SIZE (YGFL%YUVP)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%UVP(JGFL), YGFL%YUVP(JGFL))
  ENDDO
ENDIF

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%PHYCTY, YGFL%YPHYCTY)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%RSPEC, YGFL%YRSPEC)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%SDSAT, YGFL%YSDSAT)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%CVV, YGFL%YCVV)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%RKTH, YGFL%YRKTH)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%RKTQV, YGFL%YRKTQV)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%RKTQC, YGFL%YRKTQC)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%UOM, YGFL%YUOM)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%UAL, YGFL%YUAL)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%DOM, YGFL%YDOM)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%DAL, YGFL%YDAL)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%UEN, YGFL%YUEN)

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%UNEBH, YGFL%YUNEBH)



IF (ASSOCIATED (YGFL%YLIMA)) THEN
  ALLOCATE (SELF%LIMA (SIZE (YGFL%YLIMA)))

  DO JGFL = 1, SIZE (YGFL%YLIMA)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%LIMA(JGFL), YGFL%YLIMA(JGFL))
  ENDDO
ENDIF

CALL CPG_SL1F_TYPE_INIT_F3D (SELF%FSD, YGFL%YFSD)



IF (ASSOCIATED (YGFL%YEXT)) THEN
  ALLOCATE (SELF%EXT (SIZE (YGFL%YEXT)))

  DO JGFL = 1, SIZE (YGFL%YEXT)
    CALL CPG_SL1F_TYPE_INIT_F3D (SELF%EXT(JGFL), YGFL%YEXT(JGFL))
  ENDDO
ENDIF



I2FSLB = I2FSL + I2FSLA
I3FSLB = I3FSL + I3FSLA

ALLOCATE (SELF%Y2FSL  (I2FSL )); I2FSL  = 0
ALLOCATE (SELF%Y3FSL  (I3FSL )); I3FSL  = 0

ALLOCATE (SELF%Y2FSLA (I2FSLA)); I2FSLA = 0
ALLOCATE (SELF%Y3FSLA (I3FSLA)); I3FSLA = 0

ALLOCATE (SELF%Y2FSLB (I2FSLB)); I2FSLB = 0
ALLOCATE (SELF%Y3FSLB (I3FSLB)); I3FSLB = 0



!WRITE (0, *) " SIZE (SELF%Y2FSL ) = ", SIZE (SELF%Y2FSL )
!WRITE (0, *) " SIZE (SELF%Y3FSL ) = ", SIZE (SELF%Y3FSL )
!WRITE (0, *) " SIZE (SELF%Y2FSLA) = ", SIZE (SELF%Y2FSLA)
!WRITE (0, *) " SIZE (SELF%Y3FSLA) = ", SIZE (SELF%Y3FSLA)

!WRITE (0, '(A10," ",3A6," ",A16," ",A)') "NAME", "RANK", "JFLD1", "JFLD2", "ADDR", "KIND"

IF (YDTPTRSLB1%MSLB1U9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%U9%F_P, "U9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%U9%F_P, "U9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%U9%F_P, "U9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1V9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%V9%F_P, "V9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%V9%F_P, "V9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%V9%F_P, "V9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1T9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%T9%F_P, "T9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%T9%F_P, "T9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%T9%F_P, "T9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1PD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%PD9%F_P, "PD9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%PD9%F_P, "PD9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%PD9%F_P, "PD9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VD9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VD9%F_P, "VD9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VD9%F_P, "VD9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VD9%F_P, "VD9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1NHX9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1NHX9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%NHX9%F_P, "NHX9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%NHX9%F_P, "NHX9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%NHX9%F_P, "NHX9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1UR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%UR0%F_P, "UR0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%UR0%F_P, "UR0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%UR0%F_P, "UR0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VR0%F_P, "VR0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VR0%F_P, "VR0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VR0%F_P, "VR0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1ZR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%ZR0%F_P, "ZR0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%ZR0%F_P, "ZR0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%ZR0%F_P, "ZR0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1WR0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%WR0%F_P, "WR0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%WR0%F_P, "WR0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%WR0%F_P, "WR0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1UR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR00
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%UR00%F_P, "UR00", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%UR00%F_P, "UR00", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%UR00%F_P, "UR00", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR00
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VR00%F_P, "VR00", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VR00%F_P, "VR00", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VR00%F_P, "VR00", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1ZR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR00
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%ZR00%F_P, "ZR00", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%ZR00%F_P, "ZR00", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%ZR00%F_P, "ZR00", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1WR00 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WR00
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%WR00%F_P, "WR00", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%WR00%F_P, "WR00", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%WR00%F_P, "WR00", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1WRA > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1WRA
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%WRA%F_P, "WRA", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%WRA%F_P, "WRA", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%WRA%F_P, "WRA", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1UR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UR9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%UR9%F_P, "UR9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%UR9%F_P, "UR9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%UR9%F_P, "UR9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VR9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VR9%F_P, "VR9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VR9%F_P, "VR9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VR9%F_P, "VR9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1DBBC9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DBBC9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%DBBC9%F_P, "DBBC9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%DBBC9%F_P, "DBBC9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%DBBC9%F_P, "DBBC9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1DPHI9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1DPHI9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%DPHI9%F_P, "DPHI9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%DPHI9%F_P, "DPHI9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%DPHI9%F_P, "DPHI9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1GWS9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GWS9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD2FSL (SELF%Y2FSL,  I2FSL,  SELF%GWS9%F_P, "GWS9", " ", JFLD)
  ELSE
    CALL ADD2FSL (SELF%Y2FSLA, I2FSLA, SELF%GWS9%F_P, "GWS9", "A", JFLD)
  ENDIF
  CALL ADD2FSL (SELF%Y2FSLB, I2FSLB, SELF%GWS9%F_P, "GWS9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1U0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%U0%F_P, "U0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%U0%F_P, "U0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%U0%F_P, "U0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1V0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%V0%F_P, "V0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%V0%F_P, "V0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%V0%F_P, "V0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1T0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%T0%F_P, "T0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%T0%F_P, "T0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%T0%F_P, "T0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1PD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%PD0%F_P, "PD0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%PD0%F_P, "PD0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%PD0%F_P, "PD0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VD0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VD0%F_P, "VD0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VD0%F_P, "VD0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VD0%F_P, "VD0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1C9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%C9%F_P, "C9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%C9%F_P, "C9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%C9%F_P, "C9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1SP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD2FSL (SELF%Y2FSL,  I2FSL,  SELF%SP9%F_P, "SP9", " ", JFLD)
  ELSE
    CALL ADD2FSL (SELF%Y2FSLA, I2FSLA, SELF%SP9%F_P, "SP9", "A", JFLD)
  ENDIF
  CALL ADD2FSL (SELF%Y2FSLB, I2FSLB, SELF%SP9%F_P, "SP9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1SP0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1SP0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD2FSL (SELF%Y2FSL,  I2FSL,  SELF%SP0%F_P, "SP0", " ", JFLD)
  ELSE
    CALL ADD2FSL (SELF%Y2FSLA, I2FSLA, SELF%SP0%F_P, "SP0", "A", JFLD)
  ENDIF
  CALL ADD2FSL (SELF%Y2FSLB, I2FSLB, SELF%SP0%F_P, "SP0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1C0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%C0%F_P, "C0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%C0%F_P, "C0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%C0%F_P, "C0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1UP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UP9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%UP9%F_P, "UP9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%UP9%F_P, "UP9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%UP9%F_P, "UP9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VP9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VP9%F_P, "VP9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VP9%F_P, "VP9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VP9%F_P, "VP9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1TP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TP9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%TP9%F_P, "TP9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%TP9%F_P, "TP9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%TP9%F_P, "TP9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1U9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_SI
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%U9_SI%F_P, "U9_SI", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%U9_SI%F_P, "U9_SI", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%U9_SI%F_P, "U9_SI", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1V9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_SI
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%V9_SI%F_P, "V9_SI", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%V9_SI%F_P, "V9_SI", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%V9_SI%F_P, "V9_SI", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1T9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_SI
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%T9_SI%F_P, "T9_SI", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%T9_SI%F_P, "T9_SI", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%T9_SI%F_P, "T9_SI", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1PD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_SI
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%PD9_SI%F_P, "PD9_SI", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%PD9_SI%F_P, "PD9_SI", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%PD9_SI%F_P, "PD9_SI", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VD9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_SI
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VD9_SI%F_P, "VD9_SI", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VD9_SI%F_P, "VD9_SI", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VD9_SI%F_P, "VD9_SI", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1C9_SI > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_SI
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%C9_SI%F_P, "C9_SI", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%C9_SI%F_P, "C9_SI", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%C9_SI%F_P, "C9_SI", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1UF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1UF9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%UF9%F_P, "UF9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%UF9%F_P, "UF9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%UF9%F_P, "UF9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VF9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VF9%F_P, "VF9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VF9%F_P, "VF9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VF9%F_P, "VF9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1TF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1TF9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%TF9%F_P, "TF9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%TF9%F_P, "TF9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%TF9%F_P, "TF9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VDF9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VDF9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VDF9%F_P, "VDF9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VDF9%F_P, "VDF9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VDF9%F_P, "VDF9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1U9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1U9_NL
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%U9_NL%F_P, "U9_NL", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%U9_NL%F_P, "U9_NL", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%U9_NL%F_P, "U9_NL", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1V9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1V9_NL
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%V9_NL%F_P, "V9_NL", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%V9_NL%F_P, "V9_NL", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%V9_NL%F_P, "V9_NL", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1T9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1T9_NL
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%T9_NL%F_P, "T9_NL", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%T9_NL%F_P, "T9_NL", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%T9_NL%F_P, "T9_NL", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1PD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1PD9_NL
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%PD9_NL%F_P, "PD9_NL", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%PD9_NL%F_P, "PD9_NL", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%PD9_NL%F_P, "PD9_NL", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1VD9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1VD9_NL
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%VD9_NL%F_P, "VD9_NL", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%VD9_NL%F_P, "VD9_NL", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%VD9_NL%F_P, "VD9_NL", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1C9_NL > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1C9_NL
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%C9_NL%F_P, "C9_NL", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%C9_NL%F_P, "C9_NL", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%C9_NL%F_P, "C9_NL", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1ZR9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZR9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%ZR9%F_P, "ZR9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%ZR9%F_P, "ZR9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%ZR9%F_P, "ZR9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1Z9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1Z9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%Z9%F_P, "Z9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%Z9%F_P, "Z9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%Z9%F_P, "Z9", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1Z0 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1Z0
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%Z0%F_P, "Z0", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%Z0%F_P, "Z0", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%Z0%F_P, "Z0", "B", JFLD)
ENDIF

IF (YDTPTRSLB1%MSLB1ZP9 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1ZP9
  IF (ANY (IPTRSL == JFLD)) THEN
    CALL ADD3FSL (SELF%Y3FSL,  I3FSL,  SELF%ZP9%F_P, "ZP9", " ", JFLD)
  ELSE
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%ZP9%F_P, "ZP9", "A", JFLD)
  ENDIF
  CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%ZP9%F_P, "ZP9", "B", JFLD)
ENDIF


CALL GREPVARSF (SELF, YDMODEL, COND_GFL, SELF%GFL)


DO JGFL = 1, SIZE (SELF%GFL)

  IF (ASSOCIATED (SELF%GFL (JGFL)%F_P)) THEN
    YDGFC => SELF%GFL (JGFL)%YCOMP
    JFLD = YDTPTRSLB1%MSLB1GFL9     + (YDGFC%MP_SL1-1)*(NLEV+2)
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%GFL (JGFL)%F_P, YDGFC%CNAME, "A", JFLD)
    CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%GFL (JGFL)%F_P, YDGFC%CNAME, "B", JFLD)
  ENDIF

  IF (ASSOCIATED (SELF%GFL (JGFL)%F_P_F)) THEN
    YDGFC => SELF%GFL (JGFL)%YCOMP
    JFLD = YDTPTRSLB1%MSLB1GFLF9    + (YDGFC%MP_SL1-1)*(NLEV+2)
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%GFL (JGFL)%F_P_F, YDGFC%CNAME, "A", JFLD)
    CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%GFL (JGFL)%F_P_F, YDGFC%CNAME, "B", JFLD)
  ENDIF

  IF (ASSOCIATED (SELF%GFL (JGFL)%F_P_SPF)) THEN
    YDGFC => SELF%GFL (JGFL)%YCOMP
    JFLD = YDTPTRSLB1%MSLB1GFLSPF9  + (YDGFC%MP_SPL-1)*(NLEV+2)
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%GFL (JGFL)%F_P_SPF, YDGFC%CNAME, "A", JFLD)
    CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%GFL (JGFL)%F_P_SPF, YDGFC%CNAME, "B", JFLD)
  ENDIF

  IF (ASSOCIATED (SELF%GFL (JGFL)%F_P_SP)) THEN
    YDGFC => SELF%GFL (JGFL)%YCOMP
    JFLD = YDTPTRSLB1%MSLB1GFLSP9   + (YDGFC%MP_SPL-1)*(NLEV+2)
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%GFL (JGFL)%F_P_SP, YDGFC%CNAME, "A", JFLD)
    CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%GFL (JGFL)%F_P_SP, YDGFC%CNAME, "B", JFLD)
  ENDIF

  IF (ASSOCIATED (SELF%GFL (JGFL)%F_P_P)) THEN
    YDGFC => SELF%GFL (JGFL)%YCOMP
    JFLD = YDTPTRSLB1%MSLB1GFLP9    + (YDGFC%MPSLP -1)*(NLEV+2)
    CALL ADD3FSL (SELF%Y3FSLA, I3FSLA, SELF%GFL (JGFL)%F_P_P, YDGFC%CNAME, "A", JFLD)
    CALL ADD3FSL (SELF%Y3FSLB, I3FSLB, SELF%GFL (JGFL)%F_P_P, YDGFC%CNAME, "B", JFLD)
  ENDIF

ENDDO

IF (I3FSL  /= SIZE (SELF%Y3FSL )) CALL ABOR1 ('SELF%Y3FSL  : SIZE MISMATCH')
IF (I2FSL  /= SIZE (SELF%Y2FSL )) CALL ABOR1 ('SELF%Y2FSL  : SIZE MISMATCH')
IF (I3FSLA /= SIZE (SELF%Y3FSLA)) CALL ABOR1 ('SELF%Y3FSLA : SIZE MISMATCH')
IF (I2FSLA /= SIZE (SELF%Y2FSLA)) CALL ABOR1 ('SELF%Y2FSLA : SIZE MISMATCH')
IF (I3FSLB /= SIZE (SELF%Y3FSLB)) CALL ABOR1 ('SELF%Y3FSLB : SIZE MISMATCH')
IF (I2FSLB /= SIZE (SELF%Y2FSLB)) CALL ABOR1 ('SELF%Y2FSLB : SIZE MISMATCH')


CALL SELF%SET_POINTERS 

CONTAINS


SUBROUTINE ADD2FSL (YD2FSL, K2FSL, YDF1D, CDNAME, CDKIND, KFLD)

TYPE (CPG_SL1F_1RB) :: YD2FSL (:)
INTEGER (KIND=JPIM) :: K2FSL
CLASS (FIELD_1RB),    POINTER     :: YDF1D
CHARACTER (LEN=*),    INTENT (IN) :: CDNAME
CHARACTER (LEN=*),    INTENT (IN) :: CDKIND
INTEGER (KIND=JPIM),  INTENT (IN) :: KFLD

K2FSL = K2FSL + 1

IF (K2FSL > SIZE (YD2FSL)) CALL ABOR1 ('CPG_SL1F_TYPE_INIT:ADD2FSL')

YD2FSL (K2FSL)%F_P    => YDF1D
IF (YDMODEL%YRML_DYN%YRDYNA%LSLAG) THEN
  YD2FSL (K2FSL)%PARITY = YDTPTRSLB1%RPARSL1 (KFLD)
ENDIF
YD2FSL (K2FSL)%JFLD1  = KFLD
YD2FSL (K2FSL)%JFLD2  = KFLD
!WRITE (0, '(A10," ",3I6," ",Z16.16," ",A)') TRIM (CDNAME), K2FSL, YD2FSL (K2FSL )%JFLD1, YD2FSL (K2FSL )%JFLD2, LOC (YD2FSL (K2FSL)%F_P%PTR (1)), CDKIND

END SUBROUTINE

SUBROUTINE ADD3FSL (YD3FSL, K3FSL, YDF2D, CDNAME, CDKIND, KFLD)

TYPE (CPG_SL1F_2RB) :: YD3FSL (:)
INTEGER (KIND=JPIM) :: K3FSL
CLASS (FIELD_2RB),    POINTER     :: YDF2D
CHARACTER (LEN=*),    INTENT (IN) :: CDNAME
CHARACTER (LEN=*),    INTENT (IN) :: CDKIND
INTEGER (KIND=JPIM),  INTENT (IN) :: KFLD

K3FSL = K3FSL + 1

IF (K3FSL > SIZE (YD3FSL)) CALL ABOR1 ('CPG_SL1F_TYPE_INIT:ADD3FSL')

YD3FSL (K3FSL)%F_P    => YDF2D
IF (YDMODEL%YRML_DYN%YRDYNA%LSLAG) THEN
  YD3FSL (K3FSL)%PARITY = YDTPTRSLB1%RPARSL1 (KFLD)
ENDIF
YD3FSL (K3FSL)%JFLD1  = KFLD
YD3FSL (K3FSL)%JFLD2  = KFLD+NLEV+1
!WRITE (0, '(A10," ",3I6," ",Z16.16," ",A)') TRIM (CDNAME), K3FSL, YD3FSL (K3FSL )%JFLD1, YD3FSL (K3FSL )%JFLD2, LOC (YD3FSL (K3FSL)%F_P%PTR (1, 0)), CDKIND

END SUBROUTINE


LOGICAL FUNCTION COND_GFL (YDCOMP, YDMODEL)
  USE YOM_YGFL, ONLY : TYPE_GFL_COMP
  TYPE (TYPE_GFL_COMP), INTENT (IN) :: YDCOMP
  TYPE (MODEL), INTENT(IN) :: YDMODEL
  COND_GFL = .TRUE.
END FUNCTION

SUBROUTINE CPG_SL1F_TYPE_INIT_F3D (YDF3D, YDGFC)

USE YOM_YGFL, ONLY : TYPE_GFL_COMP

TYPE (CPG_SL1F_3D_TYPE), INTENT (INOUT) :: YDF3D
TYPE(TYPE_GFL_COMP),           INTENT (IN)    :: YDGFC

YDF3D%YCOMP = YDGFC

IF (YDGFC%MP_SL1 > 0 .AND. YDGFC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFL9     + (YDGFC%MP_SL1-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  I3FSLA = I3FSLA + 1
! WRITE (0, *) " JFLD = ", JFLD, "ZP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA
ELSE
  YDF3D%F_P => NULL ()
ENDIF

IF ((YDMODEL%YRML_DYN%YRDYN%LSPLTHOIGFL .OR. (YDMODEL%YRML_DYN%YRDYN%NSPLTHOI /= 0)) .AND. YDGFC%MP_SL1 > 0 .AND. YDGFC%MP1 > 0)&
    & THEN
  JFLD = YDTPTRSLB1%MSLB1GFLF9    + (YDGFC%MP_SL1-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_F, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  I3FSLA = I3FSLA + 1
! WRITE (0, *) " JFLD = ", JFLD, "ZP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA
ELSE
  YDF3D%F_P_F => NULL ()
ENDIF

IF (YDTPTRSLB1%MSLB1GFLSPF9 >= 0 .AND. YDGFC%MP_SPL > 0 .AND. YDGFC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFLSPF9  + (YDGFC%MP_SPL-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_SPF, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  I3FSLA = I3FSLA + 1
! WRITE (0, *) " JFLD = ", JFLD, "ZP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA
ELSE
  YDF3D%F_P_SPF => NULL ()
ENDIF

IF (YDGFC%MP_SPL > 0 .AND. YDGFC%MP1 > 0) THEN
  JFLD = YDTPTRSLB1%MSLB1GFLSP9   + (YDGFC%MP_SPL-1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_SP, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  I3FSLA = I3FSLA + 1
! WRITE (0, *) " JFLD = ", JFLD, "ZP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA
ELSE
  YDF3D%F_P_SP => NULL ()
ENDIF

IF (YDGFC%LPHY) THEN
  JFLD = YDTPTRSLB1%MSLB1GFLP9    + (YDGFC%MPSLP -1)*(NLEV+2)
  CALL FIELD_NEW (YDF3D%F_P_P, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV+1), PERSISTENT=LLPERSISTENT, &
                & LBOUNDS=[1,0], INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
  I3FSLA = I3FSLA + 1
! WRITE (0, *) " JFLD = ", JFLD, "ZP9", " I3FSL = ", I3FSL, " I3FSLA = ", I3FSLA, " I2FSL = ", I2FSL, " I2FSLA = ", I2FSLA
ELSE
  YDF3D%F_P_P => NULL ()
ENDIF


END SUBROUTINE CPG_SL1F_TYPE_INIT_F3D

END SUBROUTINE CPG_SL1F_TYPE_INIT

SUBROUTINE CPG_SL1F_TYPE_FINAL (SELF)
CLASS (CPG_SL1F_TYPE)          :: SELF

INTEGER (KIND=JPIM) :: JGFL

IF (ALLOCATED (SELF%Y2FSL )) DEALLOCATE (SELF%Y2FSL )
IF (ALLOCATED (SELF%Y3FSL )) DEALLOCATE (SELF%Y3FSL )
IF (ALLOCATED (SELF%Y2FSLA)) DEALLOCATE (SELF%Y2FSLA)
IF (ALLOCATED (SELF%Y3FSLA)) DEALLOCATE (SELF%Y3FSLA)
IF (ALLOCATED (SELF%Y2FSLB)) DEALLOCATE (SELF%Y2FSLB)
IF (ALLOCATED (SELF%Y3FSLB)) DEALLOCATE (SELF%Y3FSLB)

IF (ASSOCIATED (SELF%ZP9%F_P)) CALL FIELD_DELETE (SELF%ZP9%F_P)
SELF%ZP9%F_P => NULL ()
SELF%ZP9%P => NULL ()
IF (ASSOCIATED (SELF%Z0%F_P)) CALL FIELD_DELETE (SELF%Z0%F_P)
SELF%Z0%F_P => NULL ()
SELF%Z0%P => NULL ()
IF (ASSOCIATED (SELF%Z9%F_P)) CALL FIELD_DELETE (SELF%Z9%F_P)
SELF%Z9%F_P => NULL ()
SELF%Z9%P => NULL ()
IF (ASSOCIATED (SELF%ZR9%F_P)) CALL FIELD_DELETE (SELF%ZR9%F_P)
SELF%ZR9%F_P => NULL ()
SELF%ZR9%P => NULL ()
IF (ASSOCIATED (SELF%C9_NL%F_P)) CALL FIELD_DELETE (SELF%C9_NL%F_P)
SELF%C9_NL%F_P => NULL ()
SELF%C9_NL%P => NULL ()
IF (ASSOCIATED (SELF%VD9_NL%F_P)) CALL FIELD_DELETE (SELF%VD9_NL%F_P)
SELF%VD9_NL%F_P => NULL ()
SELF%VD9_NL%P => NULL ()
IF (ASSOCIATED (SELF%PD9_NL%F_P)) CALL FIELD_DELETE (SELF%PD9_NL%F_P)
SELF%PD9_NL%F_P => NULL ()
SELF%PD9_NL%P => NULL ()
IF (ASSOCIATED (SELF%T9_NL%F_P)) CALL FIELD_DELETE (SELF%T9_NL%F_P)
SELF%T9_NL%F_P => NULL ()
SELF%T9_NL%P => NULL ()
IF (ASSOCIATED (SELF%V9_NL%F_P)) CALL FIELD_DELETE (SELF%V9_NL%F_P)
SELF%V9_NL%F_P => NULL ()
SELF%V9_NL%P => NULL ()
IF (ASSOCIATED (SELF%U9_NL%F_P)) CALL FIELD_DELETE (SELF%U9_NL%F_P)
SELF%U9_NL%F_P => NULL ()
SELF%U9_NL%P => NULL ()
IF (ASSOCIATED (SELF%VDF9%F_P)) CALL FIELD_DELETE (SELF%VDF9%F_P)
SELF%VDF9%F_P => NULL ()
SELF%VDF9%P => NULL ()
IF (ASSOCIATED (SELF%TF9%F_P)) CALL FIELD_DELETE (SELF%TF9%F_P)
SELF%TF9%F_P => NULL ()
SELF%TF9%P => NULL ()
IF (ASSOCIATED (SELF%VF9%F_P)) CALL FIELD_DELETE (SELF%VF9%F_P)
SELF%VF9%F_P => NULL ()
SELF%VF9%P => NULL ()
IF (ASSOCIATED (SELF%UF9%F_P)) CALL FIELD_DELETE (SELF%UF9%F_P)
SELF%UF9%F_P => NULL ()
SELF%UF9%P => NULL ()
IF (ASSOCIATED (SELF%C9_SI%F_P)) CALL FIELD_DELETE (SELF%C9_SI%F_P)
SELF%C9_SI%F_P => NULL ()
SELF%C9_SI%P => NULL ()
IF (ASSOCIATED (SELF%VD9_SI%F_P)) CALL FIELD_DELETE (SELF%VD9_SI%F_P)
SELF%VD9_SI%F_P => NULL ()
SELF%VD9_SI%P => NULL ()
IF (ASSOCIATED (SELF%PD9_SI%F_P)) CALL FIELD_DELETE (SELF%PD9_SI%F_P)
SELF%PD9_SI%F_P => NULL ()
SELF%PD9_SI%P => NULL ()
IF (ASSOCIATED (SELF%T9_SI%F_P)) CALL FIELD_DELETE (SELF%T9_SI%F_P)
SELF%T9_SI%F_P => NULL ()
SELF%T9_SI%P => NULL ()
IF (ASSOCIATED (SELF%V9_SI%F_P)) CALL FIELD_DELETE (SELF%V9_SI%F_P)
SELF%V9_SI%F_P => NULL ()
SELF%V9_SI%P => NULL ()
IF (ASSOCIATED (SELF%U9_SI%F_P)) CALL FIELD_DELETE (SELF%U9_SI%F_P)
SELF%U9_SI%F_P => NULL ()
SELF%U9_SI%P => NULL ()
IF (ASSOCIATED (SELF%TP9%F_P)) CALL FIELD_DELETE (SELF%TP9%F_P)
SELF%TP9%F_P => NULL ()
SELF%TP9%P => NULL ()
IF (ASSOCIATED (SELF%VP9%F_P)) CALL FIELD_DELETE (SELF%VP9%F_P)
SELF%VP9%F_P => NULL ()
SELF%VP9%P => NULL ()
IF (ASSOCIATED (SELF%UP9%F_P)) CALL FIELD_DELETE (SELF%UP9%F_P)
SELF%UP9%F_P => NULL ()
SELF%UP9%P => NULL ()
IF (ASSOCIATED (SELF%C0%F_P)) CALL FIELD_DELETE (SELF%C0%F_P)
SELF%C0%F_P => NULL ()
SELF%C0%P => NULL ()
IF (ASSOCIATED (SELF%SP0%F_P)) CALL FIELD_DELETE (SELF%SP0%F_P)
SELF%SP0%F_P => NULL ()
SELF%SP0%P => NULL ()
IF (ASSOCIATED (SELF%SP9%F_P)) CALL FIELD_DELETE (SELF%SP9%F_P)
SELF%SP9%F_P => NULL ()
SELF%SP9%P => NULL ()
IF (ASSOCIATED (SELF%C9%F_P)) CALL FIELD_DELETE (SELF%C9%F_P)
SELF%C9%F_P => NULL ()
SELF%C9%P => NULL ()
IF (ASSOCIATED (SELF%VD0%F_P)) CALL FIELD_DELETE (SELF%VD0%F_P)
SELF%VD0%F_P => NULL ()
SELF%VD0%P => NULL ()
IF (ASSOCIATED (SELF%PD0%F_P)) CALL FIELD_DELETE (SELF%PD0%F_P)
SELF%PD0%F_P => NULL ()
SELF%PD0%P => NULL ()
IF (ASSOCIATED (SELF%T0%F_P)) CALL FIELD_DELETE (SELF%T0%F_P)
SELF%T0%F_P => NULL ()
SELF%T0%P => NULL ()
IF (ASSOCIATED (SELF%V0%F_P)) CALL FIELD_DELETE (SELF%V0%F_P)
SELF%V0%F_P => NULL ()
SELF%V0%P => NULL ()
IF (ASSOCIATED (SELF%U0%F_P)) CALL FIELD_DELETE (SELF%U0%F_P)
SELF%U0%F_P => NULL ()
SELF%U0%P => NULL ()
IF (ASSOCIATED (SELF%GWS9%F_P)) CALL FIELD_DELETE (SELF%GWS9%F_P)
SELF%GWS9%F_P => NULL ()
SELF%GWS9%P => NULL ()
IF (ASSOCIATED (SELF%DPHI9%F_P)) CALL FIELD_DELETE (SELF%DPHI9%F_P)
SELF%DPHI9%F_P => NULL ()
SELF%DPHI9%P => NULL ()
IF (ASSOCIATED (SELF%DBBC9%F_P)) CALL FIELD_DELETE (SELF%DBBC9%F_P)
SELF%DBBC9%F_P => NULL ()
SELF%DBBC9%P => NULL ()
IF (ASSOCIATED (SELF%VR9%F_P)) CALL FIELD_DELETE (SELF%VR9%F_P)
SELF%VR9%F_P => NULL ()
SELF%VR9%P => NULL ()
IF (ASSOCIATED (SELF%UR9%F_P)) CALL FIELD_DELETE (SELF%UR9%F_P)
SELF%UR9%F_P => NULL ()
SELF%UR9%P => NULL ()
IF (ASSOCIATED (SELF%WRA%F_P)) CALL FIELD_DELETE (SELF%WRA%F_P)
SELF%WRA%F_P => NULL ()
SELF%WRA%P => NULL ()
IF (ASSOCIATED (SELF%WR00%F_P)) CALL FIELD_DELETE (SELF%WR00%F_P)
SELF%WR00%F_P => NULL ()
SELF%WR00%P => NULL ()
IF (ASSOCIATED (SELF%ZR00%F_P)) CALL FIELD_DELETE (SELF%ZR00%F_P)
SELF%ZR00%F_P => NULL ()
SELF%ZR00%P => NULL ()
IF (ASSOCIATED (SELF%VR00%F_P)) CALL FIELD_DELETE (SELF%VR00%F_P)
SELF%VR00%F_P => NULL ()
SELF%VR00%P => NULL ()
IF (ASSOCIATED (SELF%UR00%F_P)) CALL FIELD_DELETE (SELF%UR00%F_P)
SELF%UR00%F_P => NULL ()
SELF%UR00%P => NULL ()
IF (ASSOCIATED (SELF%WR0%F_P)) CALL FIELD_DELETE (SELF%WR0%F_P)
SELF%WR0%F_P => NULL ()
SELF%WR0%P => NULL ()
IF (ASSOCIATED (SELF%ZR0%F_P)) CALL FIELD_DELETE (SELF%ZR0%F_P)
SELF%ZR0%F_P => NULL ()
SELF%ZR0%P => NULL ()
IF (ASSOCIATED (SELF%VR0%F_P)) CALL FIELD_DELETE (SELF%VR0%F_P)
SELF%VR0%F_P => NULL ()
SELF%VR0%P => NULL ()
IF (ASSOCIATED (SELF%UR0%F_P)) CALL FIELD_DELETE (SELF%UR0%F_P)
SELF%UR0%F_P => NULL ()
SELF%UR0%P => NULL ()
IF (ASSOCIATED (SELF%NHX9%F_P)) CALL FIELD_DELETE (SELF%NHX9%F_P)
SELF%NHX9%F_P => NULL ()
SELF%NHX9%P => NULL ()
IF (ASSOCIATED (SELF%VD9%F_P)) CALL FIELD_DELETE (SELF%VD9%F_P)
SELF%VD9%F_P => NULL ()
SELF%VD9%P => NULL ()
IF (ASSOCIATED (SELF%PD9%F_P)) CALL FIELD_DELETE (SELF%PD9%F_P)
SELF%PD9%F_P => NULL ()
SELF%PD9%P => NULL ()
IF (ASSOCIATED (SELF%T9%F_P)) CALL FIELD_DELETE (SELF%T9%F_P)
SELF%T9%F_P => NULL ()
SELF%T9%P => NULL ()
IF (ASSOCIATED (SELF%V9%F_P)) CALL FIELD_DELETE (SELF%V9%F_P)
SELF%V9%F_P => NULL ()
SELF%V9%P => NULL ()
IF (ASSOCIATED (SELF%U9%F_P)) CALL FIELD_DELETE (SELF%U9%F_P)
SELF%U9%F_P => NULL ()
SELF%U9%P => NULL ()

IF (ALLOCATED (SELF%EXT)) THEN
  DO JGFL = 1, SIZE (SELF%EXT)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%EXT(JGFL))
  ENDDO
  DEALLOCATE (SELF%EXT)
ENDIF
CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%FSD)

IF (ALLOCATED (SELF%LIMA)) THEN
  DO JGFL = 1, SIZE (SELF%LIMA)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%LIMA(JGFL))
  ENDDO
  DEALLOCATE (SELF%LIMA)
ENDIF
CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%UNEBH)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%UEN)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%DAL)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%DOM)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%UAL)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%UOM)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%RKTQC)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%RKTQV)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%RKTH)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%CVV)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%SDSAT)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%RSPEC)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%PHYCTY)

IF (ALLOCATED (SELF%UVP)) THEN
  DO JGFL = 1, SIZE (SELF%UVP)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%UVP(JGFL))
  ENDDO
  DEALLOCATE (SELF%UVP)
ENDIF
IF (ALLOCATED (SELF%AEROCLIM)) THEN
  DO JGFL = 1, SIZE (SELF%AEROCLIM)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%AEROCLIM(JGFL))
  ENDDO
  DEALLOCATE (SELF%AEROCLIM)
ENDIF
IF (ALLOCATED (SELF%AEROUT)) THEN
  DO JGFL = 1, SIZE (SELF%AEROUT)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%AEROUT(JGFL))
  ENDDO
  DEALLOCATE (SELF%AEROUT)
ENDIF
IF (ALLOCATED (SELF%AERLISI)) THEN
  DO JGFL = 1, SIZE (SELF%AERLISI)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%AERLISI(JGFL))
  ENDDO
  DEALLOCATE (SELF%AERLISI)
ENDIF
IF (ALLOCATED (SELF%AERAOT)) THEN
  DO JGFL = 1, SIZE (SELF%AERAOT)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%AERAOT(JGFL))
  ENDDO
  DEALLOCATE (SELF%AERAOT)
ENDIF
IF (ALLOCATED (SELF%SLDIA)) THEN
  DO JGFL = 1, SIZE (SELF%SLDIA)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%SLDIA(JGFL))
  ENDDO
  DEALLOCATE (SELF%SLDIA)
ENDIF
IF (ALLOCATED (SELF%EDRP)) THEN
  DO JGFL = 1, SIZE (SELF%EDRP)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%EDRP(JGFL))
  ENDDO
  DEALLOCATE (SELF%EDRP)
ENDIF
IF (ALLOCATED (SELF%EMIS3D)) THEN
  DO JGFL = 1, SIZE (SELF%EMIS3D)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%EMIS3D(JGFL))
  ENDDO
  DEALLOCATE (SELF%EMIS3D)
ENDIF
IF (ALLOCATED (SELF%NOGW)) THEN
  DO JGFL = 1, SIZE (SELF%NOGW)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%NOGW(JGFL))
  ENDDO
  DEALLOCATE (SELF%NOGW)
ENDIF
IF (ALLOCATED (SELF%ERA40)) THEN
  DO JGFL = 1, SIZE (SELF%ERA40)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%ERA40(JGFL))
  ENDDO
  DEALLOCATE (SELF%ERA40)
ENDIF
IF (ALLOCATED (SELF%EZDIAG)) THEN
  DO JGFL = 1, SIZE (SELF%EZDIAG)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%EZDIAG(JGFL))
  ENDDO
  DEALLOCATE (SELF%EZDIAG)
ENDIF
IF (ALLOCATED (SELF%FORC)) THEN
  DO JGFL = 1, SIZE (SELF%FORC)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%FORC(JGFL))
  ENDDO
  DEALLOCATE (SELF%FORC)
ENDIF
CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%LRCH4)

IF (ALLOCATED (SELF%AERO)) THEN
  DO JGFL = 1, SIZE (SELF%AERO)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%AERO(JGFL))
  ENDDO
  DEALLOCATE (SELF%AERO)
ENDIF
IF (ALLOCATED (SELF%CHEM)) THEN
  DO JGFL = 1, SIZE (SELF%CHEM)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%CHEM(JGFL))
  ENDDO
  DEALLOCATE (SELF%CHEM)
ENDIF
IF (ALLOCATED (SELF%GHG)) THEN
  DO JGFL = 1, SIZE (SELF%GHG)
    CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%GHG(JGFL))
  ENDDO
  DEALLOCATE (SELF%GHG)
ENDIF
CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%QVA)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%CVGQ)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%SPF)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%CPF)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%FSTUR)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%FQTUR)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%SHTUR)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%MXL)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%SRC)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%O3)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%AMF)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%A)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%EFB3)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%EFB2)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%EFB1)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%TTE)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%TKE)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%H)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%G)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%R)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%S)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%LRAD)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%IRAD)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%SCONV)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%RCONV)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%ICONV)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%LCONV)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%LMF)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%IMF)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%L)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%I)

CALL CPG_SL1F_TYPE_FINAL_F3D (SELF%Q)


IF (ALLOCATED (SELF%GFL)) DEALLOCATE (SELF%GFL)

IF (ASSOCIATED (SELF%F_DATA)) CALL FIELD_DELETE (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  IF (ASSOCIATED (SELF%ZDATA)) DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()


CONTAINS

SUBROUTINE CPG_SL1F_TYPE_FINAL_F3D (YDF3D)

TYPE (CPG_SL1F_3D_TYPE), INTENT (INOUT) :: YDF3D

IF (ASSOCIATED (YDF3D%F_P)) CALL FIELD_DELETE (YDF3D%F_P)
YDF3D%F_P => NULL ()
YDF3D%P => NULL ()
IF (ASSOCIATED (YDF3D%F_P_F)) CALL FIELD_DELETE (YDF3D%F_P_F)
YDF3D%F_P_F => NULL ()
YDF3D%P_F => NULL ()
IF (ASSOCIATED (YDF3D%F_P_SPF)) CALL FIELD_DELETE (YDF3D%F_P_SPF)
YDF3D%F_P_SPF => NULL ()
YDF3D%P_SPF => NULL ()
IF (ASSOCIATED (YDF3D%F_P_SP)) CALL FIELD_DELETE (YDF3D%F_P_SP)
YDF3D%F_P_SP => NULL ()
YDF3D%P_SP => NULL ()
IF (ASSOCIATED (YDF3D%F_P_P)) CALL FIELD_DELETE (YDF3D%F_P_P)
YDF3D%F_P_P => NULL ()
YDF3D%P_P => NULL ()

END SUBROUTINE CPG_SL1F_TYPE_FINAL_F3D

END SUBROUTINE CPG_SL1F_TYPE_FINAL

SUBROUTINE CPG_SL1F_TYPE_SYNC_HOST (YDCPG_SL1F)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

CLASS (CPG_SL1F_TYPE) :: YDCPG_SL1F

INTEGER (KIND=JPIM) :: JGFL

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1F_TYPE_SYNC_HOST', 0, ZHOOK_HANDLE)

CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%U9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%V9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%T9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%PD9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VD9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%NHX9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%UR0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VR0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%ZR0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%WR0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%UR00)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VR00)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%ZR00)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%WR00)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%WRA)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%UR9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VR9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%DBBC9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%DPHI9)
CALL CPG_SL1F_2D_TYPE_SYNC_HOST (YDCPG_SL1F%GWS9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%U0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%V0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%T0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%PD0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VD0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%C9)
CALL CPG_SL1F_2D_TYPE_SYNC_HOST (YDCPG_SL1F%SP9)
CALL CPG_SL1F_2D_TYPE_SYNC_HOST (YDCPG_SL1F%SP0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%C0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%UP9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VP9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%TP9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%U9_SI)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%V9_SI)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%T9_SI)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%PD9_SI)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VD9_SI)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%C9_SI)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%UF9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VF9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%TF9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VDF9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%U9_NL)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%V9_NL)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%T9_NL)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%PD9_NL)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%VD9_NL)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%C9_NL)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%ZR9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%Z9)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%Z0)
CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%ZP9)

DO JGFL = 1, SIZE (YDCPG_SL1F%GFL)
  CALL CPG_SL1F_3D_TYPE_SYNC_HOST (YDCPG_SL1F%GFL (JGFL))
ENDDO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1F_TYPE_SYNC_HOST', 1, ZHOOK_HANDLE)

CONTAINS

SUBROUTINE CPG_SL1F_2D_TYPE_SYNC_HOST (YDF2D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1F_2D_TYPE) :: YDF2D

REAL (KIND=JPRB), POINTER :: PTR (:)

IF (ASSOCIATED (YDF2D%F_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_F)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_F)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SPF)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_SPF)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SP)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_SP)
ENDIF
IF (ASSOCIATED (YDF2D%F_P_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF2D%F_P_P)
ENDIF

END SUBROUTINE

SUBROUTINE CPG_SL1F_3D_TYPE_SYNC_HOST (YDF3D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1F_3D_TYPE) :: YDF3D

REAL (KIND=JPRB), POINTER :: PTR (:,:)

IF (ASSOCIATED (YDF3D%F_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_F)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_F)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SPF)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_SPF)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SP)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_SP)
ENDIF
IF (ASSOCIATED (YDF3D%F_P_P)) THEN
  PTR => GET_HOST_DATA_RDWR (YDF3D%F_P_P)
ENDIF

END SUBROUTINE

END SUBROUTINE CPG_SL1F_TYPE_SYNC_HOST

SUBROUTINE CPG_SL1F_TYPE_SET_POINTERS (SELF)
USE FIELD_ACCESS_MODULE
CLASS (CPG_SL1F_TYPE)     :: SELF

INTEGER (KIND=JPIM) :: JGFL

#include "abor1.intfb.h"

IF (ASSOCIATED (SELF%F_DATA)) THEN



  IF (ASSOCIATED (SELF%U9%F_P)) THEN
    IF ((.NOT. SELF%U9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U9%P))) THEN
      SELF%U9%P => GET_HOST_DATA_RDWR (SELF%U9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U9%P)) THEN
    SELF%U9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V9%F_P)) THEN
    IF ((.NOT. SELF%V9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V9%P))) THEN
      SELF%V9%P => GET_HOST_DATA_RDWR (SELF%V9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V9%P)) THEN
    SELF%V9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T9%F_P)) THEN
    IF ((.NOT. SELF%T9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T9%P))) THEN
      SELF%T9%P => GET_HOST_DATA_RDWR (SELF%T9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T9%P)) THEN
    SELF%T9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD9%F_P)) THEN
    IF ((.NOT. SELF%PD9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD9%P))) THEN
      SELF%PD9%P => GET_HOST_DATA_RDWR (SELF%PD9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD9%P)) THEN
    SELF%PD9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD9%F_P)) THEN
    IF ((.NOT. SELF%VD9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD9%P))) THEN
      SELF%VD9%P => GET_HOST_DATA_RDWR (SELF%VD9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD9%P)) THEN
    SELF%VD9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%NHX9%F_P)) THEN
    IF ((.NOT. SELF%NHX9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%NHX9%P))) THEN
      SELF%NHX9%P => GET_HOST_DATA_RDWR (SELF%NHX9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%NHX9%P)) THEN
    SELF%NHX9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UR0%F_P)) THEN
    IF ((.NOT. SELF%UR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UR0%P))) THEN
      SELF%UR0%P => GET_HOST_DATA_RDWR (SELF%UR0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UR0%P)) THEN
    SELF%UR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VR0%F_P)) THEN
    IF ((.NOT. SELF%VR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VR0%P))) THEN
      SELF%VR0%P => GET_HOST_DATA_RDWR (SELF%VR0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VR0%P)) THEN
    SELF%VR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZR0%F_P)) THEN
    IF ((.NOT. SELF%ZR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZR0%P))) THEN
      SELF%ZR0%P => GET_HOST_DATA_RDWR (SELF%ZR0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZR0%P)) THEN
    SELF%ZR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%WR0%F_P)) THEN
    IF ((.NOT. SELF%WR0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WR0%P))) THEN
      SELF%WR0%P => GET_HOST_DATA_RDWR (SELF%WR0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WR0%P)) THEN
    SELF%WR0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UR00%F_P)) THEN
    IF ((.NOT. SELF%UR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UR00%P))) THEN
      SELF%UR00%P => GET_HOST_DATA_RDWR (SELF%UR00%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UR00%P)) THEN
    SELF%UR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VR00%F_P)) THEN
    IF ((.NOT. SELF%VR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VR00%P))) THEN
      SELF%VR00%P => GET_HOST_DATA_RDWR (SELF%VR00%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VR00%P)) THEN
    SELF%VR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZR00%F_P)) THEN
    IF ((.NOT. SELF%ZR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZR00%P))) THEN
      SELF%ZR00%P => GET_HOST_DATA_RDWR (SELF%ZR00%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZR00%P)) THEN
    SELF%ZR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%WR00%F_P)) THEN
    IF ((.NOT. SELF%WR00%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WR00%P))) THEN
      SELF%WR00%P => GET_HOST_DATA_RDWR (SELF%WR00%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WR00%P)) THEN
    SELF%WR00%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%WRA%F_P)) THEN
    IF ((.NOT. SELF%WRA%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WRA%P))) THEN
      SELF%WRA%P => GET_HOST_DATA_RDWR (SELF%WRA%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WRA%P)) THEN
    SELF%WRA%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UR9%F_P)) THEN
    IF ((.NOT. SELF%UR9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UR9%P))) THEN
      SELF%UR9%P => GET_HOST_DATA_RDWR (SELF%UR9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UR9%P)) THEN
    SELF%UR9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VR9%F_P)) THEN
    IF ((.NOT. SELF%VR9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VR9%P))) THEN
      SELF%VR9%P => GET_HOST_DATA_RDWR (SELF%VR9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VR9%P)) THEN
    SELF%VR9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%DBBC9%F_P)) THEN
    IF ((.NOT. SELF%DBBC9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DBBC9%P))) THEN
      SELF%DBBC9%P => GET_HOST_DATA_RDWR (SELF%DBBC9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%DBBC9%P)) THEN
    SELF%DBBC9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%DPHI9%F_P)) THEN
    IF ((.NOT. SELF%DPHI9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DPHI9%P))) THEN
      SELF%DPHI9%P => GET_HOST_DATA_RDWR (SELF%DPHI9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%DPHI9%P)) THEN
    SELF%DPHI9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%GWS9%F_P)) THEN
    IF ((.NOT. SELF%GWS9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GWS9%P))) THEN
      SELF%GWS9%P => GET_HOST_DATA_RDWR (SELF%GWS9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%GWS9%P)) THEN
    SELF%GWS9%P => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%U0%F_P)) THEN
    IF ((.NOT. SELF%U0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U0%P))) THEN
      SELF%U0%P => GET_HOST_DATA_RDWR (SELF%U0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U0%P)) THEN
    SELF%U0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V0%F_P)) THEN
    IF ((.NOT. SELF%V0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V0%P))) THEN
      SELF%V0%P => GET_HOST_DATA_RDWR (SELF%V0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V0%P)) THEN
    SELF%V0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T0%F_P)) THEN
    IF ((.NOT. SELF%T0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T0%P))) THEN
      SELF%T0%P => GET_HOST_DATA_RDWR (SELF%T0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T0%P)) THEN
    SELF%T0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD0%F_P)) THEN
    IF ((.NOT. SELF%PD0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD0%P))) THEN
      SELF%PD0%P => GET_HOST_DATA_RDWR (SELF%PD0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD0%P)) THEN
    SELF%PD0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD0%F_P)) THEN
    IF ((.NOT. SELF%VD0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD0%P))) THEN
      SELF%VD0%P => GET_HOST_DATA_RDWR (SELF%VD0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD0%P)) THEN
    SELF%VD0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%C9%F_P)) THEN
    IF ((.NOT. SELF%C9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C9%P))) THEN
      SELF%C9%P => GET_HOST_DATA_RDWR (SELF%C9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C9%P)) THEN
    SELF%C9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%SP9%F_P)) THEN
    IF ((.NOT. SELF%SP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%SP9%P))) THEN
      SELF%SP9%P => GET_HOST_DATA_RDWR (SELF%SP9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%SP9%P)) THEN
    SELF%SP9%P => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%SP0%F_P)) THEN
    IF ((.NOT. SELF%SP0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%SP0%P))) THEN
      SELF%SP0%P => GET_HOST_DATA_RDWR (SELF%SP0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%SP0%P)) THEN
    SELF%SP0%P => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%C0%F_P)) THEN
    IF ((.NOT. SELF%C0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C0%P))) THEN
      SELF%C0%P => GET_HOST_DATA_RDWR (SELF%C0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C0%P)) THEN
    SELF%C0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UP9%F_P)) THEN
    IF ((.NOT. SELF%UP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UP9%P))) THEN
      SELF%UP9%P => GET_HOST_DATA_RDWR (SELF%UP9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UP9%P)) THEN
    SELF%UP9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VP9%F_P)) THEN
    IF ((.NOT. SELF%VP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VP9%P))) THEN
      SELF%VP9%P => GET_HOST_DATA_RDWR (SELF%VP9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VP9%P)) THEN
    SELF%VP9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%TP9%F_P)) THEN
    IF ((.NOT. SELF%TP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TP9%P))) THEN
      SELF%TP9%P => GET_HOST_DATA_RDWR (SELF%TP9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%TP9%P)) THEN
    SELF%TP9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%U9_SI%F_P)) THEN
    IF ((.NOT. SELF%U9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U9_SI%P))) THEN
      SELF%U9_SI%P => GET_HOST_DATA_RDWR (SELF%U9_SI%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U9_SI%P)) THEN
    SELF%U9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V9_SI%F_P)) THEN
    IF ((.NOT. SELF%V9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V9_SI%P))) THEN
      SELF%V9_SI%P => GET_HOST_DATA_RDWR (SELF%V9_SI%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V9_SI%P)) THEN
    SELF%V9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T9_SI%F_P)) THEN
    IF ((.NOT. SELF%T9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T9_SI%P))) THEN
      SELF%T9_SI%P => GET_HOST_DATA_RDWR (SELF%T9_SI%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T9_SI%P)) THEN
    SELF%T9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD9_SI%F_P)) THEN
    IF ((.NOT. SELF%PD9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD9_SI%P))) THEN
      SELF%PD9_SI%P => GET_HOST_DATA_RDWR (SELF%PD9_SI%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD9_SI%P)) THEN
    SELF%PD9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD9_SI%F_P)) THEN
    IF ((.NOT. SELF%VD9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD9_SI%P))) THEN
      SELF%VD9_SI%P => GET_HOST_DATA_RDWR (SELF%VD9_SI%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD9_SI%P)) THEN
    SELF%VD9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%C9_SI%F_P)) THEN
    IF ((.NOT. SELF%C9_SI%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C9_SI%P))) THEN
      SELF%C9_SI%P => GET_HOST_DATA_RDWR (SELF%C9_SI%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C9_SI%P)) THEN
    SELF%C9_SI%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%UF9%F_P)) THEN
    IF ((.NOT. SELF%UF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%UF9%P))) THEN
      SELF%UF9%P => GET_HOST_DATA_RDWR (SELF%UF9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%UF9%P)) THEN
    SELF%UF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VF9%F_P)) THEN
    IF ((.NOT. SELF%VF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VF9%P))) THEN
      SELF%VF9%P => GET_HOST_DATA_RDWR (SELF%VF9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VF9%P)) THEN
    SELF%VF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%TF9%F_P)) THEN
    IF ((.NOT. SELF%TF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TF9%P))) THEN
      SELF%TF9%P => GET_HOST_DATA_RDWR (SELF%TF9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%TF9%P)) THEN
    SELF%TF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VDF9%F_P)) THEN
    IF ((.NOT. SELF%VDF9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VDF9%P))) THEN
      SELF%VDF9%P => GET_HOST_DATA_RDWR (SELF%VDF9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VDF9%P)) THEN
    SELF%VDF9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%U9_NL%F_P)) THEN
    IF ((.NOT. SELF%U9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U9_NL%P))) THEN
      SELF%U9_NL%P => GET_HOST_DATA_RDWR (SELF%U9_NL%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U9_NL%P)) THEN
    SELF%U9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%V9_NL%F_P)) THEN
    IF ((.NOT. SELF%V9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V9_NL%P))) THEN
      SELF%V9_NL%P => GET_HOST_DATA_RDWR (SELF%V9_NL%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V9_NL%P)) THEN
    SELF%V9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%T9_NL%F_P)) THEN
    IF ((.NOT. SELF%T9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T9_NL%P))) THEN
      SELF%T9_NL%P => GET_HOST_DATA_RDWR (SELF%T9_NL%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T9_NL%P)) THEN
    SELF%T9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%PD9_NL%F_P)) THEN
    IF ((.NOT. SELF%PD9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PD9_NL%P))) THEN
      SELF%PD9_NL%P => GET_HOST_DATA_RDWR (SELF%PD9_NL%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PD9_NL%P)) THEN
    SELF%PD9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%VD9_NL%F_P)) THEN
    IF ((.NOT. SELF%VD9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VD9_NL%P))) THEN
      SELF%VD9_NL%P => GET_HOST_DATA_RDWR (SELF%VD9_NL%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VD9_NL%P)) THEN
    SELF%VD9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%C9_NL%F_P)) THEN
    IF ((.NOT. SELF%C9_NL%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%C9_NL%P))) THEN
      SELF%C9_NL%P => GET_HOST_DATA_RDWR (SELF%C9_NL%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%C9_NL%P)) THEN
    SELF%C9_NL%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZR9%F_P)) THEN
    IF ((.NOT. SELF%ZR9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZR9%P))) THEN
      SELF%ZR9%P => GET_HOST_DATA_RDWR (SELF%ZR9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZR9%P)) THEN
    SELF%ZR9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%Z9%F_P)) THEN
    IF ((.NOT. SELF%Z9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%Z9%P))) THEN
      SELF%Z9%P => GET_HOST_DATA_RDWR (SELF%Z9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%Z9%P)) THEN
    SELF%Z9%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%Z0%F_P)) THEN
    IF ((.NOT. SELF%Z0%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%Z0%P))) THEN
      SELF%Z0%P => GET_HOST_DATA_RDWR (SELF%Z0%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%Z0%P)) THEN
    SELF%Z0%P => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%ZP9%F_P)) THEN
    IF ((.NOT. SELF%ZP9%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZP9%P))) THEN
      SELF%ZP9%P => GET_HOST_DATA_RDWR (SELF%ZP9%F_P)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZP9%P)) THEN
    SELF%ZP9%P => ZDUM2
  ENDIF

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%Q)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%I)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%L)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%IMF)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%LMF)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%LCONV)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%ICONV)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%RCONV)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%SCONV)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%IRAD)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%LRAD)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%S)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%R)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%G)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%H)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%TKE)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%TTE)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%EFB1)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%EFB2)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%EFB3)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%A)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%AMF)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%O3)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%SRC)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%MXL)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%SHTUR)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%FQTUR)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%FSTUR)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%CPF)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%SPF)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%CVGQ)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%QVA)

  IF (ALLOCATED (SELF%GHG)) THEN
    DO JGFL = 1, SIZE (SELF%GHG)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%GHG(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%CHEM)) THEN
    DO JGFL = 1, SIZE (SELF%CHEM)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%CHEM(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AERO)) THEN
    DO JGFL = 1, SIZE (SELF%AERO)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%AERO(JGFL))
    ENDDO
  ENDIF

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%LRCH4)

  IF (ALLOCATED (SELF%FORC)) THEN
    DO JGFL = 1, SIZE (SELF%FORC)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%FORC(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%EZDIAG)) THEN
    DO JGFL = 1, SIZE (SELF%EZDIAG)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%EZDIAG(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%ERA40)) THEN
    DO JGFL = 1, SIZE (SELF%ERA40)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%ERA40(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%NOGW)) THEN
    DO JGFL = 1, SIZE (SELF%NOGW)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%NOGW(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%EMIS3D)) THEN
    DO JGFL = 1, SIZE (SELF%EMIS3D)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%EMIS3D(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%EDRP)) THEN
    DO JGFL = 1, SIZE (SELF%EDRP)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%EDRP(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%SLDIA)) THEN
    DO JGFL = 1, SIZE (SELF%SLDIA)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%SLDIA(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AERAOT)) THEN
    DO JGFL = 1, SIZE (SELF%AERAOT)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%AERAOT(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AERLISI)) THEN
    DO JGFL = 1, SIZE (SELF%AERLISI)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%AERLISI(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AEROUT)) THEN
    DO JGFL = 1, SIZE (SELF%AEROUT)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%AEROUT(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%AEROCLIM)) THEN
    DO JGFL = 1, SIZE (SELF%AEROCLIM)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%AEROCLIM(JGFL))
    ENDDO
  ENDIF

  IF (ALLOCATED (SELF%UVP)) THEN
    DO JGFL = 1, SIZE (SELF%UVP)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%UVP(JGFL))
    ENDDO
  ENDIF

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%PHYCTY)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%RSPEC)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%SDSAT)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%CVV)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%RKTH)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%RKTQV)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%RKTQC)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%UOM)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%UAL)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%DOM)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%DAL)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%UEN)

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%UNEBH)

  IF (ALLOCATED (SELF%LIMA)) THEN
    DO JGFL = 1, SIZE (SELF%LIMA)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%LIMA(JGFL))
    ENDDO
  ENDIF

    CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%FSD)

  IF (ALLOCATED (SELF%EXT)) THEN
    DO JGFL = 1, SIZE (SELF%EXT)
      CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%EXT(JGFL))
    ENDDO
  ENDIF


ELSE


  IF (.NOT. ASSOCIATED (SELF%U9%F_P)) SELF%U9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V9%F_P)) SELF%V9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T9%F_P)) SELF%T9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD9%F_P)) SELF%PD9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD9%F_P)) SELF%VD9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%NHX9%F_P)) SELF%NHX9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UR0%F_P)) SELF%UR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VR0%F_P)) SELF%VR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZR0%F_P)) SELF%ZR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WR0%F_P)) SELF%WR0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UR00%F_P)) SELF%UR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VR00%F_P)) SELF%VR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZR00%F_P)) SELF%ZR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WR00%F_P)) SELF%WR00%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WRA%F_P)) SELF%WRA%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UR9%F_P)) SELF%UR9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VR9%F_P)) SELF%VR9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%DBBC9%F_P)) SELF%DBBC9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%DPHI9%F_P)) SELF%DPHI9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%GWS9%F_P)) SELF%GWS9%P => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%U0%F_P)) SELF%U0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V0%F_P)) SELF%V0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T0%F_P)) SELF%T0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD0%F_P)) SELF%PD0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD0%F_P)) SELF%VD0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%C9%F_P)) SELF%C9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%SP9%F_P)) SELF%SP9%P => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%SP0%F_P)) SELF%SP0%P => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%C0%F_P)) SELF%C0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UP9%F_P)) SELF%UP9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VP9%F_P)) SELF%VP9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%TP9%F_P)) SELF%TP9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%U9_SI%F_P)) SELF%U9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V9_SI%F_P)) SELF%V9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T9_SI%F_P)) SELF%T9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD9_SI%F_P)) SELF%PD9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD9_SI%F_P)) SELF%VD9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%C9_SI%F_P)) SELF%C9_SI%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%UF9%F_P)) SELF%UF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VF9%F_P)) SELF%VF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%TF9%F_P)) SELF%TF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VDF9%F_P)) SELF%VDF9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%U9_NL%F_P)) SELF%U9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V9_NL%F_P)) SELF%V9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T9_NL%F_P)) SELF%T9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PD9_NL%F_P)) SELF%PD9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VD9_NL%F_P)) SELF%VD9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%C9_NL%F_P)) SELF%C9_NL%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZR9%F_P)) SELF%ZR9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%Z9%F_P)) SELF%Z9%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%Z0%F_P)) SELF%Z0%P => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZP9%F_P)) SELF%ZP9%P => ZDUM2

  CALL NULLIFY_F3DF (SELF%Q)
  CALL NULLIFY_F3DF (SELF%I)
  CALL NULLIFY_F3DF (SELF%L)
  CALL NULLIFY_F3DF (SELF%IMF)
  CALL NULLIFY_F3DF (SELF%LMF)
  CALL NULLIFY_F3DF (SELF%LCONV)
  CALL NULLIFY_F3DF (SELF%ICONV)
  CALL NULLIFY_F3DF (SELF%RCONV)
  CALL NULLIFY_F3DF (SELF%SCONV)
  CALL NULLIFY_F3DF (SELF%IRAD)
  CALL NULLIFY_F3DF (SELF%LRAD)
  CALL NULLIFY_F3DF (SELF%S)
  CALL NULLIFY_F3DF (SELF%R)
  CALL NULLIFY_F3DF (SELF%G)
  CALL NULLIFY_F3DF (SELF%H)
  CALL NULLIFY_F3DF (SELF%TKE)
  CALL NULLIFY_F3DF (SELF%TTE)
  CALL NULLIFY_F3DF (SELF%EFB1)
  CALL NULLIFY_F3DF (SELF%EFB2)
  CALL NULLIFY_F3DF (SELF%EFB3)
  CALL NULLIFY_F3DF (SELF%A)
  CALL NULLIFY_F3DF (SELF%AMF)
  CALL NULLIFY_F3DF (SELF%O3)
  CALL NULLIFY_F3DF (SELF%SRC)
  CALL NULLIFY_F3DF (SELF%MXL)
  CALL NULLIFY_F3DF (SELF%SHTUR)
  CALL NULLIFY_F3DF (SELF%FQTUR)
  CALL NULLIFY_F3DF (SELF%FSTUR)
  CALL NULLIFY_F3DF (SELF%CPF)
  CALL NULLIFY_F3DF (SELF%SPF)
  CALL NULLIFY_F3DF (SELF%CVGQ)
  CALL NULLIFY_F3DF (SELF%QVA)
  IF (ALLOCATED (SELF%GHG)) THEN
    DO JGFL = 1, SIZE (SELF%GHG)
      CALL NULLIFY_F3DF (SELF%GHG(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%CHEM)) THEN
    DO JGFL = 1, SIZE (SELF%CHEM)
      CALL NULLIFY_F3DF (SELF%CHEM(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AERO)) THEN
    DO JGFL = 1, SIZE (SELF%AERO)
      CALL NULLIFY_F3DF (SELF%AERO(JGFL))
    ENDDO
  ENDIF
  CALL NULLIFY_F3DF (SELF%LRCH4)
  IF (ALLOCATED (SELF%FORC)) THEN
    DO JGFL = 1, SIZE (SELF%FORC)
      CALL NULLIFY_F3DF (SELF%FORC(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%EZDIAG)) THEN
    DO JGFL = 1, SIZE (SELF%EZDIAG)
      CALL NULLIFY_F3DF (SELF%EZDIAG(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%ERA40)) THEN
    DO JGFL = 1, SIZE (SELF%ERA40)
      CALL NULLIFY_F3DF (SELF%ERA40(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%NOGW)) THEN
    DO JGFL = 1, SIZE (SELF%NOGW)
      CALL NULLIFY_F3DF (SELF%NOGW(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%EMIS3D)) THEN
    DO JGFL = 1, SIZE (SELF%EMIS3D)
      CALL NULLIFY_F3DF (SELF%EMIS3D(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%EDRP)) THEN
    DO JGFL = 1, SIZE (SELF%EDRP)
      CALL NULLIFY_F3DF (SELF%EDRP(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%SLDIA)) THEN
    DO JGFL = 1, SIZE (SELF%SLDIA)
      CALL NULLIFY_F3DF (SELF%SLDIA(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AERAOT)) THEN
    DO JGFL = 1, SIZE (SELF%AERAOT)
      CALL NULLIFY_F3DF (SELF%AERAOT(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AERLISI)) THEN
    DO JGFL = 1, SIZE (SELF%AERLISI)
      CALL NULLIFY_F3DF (SELF%AERLISI(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AEROUT)) THEN
    DO JGFL = 1, SIZE (SELF%AEROUT)
      CALL NULLIFY_F3DF (SELF%AEROUT(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%AEROCLIM)) THEN
    DO JGFL = 1, SIZE (SELF%AEROCLIM)
      CALL NULLIFY_F3DF (SELF%AEROCLIM(JGFL))
    ENDDO
  ENDIF
  IF (ALLOCATED (SELF%UVP)) THEN
    DO JGFL = 1, SIZE (SELF%UVP)
      CALL NULLIFY_F3DF (SELF%UVP(JGFL))
    ENDDO
  ENDIF
  CALL NULLIFY_F3DF (SELF%PHYCTY)
  CALL NULLIFY_F3DF (SELF%RSPEC)
  CALL NULLIFY_F3DF (SELF%SDSAT)
  CALL NULLIFY_F3DF (SELF%CVV)
  CALL NULLIFY_F3DF (SELF%RKTH)
  CALL NULLIFY_F3DF (SELF%RKTQV)
  CALL NULLIFY_F3DF (SELF%RKTQC)
  CALL NULLIFY_F3DF (SELF%UOM)
  CALL NULLIFY_F3DF (SELF%UAL)
  CALL NULLIFY_F3DF (SELF%DOM)
  CALL NULLIFY_F3DF (SELF%DAL)
  CALL NULLIFY_F3DF (SELF%UEN)
  CALL NULLIFY_F3DF (SELF%UNEBH)
  IF (ALLOCATED (SELF%LIMA)) THEN
    DO JGFL = 1, SIZE (SELF%LIMA)
      CALL NULLIFY_F3DF (SELF%LIMA(JGFL))
    ENDDO
  ENDIF
  CALL NULLIFY_F3DF (SELF%FSD)
  IF (ALLOCATED (SELF%EXT)) THEN
    DO JGFL = 1, SIZE (SELF%EXT)
      CALL NULLIFY_F3DF (SELF%EXT(JGFL))
    ENDDO
  ENDIF

ENDIF

DO JGFL = 1, SIZE (SELF%GFL)
  CALL CPG_SL1F_TYPE_SET_POINTERS_F3D (SELF%GFL(JGFL))
ENDDO

CONTAINS

SUBROUTINE NULLIFY_F3DF (YDF3D)

TYPE (CPG_SL1F_3D_TYPE), INTENT (INOUT) :: YDF3D

IF (.NOT. ASSOCIATED (YDF3D%F_P)) YDF3D%P => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_F)) YDF3D%P_F => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_SPF)) YDF3D%P_SPF => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_SP)) YDF3D%P_SP => ZDUM2
IF (.NOT. ASSOCIATED (YDF3D%F_P_P)) YDF3D%P_P => ZDUM2

END SUBROUTINE NULLIFY_F3DF

SUBROUTINE CPG_SL1F_TYPE_SET_POINTERS_F3D (YDF3D)

TYPE (CPG_SL1F_3D_TYPE), INTENT (INOUT) :: YDF3D

IF (ASSOCIATED (YDF3D%F_P)) THEN
  IF ((.NOT. YDF3D%F_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P))) THEN
    YDF3D%P => GET_HOST_DATA_RDWR (YDF3D%F_P)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P)) THEN
  YDF3D%P => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_F)) THEN
  IF ((.NOT. YDF3D%F_P_F%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_F))) THEN
    YDF3D%P_F => GET_HOST_DATA_RDWR (YDF3D%F_P_F)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_F)) THEN
  YDF3D%P_F => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_SPF)) THEN
  IF ((.NOT. YDF3D%F_P_SPF%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_SPF))) THEN
    YDF3D%P_SPF => GET_HOST_DATA_RDWR (YDF3D%F_P_SPF)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_SPF)) THEN
  YDF3D%P_SPF => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_SP)) THEN
  IF ((.NOT. YDF3D%F_P_SP%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_SP))) THEN
    YDF3D%P_SP => GET_HOST_DATA_RDWR (YDF3D%F_P_SP)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_SP)) THEN
  YDF3D%P_SP => ZDUM2
ENDIF

IF (ASSOCIATED (YDF3D%F_P_P)) THEN
  IF ((.NOT. YDF3D%F_P_P%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (YDF3D%P_P))) THEN
    YDF3D%P_P => GET_HOST_DATA_RDWR (YDF3D%F_P_P)
  ENDIF
ELSEIF (.NOT. ASSOCIATED (YDF3D%P_P)) THEN
  YDF3D%P_P => ZDUM2
ENDIF


END SUBROUTINE CPG_SL1F_TYPE_SET_POINTERS_F3D

END SUBROUTINE CPG_SL1F_TYPE_SET_POINTERS


SUBROUTINE CPG_SL1B_TYPE_SET (YDCPG_SL1B, YDCPG_OPTS, YDCPG_BNDS, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
REAL(KIND=JPRB), INTENT(IN) :: PVALUE

INTEGER (KIND=JPIM) :: JGFL

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SET', 0, ZHOOK_HANDLE)

YDCPG_SL1B%ZVIEW = PVALUE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SET', 1, ZHOOK_HANDLE)

END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SET_HOST_PARALLEL (YDCPG_SL1B, YDCPG_OPTS, YDCPG_BNDS, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
REAL(KIND=JPRB), INTENT(IN) :: PVALUE

INTEGER (KIND=JPIM) :: JBLK

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SET_HOST_PARALLEL', 0, ZHOOK_HANDLE)

CALL YDCPG_SL1B%SYNC_HOST

!$OMP PARALLEL DO PRIVATE (JBLK)
DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
  YDCPG_SL1B%ZDATA (:,:,JBLK) = PVALUE
ENDDO
!$OMP END PARALLEL DO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SET_HOST_PARALLEL', 1, ZHOOK_HANDLE)

END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SET_DEVICE_PARALLEL (YDCPG_SL1B, YDCPG_OPTS, YDCPG_BNDS, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

CLASS (CPG_SL1B_TYPE) :: YDCPG_SL1B
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
REAL(KIND=JPRB), INTENT(IN) :: PVALUE

INTEGER (KIND=JPIM) :: JGFL

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SET_DEVICE_PARALLEL', 0, ZHOOK_HANDLE)

CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%U9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%V9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%T9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%PD9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VD9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%NHX9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%UR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%ZR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%WR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%UR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%ZR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%WR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%WRA)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%UR9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VR9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%DBBC9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%DPHI9)
CALL CPG_SL1_2D_TYPE_SET (YDCPG_SL1B%GWS9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%U0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%V0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%T0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%PD0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VD0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%C9)
CALL CPG_SL1_2D_TYPE_SET (YDCPG_SL1B%SP9)
CALL CPG_SL1_2D_TYPE_SET (YDCPG_SL1B%SP0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%C0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%UP9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VP9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%TP9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%U9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%V9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%T9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%PD9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VD9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%C9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%UF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%TF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VDF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%U9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%V9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%T9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%PD9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%VD9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%C9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%ZR9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%Z9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%Z0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%ZP9)

DO JGFL = 1, SIZE (YDCPG_SL1B%GFL)
  CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1B%GFL (JGFL))
ENDDO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SET_DEVICE_PARALLEL', 1, ZHOOK_HANDLE)

CONTAINS

SUBROUTINE CPG_SL1_2D_TYPE_SET (YDF2D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1B_2D_TYPE) :: YDF2D

REAL (KIND=JPRB), POINTER :: ZF (:,:)

INTEGER (KIND=JPIM) :: JROF, JBLK

IF (ASSOCIATED (YDF2D%F_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF2D%F_P_F)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_F)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SPF)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_SPF)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SP)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_SP)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF2D%F_P_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_P)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF

END SUBROUTINE

SUBROUTINE CPG_SL1_3D_TYPE_SET (YDF3D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1B_3D_TYPE) :: YDF3D

REAL (KIND=JPRB), POINTER :: ZF (:,:,:)

INTEGER (KIND=JPIM) :: JROF, JBLK

IF (ASSOCIATED (YDF3D%F_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF3D%F_P_F)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_F)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SPF)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_SPF)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SP)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_SP)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (YDF3D%F_P_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_P)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (ZF, YDCPG_OPTS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    DO JROF = 1, YDCPG_OPTS%KLON
      ZF (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF

END SUBROUTINE

END SUBROUTINE

LOGICAL FUNCTION CPG_SL1F_TYPE_CONFORM (SELF, REGISTRY, NLEV, YDTPTRSLB1, YDMODEL, YGFL, YDSL) RESULT (LLCONFORM)

USE PTRSLB1   , ONLY : TPTRSLB1
USE YOM_YGFL  , ONLY : TYPE_GFLD
USE TYPE_MODEL, ONLY : MODEL
USE EINT_MOD  , ONLY : SL_STRUCT

CLASS (CPG_SL1F_TYPE) :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),                    INTENT (IN)    :: YDTPTRSLB1
TYPE (TYPE_GFLD),                   INTENT (IN)    :: YGFL
TYPE (MODEL),     TARGET,           INTENT (IN)    :: YDMODEL
TYPE(SL_STRUCT),  TARGET, OPTIONAL, INTENT (IN)    :: YDSL

TYPE(SL_STRUCT),  POINTER :: YLSL

YLSL => YDMODEL%YRML_DYN%YRSL
IF (PRESENT (YDSL)) YLSL => YDSL

LLCONFORM = .FALSE.

IF (.NOT. ASSOCIATED (SELF%ZDATA)) RETURN

IF (SIZE (SELF%ZDATA, 1) /= YLSL%NASLB1) RETURN
IF (SIZE (SELF%ZDATA, 2) /= YDTPTRSLB1%NFLDSLB1) RETURN

LLCONFORM = .TRUE.

END FUNCTION

SUBROUTINE CPG_SL1F_TYPE_RESIZE (SELF, REGISTRY, NLEV, YDTPTRSLB1, YDMODEL, YGFL , YDSL)

USE PTRSLB1   , ONLY : TPTRSLB1
USE YOM_YGFL  , ONLY : TYPE_GFLD
USE TYPE_MODEL, ONLY : MODEL
USE EINT_MOD  , ONLY : SL_STRUCT

CLASS (CPG_SL1F_TYPE) :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB1),                    INTENT (IN)    :: YDTPTRSLB1
TYPE (TYPE_GFLD),                   INTENT (IN)    :: YGFL
TYPE (MODEL),               TARGET, INTENT (IN)    :: YDMODEL
TYPE(SL_STRUCT),  OPTIONAL, TARGET, INTENT (IN)    :: YDSL

IF (.NOT. SELF%CONFORM (REGISTRY, NLEV, YDTPTRSLB1, YDMODEL, YGFL, YDSL)) THEN
  CALL SELF%FINAL
  CALL SELF%INIT (REGISTRY, NLEV, YDTPTRSLB1, YDMODEL, YGFL, YDSL)
ENDIF

END SUBROUTINE

SUBROUTINE CPG_SL1F_TYPE_SET_HOST_PARALLEL (YDCPG_SL1F, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

CLASS (CPG_SL1F_TYPE) :: YDCPG_SL1F
REAL(KIND=JPRB), INTENT(IN) :: PVALUE

INTEGER (KIND=JPIM) :: JFLD

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1F_TYPE_SET_HOST_PARALLEL', 0, ZHOOK_HANDLE)

CALL YDCPG_SL1F%SYNC_HOST

!$OMP PARALLEL DO PRIVATE (JFLD)
DO JFLD = 1, SIZE (YDCPG_SL1F%ZDATA, 2)
  YDCPG_SL1F%ZDATA (:,JFLD) = PVALUE
ENDDO
!$OMP END PARALLEL DO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1F_TYPE_SET_HOST_PARALLEL', 1, ZHOOK_HANDLE)

END SUBROUTINE

SUBROUTINE CPG_SL1F_TYPE_SET_DEVICE_PARALLEL (YDCPG_SL1F, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

CLASS (CPG_SL1F_TYPE) :: YDCPG_SL1F
REAL(KIND=JPRB), INTENT(IN) :: PVALUE

INTEGER (KIND=JPIM) :: JGFL

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1F_TYPE_SET_DEVICE_PARALLEL', 0, ZHOOK_HANDLE)

CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%U9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%V9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%T9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%PD9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VD9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%NHX9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%UR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%ZR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%WR0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%UR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%ZR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%WR00)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%WRA)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%UR9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VR9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%DBBC9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%DPHI9)
CALL CPG_SL1_2D_TYPE_SET (YDCPG_SL1F%GWS9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%U0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%V0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%T0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%PD0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VD0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%C9)
CALL CPG_SL1_2D_TYPE_SET (YDCPG_SL1F%SP9)
CALL CPG_SL1_2D_TYPE_SET (YDCPG_SL1F%SP0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%C0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%UP9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VP9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%TP9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%U9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%V9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%T9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%PD9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VD9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%C9_SI)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%UF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%TF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VDF9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%U9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%V9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%T9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%PD9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%VD9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%C9_NL)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%ZR9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%Z9)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%Z0)
CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%ZP9)

DO JGFL = 1, SIZE (YDCPG_SL1F%GFL)
  CALL CPG_SL1_3D_TYPE_SET (YDCPG_SL1F%GFL (JGFL))
ENDDO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1F_TYPE_SET_DEVICE_PARALLEL', 1, ZHOOK_HANDLE)

CONTAINS

SUBROUTINE CPG_SL1_2D_TYPE_SET (YDF2D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1F_2D_TYPE) :: YDF2D

REAL (KIND=JPRB), POINTER :: ZF (:)

INTEGER (KIND=JPIM) :: JROF

IF (ASSOCIATED (YDF2D%F_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF2D%F_P_F)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_F)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SPF)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_SPF)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF2D%F_P_SP)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_SP)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF2D%F_P_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF2D%F_P_P)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF

END SUBROUTINE

SUBROUTINE CPG_SL1_3D_TYPE_SET (YDF3D)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1F_3D_TYPE) :: YDF3D

REAL (KIND=JPRB), POINTER :: ZF (:,:)

IF (ASSOCIATED (YDF3D%F_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF3D%F_P_F)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_F)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SPF)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_SPF)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF3D%F_P_SP)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_SP)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF
IF (ASSOCIATED (YDF3D%F_P_P)) THEN
  ZF => GET_DEVICE_DATA_RDWR (YDF3D%F_P_P)
!$acc kernels present (ZF)
  ZF = PVALUE
!$acc end kernels
ENDIF

END SUBROUTINE

END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, YDCPG_SL1F)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT

CLASS (CPG_SL1B_TYPE)             :: YDCPG_SL1B
TYPE(SL_STRUCT)     ,INTENT(IN)   :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
CLASS (CPG_SL1F_TYPE)             :: YDCPG_SL1F

INTEGER (KIND=JPIM) :: JBLK, JFLD, JROF, JGFL
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE_DEVICE_PARALLEL', 0, ZHOOK_HANDLE)

CALL YLCPG_BNDS%INIT (YDCPG_OPTS)

CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%U9, YDCPG_SL1F%U9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%V9, YDCPG_SL1F%V9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%T9, YDCPG_SL1F%T9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%PD9, YDCPG_SL1F%PD9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VD9, YDCPG_SL1F%VD9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%NHX9, YDCPG_SL1F%NHX9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%UR0, YDCPG_SL1F%UR0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VR0, YDCPG_SL1F%VR0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%ZR0, YDCPG_SL1F%ZR0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%WR0, YDCPG_SL1F%WR0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%UR00, YDCPG_SL1F%UR00)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VR00, YDCPG_SL1F%VR00)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%ZR00, YDCPG_SL1F%ZR00)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%WR00, YDCPG_SL1F%WR00)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%WRA, YDCPG_SL1F%WRA)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%UR9, YDCPG_SL1F%UR9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VR9, YDCPG_SL1F%VR9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%DBBC9, YDCPG_SL1F%DBBC9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%DPHI9, YDCPG_SL1F%DPHI9)
CALL CPG_SL1_2D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%GWS9, YDCPG_SL1F%GWS9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%U0, YDCPG_SL1F%U0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%V0, YDCPG_SL1F%V0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%T0, YDCPG_SL1F%T0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%PD0, YDCPG_SL1F%PD0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VD0, YDCPG_SL1F%VD0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%C9, YDCPG_SL1F%C9)
CALL CPG_SL1_2D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%SP9, YDCPG_SL1F%SP9)
CALL CPG_SL1_2D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%SP0, YDCPG_SL1F%SP0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%C0, YDCPG_SL1F%C0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%UP9, YDCPG_SL1F%UP9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VP9, YDCPG_SL1F%VP9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%TP9, YDCPG_SL1F%TP9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%U9_SI, YDCPG_SL1F%U9_SI)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%V9_SI, YDCPG_SL1F%V9_SI)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%T9_SI, YDCPG_SL1F%T9_SI)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%PD9_SI, YDCPG_SL1F%PD9_SI)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VD9_SI, YDCPG_SL1F%VD9_SI)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%C9_SI, YDCPG_SL1F%C9_SI)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%UF9, YDCPG_SL1F%UF9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VF9, YDCPG_SL1F%VF9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%TF9, YDCPG_SL1F%TF9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VDF9, YDCPG_SL1F%VDF9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%U9_NL, YDCPG_SL1F%U9_NL)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%V9_NL, YDCPG_SL1F%V9_NL)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%T9_NL, YDCPG_SL1F%T9_NL)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%PD9_NL, YDCPG_SL1F%PD9_NL)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%VD9_NL, YDCPG_SL1F%VD9_NL)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%C9_NL, YDCPG_SL1F%C9_NL)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%ZR9, YDCPG_SL1F%ZR9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%Z9, YDCPG_SL1F%Z9)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%Z0, YDCPG_SL1F%Z0)
CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%ZP9, YDCPG_SL1F%ZP9)

DO JGFL = 1, SIZE (YDCPG_SL1F%GFL)
  CALL CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDCPG_SL1B%GFL (JGFL), YDCPG_SL1F%GFL (JGFL))
ENDDO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE_DEVICE_PARALLEL', 1, ZHOOK_HANDLE)

CONTAINS

SUBROUTINE CPG_SL1_2D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDF2DB, YDF2DF)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1B_2D_TYPE) :: YDF2DB
TYPE (CPG_SL1F_2D_TYPE) :: YDF2DF

REAL (KIND=JPRB), POINTER :: Z2DB (:,:), Z2DF (:)
INTEGER (KIND=JPIM) :: JBLK, JROF

IF (ASSOCIATED (YDF2DF%F_P)) THEN

  Z2DF => GET_DEVICE_DATA_RDWR   (YDF2DF%F_P)
  Z2DB => GET_DEVICE_DATA_RDONLY (YDF2DB%F_P)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z2DB, Z2DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      Z2DF(YDSL%NSLCORE(JROF))=Z2DB(JROF-YLCPG_BNDS%KSTGLO+1,JBLK)
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF2DF%F_P_F)) THEN

  Z2DF => GET_DEVICE_DATA_RDWR   (YDF2DF%F_P_F)
  Z2DB => GET_DEVICE_DATA_RDONLY (YDF2DB%F_P_F)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z2DB, Z2DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      Z2DF(YDSL%NSLCORE(JROF))=Z2DB(JROF-YLCPG_BNDS%KSTGLO+1,JBLK)
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF2DF%F_P_SPF)) THEN

  Z2DF => GET_DEVICE_DATA_RDWR   (YDF2DF%F_P_SPF)
  Z2DB => GET_DEVICE_DATA_RDONLY (YDF2DB%F_P_SPF)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z2DB, Z2DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      Z2DF(YDSL%NSLCORE(JROF))=Z2DB(JROF-YLCPG_BNDS%KSTGLO+1,JBLK)
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF2DF%F_P_SP)) THEN

  Z2DF => GET_DEVICE_DATA_RDWR   (YDF2DF%F_P_SP)
  Z2DB => GET_DEVICE_DATA_RDONLY (YDF2DB%F_P_SP)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z2DB, Z2DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      Z2DF(YDSL%NSLCORE(JROF))=Z2DB(JROF-YLCPG_BNDS%KSTGLO+1,JBLK)
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF2DF%F_P_P)) THEN

  Z2DF => GET_DEVICE_DATA_RDWR   (YDF2DF%F_P_P)
  Z2DB => GET_DEVICE_DATA_RDONLY (YDF2DB%F_P_P)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z2DB, Z2DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      Z2DF(YDSL%NSLCORE(JROF))=Z2DB(JROF-YLCPG_BNDS%KSTGLO+1,JBLK)
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF

END SUBROUTINE

SUBROUTINE CPG_SL1_3D_TYPE_SHUFFLE_DEVICE_PARALLEL (YDF3DB, YDF3DF)

USE FIELD_ACCESS_MODULE

TYPE (CPG_SL1B_3D_TYPE) :: YDF3DB
TYPE (CPG_SL1F_3D_TYPE) :: YDF3DF

REAL (KIND=JPRB), POINTER :: Z3DB (:,:,:), Z3DF (:,:)
INTEGER (KIND=JPIM) :: JBLK, JROF, JLEV

IF (ASSOCIATED (YDF3DF%F_P)) THEN

  Z3DF => GET_DEVICE_DATA_RDWR   (YDF3DF%F_P)
  Z3DB => GET_DEVICE_DATA_RDONLY (YDF3DB%F_P)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z3DB, Z3DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF, JLEV)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      DO JLEV = 0, YDCPG_OPTS%KFLEVG+1
        Z3DF(YDSL%NSLCORE(JROF),JLEV)=Z3DB(JROF-YLCPG_BNDS%KSTGLO+1,JLEV,JBLK)
      ENDDO
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF3DF%F_P_F)) THEN

  Z3DF => GET_DEVICE_DATA_RDWR   (YDF3DF%F_P_F)
  Z3DB => GET_DEVICE_DATA_RDONLY (YDF3DB%F_P_F)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z3DB, Z3DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF, JLEV)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      DO JLEV = 0, YDCPG_OPTS%KFLEVG+1
        Z3DF(YDSL%NSLCORE(JROF),JLEV)=Z3DB(JROF-YLCPG_BNDS%KSTGLO+1,JLEV,JBLK)
      ENDDO
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF3DF%F_P_SPF)) THEN

  Z3DF => GET_DEVICE_DATA_RDWR   (YDF3DF%F_P_SPF)
  Z3DB => GET_DEVICE_DATA_RDONLY (YDF3DB%F_P_SPF)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z3DB, Z3DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF, JLEV)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      DO JLEV = 0, YDCPG_OPTS%KFLEVG+1
        Z3DF(YDSL%NSLCORE(JROF),JLEV)=Z3DB(JROF-YLCPG_BNDS%KSTGLO+1,JLEV,JBLK)
      ENDDO
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF3DF%F_P_SP)) THEN

  Z3DF => GET_DEVICE_DATA_RDWR   (YDF3DF%F_P_SP)
  Z3DB => GET_DEVICE_DATA_RDONLY (YDF3DB%F_P_SP)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z3DB, Z3DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF, JLEV)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      DO JLEV = 0, YDCPG_OPTS%KFLEVG+1
        Z3DF(YDSL%NSLCORE(JROF),JLEV)=Z3DB(JROF-YLCPG_BNDS%KSTGLO+1,JLEV,JBLK)
      ENDDO
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF
IF (ASSOCIATED (YDF3DF%F_P_P)) THEN

  Z3DF => GET_DEVICE_DATA_RDWR   (YDF3DF%F_P_P)
  Z3DB => GET_DEVICE_DATA_RDONLY (YDF3DB%F_P_P)

!$acc parallel loop gang vector_length (YDCPG_OPTS%KLON) present (Z3DB, Z3DF, YDSL, YDCPG_OPTS) private (JBLK) firstprivate (YLCPG_BNDS)
  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    YLCPG_BNDS%KSTGLO = 1 + (JBLK - 1) * YLCPG_BNDS%KLON
    YLCPG_BNDS%KFDIA  = MIN (YLCPG_BNDS%KLON, YLCPG_BNDS%KGPCOMP - YLCPG_BNDS%KSTGLO + 1)
!$acc loop vector private (JROF, JLEV)
    DO JROF=YLCPG_BNDS%KSTGLO,YLCPG_BNDS%KSTGLO+YLCPG_BNDS%KFDIA-1
      DO JLEV = 0, YDCPG_OPTS%KFLEVG+1
        Z3DF(YDSL%NSLCORE(JROF),JLEV)=Z3DB(JROF-YLCPG_BNDS%KSTGLO+1,JLEV,JBLK)
      ENDDO
    ENDDO
  ENDDO
!$acc end parallel loop

ENDIF

END SUBROUTINE

END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE_HOST_PARALLEL (YDCPG_SL1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, YDCPG_SL1F)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT

CLASS (CPG_SL1B_TYPE)             :: YDCPG_SL1B
TYPE(SL_STRUCT)     ,INTENT(IN)   :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
CLASS (CPG_SL1F_TYPE)             :: YDCPG_SL1F

INTEGER (KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE_HOST_PARALLEL', 0, ZHOOK_HANDLE)

CALL YDCPG_SL1F%SYNC_HOST
CALL YDCPG_SL1B%SYNC_HOST

CALL YLCPG_BNDS%INIT (YDCPG_OPTS)

!$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)
DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

  CALL YLCPG_BNDS%UPDATE (JBLK)

  CALL CPG_SL1B_TYPE_SHUFFLE_PB1 (YDCPG_SL1B%ZDATA (:,:,JBLK), YDSL, YDCPG_OPTS, YLCPG_BNDS, YDCPG_SL1F%ZDATA (:,:))

ENDDO
!$OMP END PARALLEL DO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE_HOST_PARALLEL', 1, ZHOOK_HANDLE)

END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE (YDCPG_SL1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, YDCPG_SL1F)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT

CLASS (CPG_SL1B_TYPE)             :: YDCPG_SL1B
TYPE(SL_STRUCT)     ,INTENT(IN)   :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
CLASS (CPG_SL1F_TYPE)             :: YDCPG_SL1F

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE', 0, ZHOOK_HANDLE)

CALL CPG_SL1B_TYPE_SHUFFLE_PB1 (YDCPG_SL1B%ZVIEW, YDSL, YDCPG_OPTS, YDCPG_BNDS, YDCPG_SL1F%ZDATA)

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE', 1, ZHOOK_HANDLE)

END SUBROUTINE

SUBROUTINE CPG_SL1B_TYPE_SHUFFLE_PB1 (PB1B, YDSL, YDCPG_OPTS, YDCPG_BNDS, PB1F) 

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE EINT_MOD           , ONLY : SL_STRUCT

REAL (KIND=JPRB)    ,INTENT(IN)    :: PB1B (:,:)
TYPE(SL_STRUCT)     ,INTENT(IN)    :: YDSL
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)    :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)    :: YDCPG_BNDS
REAL (KIND=JPRB)    ,INTENT(INOUT) :: PB1F (:,:)

#ifdef __INTEL_COMPILER
INTEGER(KIND=JPIM), PARAMETER :: JPREFETCH = 8
#else
INTEGER(KIND=JPIM), PARAMETER :: JPREFETCH = 0
#endif

INTEGER (KIND=JPIM) :: JFLD, JROF, IFLDSLB1

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE_PB1', 0, ZHOOK_HANDLE)

IFLDSLB1 = SIZE (PB1B, 2)

#ifdef __INTEL_COMPILER
! optim: prefetch does not help on nslcore, prefer to prefetch 1 level
JFLD = MIN(IFLDSLB1,JPREFETCH)
DO JROF=YDCPG_BNDS%KSTGLO,YDCPG_BNDS%KSTGLO+YDCPG_BNDS%KFDIA-1,4
  CALL MM_PREFETCH(PB1F(YDSL%NSLCORE(JROF),JFLD),3)
ENDDO
#endif

DO JFLD=1,IFLDSLB1-JPREFETCH
  !DIR$ NEXTSCALAR
  !DIR$ IVDEP
  !DIR$ NOINTERCHANGE
  !DIR$ LOOP COUNT AVG(16)
  DO JROF=YDCPG_BNDS%KSTGLO,YDCPG_BNDS%KSTGLO+YDCPG_BNDS%KFDIA-1
#ifdef __INTEL_COMPILER
    ! Prefetch next field from PB1F to L2, same point
    CALL MM_PREFETCH(PB1F(YDSL%NSLCORE(JROF),JFLD+JPREFETCH),3)
#endif
    PB1F(YDSL%NSLCORE(JROF),JFLD)=PB1B(JROF-YDCPG_BNDS%KSTGLO+1,JFLD)
  ENDDO
ENDDO

DO JFLD=MAX(IFLDSLB1-JPREFETCH+1,1),IFLDSLB1
  !DIR$ IVDEP
  !DIR$ LOOP COUNT AVG(16)
  DO JROF=YDCPG_BNDS%KSTGLO,YDCPG_BNDS%KSTGLO+YDCPG_BNDS%KFDIA-1
    PB1F(YDSL%NSLCORE(JROF),JFLD)=PB1B(JROF-YDCPG_BNDS%KSTGLO+1,JFLD)
  ENDDO
ENDDO

IF (LHOOK) CALL DR_HOOK ('CPG_SL1B_TYPE_SHUFFLE', 1, ZHOOK_HANDLE)

END SUBROUTINE

END MODULE CPG_SL1_TYPE_MOD

