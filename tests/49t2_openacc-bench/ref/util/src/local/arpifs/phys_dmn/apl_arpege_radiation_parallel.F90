SUBROUTINE APL_ARPEGE_RADIATION_PARALLEL (YDMF_PHYS_BASE_STATE, YDCFU, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS&
&, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YD_PCLCT_RAD, YD_PALBDIR, YD_PDECRD&
&, YD_PAER, YD_PAERINDS, YD_PALBD, YD_PALBP, YD_PQCO2, YD_PCEMTR, YD_PCTRSO, YD_PFLU_EMIS, YD_PFLU_QSAT&
&, YD_PQO3, YD_PQR, YD_PQS, YD_PQV, YD_PRDG_MU0, YD_PRDG_SOLO, YD_PRDG_MU0LU, YD_PRDG_MU0M, YD_PSFSWDIF&
&, YD_PSFSWDIR, YD_PSUDU, YD_PTENT, YD_PTRSOD, YD_PTRSODIF, YD_PTRSODIR)
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK

USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE, CPG_GPAR_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE TYPE_MODEL,ONLY:MODEL
USE YOMCFU,ONLY:TCFU
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (TCFU), INTENT (IN)::YDCFU
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_GPAR_TYPE), INTENT (INOUT)::YDCPG_GPAR
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL), INTENT (IN)::YDMODEL
CLASS (FIELD_2RB), POINTER :: YD_PCLCT_RAD
REAL (KIND=JPRB), POINTER::PCLCT_RAD (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PALBDIR
REAL (KIND=JPRB), POINTER::PALBDIR (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDECRD
REAL (KIND=JPRB), POINTER::PDECRD (:,:)
CLASS (FIELD_4RB), POINTER :: YD_PAER
REAL (KIND=JPRB), POINTER::PAER (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAERINDS
REAL (KIND=JPRB), POINTER::PAERINDS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALBD
REAL (KIND=JPRB), POINTER::PALBD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALBP
REAL (KIND=JPRB), POINTER::PALBP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQCO2
REAL (KIND=JPRB), POINTER::PQCO2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCEMTR
REAL (KIND=JPRB), POINTER::PCEMTR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCTRSO
REAL (KIND=JPRB), POINTER::PCTRSO (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_EMIS
REAL (KIND=JPRB), POINTER::PFLU_EMIS (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFLU_QSAT
REAL (KIND=JPRB), POINTER::PFLU_QSAT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQO3
REAL (KIND=JPRB), POINTER::PQO3 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQR
REAL (KIND=JPRB), POINTER::PQR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQS
REAL (KIND=JPRB), POINTER::PQS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQV
REAL (KIND=JPRB), POINTER::PQV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PRDG_MU0
REAL (KIND=JPRB), POINTER::PRDG_MU0 (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PRDG_SOLO
REAL (KIND=JPRB), POINTER::PRDG_SOLO (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PRDG_MU0LU
REAL (KIND=JPRB), POINTER::PRDG_MU0LU (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PRDG_MU0M
REAL (KIND=JPRB), POINTER::PRDG_MU0M (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIF
REAL (KIND=JPRB), POINTER::PSFSWDIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIR
REAL (KIND=JPRB), POINTER::PSFSWDIR (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSUDU
REAL (KIND=JPRB), POINTER::PSUDU (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENT
REAL (KIND=JPRB), POINTER::PTENT (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PTRSOD
REAL (KIND=JPRB), POINTER::PTRSOD (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTRSODIF
REAL (KIND=JPRB), POINTER::PTRSODIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTRSODIR
REAL (KIND=JPRB), POINTER::PTRSODIR (:,:,:)
#include "acdayd.intfb.h"
#include "acdayd_openacc.intfb.h"
#include "acrso.intfb.h"
#include "acrso_openacc.intfb.h"
#include "radheat.intfb.h"
#include "radheat_openacc.intfb.h"
#include "recmwf_parallel.intfb.h"
#include "acraneb2.intfb.h"
#include "acraneb2_openacc.intfb.h"
#include "abor1.intfb.h"
CLASS (FIELD_4RB), POINTER :: YL_ZCGA_DST
REAL (KIND=JPRB), POINTER::ZCGA_DST (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZPIZA_DST
REAL (KIND=JPRB), POINTER::ZPIZA_DST (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZTAUREL_DST
REAL (KIND=JPRB), POINTER::ZTAUREL_DST (:,:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFRSODS
REAL (KIND=JPRB), POINTER::ZFRSODS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFSDNN
REAL (KIND=JPRB), POINTER::ZFSDNN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFSDNV
REAL (KIND=JPRB), POINTER::ZFSDNV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSDUR
REAL (KIND=JPRB), POINTER::ZSDUR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDSRP
REAL (KIND=JPRB), POINTER::ZDSRP (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZALB
REAL (KIND=JPRB), POINTER::ZALB (:,:)
INTEGER (KIND=JPIM), PARAMETER::IAERO=12
CLASS (FIELD_4RB), POINTER :: YL_ZAERO
REAL (KIND=JPRB), POINTER::ZAERO (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDUM
REAL (KIND=JPRB), POINTER::ZDUM (:,:,:)
CLASS (FIELD_5RB), POINTER :: YL_ZAEROCPL
REAL (KIND=JPRB), POINTER::ZAEROCPL (:,:,:,:,:)
LOGICAL::LLCALLRAD
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JSG
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_SWDIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GPAR_SWDIR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_NEB(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QICE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QLI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GDEOSI(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GDEOTI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GDEOTI2(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GEOLT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GEOXT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GFLUXC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GMIXP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GMU0(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GMU0_MAX(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GMU0_MIN(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GRPROX(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GRSURF(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GUEOSI(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GUEOTI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OPT_GUEOTI2(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_ALB(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSDNI(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSGNI(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSO(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSOC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSODS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSOLU(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSOPS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSOPT(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTH(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTHC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTHDS(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VD_PSUND(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GELAM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_RADIATION_EMTD_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_RADIATION_RMOON_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_RADIATION_TRSW_T0(:,:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZTAUREL_DST, UBOUNDS=[YDCPG_OPTS%KLON, 0, YDMODEL%YRML_PHY_RAD%YRERAD&
&%NSW, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSDUR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPIZA_DST, UBOUNDS=[YDCPG_OPTS%KLON, 0, YDMODEL%YRML_PHY_RAD%YRERAD%NSW&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFSDNV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFSDNN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFRSODS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDUM, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDSRP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCGA_DST, UBOUNDS=[YDCPG_OPTS%KLON, 0, YDMODEL%YRML_PHY_RAD%YRERAD%NSW&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZALB, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZAEROCPL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD&
&%YRERAD%NTLW, MERGE (6, 0, YDMODEL%YRML_PHY_RAD%YREAERATM%LAERRADCPL), YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZAERO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, IAERO, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)



IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAY.AND.YDMODEL%YRML_PHY_MF%YRPHY%NRAY==2) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDONLY (YD_PAER)
    PALBDIR => GET_HOST_DATA_RDONLY (YD_PALBDIR)
    PCLCT_RAD => GET_HOST_DATA_RDONLY (YD_PCLCT_RAD)
    PDECRD => GET_HOST_DATA_RDONLY (YD_PDECRD)
    PFLU_EMIS => GET_HOST_DATA_RDONLY (YD_PFLU_EMIS)
    PQCO2 => GET_HOST_DATA_RDONLY (YD_PQCO2)
    PQO3 => GET_HOST_DATA_RDONLY (YD_PQO3)
    PQV => GET_HOST_DATA_RDONLY (YD_PQV)
    PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
    PRDG_MU0LU => GET_HOST_DATA_RDONLY (YD_PRDG_MU0LU)
    ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OPT_GDEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOSI)
    Z_YDMF_PHYS_OPT_GDEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI)
    Z_YDMF_PHYS_OPT_GDEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI2)
    Z_YDMF_PHYS_OPT_GEOLT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOLT)
    Z_YDMF_PHYS_OPT_GEOXT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOXT)
    Z_YDMF_PHYS_OPT_GFLUXC => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GFLUXC)
    Z_YDMF_PHYS_OPT_GMIXP => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMIXP)
    Z_YDMF_PHYS_OPT_GMU0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0)
    Z_YDMF_PHYS_OPT_GMU0_MAX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MAX)
    Z_YDMF_PHYS_OPT_GMU0_MIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MIN)
    Z_YDMF_PHYS_OPT_GRPROX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRPROX)
    Z_YDMF_PHYS_OPT_GRSURF => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRSURF)
    Z_YDMF_PHYS_OPT_GUEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOSI)
    Z_YDMF_PHYS_OPT_GUEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI)
    Z_YDMF_PHYS_OPT_GUEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI2)
    Z_YDMF_PHYS_OUT_ALB => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_ALB)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
    Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL ACRANEB2 (YDMODEL%YRCST, YDMODEL%YRML_PHY_RAD%YRERDI, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF&
      &, YDCPG_OPTS%LCONFX, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH&
      &%NTRADI, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KLON, YDCPG_OPTS%NSTEP, YDCFU%NFRRC, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), PQV(:,:, JBLK), PQCO2(:,:, JBLK), Z_YDCPG_MISC_QICE(:,&
      &:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), PQO3(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_OUT_ALB&
      &(:, JBLK), PALBDIR(:, JBLK), PFLU_EMIS(:, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0&
      &(:, JBLK), PRDG_MU0(:, JBLK), PRDG_MU0LU(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), PDECRD&
      &(:, JBLK), PCLCT_RAD(:, JBLK), Z_YDMF_PHYS_OPT_GDEOSI(:,:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOSI(:,:,:&
      &, JBLK), Z_YDMF_PHYS_OPT_GMU0(:,:, JBLK), Z_YDMF_PHYS_OPT_GMU0_MIN(:, JBLK), Z_YDMF_PHYS_OPT_GMU0_MAX&
      &(:, JBLK), Z_YDMF_PHYS_OPT_GDEOTI(:,:, JBLK), Z_YDMF_PHYS_OPT_GDEOTI2(:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOTI&
      &(:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOTI2(:,:, JBLK), Z_YDMF_PHYS_OPT_GEOLT(:,:, JBLK), Z_YDMF_PHYS_OPT_GEOXT&
      &(:,:, JBLK), Z_YDMF_PHYS_OPT_GRPROX(:,:, JBLK), Z_YDMF_PHYS_OPT_GMIXP(:,:, JBLK), Z_YDMF_PHYS_OPT_GFLUXC&
      &(:,:, JBLK), Z_YDMF_PHYS_OPT_GRSURF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VD_PSUND(:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRSOC(:,:, JBLK), Z_YDMF_PHYS_OUT_FRTHC&
      &(:,:, JBLK), ZFRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOPS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOLU(:, JBLK),&
      & Z_YDMF_PHYS_OUT_FRTHDS(:, JBLK), PAER(:,:,:, JBLK))

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)=ZFRSODS (JLON, JBLK)+Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PAER => GET_HOST_DATA_RDWR (YD_PAER)
      PALBDIR => GET_HOST_DATA_RDWR (YD_PALBDIR)
      PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
      PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PQCO2 => GET_HOST_DATA_RDWR (YD_PQCO2)
      PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
      PRDG_MU0LU => GET_HOST_DATA_RDWR (YD_PRDG_MU0LU)
      ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OPT_GDEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOSI)
      Z_YDMF_PHYS_OPT_GDEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI)
      Z_YDMF_PHYS_OPT_GDEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI2)
      Z_YDMF_PHYS_OPT_GEOLT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOLT)
      Z_YDMF_PHYS_OPT_GEOXT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOXT)
      Z_YDMF_PHYS_OPT_GFLUXC => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GFLUXC)
      Z_YDMF_PHYS_OPT_GMIXP => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMIXP)
      Z_YDMF_PHYS_OPT_GMU0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0)
      Z_YDMF_PHYS_OPT_GMU0_MAX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MAX)
      Z_YDMF_PHYS_OPT_GMU0_MIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MIN)
      Z_YDMF_PHYS_OPT_GRPROX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRPROX)
      Z_YDMF_PHYS_OPT_GRSURF => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRSURF)
      Z_YDMF_PHYS_OPT_GUEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOSI)
      Z_YDMF_PHYS_OPT_GUEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI)
      Z_YDMF_PHYS_OPT_GUEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI2)
      Z_YDMF_PHYS_OUT_ALB => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_ALB)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
      Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PAER => NULL ()
    PALBDIR => NULL ()
    PCLCT_RAD => NULL ()
    PDECRD => NULL ()
    PFLU_EMIS => NULL ()
    PQCO2 => NULL ()
    PQO3 => NULL ()
    PQV => NULL ()
    PRDG_MU0 => NULL ()
    PRDG_MU0LU => NULL ()
    ZFRSODS => NULL ()
    Z_YDCPG_MISC_NEB => NULL ()
    Z_YDCPG_MISC_QICE => NULL ()
    Z_YDCPG_MISC_QLI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OPT_GDEOSI => NULL ()
    Z_YDMF_PHYS_OPT_GDEOTI => NULL ()
    Z_YDMF_PHYS_OPT_GDEOTI2 => NULL ()
    Z_YDMF_PHYS_OPT_GEOLT => NULL ()
    Z_YDMF_PHYS_OPT_GEOXT => NULL ()
    Z_YDMF_PHYS_OPT_GFLUXC => NULL ()
    Z_YDMF_PHYS_OPT_GMIXP => NULL ()
    Z_YDMF_PHYS_OPT_GMU0 => NULL ()
    Z_YDMF_PHYS_OPT_GMU0_MAX => NULL ()
    Z_YDMF_PHYS_OPT_GMU0_MIN => NULL ()
    Z_YDMF_PHYS_OPT_GRPROX => NULL ()
    Z_YDMF_PHYS_OPT_GRSURF => NULL ()
    Z_YDMF_PHYS_OPT_GUEOSI => NULL ()
    Z_YDMF_PHYS_OPT_GUEOTI => NULL ()
    Z_YDMF_PHYS_OPT_GUEOTI2 => NULL ()
    Z_YDMF_PHYS_OUT_ALB => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRSOC => NULL ()
    Z_YDMF_PHYS_OUT_FRSODS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOLU => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FRTHC => NULL ()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VD_PSUND => NULL ()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
    &','APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDONLY (YD_PAER)
    PALBDIR => GET_HOST_DATA_RDONLY (YD_PALBDIR)
    PCLCT_RAD => GET_HOST_DATA_RDONLY (YD_PCLCT_RAD)
    PDECRD => GET_HOST_DATA_RDONLY (YD_PDECRD)
    PFLU_EMIS => GET_HOST_DATA_RDONLY (YD_PFLU_EMIS)
    PQCO2 => GET_HOST_DATA_RDONLY (YD_PQCO2)
    PQO3 => GET_HOST_DATA_RDONLY (YD_PQO3)
    PQV => GET_HOST_DATA_RDONLY (YD_PQV)
    PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
    PRDG_MU0LU => GET_HOST_DATA_RDONLY (YD_PRDG_MU0LU)
    ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OPT_GDEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOSI)
    Z_YDMF_PHYS_OPT_GDEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI)
    Z_YDMF_PHYS_OPT_GDEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI2)
    Z_YDMF_PHYS_OPT_GEOLT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOLT)
    Z_YDMF_PHYS_OPT_GEOXT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOXT)
    Z_YDMF_PHYS_OPT_GFLUXC => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GFLUXC)
    Z_YDMF_PHYS_OPT_GMIXP => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMIXP)
    Z_YDMF_PHYS_OPT_GMU0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0)
    Z_YDMF_PHYS_OPT_GMU0_MAX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MAX)
    Z_YDMF_PHYS_OPT_GMU0_MIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MIN)
    Z_YDMF_PHYS_OPT_GRPROX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRPROX)
    Z_YDMF_PHYS_OPT_GRSURF => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRSURF)
    Z_YDMF_PHYS_OPT_GUEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOSI)
    Z_YDMF_PHYS_OPT_GUEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI)
    Z_YDMF_PHYS_OPT_GUEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI2)
    Z_YDMF_PHYS_OUT_ALB => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_ALB)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
    Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACRANEB2_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_RAD%YRERDI, YDMODEL%YRML_GCONF%YRRIP, YDMODEL&
        &%YRML_PHY_MF, YDCPG_OPTS%LCONFX, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF&
        &%YRTOPH%NTRADI, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KLON, YDCPG_OPTS%NSTEP, YDCFU%NFRRC, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
        &(:,:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), PQV(:,:, JBLK), PQCO2(:,:, JBLK), Z_YDCPG_MISC_QICE(:,:&
        &, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), PQO3(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_OUT_ALB&
        &(:, JBLK), PALBDIR(:, JBLK), PFLU_EMIS(:, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0&
        &(:, JBLK), PRDG_MU0(:, JBLK), PRDG_MU0LU(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), PDECRD&
        &(:, JBLK), PCLCT_RAD(:, JBLK), Z_YDMF_PHYS_OPT_GDEOSI(:,:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOSI(:,:,:,&
        & JBLK), Z_YDMF_PHYS_OPT_GMU0(:,:, JBLK), Z_YDMF_PHYS_OPT_GMU0_MIN(:, JBLK), Z_YDMF_PHYS_OPT_GMU0_MAX&
        &(:, JBLK), Z_YDMF_PHYS_OPT_GDEOTI(:,:, JBLK), Z_YDMF_PHYS_OPT_GDEOTI2(:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOTI&
        &(:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOTI2(:,:, JBLK), Z_YDMF_PHYS_OPT_GEOLT(:,:, JBLK), Z_YDMF_PHYS_OPT_GEOXT&
        &(:,:, JBLK), Z_YDMF_PHYS_OPT_GRPROX(:,:, JBLK), Z_YDMF_PHYS_OPT_GMIXP(:,:, JBLK), Z_YDMF_PHYS_OPT_GFLUXC&
        &(:,:, JBLK), Z_YDMF_PHYS_OPT_GRSURF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VD_PSUND(:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
        &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRSOC(:,:, JBLK), Z_YDMF_PHYS_OUT_FRTHC&
        &(:,:, JBLK), ZFRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOPS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOLU(:, JBLK), Z_YDMF_PHYS_OUT_FRTHDS&
        &(:, JBLK), PAER(:,:,:, JBLK),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)=ZFRSODS (JLON, JBLK)+Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PAER => GET_HOST_DATA_RDWR (YD_PAER)
      PALBDIR => GET_HOST_DATA_RDWR (YD_PALBDIR)
      PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
      PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PQCO2 => GET_HOST_DATA_RDWR (YD_PQCO2)
      PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
      PRDG_MU0LU => GET_HOST_DATA_RDWR (YD_PRDG_MU0LU)
      ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OPT_GDEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOSI)
      Z_YDMF_PHYS_OPT_GDEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI)
      Z_YDMF_PHYS_OPT_GDEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI2)
      Z_YDMF_PHYS_OPT_GEOLT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOLT)
      Z_YDMF_PHYS_OPT_GEOXT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOXT)
      Z_YDMF_PHYS_OPT_GFLUXC => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GFLUXC)
      Z_YDMF_PHYS_OPT_GMIXP => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMIXP)
      Z_YDMF_PHYS_OPT_GMU0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0)
      Z_YDMF_PHYS_OPT_GMU0_MAX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MAX)
      Z_YDMF_PHYS_OPT_GMU0_MIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MIN)
      Z_YDMF_PHYS_OPT_GRPROX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRPROX)
      Z_YDMF_PHYS_OPT_GRSURF => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRSURF)
      Z_YDMF_PHYS_OPT_GUEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOSI)
      Z_YDMF_PHYS_OPT_GUEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI)
      Z_YDMF_PHYS_OPT_GUEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI2)
      Z_YDMF_PHYS_OUT_ALB => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_ALB)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
      Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PAER => NULL ()
    PALBDIR => NULL ()
    PCLCT_RAD => NULL ()
    PDECRD => NULL ()
    PFLU_EMIS => NULL ()
    PQCO2 => NULL ()
    PQO3 => NULL ()
    PQV => NULL ()
    PRDG_MU0 => NULL ()
    PRDG_MU0LU => NULL ()
    ZFRSODS => NULL ()
    Z_YDCPG_MISC_NEB => NULL ()
    Z_YDCPG_MISC_QICE => NULL ()
    Z_YDCPG_MISC_QLI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OPT_GDEOSI => NULL ()
    Z_YDMF_PHYS_OPT_GDEOTI => NULL ()
    Z_YDMF_PHYS_OPT_GDEOTI2 => NULL ()
    Z_YDMF_PHYS_OPT_GEOLT => NULL ()
    Z_YDMF_PHYS_OPT_GEOXT => NULL ()
    Z_YDMF_PHYS_OPT_GFLUXC => NULL ()
    Z_YDMF_PHYS_OPT_GMIXP => NULL ()
    Z_YDMF_PHYS_OPT_GMU0 => NULL ()
    Z_YDMF_PHYS_OPT_GMU0_MAX => NULL ()
    Z_YDMF_PHYS_OPT_GMU0_MIN => NULL ()
    Z_YDMF_PHYS_OPT_GRPROX => NULL ()
    Z_YDMF_PHYS_OPT_GRSURF => NULL ()
    Z_YDMF_PHYS_OPT_GUEOSI => NULL ()
    Z_YDMF_PHYS_OPT_GUEOTI => NULL ()
    Z_YDMF_PHYS_OPT_GUEOTI2 => NULL ()
    Z_YDMF_PHYS_OUT_ALB => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRSOC => NULL ()
    Z_YDMF_PHYS_OUT_FRSODS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOLU => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FRTHC => NULL ()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VD_PSUND => NULL ()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_DEVICE_DATA_RDONLY (YD_PAER)
    PALBDIR => GET_DEVICE_DATA_RDONLY (YD_PALBDIR)
    PCLCT_RAD => GET_DEVICE_DATA_RDONLY (YD_PCLCT_RAD)
    PDECRD => GET_DEVICE_DATA_RDONLY (YD_PDECRD)
    PFLU_EMIS => GET_DEVICE_DATA_RDONLY (YD_PFLU_EMIS)
    PQCO2 => GET_DEVICE_DATA_RDONLY (YD_PQCO2)
    PQO3 => GET_DEVICE_DATA_RDONLY (YD_PQO3)
    PQV => GET_DEVICE_DATA_RDONLY (YD_PQV)
    PRDG_MU0 => GET_DEVICE_DATA_RDONLY (YD_PRDG_MU0)
    PRDG_MU0LU => GET_DEVICE_DATA_RDONLY (YD_PRDG_MU0LU)
    ZFRSODS => GET_DEVICE_DATA_RDWR (YL_ZFRSODS)
    Z_YDCPG_MISC_NEB => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OPT_GDEOSI => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOSI)
    Z_YDMF_PHYS_OPT_GDEOTI => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI)
    Z_YDMF_PHYS_OPT_GDEOTI2 => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI2)
    Z_YDMF_PHYS_OPT_GEOLT => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GEOLT)
    Z_YDMF_PHYS_OPT_GEOXT => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GEOXT)
    Z_YDMF_PHYS_OPT_GFLUXC => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GFLUXC)
    Z_YDMF_PHYS_OPT_GMIXP => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GMIXP)
    Z_YDMF_PHYS_OPT_GMU0 => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0)
    Z_YDMF_PHYS_OPT_GMU0_MAX => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MAX)
    Z_YDMF_PHYS_OPT_GMU0_MIN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MIN)
    Z_YDMF_PHYS_OPT_GRPROX => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GRPROX)
    Z_YDMF_PHYS_OPT_GRSURF => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GRSURF)
    Z_YDMF_PHYS_OPT_GUEOSI => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOSI)
    Z_YDMF_PHYS_OPT_GUEOTI => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI)
    Z_YDMF_PHYS_OPT_GUEOTI2 => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI2)
    Z_YDMF_PHYS_OUT_ALB => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_ALB)
    Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSOC => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
    Z_YDMF_PHYS_OUT_FRSODS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOLU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    Z_YDMF_PHYS_OUT_FRTH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHC => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (PAER, PALBDIR, PCLCT_RAD, PDECRD, PFLU_EMIS, PQCO2, PQO3, PQV, PRDG_MU0, &
      !$ACC&         PRDG_MU0LU, YDCFU, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZFRSODS, &
      !$ACC&         Z_YDCPG_MISC_NEB, Z_YDCPG_MISC_QICE, Z_YDCPG_MISC_QLI, Z_YDMF_PHYS_BASE_STATE_T, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, &
      !$ACC&         Z_YDMF_PHYS_OPT_GDEOSI, Z_YDMF_PHYS_OPT_GDEOTI, Z_YDMF_PHYS_OPT_GDEOTI2, &
      !$ACC&         Z_YDMF_PHYS_OPT_GEOLT, Z_YDMF_PHYS_OPT_GEOXT, Z_YDMF_PHYS_OPT_GFLUXC, &
      !$ACC&         Z_YDMF_PHYS_OPT_GMIXP, Z_YDMF_PHYS_OPT_GMU0, Z_YDMF_PHYS_OPT_GMU0_MAX, &
      !$ACC&         Z_YDMF_PHYS_OPT_GMU0_MIN, Z_YDMF_PHYS_OPT_GRPROX, Z_YDMF_PHYS_OPT_GRSURF, &
      !$ACC&         Z_YDMF_PHYS_OPT_GUEOSI, Z_YDMF_PHYS_OPT_GUEOTI, Z_YDMF_PHYS_OPT_GUEOTI2, &
      !$ACC&         Z_YDMF_PHYS_OUT_ALB, Z_YDMF_PHYS_OUT_FRSO, Z_YDMF_PHYS_OUT_FRSOC, &
      !$ACC&         Z_YDMF_PHYS_OUT_FRSODS, Z_YDMF_PHYS_OUT_FRSOLU, Z_YDMF_PHYS_OUT_FRSOPS, &
      !$ACC&         Z_YDMF_PHYS_OUT_FRTH, Z_YDMF_PHYS_OUT_FRTHC, Z_YDMF_PHYS_OUT_FRTHDS, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VD_PSUND, Z_YDVARS_GEOMETRY_GELAM_T0, &
      !$ACC&         Z_YDVARS_GEOMETRY_GEMU_T0) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACRANEB2_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_RAD%YRERDI, YDMODEL%YRML_GCONF%YRRIP, YDMODEL&
        &%YRML_PHY_MF, YDCPG_OPTS%LCONFX, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF&
        &%YRTOPH%NTRADI, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KLON, YDCPG_OPTS%NSTEP, YDCFU%NFRRC, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
        &(:,:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), PQV(:,:, JBLK), PQCO2(:,:, JBLK), Z_YDCPG_MISC_QICE(:,:&
        &, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), PQO3(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_OUT_ALB&
        &(:, JBLK), PALBDIR(:, JBLK), PFLU_EMIS(:, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0&
        &(:, JBLK), PRDG_MU0(:, JBLK), PRDG_MU0LU(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), PDECRD&
        &(:, JBLK), PCLCT_RAD(:, JBLK), Z_YDMF_PHYS_OPT_GDEOSI(:,:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOSI(:,:,:,&
        & JBLK), Z_YDMF_PHYS_OPT_GMU0(:,:, JBLK), Z_YDMF_PHYS_OPT_GMU0_MIN(:, JBLK), Z_YDMF_PHYS_OPT_GMU0_MAX&
        &(:, JBLK), Z_YDMF_PHYS_OPT_GDEOTI(:,:, JBLK), Z_YDMF_PHYS_OPT_GDEOTI2(:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOTI&
        &(:,:, JBLK), Z_YDMF_PHYS_OPT_GUEOTI2(:,:, JBLK), Z_YDMF_PHYS_OPT_GEOLT(:,:, JBLK), Z_YDMF_PHYS_OPT_GEOXT&
        &(:,:, JBLK), Z_YDMF_PHYS_OPT_GRPROX(:,:, JBLK), Z_YDMF_PHYS_OPT_GMIXP(:,:, JBLK), Z_YDMF_PHYS_OPT_GFLUXC&
        &(:,:, JBLK), Z_YDMF_PHYS_OPT_GRSURF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VD_PSUND(:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
        &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRSOC(:,:, JBLK), Z_YDMF_PHYS_OUT_FRTHC&
        &(:,:, JBLK), ZFRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOPS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOLU(:, JBLK), Z_YDMF_PHYS_OUT_FRTHDS&
        &(:, JBLK), PAER(:,:,:, JBLK),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)=ZFRSODS (JLON, JBLK)+Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PAER => GET_HOST_DATA_RDWR (YD_PAER)
      PALBDIR => GET_HOST_DATA_RDWR (YD_PALBDIR)
      PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
      PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PQCO2 => GET_HOST_DATA_RDWR (YD_PQCO2)
      PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
      PRDG_MU0LU => GET_HOST_DATA_RDWR (YD_PRDG_MU0LU)
      ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
      Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
      Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
      Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OPT_GDEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOSI)
      Z_YDMF_PHYS_OPT_GDEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI)
      Z_YDMF_PHYS_OPT_GDEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GDEOTI2)
      Z_YDMF_PHYS_OPT_GEOLT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOLT)
      Z_YDMF_PHYS_OPT_GEOXT => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GEOXT)
      Z_YDMF_PHYS_OPT_GFLUXC => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GFLUXC)
      Z_YDMF_PHYS_OPT_GMIXP => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMIXP)
      Z_YDMF_PHYS_OPT_GMU0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0)
      Z_YDMF_PHYS_OPT_GMU0_MAX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MAX)
      Z_YDMF_PHYS_OPT_GMU0_MIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GMU0_MIN)
      Z_YDMF_PHYS_OPT_GRPROX => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRPROX)
      Z_YDMF_PHYS_OPT_GRSURF => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GRSURF)
      Z_YDMF_PHYS_OPT_GUEOSI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOSI)
      Z_YDMF_PHYS_OPT_GUEOTI => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI)
      Z_YDMF_PHYS_OPT_GUEOTI2 => GET_HOST_DATA_RDWR (YDMF_PHYS%OPT%F_GUEOTI2)
      Z_YDMF_PHYS_OUT_ALB => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_ALB)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
      Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PAER => NULL ()
    PALBDIR => NULL ()
    PCLCT_RAD => NULL ()
    PDECRD => NULL ()
    PFLU_EMIS => NULL ()
    PQCO2 => NULL ()
    PQO3 => NULL ()
    PQV => NULL ()
    PRDG_MU0 => NULL ()
    PRDG_MU0LU => NULL ()
    ZFRSODS => NULL ()
    Z_YDCPG_MISC_NEB => NULL ()
    Z_YDCPG_MISC_QICE => NULL ()
    Z_YDCPG_MISC_QLI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OPT_GDEOSI => NULL ()
    Z_YDMF_PHYS_OPT_GDEOTI => NULL ()
    Z_YDMF_PHYS_OPT_GDEOTI2 => NULL ()
    Z_YDMF_PHYS_OPT_GEOLT => NULL ()
    Z_YDMF_PHYS_OPT_GEOXT => NULL ()
    Z_YDMF_PHYS_OPT_GFLUXC => NULL ()
    Z_YDMF_PHYS_OPT_GMIXP => NULL ()
    Z_YDMF_PHYS_OPT_GMU0 => NULL ()
    Z_YDMF_PHYS_OPT_GMU0_MAX => NULL ()
    Z_YDMF_PHYS_OPT_GMU0_MIN => NULL ()
    Z_YDMF_PHYS_OPT_GRPROX => NULL ()
    Z_YDMF_PHYS_OPT_GRSURF => NULL ()
    Z_YDMF_PHYS_OPT_GUEOSI => NULL ()
    Z_YDMF_PHYS_OPT_GUEOTI => NULL ()
    Z_YDMF_PHYS_OPT_GUEOTI2 => NULL ()
    Z_YDMF_PHYS_OUT_ALB => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRSOC => NULL ()
    Z_YDMF_PHYS_OUT_FRSODS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOLU => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FRTHC => NULL ()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VD_PSUND => NULL ()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRANEB2',1,ZHOOK_HANDLE_PARALLEL)
ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LRAYFM) THEN
  LLCALLRAD=(MOD (YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_RAD%YRERAD%NRADFR)==0)

  IF (YDMODEL%YRML_PHY_MF%YRPHY%NCALLRAD==2)  THEN
    LLCALLRAD=(LLCALLRAD.AND.(YDCPG_OPTS%NSTEP<=YDMODEL%YRML_GCONF%YRRIP%NSTOP-1))
  ENDIF


  IF (LLCALLRAD) THEN
    CALL RECMWF_PARALLEL (YDGEOMETRY%YRDIMV, YDMODEL, YDCPG_OPTS, YDCPG_BNDS, YDMODEL%YRML_PHY_RAD&
    &%YRERAD%NOZOCL, YDMODEL%YRML_PHY_RAD%YRERAD%NAERMACC, IAERO, YD_PALBD, YD_PALBP, YDMF_PHYS_BASE_STATE&
    &%YCPG_PHY%F_PREHYD, YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF, YDCPG_MISC%F_NEB, YD_PQO3, YL_ZDUM&
    &, YL_ZDUM, YL_ZDUM, YL_ZDUM, YL_ZDUM, YL_ZDUM, YL_ZDUM, YL_ZDUM, YD_PAER, YL_ZAERO, YL_ZAEROCPL&
    &, YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP, YD_PFLU_EMIS, YD_PRDG_MU0M, YD_PQV, YD_PFLU_QSAT,&
    & YDCPG_MISC%F_QICE, YDCPG_MISC%F_QLI, YD_PQS, YD_PQR, YDMF_PHYS_SURF%GSD_VF%F_LSM, YDMF_PHYS_BASE_STATE&
    &%F_T, YDMF_PHYS_BASE_STATE%YGSP_RR%F_T, YDVARS%RADIATION%EMTD%FT0, YDVARS%RADIATION%EMTU%FT0,&
    & YDVARS%RADIATION%TRSW%FT0, YDMF_PHYS%OUT%F_FRTHC, YDMF_PHYS%OUT%F_FRTH, YDMF_PHYS%OUT%F_FRSOC&
    &, YDMF_PHYS%OUT%F_FRSO, YD_PSFSWDIR, YD_PSFSWDIF, YL_ZFSDNN, YL_ZFSDNV, YD_PCTRSO, YD_PCEMTR,&
    & YD_PTRSOD, YD_PTRSODIR, YD_PTRSODIF, YL_ZPIZA_DST, YL_ZCGA_DST, YL_ZTAUREL_DST, YD_PAERINDS,&
    & YDVARS%GEOMETRY%GELAM%FT0, YDVARS%GEOMETRY%GEMU%FT0, YDCPG_GPAR%F_SWDIR, YDCPG_GPAR%F_SWDIF,&
    & YD_PRDG_MU0LU, YDMF_PHYS%OUT%F_ALB, YDVARS%RADIATION%RMOON%FT0)
  ELSE
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
      &:CALLRAD_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
      PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
      Z_YDCPG_GPAR_SWDIF => GET_HOST_DATA_RDONLY (YDCPG_GPAR%F_SWDIF)
      Z_YDCPG_GPAR_SWDIR => GET_HOST_DATA_RDONLY (YDCPG_GPAR%F_SWDIR)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
      &:CALLRAD_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, JSG) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN

          DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW

            DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              PTRSODIR (JLON, JSG, JBLK)=Z_YDCPG_GPAR_SWDIR (JLON, JSG, JBLK)
              PTRSODIF (JLON, JSG, JBLK)=Z_YDCPG_GPAR_SWDIF (JLON, JSG, JBLK)
            ENDDO

          ENDDO

        ENDIF

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
        &:CALLRAD_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
        PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
        Z_YDCPG_GPAR_SWDIF => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_SWDIF)
        Z_YDCPG_GPAR_SWDIR => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_SWDIR)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
        &:CALLRAD_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PTRSODIF => NULL ()
      PTRSODIR => NULL ()
      Z_YDCPG_GPAR_SWDIF => NULL ()
      Z_YDCPG_GPAR_SWDIR => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
      &:CALLRAD_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
      PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
      Z_YDCPG_GPAR_SWDIF => GET_HOST_DATA_RDONLY (YDCPG_GPAR%F_SWDIF)
      Z_YDCPG_GPAR_SWDIR => GET_HOST_DATA_RDONLY (YDCPG_GPAR%F_SWDIR)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
      &:CALLRAD_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, JSG, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON

          

          IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN

            DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
              
              PTRSODIR (JLON, JSG, JBLK)=Z_YDCPG_GPAR_SWDIR (JLON, JSG, JBLK)
              PTRSODIF (JLON, JSG, JBLK)=Z_YDCPG_GPAR_SWDIF (JLON, JSG, JBLK)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
        &:CALLRAD_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
        PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
        Z_YDCPG_GPAR_SWDIF => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_SWDIF)
        Z_YDCPG_GPAR_SWDIR => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_SWDIR)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
        &:CALLRAD_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PTRSODIF => NULL ()
      PTRSODIR => NULL ()
      Z_YDCPG_GPAR_SWDIF => NULL ()
      Z_YDCPG_GPAR_SWDIR => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
      &:CALLRAD_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PTRSODIF => GET_DEVICE_DATA_RDWR (YD_PTRSODIF)
      PTRSODIR => GET_DEVICE_DATA_RDWR (YD_PTRSODIR)
      Z_YDCPG_GPAR_SWDIF => GET_DEVICE_DATA_RDONLY (YDCPG_GPAR%F_SWDIF)
      Z_YDCPG_GPAR_SWDIR => GET_DEVICE_DATA_RDONLY (YDCPG_GPAR%F_SWDIR)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
      &:CALLRAD_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (PTRSODIF, PTRSODIR, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, &
        !$ACC&         Z_YDCPG_GPAR_SWDIF, Z_YDCPG_GPAR_SWDIR) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLON, JSG, YLCPG_BNDS) 

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON

          

          IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN

            DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
              
              PTRSODIR (JLON, JSG, JBLK)=Z_YDCPG_GPAR_SWDIR (JLON, JSG, JBLK)
              PTRSODIF (JLON, JSG, JBLK)=Z_YDCPG_GPAR_SWDIF (JLON, JSG, JBLK)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
        &:CALLRAD_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
        PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
        Z_YDCPG_GPAR_SWDIF => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_SWDIF)
        Z_YDCPG_GPAR_SWDIR => GET_HOST_DATA_RDWR (YDCPG_GPAR%F_SWDIR)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL&
        &:CALLRAD_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PTRSODIF => NULL ()
      PTRSODIR => NULL ()
      Z_YDCPG_GPAR_SWDIF => NULL ()
      Z_YDCPG_GPAR_SWDIR => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:CALLRAD_F',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:RADHEAT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
    PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
    PCEMTR => GET_HOST_DATA_RDONLY (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDONLY (YD_PCTRSO)
    PFLU_EMIS => GET_HOST_DATA_RDONLY (YD_PFLU_EMIS)
    PQV => GET_HOST_DATA_RDONLY (YD_PQV)
    PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
    PRDG_SOLO => GET_HOST_DATA_RDONLY (YD_PRDG_SOLO)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSUDU => GET_HOST_DATA_RDONLY (YD_PSUDU)
    PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
    PTRSOD => GET_HOST_DATA_RDONLY (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDONLY (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDONLY (YD_PTRSODIR)
    ZDSRP => GET_HOST_DATA_RDWR (YL_ZDSRP)
    ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
    ZSDUR => GET_HOST_DATA_RDWR (YL_ZSDUR)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
    Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    Z_YDVARS_RADIATION_EMTD_T0 => GET_HOST_DATA_RDONLY (YDVARS%RADIATION%EMTD%FT0)
    Z_YDVARS_RADIATION_RMOON_T0 => GET_HOST_DATA_RDONLY (YDVARS%RADIATION%RMOON%FT0)
    Z_YDVARS_RADIATION_TRSW_T0 => GET_HOST_DATA_RDONLY (YDVARS%RADIATION%TRSW%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      Z_YDMF_PHYS_OUT_FRSOLU (:, JBLK)=Z_YDVARS_RADIATION_RMOON_T0 (:, JBLK)
      CALL RADHEAT (YDMODEL%YRCST, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL%YRML_PHY_RAD%YRERAD, YDMODEL%YRML_PHY_RAD&
      &%YRERDI, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS&
      &%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), PFLU_EMIS(:, JBLK), Z_YDVARS_RADIATION_EMTD_T0&
      &(:,:, JBLK), PRDG_MU0(:, JBLK), PRDG_SOLO(:, JBLK), PQV(:,:, JBLK), PTENT(:,:, JBLK), Z_YDVARS_RADIATION_TRSW_T0&
      &(:,:, JBLK), PTRSOD(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), YDMODEL%YRML_PHY_MF%YRPHY2&
      &%TSPHY, PTRSODIR(:,:, JBLK), PTRSODIF(:,:, JBLK), PALBD(:,:, JBLK), PALBP(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRTHDS&
      &(:, JBLK), PCEMTR(:,:, JBLK), PCTRSO(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSOC(:,:, JBLK), Z_YDMF_PHYS_OUT_FRTHC&
      &(:,:, JBLK), PSUDU(:, JBLK), ZSDUR(:, JBLK), ZDSRP(:, JBLK), PSFSWDIR(:,:, JBLK), PSFSWDIF(:,&
      &:, JBLK), Z_YDMF_PHYS_OUT_FRSOPS(:, JBLK), ZFRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOPT(:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
      PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
      PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
      PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
      PRDG_SOLO => GET_HOST_DATA_RDWR (YD_PRDG_SOLO)
      PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
      PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
      PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
      PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
      PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
      PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
      PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
      ZDSRP => GET_HOST_DATA_RDWR (YL_ZDSRP)
      ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
      ZSDUR => GET_HOST_DATA_RDWR (YL_ZSDUR)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
      Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
      Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
      Z_YDVARS_RADIATION_EMTD_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%EMTD%FT0)
      Z_YDVARS_RADIATION_RMOON_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%RMOON%FT0)
      Z_YDVARS_RADIATION_TRSW_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%TRSW%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => NULL ()
    PALBP => NULL ()
    PCEMTR => NULL ()
    PCTRSO => NULL ()
    PFLU_EMIS => NULL ()
    PQV => NULL ()
    PRDG_MU0 => NULL ()
    PRDG_SOLO => NULL ()
    PSFSWDIF => NULL ()
    PSFSWDIR => NULL ()
    PSUDU => NULL ()
    PTENT => NULL ()
    PTRSOD => NULL ()
    PTRSODIF => NULL ()
    PTRSODIR => NULL ()
    ZDSRP => NULL ()
    ZFRSODS => NULL ()
    ZSDUR => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRSOC => NULL ()
    Z_YDMF_PHYS_OUT_FRSODS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOLU => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPT => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FRTHC => NULL ()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
    Z_YDVARS_RADIATION_EMTD_T0 => NULL ()
    Z_YDVARS_RADIATION_RMOON_T0 => NULL ()
    Z_YDVARS_RADIATION_TRSW_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
    &','APL_ARPEGE_RADIATION_PARALLEL:RADHEAT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
    PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
    PCEMTR => GET_HOST_DATA_RDONLY (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDONLY (YD_PCTRSO)
    PFLU_EMIS => GET_HOST_DATA_RDONLY (YD_PFLU_EMIS)
    PQV => GET_HOST_DATA_RDONLY (YD_PQV)
    PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
    PRDG_SOLO => GET_HOST_DATA_RDONLY (YD_PRDG_SOLO)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSUDU => GET_HOST_DATA_RDONLY (YD_PSUDU)
    PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
    PTRSOD => GET_HOST_DATA_RDONLY (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDONLY (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDONLY (YD_PTRSODIR)
    ZDSRP => GET_HOST_DATA_RDWR (YL_ZDSRP)
    ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
    ZSDUR => GET_HOST_DATA_RDWR (YL_ZSDUR)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
    Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    Z_YDVARS_RADIATION_EMTD_T0 => GET_HOST_DATA_RDONLY (YDVARS%RADIATION%EMTD%FT0)
    Z_YDVARS_RADIATION_RMOON_T0 => GET_HOST_DATA_RDONLY (YDVARS%RADIATION%RMOON%FT0)
    Z_YDVARS_RADIATION_TRSW_T0 => GET_HOST_DATA_RDONLY (YDVARS%RADIATION%TRSW%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        Z_YDMF_PHYS_OUT_FRSOLU (JLON, JBLK)=Z_YDVARS_RADIATION_RMOON_T0 (JLON, JBLK)
        CALL RADHEAT_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL%YRML_PHY_RAD%YRERAD, YDMODEL&
        &%YRML_PHY_RAD%YRERDI, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,&
        & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), PFLU_EMIS(:, JBLK), Z_YDVARS_RADIATION_EMTD_T0&
        &(:,:, JBLK), PRDG_MU0(:, JBLK), PRDG_SOLO(:, JBLK), PQV(:,:, JBLK), PTENT(:,:, JBLK), Z_YDVARS_RADIATION_TRSW_T0&
        &(:,:, JBLK), PTRSOD(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), YDMODEL%YRML_PHY_MF%YRPHY2&
        &%TSPHY, PTRSODIR(:,:, JBLK), PTRSODIF(:,:, JBLK), PALBD(:,:, JBLK), PALBP(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
        &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRTHDS&
        &(:, JBLK), PCEMTR(:,:, JBLK), PCTRSO(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSOC(:,:, JBLK), Z_YDMF_PHYS_OUT_FRTHC&
        &(:,:, JBLK), PSUDU(:, JBLK), ZSDUR(:, JBLK), ZDSRP(:, JBLK), PSFSWDIR(:,:, JBLK), PSFSWDIF(:,:,&
        & JBLK), Z_YDMF_PHYS_OUT_FRSOPS(:, JBLK), ZFRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOPT(:, JBLK),YDSTACK&
        &=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
      PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
      PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
      PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
      PRDG_SOLO => GET_HOST_DATA_RDWR (YD_PRDG_SOLO)
      PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
      PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
      PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
      PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
      PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
      PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
      PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
      ZDSRP => GET_HOST_DATA_RDWR (YL_ZDSRP)
      ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
      ZSDUR => GET_HOST_DATA_RDWR (YL_ZSDUR)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
      Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
      Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
      Z_YDVARS_RADIATION_EMTD_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%EMTD%FT0)
      Z_YDVARS_RADIATION_RMOON_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%RMOON%FT0)
      Z_YDVARS_RADIATION_TRSW_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%TRSW%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => NULL ()
    PALBP => NULL ()
    PCEMTR => NULL ()
    PCTRSO => NULL ()
    PFLU_EMIS => NULL ()
    PQV => NULL ()
    PRDG_MU0 => NULL ()
    PRDG_SOLO => NULL ()
    PSFSWDIF => NULL ()
    PSFSWDIR => NULL ()
    PSUDU => NULL ()
    PTENT => NULL ()
    PTRSOD => NULL ()
    PTRSODIF => NULL ()
    PTRSODIR => NULL ()
    ZDSRP => NULL ()
    ZFRSODS => NULL ()
    ZSDUR => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRSOC => NULL ()
    Z_YDMF_PHYS_OUT_FRSODS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOLU => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPT => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FRTHC => NULL ()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
    Z_YDVARS_RADIATION_EMTD_T0 => NULL ()
    Z_YDVARS_RADIATION_RMOON_T0 => NULL ()
    Z_YDVARS_RADIATION_TRSW_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_RADIATION_PARALLEL:RADHEAT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => GET_DEVICE_DATA_RDONLY (YD_PALBD)
    PALBP => GET_DEVICE_DATA_RDONLY (YD_PALBP)
    PCEMTR => GET_DEVICE_DATA_RDONLY (YD_PCEMTR)
    PCTRSO => GET_DEVICE_DATA_RDONLY (YD_PCTRSO)
    PFLU_EMIS => GET_DEVICE_DATA_RDONLY (YD_PFLU_EMIS)
    PQV => GET_DEVICE_DATA_RDONLY (YD_PQV)
    PRDG_MU0 => GET_DEVICE_DATA_RDONLY (YD_PRDG_MU0)
    PRDG_SOLO => GET_DEVICE_DATA_RDONLY (YD_PRDG_SOLO)
    PSFSWDIF => GET_DEVICE_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_DEVICE_DATA_RDWR (YD_PSFSWDIR)
    PSUDU => GET_DEVICE_DATA_RDONLY (YD_PSUDU)
    PTENT => GET_DEVICE_DATA_RDWR (YD_PTENT)
    PTRSOD => GET_DEVICE_DATA_RDONLY (YD_PTRSOD)
    PTRSODIF => GET_DEVICE_DATA_RDONLY (YD_PTRSODIF)
    PTRSODIR => GET_DEVICE_DATA_RDONLY (YD_PTRSODIR)
    ZDSRP => GET_DEVICE_DATA_RDWR (YL_ZDSRP)
    ZFRSODS => GET_DEVICE_DATA_RDWR (YL_ZFRSODS)
    ZSDUR => GET_DEVICE_DATA_RDWR (YL_ZSDUR)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSOC => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
    Z_YDMF_PHYS_OUT_FRSODS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOLU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    Z_YDMF_PHYS_OUT_FRSOPT => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
    Z_YDMF_PHYS_OUT_FRTH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHC => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    Z_YDVARS_RADIATION_EMTD_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%RADIATION%EMTD%FT0)
    Z_YDVARS_RADIATION_RMOON_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%RADIATION%RMOON%FT0)
    Z_YDVARS_RADIATION_TRSW_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%RADIATION%TRSW%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (PALBD, PALBP, PCEMTR, PCTRSO, PFLU_EMIS, PQV, PRDG_MU0, PRDG_SOLO, &
      !$ACC&         PSFSWDIF, PSFSWDIR, PSUDU, PTENT, PTRSOD, PTRSODIF, PTRSODIR, YDCPG_OPTS, &
      !$ACC&         YDMODEL, YFXTRAN_ACDC_STACK, ZDSRP, ZFRSODS, ZSDUR, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_FRSO, &
      !$ACC&         Z_YDMF_PHYS_OUT_FRSOC, Z_YDMF_PHYS_OUT_FRSODS, Z_YDMF_PHYS_OUT_FRSOLU, &
      !$ACC&         Z_YDMF_PHYS_OUT_FRSOPS, Z_YDMF_PHYS_OUT_FRSOPT, Z_YDMF_PHYS_OUT_FRTH, &
      !$ACC&         Z_YDMF_PHYS_OUT_FRTHC, Z_YDMF_PHYS_OUT_FRTHDS, Z_YDVARS_RADIATION_EMTD_T0, &
      !$ACC&         Z_YDVARS_RADIATION_RMOON_T0, Z_YDVARS_RADIATION_TRSW_T0) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        Z_YDMF_PHYS_OUT_FRSOLU (JLON, JBLK)=Z_YDVARS_RADIATION_RMOON_T0 (JLON, JBLK)
        CALL RADHEAT_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL%YRML_PHY_RAD%YRERAD, YDMODEL&
        &%YRML_PHY_RAD%YRERDI, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,&
        & YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), PFLU_EMIS(:, JBLK), Z_YDVARS_RADIATION_EMTD_T0&
        &(:,:, JBLK), PRDG_MU0(:, JBLK), PRDG_SOLO(:, JBLK), PQV(:,:, JBLK), PTENT(:,:, JBLK), Z_YDVARS_RADIATION_TRSW_T0&
        &(:,:, JBLK), PTRSOD(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), YDMODEL%YRML_PHY_MF%YRPHY2&
        &%TSPHY, PTRSODIR(:,:, JBLK), PTRSODIF(:,:, JBLK), PALBD(:,:, JBLK), PALBP(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO&
        &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRTHDS&
        &(:, JBLK), PCEMTR(:,:, JBLK), PCTRSO(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSOC(:,:, JBLK), Z_YDMF_PHYS_OUT_FRTHC&
        &(:,:, JBLK), PSUDU(:, JBLK), ZSDUR(:, JBLK), ZDSRP(:, JBLK), PSFSWDIR(:,:, JBLK), PSFSWDIF(:,:,&
        & JBLK), Z_YDMF_PHYS_OUT_FRSOPS(:, JBLK), ZFRSODS(:, JBLK), Z_YDMF_PHYS_OUT_FRSOPT(:, JBLK),YDSTACK&
        &=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
      PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
      PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
      PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
      PFLU_EMIS => GET_HOST_DATA_RDWR (YD_PFLU_EMIS)
      PQV => GET_HOST_DATA_RDWR (YD_PQV)
      PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
      PRDG_SOLO => GET_HOST_DATA_RDWR (YD_PRDG_SOLO)
      PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
      PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
      PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
      PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
      PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
      PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
      PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
      ZDSRP => GET_HOST_DATA_RDWR (YL_ZDSRP)
      ZFRSODS => GET_HOST_DATA_RDWR (YL_ZFRSODS)
      ZSDUR => GET_HOST_DATA_RDWR (YL_ZSDUR)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSOC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOC)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_OUT_FRSOLU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOLU)
      Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
      Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
      Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
      Z_YDMF_PHYS_OUT_FRTHC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHC)
      Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
      Z_YDVARS_RADIATION_EMTD_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%EMTD%FT0)
      Z_YDVARS_RADIATION_RMOON_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%RMOON%FT0)
      Z_YDVARS_RADIATION_TRSW_T0 => GET_HOST_DATA_RDWR (YDVARS%RADIATION%TRSW%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => NULL ()
    PALBP => NULL ()
    PCEMTR => NULL ()
    PCTRSO => NULL ()
    PFLU_EMIS => NULL ()
    PQV => NULL ()
    PRDG_MU0 => NULL ()
    PRDG_SOLO => NULL ()
    PSFSWDIF => NULL ()
    PSFSWDIR => NULL ()
    PSUDU => NULL ()
    PTENT => NULL ()
    PTRSOD => NULL ()
    PTRSODIF => NULL ()
    PTRSODIR => NULL ()
    ZDSRP => NULL ()
    ZFRSODS => NULL ()
    ZSDUR => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OUT_FRSO => NULL ()
    Z_YDMF_PHYS_OUT_FRSOC => NULL ()
    Z_YDMF_PHYS_OUT_FRSODS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOLU => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
    Z_YDMF_PHYS_OUT_FRSOPT => NULL ()
    Z_YDMF_PHYS_OUT_FRTH => NULL ()
    Z_YDMF_PHYS_OUT_FRTHC => NULL ()
    Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
    Z_YDVARS_RADIATION_EMTD_T0 => NULL ()
    Z_YDVARS_RADIATION_RMOON_T0 => NULL ()
    Z_YDVARS_RADIATION_TRSW_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:RADHEAT',1,ZHOOK_HANDLE_PARALLEL)

  IF (YDMODEL%YRML_PHY_MF%YRPHY%LDAYD) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:ACDAYD')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        CALL ACDAYD (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
        &%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTDIA, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, Z_YDVARS_GEOMETRY_GEMU_T0&
        &(:, JBLK), PRDG_MU0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK))
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
        & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:ACDAYD')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          
          CALL ACDAYD_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
          &%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTDIA, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, Z_YDVARS_GEOMETRY_GEMU_T0&
          &(:, JBLK), PRDG_MU0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
          &(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
        & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:ACDAYD')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => GET_DEVICE_DATA_RDONLY (YD_PRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (PRDG_MU0, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, &
        !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_OUT_FRSO, &
        !$ACC&         Z_YDVARS_GEOMETRY_GEMU_T0) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          
          CALL ACDAYD_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
          &%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTDIA, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, Z_YDVARS_GEOMETRY_GEMU_T0&
          &(:, JBLK), PRDG_MU0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
          &(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
        & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACDAYD',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF


  IF (YDMODEL%YRML_PHY_MF%YRPHY0%GRSO<1._JPRB) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:ACRSO')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        CALL ACRSO (YDMODEL%YRML_PHY_MF%YRPHY0, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
        &, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTDIA, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, Z_YDVARS_GEOMETRY_GEMU_T0&
        &(:, JBLK), PRDG_MU0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK))
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
        & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:ACRSO')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          
          CALL ACRSO_OPENACC (YDMODEL%YRML_PHY_MF%YRPHY0, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
          &, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTDIA, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, Z_YDVARS_GEOMETRY_GEMU_T0&
          &(:, JBLK), PRDG_MU0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
          &(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
        & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:ACRSO')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => GET_DEVICE_DATA_RDONLY (YD_PRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (PRDG_MU0, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, &
        !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_OUT_FRSO, &
        !$ACC&         Z_YDVARS_GEOMETRY_GEMU_T0) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          
          CALL ACRSO_OPENACC (YDMODEL%YRML_PHY_MF%YRPHY0, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
          &, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%KTDIA, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, Z_YDVARS_GEOMETRY_GEMU_T0&
          &(:, JBLK), PRDG_MU0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
          &(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
        Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
        Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
        & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PRDG_MU0 => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:ACRSO',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF


  IF (.NOT.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:LMSE_F')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
      PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
      ZALB => GET_HOST_DATA_RDWR (YL_ZALB)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, JSG) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZALB (JLON, JBLK)=0.0_JPRB

          DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
            ZALB (JLON, JBLK)=ZALB (JLON, JBLK)+0.5_JPRB*(PALBD (JLON, JSG, JBLK)+PALBP (JLON, JSG, JBLK))
          ENDDO

          ZALB (JLON, JBLK)=ZALB (JLON, JBLK)/REAL (YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JPRB)
          Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSO (JLON&
          &, YDCPG_OPTS%KFLEVG, 1, JBLK)/(1.0_JPRB-ZALB (JLON, JBLK))
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
        PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
        ZALB => GET_HOST_DATA_RDWR (YL_ZALB)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => NULL ()
      PALBP => NULL ()
      ZALB => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDMF_PHYS_OUT_FRSODS => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:LMSE_F')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
      PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
      ZALB => GET_HOST_DATA_RDWR (YL_ZALB)
      Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, JSG, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          
          
          ZALB (JLON, JBLK)=0.0_JPRB

          DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
            ZALB (JLON, JBLK)=ZALB (JLON, JBLK)+0.5_JPRB*(PALBD (JLON, JSG, JBLK)+PALBP (JLON, JSG, JBLK))
          ENDDO

          ZALB (JLON, JBLK)=ZALB (JLON, JBLK)/REAL (YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JPRB)
          Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSO (JLON&
          &, YDCPG_OPTS%KFLEVG, 1, JBLK)/(1.0_JPRB-ZALB (JLON, JBLK))
        
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
        PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
        ZALB => GET_HOST_DATA_RDWR (YL_ZALB)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => NULL ()
      PALBP => NULL ()
      ZALB => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDMF_PHYS_OUT_FRSODS => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:LMSE_F')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_DEVICE_DATA_RDONLY (YD_PALBD)
      PALBP => GET_DEVICE_DATA_RDONLY (YD_PALBP)
      ZALB => GET_DEVICE_DATA_RDWR (YL_ZALB)
      Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
      Z_YDMF_PHYS_OUT_FRSODS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (PALBD, PALBP, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZALB, Z_YDMF_PHYS_OUT_FRSO, &
        !$ACC&         Z_YDMF_PHYS_OUT_FRSODS) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLON, JSG, YLCPG_BNDS) 

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          
          
          ZALB (JLON, JBLK)=0.0_JPRB

          DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
            ZALB (JLON, JBLK)=ZALB (JLON, JBLK)+0.5_JPRB*(PALBD (JLON, JSG, JBLK)+PALBP (JLON, JSG, JBLK))
          ENDDO

          ZALB (JLON, JBLK)=ZALB (JLON, JBLK)/REAL (YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JPRB)
          Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSO (JLON&
          &, YDCPG_OPTS%KFLEVG, 1, JBLK)/(1.0_JPRB-ZALB (JLON, JBLK))
        
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
        PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
        ZALB => GET_HOST_DATA_RDWR (YL_ZALB)
        Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
        Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => NULL ()
      PALBP => NULL ()
      ZALB => NULL ()
      Z_YDMF_PHYS_OUT_FRSO => NULL ()
      Z_YDMF_PHYS_OUT_FRSODS => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:LMSE_F',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF


  IF (.NOT.YDCPG_OPTS%LCONFX) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

          IF (Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)>=YDMODEL%YRML_PHY_RAD%YRERDI%RSUNDUR) THEN
            Z_YDMF_PHYS_SURF_GSD_VD_PSUND (JLON, JBLK)=Z_YDMF_PHYS_SURF_GSD_VD_PSUND&
            & (JLON, JBLK)+1.0_JPRB*YDMODEL%YRML_GCONF%YRRIP%TSTEP
          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
        Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FRSODS => NULL ()
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON

          

          

          IF (Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)>=YDMODEL%YRML_PHY_RAD%YRERDI%RSUNDUR) THEN
            Z_YDMF_PHYS_SURF_GSD_VD_PSUND (JLON, JBLK)=Z_YDMF_PHYS_SURF_GSD_VD_PSUND&
            & (JLON, JBLK)+1.0_JPRB*YDMODEL%YRML_GCONF%YRRIP%TSTEP
          ENDIF

        
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
        Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FRSODS => NULL ()
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
      &','APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FRSODS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSODS)
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_OUT_FRSODS, &
        !$ACC&         Z_YDMF_PHYS_SURF_GSD_VD_PSUND) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON

          

          

          IF (Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)>=YDMODEL%YRML_PHY_RAD%YRERDI%RSUNDUR) THEN
            Z_YDMF_PHYS_SURF_GSD_VD_PSUND (JLON, JBLK)=Z_YDMF_PHYS_SURF_GSD_VD_PSUND&
            & (JLON, JBLK)+1.0_JPRB*YDMODEL%YRML_GCONF%YRRIP%TSTEP
          ENDIF

        
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE')) THEN
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
        Z_YDMF_PHYS_SURF_GSD_VD_PSUND => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VD%F_SUND)
        IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FRSODS => NULL ()
      Z_YDMF_PHYS_SURF_GSD_VD_PSUND => NULL ()
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:SUNSHINE',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF

ELSE
  CALL ABOR1 ('APL_ARPEGE_RADIATION: WRONG SETTINGS')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_RADIATION_PARALLEL:DIRECT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
  Z_YDMF_PHYS_OUT_FRSDNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSDNI)
  Z_YDMF_PHYS_OUT_FRSGNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSGNI)
  Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSODS)
  Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSOPS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)

      IF (PRDG_MU0 (JLON, JBLK)>3.0E-02_JPRB) THEN
        Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)/PRDG_MU0 (JLON, JBLK)
      ENDIF

      Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK))
    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      Z_YDMF_PHYS_OUT_FRSGNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)+0.5_JPRB*&
      &((1.0_JPRB+PRDG_MU0 (JLON, JBLK))*(Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)-Z_YDMF_PHYS_OUT_FRSOPS&
      & (JLON, JBLK))+(1.0_JPRB-PRDG_MU0 (JLON, JBLK))*(Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK&
      &)-Z_YDMF_PHYS_OUT_FRSO (JLON, YDCPG_OPTS%KFLEVG, 1, JBLK)))
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
    Z_YDMF_PHYS_OUT_FRSDNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSDNI)
    Z_YDMF_PHYS_OUT_FRSGNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSGNI)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_MU0 => NULL ()
  Z_YDMF_PHYS_OUT_FRSDNI => NULL ()
  Z_YDMF_PHYS_OUT_FRSGNI => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRSODS => NULL ()
  Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_RADIATION_PARALLEL:DIRECT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_MU0 => GET_HOST_DATA_RDONLY (YD_PRDG_MU0)
  Z_YDMF_PHYS_OUT_FRSDNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSDNI)
  Z_YDMF_PHYS_OUT_FRSGNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSGNI)
  Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSODS)
  Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSOPS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)

      IF (PRDG_MU0 (JLON, JBLK)>3.0E-02_JPRB) THEN
        Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)/PRDG_MU0 (JLON, JBLK)
      ENDIF

      Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK))
      
      
      Z_YDMF_PHYS_OUT_FRSGNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)+0.5_JPRB*&
      &((1.0_JPRB+PRDG_MU0 (JLON, JBLK))*(Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)-Z_YDMF_PHYS_OUT_FRSOPS&
      & (JLON, JBLK))+(1.0_JPRB-PRDG_MU0 (JLON, JBLK))*(Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK&
      &)-Z_YDMF_PHYS_OUT_FRSO (JLON, YDCPG_OPTS%KFLEVG, 1, JBLK)))
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
    Z_YDMF_PHYS_OUT_FRSDNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSDNI)
    Z_YDMF_PHYS_OUT_FRSGNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSGNI)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_MU0 => NULL ()
  Z_YDMF_PHYS_OUT_FRSDNI => NULL ()
  Z_YDMF_PHYS_OUT_FRSGNI => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRSODS => NULL ()
  Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_RADIATION_PARALLEL:DIRECT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_MU0 => GET_DEVICE_DATA_RDONLY (YD_PRDG_MU0)
  Z_YDMF_PHYS_OUT_FRSDNI => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSDNI)
  Z_YDMF_PHYS_OUT_FRSGNI => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSGNI)
  Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRSODS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSODS)
  Z_YDMF_PHYS_OUT_FRSOPS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSOPS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PRDG_MU0, YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_OUT_FRSDNI, &
    !$ACC&         Z_YDMF_PHYS_OUT_FRSGNI, Z_YDMF_PHYS_OUT_FRSO, Z_YDMF_PHYS_OUT_FRSODS, &
    !$ACC&         Z_YDMF_PHYS_OUT_FRSOPS) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)

      IF (PRDG_MU0 (JLON, JBLK)>3.0E-02_JPRB) THEN
        Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSOPS (JLON, JBLK)/PRDG_MU0 (JLON, JBLK)
      ENDIF

      Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK))
      
      
      Z_YDMF_PHYS_OUT_FRSGNI (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRSDNI (JLON, JBLK)+0.5_JPRB*&
      &((1.0_JPRB+PRDG_MU0 (JLON, JBLK))*(Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK)-Z_YDMF_PHYS_OUT_FRSOPS&
      & (JLON, JBLK))+(1.0_JPRB-PRDG_MU0 (JLON, JBLK))*(Z_YDMF_PHYS_OUT_FRSODS (JLON, JBLK&
      &)-Z_YDMF_PHYS_OUT_FRSO (JLON, YDCPG_OPTS%KFLEVG, 1, JBLK)))
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PRDG_MU0 => GET_HOST_DATA_RDWR (YD_PRDG_MU0)
    Z_YDMF_PHYS_OUT_FRSDNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSDNI)
    Z_YDMF_PHYS_OUT_FRSGNI => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSGNI)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRSODS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSODS)
    Z_YDMF_PHYS_OUT_FRSOPS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_MU0 => NULL ()
  Z_YDMF_PHYS_OUT_FRSDNI => NULL ()
  Z_YDMF_PHYS_OUT_FRSGNI => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRSODS => NULL ()
  Z_YDMF_PHYS_OUT_FRSOPS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_RADIATION_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL:DIRECT',1,ZHOOK_HANDLE_PARALLEL)


CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZAERO)) CALL FIELD_DELETE (YL_ZAERO)
IF (ASSOCIATED (YL_ZAEROCPL)) CALL FIELD_DELETE (YL_ZAEROCPL)
IF (ASSOCIATED (YL_ZALB)) CALL FIELD_DELETE (YL_ZALB)
IF (ASSOCIATED (YL_ZCGA_DST)) CALL FIELD_DELETE (YL_ZCGA_DST)
IF (ASSOCIATED (YL_ZDSRP)) CALL FIELD_DELETE (YL_ZDSRP)
IF (ASSOCIATED (YL_ZDUM)) CALL FIELD_DELETE (YL_ZDUM)
IF (ASSOCIATED (YL_ZFRSODS)) CALL FIELD_DELETE (YL_ZFRSODS)
IF (ASSOCIATED (YL_ZFSDNN)) CALL FIELD_DELETE (YL_ZFSDNN)
IF (ASSOCIATED (YL_ZFSDNV)) CALL FIELD_DELETE (YL_ZFSDNV)
IF (ASSOCIATED (YL_ZPIZA_DST)) CALL FIELD_DELETE (YL_ZPIZA_DST)
IF (ASSOCIATED (YL_ZSDUR)) CALL FIELD_DELETE (YL_ZSDUR)
IF (ASSOCIATED (YL_ZTAUREL_DST)) CALL FIELD_DELETE (YL_ZTAUREL_DST)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_RADIATION_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_RADIATION_PARALLEL
