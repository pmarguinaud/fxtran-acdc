SUBMODULE (YOMMDDH) YOMMDDH_TMDDH_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TMDDH (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TMDDH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LHDSF, LHDSFDU, LHDSFLA, LNDDHI, LNDDHLA, LNDDHPU, LNLRDDH, LNLXDDH, LNURDDH, LNUXDDH
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LNDDHLA = ALLOCATED (SELF%NDDHLA)
IF (LNDDHLA) THEN
  !$ACC EXIT DATA DETACH (SELF%NDDHLA)
  !$ACC EXIT DATA DELETE (SELF%NDDHLA)
ENDIF

LNDDHPU = ALLOCATED (SELF%NDDHPU)
IF (LNDDHPU) THEN
  !$ACC EXIT DATA DETACH (SELF%NDDHPU)
  !$ACC EXIT DATA DELETE (SELF%NDDHPU)
ENDIF

LNDDHI = ALLOCATED (SELF%NDDHI)
IF (LNDDHI) THEN
  !$ACC EXIT DATA DETACH (SELF%NDDHI)
  !$ACC EXIT DATA DELETE (SELF%NDDHI)
ENDIF

LNLRDDH = ALLOCATED (SELF%NLRDDH)
IF (LNLRDDH) THEN
  !$ACC EXIT DATA DETACH (SELF%NLRDDH)
  !$ACC EXIT DATA DELETE (SELF%NLRDDH)
ENDIF

LNURDDH = ALLOCATED (SELF%NURDDH)
IF (LNURDDH) THEN
  !$ACC EXIT DATA DETACH (SELF%NURDDH)
  !$ACC EXIT DATA DELETE (SELF%NURDDH)
ENDIF

LNLXDDH = ALLOCATED (SELF%NLXDDH)
IF (LNLXDDH) THEN
  !$ACC EXIT DATA DETACH (SELF%NLXDDH)
  !$ACC EXIT DATA DELETE (SELF%NLXDDH)
ENDIF

LNUXDDH = ALLOCATED (SELF%NUXDDH)
IF (LNUXDDH) THEN
  !$ACC EXIT DATA DETACH (SELF%NUXDDH)
  !$ACC EXIT DATA DELETE (SELF%NUXDDH)
ENDIF

LHDSFLA = ALLOCATED (SELF%HDSFLA)
IF (LHDSFLA) THEN
  !$ACC EXIT DATA DETACH (SELF%HDSFLA)
  !$ACC EXIT DATA DELETE (SELF%HDSFLA)
ENDIF

LHDSFDU = ALLOCATED (SELF%HDSFDU)
IF (LHDSFDU) THEN
  !$ACC EXIT DATA DETACH (SELF%HDSFDU)
  !$ACC EXIT DATA DELETE (SELF%HDSFDU)
ENDIF

LHDSF = ALLOCATED (SELF%HDSF)
IF (LHDSF) THEN
  !$ACC EXIT DATA DETACH (SELF%HDSF)
  !$ACC EXIT DATA DELETE (SELF%HDSF)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
