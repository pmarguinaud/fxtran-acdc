SUBROUTINE LATRAJOUT_OPENACC (YDCST, LDRPRSLTRJ, KPROMA, KFLEVG&
&, KST, KEND, KSTEST, KSTESB, PWF, PRCOLON, PGEMU, YDSTACK)
!$ACC ROUTINE (LATRAJOUT_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB, JPRD
USE YOMCST,ONLY:TCST

USE YOMLUN,ONLY:NULERR
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
LOGICAL, INTENT (IN)::LDRPRSLTRJ
INTEGER (KIND=JPIM), INTENT (IN)::KFLEVG
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
INTEGER (KIND=JPIM), INTENT (IN)::KSTEST (KPROMA)
INTEGER (KIND=JPIM), INTENT (IN)::KSTESB (KPROMA)
REAL (KIND=JPRB), INTENT (IN)::PWF (KPROMA, KFLEVG)
REAL (KIND=JPRD), INTENT (IN)::PRCOLON (KPROMA)
REAL (KIND=JPRB), INTENT (IN)::PGEMU (KPROMA)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::ICNT


JROF = KST


ICNT=KSTEST(JROF)

IF (ICNT>0) THEN
  PRINT *, 'SMILAGTRAJECTORYOUTOFATM',ICNT,'TIMES.'

  IF (LDRPRSLTRJ) THEN

    

    IF (KSTEST (JROF)/=0) THEN
      PRINT *, 'POINT=',JROF,'MAXETADOTVERTICALVEL.=',MAXVAL(PWF(JROF,:))
      PRINT *, 'LON=',ACOS(PRCOLON(JROF))*180._JPRB/YDCST%RPI,'DEGREES'
      PRINT *, 'LAT=',ASIN(PGEMU(JROF))*180._JPRB/YDCST%RPI,'DEGREES'
    ENDIF

  
  ENDIF

ENDIF

ICNT=KSTESB(JROF)

IF (ICNT>0) THEN
  PRINT *, 'SMILAGTRAJECTORYUNDERGROUND',ICNT,'TIMES.'

  IF (LDRPRSLTRJ) THEN

    

    IF (KSTESB (JROF)/=0) THEN
      PRINT *, 'POINT=',JROF,'MAXETADOTVERTICALVEL.=',MAXVAL(PWF(JROF,:))
      PRINT *, 'LON=',ACOS(PRCOLON(JROF))*180._JPRB/YDCST%RPI,'DEGREES'
      PRINT *, 'LAT=',ASIN(PGEMU(JROF))*180._JPRB/YDCST%RPI,'DEGREES'
    ENDIF

  
  ENDIF

ENDIF


END SUBROUTINE LATRAJOUT_OPENACC
