SUBROUTINE GP_SPV_OPENACC (YDGEOMETRY, YDDYN, YDDYNA, YDSIMPHL, LDTL, KST, KEND, PSPT0, PSPT0L&
&, PSPT0M, PSPT9, PSPT9L, PSPT9M, PRE0, PRE0L, PRE0M, PRE9, PRE9L, PRE9M, YDSTACK)
!$ACC ROUTINE (GP_SPV_OPENACC) SEQ
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB

USE YOMDYN,ONLY:TDYN
USE YOMDYNA,ONLY:TDYNA
USE YOMSIMPHL,ONLY:TSIMPHL
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (TSIMPHL), INTENT (IN)::YDSIMPHL
LOGICAL, INTENT (IN)::LDTL
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PSPT0 (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT0L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT0M (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT9 (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT9L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PSPT9M (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE0 (YDGEOMETRY%YRDIM%NPROMA, 0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PRE0L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE0M (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE9 (YDGEOMETRY%YRDIM%NPROMA, 0:YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PRE9L (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PRE9M (YDGEOMETRY%YRDIM%NPROMA)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::JROF
LOGICAL::LLPRE9


JROF = KST







IF (.NOT.(((YDSIMPHL%LSIMPH.OR.YDDYNA%LNHDYN).AND.LDTL).OR..NOT.LDTL)) THEN
  LLPRE9=.FALSE.
ELSE
  LLPRE9=.NOT.YDDYNA%LTWOTL
ENDIF


PRE0 (JROF, YDGEOMETRY%YRDIMV%NFLEVG)=EXP (PSPT0 (JROF))
PRE0L (JROF)=PSPT0L (JROF)*PRE0 (JROF, YDGEOMETRY%YRDIMV%NFLEVG)
PRE0M (JROF)=PSPT0M (JROF)*PRE0 (JROF, YDGEOMETRY%YRDIMV%NFLEVG)


IF (LLPRE9) THEN
  
  PRE9 (JROF, YDGEOMETRY%YRDIMV%NFLEVG)=EXP (PSPT9 (JROF))
  PRE9L (JROF)=PSPT9L (JROF)*PRE9 (JROF, YDGEOMETRY%YRDIMV%NFLEVG)
  PRE9M (JROF)=PSPT9M (JROF)*PRE9 (JROF, YDGEOMETRY%YRDIMV%NFLEVG)
  
ENDIF




END SUBROUTINE GP_SPV_OPENACC
