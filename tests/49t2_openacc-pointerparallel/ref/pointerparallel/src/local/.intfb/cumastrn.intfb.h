INTERFACE
SUBROUTINE CUMASTRN &
& (PPLDARE, PPLRG,    YDTHF,   YDCST, YDML_PHY_SLIN,     YDML_PHY_EC, YGFL,&
& YDCHEM,   YDSPP_CONFIG, YDPERTPAR, &
& KIDIA,    KFDIA,    KLON,    KLEV,   PDX, LDTDKMF,&
& LDMCAPEA, LDLAND,   PTSPHY,&
& PTEN,     PQEN,     PUEN,     PVEN,     PLITOT,&
& PVERVEL,  PQSEN,    PQHFL,    PAHFS,&
& PAP,      PAPH,     PGEO,     PGEOH,    PGAW,&
& PCUCONVCA,PGP2DSPP, &
& PTENT,    PTENQ,    PTENU,    PTENV,    PTENTA,   PTENQA,&
& LDCUM,    KTYPE,    KCBOT,    KCTOP,&
& LDCUM_LIG, KCBOT_LIG, KCTOP_LIG,&
& KBOTSC,   LDSC,&
& LDSHCV,&
& PLCRIT_AER,&
& PTU,      PQU,      PLU,      PLUDE,    PLUDELI,   PSNDE,&
& PENTH,    PMFLXR,   PMFLXS,   PRAIN,    PLRAIN,    PRSUD,&
& PMFU,     PMFD,     PLGLAC, &
& PMFUDE_RATE,        PMFDDE_RATE,    PCAPE,   PWU, PWMEAN, PVDISCU, PDISS, &
& KTRAC,    PCEN,     PTENC,    PSCAV, PSCAV0 )
USE MODEL_PHYSICS_ECMWF_MOD , ONLY : MODEL_PHYSICS_ECMWF_TYPE
USE MODEL_PHYSICS_SIMPLINEAR_MOD , ONLY : MODEL_PHYSICS_SIMPLINEAR_TYPE
USE YOM_YGFL  , ONLY : TYPE_GFLD
USE YOMCHEM   , ONLY : TCHEM
USE PARKIND1  , ONLY : JPIM, JPRB
USE YOMCST    , ONLY : TCST
USE YOETHF    , ONLY : TTHF
USE SPP_MOD     , ONLY : TSPP_CONFIG
USE YOMPERTPAR  , ONLY : TPERTPAR
IMPLICIT NONE
REAL(KIND=JPRB)   ,INTENT(IN)    :: PPLDARE
REAL(KIND=JPRB)   ,INTENT(IN)    :: PPLRG
TYPE(TTHF)                         ,INTENT(IN):: YDTHF
TYPE(TCST)                         ,INTENT(IN):: YDCST
TYPE(MODEL_PHYSICS_ECMWF_TYPE)     ,INTENT(IN):: YDML_PHY_EC
TYPE(TCHEM)       ,INTENT(IN)    :: YDCHEM
TYPE(TSPP_CONFIG) ,INTENT(IN)    :: YDSPP_CONFIG
TYPE(TPERTPAR)    ,INTENT(IN)    :: YDPERTPAR
TYPE(MODEL_PHYSICS_SIMPLINEAR_TYPE),INTENT(IN):: YDML_PHY_SLIN
TYPE(TYPE_GFLD)   ,INTENT(IN)    :: YGFL
INTEGER(KIND=JPIM),INTENT(IN)    :: KLON
INTEGER(KIND=JPIM),INTENT(IN)    :: KLEV
INTEGER(KIND=JPIM),INTENT(IN)    :: KIDIA
INTEGER(KIND=JPIM),INTENT(IN)    :: KFDIA
INTEGER(KIND=JPIM),INTENT(IN)    :: KTRAC
LOGICAL           ,INTENT(IN)    :: LDMCAPEA
LOGICAL           ,INTENT(IN)    :: LDLAND(KLON)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PTSPHY
REAL(KIND=JPRB)   ,INTENT(IN)    :: PLCRIT_AER(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PTEN(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PQEN(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PUEN(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PVEN(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PLITOT(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PVERVEL(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PQSEN(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PQHFL(KLON,KLEV+1)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PAHFS(KLON,KLEV+1)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PAP(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PAPH(KLON,KLEV+1)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGEO(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGEOH(KLON,KLEV+1)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGAW(KLON)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PCUCONVCA(KLON)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PGP2DSPP(KLON,YDSPP_CONFIG%SM%NRFTOTAL)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PCEN(KLON,KLEV,KTRAC)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PSCAV(KTRAC)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PSCAV0(KTRAC)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PDX(KLON)
LOGICAL           ,INTENT(IN)    :: LDTDKMF
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PTENT(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PTENQ(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PTENU(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PTENV(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PTENTA(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(IN)    :: PTENQA(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(INOUT) :: PTENC(KLON,KLEV,KTRAC)
LOGICAL           ,INTENT(OUT)   :: LDCUM(KLON)
INTEGER(KIND=JPIM),INTENT(OUT)   :: KTYPE(KLON)
INTEGER(KIND=JPIM),INTENT(OUT)   :: KCBOT(KLON)
INTEGER(KIND=JPIM),INTENT(OUT)   :: KCTOP(KLON)
LOGICAL           ,INTENT(OUT)   :: LDCUM_LIG(KLON)
INTEGER(KIND=JPIM),INTENT(OUT)   :: KCBOT_LIG(KLON)
INTEGER(KIND=JPIM),INTENT(OUT)   :: KCTOP_LIG(KLON)
INTEGER(KIND=JPIM),INTENT(OUT)   :: KBOTSC(KLON)
LOGICAL           ,INTENT(OUT)   :: LDSC(KLON)
LOGICAL           ,INTENT(IN)    :: LDSHCV(KLON)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PTU(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PQU(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PLU(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PLUDE(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PLUDELI(KLON,KLEV,4)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PSNDE(KLON,KLEV,2)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PENTH(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PMFLXR(KLON,KLEV+1)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PMFLXS(KLON,KLEV+1)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PRAIN(KLON)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PLRAIN(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PRSUD(KLON,KLEV,2)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PMFU(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PMFD(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PLGLAC(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PMFUDE_RATE(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PMFDDE_RATE(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PCAPE(KLON)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PWMEAN(KLON)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PVDISCU(KLON)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PWU(KLON,KLEV)
REAL(KIND=JPRB)   ,INTENT(OUT)   :: PDISS(KLON,KLEV)
END SUBROUTINE CUMASTRN




SUBROUTINE CUMASTRN_PARALLEL (PPLDARE, PPLRG, YDTHF, YDCST, YDML_PHY_SLIN, YDML_PHY_EC, YGFL, YDCHEM&
&, YDSPP_CONFIG, YDPERTPAR, YDCPG_OPTS, YDCPG_BNDS, KLON, KLEV, YD_PDX, LDTDKMF, LDMCAPEA, YD_LDLAND&
&, PTSPHY, YD_PTEN, YD_PQEN, YD_PUEN, YD_PVEN, YD_PLITOT, YD_PVERVEL, YD_PQSEN, YD_PQHFL, YD_PAHFS&
&, YD_PAP, YD_PAPH, YD_PGEO, YD_PGEOH, YD_PGAW, YD_PCUCONVCA, YD_PGP2DSPP, YD_PTENT, YD_PTENQ,&
& YD_PTENU, YD_PTENV, YD_PTENTA, YD_PTENQA, YD_LDCUM, YD_KTYPE, YD_KCBOT, YD_KCTOP, YD_LDCUM_LIG&
&, YD_KCBOT_LIG, YD_KCTOP_LIG, YD_KBOTSC, YD_LDSC, YD_LDSHCV, YD_PLCRIT_AER, YD_PTU, YD_PQU, YD_PLU&
&, YD_PLUDE, YD_PLUDELI, YD_PSNDE, YD_PENTH, YD_PMFLXR, YD_PMFLXS, YD_PRAIN, YD_PLRAIN, YD_PRSUD&
&, YD_PMFU, YD_PMFD, YD_PLGLAC, YD_PMFUDE_RATE, YD_PMFDDE_RATE, YD_PCAPE, YD_PWU, YD_PWMEAN, YD_PVDISCU&
&, YD_PDISS, KTRAC, YD_PCEN, YD_PTENC, PSCAV, PSCAV0)
USE MODEL_PHYSICS_ECMWF_MOD,ONLY:MODEL_PHYSICS_ECMWF_TYPE
USE MODEL_PHYSICS_SIMPLINEAR_MOD,ONLY:MODEL_PHYSICS_SIMPLINEAR_TYPE
USE YOM_YGFL,ONLY:TYPE_GFLD
USE YOMCHEM,ONLY:TCHEM
USE YOMCST,ONLY:TCST
USE YOETHF,ONLY:TTHF
USE SPP_MOD,ONLY:TSPP_CONFIG
USE YOMPERTPAR,ONLY:TPERTPAR
USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE YOMHOOK
USE PARKIND1
USE FXTRAN_ACDC_GPUMEM_MOD

IMPLICIT NONE
REAL (KIND=JPRB), INTENT (IN)::PPLDARE
REAL (KIND=JPRB), INTENT (IN)::PPLRG
TYPE (TTHF), INTENT (IN)::YDTHF
TYPE (TCST), INTENT (IN)::YDCST
TYPE (MODEL_PHYSICS_ECMWF_TYPE), INTENT (IN)::YDML_PHY_EC
TYPE (TCHEM), INTENT (IN)::YDCHEM
TYPE (TSPP_CONFIG), INTENT (IN)::YDSPP_CONFIG
TYPE (TPERTPAR), INTENT (IN)::YDPERTPAR
TYPE (MODEL_PHYSICS_SIMPLINEAR_TYPE), INTENT (IN)::YDML_PHY_SLIN
TYPE (TYPE_GFLD), INTENT (IN)::YGFL
INTEGER (KIND=JPIM), INTENT (IN)::KLON
INTEGER (KIND=JPIM), INTENT (IN)::KLEV
TYPE (CPG_OPTS_TYPE), INTENT (IN) :: YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN) :: YDCPG_BNDS
INTEGER (KIND=JPIM), INTENT (IN)::KTRAC
LOGICAL, INTENT (IN)::LDMCAPEA
CLASS (FIELD_2LM), POINTER :: YD_LDLAND
REAL (KIND=JPRB), INTENT (IN)::PTSPHY
CLASS (FIELD_3RB), POINTER :: YD_PLCRIT_AER
CLASS (FIELD_3RB), POINTER :: YD_PTEN
CLASS (FIELD_3RB), POINTER :: YD_PQEN
CLASS (FIELD_3RB), POINTER :: YD_PUEN
CLASS (FIELD_3RB), POINTER :: YD_PVEN
CLASS (FIELD_3RB), POINTER :: YD_PLITOT
CLASS (FIELD_3RB), POINTER :: YD_PVERVEL
CLASS (FIELD_3RB), POINTER :: YD_PQSEN
CLASS (FIELD_3RB), POINTER :: YD_PQHFL
CLASS (FIELD_3RB), POINTER :: YD_PAHFS
CLASS (FIELD_3RB), POINTER :: YD_PAP
CLASS (FIELD_3RB), POINTER :: YD_PAPH
CLASS (FIELD_3RB), POINTER :: YD_PGEO
CLASS (FIELD_3RB), POINTER :: YD_PGEOH
CLASS (FIELD_2RB), POINTER :: YD_PGAW
CLASS (FIELD_2RB), POINTER :: YD_PCUCONVCA
CLASS (FIELD_3RB), POINTER :: YD_PGP2DSPP
CLASS (FIELD_4RB), POINTER :: YD_PCEN
REAL (KIND=JPRB), INTENT (IN)::PSCAV (KTRAC)
REAL (KIND=JPRB), INTENT (IN)::PSCAV0 (KTRAC)
CLASS (FIELD_2RB), POINTER :: YD_PDX
LOGICAL, INTENT (IN)::LDTDKMF
CLASS (FIELD_3RB), POINTER :: YD_PTENT
CLASS (FIELD_3RB), POINTER :: YD_PTENQ
CLASS (FIELD_3RB), POINTER :: YD_PTENU
CLASS (FIELD_3RB), POINTER :: YD_PTENV
CLASS (FIELD_3RB), POINTER :: YD_PTENTA
CLASS (FIELD_3RB), POINTER :: YD_PTENQA
CLASS (FIELD_4RB), POINTER :: YD_PTENC
CLASS (FIELD_2LM), POINTER :: YD_LDCUM
CLASS (FIELD_2IM), POINTER :: YD_KTYPE
CLASS (FIELD_2IM), POINTER :: YD_KCBOT
CLASS (FIELD_2IM), POINTER :: YD_KCTOP
CLASS (FIELD_2LM), POINTER :: YD_LDCUM_LIG
CLASS (FIELD_2IM), POINTER :: YD_KCBOT_LIG
CLASS (FIELD_2IM), POINTER :: YD_KCTOP_LIG
CLASS (FIELD_2IM), POINTER :: YD_KBOTSC
CLASS (FIELD_2LM), POINTER :: YD_LDSC
CLASS (FIELD_2LM), POINTER :: YD_LDSHCV
CLASS (FIELD_3RB), POINTER :: YD_PTU
CLASS (FIELD_3RB), POINTER :: YD_PQU
CLASS (FIELD_3RB), POINTER :: YD_PLU
CLASS (FIELD_3RB), POINTER :: YD_PLUDE
CLASS (FIELD_4RB), POINTER :: YD_PLUDELI
CLASS (FIELD_4RB), POINTER :: YD_PSNDE
CLASS (FIELD_3RB), POINTER :: YD_PENTH
CLASS (FIELD_3RB), POINTER :: YD_PMFLXR
CLASS (FIELD_3RB), POINTER :: YD_PMFLXS
CLASS (FIELD_2RB), POINTER :: YD_PRAIN
CLASS (FIELD_3RB), POINTER :: YD_PLRAIN
CLASS (FIELD_4RB), POINTER :: YD_PRSUD
CLASS (FIELD_3RB), POINTER :: YD_PMFU
CLASS (FIELD_3RB), POINTER :: YD_PMFD
CLASS (FIELD_3RB), POINTER :: YD_PLGLAC
CLASS (FIELD_3RB), POINTER :: YD_PMFUDE_RATE
CLASS (FIELD_3RB), POINTER :: YD_PMFDDE_RATE
CLASS (FIELD_2RB), POINTER :: YD_PCAPE
CLASS (FIELD_2RB), POINTER :: YD_PWMEAN
CLASS (FIELD_2RB), POINTER :: YD_PVDISCU
CLASS (FIELD_3RB), POINTER :: YD_PWU
CLASS (FIELD_3RB), POINTER :: YD_PDISS

END SUBROUTINE CUMASTRN_PARALLEL




END INTERFACE
