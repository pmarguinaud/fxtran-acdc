
SUBROUTINE LASCAW_OPENACC (YDVSPLIP, YDSL, LDREGETA, YDDYNA, KPROMA, KDIMK, KST, KEND, KFLEV, KFLDN&
&, KWIS, KHOR, KWENO, KHVI, LDSLHD, LDSLHDQUAD, LDSLHD_OLD, LDSLHDHEAT, LD3DTURB, LDCOMAD, LDCOMADH&
&, LDCOMADV, KSPLTHOI, P4JP, PIS2, PLATI, YDDHSLMER, PSLDW, P3DTW, PLON, PLAT, PLEV, PVETA, KVAUT&
&, PVCUICO, PVSLD, PVSLDW, PVSLVF, PGAMMA_WENO, KRLEVX, PVRLEVX, PKAPPA, PKAPPAT, PKAPPAM, PKAPPAH&
&, PSTDDISU, PSTDDISV, PSTDDISW, KMASK_SL2, PDLAT, PDLAMAD, PCLA, PCLASLD, PCLASLT, PCLAMAD, PDLO&
&, PDLOMAD, PCLO, PCLOSLD, PCLOSLT, PCLOMAD, KL0, KLH0, KLEV, KNOWENO, PCW, PDVER, PDVERMAD, PVINTW&
&, PVINTWSLD, PVINTWSLT, PVINTWSLVF, PVINTWMAD, PVINTWS, PVDERW, PHVW, YDSTACK)
!$ACC ROUTINE (LASCAW_OPENACC) SEQ
USE YOMVSPLIP,ONLY:TVSPLIP
USE PARKIND1,ONLY:JPIB, JPIM, JPRB, JPRD

USE YOMDYNA,ONLY:TDYNA
USE EINT_MOD,ONLY:SL_STRUCT
USE YOMHSLMER,ONLY:THSLMER
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (TVSPLIP), INTENT (IN)::YDVSPLIP
TYPE (TDYNA), INTENT (IN)::YDDYNA
LOGICAL, INTENT (IN)::LDREGETA
LOGICAL, INTENT (IN)::LDSLHDHEAT
TYPE (SL_STRUCT), INTENT (IN)::YDSL
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KDIMK
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KFLDN
INTEGER (KIND=JPIM), INTENT (IN)::KWIS
INTEGER (KIND=JPIM), INTENT (IN)::KHOR
INTEGER (KIND=JPIM), INTENT (IN)::KWENO
INTEGER (KIND=JPIM), INTENT (IN)::KHVI
LOGICAL, INTENT (IN)::LDSLHD
LOGICAL, INTENT (IN)::LDSLHDQUAD
LOGICAL, INTENT (IN)::LDSLHD_OLD
LOGICAL, INTENT (IN)::LD3DTURB
LOGICAL, INTENT (IN)::LDCOMAD
LOGICAL, INTENT (IN)::LDCOMADH
LOGICAL, INTENT (IN)::LDCOMADV
INTEGER (KIND=JPIM), INTENT (IN)::KSPLTHOI
INTEGER (KIND=JPIM), INTENT (IN)::KRLEVX
REAL (KIND=JPRB), INTENT (IN)::P4JP
REAL (KIND=JPRB), INTENT (IN)::PIS2
REAL (KIND=JPRB), INTENT (IN)::PLATI (YDSL%NDGSAH:YDSL%NDGENH)
TYPE (THSLMER), INTENT (IN)::YDDHSLMER
REAL (KIND=JPRB), INTENT (IN)::PSLDW (3, 3, YDSL%NDGSAH:YDSL%NDGENH)
REAL (KIND=JPRB), INTENT (IN)::P3DTW (3, 3, YDSL%NDGSAH:YDSL%NDGENH)
REAL (KIND=JPRB), INTENT (IN)::PLON (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PLAT (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PLEV (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PVETA (0:KFLEV+1)
INTEGER (KIND=JPIM), INTENT (IN)::KVAUT (0:KRLEVX)
REAL (KIND=JPRB), INTENT (IN)::PVCUICO (4, 0:KFLEV-1)
REAL (KIND=JPRB), INTENT (IN)::PVSLD (3, 0:KFLEV-1)
REAL (KIND=JPRB), INTENT (IN)::PVSLDW (3, 3, 0:KFLEV-1)
REAL (KIND=JPRB), INTENT (IN)::PVSLVF (3, 3, 0:KFLEV-1)
REAL (KIND=JPRB), INTENT (IN)::PGAMMA_WENO (KFLEV, 3)
REAL (KIND=JPRB), INTENT (IN)::PVRLEVX
REAL (KIND=JPRB), INTENT (IN)::PKAPPA (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PKAPPAT (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PKAPPAM (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PKAPPAH (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PSTDDISU (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PSTDDISV (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PSTDDISW (KPROMA, KFLEV)
INTEGER (KIND=JPIM), INTENT (INOUT)::KMASK_SL2 (YDSL%NASLMASK)
REAL (KIND=JPRB), INTENT (OUT)::PDLAT (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (OUT)::PDLAMAD (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (OUT)::PCLA (KPROMA, KFLEV, 3, KDIMK)
REAL (KIND=JPRB), INTENT (OUT)::PCLASLD (KPROMA, KFLEV, 3, KDIMK)
REAL (KIND=JPRB), INTENT (OUT)::PCLASLT (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (OUT)::PCLAMAD (KPROMA, KFLEV, 3, KDIMK)
REAL (KIND=JPRB), INTENT (OUT)::PDLO (KPROMA, KFLEV, 0:3)
REAL (KIND=JPRB), INTENT (OUT)::PDLOMAD (KPROMA, KFLEV, 0:3)
REAL (KIND=JPRB), INTENT (OUT)::PCLO (KPROMA, KFLEV, 3, 2, KDIMK)
REAL (KIND=JPRB), INTENT (OUT)::PCLOSLD (KPROMA, KFLEV, 3, 2, KDIMK)
REAL (KIND=JPRB), INTENT (OUT)::PCLOSLT (KPROMA, KFLEV, 3, 2)
REAL (KIND=JPRB), INTENT (OUT)::PCLOMAD (KPROMA, KFLEV, 3, 2, KDIMK)
INTEGER (KIND=JPIM), INTENT (OUT)::KL0 (KPROMA, KFLEV, 0:3)
INTEGER (KIND=JPIM), INTENT (OUT)::KLH0 (KPROMA, KFLEV, 0:3)
INTEGER (KIND=JPIM), INTENT (OUT)::KLEV (KPROMA, KFLEV)
INTEGER (KIND=JPIM), INTENT (OUT)::KNOWENO (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (OUT)::PCW (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (OUT)::PDVER (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (OUT)::PDVERMAD (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (OUT)::PVINTW (KPROMA, KFLEV, 3*KWENO)
REAL (KIND=JPRB), INTENT (OUT)::PVINTWSLD (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (OUT)::PVINTWMAD (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (OUT)::PVINTWSLT (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (OUT)::PVINTWSLVF (KPROMA, KFLEV, 3*KWENO)
REAL (KIND=JPRB), INTENT (OUT)::PVINTWS (KPROMA, KFLEV, 1:4)
REAL (KIND=JPRB), INTENT (OUT)::PVDERW (KPROMA, KFLEV, 2*KHVI, 2*KHVI)
REAL (KIND=JPRB), INTENT (OUT)::PHVW (KPROMA, KFLEV, 4*KHVI)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
INTEGER (KIND=JPIB)::IL
INTEGER (KIND=JPIB)::ILEV64
INTEGER (KIND=JPIM)::JOFF
INTEGER (KIND=JPIM)::IOFF
INTEGER (KIND=JPIM)::ILEV
INTEGER (KIND=JPIM)::IZLATV
INTEGER (KIND=JPIM)::JJ
INTEGER (KIND=JPIM)::IBCLIM
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLAT
INTEGER (KIND=JPIM)::IFLVM2
fxtran_acdc_temp (INTEGER (KIND=JPIM), ILAV, (KPROMA, KFLEV))
fxtran_acdc_temp (INTEGER (KIND=JPIM), IILEV, (KPROMA, KFLEV))
INTEGER (KIND=JPIM)::ILO3 
INTEGER (KIND=JPIM)::ILO2 
INTEGER (KIND=JPIM)::ILO1 
INTEGER (KIND=JPIM)::ILO0 
fxtran_acdc_temp (INTEGER (KIND=JPIM), ILO1IK, (KPROMA, KFLEV))
fxtran_acdc_temp (INTEGER (KIND=JPIM), ILO0IK, (KPROMA, KFLEV))
fxtran_acdc_temp (INTEGER (KIND=JPIM), ILO3IK, (KPROMA, KFLEV))
fxtran_acdc_temp (INTEGER (KIND=JPIM), ILO2IK, (KPROMA, KFLEV))
REAL (KIND=JPRB)::ZDDMAD
REAL (KIND=JPRB)::ZDCMAD
REAL (KIND=JPRB)::ZDBMAD
REAL (KIND=JPRB)::ZDAMAD
fxtran_acdc_temp (REAL (KIND=JPRB), ZKHTURB, (KPROMA, KFLEV, KDIMK))
LOGICAL::LLSLVF
LOGICAL::LL3DTURB
LOGICAL::LLSLHD_OLD
LOGICAL::LLSLHDQUAD
LOGICAL::LLSLHD
LOGICAL::LLT_PHYS (4)
LOGICAL::LLT_SLHD (4)
LOGICAL::LLCOMADV
LOGICAL::LLCOMADH
LOGICAL::LLCOMAD
REAL (KIND=JPRB)::ZEPS
REAL (KIND=JPRB)::ZLO3
REAL (KIND=JPRB)::ZLO2
REAL (KIND=JPRB)::ZLO1
REAL (KIND=JPRB)::ZLO
REAL (KIND=JPRB)::ZFAC
REAL (KIND=JPRB)::ZDVER
REAL (KIND=JPRB)::ZDD
REAL (KIND=JPRB)::ZDC
REAL (KIND=JPRB)::ZDB
REAL (KIND=JPRB)::ZDA
REAL (KIND=JPRB)::Z4
REAL (KIND=JPRB)::Z3
REAL (KIND=JPRB)::Z2
REAL (KIND=JPRB)::Z1
REAL (KIND=JPRB)::ZW2
REAL (KIND=JPRB)::ZW1
REAL (KIND=JPRB)::ZSLHDKMINV
REAL (KIND=JPRB)::ZSLHDKMINH
REAL (KIND=JPRB), PARAMETER::ZSLHDKMINV_WENO=0._JPRB
fxtran_acdc_temp (REAL (KIND=JPRB), ZCLO, (KPROMA, KFLEV, 3))
fxtran_acdc_temp (REAL (KIND=JPRB), ZCLA, (KPROMA, KFLEV, 3))
#include "lascaw_cla_openacc.intfb.h"
#include "lascaw_clo_openacc.intfb.h"
#include "lascaw_claturb_openacc.intfb.h"
#include "lascaw_cloturb_openacc.intfb.h"
#include "lascaw_vintw_openacc.intfb.h"
#include "lascaw.func.h"



YLSTACK = YDSTACK



IF (KIND (ILAV) == 8) THEN
    fxtran_acdc_alloc8 (ILAV)
ELSEIF (KIND (ILAV) == 4) THEN
    fxtran_acdc_alloc4 (ILAV)
ELSE
    STOP 1
ENDIF


IF (KIND (IILEV) == 8) THEN
    fxtran_acdc_alloc8 (IILEV)
ELSEIF (KIND (IILEV) == 4) THEN
    fxtran_acdc_alloc4 (IILEV)
ELSE
    STOP 1
ENDIF


IF (KIND (ILO1IK) == 8) THEN
    fxtran_acdc_alloc8 (ILO1IK)
ELSEIF (KIND (ILO1IK) == 4) THEN
    fxtran_acdc_alloc4 (ILO1IK)
ELSE
    STOP 1
ENDIF


IF (KIND (ILO0IK) == 8) THEN
    fxtran_acdc_alloc8 (ILO0IK)
ELSEIF (KIND (ILO0IK) == 4) THEN
    fxtran_acdc_alloc4 (ILO0IK)
ELSE
    STOP 1
ENDIF


IF (KIND (ILO3IK) == 8) THEN
    fxtran_acdc_alloc8 (ILO3IK)
ELSEIF (KIND (ILO3IK) == 4) THEN
    fxtran_acdc_alloc4 (ILO3IK)
ELSE
    STOP 1
ENDIF


IF (KIND (ILO2IK) == 8) THEN
    fxtran_acdc_alloc8 (ILO2IK)
ELSEIF (KIND (ILO2IK) == 4) THEN
    fxtran_acdc_alloc4 (ILO2IK)
ELSE
    STOP 1
ENDIF


IF (KIND (ZKHTURB) == 8) THEN
    fxtran_acdc_alloc8 (ZKHTURB)
ELSEIF (KIND (ZKHTURB) == 4) THEN
    fxtran_acdc_alloc4 (ZKHTURB)
ELSE
    STOP 1
ENDIF


IF (KIND (ZCLO) == 8) THEN
    fxtran_acdc_alloc8 (ZCLO)
ELSEIF (KIND (ZCLO) == 4) THEN
    fxtran_acdc_alloc4 (ZCLO)
ELSE
    STOP 1
ENDIF


IF (KIND (ZCLA) == 8) THEN
    fxtran_acdc_alloc8 (ZCLA)
ELSEIF (KIND (ZCLA) == 4) THEN
    fxtran_acdc_alloc4 (ZCLA)
ELSE
    STOP 1
ENDIF


JROF = KST



ZEPS=100.0_JPRB*TINY (1.0_JPRB)
LLSLHD=LDSLHD.AND.(KWIS==103.OR.KWIS==104.OR.KWIS==105.OR.KWIS==106.OR.KWIS==203)
LLSLHDQUAD=(LDSLHDQUAD.AND.(KWIS==103.OR.KWIS==104.OR.KWIS==105.OR.KWIS==106.OR.KWIS==203)).OR.((KWIS&
&==102.OR.KWIS==202).AND.YDDYNA%LHOISLT.AND.((YDDYNA%HOISLTV/=0_JPRB).OR.(YDDYNA%HOISLTH/=0_JPRB)))
LL3DTURB=LD3DTURB.AND.(KWIS==103.OR.KWIS==104.OR.KWIS==105.OR.KWIS==106)
LLSLHD_OLD=LLSLHD.AND.LDSLHD_OLD
LLT_SLHD (1)=LLSLHD
LLT_SLHD (2)=LLSLHDQUAD
LLT_SLHD (3)=LLSLHD_OLD
LLT_SLHD (4)=.FALSE.
LLSLVF=(KWIS/=202).AND.YDDYNA%LSLVF
LLCOMAD=LDCOMAD.AND.(KWIS==103.OR.KWIS==104.OR.KWIS==105.OR.KWIS==106.OR.KWIS==203)
LLCOMADH=LLCOMAD.AND.LDCOMADH
LLCOMADV=LLCOMAD.AND.LDCOMADV
LLT_PHYS (1)=YDDYNA%LSLHD
LLT_PHYS (2)=YDDYNA%LSLHDQUAD
LLT_PHYS (3)=LDSLHD_OLD
LLT_PHYS (4)=.FALSE.
ZSLHDKMINH=YDDYNA%SLHDKMIN
ZSLHDKMINV=YDDYNA%SLHDKMIN

IF (KWIS==102.OR.KWIS==202) THEN
  ZSLHDKMINH=YDDYNA%HOISLTH
  ZSLHDKMINV=YDDYNA%HOISLTV
  LLT_SLHD (2)=(YDDYNA%HOISLTH/=0._JPRB)
ELSEIF (KWIS==106) THEN
  LLT_PHYS (2)=.FALSE.
ENDIF


IF (KFLDN/=0.AND.KFLDN/=1) THEN
  CALL FXTRAN_ACDC_ABORT ('LASCAW: UNEXPECTED KFLDN')
ENDIF


IF (LL3DTURB) THEN
  ZKHTURB (JROF, 1:KFLEV, 2)=PKAPPAM (JROF, 1:KFLEV)
  ZKHTURB (JROF, 1:KFLEV, 3)=PKAPPAH (JROF, 1:KFLEV)
ENDIF


IF (KSPLTHOI==1)  THEN
  ZKHTURB (JROF, 1:KFLEV, KDIMK)=1._JPRB
ENDIF

IFLVM2=KFLEV-2

DO JLEV=1, KFLEV
  
  IZLATV=INT (P4JP*(PIS2-PLAT (JROF, JLEV))+0.75_JPRB+ZEPS)-YDSL%NFRSTLOFF
  ILAV (JROF, JLEV)=IZLATV+NINT (SIGN (0.5_JPRB, PLATI (IZLATV)-PLAT (JROF, JLEV)+ZEPS)-1.5_JPRB)
  Z1=PLATI (ILAV (JROF, JLEV)+1)
  PDLAT (JROF, JLEV)=(PLAT (JROF, JLEV)-Z1)/(PLATI (ILAV (JROF, JLEV)+2)-Z1+ZEPS)
  
ENDDO

IOFF=YDSL%NASLB1*KFLDN

IF (101<=KWIS.AND.KWIS<=106) THEN
  ZFAC=PVRLEVX/(PVETA (KFLEV+1)-PVETA (0))

  DO JLEV=1, KFLEV
    
    KLEV (JROF, JLEV)=KVAUT (INT (PLEV (JROF, JLEV)*ZFAC))-1

    IF (KLEV (JROF, JLEV)<IFLVM2.AND.PLEV (JROF, JLEV)>PVETA (KLEV (JROF, JLEV)+2)) THEN
      KLEV (JROF, JLEV)=KLEV (JROF, JLEV)+1
    ENDIF

    Z1=PVETA (KLEV (JROF, JLEV)+1)
    PDVER (JROF, JLEV)=(PLEV (JROF, JLEV)-Z1)/(PVETA (KLEV (JROF, JLEV)+2)-Z1)
    ZLO=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV))
    ILO0 =INT (ZLO)
    PDLO (JROF, JLEV, 0)=ZLO-ILO0 
    ZLO1=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+1)
    ILO1 =INT (ZLO1)
    PDLO (JROF, JLEV, 1)=ZLO1-ILO1 
    ZLO2=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+2)
    ILO2 =INT (ZLO2)
    PDLO (JROF, JLEV, 2)=ZLO2-ILO2 
    ZLO3=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+3)
    ILO3 =INT (ZLO3)
    PDLO (JROF, JLEV, 3)=ZLO3-ILO3 
    
    
    IL=ILAV (JROF, JLEV)
    ILO0 =YDSL%NADDR (ILAV (JROF, JLEV)+0, KFLDN)+YDSL%NSLEXT (ILO0 , IL+0)
    ILO1 =YDSL%NADDR (ILAV (JROF, JLEV)+1, KFLDN)+YDSL%NSLEXT (ILO1 , IL+1)
    ILO2 =YDSL%NADDR (ILAV (JROF, JLEV)+2, KFLDN)+YDSL%NSLEXT (ILO2 , IL+2)
    ILO3 =YDSL%NADDR (ILAV (JROF, JLEV)+3, KFLDN)+YDSL%NSLEXT (ILO3 , IL+3)
    
    
    ILO0IK (JROF, JLEV)=ILO0 
    ILO1IK (JROF, JLEV)=ILO1 
    ILO2IK (JROF, JLEV)=ILO2 
    ILO3IK (JROF, JLEV)=ILO3 

    

    IF (KWIS==101) THEN
      
      JOFF=YDSL%NASLB1*KLEV (JROF, JLEV)
      KL0 (JROF, JLEV, 0)=ILO0 +JOFF
      KL0 (JROF, JLEV, 1)=ILO1 +JOFF
      KL0 (JROF, JLEV, 2)=ILO2 +JOFF
      KL0 (JROF, JLEV, 3)=ILO3 +JOFF
    
    ELSE

      IF (KHOR==0)  THEN
        IOFF=YDSL%NASLB1*JLEV
      ENDIF

      
      JOFF=YDSL%NASLB1*KLEV (JROF, JLEV)
      KL0 (JROF, JLEV, 0)=ILO0 +JOFF
      KL0 (JROF, JLEV, 1)=ILO1 +JOFF
      KL0 (JROF, JLEV, 2)=ILO2 +JOFF
      KL0 (JROF, JLEV, 3)=ILO3 +JOFF
      KLH0 (JROF, JLEV, 0)=ILO0 +IOFF
      KLH0 (JROF, JLEV, 1)=ILO1 +IOFF
      KLH0 (JROF, JLEV, 2)=ILO2 +IOFF
      KLH0 (JROF, JLEV, 3)=ILO3 +IOFF
    
    ENDIF

  ENDDO


  IF (YDSL%NPROC>1.AND.YDSL%LSLONDEM_ACTIVE) THEN

    DO JLEV=1, KFLEV
      
      KMASK_SL2 (ILO0IK (JROF, JLEV):ILO0IK (JROF, JLEV)+3)=1
    
    ENDDO


    DO JLEV=1, KFLEV
      
      KMASK_SL2 (ILO1IK (JROF, JLEV):ILO1IK (JROF, JLEV)+3)=1
    
    ENDDO


    DO JLEV=1, KFLEV
      
      KMASK_SL2 (ILO2IK (JROF, JLEV):ILO2IK (JROF, JLEV)+3)=1
    
    ENDDO


    DO JLEV=1, KFLEV
      
      KMASK_SL2 (ILO3IK (JROF, JLEV):ILO3IK (JROF, JLEV)+3)=1
    
    ENDDO

  ENDIF

ENDIF


IF (102<=KWIS.AND.KWIS<=106) THEN

  DO JLEV=1, KFLEV
    
    ZDA=PLAT (JROF, JLEV)-PLATI (ILAV (JROF, JLEV))
    ZDB=PLAT (JROF, JLEV)-PLATI (ILAV (JROF, JLEV)+1)
    ZDC=PLAT (JROF, JLEV)-PLATI (ILAV (JROF, JLEV)+2)
    ZDD=PLAT (JROF, JLEV)-PLATI (ILAV (JROF, JLEV)+3)
    Z2=ZDA*ZDB
    PCLA (JROF, JLEV, 1, 1)=(ZDA*ZDC)*ZDD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 1)
    PCLA (JROF, JLEV, 2, 1)=Z2*ZDD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 2)
    PCLA (JROF, JLEV, 3, 1)=Z2*ZDC*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 3)

    IF (LLCOMADH) THEN
      Z1=1._JPRB/PSTDDISV (JROF, JLEV)
      Z4=0.5_JPRB*(PLATI (ILAV (JROF, JLEV)+2)-PLATI (ILAV (JROF, JLEV)+1))*(Z1-1._JPRB)
      ZDAMAD=(ZDA-ZDB)*Z1
      ZDDMAD=(ZDD-ZDC)*Z1
      ZDBMAD=ZDB+Z4
      ZDCMAD=ZDC-Z4
      ZDAMAD=ZDAMAD+ZDBMAD
      ZDDMAD=ZDDMAD+ZDCMAD
      Z2=ZDAMAD*ZDBMAD
      Z3=PSTDDISV (JROF, JLEV)**3
      PCLAMAD (JROF, JLEV, 1, 1)=ZDAMAD*ZDCMAD*ZDDMAD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 1)*Z3
      PCLAMAD (JROF, JLEV, 2, 1)=Z2*ZDDMAD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 2)*Z3
      PCLAMAD (JROF, JLEV, 3, 1)=Z2*ZDCMAD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 3)*Z3
    ELSE
      PCLAMAD (JROF, JLEV, 1, 1)=PCLA (JROF, JLEV, 1, 1)
      PCLAMAD (JROF, JLEV, 2, 1)=PCLA (JROF, JLEV, 2, 1)
      PCLAMAD (JROF, JLEV, 3, 1)=PCLA (JROF, JLEV, 3, 1)
    ENDIF


    

    IF (LLCOMADH) THEN
      
      PDLAMAD (JROF, JLEV)=0.5_JPRB+(PDLAT (JROF, JLEV)-0.5_JPRB)*PSTDDISV (JROF, JLEV)
      PDLOMAD (JROF, JLEV, 0)=0.5_JPRB+(PDLO (JROF, JLEV, 0)-0.5_JPRB)*PSTDDISU (JROF, JLEV)
      PDLOMAD (JROF, JLEV, 1)=0.5_JPRB+(PDLO (JROF, JLEV, 1)-0.5_JPRB)*PSTDDISU (JROF, JLEV)
      PDLOMAD (JROF, JLEV, 2)=0.5_JPRB+(PDLO (JROF, JLEV, 2)-0.5_JPRB)*PSTDDISU (JROF, JLEV)
      PDLOMAD (JROF, JLEV, 3)=0.5_JPRB+(PDLO (JROF, JLEV, 3)-0.5_JPRB)*PSTDDISU (JROF, JLEV)
    
    ELSE
      
      PDLAMAD (JROF, JLEV)=PDLAT (JROF, JLEV)
      PDLOMAD (JROF, JLEV, 0)=PDLO (JROF, JLEV, 0)
      PDLOMAD (JROF, JLEV, 1)=PDLO (JROF, JLEV, 1)
      PDLOMAD (JROF, JLEV, 2)=PDLO (JROF, JLEV, 2)
      PDLOMAD (JROF, JLEV, 3)=PDLO (JROF, JLEV, 3)
    
    ENDIF


    IF (LLCOMADV) THEN
      
      PDVERMAD (JROF, JLEV)=0.5_JPRB+(PDVER (JROF, JLEV)-0.5_JPRB)*PSTDDISW (JROF, JLEV)
    
    ELSE
      
      PDVERMAD (JROF, JLEV)=PDVER (JROF, JLEV)
    
    ENDIF

  ENDDO


  IF (LLSLHD.AND.LDSLHDHEAT) THEN
    CALL LASCAW_CLA_OPENACC (YDSL, YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH,&
    & ILAV, PDLAT, PKAPPAT, YDDHSLMER, PSLDW, PCLA (:,:,:, 1), PCLASLT, YDSTACK=YLSTACK)
    CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH&
    &, PDLO (:,:, 1), PDLOMAD (:,:, 1), PKAPPAT, PCLO (:,:,:, 1, 1), PCLOMAD&
    & (:,:,:, 1, 1), PCLOSLT (:,:,:, 1), YDSTACK=YLSTACK)
    CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH&
    &, PDLO (:,:, 2), PDLOMAD (:,:, 2), PKAPPAT, PCLO (:,:,:, 2, 1), PCLOMAD&
    & (:,:,:, 2, 1), PCLOSLT (:,:,:, 2), YDSTACK=YLSTACK)
  ENDIF


  DO JJ=1, KDIMK

    IF (JJ>1) THEN
      PCLA (JROF, 1:KFLEV, 1:3, JJ)=PCLA (JROF, 1:KFLEV, 1:3, 1)
      PCLAMAD (JROF, 1:KFLEV, 1:3, JJ)=PCLAMAD (JROF, 1:KFLEV, 1:3, 1)
    ENDIF


    IF ((KSPLTHOI==1).AND.(JJ==KDIMK)) THEN
      ZCLA (JROF, 1:KFLEV, 1:3)=PCLA (JROF, 1:KFLEV, 1:3, JJ)
      CALL LASCAW_CLA_OPENACC (YDSL, YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_PHYS, ZSLHDKMINH, ILAV&
      &, PDLAT, ZKHTURB (:,:, JJ), YDDHSLMER, PSLDW, ZCLA, PCLA (:,:,:, JJ), YDSTACK=YLSTACK)
      CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_PHYS, ZSLHDKMINH, PDLO (:,:, 1), PDLOMAD&
      & (:,:, 1), ZKHTURB (:,:, JJ), ZCLO, PCLOMAD (:,:,:, 1, JJ), PCLO (:,:,:, 1, JJ), YDSTACK=YLSTACK)
      CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_PHYS, ZSLHDKMINH, PDLO (:,:, 2), PDLOMAD&
      & (:,:, 2), ZKHTURB (:,:, JJ), ZCLO, PCLOMAD (:,:,:, 2, JJ), PCLO (:,:,:, 2, JJ), YDSTACK=YLSTACK)
    ELSE
      CALL LASCAW_CLA_OPENACC (YDSL, YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH, ILAV,&
      & PDLAT, PKAPPA, YDDHSLMER, PSLDW, PCLA (:,:,:, JJ), PCLASLD (:,:,:, JJ), YDSTACK=YLSTACK)
      CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH&
      &, PDLO (:,:, 1), PDLOMAD (:,:, 1), PKAPPA, PCLO (:,:,:, 1, JJ), PCLOMAD&
      & (:,:,:, 1, JJ), PCLOSLD (:,:,:, 1, JJ), YDSTACK=YLSTACK)
      CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH&
      &, PDLO (:,:, 2), PDLOMAD (:,:, 2), PKAPPA, PCLO (:,:,:, 2, JJ), PCLOMAD&
      & (:,:,:, 2, JJ), PCLOSLD (:,:,:, 2, JJ), YDSTACK=YLSTACK)

      IF (JJ>1.AND.LL3DTURB) THEN
        CALL LASCAW_CLATURB_OPENACC (YDSL, KFLEV, KPROMA, KST, KEND, ILAV, ZKHTURB (&
        &:,:, JJ), P3DTW, PCLA (:,:,:, JJ), PCLASLD (:,:,:, JJ), YDSTACK=YLSTACK)
        CALL LASCAW_CLOTURB_OPENACC (KFLEV, KPROMA, KST, KEND, ZKHTURB (:,:, JJ&
        &), PCLO (:,:,:, 1, JJ), PCLOSLD (:,:,:, 1, JJ), YDSTACK=YLSTACK)
        CALL LASCAW_CLOTURB_OPENACC (KFLEV, KPROMA, KST, KEND, ZKHTURB (:,:, JJ&
        &), PCLO (:,:,:, 2, JJ), PCLOSLD (:,:,:, 2, JJ), YDSTACK=YLSTACK)
      ENDIF

    ENDIF

  ENDDO


  IF (KWIS==102)  THEN
    LLT_SLHD (2)=YDDYNA%HOISLTV/=0._JPRB
  ENDIF


  IF (KWIS==102.AND.YDDYNA%LSLTVWENO.OR.KWIS==106) THEN

    IF (LDREGETA) THEN
      IBCLIM=0
    ELSE
      IBCLIM=1
    ENDIF

    KNOWENO (JROF, 1:KFLEV)=0

    DO JJ=3, 1,-1

      SELECTCASE (JJ)
      CASE (1)
        IILEV (JROF, 1:KFLEV)=KLEV (JROF, 1:KFLEV)
      CASE (2)
        IILEV (JROF, 1:KFLEV)=MIN (IFLVM2-IBCLIM, KLEV (JROF, 1:KFLEV)+1)

        DO JLEV=1, KFLEV
          
          KNOWENO (JROF, JLEV)=KNOWENO (JROF, JLEV)+IILEV (JROF, JLEV)-KLEV (JROF, JLEV)-1
        
        ENDDO

      CASE (3)
        IILEV (JROF, 1:KFLEV)=MAX (IBCLIM, KLEV (JROF, 1:KFLEV)-1)

        DO JLEV=1, KFLEV
          
          KNOWENO (JROF, JLEV)=KNOWENO (JROF, JLEV)+IILEV (JROF, JLEV)-KLEV (JROF, JLEV)+1
        
        ENDDO

      CASE DEFAULT
        CALL FXTRAN_ACDC_ABORT (' LASCAW: WENO PROBLEM')
      ENDSELECT

      CALL LASCAW_VINTW_OPENACC (YDDYNA, KPROMA, KFLEV, KST, KEND, LLCOMADV, LLT_SLHD, LLSLVF&
      &, LDSLHDHEAT, ZSLHDKMINV_WENO, IILEV, PLEV, PDVER, PDVERMAD, PSTDDISW, PKAPPA, PKAPPAT&
      &, PVETA, PVCUICO, PVSLD, PVSLDW, PVSLVF, PVINTW (:,:, 3*(JJ-1)+1), PVINTWMAD, PVINTWSLD&
      &, PVINTWSLT, PVINTWSLVF (:,:, 3*(JJ-1)+1), YDSTACK=YLSTACK)
    ENDDO


    IF (ANY (ABS (KNOWENO (JROF, 1:KFLEV))>1+IBCLIM))  THEN
      CALL FXTRAN_ACDC_ABORT (' LASCAW: Something strange is happening about level shifts.')
    ENDIF


    IF (LDREGETA) THEN

      DO JLEV=1, KFLEV
        
        PCW (JROF, JLEV, 1)=0.10_JPRB*(2.0_JPRB+PDVER (JROF, JLEV))*(3.0_JPRB-PDVER (JROF, JLEV))
        PCW (JROF, JLEV, 2)=0.05_JPRB*(2.0_JPRB+PDVER (JROF, JLEV))*(1.0_JPRB+PDVER (JROF, JLEV))
        PCW (JROF, JLEV, 3)=0.05_JPRB*(2.0_JPRB-PDVER (JROF, JLEV))*(3.0_JPRB-PDVER (JROF, JLEV))
      
      ENDDO

    ELSE

      DO JLEV=1, KFLEV
        
        ILEV=KLEV (JROF, JLEV)

        IF (ILEV>1.AND.ILEV<KFLEV-3) THEN
          Z1=PLEV (JROF, JLEV)-PVETA (ILEV-1)
          Z4=PLEV (JROF, JLEV)-PVETA (ILEV+4)
          PCW (JROF, JLEV, 1)=PGAMMA_WENO (ILEV, 1)*Z1*Z4
          PCW (JROF, JLEV, 2)=PGAMMA_WENO (ILEV, 2)*Z1*(PLEV (JROF, JLEV)-PVETA (ILEV))
          PCW (JROF, JLEV, 3)=PGAMMA_WENO (ILEV, 3)*(PLEV (JROF, JLEV)-PVETA (ILEV+3))*Z4
        ENDIF

      
      ENDDO

    ENDIF

  ELSE
    CALL LASCAW_VINTW_OPENACC (YDDYNA, KPROMA, KFLEV, KST, KEND, LLCOMADV, LLT_SLHD, LLSLVF, LDSLHDHEAT&
    &, ZSLHDKMINV, KLEV, PLEV, PDVER, PDVERMAD, PSTDDISW, PKAPPA, PKAPPAT, PVETA, PVCUICO, PVSLD, PVSLDW&
    &, PVSLVF, PVINTW, PVINTWMAD, PVINTWSLD, PVINTWSLT, PVINTWSLVF, YDSTACK=YLSTACK)
  ENDIF


  IF (KWIS==104) THEN

    DO JLEV=1, KFLEV
      
      ZDVER=PDVER (JROF, JLEV)
      PHVW (JROF, JLEV, 1)=FHLO1 (ZDVER)
      PHVW (JROF, JLEV, 2)=FHLO2 (ZDVER)
      PHVW (JROF, JLEV, 3)=FHLO3 (ZDVER)
      PHVW (JROF, JLEV, 4)=FHLO4 (ZDVER)
      
      
      ILEV=KLEV (JROF, JLEV)
      Z1=PVETA (ILEV+1)
      Z2=PVETA (ILEV+2)
      ZW1=(Z2-Z1)/(Z2-PVETA (ILEV))
      ZW2=(Z2-Z1)/(PVETA (ILEV+3)-Z1)

      IF (ILEV>=1.AND.ILEV<=KFLEV-3) THEN
        PVDERW (JROF, JLEV, 1, 1)=ZW1
        PVDERW (JROF, JLEV, 2, 1)=ZW1
        PVDERW (JROF, JLEV, 1, 2)=ZW2
        PVDERW (JROF, JLEV, 2, 2)=ZW2
      ELSEIF (ILEV==0) THEN
        PVDERW (JROF, JLEV, 1, 1)=0.0_JPRB
        PVDERW (JROF, JLEV, 2, 1)=2._JPRB*ZW1
        PVDERW (JROF, JLEV, 1, 2)=ZW2
        PVDERW (JROF, JLEV, 2, 2)=ZW2
      ELSEIF (ILEV==KFLEV-2) THEN
        PVDERW (JROF, JLEV, 1, 1)=ZW1
        PVDERW (JROF, JLEV, 2, 1)=ZW1
        PVDERW (JROF, JLEV, 1, 2)=2._JPRB*ZW2
        PVDERW (JROF, JLEV, 2, 2)=0.0_JPRB
      ENDIF

    
    ENDDO

  ENDIF


  IF (KWIS==105) THEN

    DO JLEV=1, KFLEV
      
      ILEV64=KLEV (JROF, JLEV)
      Z1=PLEV (JROF, JLEV)-PVETA (ILEV64+1)
      PVINTWS (JROF, JLEV, 1)=YDVSPLIP%RFVV(4, ILEV64, 1)+Z1*(YDVSPLIP%RFVV(4, ILEV64&
      &, 2)+Z1*(YDVSPLIP%RFVV(4, ILEV64, 3)+Z1*YDVSPLIP%RFVV(4, ILEV64, 4)))
      PVINTWS (JROF, JLEV, 2)=YDVSPLIP%RFVV(3, ILEV64+1, 1)+Z1*(YDVSPLIP%RFVV(3, ILEV64&
      &+1, 2)+Z1*(YDVSPLIP%RFVV(3, ILEV64+1, 3)+Z1*YDVSPLIP%RFVV(3, ILEV64+1, 4)))
      PVINTWS (JROF, JLEV, 3)=YDVSPLIP%RFVV(2, ILEV64+2, 1)+Z1*(YDVSPLIP%RFVV(2, ILEV64&
      &+2, 2)+Z1*(YDVSPLIP%RFVV(2, ILEV64+2, 3)+Z1*YDVSPLIP%RFVV(2, ILEV64+2, 4)))
      PVINTWS (JROF, JLEV, 4)=YDVSPLIP%RFVV(1, ILEV64+3, 1)+Z1*(YDVSPLIP%RFVV(1, ILEV64&
      &+3, 2)+Z1*(YDVSPLIP%RFVV(1, ILEV64+3, 3)+Z1*YDVSPLIP%RFVV(1, ILEV64+3, 4)))
    
    ENDDO

  ENDIF

ENDIF


IF (KWIS==201) THEN

  IF (KHOR==1)  THEN
    IOFF=0
  ENDIF


  DO JLEV=1, KFLEV

    IF (KHOR==0)  THEN
      IOFF=YDSL%NASLB1*JLEV
    ENDIF

    
    ZLO1=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+1)
    ILO1 =INT (ZLO1)
    PDLO (JROF, JLEV, 1)=ZLO1-ILO1 
    ZLO2=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+2)
    ILO2 =INT (ZLO2)
    PDLO (JROF, JLEV, 2)=ZLO2-ILO2 
    
    
    IL=ILAV (JROF, JLEV)
    KL0 (JROF, JLEV, 1)=YDSL%NADDR (ILAV (JROF, JLEV)+1, KFLDN)+YDSL%NSLEXT (ILO1 , IL+1)+IOFF
    KL0 (JROF, JLEV, 2)=YDSL%NADDR (ILAV (JROF, JLEV)+2, KFLDN)+YDSL%NSLEXT (ILO2 , IL+2)+IOFF
  
  ENDDO


  IF (YDSL%NPROC>1.AND.YDSL%LSLONDEM_ACTIVE) THEN

    DO JLEV=1, KFLEV
      
      KMASK_SL2 (KL0 (JROF, JLEV, 1):KL0 (JROF, JLEV, 1)+3)=1
    
    ENDDO


    DO JLEV=1, KFLEV
      
      KMASK_SL2 (KL0 (JROF, JLEV, 2):KL0 (JROF, JLEV, 2)+3)=1
    
    ENDDO

  ENDIF

ENDIF


IF (KWIS==202.OR.KWIS==203) THEN

  IF (KHOR==1)  THEN
    IOFF=0
  ENDIF


  DO JLEV=1, KFLEV

    IF (KHOR==0)  THEN
      IOFF=YDSL%NASLB1*JLEV
    ENDIF

    
    ZLO=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV))
    ILO0 =INT (ZLO)
    PDLO (JROF, JLEV, 0)=ZLO-ILO0 
    ZLO1=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+1)
    ILO1 =INT (ZLO1)
    PDLO (JROF, JLEV, 1)=ZLO1-ILO1 
    ZLO2=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+2)
    ILO2 =INT (ZLO2)
    PDLO (JROF, JLEV, 2)=ZLO2-ILO2 
    ZLO3=PLON (JROF, JLEV)*YDSL%RLSDEPI (ILAV (JROF, JLEV)+3)
    ILO3 =INT (ZLO3)
    PDLO (JROF, JLEV, 3)=ZLO3-ILO3 
    
    
    IL=ILAV (JROF, JLEV)
    KL0 (JROF, JLEV, 0)=YDSL%NADDR (ILAV (JROF, JLEV)+0, KFLDN)+YDSL%NSLEXT (ILO0 , IL+0)+IOFF
    KL0 (JROF, JLEV, 1)=YDSL%NADDR (ILAV (JROF, JLEV)+1, KFLDN)+YDSL%NSLEXT (ILO1 , IL+1)+IOFF
    KL0 (JROF, JLEV, 2)=YDSL%NADDR (ILAV (JROF, JLEV)+2, KFLDN)+YDSL%NSLEXT (ILO2 , IL+2)+IOFF
    KL0 (JROF, JLEV, 3)=YDSL%NADDR (ILAV (JROF, JLEV)+3, KFLDN)+YDSL%NSLEXT (ILO3 , IL+3)+IOFF
  
  ENDDO


  IF (YDSL%NPROC>1.AND.YDSL%LSLONDEM_ACTIVE) THEN

    DO JLEV=1, KFLEV
      
      KMASK_SL2 (KL0 (JROF, JLEV, 0):KL0 (JROF, JLEV, 0)+3)=1
    
    ENDDO


    DO JLEV=1, KFLEV
      
      KMASK_SL2 (KL0 (JROF, JLEV, 1):KL0 (JROF, JLEV, 1)+3)=1
    
    ENDDO


    DO JLEV=1, KFLEV
      
      KMASK_SL2 (KL0 (JROF, JLEV, 2):KL0 (JROF, JLEV, 2)+3)=1
    
    ENDDO


    DO JLEV=1, KFLEV
      
      KMASK_SL2 (KL0 (JROF, JLEV, 3):KL0 (JROF, JLEV, 3)+3)=1
    
    ENDDO

  ENDIF


  DO JLEV=1, KFLEV
    
    Z1=PLATI (ILAV (JROF, JLEV)+1)
    Z2=PLATI (ILAV (JROF, JLEV)+2)
    PDLAT (JROF, JLEV)=(PLAT (JROF, JLEV)-Z1)/(Z2-Z1)
    ZDA=PLAT (JROF, JLEV)-PLATI (ILAV (JROF, JLEV))
    ZDB=PLAT (JROF, JLEV)-Z1
    ZDC=PLAT (JROF, JLEV)-Z2
    ZDD=PLAT (JROF, JLEV)-PLATI (ILAV (JROF, JLEV)+3)
    Z2=ZDA*ZDB
    PCLA (JROF, JLEV, 1, 1)=(ZDA*ZDC)*ZDD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 1)
    PCLA (JROF, JLEV, 2, 1)=Z2*ZDD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 2)
    PCLA (JROF, JLEV, 3, 1)=Z2*ZDC*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 3)

    IF (LLCOMADH) THEN
      PDLAMAD (JROF, JLEV)=PDLAT (JROF, JLEV)*PSTDDISV (JROF&
      &, JLEV)+0.5_JPRB*(1._JPRB-PSTDDISV (JROF, JLEV))
      Z1=1._JPRB/PSTDDISV (JROF, JLEV)
      Z4=0.5_JPRB*(Z2-Z1)*(Z1-1._JPRB)
      ZDA=(ZDA-ZDB)*Z1
      ZDD=(ZDD-ZDC)*Z1
      ZDB=ZDB+Z4
      ZDC=ZDC-Z4
      ZDA=ZDA+ZDB
      ZDD=ZDD+ZDC
      Z2=ZDA*ZDB
      Z3=PSTDDISV (JROF, JLEV)**3
      PCLAMAD (JROF, JLEV, 1, 1)=ZDA*ZDC*ZDD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 1)*Z3
      PCLAMAD (JROF, JLEV, 2, 1)=Z2*ZDD*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 2)*Z3
      PCLAMAD (JROF, JLEV, 3, 1)=Z2*ZDC*YDDHSLMER%RIPI (ILAV (JROF, JLEV)+1, 3)*Z3
      PDLOMAD (JROF, JLEV, 0)=PDLO (JROF, JLEV, 0)*PSTDDISU (JROF&
      &, JLEV)+0.5_JPRB*(1._JPRB-PSTDDISU (JROF, JLEV))
      PDLOMAD (JROF, JLEV, 1)=PDLO (JROF, JLEV, 1)*PSTDDISU (JROF&
      &, JLEV)+0.5_JPRB*(1._JPRB-PSTDDISU (JROF, JLEV))
      PDLOMAD (JROF, JLEV, 2)=PDLO (JROF, JLEV, 2)*PSTDDISU (JROF&
      &, JLEV)+0.5_JPRB*(1._JPRB-PSTDDISU (JROF, JLEV))
      PDLOMAD (JROF, JLEV, 3)=PDLO (JROF, JLEV, 3)*PSTDDISU (JROF&
      &, JLEV)+0.5_JPRB*(1._JPRB-PSTDDISU (JROF, JLEV))
    ELSE
      PDLAMAD (JROF, JLEV)=PDLAT (JROF, JLEV)
      PCLAMAD (JROF, JLEV, 1, 1)=PCLA (JROF, JLEV, 1, 1)
      PCLAMAD (JROF, JLEV, 2, 1)=PCLA (JROF, JLEV, 2, 1)
      PCLAMAD (JROF, JLEV, 3, 1)=PCLA (JROF, JLEV, 3, 1)
      PDLOMAD (JROF, JLEV, 0)=PDLO (JROF, JLEV, 0)
      PDLOMAD (JROF, JLEV, 1)=PDLO (JROF, JLEV, 1)
      PDLOMAD (JROF, JLEV, 2)=PDLO (JROF, JLEV, 2)
      PDLOMAD (JROF, JLEV, 3)=PDLO (JROF, JLEV, 3)
    ENDIF

  
  ENDDO

  CALL LASCAW_CLA_OPENACC (YDSL, YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH, ILAV&
  &, PDLAT, PKAPPA, YDDHSLMER, PSLDW, PCLA (:,:,:, 1), PCLASLD (:,:,:, 1), YDSTACK=YLSTACK)
  CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH&
  &, PDLO (:,:, 1), PDLOMAD (:,:, 1), PKAPPA, PCLO (:,:,:, 1, 1), PCLOMAD&
  & (:,:,:, 1, 1), PCLOSLD (:,:,:, 1, 1), YDSTACK=YLSTACK)
  CALL LASCAW_CLO_OPENACC (YDDYNA, KFLEV, KPROMA, KST, KEND, LLT_SLHD, ZSLHDKMINH&
  &, PDLO (:,:, 2), PDLOMAD (:,:, 2), PKAPPA, PCLO (:,:,:, 2, 1), PCLOMAD&
  & (:,:,:, 2, 1), PCLOSLD (:,:,:, 2, 1), YDSTACK=YLSTACK)
ENDIF



END SUBROUTINE LASCAW_OPENACC
