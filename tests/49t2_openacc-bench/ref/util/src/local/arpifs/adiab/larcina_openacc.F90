
SUBROUTINE LARCINA_OPENACC (YDGEOMETRY, YDCST, YDML_DYN, KST, KEND, YDSL, KHVI, LDFINDVSEP&
&, LDSLHD, LDSLHDQUAD, LDINTV, KTIP, KROT, LDPLANE, PSCO, PLEV, PKAPPA, PKAPPAT, PKAPPAM&
&, PKAPPAH, PSTDDISU, PSTDDISV, PSTDDISW, PURL0, PVRL0, PZRL0, PWRL0, KMASK_SL2, KVSEPC&
&, KVSEPL, PCCO, PUF0, PVF0, PZF0, PWF0, PWFSM, KL0, KLH0, KLEV, PLSCAW, PRSCAW, KDEP&
&, KNOWENO, PRCOLON, PRSILON, PGECLO, PGEMU, PGESLO, PGSQM2, YDSTACK)
!$ACC ROUTINE (LARCINA_OPENACC) SEQ
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE PARKIND1,ONLY:JPIM, JPRB, JPRD

USE YOMCST,ONLY:TCST
USE EINT_MOD,ONLY:SL_STRUCT
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TCST), INTENT (IN)::YDCST
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
INTEGER (KIND=JPIM), INTENT (IN)::KHVI
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
TYPE (SL_STRUCT), INTENT (IN)::YDSL
LOGICAL, INTENT (IN)::LDFINDVSEP
LOGICAL, INTENT (IN)::LDSLHD
LOGICAL, INTENT (IN)::LDSLHDQUAD
LOGICAL, INTENT (IN)::LDINTV
INTEGER (KIND=JPIM), INTENT (IN)::KTIP
INTEGER (KIND=JPIM), INTENT (IN)::KROT
LOGICAL, INTENT (IN)::LDPLANE
REAL (KIND=JPRB), INTENT (IN)::PSCO (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTSCO%NDIM)
REAL (KIND=JPRB), INTENT (IN)::PLEV (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PKAPPA (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PKAPPAT (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PKAPPAM (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PKAPPAH (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PURL0 (YDSL%NASLB1, YDGEOMETRY%YRDIMV%NFLSA:YDGEOMETRY%YRDIMV%NFLEN)
REAL (KIND=JPRB), INTENT (IN)::PVRL0 (YDSL%NASLB1, YDGEOMETRY%YRDIMV%NFLSA:YDGEOMETRY%YRDIMV%NFLEN)
REAL (KIND=JPRB), INTENT (IN)::PZRL0 (YDSL%NASLB1, YDGEOMETRY%YRDIMV%NFLSA:YDGEOMETRY%YRDIMV%NFLEN)
REAL (KIND=JPRB), INTENT (IN)::PWRL0 (YDSL%NASLB1, YDGEOMETRY%YRDIMV%NFLSA:YDGEOMETRY%YRDIMV%NFLEN)
REAL (KIND=JPRB), INTENT (IN)::PSTDDISU (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSTDDISV (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSTDDISW (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
INTEGER (KIND=JPIM), INTENT (INOUT)::KMASK_SL2 (YDSL%NASLMASK)
INTEGER (KIND=JPIM), INTENT (INOUT)::KVSEPC (YDGEOMETRY%YRDIM%NPROMA)
INTEGER (KIND=JPIM), INTENT (INOUT)::KVSEPL (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (INOUT)::PCCO (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTCCO%NDIM)
REAL (KIND=JPRB), INTENT (OUT)::PUF0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PVF0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PZF0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PWF0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PWFSM (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
INTEGER (KIND=JPIM), INTENT (INOUT)::KL0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, 0:3)
INTEGER (KIND=JPIM), INTENT (INOUT)::KLH0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, 0:3)
INTEGER (KIND=JPIM), INTENT (INOUT)::KLEV (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PLSCAW (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTLSCAW%NDIM)
REAL (KIND=JPRB), INTENT (OUT)::PRSCAW (YDGEOMETRY%YRDIM%NPROMA&
&, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTRSCAW%NDIM)
INTEGER (KIND=JPIM), INTENT (OUT)::KDEP (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
INTEGER (KIND=JPIM), INTENT (OUT)::KNOWENO (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRD), INTENT (IN)::PRCOLON (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRD), INTENT (IN)::PRSILON (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PGECLO (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PGEMU (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PGESLO (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN)::PGSQM2 (YDGEOMETRY%YRDIM%NPROMA)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
INTEGER (KIND=JPIM)::ISEP
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::IWIS
INTEGER (KIND=JPIM)::IVSEP
INTEGER (KIND=JPIM)::IMINSEP
INTEGER (KIND=JPIM)::IHOR
INTEGER (KIND=JPIM)::IWENO
LOGICAL::LLDONE

REAL (KIND=JPRB)::ZPIS2
REAL (KIND=JPRB)::ZDEPI
REAL (KIND=JPRB)::ZDSTRET

#include "elarche_openacc.intfb.h"
#include "elascaw_openacc.intfb.h"
#include "laitli_openacc.intfb.h"
#include "laitri_openacc.intfb.h"
#include "laitri_weno_openacc.intfb.h"
#include "larche_openacc.intfb.h"
#include "lascaw_openacc.intfb.h"
#include "laismoo_openacc.intfb.h"

YLSTACK = YDSTACK



JROF = KST




ZDSTRET=2.0_JPRB*YDGEOMETRY%YRGEM%RSTRET
ZDEPI=2.0_JPRB*YDCST%RPI
ZPIS2=0.5_JPRB*YDCST%RPI
IWENO=1

IF (KTIP==1) THEN

  IF (YDML_DYN%YRDYNA%LHOISLT) THEN
    IWIS=102

    IF (YDML_DYN%YRDYNA%LSLTVWENO) THEN
      IWENO=3
    ENDIF

  ELSE
    IWIS=101
  ENDIF

  IHOR=1
ELSEIF (KTIP==2) THEN

  IF (YDML_DYN%YRDYNA%LVSPLIP) THEN
    IWIS=105
  ELSEIF (YDML_DYN%YRDYNA%LRHSVWENO) THEN
    IWIS=106
    IWENO=3
  ELSE
    IWIS=103+KHVI
  ENDIF

  IHOR=1
ELSEIF (KTIP==3) THEN

  IF (YDML_DYN%YRDYNA%LRHSVWENO) THEN
    IWIS=106
    IWENO=3
  ELSE
    IWIS=103
  ENDIF

  IHOR=0
ENDIF


IF (LDPLANE) THEN

  IF (KROT==1) THEN
    CALL ELARCHE_OPENACC (YDCST, YDML_DYN, YDGEOMETRY%YRDIM%NPROMA, KST, KEND&
    &, YDGEOMETRY%YRDIMV%NFLEVG, YDSL, YDGEOMETRY%YREGSL, YDGEOMETRY%YREGEO&
    &, PSCO, PCCO, PGECLO, PGEMU, PGESLO, PGSQM2, YDSTACK=YLSTACK)
  ENDIF

  CALL ELASCAW_OPENACC (YDML_DYN%YRSLINT%YRVSPLIP, YDML_DYN%YRDYN%LSLHDHEAT, YDSL, YDGEOMETRY%YRVERT_GEOM&
  &%YRCVER%LREGETA, YDML_DYN%YRDYNA, YDGEOMETRY%YRDIM%NPROMA, YDML_DYN%YRDYN%NSLDIMK, KST, KEND, YDGEOMETRY&
  &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, IWIS, IHOR, IWENO, KHVI, LDSLHD, LDSLHDQUAD, YDML_DYN%YRDYNA&
  &%LSLHD_OLD, YDML_DYN%YRDYNA%L3DTURB, YDML_DYN%YRDYNA%LCOMAD, YDML_DYN%YRDYNA%LCOMADH, YDML_DYN%YRDYNA&
  &%LCOMADV, YDML_DYN%YRDYN%NSPLTHOI, PSCO (:,:, YDML_DYN%YYTSCO%M_COSCO), PSCO (:,:, YDML_DYN%YYTSCO&
  &%M_SINCO), PLEV, YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF, YDML_DYN%YRSLINT%YRVSLETA%NVAUTF, YDML_DYN%YRSLINT&
  &%YRVSLETA%VCUICO, YDML_DYN%YRSLINT%YRVSLETA%VSLD, YDML_DYN%YRSLINT%YRVSLETA%VSLDW, YDML_DYN%YRSLINT&
  &%YRVSLETA%VSLVF, YDML_DYN%YRSLINT%YRVSLETA%GAMMA_WENO, YDML_DYN%YRSLINT%YRVSLETA%NRLEVX, YDML_DYN%YRSLINT&
  &%YRVSLETA%VRLEVX, PKAPPA, PKAPPAT, PKAPPAM, PKAPPAH, PSTDDISU, PSTDDISV, PSTDDISW, KMASK_SL2, PLSCAW&
  & (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAMAD), PRSCAW (:,:, YDML_DYN&
  &%YYTRSCAW%M_WCLA (1)), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLASLD (1)), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
  &%M_WCLASLT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLAMAD (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO)&
  &, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLOMAD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLO (1)), PRSCAW (:&
  &,:, YDML_DYN%YYTRSCAW%M_WCLOSLD (1)), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOSLT), PRSCAW (:,:, YDML_DYN&
  &%YYTRSCAW%M_WCLOMAD (1)), KL0, KLH0, KLEV, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PLSCAW (&
  &:,:, YDML_DYN%YYTLSCAW%M_WDVER), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDVERMAD), PRSCAW (:,:, YDML_DYN&
  &%YYTRSCAW%M_WVINTW), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTWSLD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTWSLT&
  &), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTWSLVF), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTWMAD), PRSCAW&
  & (:,:, YDML_DYN%YYTRSCAW%M_WVINTWS), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVDERW), PRSCAW (:,:, YDML_DYN&
  &%YYTRSCAW%M_WHVW), KDEP, YDSTACK=YLSTACK)
ELSE

  IF (.NOT.YDML_DYN%YRDYN%LSLDP_XYZ) THEN
    CALL LARCHE_OPENACC (YDML_DYN%YYTCCO, YDML_DYN%YYTSCO, YDGEOMETRY%YRDIM%NPROMA, KST, KEND&
    &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRGEM%NSTTYP, ZDSTRET, YDGEOMETRY%YRGEM%RC2M1, YDGEOMETRY&
    &%YRGEM%RC2P1, YDCST%RPI, ZDEPI, YDGEOMETRY%YRGEM%RLOCEN, YDGEOMETRY%YRGEM%RMUCEN, PSCO, KROT&
    &, PCCO, PRCOLON, PRSILON, PGECLO, PGEMU, PGESLO, PGSQM2, YDSTACK=YLSTACK)
  ENDIF

  CALL LASCAW_OPENACC (YDML_DYN%YRSLINT%YRVSPLIP, YDSL, YDGEOMETRY%YRVERT_GEOM%YRCVER%LREGETA, YDML_DYN&
  &%YRDYNA, YDGEOMETRY%YRDIM%NPROMA, YDML_DYN%YRDYN%NSLDIMK, KST, KEND, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY&
  &%YRDIMV%NFLSA, IWIS, IHOR, IWENO, KHVI, LDSLHD, LDSLHDQUAD, YDML_DYN%YRDYNA%LSLHD_OLD, YDML_DYN%YRDYN&
  &%LSLHDHEAT, YDML_DYN%YRDYNA%L3DTURB, YDML_DYN%YRDYNA%LCOMAD, YDML_DYN%YRDYNA%LCOMADH, YDML_DYN%YRDYNA&
  &%LCOMADV, YDML_DYN%YRDYN%NSPLTHOI, YDGEOMETRY%YRGEM%R4JP, ZPIS2, YDGEOMETRY%YRCSGLEG%RLATI (YDSL%NDGSAH&
  &:), YDML_DYN%YRSLINT%YRHSLMER, YDML_DYN%YRSLINT%YRHSLMER%RSLDW(:,:, YDSL%NDGSAH), YDML_DYN%YRSLINT&
  &%YRHSLMER%R3DTW(:,:, YDSL%NDGSAH), PCCO (:,:, YDML_DYN%YYTCCO%M_RLON), PCCO (:,:, YDML_DYN%YYTCCO%M_RLAT&
  &), PLEV, YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF, YDML_DYN%YRSLINT%YRVSLETA%NVAUTF, YDML_DYN%YRSLINT%YRVSLETA&
  &%VCUICO, YDML_DYN%YRSLINT%YRVSLETA%VSLD, YDML_DYN%YRSLINT%YRVSLETA%VSLDW, YDML_DYN%YRSLINT%YRVSLETA&
  &%VSLVF, YDML_DYN%YRSLINT%YRVSLETA%GAMMA_WENO, YDML_DYN%YRSLINT%YRVSLETA%NRLEVX, YDML_DYN%YRSLINT%YRVSLETA&
  &%VRLEVX, PKAPPA, PKAPPAT, PKAPPAM, PKAPPAH, PSTDDISU, PSTDDISV, PSTDDISW, KMASK_SL2, PLSCAW (:,:, YDML_DYN&
  &%YYTLSCAW%M_WDLAT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAMAD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLA&
  & (1)), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLASLD (1)), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLASLT), PRSCAW&
  & (:,:, YDML_DYN%YYTRSCAW%M_WCLAMAD (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PLSCAW (:,:, YDML_DYN&
  &%YYTLSCAW%M_WDLOMAD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLO (1)), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOSLD&
  & (1)), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOSLT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOMAD (1)), KL0&
  &, KLH0, KLEV, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDVER&
  &), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDVERMAD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PRSCAW (:&
  &,:, YDML_DYN%YYTRSCAW%M_WVINTWSLD), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTWSLT), PRSCAW (:,:, YDML_DYN&
  &%YYTRSCAW%M_WVINTWSLVF), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTWMAD), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
  &%M_WVINTWS), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVDERW), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WHVW), YDSTACK&
  &=YLSTACK)
ENDIF


IF (LDFINDVSEP) THEN
  
  IVSEP=KVSEPC (JROF)-1
  LLDONE=.FALSE.

  DO WHILE (.NOT.LLDONE)
    IVSEP=IVSEP+1
    ISEP=KLEV (JROF, IVSEP+1)-KLEV (JROF, 1)

    DO JLEV=2, YDGEOMETRY%YRDIMV%NFLEVG-IVSEP
      ISEP=MIN (ISEP,(KLEV (JROF, JLEV+IVSEP)-KLEV (JROF, JLEV)))
    ENDDO

    IMINSEP=MIN (YDGEOMETRY%YRDIMV%NFLEVG, ISEP)
    LLDONE=IMINSEP>=4.OR.IVSEP==YDGEOMETRY%YRDIMV%NFLEVG-1
  ENDDO


  IF (IMINSEP<4) THEN
    CALL FXTRAN_ACDC_ABORT ('LARCINA: UNABLE TO COMPUTE NVSEPC')
  ENDIF

  KVSEPC (JROF)=MAX (KVSEPC (JROF), IVSEP)
  
  
  IVSEP=KVSEPL (JROF)-1
  LLDONE=.FALSE.

  DO WHILE (.NOT.LLDONE)
    IVSEP=IVSEP+1
    ISEP=KLEV (JROF, IVSEP+1)-KLEV (JROF, 1)

    DO JLEV=2, YDGEOMETRY%YRDIMV%NFLEVG-IVSEP
      ISEP=MIN (ISEP,(KLEV (JROF, JLEV+IVSEP)-KLEV (JROF, JLEV)))
    ENDDO

    IMINSEP=MIN (YDGEOMETRY%YRDIMV%NFLEVG, ISEP)
    LLDONE=IMINSEP>=2.OR.IVSEP==YDGEOMETRY%YRDIMV%NFLEVG-1
  ENDDO


  IF (IMINSEP<2) THEN
    CALL FXTRAN_ACDC_ABORT ('LARCINA: UNABLE TO COMPUTE NVSEPL')
  ENDIF

  KVSEPL (JROF)=MAX (KVSEPL (JROF), IVSEP)
  
ENDIF


IF (LDINTV) THEN

  IF (YDML_DYN%YRDYNA%LSLTVWENO) THEN
    CALL LAITRI_WENO_OPENACC (YDML_DYN%YRDYN, YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND&
    &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN&
    &%NQMHOISLT, YDML_DYN%YRDYN%CLAITRI_WENO_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW&
    & (:,:, YDML_DYN%YYTRSCAW%M_WCLA (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:&
    &,:, YDML_DYN%YYTRSCAW%M_WCLO (1)), KL0, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PRSCAW&
    & (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PURL0, PUF0, YDSTACK=YLSTACK)
    CALL LAITRI_WENO_OPENACC (YDML_DYN%YRDYN, YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND&
    &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN&
    &%NQMHOISLT, YDML_DYN%YRDYN%CLAITRI_WENO_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW&
    & (:,:, YDML_DYN%YYTRSCAW%M_WCLA (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:&
    &,:, YDML_DYN%YYTRSCAW%M_WCLO (1)), KL0, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PRSCAW&
    & (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PVRL0, PVF0, YDSTACK=YLSTACK)

    IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN
      CALL LAITRI_WENO_OPENACC (YDML_DYN%YRDYN, YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND&
      &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN&
      &%NQMHOISLT, YDML_DYN%YRDYN%CLAITRI_WENO_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW&
      & (:,:, YDML_DYN%YYTRSCAW%M_WCLA (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:&
      &,:, YDML_DYN%YYTRSCAW%M_WCLO (1)), KL0, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PRSCAW&
      & (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PZRL0, PZF0, YDSTACK=YLSTACK)
    ENDIF

    CALL LAITRI_WENO_OPENACC (YDML_DYN%YRDYN, YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND&
    &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN&
    &%NQMHOISLT, YDML_DYN%YRDYN%CLAITRI_WENO_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW&
    & (:,:, YDML_DYN%YYTRSCAW%M_WCLA (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:&
    &,:, YDML_DYN%YYTRSCAW%M_WCLO (1)), KL0, KNOWENO, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_CW), PRSCAW&
    & (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PWRL0, PWF0, YDSTACK=YLSTACK)
  ELSEIF (YDML_DYN%YRDYNA%LHOISLT) THEN
    CALL LAITRI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY%YRDIMV%NFLEVG&
    &, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN%NQMHOISLT, YDML_DYN%YRDYN&
    &%CLAITRI_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLA&
    & (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLO (1)),&
    & KL0, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PURL0, PUF0, YDSTACK=YLSTACK)
    CALL LAITRI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY%YRDIMV%NFLEVG&
    &, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN%NQMHOISLT, YDML_DYN%YRDYN&
    &%CLAITRI_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLA&
    & (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLO (1)),&
    & KL0, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PVRL0, PVF0, YDSTACK=YLSTACK)

    IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN
      CALL LAITRI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY%YRDIMV%NFLEVG&
      &, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN%NQMHOISLT, YDML_DYN%YRDYN&
      &%CLAITRI_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLA&
      & (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLO (1)),&
      & KL0, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PZRL0, PZF0, YDSTACK=YLSTACK)
    ENDIF

    CALL LAITRI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY%YRDIMV%NFLEVG&
    &, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, YDML_DYN%YRDYN%NQMHOISLT, YDML_DYN%YRDYN&
    &%CLAITRI_TYPE, PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLAT), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLA&
    & (1)), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLO (1)),&
    & KL0, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WVINTW), PWRL0, PWF0, YDSTACK=YLSTACK)
  ELSE
    CALL LAITLI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY&
    &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW (:,:, YDML_DYN&
    &%YYTLSCAW%M_WDLAT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO+1), KL0 (:,:, 1:2), PLSCAW&
    & (:,:, YDML_DYN%YYTLSCAW%M_WDVER), PURL0, PUF0, YDSTACK=YLSTACK)
    CALL LAITLI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY&
    &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW (:,:, YDML_DYN&
    &%YYTLSCAW%M_WDLAT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO+1), KL0 (:,:, 1:2), PLSCAW&
    & (:,:, YDML_DYN%YYTLSCAW%M_WDVER), PVRL0, PVF0, YDSTACK=YLSTACK)

    IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN
      CALL LAITLI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY&
      &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW (:,:, YDML_DYN&
      &%YYTLSCAW%M_WDLAT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO+1), KL0 (:,:, 1:2), PLSCAW&
      & (:,:, YDML_DYN%YYTLSCAW%M_WDVER), PZRL0, PZF0, YDSTACK=YLSTACK)
    ENDIF

    CALL LAITLI_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY&
    &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW (:,:, YDML_DYN&
    &%YYTLSCAW%M_WDLAT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO+1), KL0 (:,:, 1:2), PLSCAW&
    & (:,:, YDML_DYN%YYTLSCAW%M_WDVER), PWRL0, PWF0, YDSTACK=YLSTACK)
  ENDIF


  IF (YDML_DYN%YRDYN%LSVTSM) THEN
    CALL LAISMOO_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, KST, KEND, YDGEOMETRY&
    &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW (:,:&
    &, YDML_DYN%YYTLSCAW%M_WDLAT), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO), KL0, PLSCAW&
    & (:,:, YDML_DYN%YYTLSCAW%M_WDVER), PWRL0, PWFSM, YDSTACK=YLSTACK)
  ENDIF

ENDIF




END SUBROUTINE LARCINA_OPENACC
