SUBROUTINE APL_ARPEGE_DEEP_CONVECTION_PARALLEL (YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS&
&, YDCPG_OPTS, YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF, YDVARS, YDMODEL, YD_PFPCOR, YD_PQV&
&, YD_PTENHA, YD_PTENQVA, YD_PTENT, YD_PRDG_CVGQ, YD_PRDG_CVGT)
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK

USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE YOMCFU,ONLY:TCFU
USE TYPE_MODEL,ONLY:MODEL
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL), INTENT (IN)::YDMODEL
CLASS (FIELD_3RB), POINTER :: YD_PFPCOR
REAL (KIND=JPRB), POINTER::PFPCOR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQV
REAL (KIND=JPRB), POINTER::PQV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENHA
REAL (KIND=JPRB), POINTER::PTENHA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENQVA
REAL (KIND=JPRB), POINTER::PTENQVA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENT
REAL (KIND=JPRB), POINTER::PTENT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PRDG_CVGQ
REAL (KIND=JPRB), POINTER::PRDG_CVGQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PRDG_CVGT
REAL (KIND=JPRB), POINTER::PRDG_CVGT (:,:,:)
#include "acuptq.intfb.h"
#include "abor1.intfb.h"
#include "acuptq_openacc.intfb.h"
#include "cucalln_mf.intfb.h"
#include "cucalln_mf_openacc.intfb.h"
#include "culight.intfb.h"
#include "culight_openacc.intfb.h"
CLASS (FIELD_2IM), POINTER :: YL_IBASC
INTEGER (KIND=JPIM), POINTER::IBASC (:,:)
CLASS (FIELD_2IM), POINTER :: YL_IBOTSC
INTEGER (KIND=JPIM), POINTER::IBOTSC (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICBOT
INTEGER (KIND=JPIM), POINTER::ICBOT (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICBOT_LIG
INTEGER (KIND=JPIM), POINTER::ICBOT_LIG (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICTOP
INTEGER (KIND=JPIM), POINTER::ICTOP (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICTOP_LIG
INTEGER (KIND=JPIM), POINTER::ICTOP_LIG (:,:)
INTEGER (KIND=JPIM)::ISPPN2D
CLASS (FIELD_2IM), POINTER :: YL_ITOPC
INTEGER (KIND=JPIM), POINTER::ITOPC (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ITYPE
INTEGER (KIND=JPIM), POINTER::ITYPE (:,:)
CLASS (FIELD_2LM), POINTER :: YL_LLCUM
LOGICAL, POINTER::LLCUM (:,:)
CLASS (FIELD_2LM), POINTER :: YL_LLCUM_LIG
LOGICAL, POINTER::LLCUM_LIG (:,:)
LOGICAL::LLDSLPHY
CLASS (FIELD_2LM), POINTER :: YL_LLLAND
LOGICAL, POINTER::LLLAND (:,:)
CLASS (FIELD_2LM), POINTER :: YL_LLLINOX
LOGICAL, POINTER::LLLINOX (:,:)
CLASS (FIELD_2LM), POINTER :: YL_LLSC
LOGICAL, POINTER::LLSC (:,:)
CLASS (FIELD_2LM), POINTER :: YL_LLSHCV
LOGICAL, POINTER::LLSHCV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZACPR
REAL (KIND=JPRB), POINTER::ZACPR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCDEPTH
REAL (KIND=JPRB), POINTER::ZCDEPTH (:,:)
REAL (KIND=JPRB)::ZCEN (1, 1, 1)
CLASS (FIELD_2RB), POINTER :: YL_ZCTOPH
REAL (KIND=JPRB), POINTER::ZCTOPH (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCUCONVCA
REAL (KIND=JPRB), POINTER::ZCUCONVCA (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDIFF
REAL (KIND=JPRB), POINTER::ZDIFF (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDXTDK
REAL (KIND=JPRB), POINTER::ZDXTDK (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFCQLF
REAL (KIND=JPRB), POINTER::ZFCQLF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFCQLI
REAL (KIND=JPRB), POINTER::ZFCQLI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFHPCL
REAL (KIND=JPRB), POINTER::ZFHPCL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFHPCN
REAL (KIND=JPRB), POINTER::ZFHPCN (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGAW
REAL (KIND=JPRB), POINTER::ZGAW (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGEOM1
REAL (KIND=JPRB), POINTER::ZGEOM1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGEOMH
REAL (KIND=JPRB), POINTER::ZGEOMH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGP2DSPPA
REAL (KIND=JPRB), POINTER::ZGP2DSPPA (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZICE
REAL (KIND=JPRB), POINTER::ZICE (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLCRIT_AER
REAL (KIND=JPRB), POINTER::ZLCRIT_AER (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZLIGH_CTG
REAL (KIND=JPRB), POINTER::ZLIGH_CTG (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLISUM
REAL (KIND=JPRB), POINTER::ZLISUM (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLRAIN
REAL (KIND=JPRB), POINTER::ZLRAIN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLU
REAL (KIND=JPRB), POINTER::ZLU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLUDE
REAL (KIND=JPRB), POINTER::ZLUDE (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZLUDELI
REAL (KIND=JPRB), POINTER::ZLUDELI (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMFD
REAL (KIND=JPRB), POINTER::ZMFD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMFDDE_RATE
REAL (KIND=JPRB), POINTER::ZMFDDE_RATE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMFU
REAL (KIND=JPRB), POINTER::ZMFU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMFUDE_RATE
REAL (KIND=JPRB), POINTER::ZMFUDE_RATE (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPRECMX
REAL (KIND=JPRB), POINTER::ZPRECMX (:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZRSUD
REAL (KIND=JPRB), POINTER::ZRSUD (:,:,:,:)
REAL (KIND=JPRB)::ZSCAV (1)
CLASS (FIELD_4RB), POINTER :: YL_ZSNDE
REAL (KIND=JPRB), POINTER::ZSNDE (:,:,:,:)
REAL (KIND=JPRB)::ZTENC (1, 1, 1)
CLASS (FIELD_3RB), POINTER :: YL_ZTENT
REAL (KIND=JPRB), POINTER::ZTENT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENQ
REAL (KIND=JPRB), POINTER::ZTENQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENU
REAL (KIND=JPRB), POINTER::ZTENU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENV
REAL (KIND=JPRB), POINTER::ZTENV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENTA
REAL (KIND=JPRB), POINTER::ZTENTA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENQA
REAL (KIND=JPRB), POINTER::ZTENQA (:,:,:)
REAL (KIND=JPRB)::ZVDIFTS
CLASS (FIELD_3RB), POINTER :: YL_ZVERVEL
REAL (KIND=JPRB), POINTER::ZVERVEL (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWMEAN
REAL (KIND=JPRB), POINTER::ZWMEAN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZVDISCU
REAL (KIND=JPRB), POINTER::ZVDISCU (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWMFU
REAL (KIND=JPRB), POINTER::ZWMFU (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZWU
REAL (KIND=JPRB), POINTER::ZWU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLGLAC
REAL (KIND=JPRB), POINTER::ZLGLAC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDT
REAL (KIND=JPRB), POINTER::ZTENDT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDQ
REAL (KIND=JPRB), POINTER::ZTENDQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQPFROZ
REAL (KIND=JPRB), POINTER::ZQPFROZ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCHARGE
REAL (KIND=JPRB), POINTER::ZCHARGE (:,:,:)
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
LOGICAL::LLPTQ
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_VVEL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CAPE(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FLASH(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSO(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTH(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCV(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GAW_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GM_T0(:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZWU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWMFU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWMEAN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVERVEL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVDISCU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENTA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENQA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSNDE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 2, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRSUD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 2, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQPFROZ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPRECMX, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMFUDE_RATE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMFU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMFDDE_RATE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMFD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLUDELI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 4, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLUDE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLRAIN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLISUM, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLIGH_CTG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLGLAC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLCRIT_AER, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZICE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGP2DSPPA, UBOUNDS=[YDCPG_OPTS%KLON, 1, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGEOMH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGEOM1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGAW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFHPCN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFHPCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFCQLI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFCQLF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDXTDK, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCUCONVCA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCTOPH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCHARGE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCDEPTH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZACPR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_LLSHCV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_LLSC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_LLLINOX, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_LLLAND, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_LLCUM_LIG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_LLCUM, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ITYPE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ITOPC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICTOP_LIG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICTOP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICBOT_LIG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICBOT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_IBOTSC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_IBASC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
  LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
  ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
  ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
  ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
  ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
  ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
  ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
  ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
  ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
  ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
  ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZGEOM1 (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF (JLON, JLEV, JBLK&
        &)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZVERVEL (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_CTY_VVEL (JLON, JLEV, JBLK&
        &)*Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF (JLON, JLEV, JBLK)
        ZLISUM (JLON, JLEV, JBLK)=0.0_JPRB
        ZLCRIT_AER (JLON, JLEV, JBLK)=5.E-4_JPRB
      ENDDO

    ENDDO


    DO JLEV=0, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZGEOMH (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, JLEV, JBLK&
        &)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZFCQLF (JLON, JLEV, JBLK)=0.0_JPRB
        ZFCQLI (JLON, JLEV, JBLK)=0.0_JPRB
      ENDDO

    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      LLLAND (JLON, JBLK)=(Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)>0.5_JPRB)
      LLSHCV (JLON, JBLK)=.FALSE.
      ZCUCONVCA (JLON, JBLK)=0.0_JPRB
      ZACPR (JLON, JBLK)=0.0_JPRB
      ZDXTDK (JLON, JBLK)=YDGEOMETRY%YRGEM%RDELXN/Z_YDVARS_GEOMETRY_GM_T0 (JLON, JBLK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:INIT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
    LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
    ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
    ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
    ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
    ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
    ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
    ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
    ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
    ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
    ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
    ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:INIT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  LLLAND => NULL ()
  LLSHCV => NULL ()
  ZACPR => NULL ()
  ZCUCONVCA => NULL ()
  ZDXTDK => NULL ()
  ZFCQLF => NULL ()
  ZFCQLI => NULL ()
  ZGEOM1 => NULL ()
  ZGEOMH => NULL ()
  ZLCRIT_AER => NULL ()
  ZLISUM => NULL ()
  ZVERVEL => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
  LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
  ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
  ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
  ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
  ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
  ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
  ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
  ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
  ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
  ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
  ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZGEOM1 (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF (JLON, JLEV, JBLK&
        &)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZVERVEL (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_CTY_VVEL (JLON, JLEV, JBLK&
        &)*Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF (JLON, JLEV, JBLK)
        ZLISUM (JLON, JLEV, JBLK)=0.0_JPRB
        ZLCRIT_AER (JLON, JLEV, JBLK)=5.E-4_JPRB
      
      ENDDO


      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        ZGEOMH (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, JLEV, JBLK&
        &)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZFCQLF (JLON, JLEV, JBLK)=0.0_JPRB
        ZFCQLI (JLON, JLEV, JBLK)=0.0_JPRB
      
      ENDDO

      
      LLLAND (JLON, JBLK)=(Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)>0.5_JPRB)
      LLSHCV (JLON, JBLK)=.FALSE.
      ZCUCONVCA (JLON, JBLK)=0.0_JPRB
      ZACPR (JLON, JBLK)=0.0_JPRB
      ZDXTDK (JLON, JBLK)=YDGEOMETRY%YRGEM%RDELXN/Z_YDVARS_GEOMETRY_GM_T0 (JLON, JBLK)
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:INIT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
    LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
    ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
    ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
    ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
    ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
    ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
    ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
    ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
    ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
    ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
    ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:INIT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  LLLAND => NULL ()
  LLSHCV => NULL ()
  ZACPR => NULL ()
  ZCUCONVCA => NULL ()
  ZDXTDK => NULL ()
  ZFCQLF => NULL ()
  ZFCQLI => NULL ()
  ZGEOM1 => NULL ()
  ZGEOMH => NULL ()
  ZLCRIT_AER => NULL ()
  ZLISUM => NULL ()
  ZVERVEL => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  LLLAND => GET_DEVICE_DATA_RDWR (YL_LLLAND)
  LLSHCV => GET_DEVICE_DATA_RDWR (YL_LLSHCV)
  ZACPR => GET_DEVICE_DATA_RDWR (YL_ZACPR)
  ZCUCONVCA => GET_DEVICE_DATA_RDWR (YL_ZCUCONVCA)
  ZDXTDK => GET_DEVICE_DATA_RDWR (YL_ZDXTDK)
  ZFCQLF => GET_DEVICE_DATA_RDWR (YL_ZFCQLF)
  ZFCQLI => GET_DEVICE_DATA_RDWR (YL_ZFCQLI)
  ZGEOM1 => GET_DEVICE_DATA_RDWR (YL_ZGEOM1)
  ZGEOMH => GET_DEVICE_DATA_RDWR (YL_ZGEOMH)
  ZLCRIT_AER => GET_DEVICE_DATA_RDWR (YL_ZLCRIT_AER)
  ZLISUM => GET_DEVICE_DATA_RDWR (YL_ZLISUM)
  ZVERVEL => GET_DEVICE_DATA_RDWR (YL_ZVERVEL)
  Z_YDCPG_DYN0_CTY_VVEL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (LLLAND, LLSHCV, YDCPG_OPTS, YDGEOMETRY, YFXTRAN_ACDC_STACK, ZACPR, &
    !$ACC&         ZCUCONVCA, ZDXTDK, ZFCQLF, ZFCQLI, ZGEOM1, ZGEOMH, ZLCRIT_AER, ZLISUM, &
    !$ACC&         ZVERVEL, Z_YDCPG_DYN0_CTY_VVEL, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
    !$ACC&         Z_YDMF_PHYS_SURF_GSD_VF_PLSM, Z_YDVARS_GEOMETRY_GM_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZGEOM1 (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF (JLON, JLEV, JBLK&
        &)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZVERVEL (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_CTY_VVEL (JLON, JLEV, JBLK&
        &)*Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF (JLON, JLEV, JBLK)
        ZLISUM (JLON, JLEV, JBLK)=0.0_JPRB
        ZLCRIT_AER (JLON, JLEV, JBLK)=5.E-4_JPRB
      
      ENDDO


      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        ZGEOMH (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, JLEV, JBLK&
        &)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZFCQLF (JLON, JLEV, JBLK)=0.0_JPRB
        ZFCQLI (JLON, JLEV, JBLK)=0.0_JPRB
      
      ENDDO

      
      LLLAND (JLON, JBLK)=(Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)>0.5_JPRB)
      LLSHCV (JLON, JBLK)=.FALSE.
      ZCUCONVCA (JLON, JBLK)=0.0_JPRB
      ZACPR (JLON, JBLK)=0.0_JPRB
      ZDXTDK (JLON, JBLK)=YDGEOMETRY%YRGEM%RDELXN/Z_YDVARS_GEOMETRY_GM_T0 (JLON, JBLK)
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:INIT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
    LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
    ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
    ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
    ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
    ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
    ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
    ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
    ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
    ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
    ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
    ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:INIT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  LLLAND => NULL ()
  LLSHCV => NULL ()
  ZACPR => NULL ()
  ZCUCONVCA => NULL ()
  ZDXTDK => NULL ()
  ZFCQLF => NULL ()
  ZFCQLI => NULL ()
  ZGEOM1 => NULL ()
  ZGEOMH => NULL ()
  ZLCRIT_AER => NULL ()
  ZLISUM => NULL ()
  ZVERVEL => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:INIT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:INIT',1,ZHOOK_HANDLE_PARALLEL)
LLPTQ=.FALSE.
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
  PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL ACUPTQ (YDMODEL%YRCST, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
    &%KFLEVG, 0, LLPTQ, Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCL&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
    &(:, JBLK), PTENHA(:,:, JBLK), PTENQVA(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ACUPTQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ACUPTQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PTENHA => NULL ()
  PTENQVA => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
  PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACUPTQ_OPENACC (YDMODEL%YRCST, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KFLEVG, 0, LLPTQ, Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
      &(:, JBLK), PTENHA(:,:, JBLK), PTENQVA(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ACUPTQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ACUPTQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PTENHA => NULL ()
  PTENQVA => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PTENHA => GET_DEVICE_DATA_RDWR (YD_PTENHA)
  PTENQVA => GET_DEVICE_DATA_RDWR (YD_PTENQVA)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCCQL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRTH => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PTENHA, PTENQVA, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_BASE_STATE_Q, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_DIFCQ, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFCS, Z_YDMF_PHYS_OUT_DIFTQ, Z_YDMF_PHYS_OUT_DIFTS, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCCQL, Z_YDMF_PHYS_OUT_FCCQN, Z_YDMF_PHYS_OUT_FPEVPCL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPEVPCN, Z_YDMF_PHYS_OUT_FPFPCL, Z_YDMF_PHYS_OUT_FPFPCN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPLCL, Z_YDMF_PHYS_OUT_FPLCN, Z_YDMF_PHYS_OUT_FRSO, &
    !$ACC&         Z_YDMF_PHYS_OUT_FRTH) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACUPTQ_OPENACC (YDMODEL%YRCST, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KFLEVG, 0, LLPTQ, Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
      &(:, JBLK), PTENHA(:,:, JBLK), PTENQVA(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ACUPTQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ACUPTQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PTENHA => NULL ()
  PTENQVA => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ACUPTQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ACUPTQ',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_CVGQ => GET_HOST_DATA_RDONLY (YD_PRDG_CVGQ)
  PRDG_CVGT => GET_HOST_DATA_RDONLY (YD_PRDG_CVGT)
  PTENHA => GET_HOST_DATA_RDONLY (YD_PTENHA)
  PTENQVA => GET_HOST_DATA_RDONLY (YD_PTENQVA)
  ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
  ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
  ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
  ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
  ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
  ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZTENT (JLON, JLEV, JBLK)=PTENHA (JLON, JLEV, JBLK)/Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
        & (JLON, JLEV, JBLK)
        ZTENQ (JLON, JLEV, JBLK)=PTENQVA (JLON, JLEV, JBLK)
        ZTENU (JLON, JLEV, JBLK)=0.0_JPRB
        ZTENV (JLON, JLEV, JBLK)=0.0_JPRB
        ZTENDT (JLON, JLEV, JBLK)=PRDG_CVGT (JLON, JLEV, JBLK)
        ZTENDQ (JLON, JLEV, JBLK)=PRDG_CVGQ (JLON, JLEV, JBLK)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ZERO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PRDG_CVGQ => GET_HOST_DATA_RDWR (YD_PRDG_CVGQ)
    PRDG_CVGT => GET_HOST_DATA_RDWR (YD_PRDG_CVGT)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
    ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
    ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
    ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
    ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ZERO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_CVGQ => NULL ()
  PRDG_CVGT => NULL ()
  PTENHA => NULL ()
  PTENQVA => NULL ()
  ZTENDQ => NULL ()
  ZTENDT => NULL ()
  ZTENQ => NULL ()
  ZTENT => NULL ()
  ZTENU => NULL ()
  ZTENV => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_CVGQ => GET_HOST_DATA_RDONLY (YD_PRDG_CVGQ)
  PRDG_CVGT => GET_HOST_DATA_RDONLY (YD_PRDG_CVGT)
  PTENHA => GET_HOST_DATA_RDONLY (YD_PTENHA)
  PTENQVA => GET_HOST_DATA_RDONLY (YD_PTENQVA)
  ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
  ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
  ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
  ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
  ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
  ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZTENT (JLON, JLEV, JBLK)=PTENHA (JLON, JLEV, JBLK)/Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
        & (JLON, JLEV, JBLK)
        ZTENQ (JLON, JLEV, JBLK)=PTENQVA (JLON, JLEV, JBLK)
        ZTENU (JLON, JLEV, JBLK)=0.0_JPRB
        ZTENV (JLON, JLEV, JBLK)=0.0_JPRB
        ZTENDT (JLON, JLEV, JBLK)=PRDG_CVGT (JLON, JLEV, JBLK)
        ZTENDQ (JLON, JLEV, JBLK)=PRDG_CVGQ (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ZERO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PRDG_CVGQ => GET_HOST_DATA_RDWR (YD_PRDG_CVGQ)
    PRDG_CVGT => GET_HOST_DATA_RDWR (YD_PRDG_CVGT)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
    ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
    ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
    ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
    ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ZERO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_CVGQ => NULL ()
  PRDG_CVGT => NULL ()
  PTENHA => NULL ()
  PTENQVA => NULL ()
  ZTENDQ => NULL ()
  ZTENDT => NULL ()
  ZTENQ => NULL ()
  ZTENT => NULL ()
  ZTENU => NULL ()
  ZTENV => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_CVGQ => GET_DEVICE_DATA_RDONLY (YD_PRDG_CVGQ)
  PRDG_CVGT => GET_DEVICE_DATA_RDONLY (YD_PRDG_CVGT)
  PTENHA => GET_DEVICE_DATA_RDONLY (YD_PTENHA)
  PTENQVA => GET_DEVICE_DATA_RDONLY (YD_PTENQVA)
  ZTENDQ => GET_DEVICE_DATA_RDWR (YL_ZTENDQ)
  ZTENDT => GET_DEVICE_DATA_RDWR (YL_ZTENDT)
  ZTENQ => GET_DEVICE_DATA_RDWR (YL_ZTENQ)
  ZTENT => GET_DEVICE_DATA_RDWR (YL_ZTENT)
  ZTENU => GET_DEVICE_DATA_RDWR (YL_ZTENU)
  ZTENV => GET_DEVICE_DATA_RDWR (YL_ZTENV)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PRDG_CVGQ, PRDG_CVGT, PTENHA, PTENQVA, YDCPG_OPTS, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZTENDQ, ZTENDT, ZTENQ, ZTENT, ZTENU, ZTENV, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZTENT (JLON, JLEV, JBLK)=PTENHA (JLON, JLEV, JBLK)/Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
        & (JLON, JLEV, JBLK)
        ZTENQ (JLON, JLEV, JBLK)=PTENQVA (JLON, JLEV, JBLK)
        ZTENU (JLON, JLEV, JBLK)=0.0_JPRB
        ZTENV (JLON, JLEV, JBLK)=0.0_JPRB
        ZTENDT (JLON, JLEV, JBLK)=PRDG_CVGT (JLON, JLEV, JBLK)
        ZTENDQ (JLON, JLEV, JBLK)=PRDG_CVGQ (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ZERO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PRDG_CVGQ => GET_HOST_DATA_RDWR (YD_PRDG_CVGQ)
    PRDG_CVGT => GET_HOST_DATA_RDWR (YD_PRDG_CVGT)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
    ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
    ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
    ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
    ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:ZERO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PRDG_CVGQ => NULL ()
  PRDG_CVGT => NULL ()
  PTENHA => NULL ()
  PTENQVA => NULL ()
  ZTENDQ => NULL ()
  ZTENDT => NULL ()
  ZTENQ => NULL ()
  ZTENT => NULL ()
  ZTENU => NULL ()
  ZTENV => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:ZERO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:ZERO',1,ZHOOK_HANDLE_PARALLEL)
LLDSLPHY=.TRUE.
ZVDIFTS=0._JPRB
ISPPN2D=0
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IBASC => GET_HOST_DATA_RDWR (YL_IBASC)
  IBOTSC => GET_HOST_DATA_RDWR (YL_IBOTSC)
  ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
  ICBOT_LIG => GET_HOST_DATA_RDWR (YL_ICBOT_LIG)
  ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
  ICTOP_LIG => GET_HOST_DATA_RDWR (YL_ICTOP_LIG)
  ITOPC => GET_HOST_DATA_RDWR (YL_ITOPC)
  ITYPE => GET_HOST_DATA_RDWR (YL_ITYPE)
  LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
  LLCUM_LIG => GET_HOST_DATA_RDWR (YL_LLCUM_LIG)
  LLLAND => GET_HOST_DATA_RDONLY (YL_LLLAND)
  LLSC => GET_HOST_DATA_RDWR (YL_LLSC)
  LLSHCV => GET_HOST_DATA_RDONLY (YL_LLSHCV)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
  ZCUCONVCA => GET_HOST_DATA_RDONLY (YL_ZCUCONVCA)
  ZDIFF => GET_HOST_DATA_RDWR (YL_ZDIFF)
  ZDXTDK => GET_HOST_DATA_RDONLY (YL_ZDXTDK)
  ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
  ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
  ZFHPCL => GET_HOST_DATA_RDWR (YL_ZFHPCL)
  ZFHPCN => GET_HOST_DATA_RDWR (YL_ZFHPCN)
  ZGEOM1 => GET_HOST_DATA_RDONLY (YL_ZGEOM1)
  ZGEOMH => GET_HOST_DATA_RDONLY (YL_ZGEOMH)
  ZGP2DSPPA => GET_HOST_DATA_RDONLY (YL_ZGP2DSPPA)
  ZLCRIT_AER => GET_HOST_DATA_RDONLY (YL_ZLCRIT_AER)
  ZLGLAC => GET_HOST_DATA_RDWR (YL_ZLGLAC)
  ZLISUM => GET_HOST_DATA_RDONLY (YL_ZLISUM)
  ZLRAIN => GET_HOST_DATA_RDWR (YL_ZLRAIN)
  ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
  ZLUDE => GET_HOST_DATA_RDWR (YL_ZLUDE)
  ZLUDELI => GET_HOST_DATA_RDWR (YL_ZLUDELI)
  ZMFD => GET_HOST_DATA_RDWR (YL_ZMFD)
  ZMFDDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFDDE_RATE)
  ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
  ZMFUDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFUDE_RATE)
  ZRSUD => GET_HOST_DATA_RDWR (YL_ZRSUD)
  ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
  ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
  ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
  ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
  ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
  ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
  ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
  ZVDISCU => GET_HOST_DATA_RDWR (YL_ZVDISCU)
  ZVERVEL => GET_HOST_DATA_RDONLY (YL_ZVERVEL)
  ZWMEAN => GET_HOST_DATA_RDWR (YL_ZWMEAN)
  ZWU => GET_HOST_DATA_RDWR (YL_ZWU)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL CUCALLN_MF (YDCPG_OPTS%RPLDARE, YDCPG_OPTS%RPLRG, YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL&
    &%YRCST, YDMODEL%YRML_PHY_RAD%YRERAD, YDMODEL%YRML_PHY_SLIN, YDMODEL%YRML_PHY_EC, YDMODEL%YRML_GCONF%YGFL&
    &, YDMODEL%YRML_CHEM%YRCHEM, YDMODEL%YRML_GCONF%YRSPP_CONFIG, YDMODEL%YRML_PHY_STOCH%YRPERTPAR, YLCPG_BNDS&
    &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, 0, YDCPG_OPTS%KFLEVG, ZDXTDK(:, JBLK), ISPPN2D, YDMODEL%YRML_PHY_MF&
    &%YRPHY%YRCAPE%LMCAPEA, LLLAND(:, JBLK), LLDSLPHY, YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY, ZVDIFTS, Z_YDMF_PHYS_BASE_STATE_T&
    &(:,:, JBLK), PQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK)&
    &, ZLISUM(:,:, JBLK), ZVERVEL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:,&
    & JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,&
    &:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), ZGEOM1(:,:, JBLK), ZGEOMH(:,:, JBLK), Z_YDVARS_GEOMETRY_GM_T0&
    &(:, JBLK), ZCUCONVCA(:, JBLK), ZGP2DSPPA(:,:, JBLK), ZTENT(:,:, JBLK), ZTENQ(:,:, JBLK), ZTENU(:,:, JBLK&
    &), ZTENV(:,:, JBLK), ZTENDT(:,:, JBLK), ZTENDQ(:,:, JBLK), ZACPR(:, JBLK), ITOPC(:, JBLK), IBASC(:, JBLK&
    &), ITYPE(:, JBLK), ICBOT(:, JBLK), ICTOP(:, JBLK), IBOTSC(:, JBLK), LLCUM(:, JBLK), LLSC(:, JBLK), ICBOT_LIG&
    &(:, JBLK), ICTOP_LIG(:, JBLK), LLCUM_LIG(:, JBLK), LLSHCV(:, JBLK), ZLCRIT_AER(:,:, JBLK), ZLU(:,:, JBLK&
    &), ZLUDE(:,:, JBLK), ZLUDELI(:,:,:, JBLK), ZSNDE(:,:,:, JBLK), ZMFU(:,:, JBLK), ZMFD(:,:, JBLK), ZLGLAC&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), ZFHPCL(:,:, JBLK), ZFHPCN&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), ZLRAIN(:,:, JBLK), ZRSUD&
    &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), ZFCQLF(:,:, JBLK),&
    & ZFCQLI(:,:, JBLK), ZMFUDE_RATE(:,:, JBLK), ZMFDDE_RATE(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK), ZWU&
    &(:,:, JBLK), ZWMEAN(:, JBLK), ZVDISCU(:, JBLK), ZDIFF(:,:, JBLK), 0, ZCEN, ZTENC, ZSCAV, ZSCAV)
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CUCALLN_MF:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IBASC => GET_HOST_DATA_RDWR (YL_IBASC)
    IBOTSC => GET_HOST_DATA_RDWR (YL_IBOTSC)
    ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
    ICBOT_LIG => GET_HOST_DATA_RDWR (YL_ICBOT_LIG)
    ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
    ICTOP_LIG => GET_HOST_DATA_RDWR (YL_ICTOP_LIG)
    ITOPC => GET_HOST_DATA_RDWR (YL_ITOPC)
    ITYPE => GET_HOST_DATA_RDWR (YL_ITYPE)
    LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
    LLCUM_LIG => GET_HOST_DATA_RDWR (YL_LLCUM_LIG)
    LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
    LLSC => GET_HOST_DATA_RDWR (YL_LLSC)
    LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
    ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
    ZDIFF => GET_HOST_DATA_RDWR (YL_ZDIFF)
    ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
    ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
    ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
    ZFHPCL => GET_HOST_DATA_RDWR (YL_ZFHPCL)
    ZFHPCN => GET_HOST_DATA_RDWR (YL_ZFHPCN)
    ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
    ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
    ZGP2DSPPA => GET_HOST_DATA_RDWR (YL_ZGP2DSPPA)
    ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
    ZLGLAC => GET_HOST_DATA_RDWR (YL_ZLGLAC)
    ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
    ZLRAIN => GET_HOST_DATA_RDWR (YL_ZLRAIN)
    ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
    ZLUDE => GET_HOST_DATA_RDWR (YL_ZLUDE)
    ZLUDELI => GET_HOST_DATA_RDWR (YL_ZLUDELI)
    ZMFD => GET_HOST_DATA_RDWR (YL_ZMFD)
    ZMFDDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFDDE_RATE)
    ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
    ZMFUDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFUDE_RATE)
    ZRSUD => GET_HOST_DATA_RDWR (YL_ZRSUD)
    ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
    ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
    ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
    ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
    ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
    ZVDISCU => GET_HOST_DATA_RDWR (YL_ZVDISCU)
    ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
    ZWMEAN => GET_HOST_DATA_RDWR (YL_ZWMEAN)
    ZWU => GET_HOST_DATA_RDWR (YL_ZWU)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CUCALLN_MF:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IBASC => NULL ()
  IBOTSC => NULL ()
  ICBOT => NULL ()
  ICBOT_LIG => NULL ()
  ICTOP => NULL ()
  ICTOP_LIG => NULL ()
  ITOPC => NULL ()
  ITYPE => NULL ()
  LLCUM => NULL ()
  LLCUM_LIG => NULL ()
  LLLAND => NULL ()
  LLSC => NULL ()
  LLSHCV => NULL ()
  PQV => NULL ()
  ZACPR => NULL ()
  ZCUCONVCA => NULL ()
  ZDIFF => NULL ()
  ZDXTDK => NULL ()
  ZFCQLF => NULL ()
  ZFCQLI => NULL ()
  ZFHPCL => NULL ()
  ZFHPCN => NULL ()
  ZGEOM1 => NULL ()
  ZGEOMH => NULL ()
  ZGP2DSPPA => NULL ()
  ZLCRIT_AER => NULL ()
  ZLGLAC => NULL ()
  ZLISUM => NULL ()
  ZLRAIN => NULL ()
  ZLU => NULL ()
  ZLUDE => NULL ()
  ZLUDELI => NULL ()
  ZMFD => NULL ()
  ZMFDDE_RATE => NULL ()
  ZMFU => NULL ()
  ZMFUDE_RATE => NULL ()
  ZRSUD => NULL ()
  ZSNDE => NULL ()
  ZTENDQ => NULL ()
  ZTENDT => NULL ()
  ZTENQ => NULL ()
  ZTENT => NULL ()
  ZTENU => NULL ()
  ZTENV => NULL ()
  ZVDISCU => NULL ()
  ZVERVEL => NULL ()
  ZWMEAN => NULL ()
  ZWU => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_OUT_CAPE => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN',&
  &'APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IBASC => GET_HOST_DATA_RDWR (YL_IBASC)
  IBOTSC => GET_HOST_DATA_RDWR (YL_IBOTSC)
  ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
  ICBOT_LIG => GET_HOST_DATA_RDWR (YL_ICBOT_LIG)
  ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
  ICTOP_LIG => GET_HOST_DATA_RDWR (YL_ICTOP_LIG)
  ITOPC => GET_HOST_DATA_RDWR (YL_ITOPC)
  ITYPE => GET_HOST_DATA_RDWR (YL_ITYPE)
  LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
  LLCUM_LIG => GET_HOST_DATA_RDWR (YL_LLCUM_LIG)
  LLLAND => GET_HOST_DATA_RDONLY (YL_LLLAND)
  LLSC => GET_HOST_DATA_RDWR (YL_LLSC)
  LLSHCV => GET_HOST_DATA_RDONLY (YL_LLSHCV)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
  ZCUCONVCA => GET_HOST_DATA_RDONLY (YL_ZCUCONVCA)
  ZDIFF => GET_HOST_DATA_RDWR (YL_ZDIFF)
  ZDXTDK => GET_HOST_DATA_RDONLY (YL_ZDXTDK)
  ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
  ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
  ZFHPCL => GET_HOST_DATA_RDWR (YL_ZFHPCL)
  ZFHPCN => GET_HOST_DATA_RDWR (YL_ZFHPCN)
  ZGEOM1 => GET_HOST_DATA_RDONLY (YL_ZGEOM1)
  ZGEOMH => GET_HOST_DATA_RDONLY (YL_ZGEOMH)
  ZGP2DSPPA => GET_HOST_DATA_RDONLY (YL_ZGP2DSPPA)
  ZLCRIT_AER => GET_HOST_DATA_RDONLY (YL_ZLCRIT_AER)
  ZLGLAC => GET_HOST_DATA_RDWR (YL_ZLGLAC)
  ZLISUM => GET_HOST_DATA_RDONLY (YL_ZLISUM)
  ZLRAIN => GET_HOST_DATA_RDWR (YL_ZLRAIN)
  ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
  ZLUDE => GET_HOST_DATA_RDWR (YL_ZLUDE)
  ZLUDELI => GET_HOST_DATA_RDWR (YL_ZLUDELI)
  ZMFD => GET_HOST_DATA_RDWR (YL_ZMFD)
  ZMFDDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFDDE_RATE)
  ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
  ZMFUDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFUDE_RATE)
  ZRSUD => GET_HOST_DATA_RDWR (YL_ZRSUD)
  ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
  ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
  ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
  ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
  ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
  ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
  ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
  ZVDISCU => GET_HOST_DATA_RDWR (YL_ZVDISCU)
  ZVERVEL => GET_HOST_DATA_RDONLY (YL_ZVERVEL)
  ZWMEAN => GET_HOST_DATA_RDWR (YL_ZWMEAN)
  ZWU => GET_HOST_DATA_RDWR (YL_ZWU)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL CUCALLN_MF_OPENACC (YDCPG_OPTS%RPLDARE, YDCPG_OPTS%RPLRG, YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_EC&
      &%YRTHF, YDMODEL%YRCST, YDMODEL%YRML_PHY_RAD%YRERAD, YDMODEL%YRML_PHY_SLIN, YDMODEL%YRML_PHY_EC, YDMODEL&
      &%YRML_GCONF%YGFL, YDMODEL%YRML_CHEM%YRCHEM, YDMODEL%YRML_GCONF%YRSPP_CONFIG, YDMODEL%YRML_PHY_STOCH&
      &%YRPERTPAR, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, 0, YDCPG_OPTS%KFLEVG, ZDXTDK(:, JBLK&
      &), ISPPN2D, YDMODEL%YRML_PHY_MF%YRPHY%YRCAPE%LMCAPEA, LLLAND(:, JBLK), LLDSLPHY, YDMODEL%YRML_PHY_MF&
      &%YRPHY2%TSPHY, ZVDIFTS, Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), PQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), ZLISUM(:,:, JBLK), ZVERVEL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK),&
      & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK&
      &), ZGEOM1(:,:, JBLK), ZGEOMH(:,:, JBLK), Z_YDVARS_GEOMETRY_GM_T0(:, JBLK), ZCUCONVCA(:, JBLK), ZGP2DSPPA&
      &(:,:, JBLK), ZTENT(:,:, JBLK), ZTENQ(:,:, JBLK), ZTENU(:,:, JBLK), ZTENV(:,:, JBLK), ZTENDT(:,:, JBLK&
      &), ZTENDQ(:,:, JBLK), ZACPR(:, JBLK), ITOPC(:, JBLK), IBASC(:, JBLK), ITYPE(:, JBLK), ICBOT(:, JBLK&
      &), ICTOP(:, JBLK), IBOTSC(:, JBLK), LLCUM(:, JBLK), LLSC(:, JBLK), ICBOT_LIG(:, JBLK), ICTOP_LIG(&
      &:, JBLK), LLCUM_LIG(:, JBLK), LLSHCV(:, JBLK), ZLCRIT_AER(:,:, JBLK), ZLU(:,:, JBLK), ZLUDE(:,:, JBLK&
      &), ZLUDELI(:,:,:, JBLK), ZSNDE(:,:,:, JBLK), ZMFU(:,:, JBLK), ZMFD(:,:, JBLK), ZLGLAC(:,:, JBLK),&
      & Z_YDMF_PHYS_OUT_DIFCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), ZFHPCL(:,:, JBLK), ZFHPCN(:,&
      &:, JBLK), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), ZLRAIN(:,:, JBLK), ZRSUD&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), ZFCQLF(:,:, JBLK&
      &), ZFCQLI(:,:, JBLK), ZMFUDE_RATE(:,:, JBLK), ZMFDDE_RATE(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK&
      &), ZWU(:,:, JBLK), ZWMEAN(:, JBLK), ZVDISCU(:, JBLK), ZDIFF(:,:, JBLK), 0, ZCEN, ZTENC, ZSCAV, ZSCAV&
      &,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CUCALLN_MF:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IBASC => GET_HOST_DATA_RDWR (YL_IBASC)
    IBOTSC => GET_HOST_DATA_RDWR (YL_IBOTSC)
    ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
    ICBOT_LIG => GET_HOST_DATA_RDWR (YL_ICBOT_LIG)
    ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
    ICTOP_LIG => GET_HOST_DATA_RDWR (YL_ICTOP_LIG)
    ITOPC => GET_HOST_DATA_RDWR (YL_ITOPC)
    ITYPE => GET_HOST_DATA_RDWR (YL_ITYPE)
    LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
    LLCUM_LIG => GET_HOST_DATA_RDWR (YL_LLCUM_LIG)
    LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
    LLSC => GET_HOST_DATA_RDWR (YL_LLSC)
    LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
    ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
    ZDIFF => GET_HOST_DATA_RDWR (YL_ZDIFF)
    ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
    ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
    ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
    ZFHPCL => GET_HOST_DATA_RDWR (YL_ZFHPCL)
    ZFHPCN => GET_HOST_DATA_RDWR (YL_ZFHPCN)
    ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
    ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
    ZGP2DSPPA => GET_HOST_DATA_RDWR (YL_ZGP2DSPPA)
    ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
    ZLGLAC => GET_HOST_DATA_RDWR (YL_ZLGLAC)
    ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
    ZLRAIN => GET_HOST_DATA_RDWR (YL_ZLRAIN)
    ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
    ZLUDE => GET_HOST_DATA_RDWR (YL_ZLUDE)
    ZLUDELI => GET_HOST_DATA_RDWR (YL_ZLUDELI)
    ZMFD => GET_HOST_DATA_RDWR (YL_ZMFD)
    ZMFDDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFDDE_RATE)
    ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
    ZMFUDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFUDE_RATE)
    ZRSUD => GET_HOST_DATA_RDWR (YL_ZRSUD)
    ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
    ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
    ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
    ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
    ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
    ZVDISCU => GET_HOST_DATA_RDWR (YL_ZVDISCU)
    ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
    ZWMEAN => GET_HOST_DATA_RDWR (YL_ZWMEAN)
    ZWU => GET_HOST_DATA_RDWR (YL_ZWU)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CUCALLN_MF:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IBASC => NULL ()
  IBOTSC => NULL ()
  ICBOT => NULL ()
  ICBOT_LIG => NULL ()
  ICTOP => NULL ()
  ICTOP_LIG => NULL ()
  ITOPC => NULL ()
  ITYPE => NULL ()
  LLCUM => NULL ()
  LLCUM_LIG => NULL ()
  LLLAND => NULL ()
  LLSC => NULL ()
  LLSHCV => NULL ()
  PQV => NULL ()
  ZACPR => NULL ()
  ZCUCONVCA => NULL ()
  ZDIFF => NULL ()
  ZDXTDK => NULL ()
  ZFCQLF => NULL ()
  ZFCQLI => NULL ()
  ZFHPCL => NULL ()
  ZFHPCN => NULL ()
  ZGEOM1 => NULL ()
  ZGEOMH => NULL ()
  ZGP2DSPPA => NULL ()
  ZLCRIT_AER => NULL ()
  ZLGLAC => NULL ()
  ZLISUM => NULL ()
  ZLRAIN => NULL ()
  ZLU => NULL ()
  ZLUDE => NULL ()
  ZLUDELI => NULL ()
  ZMFD => NULL ()
  ZMFDDE_RATE => NULL ()
  ZMFU => NULL ()
  ZMFUDE_RATE => NULL ()
  ZRSUD => NULL ()
  ZSNDE => NULL ()
  ZTENDQ => NULL ()
  ZTENDT => NULL ()
  ZTENQ => NULL ()
  ZTENT => NULL ()
  ZTENU => NULL ()
  ZTENV => NULL ()
  ZVDISCU => NULL ()
  ZVERVEL => NULL ()
  ZWMEAN => NULL ()
  ZWU => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_OUT_CAPE => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN',&
  &'APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IBASC => GET_DEVICE_DATA_RDWR (YL_IBASC)
  IBOTSC => GET_DEVICE_DATA_RDWR (YL_IBOTSC)
  ICBOT => GET_DEVICE_DATA_RDWR (YL_ICBOT)
  ICBOT_LIG => GET_DEVICE_DATA_RDWR (YL_ICBOT_LIG)
  ICTOP => GET_DEVICE_DATA_RDWR (YL_ICTOP)
  ICTOP_LIG => GET_DEVICE_DATA_RDWR (YL_ICTOP_LIG)
  ITOPC => GET_DEVICE_DATA_RDWR (YL_ITOPC)
  ITYPE => GET_DEVICE_DATA_RDWR (YL_ITYPE)
  LLCUM => GET_DEVICE_DATA_RDWR (YL_LLCUM)
  LLCUM_LIG => GET_DEVICE_DATA_RDWR (YL_LLCUM_LIG)
  LLLAND => GET_DEVICE_DATA_RDONLY (YL_LLLAND)
  LLSC => GET_DEVICE_DATA_RDWR (YL_LLSC)
  LLSHCV => GET_DEVICE_DATA_RDONLY (YL_LLSHCV)
  PQV => GET_DEVICE_DATA_RDONLY (YD_PQV)
  ZACPR => GET_DEVICE_DATA_RDWR (YL_ZACPR)
  ZCUCONVCA => GET_DEVICE_DATA_RDONLY (YL_ZCUCONVCA)
  ZDIFF => GET_DEVICE_DATA_RDWR (YL_ZDIFF)
  ZDXTDK => GET_DEVICE_DATA_RDONLY (YL_ZDXTDK)
  ZFCQLF => GET_DEVICE_DATA_RDWR (YL_ZFCQLF)
  ZFCQLI => GET_DEVICE_DATA_RDWR (YL_ZFCQLI)
  ZFHPCL => GET_DEVICE_DATA_RDWR (YL_ZFHPCL)
  ZFHPCN => GET_DEVICE_DATA_RDWR (YL_ZFHPCN)
  ZGEOM1 => GET_DEVICE_DATA_RDONLY (YL_ZGEOM1)
  ZGEOMH => GET_DEVICE_DATA_RDONLY (YL_ZGEOMH)
  ZGP2DSPPA => GET_DEVICE_DATA_RDONLY (YL_ZGP2DSPPA)
  ZLCRIT_AER => GET_DEVICE_DATA_RDONLY (YL_ZLCRIT_AER)
  ZLGLAC => GET_DEVICE_DATA_RDWR (YL_ZLGLAC)
  ZLISUM => GET_DEVICE_DATA_RDONLY (YL_ZLISUM)
  ZLRAIN => GET_DEVICE_DATA_RDWR (YL_ZLRAIN)
  ZLU => GET_DEVICE_DATA_RDWR (YL_ZLU)
  ZLUDE => GET_DEVICE_DATA_RDWR (YL_ZLUDE)
  ZLUDELI => GET_DEVICE_DATA_RDWR (YL_ZLUDELI)
  ZMFD => GET_DEVICE_DATA_RDWR (YL_ZMFD)
  ZMFDDE_RATE => GET_DEVICE_DATA_RDWR (YL_ZMFDDE_RATE)
  ZMFU => GET_DEVICE_DATA_RDWR (YL_ZMFU)
  ZMFUDE_RATE => GET_DEVICE_DATA_RDWR (YL_ZMFUDE_RATE)
  ZRSUD => GET_DEVICE_DATA_RDWR (YL_ZRSUD)
  ZSNDE => GET_DEVICE_DATA_RDWR (YL_ZSNDE)
  ZTENDQ => GET_DEVICE_DATA_RDWR (YL_ZTENDQ)
  ZTENDT => GET_DEVICE_DATA_RDWR (YL_ZTENDT)
  ZTENQ => GET_DEVICE_DATA_RDWR (YL_ZTENQ)
  ZTENT => GET_DEVICE_DATA_RDWR (YL_ZTENT)
  ZTENU => GET_DEVICE_DATA_RDWR (YL_ZTENU)
  ZTENV => GET_DEVICE_DATA_RDWR (YL_ZTENV)
  ZVDISCU => GET_DEVICE_DATA_RDWR (YL_ZVDISCU)
  ZVERVEL => GET_DEVICE_DATA_RDONLY (YL_ZVERVEL)
  ZWMEAN => GET_DEVICE_DATA_RDWR (YL_ZWMEAN)
  ZWU => GET_DEVICE_DATA_RDWR (YL_ZWU)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_OUT_CAPE => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_STRCU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (IBASC, IBOTSC, ICBOT, ICBOT_LIG, ICTOP, ICTOP_LIG, ITOPC, ITYPE, LLCUM, &
    !$ACC&         LLCUM_LIG, LLLAND, LLSC, LLSHCV, PQV, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZACPR, ZCUCONVCA, ZDIFF, ZDXTDK, ZFCQLF, ZFCQLI, ZFHPCL, ZFHPCN, ZGEOM1, &
    !$ACC&         ZGEOMH, ZGP2DSPPA, ZLCRIT_AER, ZLGLAC, ZLISUM, ZLRAIN, ZLU, ZLUDE, &
    !$ACC&         ZLUDELI, ZMFD, ZMFDDE_RATE, ZMFU, ZMFUDE_RATE, ZRSUD, ZSNDE, ZTENDQ, &
    !$ACC&         ZTENDT, ZTENQ, ZTENT, ZTENU, ZTENV, ZVDISCU, ZVERVEL, ZWMEAN, ZWU, Z_YDMF_PHYS_BASE_STATE_T, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_OUT_CAPE, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFCQ, Z_YDMF_PHYS_OUT_DIFCS, Z_YDMF_PHYS_OUT_DIFTQ, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFTS, Z_YDMF_PHYS_OUT_FPLCL, Z_YDMF_PHYS_OUT_FPLCN, &
    !$ACC&         Z_YDMF_PHYS_OUT_STRCU, Z_YDMF_PHYS_OUT_STRCV, Z_YDVARS_GEOMETRY_GM_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL CUCALLN_MF_OPENACC (YDCPG_OPTS%RPLDARE, YDCPG_OPTS%RPLRG, YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_EC&
      &%YRTHF, YDMODEL%YRCST, YDMODEL%YRML_PHY_RAD%YRERAD, YDMODEL%YRML_PHY_SLIN, YDMODEL%YRML_PHY_EC, YDMODEL&
      &%YRML_GCONF%YGFL, YDMODEL%YRML_CHEM%YRCHEM, YDMODEL%YRML_GCONF%YRSPP_CONFIG, YDMODEL%YRML_PHY_STOCH&
      &%YRPERTPAR, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, 0, YDCPG_OPTS%KFLEVG, ZDXTDK(:, JBLK&
      &), ISPPN2D, YDMODEL%YRML_PHY_MF%YRPHY%YRCAPE%LMCAPEA, LLLAND(:, JBLK), LLDSLPHY, YDMODEL%YRML_PHY_MF&
      &%YRPHY2%TSPHY, ZVDIFTS, Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), PQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), ZLISUM(:,:, JBLK), ZVERVEL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK),&
      & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK&
      &), ZGEOM1(:,:, JBLK), ZGEOMH(:,:, JBLK), Z_YDVARS_GEOMETRY_GM_T0(:, JBLK), ZCUCONVCA(:, JBLK), ZGP2DSPPA&
      &(:,:, JBLK), ZTENT(:,:, JBLK), ZTENQ(:,:, JBLK), ZTENU(:,:, JBLK), ZTENV(:,:, JBLK), ZTENDT(:,:, JBLK&
      &), ZTENDQ(:,:, JBLK), ZACPR(:, JBLK), ITOPC(:, JBLK), IBASC(:, JBLK), ITYPE(:, JBLK), ICBOT(:, JBLK&
      &), ICTOP(:, JBLK), IBOTSC(:, JBLK), LLCUM(:, JBLK), LLSC(:, JBLK), ICBOT_LIG(:, JBLK), ICTOP_LIG(&
      &:, JBLK), LLCUM_LIG(:, JBLK), LLSHCV(:, JBLK), ZLCRIT_AER(:,:, JBLK), ZLU(:,:, JBLK), ZLUDE(:,:, JBLK&
      &), ZLUDELI(:,:,:, JBLK), ZSNDE(:,:,:, JBLK), ZMFU(:,:, JBLK), ZMFD(:,:, JBLK), ZLGLAC(:,:, JBLK),&
      & Z_YDMF_PHYS_OUT_DIFCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), ZFHPCL(:,:, JBLK), ZFHPCN(:,&
      &:, JBLK), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), ZLRAIN(:,:, JBLK), ZRSUD&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), ZFCQLF(:,:, JBLK&
      &), ZFCQLI(:,:, JBLK), ZMFUDE_RATE(:,:, JBLK), ZMFDDE_RATE(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK&
      &), ZWU(:,:, JBLK), ZWMEAN(:, JBLK), ZVDISCU(:, JBLK), ZDIFF(:,:, JBLK), 0, ZCEN, ZTENC, ZSCAV, ZSCAV&
      &,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CUCALLN_MF:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IBASC => GET_HOST_DATA_RDWR (YL_IBASC)
    IBOTSC => GET_HOST_DATA_RDWR (YL_IBOTSC)
    ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
    ICBOT_LIG => GET_HOST_DATA_RDWR (YL_ICBOT_LIG)
    ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
    ICTOP_LIG => GET_HOST_DATA_RDWR (YL_ICTOP_LIG)
    ITOPC => GET_HOST_DATA_RDWR (YL_ITOPC)
    ITYPE => GET_HOST_DATA_RDWR (YL_ITYPE)
    LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
    LLCUM_LIG => GET_HOST_DATA_RDWR (YL_LLCUM_LIG)
    LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
    LLSC => GET_HOST_DATA_RDWR (YL_LLSC)
    LLSHCV => GET_HOST_DATA_RDWR (YL_LLSHCV)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    ZACPR => GET_HOST_DATA_RDWR (YL_ZACPR)
    ZCUCONVCA => GET_HOST_DATA_RDWR (YL_ZCUCONVCA)
    ZDIFF => GET_HOST_DATA_RDWR (YL_ZDIFF)
    ZDXTDK => GET_HOST_DATA_RDWR (YL_ZDXTDK)
    ZFCQLF => GET_HOST_DATA_RDWR (YL_ZFCQLF)
    ZFCQLI => GET_HOST_DATA_RDWR (YL_ZFCQLI)
    ZFHPCL => GET_HOST_DATA_RDWR (YL_ZFHPCL)
    ZFHPCN => GET_HOST_DATA_RDWR (YL_ZFHPCN)
    ZGEOM1 => GET_HOST_DATA_RDWR (YL_ZGEOM1)
    ZGEOMH => GET_HOST_DATA_RDWR (YL_ZGEOMH)
    ZGP2DSPPA => GET_HOST_DATA_RDWR (YL_ZGP2DSPPA)
    ZLCRIT_AER => GET_HOST_DATA_RDWR (YL_ZLCRIT_AER)
    ZLGLAC => GET_HOST_DATA_RDWR (YL_ZLGLAC)
    ZLISUM => GET_HOST_DATA_RDWR (YL_ZLISUM)
    ZLRAIN => GET_HOST_DATA_RDWR (YL_ZLRAIN)
    ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
    ZLUDE => GET_HOST_DATA_RDWR (YL_ZLUDE)
    ZLUDELI => GET_HOST_DATA_RDWR (YL_ZLUDELI)
    ZMFD => GET_HOST_DATA_RDWR (YL_ZMFD)
    ZMFDDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFDDE_RATE)
    ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
    ZMFUDE_RATE => GET_HOST_DATA_RDWR (YL_ZMFUDE_RATE)
    ZRSUD => GET_HOST_DATA_RDWR (YL_ZRSUD)
    ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDT => GET_HOST_DATA_RDWR (YL_ZTENDT)
    ZTENQ => GET_HOST_DATA_RDWR (YL_ZTENQ)
    ZTENT => GET_HOST_DATA_RDWR (YL_ZTENT)
    ZTENU => GET_HOST_DATA_RDWR (YL_ZTENU)
    ZTENV => GET_HOST_DATA_RDWR (YL_ZTENV)
    ZVDISCU => GET_HOST_DATA_RDWR (YL_ZVDISCU)
    ZVERVEL => GET_HOST_DATA_RDWR (YL_ZVERVEL)
    ZWMEAN => GET_HOST_DATA_RDWR (YL_ZWMEAN)
    ZWU => GET_HOST_DATA_RDWR (YL_ZWU)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CUCALLN_MF:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IBASC => NULL ()
  IBOTSC => NULL ()
  ICBOT => NULL ()
  ICBOT_LIG => NULL ()
  ICTOP => NULL ()
  ICTOP_LIG => NULL ()
  ITOPC => NULL ()
  ITYPE => NULL ()
  LLCUM => NULL ()
  LLCUM_LIG => NULL ()
  LLLAND => NULL ()
  LLSC => NULL ()
  LLSHCV => NULL ()
  PQV => NULL ()
  ZACPR => NULL ()
  ZCUCONVCA => NULL ()
  ZDIFF => NULL ()
  ZDXTDK => NULL ()
  ZFCQLF => NULL ()
  ZFCQLI => NULL ()
  ZFHPCL => NULL ()
  ZFHPCN => NULL ()
  ZGEOM1 => NULL ()
  ZGEOMH => NULL ()
  ZGP2DSPPA => NULL ()
  ZLCRIT_AER => NULL ()
  ZLGLAC => NULL ()
  ZLISUM => NULL ()
  ZLRAIN => NULL ()
  ZLU => NULL ()
  ZLUDE => NULL ()
  ZLUDELI => NULL ()
  ZMFD => NULL ()
  ZMFDDE_RATE => NULL ()
  ZMFU => NULL ()
  ZMFUDE_RATE => NULL ()
  ZRSUD => NULL ()
  ZSNDE => NULL ()
  ZTENDQ => NULL ()
  ZTENDT => NULL ()
  ZTENQ => NULL ()
  ZTENT => NULL ()
  ZTENU => NULL ()
  ZTENV => NULL ()
  ZVDISCU => NULL ()
  ZVERVEL => NULL ()
  ZWMEAN => NULL ()
  ZWU => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_OUT_CAPE => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:CUCALLN_MF:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CUCALLN_MF',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
  ZSNDE => GET_HOST_DATA_RDONLY (YL_ZSNDE)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=0, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PFPCOR (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCCQL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCCQN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPFPCL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPFPCN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPEVPCL (JLON, JLEV, JBLK)=0._JPRB
        Z_YDMF_PHYS_OUT_FPEVPCN (JLON, JLEV, JBLK)=0._JPRB
      ENDDO

    ENDDO


    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_OUT_FPEVPCL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPEVPCL&
        & (JLON, JLEV-1, JBLK)-ZSNDE (JLON, JLEV, 1, JBLK)
        Z_YDMF_PHYS_OUT_FPEVPCN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPEVPCN&
        & (JLON, JLEV-1, JBLK)-ZSNDE (JLON, JLEV, 2, JBLK)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:COPY:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
    ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:COPY:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PFPCOR => NULL ()
  ZSNDE => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
  ZSNDE => GET_HOST_DATA_RDONLY (YL_ZSNDE)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        PFPCOR (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCCQL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCCQN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPFPCL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPFPCN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPEVPCL (JLON, JLEV, JBLK)=0._JPRB
        Z_YDMF_PHYS_OUT_FPEVPCN (JLON, JLEV, JBLK)=0._JPRB
      
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        Z_YDMF_PHYS_OUT_FPEVPCL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPEVPCL&
        & (JLON, JLEV-1, JBLK)-ZSNDE (JLON, JLEV, 1, JBLK)
        Z_YDMF_PHYS_OUT_FPEVPCN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPEVPCN&
        & (JLON, JLEV-1, JBLK)-ZSNDE (JLON, JLEV, 2, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:COPY:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
    ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:COPY:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PFPCOR => NULL ()
  ZSNDE => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PFPCOR => GET_DEVICE_DATA_RDWR (YD_PFPCOR)
  ZSNDE => GET_DEVICE_DATA_RDONLY (YL_ZSNDE)
  Z_YDMF_PHYS_OUT_FCCQL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PFPCOR, YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZSNDE, Z_YDMF_PHYS_OUT_FCCQL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCCQN, Z_YDMF_PHYS_OUT_FPEVPCL, Z_YDMF_PHYS_OUT_FPEVPCN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPFPCL, Z_YDMF_PHYS_OUT_FPFPCN, Z_YDMF_PHYS_OUT_FPLCL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPLCN) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        PFPCOR (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCCQL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCCQN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPFPCL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPFPCN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FPEVPCL (JLON, JLEV, JBLK)=0._JPRB
        Z_YDMF_PHYS_OUT_FPEVPCN (JLON, JLEV, JBLK)=0._JPRB
      
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        Z_YDMF_PHYS_OUT_FPEVPCL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPEVPCL&
        & (JLON, JLEV-1, JBLK)-ZSNDE (JLON, JLEV, 1, JBLK)
        Z_YDMF_PHYS_OUT_FPEVPCN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPEVPCN&
        & (JLON, JLEV-1, JBLK)-ZSNDE (JLON, JLEV, 2, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:COPY:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
    ZSNDE => GET_HOST_DATA_RDWR (YL_ZSNDE)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:COPY:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PFPCOR => NULL ()
  ZSNDE => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
  &:COPY:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:COPY',1,ZHOOK_HANDLE_PARALLEL)

IF (YDCPG_OPTS%LFLASH) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ICBOT => GET_HOST_DATA_RDONLY (YL_ICBOT)
    ICTOP => GET_HOST_DATA_RDONLY (YL_ICTOP)
    LLCUM => GET_HOST_DATA_RDONLY (YL_LLCUM)
    LLLAND => GET_HOST_DATA_RDONLY (YL_LLLAND)
    LLLINOX => GET_HOST_DATA_RDWR (YL_LLLINOX)
    ZCDEPTH => GET_HOST_DATA_RDWR (YL_ZCDEPTH)
    ZCHARGE => GET_HOST_DATA_RDWR (YL_ZCHARGE)
    ZCTOPH => GET_HOST_DATA_RDWR (YL_ZCTOPH)
    ZGAW => GET_HOST_DATA_RDWR (YL_ZGAW)
    ZICE => GET_HOST_DATA_RDWR (YL_ZICE)
    ZLIGH_CTG => GET_HOST_DATA_RDWR (YL_ZLIGH_CTG)
    ZLU => GET_HOST_DATA_RDONLY (YL_ZLU)
    ZMFU => GET_HOST_DATA_RDONLY (YL_ZMFU)
    ZPRECMX => GET_HOST_DATA_RDWR (YL_ZPRECMX)
    ZQPFROZ => GET_HOST_DATA_RDWR (YL_ZQPFROZ)
    ZWMFU => GET_HOST_DATA_RDWR (YL_ZWMFU)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_FLASH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FLASH)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDVARS_GEOMETRY_GAW_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GAW%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      ZGAW (:, JBLK)=Z_YDVARS_GEOMETRY_GAW_P (:, JBLK)
      ZQPFROZ (:,:, JBLK)=0
      ZCHARGE (:,:, JBLK)=0
      CALL CULIGHT (YDCPG_OPTS%RPLDARE, YDCPG_OPTS%RPLRG, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL%YRCST&
      &, YDMODEL%YRML_PHY_EC%YREPHY, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_EC%YRECUMF, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, ZGAW(:, JBLK), ZGAW(:, JBLK),&
      & Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), LLLAND(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), ZLU(:,:, JBLK), ZMFU(:,:&
      &, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN&
      &(:,:, JBLK), ZQPFROZ(:,:, JBLK), LLCUM(:, JBLK), ICBOT(:, JBLK), ICTOP(:, JBLK), LLLINOX(:,&
      & JBLK), Z_YDMF_PHYS_OUT_FLASH(:, JBLK), ZLIGH_CTG(:, JBLK), ZCTOPH(:, JBLK), ZPRECMX(:, JBLK&
      &), ZICE(:, JBLK), ZCDEPTH(:, JBLK), ZWMFU(:, JBLK), ZCHARGE(:,:, JBLK))

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_OUT_FLASH (JLON, JBLK)=Z_YDMF_PHYS_OUT_FLASH (JLON, JBLK)/86400._JPRB
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
      &:CULIGHT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
      ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
      LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
      LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
      LLLINOX => GET_HOST_DATA_RDWR (YL_LLLINOX)
      ZCDEPTH => GET_HOST_DATA_RDWR (YL_ZCDEPTH)
      ZCHARGE => GET_HOST_DATA_RDWR (YL_ZCHARGE)
      ZCTOPH => GET_HOST_DATA_RDWR (YL_ZCTOPH)
      ZGAW => GET_HOST_DATA_RDWR (YL_ZGAW)
      ZICE => GET_HOST_DATA_RDWR (YL_ZICE)
      ZLIGH_CTG => GET_HOST_DATA_RDWR (YL_ZLIGH_CTG)
      ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
      ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
      ZPRECMX => GET_HOST_DATA_RDWR (YL_ZPRECMX)
      ZQPFROZ => GET_HOST_DATA_RDWR (YL_ZQPFROZ)
      ZWMFU => GET_HOST_DATA_RDWR (YL_ZWMFU)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_FLASH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FLASH)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
      Z_YDVARS_GEOMETRY_GAW_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GAW%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
      &:CULIGHT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ICBOT => NULL ()
    ICTOP => NULL ()
    LLCUM => NULL ()
    LLLAND => NULL ()
    LLLINOX => NULL ()
    ZCDEPTH => NULL ()
    ZCHARGE => NULL ()
    ZCTOPH => NULL ()
    ZGAW => NULL ()
    ZICE => NULL ()
    ZLIGH_CTG => NULL ()
    ZLU => NULL ()
    ZMFU => NULL ()
    ZPRECMX => NULL ()
    ZQPFROZ => NULL ()
    ZWMFU => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_OUT_CAPE => NULL ()
    Z_YDMF_PHYS_OUT_FLASH => NULL ()
    Z_YDMF_PHYS_OUT_FPLCL => NULL ()
    Z_YDMF_PHYS_OUT_FPLCN => NULL ()
    Z_YDVARS_GEOMETRY_GAW_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN'&
    &,'APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ICBOT => GET_HOST_DATA_RDONLY (YL_ICBOT)
    ICTOP => GET_HOST_DATA_RDONLY (YL_ICTOP)
    LLCUM => GET_HOST_DATA_RDONLY (YL_LLCUM)
    LLLAND => GET_HOST_DATA_RDONLY (YL_LLLAND)
    LLLINOX => GET_HOST_DATA_RDWR (YL_LLLINOX)
    ZCDEPTH => GET_HOST_DATA_RDWR (YL_ZCDEPTH)
    ZCHARGE => GET_HOST_DATA_RDWR (YL_ZCHARGE)
    ZCTOPH => GET_HOST_DATA_RDWR (YL_ZCTOPH)
    ZGAW => GET_HOST_DATA_RDWR (YL_ZGAW)
    ZICE => GET_HOST_DATA_RDWR (YL_ZICE)
    ZLIGH_CTG => GET_HOST_DATA_RDWR (YL_ZLIGH_CTG)
    ZLU => GET_HOST_DATA_RDONLY (YL_ZLU)
    ZMFU => GET_HOST_DATA_RDONLY (YL_ZMFU)
    ZPRECMX => GET_HOST_DATA_RDWR (YL_ZPRECMX)
    ZQPFROZ => GET_HOST_DATA_RDWR (YL_ZQPFROZ)
    ZWMFU => GET_HOST_DATA_RDWR (YL_ZWMFU)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_FLASH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FLASH)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDVARS_GEOMETRY_GAW_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GAW%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        ZGAW (JLON, JBLK)=Z_YDVARS_GEOMETRY_GAW_P (JLON, JBLK)
        ZQPFROZ (JLON,:, JBLK)=0
        ZCHARGE (JLON,:, JBLK)=0
        CALL CULIGHT_OPENACC (YDCPG_OPTS%RPLDARE, YDCPG_OPTS%RPLRG, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL&
        &%YRCST, YDMODEL%YRML_PHY_EC%YREPHY, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_EC%YRECUMF, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, ZGAW(:, JBLK), ZGAW(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), LLLAND(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
        &(:,:, JBLK), ZLU(:,:, JBLK), ZMFU(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK), Z_YDMF_PHYS_OUT_FPLCL&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), ZQPFROZ(:,:, JBLK), LLCUM(:, JBLK), ICBOT(:, JBLK&
        &), ICTOP(:, JBLK), LLLINOX(:, JBLK), Z_YDMF_PHYS_OUT_FLASH(:, JBLK), ZLIGH_CTG(:, JBLK), ZCTOPH&
        &(:, JBLK), ZPRECMX(:, JBLK), ZICE(:, JBLK), ZCDEPTH(:, JBLK), ZWMFU(:, JBLK), ZCHARGE(:,:, JBLK&
        &),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_FLASH (JLON, JBLK)=Z_YDMF_PHYS_OUT_FLASH (JLON, JBLK)/86400._JPRB
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
      &:CULIGHT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
      ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
      LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
      LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
      LLLINOX => GET_HOST_DATA_RDWR (YL_LLLINOX)
      ZCDEPTH => GET_HOST_DATA_RDWR (YL_ZCDEPTH)
      ZCHARGE => GET_HOST_DATA_RDWR (YL_ZCHARGE)
      ZCTOPH => GET_HOST_DATA_RDWR (YL_ZCTOPH)
      ZGAW => GET_HOST_DATA_RDWR (YL_ZGAW)
      ZICE => GET_HOST_DATA_RDWR (YL_ZICE)
      ZLIGH_CTG => GET_HOST_DATA_RDWR (YL_ZLIGH_CTG)
      ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
      ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
      ZPRECMX => GET_HOST_DATA_RDWR (YL_ZPRECMX)
      ZQPFROZ => GET_HOST_DATA_RDWR (YL_ZQPFROZ)
      ZWMFU => GET_HOST_DATA_RDWR (YL_ZWMFU)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_FLASH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FLASH)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
      Z_YDVARS_GEOMETRY_GAW_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GAW%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
      &:CULIGHT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ICBOT => NULL ()
    ICTOP => NULL ()
    LLCUM => NULL ()
    LLLAND => NULL ()
    LLLINOX => NULL ()
    ZCDEPTH => NULL ()
    ZCHARGE => NULL ()
    ZCTOPH => NULL ()
    ZGAW => NULL ()
    ZICE => NULL ()
    ZLIGH_CTG => NULL ()
    ZLU => NULL ()
    ZMFU => NULL ()
    ZPRECMX => NULL ()
    ZQPFROZ => NULL ()
    ZWMFU => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_OUT_CAPE => NULL ()
    Z_YDMF_PHYS_OUT_FLASH => NULL ()
    Z_YDMF_PHYS_OUT_FPLCL => NULL ()
    Z_YDMF_PHYS_OUT_FPLCN => NULL ()
    Z_YDVARS_GEOMETRY_GAW_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ICBOT => GET_DEVICE_DATA_RDONLY (YL_ICBOT)
    ICTOP => GET_DEVICE_DATA_RDONLY (YL_ICTOP)
    LLCUM => GET_DEVICE_DATA_RDONLY (YL_LLCUM)
    LLLAND => GET_DEVICE_DATA_RDONLY (YL_LLLAND)
    LLLINOX => GET_DEVICE_DATA_RDWR (YL_LLLINOX)
    ZCDEPTH => GET_DEVICE_DATA_RDWR (YL_ZCDEPTH)
    ZCHARGE => GET_DEVICE_DATA_RDWR (YL_ZCHARGE)
    ZCTOPH => GET_DEVICE_DATA_RDWR (YL_ZCTOPH)
    ZGAW => GET_DEVICE_DATA_RDWR (YL_ZGAW)
    ZICE => GET_DEVICE_DATA_RDWR (YL_ZICE)
    ZLIGH_CTG => GET_DEVICE_DATA_RDWR (YL_ZLIGH_CTG)
    ZLU => GET_DEVICE_DATA_RDONLY (YL_ZLU)
    ZMFU => GET_DEVICE_DATA_RDONLY (YL_ZMFU)
    ZPRECMX => GET_DEVICE_DATA_RDWR (YL_ZPRECMX)
    ZQPFROZ => GET_DEVICE_DATA_RDWR (YL_ZQPFROZ)
    ZWMFU => GET_DEVICE_DATA_RDWR (YL_ZWMFU)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_FLASH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FLASH)
    Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDVARS_GEOMETRY_GAW_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GAW%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (ICBOT, ICTOP, LLCUM, LLLAND, LLLINOX, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, &
      !$ACC&         ZCDEPTH, ZCHARGE, ZCTOPH, ZGAW, ZICE, ZLIGH_CTG, ZLU, ZMFU, ZPRECMX, &
      !$ACC&         ZQPFROZ, ZWMFU, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_OUT_CAPE, &
      !$ACC&         Z_YDMF_PHYS_OUT_FLASH, Z_YDMF_PHYS_OUT_FPLCL, Z_YDMF_PHYS_OUT_FPLCN, &
      !$ACC&         Z_YDVARS_GEOMETRY_GAW_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        ZGAW (JLON, JBLK)=Z_YDVARS_GEOMETRY_GAW_P (JLON, JBLK)
        ZQPFROZ (JLON,:, JBLK)=0
        ZCHARGE (JLON,:, JBLK)=0
        CALL CULIGHT_OPENACC (YDCPG_OPTS%RPLDARE, YDCPG_OPTS%RPLRG, YDMODEL%YRML_PHY_EC%YRTHF, YDMODEL&
        &%YRCST, YDMODEL%YRML_PHY_EC%YREPHY, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_PHY_EC%YRECUMF, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, ZGAW(:, JBLK), ZGAW(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), LLLAND(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
        &(:,:, JBLK), ZLU(:,:, JBLK), ZMFU(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE(:, JBLK), Z_YDMF_PHYS_OUT_FPLCL&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), ZQPFROZ(:,:, JBLK), LLCUM(:, JBLK), ICBOT(:, JBLK&
        &), ICTOP(:, JBLK), LLLINOX(:, JBLK), Z_YDMF_PHYS_OUT_FLASH(:, JBLK), ZLIGH_CTG(:, JBLK), ZCTOPH&
        &(:, JBLK), ZPRECMX(:, JBLK), ZICE(:, JBLK), ZCDEPTH(:, JBLK), ZWMFU(:, JBLK), ZCHARGE(:,:, JBLK&
        &),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_FLASH (JLON, JBLK)=Z_YDMF_PHYS_OUT_FLASH (JLON, JBLK)/86400._JPRB
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
      &:CULIGHT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ICBOT => GET_HOST_DATA_RDWR (YL_ICBOT)
      ICTOP => GET_HOST_DATA_RDWR (YL_ICTOP)
      LLCUM => GET_HOST_DATA_RDWR (YL_LLCUM)
      LLLAND => GET_HOST_DATA_RDWR (YL_LLLAND)
      LLLINOX => GET_HOST_DATA_RDWR (YL_LLLINOX)
      ZCDEPTH => GET_HOST_DATA_RDWR (YL_ZCDEPTH)
      ZCHARGE => GET_HOST_DATA_RDWR (YL_ZCHARGE)
      ZCTOPH => GET_HOST_DATA_RDWR (YL_ZCTOPH)
      ZGAW => GET_HOST_DATA_RDWR (YL_ZGAW)
      ZICE => GET_HOST_DATA_RDWR (YL_ZICE)
      ZLIGH_CTG => GET_HOST_DATA_RDWR (YL_ZLIGH_CTG)
      ZLU => GET_HOST_DATA_RDWR (YL_ZLU)
      ZMFU => GET_HOST_DATA_RDWR (YL_ZMFU)
      ZPRECMX => GET_HOST_DATA_RDWR (YL_ZPRECMX)
      ZQPFROZ => GET_HOST_DATA_RDWR (YL_ZQPFROZ)
      ZWMFU => GET_HOST_DATA_RDWR (YL_ZWMFU)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_FLASH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FLASH)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
      Z_YDVARS_GEOMETRY_GAW_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GAW%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
      &:CULIGHT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ICBOT => NULL ()
    ICTOP => NULL ()
    LLCUM => NULL ()
    LLLAND => NULL ()
    LLLINOX => NULL ()
    ZCDEPTH => NULL ()
    ZCHARGE => NULL ()
    ZCTOPH => NULL ()
    ZGAW => NULL ()
    ZICE => NULL ()
    ZLIGH_CTG => NULL ()
    ZLU => NULL ()
    ZMFU => NULL ()
    ZPRECMX => NULL ()
    ZQPFROZ => NULL ()
    ZWMFU => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_OUT_CAPE => NULL ()
    Z_YDMF_PHYS_OUT_FLASH => NULL ()
    Z_YDMF_PHYS_OUT_FPLCL => NULL ()
    Z_YDMF_PHYS_OUT_FPLCN => NULL ()
    Z_YDVARS_GEOMETRY_GAW_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL&
    &:CULIGHT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL:CULIGHT',1,ZHOOK_HANDLE_PARALLEL)
ENDIF



CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_IBASC)) CALL FIELD_DELETE (YL_IBASC)
IF (ASSOCIATED (YL_IBOTSC)) CALL FIELD_DELETE (YL_IBOTSC)
IF (ASSOCIATED (YL_ICBOT)) CALL FIELD_DELETE (YL_ICBOT)
IF (ASSOCIATED (YL_ICBOT_LIG)) CALL FIELD_DELETE (YL_ICBOT_LIG)
IF (ASSOCIATED (YL_ICTOP)) CALL FIELD_DELETE (YL_ICTOP)
IF (ASSOCIATED (YL_ICTOP_LIG)) CALL FIELD_DELETE (YL_ICTOP_LIG)
IF (ASSOCIATED (YL_ITOPC)) CALL FIELD_DELETE (YL_ITOPC)
IF (ASSOCIATED (YL_ITYPE)) CALL FIELD_DELETE (YL_ITYPE)
IF (ASSOCIATED (YL_LLCUM)) CALL FIELD_DELETE (YL_LLCUM)
IF (ASSOCIATED (YL_LLCUM_LIG)) CALL FIELD_DELETE (YL_LLCUM_LIG)
IF (ASSOCIATED (YL_LLLAND)) CALL FIELD_DELETE (YL_LLLAND)
IF (ASSOCIATED (YL_LLLINOX)) CALL FIELD_DELETE (YL_LLLINOX)
IF (ASSOCIATED (YL_LLSC)) CALL FIELD_DELETE (YL_LLSC)
IF (ASSOCIATED (YL_LLSHCV)) CALL FIELD_DELETE (YL_LLSHCV)
IF (ASSOCIATED (YL_ZACPR)) CALL FIELD_DELETE (YL_ZACPR)
IF (ASSOCIATED (YL_ZCDEPTH)) CALL FIELD_DELETE (YL_ZCDEPTH)
IF (ASSOCIATED (YL_ZCHARGE)) CALL FIELD_DELETE (YL_ZCHARGE)
IF (ASSOCIATED (YL_ZCTOPH)) CALL FIELD_DELETE (YL_ZCTOPH)
IF (ASSOCIATED (YL_ZCUCONVCA)) CALL FIELD_DELETE (YL_ZCUCONVCA)
IF (ASSOCIATED (YL_ZDIFF)) CALL FIELD_DELETE (YL_ZDIFF)
IF (ASSOCIATED (YL_ZDXTDK)) CALL FIELD_DELETE (YL_ZDXTDK)
IF (ASSOCIATED (YL_ZFCQLF)) CALL FIELD_DELETE (YL_ZFCQLF)
IF (ASSOCIATED (YL_ZFCQLI)) CALL FIELD_DELETE (YL_ZFCQLI)
IF (ASSOCIATED (YL_ZFHPCL)) CALL FIELD_DELETE (YL_ZFHPCL)
IF (ASSOCIATED (YL_ZFHPCN)) CALL FIELD_DELETE (YL_ZFHPCN)
IF (ASSOCIATED (YL_ZGAW)) CALL FIELD_DELETE (YL_ZGAW)
IF (ASSOCIATED (YL_ZGEOM1)) CALL FIELD_DELETE (YL_ZGEOM1)
IF (ASSOCIATED (YL_ZGEOMH)) CALL FIELD_DELETE (YL_ZGEOMH)
IF (ASSOCIATED (YL_ZGP2DSPPA)) CALL FIELD_DELETE (YL_ZGP2DSPPA)
IF (ASSOCIATED (YL_ZICE)) CALL FIELD_DELETE (YL_ZICE)
IF (ASSOCIATED (YL_ZLCRIT_AER)) CALL FIELD_DELETE (YL_ZLCRIT_AER)
IF (ASSOCIATED (YL_ZLGLAC)) CALL FIELD_DELETE (YL_ZLGLAC)
IF (ASSOCIATED (YL_ZLIGH_CTG)) CALL FIELD_DELETE (YL_ZLIGH_CTG)
IF (ASSOCIATED (YL_ZLISUM)) CALL FIELD_DELETE (YL_ZLISUM)
IF (ASSOCIATED (YL_ZLRAIN)) CALL FIELD_DELETE (YL_ZLRAIN)
IF (ASSOCIATED (YL_ZLU)) CALL FIELD_DELETE (YL_ZLU)
IF (ASSOCIATED (YL_ZLUDE)) CALL FIELD_DELETE (YL_ZLUDE)
IF (ASSOCIATED (YL_ZLUDELI)) CALL FIELD_DELETE (YL_ZLUDELI)
IF (ASSOCIATED (YL_ZMFD)) CALL FIELD_DELETE (YL_ZMFD)
IF (ASSOCIATED (YL_ZMFDDE_RATE)) CALL FIELD_DELETE (YL_ZMFDDE_RATE)
IF (ASSOCIATED (YL_ZMFU)) CALL FIELD_DELETE (YL_ZMFU)
IF (ASSOCIATED (YL_ZMFUDE_RATE)) CALL FIELD_DELETE (YL_ZMFUDE_RATE)
IF (ASSOCIATED (YL_ZPRECMX)) CALL FIELD_DELETE (YL_ZPRECMX)
IF (ASSOCIATED (YL_ZQPFROZ)) CALL FIELD_DELETE (YL_ZQPFROZ)
IF (ASSOCIATED (YL_ZRSUD)) CALL FIELD_DELETE (YL_ZRSUD)
IF (ASSOCIATED (YL_ZSNDE)) CALL FIELD_DELETE (YL_ZSNDE)
IF (ASSOCIATED (YL_ZTENDQ)) CALL FIELD_DELETE (YL_ZTENDQ)
IF (ASSOCIATED (YL_ZTENDT)) CALL FIELD_DELETE (YL_ZTENDT)
IF (ASSOCIATED (YL_ZTENQ)) CALL FIELD_DELETE (YL_ZTENQ)
IF (ASSOCIATED (YL_ZTENQA)) CALL FIELD_DELETE (YL_ZTENQA)
IF (ASSOCIATED (YL_ZTENT)) CALL FIELD_DELETE (YL_ZTENT)
IF (ASSOCIATED (YL_ZTENTA)) CALL FIELD_DELETE (YL_ZTENTA)
IF (ASSOCIATED (YL_ZTENU)) CALL FIELD_DELETE (YL_ZTENU)
IF (ASSOCIATED (YL_ZTENV)) CALL FIELD_DELETE (YL_ZTENV)
IF (ASSOCIATED (YL_ZVDISCU)) CALL FIELD_DELETE (YL_ZVDISCU)
IF (ASSOCIATED (YL_ZVERVEL)) CALL FIELD_DELETE (YL_ZVERVEL)
IF (ASSOCIATED (YL_ZWMEAN)) CALL FIELD_DELETE (YL_ZWMEAN)
IF (ASSOCIATED (YL_ZWMFU)) CALL FIELD_DELETE (YL_ZWMFU)
IF (ASSOCIATED (YL_ZWU)) CALL FIELD_DELETE (YL_ZWU)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_DEEP_CONVECTION_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_DEEP_CONVECTION_PARALLEL
