SUBROUTINE GPHLUV_EXPL_OPENACC (YDDIMV, KPROMA, KST, KEND, PU, PV, PWWI, PUH, PVH, YDSTACK)
!$ACC ROUTINE (GPHLUV_EXPL_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB

USE YOMDIMV,ONLY:TDIMV
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (TDIMV), INTENT (IN)::YDDIMV
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PU (KPROMA, YDDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PV (KPROMA, YDDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PWWI (KPROMA, 0:YDDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PUH (KPROMA, 0:YDDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PVH (KPROMA, 0:YDDIMV%NFLEVG)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPRB)::ZWW


JROF = KST





DO JLEV=1, YDDIMV%NFLEVG-1
  
  ZWW=PWWI (JROF, JLEV)
  PUH (JROF, JLEV)=ZWW*PU (JROF, JLEV)+(1.0_JPRB-ZWW)*PU (JROF, JLEV+1)
  PVH (JROF, JLEV)=ZWW*PV (JROF, JLEV)+(1.0_JPRB-ZWW)*PV (JROF, JLEV+1)
  
ENDDO

PUH (JROF, 0)=PU (JROF, 1)
PVH (JROF, 0)=PV (JROF, 1)
PUH (JROF, YDDIMV%NFLEVG)=PU (JROF, YDDIMV%NFLEVG)
PVH (JROF, YDDIMV%NFLEVG)=PV (JROF, YDDIMV%NFLEVG)


END SUBROUTINE GPHLUV_EXPL_OPENACC
