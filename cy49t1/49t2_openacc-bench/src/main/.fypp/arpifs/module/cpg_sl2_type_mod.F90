MODULE CPG_SL2_TYPE_MOD

!$ACDC methods --methods-list=host,wipe,copy --skip-components cpg --field-api --field-api-class cpg


USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_REGISTRY_MOD
USE PARKIND1, ONLY : JPRB, JPIM, JPIB

IMPLICIT NONE



TYPE CPG_SL2_TYPE
  LOGICAL :: LOWNED = .FALSE.
  INTEGER (KIND=JPIM) :: NLEV = -1
  INTEGER (KIND=JPIB) :: ISIZE = 0
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZVIEW (:,:) => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZDATA (:,:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_DATA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DBBC1 (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_DBBC1 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: DPHI1 (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_DPHI1 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: USI (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_USI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VSI (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_VSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: TSI (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_TSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: PDSI (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_PDSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VDSI (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_VDSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: SPSI (:) => NULL ()
  CLASS (FIELD_2RB), POINTER :: F_SPSI => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VVEL (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_VVEL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: URL (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_URL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VRL (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_VRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRL (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_WRL => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: URL5 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_URL5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VRL5 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_VRL5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: WRL5 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_WRL5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: USI5 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_USI5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: VSI5 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_VSI5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: U15 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_U15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: V15 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_V15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: T15 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_T15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: Q15 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_Q15 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPA (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_KAPPA => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAT (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_KAPPAT => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAM (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_KAPPAM => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAH (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_KAPPAH => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPA5 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_KAPPA5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: KAPPAT5 (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_KAPPAT5 => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWF (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_GWF => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GDW (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_GDW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: GWS (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_GWS => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STDDISU (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_STDDISU => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STDDISV (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_STDDISV => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: STDDISW (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_STDDISW => NULL ()
  REAL (KIND=JPRB), POINTER, CONTIGUOUS :: ZRL (:,:) => NULL ()
  CLASS (FIELD_3RB), POINTER :: F_ZRL => NULL ()

CONTAINS
  PROCEDURE :: INIT => CPG_SL2_TYPE_INIT
  PROCEDURE :: CONFORM => CPG_SL2_TYPE_CONFORM
  PROCEDURE :: RESIZE => CPG_SL2_TYPE_RESIZE
  PROCEDURE :: SYNC_HOST => CPG_SL2_TYPE_SYNC_HOST
  PROCEDURE :: SET => CPG_SL2_TYPE_SET
  PROCEDURE :: SET_HOST_PARALLEL => CPG_SL2_TYPE_SET_HOST_PARALLEL
  PROCEDURE :: SET_DEVICE_PARALLEL => CPG_SL2_TYPE_SET_DEVICE_PARALLEL
  PROCEDURE :: UPDATE_VIEW => CPG_SL2_TYPE_UPDATE_VIEW
  PROCEDURE :: FINAL => CPG_SL2_TYPE_FINAL
END TYPE CPG_SL2_TYPE

REAL(KIND=JPRB),    PRIVATE, SAVE, TARGET :: ZDUM1 (1), ZDUM2 (1, 1)

CONTAINS

SUBROUTINE CPG_SL2_TYPE_INIT (SELF, REGISTRY, NLEV, YDTPTRSLB2 &
                                & , PERSISTENT, PB2)

USE PTRSLB2, ONLY : TPTRSLB2
USE OML_MOD, ONLY: OML_MAX_THREADS

USE FIELD_DEFAULTS_MODULE

CLASS (CPG_SL2_TYPE)                               :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB2),                    INTENT (IN)    :: YDTPTRSLB2
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT
REAL (KIND=JPRB), OPTIONAL, TARGET, INTENT (IN)    :: PB2 (:, :, :)

INTEGER (KIND=JPIM) :: JFLD

LOGICAL :: LLPERSISTENT
LOGICAL :: LLINITIALIZED

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

SELF%NLEV = NLEV

LLINITIALIZED = .FALSE.

IF (PRESENT (PB2)) THEN
  SELF%ZDATA => PB2
  SELF%LOWNED = .FALSE.
  LLPERSISTENT = .TRUE.
  LLINITIALIZED = .TRUE.
ELSEIF (LLPERSISTENT) THEN
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB2%NFLDSLB2, REGISTRY%GEOM%YRDIM%NGPBLKS))
  IF (USE_INIT_DEBUG_VALUE) THEN
    SELF%ZDATA = INIT_DEBUG_VALUE_JPRB
    LLINITIALIZED = .TRUE.
  ENDIF
  SELF%LOWNED = .TRUE.
ELSE
  ALLOCATE (SELF%ZDATA (REGISTRY%GEOM%YRDIM%NPROMA, YDTPTRSLB2%NFLDSLB2, OML_MAX_THREADS ()))
  IF (USE_INIT_DEBUG_VALUE) THEN
    SELF%ZDATA = INIT_DEBUG_VALUE_JPRB
    LLINITIALIZED = .TRUE.
  ENDIF
  SELF%LOWNED = .TRUE.
ENDIF

CALL FIELD_NEW (SELF%F_DATA, DATA=SELF%ZDATA, PERSISTENT=LLPERSISTENT)


IF (YDTPTRSLB2%MSLB2DBBC1 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2DBBC1
  CALL FIELD_NEW (SELF%F_DBBC1, DATA=SELF%ZDATA (:, JFLD,             :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_DBBC1 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2DPHI1 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2DPHI1
  CALL FIELD_NEW (SELF%F_DPHI1, DATA=SELF%ZDATA (:, JFLD,             :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_DPHI1 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2USI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2USI
  CALL FIELD_NEW (SELF%F_USI, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_USI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VSI
  CALL FIELD_NEW (SELF%F_VSI, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_VSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2TSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2TSI
  CALL FIELD_NEW (SELF%F_TSI, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_TSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2PDSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2PDSI
  CALL FIELD_NEW (SELF%F_PDSI, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_PDSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VDSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VDSI
  CALL FIELD_NEW (SELF%F_VDSI, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_VDSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2SPSI > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2SPSI
  CALL FIELD_NEW (SELF%F_SPSI, DATA=SELF%ZDATA (:, JFLD,             :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_SPSI => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VVEL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VVEL
  CALL FIELD_NEW (SELF%F_VVEL, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_VVEL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2URL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2URL
  CALL FIELD_NEW (SELF%F_URL, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_URL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VRL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VRL
  CALL FIELD_NEW (SELF%F_VRL, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_VRL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2WRL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2WRL
  CALL FIELD_NEW (SELF%F_WRL, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_WRL => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2URL5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2URL5
  CALL FIELD_NEW (SELF%F_URL5, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_URL5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VRL5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VRL5
  CALL FIELD_NEW (SELF%F_VRL5, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_VRL5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2WRL5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2WRL5
  CALL FIELD_NEW (SELF%F_WRL5, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_WRL5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2USI5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2USI5
  CALL FIELD_NEW (SELF%F_USI5, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_USI5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2VSI5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2VSI5
  CALL FIELD_NEW (SELF%F_VSI5, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_VSI5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2U15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2U15
  CALL FIELD_NEW (SELF%F_U15, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_U15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2V15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2V15
  CALL FIELD_NEW (SELF%F_V15, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_V15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2T15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2T15
  CALL FIELD_NEW (SELF%F_T15, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_T15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2Q15 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2Q15
  CALL FIELD_NEW (SELF%F_Q15, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_Q15 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPA > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPA
  CALL FIELD_NEW (SELF%F_KAPPA, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_KAPPA => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAT > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAT
  CALL FIELD_NEW (SELF%F_KAPPAT, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_KAPPAT => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAM > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAM
  CALL FIELD_NEW (SELF%F_KAPPAM, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_KAPPAM => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAH > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAH
  CALL FIELD_NEW (SELF%F_KAPPAH, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_KAPPAH => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPA5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPA5
  CALL FIELD_NEW (SELF%F_KAPPA5, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_KAPPA5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2KAPPAT5 > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2KAPPAT5
  CALL FIELD_NEW (SELF%F_KAPPAT5, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_KAPPAT5 => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2GWF > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2GWF
  CALL FIELD_NEW (SELF%F_GWF, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_GWF => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2GDW > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2GDW
  CALL FIELD_NEW (SELF%F_GDW, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_GDW => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2GWS > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2GWS
  CALL FIELD_NEW (SELF%F_GWS, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_GWS => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2STDDISU > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2STDDISU
  CALL FIELD_NEW (SELF%F_STDDISU, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_STDDISU => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2STDDISV > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2STDDISV
  CALL FIELD_NEW (SELF%F_STDDISV, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_STDDISV => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2STDDISW > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2STDDISW
  CALL FIELD_NEW (SELF%F_STDDISW, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_STDDISW => NULL ()
ENDIF
IF (YDTPTRSLB2%MSLB2ZRL > 0) THEN
  JFLD = YDTPTRSLB2%MSLB2ZRL
  CALL FIELD_NEW (SELF%F_ZRL, DATA=SELF%ZDATA (:, JFLD:JFLD+NLEV-1, :), &
      & PERSISTENT=LLPERSISTENT, INITIALIZED=LLINITIALIZED, SYNC_ON_FINAL=.FALSE.)
ELSE
  SELF%F_ZRL => NULL ()
ENDIF

END SUBROUTINE CPG_SL2_TYPE_INIT

SUBROUTINE CPG_SL2_TYPE_RESIZE (SELF, REGISTRY, NLEV, YDTPTRSLB2, PERSISTENT)

USE PTRSLB2, ONLY : TPTRSLB2

CLASS (CPG_SL2_TYPE)                               :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB2),                    INTENT (IN)    :: YDTPTRSLB2
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT

IF (.NOT. SELF%CONFORM (REGISTRY, NLEV, YDTPTRSLB2, PERSISTENT)) THEN
  CALL SELF%FINAL
  CALL SELF%INIT (REGISTRY, NLEV, YDTPTRSLB2, PERSISTENT)
ENDIF

END SUBROUTINE CPG_SL2_TYPE_RESIZE

LOGICAL FUNCTION CPG_SL2_TYPE_CONFORM (SELF, REGISTRY, NLEV, YDTPTRSLB2, PERSISTENT) RESULT (LLCONFORM)

USE PTRSLB2, ONLY : TPTRSLB2
USE OML_MOD, ONLY: OML_MAX_THREADS

CLASS (CPG_SL2_TYPE)                               :: SELF
TYPE (FIELD_REGISTRY),              INTENT (IN)    :: REGISTRY
INTEGER (KIND=JPIM),                INTENT (IN)    :: NLEV
TYPE (TPTRSLB2),                    INTENT (IN)    :: YDTPTRSLB2
LOGICAL, OPTIONAL,                  INTENT (IN)    :: PERSISTENT

LOGICAL :: LLPERSISTENT

LLCONFORM = .FALSE.

LLPERSISTENT = .FALSE.
IF (PRESENT (PERSISTENT)) LLPERSISTENT = PERSISTENT

IF (.NOT. ASSOCIATED (SELF%ZDATA)) RETURN

IF (SELF%NLEV /= NLEV) RETURN

IF (SIZE (SELF%ZDATA, 1) /= REGISTRY%GEOM%YRDIM%NPROMA) RETURN
IF (SIZE (SELF%ZDATA, 2) /= YDTPTRSLB2%NFLDSLB2) RETURN

IF (LLPERSISTENT) THEN
  IF (SIZE (SELF%ZDATA, 3) /= REGISTRY%GEOM%YRDIM%NGPBLKS) RETURN
ELSE
  IF (SIZE (SELF%ZDATA, 3) /= OML_MAX_THREADS ()) RETURN
ENDIF

LLCONFORM = .TRUE.

END FUNCTION CPG_SL2_TYPE_CONFORM

SUBROUTINE CPG_SL2_TYPE_UPDATE_VIEW (SELF, BLOCK_INDEX)

CLASS (CPG_SL2_TYPE)        :: SELF
INTEGER(KIND=JPIM), INTENT (IN)   :: BLOCK_INDEX

IF (ASSOCIATED (SELF%F_DATA)) THEN
  SELF%ZVIEW => SELF%F_DATA%GET_VIEW (BLOCK_INDEX)
  IF (ASSOCIATED (SELF%F_DBBC1)) THEN
    IF ((.NOT. SELF%F_DBBC1%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DBBC1))) THEN
      SELF%DBBC1 => SELF%F_DBBC1%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%DBBC1)) THEN
    SELF%DBBC1 => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_DPHI1)) THEN
    IF ((.NOT. SELF%F_DPHI1%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%DPHI1))) THEN
      SELF%DPHI1 => SELF%F_DPHI1%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%DPHI1)) THEN
    SELF%DPHI1 => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_USI)) THEN
    IF ((.NOT. SELF%F_USI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%USI))) THEN
      SELF%USI => SELF%F_USI%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%USI)) THEN
    SELF%USI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VSI)) THEN
    IF ((.NOT. SELF%F_VSI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VSI))) THEN
      SELF%VSI => SELF%F_VSI%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VSI)) THEN
    SELF%VSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_TSI)) THEN
    IF ((.NOT. SELF%F_TSI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%TSI))) THEN
      SELF%TSI => SELF%F_TSI%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%TSI)) THEN
    SELF%TSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_PDSI)) THEN
    IF ((.NOT. SELF%F_PDSI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%PDSI))) THEN
      SELF%PDSI => SELF%F_PDSI%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%PDSI)) THEN
    SELF%PDSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VDSI)) THEN
    IF ((.NOT. SELF%F_VDSI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VDSI))) THEN
      SELF%VDSI => SELF%F_VDSI%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VDSI)) THEN
    SELF%VDSI => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_SPSI)) THEN
    IF ((.NOT. SELF%F_SPSI%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%SPSI))) THEN
      SELF%SPSI => SELF%F_SPSI%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%SPSI)) THEN
    SELF%SPSI => ZDUM1
  ENDIF
  IF (ASSOCIATED (SELF%F_VVEL)) THEN
    IF ((.NOT. SELF%F_VVEL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VVEL))) THEN
      SELF%VVEL => SELF%F_VVEL%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VVEL)) THEN
    SELF%VVEL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_URL)) THEN
    IF ((.NOT. SELF%F_URL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%URL))) THEN
      SELF%URL => SELF%F_URL%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%URL)) THEN
    SELF%URL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VRL)) THEN
    IF ((.NOT. SELF%F_VRL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VRL))) THEN
      SELF%VRL => SELF%F_VRL%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VRL)) THEN
    SELF%VRL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WRL)) THEN
    IF ((.NOT. SELF%F_WRL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WRL))) THEN
      SELF%WRL => SELF%F_WRL%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WRL)) THEN
    SELF%WRL => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_URL5)) THEN
    IF ((.NOT. SELF%F_URL5%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%URL5))) THEN
      SELF%URL5 => SELF%F_URL5%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%URL5)) THEN
    SELF%URL5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VRL5)) THEN
    IF ((.NOT. SELF%F_VRL5%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VRL5))) THEN
      SELF%VRL5 => SELF%F_VRL5%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VRL5)) THEN
    SELF%VRL5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_WRL5)) THEN
    IF ((.NOT. SELF%F_WRL5%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%WRL5))) THEN
      SELF%WRL5 => SELF%F_WRL5%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%WRL5)) THEN
    SELF%WRL5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_USI5)) THEN
    IF ((.NOT. SELF%F_USI5%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%USI5))) THEN
      SELF%USI5 => SELF%F_USI5%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%USI5)) THEN
    SELF%USI5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_VSI5)) THEN
    IF ((.NOT. SELF%F_VSI5%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%VSI5))) THEN
      SELF%VSI5 => SELF%F_VSI5%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%VSI5)) THEN
    SELF%VSI5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_U15)) THEN
    IF ((.NOT. SELF%F_U15%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%U15))) THEN
      SELF%U15 => SELF%F_U15%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%U15)) THEN
    SELF%U15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_V15)) THEN
    IF ((.NOT. SELF%F_V15%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%V15))) THEN
      SELF%V15 => SELF%F_V15%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%V15)) THEN
    SELF%V15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_T15)) THEN
    IF ((.NOT. SELF%F_T15%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%T15))) THEN
      SELF%T15 => SELF%F_T15%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%T15)) THEN
    SELF%T15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_Q15)) THEN
    IF ((.NOT. SELF%F_Q15%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%Q15))) THEN
      SELF%Q15 => SELF%F_Q15%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%Q15)) THEN
    SELF%Q15 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPA)) THEN
    IF ((.NOT. SELF%F_KAPPA%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%KAPPA))) THEN
      SELF%KAPPA => SELF%F_KAPPA%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%KAPPA)) THEN
    SELF%KAPPA => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAT)) THEN
    IF ((.NOT. SELF%F_KAPPAT%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%KAPPAT))) THEN
      SELF%KAPPAT => SELF%F_KAPPAT%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%KAPPAT)) THEN
    SELF%KAPPAT => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAM)) THEN
    IF ((.NOT. SELF%F_KAPPAM%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%KAPPAM))) THEN
      SELF%KAPPAM => SELF%F_KAPPAM%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%KAPPAM)) THEN
    SELF%KAPPAM => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAH)) THEN
    IF ((.NOT. SELF%F_KAPPAH%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%KAPPAH))) THEN
      SELF%KAPPAH => SELF%F_KAPPAH%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%KAPPAH)) THEN
    SELF%KAPPAH => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPA5)) THEN
    IF ((.NOT. SELF%F_KAPPA5%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%KAPPA5))) THEN
      SELF%KAPPA5 => SELF%F_KAPPA5%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%KAPPA5)) THEN
    SELF%KAPPA5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_KAPPAT5)) THEN
    IF ((.NOT. SELF%F_KAPPAT5%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%KAPPAT5))) THEN
      SELF%KAPPAT5 => SELF%F_KAPPAT5%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%KAPPAT5)) THEN
    SELF%KAPPAT5 => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_GWF)) THEN
    IF ((.NOT. SELF%F_GWF%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GWF))) THEN
      SELF%GWF => SELF%F_GWF%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%GWF)) THEN
    SELF%GWF => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_GDW)) THEN
    IF ((.NOT. SELF%F_GDW%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GDW))) THEN
      SELF%GDW => SELF%F_GDW%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%GDW)) THEN
    SELF%GDW => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_GWS)) THEN
    IF ((.NOT. SELF%F_GWS%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%GWS))) THEN
      SELF%GWS => SELF%F_GWS%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%GWS)) THEN
    SELF%GWS => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_STDDISU)) THEN
    IF ((.NOT. SELF%F_STDDISU%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STDDISU))) THEN
      SELF%STDDISU => SELF%F_STDDISU%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%STDDISU)) THEN
    SELF%STDDISU => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_STDDISV)) THEN
    IF ((.NOT. SELF%F_STDDISV%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STDDISV))) THEN
      SELF%STDDISV => SELF%F_STDDISV%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%STDDISV)) THEN
    SELF%STDDISV => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_STDDISW)) THEN
    IF ((.NOT. SELF%F_STDDISW%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%STDDISW))) THEN
      SELF%STDDISW => SELF%F_STDDISW%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%STDDISW)) THEN
    SELF%STDDISW => ZDUM2
  ENDIF
  IF (ASSOCIATED (SELF%F_ZRL)) THEN
    IF ((.NOT. SELF%F_ZRL%THREAD_BUFFER) .OR. (.NOT. ASSOCIATED (SELF%ZRL))) THEN
      SELF%ZRL => SELF%F_ZRL%GET_VIEW (BLOCK_INDEX)
    ENDIF
  ELSEIF (.NOT. ASSOCIATED (SELF%ZRL)) THEN
    SELF%ZRL => ZDUM2
  ENDIF

ELSE
  SELF%ZVIEW => ZDUM2

  IF (.NOT. ASSOCIATED (SELF%DBBC1)) SELF%DBBC1 => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%DPHI1)) SELF%DPHI1 => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%USI)) SELF%USI => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VSI)) SELF%VSI => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%TSI)) SELF%TSI => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%PDSI)) SELF%PDSI => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VDSI)) SELF%VDSI => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%SPSI)) SELF%SPSI => ZDUM1
  IF (.NOT. ASSOCIATED (SELF%VVEL)) SELF%VVEL => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%URL)) SELF%URL => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VRL)) SELF%VRL => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WRL)) SELF%WRL => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%URL5)) SELF%URL5 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VRL5)) SELF%VRL5 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%WRL5)) SELF%WRL5 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%USI5)) SELF%USI5 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%VSI5)) SELF%VSI5 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%U15)) SELF%U15 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%V15)) SELF%V15 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%T15)) SELF%T15 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%Q15)) SELF%Q15 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%KAPPA)) SELF%KAPPA => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%KAPPAT)) SELF%KAPPAT => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%KAPPAM)) SELF%KAPPAM => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%KAPPAH)) SELF%KAPPAH => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%KAPPA5)) SELF%KAPPA5 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%KAPPAT5)) SELF%KAPPAT5 => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%GWF)) SELF%GWF => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%GDW)) SELF%GDW => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%GWS)) SELF%GWS => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%STDDISU)) SELF%STDDISU => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%STDDISV)) SELF%STDDISV => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%STDDISW)) SELF%STDDISW => ZDUM2
  IF (.NOT. ASSOCIATED (SELF%ZRL)) SELF%ZRL => ZDUM2

ENDIF

END SUBROUTINE CPG_SL2_TYPE_UPDATE_VIEW

SUBROUTINE CPG_SL2_TYPE_FINAL (SELF)
CLASS (CPG_SL2_TYPE)          :: SELF

IF (ASSOCIATED (SELF%F_ZRL)) CALL FIELD_DELETE (SELF%F_ZRL)
SELF%F_ZRL => NULL ()
SELF%ZRL => NULL ()
IF (ASSOCIATED (SELF%F_STDDISW)) CALL FIELD_DELETE (SELF%F_STDDISW)
SELF%F_STDDISW => NULL ()
SELF%STDDISW => NULL ()
IF (ASSOCIATED (SELF%F_STDDISV)) CALL FIELD_DELETE (SELF%F_STDDISV)
SELF%F_STDDISV => NULL ()
SELF%STDDISV => NULL ()
IF (ASSOCIATED (SELF%F_STDDISU)) CALL FIELD_DELETE (SELF%F_STDDISU)
SELF%F_STDDISU => NULL ()
SELF%STDDISU => NULL ()
IF (ASSOCIATED (SELF%F_GWS)) CALL FIELD_DELETE (SELF%F_GWS)
SELF%F_GWS => NULL ()
SELF%GWS => NULL ()
IF (ASSOCIATED (SELF%F_GDW)) CALL FIELD_DELETE (SELF%F_GDW)
SELF%F_GDW => NULL ()
SELF%GDW => NULL ()
IF (ASSOCIATED (SELF%F_GWF)) CALL FIELD_DELETE (SELF%F_GWF)
SELF%F_GWF => NULL ()
SELF%GWF => NULL ()
IF (ASSOCIATED (SELF%F_KAPPAT5)) CALL FIELD_DELETE (SELF%F_KAPPAT5)
SELF%F_KAPPAT5 => NULL ()
SELF%KAPPAT5 => NULL ()
IF (ASSOCIATED (SELF%F_KAPPA5)) CALL FIELD_DELETE (SELF%F_KAPPA5)
SELF%F_KAPPA5 => NULL ()
SELF%KAPPA5 => NULL ()
IF (ASSOCIATED (SELF%F_KAPPAH)) CALL FIELD_DELETE (SELF%F_KAPPAH)
SELF%F_KAPPAH => NULL ()
SELF%KAPPAH => NULL ()
IF (ASSOCIATED (SELF%F_KAPPAM)) CALL FIELD_DELETE (SELF%F_KAPPAM)
SELF%F_KAPPAM => NULL ()
SELF%KAPPAM => NULL ()
IF (ASSOCIATED (SELF%F_KAPPAT)) CALL FIELD_DELETE (SELF%F_KAPPAT)
SELF%F_KAPPAT => NULL ()
SELF%KAPPAT => NULL ()
IF (ASSOCIATED (SELF%F_KAPPA)) CALL FIELD_DELETE (SELF%F_KAPPA)
SELF%F_KAPPA => NULL ()
SELF%KAPPA => NULL ()
IF (ASSOCIATED (SELF%F_Q15)) CALL FIELD_DELETE (SELF%F_Q15)
SELF%F_Q15 => NULL ()
SELF%Q15 => NULL ()
IF (ASSOCIATED (SELF%F_T15)) CALL FIELD_DELETE (SELF%F_T15)
SELF%F_T15 => NULL ()
SELF%T15 => NULL ()
IF (ASSOCIATED (SELF%F_V15)) CALL FIELD_DELETE (SELF%F_V15)
SELF%F_V15 => NULL ()
SELF%V15 => NULL ()
IF (ASSOCIATED (SELF%F_U15)) CALL FIELD_DELETE (SELF%F_U15)
SELF%F_U15 => NULL ()
SELF%U15 => NULL ()
IF (ASSOCIATED (SELF%F_VSI5)) CALL FIELD_DELETE (SELF%F_VSI5)
SELF%F_VSI5 => NULL ()
SELF%VSI5 => NULL ()
IF (ASSOCIATED (SELF%F_USI5)) CALL FIELD_DELETE (SELF%F_USI5)
SELF%F_USI5 => NULL ()
SELF%USI5 => NULL ()
IF (ASSOCIATED (SELF%F_WRL5)) CALL FIELD_DELETE (SELF%F_WRL5)
SELF%F_WRL5 => NULL ()
SELF%WRL5 => NULL ()
IF (ASSOCIATED (SELF%F_VRL5)) CALL FIELD_DELETE (SELF%F_VRL5)
SELF%F_VRL5 => NULL ()
SELF%VRL5 => NULL ()
IF (ASSOCIATED (SELF%F_URL5)) CALL FIELD_DELETE (SELF%F_URL5)
SELF%F_URL5 => NULL ()
SELF%URL5 => NULL ()
IF (ASSOCIATED (SELF%F_WRL)) CALL FIELD_DELETE (SELF%F_WRL)
SELF%F_WRL => NULL ()
SELF%WRL => NULL ()
IF (ASSOCIATED (SELF%F_VRL)) CALL FIELD_DELETE (SELF%F_VRL)
SELF%F_VRL => NULL ()
SELF%VRL => NULL ()
IF (ASSOCIATED (SELF%F_URL)) CALL FIELD_DELETE (SELF%F_URL)
SELF%F_URL => NULL ()
SELF%URL => NULL ()
IF (ASSOCIATED (SELF%F_VVEL)) CALL FIELD_DELETE (SELF%F_VVEL)
SELF%F_VVEL => NULL ()
SELF%VVEL => NULL ()
IF (ASSOCIATED (SELF%F_SPSI)) CALL FIELD_DELETE (SELF%F_SPSI)
SELF%F_SPSI => NULL ()
SELF%SPSI => NULL ()
IF (ASSOCIATED (SELF%F_VDSI)) CALL FIELD_DELETE (SELF%F_VDSI)
SELF%F_VDSI => NULL ()
SELF%VDSI => NULL ()
IF (ASSOCIATED (SELF%F_PDSI)) CALL FIELD_DELETE (SELF%F_PDSI)
SELF%F_PDSI => NULL ()
SELF%PDSI => NULL ()
IF (ASSOCIATED (SELF%F_TSI)) CALL FIELD_DELETE (SELF%F_TSI)
SELF%F_TSI => NULL ()
SELF%TSI => NULL ()
IF (ASSOCIATED (SELF%F_VSI)) CALL FIELD_DELETE (SELF%F_VSI)
SELF%F_VSI => NULL ()
SELF%VSI => NULL ()
IF (ASSOCIATED (SELF%F_USI)) CALL FIELD_DELETE (SELF%F_USI)
SELF%F_USI => NULL ()
SELF%USI => NULL ()
IF (ASSOCIATED (SELF%F_DPHI1)) CALL FIELD_DELETE (SELF%F_DPHI1)
SELF%F_DPHI1 => NULL ()
SELF%DPHI1 => NULL ()
IF (ASSOCIATED (SELF%F_DBBC1)) CALL FIELD_DELETE (SELF%F_DBBC1)
SELF%F_DBBC1 => NULL ()
SELF%DBBC1 => NULL ()

IF (ASSOCIATED (SELF%F_DATA)) CALL FIELD_DELETE (SELF%F_DATA)
SELF%F_DATA => NULL ()

IF (SELF%LOWNED) THEN
  IF (ASSOCIATED (SELF%ZDATA)) DEALLOCATE (SELF%ZDATA)
ENDIF

SELF%ZDATA => NULL ()
SELF%ZVIEW => NULL ()

END SUBROUTINE CPG_SL2_TYPE_FINAL

SUBROUTINE CPG_SL2_TYPE_SYNC_HOST (SELF)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK
USE FIELD_ACCESS_MODULE

CLASS (CPG_SL2_TYPE) :: SELF

REAL (KIND=JPRB), POINTER :: PTR2 (:,:), PTR3 (:,:,:)

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SYNC_HOST', 0, ZHOOK_HANDLE)

IF (ASSOCIATED (SELF%F_DBBC1)) THEN
  PTR2 => GET_HOST_DATA_RDWR (SELF%F_DBBC1)
ENDIF
IF (ASSOCIATED (SELF%F_DPHI1)) THEN
  PTR2 => GET_HOST_DATA_RDWR (SELF%F_DPHI1)
ENDIF
IF (ASSOCIATED (SELF%F_USI)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_USI)
ENDIF
IF (ASSOCIATED (SELF%F_VSI)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_VSI)
ENDIF
IF (ASSOCIATED (SELF%F_TSI)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_TSI)
ENDIF
IF (ASSOCIATED (SELF%F_PDSI)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_PDSI)
ENDIF
IF (ASSOCIATED (SELF%F_VDSI)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_VDSI)
ENDIF
IF (ASSOCIATED (SELF%F_SPSI)) THEN
  PTR2 => GET_HOST_DATA_RDWR (SELF%F_SPSI)
ENDIF
IF (ASSOCIATED (SELF%F_VVEL)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_VVEL)
ENDIF
IF (ASSOCIATED (SELF%F_URL)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_URL)
ENDIF
IF (ASSOCIATED (SELF%F_VRL)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_VRL)
ENDIF
IF (ASSOCIATED (SELF%F_WRL)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_WRL)
ENDIF
IF (ASSOCIATED (SELF%F_URL5)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_URL5)
ENDIF
IF (ASSOCIATED (SELF%F_VRL5)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_VRL5)
ENDIF
IF (ASSOCIATED (SELF%F_WRL5)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_WRL5)
ENDIF
IF (ASSOCIATED (SELF%F_USI5)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_USI5)
ENDIF
IF (ASSOCIATED (SELF%F_VSI5)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_VSI5)
ENDIF
IF (ASSOCIATED (SELF%F_U15)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_U15)
ENDIF
IF (ASSOCIATED (SELF%F_V15)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_V15)
ENDIF
IF (ASSOCIATED (SELF%F_T15)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_T15)
ENDIF
IF (ASSOCIATED (SELF%F_Q15)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_Q15)
ENDIF
IF (ASSOCIATED (SELF%F_KAPPA)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_KAPPA)
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAT)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_KAPPAT)
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAM)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_KAPPAM)
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAH)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_KAPPAH)
ENDIF
IF (ASSOCIATED (SELF%F_KAPPA5)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_KAPPA5)
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAT5)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_KAPPAT5)
ENDIF
IF (ASSOCIATED (SELF%F_GWF)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_GWF)
ENDIF
IF (ASSOCIATED (SELF%F_GDW)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_GDW)
ENDIF
IF (ASSOCIATED (SELF%F_GWS)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_GWS)
ENDIF
IF (ASSOCIATED (SELF%F_STDDISU)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_STDDISU)
ENDIF
IF (ASSOCIATED (SELF%F_STDDISV)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_STDDISV)
ENDIF
IF (ASSOCIATED (SELF%F_STDDISW)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_STDDISW)
ENDIF
IF (ASSOCIATED (SELF%F_ZRL)) THEN
  PTR3 => GET_HOST_DATA_RDWR (SELF%F_ZRL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SYNC_HOST', 1, ZHOOK_HANDLE)

END SUBROUTINE CPG_SL2_TYPE_SYNC_HOST

SUBROUTINE CPG_SL2_TYPE_SET (SELF, YDCPG_OPTS, YDCPG_BNDS, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

CLASS (CPG_SL2_TYPE) :: SELF
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
REAL (KIND=JPRB), INTENT(IN) :: PVALUE

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SET', 0, ZHOOK_HANDLE)

SELF%ZVIEW = 0._JPRB

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SET', 1, ZHOOK_HANDLE)

END SUBROUTINE

SUBROUTINE CPG_SL2_TYPE_SET_HOST_PARALLEL (SELF, YDCPG_OPTS, YDCPG_BNDS, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

CLASS (CPG_SL2_TYPE) :: SELF
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
REAL (KIND=JPRB), INTENT(IN) :: PVALUE

INTEGER (KIND=JPIM) :: JBLK

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SET_HOST_PARALLEL', 0, ZHOOK_HANDLE)

CALL SELF%SYNC_HOST

!$OMP PARALLEL DO PRIVATE (JBLK)
DO JBLK = 1, YDCPG_OPTS%KGPBLKS
  SELF%ZDATA (:,:,JBLK) = PVALUE
ENDDO
!$OMP END PARALLEL DO

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SET_HOST_PARALLEL', 1, ZHOOK_HANDLE)

END SUBROUTINE

SUBROUTINE CPG_SL2_TYPE_SET_DEVICE_PARALLEL (SELF, YDCPG_OPTS, YDCPG_BNDS, PVALUE)

USE YOMHOOK, ONLY : LHOOK, DR_HOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD  , ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE

USE FIELD_ACCESS_MODULE

CLASS (CPG_SL2_TYPE) :: SELF
TYPE(CPG_OPTS_TYPE) ,INTENT(IN)   :: YDCPG_OPTS
TYPE(CPG_BNDS_TYPE) ,INTENT(IN)   :: YDCPG_BNDS
REAL (KIND=JPRB), INTENT(IN) :: PVALUE

REAL (KIND=JPRB), POINTER :: Z2 (:,:), Z3 (:,:,:)
INTEGER (KIND=JPIM) :: JROF, JBLK

REAL (KIND=JPHOOK) :: ZHOOK_HANDLE

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SET_DEVICE_PARALLEL', 0, ZHOOK_HANDLE)

IF (ASSOCIATED (SELF%F_DBBC1)) THEN
  Z2 => GET_DEVICE_DATA_RDWR (SELF%F_DBBC1)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z2, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z2 (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_DPHI1)) THEN
  Z2 => GET_DEVICE_DATA_RDWR (SELF%F_DPHI1)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z2, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z2 (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_USI)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_USI)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_VSI)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_VSI)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_TSI)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_TSI)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_PDSI)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_PDSI)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_VDSI)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_VDSI)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_SPSI)) THEN
  Z2 => GET_DEVICE_DATA_RDWR (SELF%F_SPSI)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z2, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z2 (JROF, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_VVEL)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_VVEL)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_URL)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_URL)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_VRL)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_VRL)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_WRL)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_WRL)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_URL5)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_URL5)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_VRL5)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_VRL5)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_WRL5)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_WRL5)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_USI5)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_USI5)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_VSI5)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_VSI5)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_U15)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_U15)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_V15)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_V15)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_T15)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_T15)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_Q15)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_Q15)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_KAPPA)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_KAPPA)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAT)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_KAPPAT)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAM)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_KAPPAM)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAH)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_KAPPAH)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_KAPPA5)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_KAPPA5)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_KAPPAT5)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_KAPPAT5)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_GWF)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_GWF)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_GDW)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_GDW)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_GWS)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_GWS)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_STDDISU)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_STDDISU)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_STDDISV)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_STDDISV)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_STDDISW)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_STDDISW)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF
IF (ASSOCIATED (SELF%F_ZRL)) THEN
  Z3 => GET_DEVICE_DATA_RDWR (SELF%F_ZRL)
!$acc parallel loop gang vector vector_length (YDCPG_OPTS%KLON) collapse (2) present (Z3, YDCPG_OPTS)
  DO JBLK = 1, YDCPG_OPTS%KGPBLKS
    DO JROF = 1, YDCPG_OPTS%KLON
      Z3 (JROF, :, JBLK) = PVALUE
    ENDDO
  ENDDO
!$acc end parallel loop
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_SL2_TYPE_SET_DEVICE_PARALLEL', 1, ZHOOK_HANDLE)

END SUBROUTINE

END MODULE CPG_SL2_TYPE_MOD

