MODULE UTIL_TRADF_MOD

USE YOMRADF, ONLY : TRADF

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TRADF
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TRADF
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TRADF
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TRADF
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TRADF
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TRADF
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TRADF
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TRADF (SELF, KLUN)

IMPLICIT NONE
TYPE (TRADF), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW
LEMTD = ALLOCATED (SELF%EMTD)
WRITE (KLUN) LEMTD
IF (LEMTD) THEN
  WRITE (KLUN) LBOUND (SELF%EMTD)
  WRITE (KLUN) UBOUND (SELF%EMTD)
  WRITE (KLUN) SELF%EMTD
ENDIF
LTRSW = ALLOCATED (SELF%TRSW)
WRITE (KLUN) LTRSW
IF (LTRSW) THEN
  WRITE (KLUN) LBOUND (SELF%TRSW)
  WRITE (KLUN) UBOUND (SELF%TRSW)
  WRITE (KLUN) SELF%TRSW
ENDIF
LEMTC = ALLOCATED (SELF%EMTC)
WRITE (KLUN) LEMTC
IF (LEMTC) THEN
  WRITE (KLUN) LBOUND (SELF%EMTC)
  WRITE (KLUN) UBOUND (SELF%EMTC)
  WRITE (KLUN) SELF%EMTC
ENDIF
LTRSC = ALLOCATED (SELF%TRSC)
WRITE (KLUN) LTRSC
IF (LTRSC) THEN
  WRITE (KLUN) LBOUND (SELF%TRSC)
  WRITE (KLUN) UBOUND (SELF%TRSC)
  WRITE (KLUN) SELF%TRSC
ENDIF
LEMTU = ALLOCATED (SELF%EMTU)
WRITE (KLUN) LEMTU
IF (LEMTU) THEN
  WRITE (KLUN) LBOUND (SELF%EMTU)
  WRITE (KLUN) UBOUND (SELF%EMTU)
  WRITE (KLUN) SELF%EMTU
ENDIF
LTAUAER = ALLOCATED (SELF%TAUAER)
WRITE (KLUN) LTAUAER
IF (LTAUAER) THEN
  WRITE (KLUN) LBOUND (SELF%TAUAER)
  WRITE (KLUN) UBOUND (SELF%TAUAER)
  WRITE (KLUN) SELF%TAUAER
ENDIF
LSRSWD = ALLOCATED (SELF%SRSWD)
WRITE (KLUN) LSRSWD
IF (LSRSWD) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWD)
  WRITE (KLUN) UBOUND (SELF%SRSWD)
  WRITE (KLUN) SELF%SRSWD
ENDIF
LSRLWDC = ALLOCATED (SELF%SRLWDC)
WRITE (KLUN) LSRLWDC
IF (LSRLWDC) THEN
  WRITE (KLUN) LBOUND (SELF%SRLWDC)
  WRITE (KLUN) UBOUND (SELF%SRLWDC)
  WRITE (KLUN) SELF%SRLWDC
ENDIF
LSRLWD = ALLOCATED (SELF%SRLWD)
WRITE (KLUN) LSRLWD
IF (LSRLWD) THEN
  WRITE (KLUN) LBOUND (SELF%SRLWD)
  WRITE (KLUN) UBOUND (SELF%SRLWD)
  WRITE (KLUN) SELF%SRLWD
ENDIF
LSRSWDC = ALLOCATED (SELF%SRSWDC)
WRITE (KLUN) LSRSWDC
IF (LSRSWDC) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWDC)
  WRITE (KLUN) UBOUND (SELF%SRSWDC)
  WRITE (KLUN) SELF%SRSWDC
ENDIF
LSRSWDCS = ALLOCATED (SELF%SRSWDCS)
WRITE (KLUN) LSRSWDCS
IF (LSRSWDCS) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWDCS)
  WRITE (KLUN) UBOUND (SELF%SRSWDCS)
  WRITE (KLUN) SELF%SRSWDCS
ENDIF
LSRLWDCS = ALLOCATED (SELF%SRLWDCS)
WRITE (KLUN) LSRLWDCS
IF (LSRLWDCS) THEN
  WRITE (KLUN) LBOUND (SELF%SRLWDCS)
  WRITE (KLUN) UBOUND (SELF%SRLWDCS)
  WRITE (KLUN) SELF%SRLWDCS
ENDIF
LSRSWDV = ALLOCATED (SELF%SRSWDV)
WRITE (KLUN) LSRSWDV
IF (LSRSWDV) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWDV)
  WRITE (KLUN) UBOUND (SELF%SRSWDV)
  WRITE (KLUN) SELF%SRSWDV
ENDIF
LSRSWDUV = ALLOCATED (SELF%SRSWDUV)
WRITE (KLUN) LSRSWDUV
IF (LSRSWDUV) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWDUV)
  WRITE (KLUN) UBOUND (SELF%SRSWDUV)
  WRITE (KLUN) SELF%SRSWDUV
ENDIF
LEDRO = ALLOCATED (SELF%EDRO)
WRITE (KLUN) LEDRO
IF (LEDRO) THEN
  WRITE (KLUN) LBOUND (SELF%EDRO)
  WRITE (KLUN) UBOUND (SELF%EDRO)
  WRITE (KLUN) SELF%EDRO
ENDIF
LSRSWPAR = ALLOCATED (SELF%SRSWPAR)
WRITE (KLUN) LSRSWPAR
IF (LSRSWPAR) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWPAR)
  WRITE (KLUN) UBOUND (SELF%SRSWPAR)
  WRITE (KLUN) SELF%SRSWPAR
ENDIF
LSRSWUVB = ALLOCATED (SELF%SRSWUVB)
WRITE (KLUN) LSRSWUVB
IF (LSRSWUVB) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWUVB)
  WRITE (KLUN) UBOUND (SELF%SRSWUVB)
  WRITE (KLUN) SELF%SRSWUVB
ENDIF
LSRSWPARC = ALLOCATED (SELF%SRSWPARC)
WRITE (KLUN) LSRSWPARC
IF (LSRSWPARC) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWPARC)
  WRITE (KLUN) UBOUND (SELF%SRSWPARC)
  WRITE (KLUN) SELF%SRSWPARC
ENDIF
LSRSWTINC = ALLOCATED (SELF%SRSWTINC)
WRITE (KLUN) LSRSWTINC
IF (LSRSWTINC) THEN
  WRITE (KLUN) LBOUND (SELF%SRSWTINC)
  WRITE (KLUN) UBOUND (SELF%SRSWTINC)
  WRITE (KLUN) SELF%SRSWTINC
ENDIF
LSRFDIR = ALLOCATED (SELF%SRFDIR)
WRITE (KLUN) LSRFDIR
IF (LSRFDIR) THEN
  WRITE (KLUN) LBOUND (SELF%SRFDIR)
  WRITE (KLUN) UBOUND (SELF%SRFDIR)
  WRITE (KLUN) SELF%SRFDIR
ENDIF
LSRCDIR = ALLOCATED (SELF%SRCDIR)
WRITE (KLUN) LSRCDIR
IF (LSRCDIR) THEN
  WRITE (KLUN) LBOUND (SELF%SRCDIR)
  WRITE (KLUN) UBOUND (SELF%SRCDIR)
  WRITE (KLUN) SELF%SRCDIR
ENDIF
LRMOON = ALLOCATED (SELF%RMOON)
WRITE (KLUN) LRMOON
IF (LRMOON) THEN
  WRITE (KLUN) LBOUND (SELF%RMOON)
  WRITE (KLUN) UBOUND (SELF%RMOON)
  WRITE (KLUN) SELF%RMOON
ENDIF
LDERIVATIVELW = ASSOCIATED (SELF%DERIVATIVELW)
WRITE (KLUN) LDERIVATIVELW
IF (LDERIVATIVELW) THEN
  WRITE (KLUN) LBOUND (SELF%DERIVATIVELW)
  WRITE (KLUN) UBOUND (SELF%DERIVATIVELW)
  WRITE (KLUN) SELF%DERIVATIVELW
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TRADF (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TRADF), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL2(2), IU2(2), IL3(3), IU3(3), IL4(4), IU4(4)
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) LEMTD
IF (LEMTD) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%EMTD (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%EMTD,1):UBOUND(SELF%EMTD,1), LBOUND(SELF%EMTD,2):UBOUND(SELF%EMTD,2), LBOUND(SELF%EMTD,3):UBOUND(SELF%EMTD,3)))
  READ (KLUN) ZTMP3
  SELF%EMTD = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LTRSW
IF (LTRSW) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%TRSW (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%TRSW,1):UBOUND(SELF%TRSW,1), LBOUND(SELF%TRSW,2):UBOUND(SELF%TRSW,2), LBOUND(SELF%TRSW,3):UBOUND(SELF%TRSW,3)))
  READ (KLUN) ZTMP3
  SELF%TRSW = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LEMTC
IF (LEMTC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%EMTC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%EMTC,1):UBOUND(SELF%EMTC,1), LBOUND(SELF%EMTC,2):UBOUND(SELF%EMTC,2), LBOUND(SELF%EMTC,3):UBOUND(SELF%EMTC,3)))
  READ (KLUN) ZTMP3
  SELF%EMTC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LTRSC
IF (LTRSC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%TRSC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%TRSC,1):UBOUND(SELF%TRSC,1), LBOUND(SELF%TRSC,2):UBOUND(SELF%TRSC,2), LBOUND(SELF%TRSC,3):UBOUND(SELF%TRSC,3)))
  READ (KLUN) ZTMP3
  SELF%TRSC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LEMTU
IF (LEMTU) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%EMTU (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%EMTU,1):UBOUND(SELF%EMTU,1), LBOUND(SELF%EMTU,2):UBOUND(SELF%EMTU,2), LBOUND(SELF%EMTU,3):UBOUND(SELF%EMTU,3)))
  READ (KLUN) ZTMP3
  SELF%EMTU = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LTAUAER
IF (LTAUAER) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%TAUAER (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%TAUAER,1):UBOUND(SELF%TAUAER,1), LBOUND(SELF%TAUAER,2):UBOUND(SELF%TAUAER,2), LBOUND(SELF%TAUAER,3):UBOUND(SELF%TAUAER,3), LBOUND(SELF%TAUAER,4):UBOUND(SELF%TAUAER,4)))
  READ (KLUN) ZTMP4
  SELF%TAUAER = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LSRSWD
IF (LSRSWD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWD,1):UBOUND(SELF%SRSWD,1), LBOUND(SELF%SRSWD,2):UBOUND(SELF%SRSWD,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRLWDC
IF (LSRLWDC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRLWDC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRLWDC,1):UBOUND(SELF%SRLWDC,1), LBOUND(SELF%SRLWDC,2):UBOUND(SELF%SRLWDC,2)))
  READ (KLUN) ZTMP2
  SELF%SRLWDC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRLWD
IF (LSRLWD) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%SRLWD (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%SRLWD,1):UBOUND(SELF%SRLWD,1), LBOUND(SELF%SRLWD,2):UBOUND(SELF%SRLWD,2), LBOUND(SELF%SRLWD,3):UBOUND(SELF%SRLWD,3)))
  READ (KLUN) ZTMP3
  SELF%SRLWD = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LSRSWDC
IF (LSRSWDC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDC,1):UBOUND(SELF%SRSWDC,1), LBOUND(SELF%SRSWDC,2):UBOUND(SELF%SRSWDC,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWDCS
IF (LSRSWDCS) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDCS (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDCS,1):UBOUND(SELF%SRSWDCS,1), LBOUND(SELF%SRSWDCS,2):UBOUND(SELF%SRSWDCS,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDCS = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRLWDCS
IF (LSRLWDCS) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRLWDCS (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRLWDCS,1):UBOUND(SELF%SRLWDCS,1), LBOUND(SELF%SRLWDCS,2):UBOUND(SELF%SRLWDCS,2)))
  READ (KLUN) ZTMP2
  SELF%SRLWDCS = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWDV
IF (LSRSWDV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDV,1):UBOUND(SELF%SRSWDV,1), LBOUND(SELF%SRSWDV,2):UBOUND(SELF%SRSWDV,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWDUV
IF (LSRSWDUV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWDUV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWDUV,1):UBOUND(SELF%SRSWDUV,1), LBOUND(SELF%SRSWDUV,2):UBOUND(SELF%SRSWDUV,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWDUV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LEDRO
IF (LEDRO) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%EDRO (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%EDRO,1):UBOUND(SELF%EDRO,1), LBOUND(SELF%EDRO,2):UBOUND(SELF%EDRO,2)))
  READ (KLUN) ZTMP2
  SELF%EDRO = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWPAR
IF (LSRSWPAR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWPAR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWPAR,1):UBOUND(SELF%SRSWPAR,1), LBOUND(SELF%SRSWPAR,2):UBOUND(SELF%SRSWPAR,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWPAR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWUVB
IF (LSRSWUVB) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWUVB (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWUVB,1):UBOUND(SELF%SRSWUVB,1), LBOUND(SELF%SRSWUVB,2):UBOUND(SELF%SRSWUVB,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWUVB = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWPARC
IF (LSRSWPARC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWPARC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWPARC,1):UBOUND(SELF%SRSWPARC,1), LBOUND(SELF%SRSWPARC,2):UBOUND(SELF%SRSWPARC,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWPARC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRSWTINC
IF (LSRSWTINC) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRSWTINC (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRSWTINC,1):UBOUND(SELF%SRSWTINC,1), LBOUND(SELF%SRSWTINC,2):UBOUND(SELF%SRSWTINC,2)))
  READ (KLUN) ZTMP2
  SELF%SRSWTINC = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRFDIR
IF (LSRFDIR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRFDIR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRFDIR,1):UBOUND(SELF%SRFDIR,1), LBOUND(SELF%SRFDIR,2):UBOUND(SELF%SRFDIR,2)))
  READ (KLUN) ZTMP2
  SELF%SRFDIR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSRCDIR
IF (LSRCDIR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SRCDIR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SRCDIR,1):UBOUND(SELF%SRCDIR,1), LBOUND(SELF%SRCDIR,2):UBOUND(SELF%SRCDIR,2)))
  READ (KLUN) ZTMP2
  SELF%SRCDIR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRMOON
IF (LRMOON) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RMOON (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RMOON,1):UBOUND(SELF%RMOON,1), LBOUND(SELF%RMOON,2):UBOUND(SELF%RMOON,2)))
  READ (KLUN) ZTMP2
  SELF%RMOON = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LDERIVATIVELW
IF (LDERIVATIVELW) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%DERIVATIVELW (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%DERIVATIVELW,1):UBOUND(SELF%DERIVATIVELW,1), LBOUND(SELF%DERIVATIVELW,2):UBOUND(SELF%DERIVATIVELW,2), LBOUND(SELF%DERIVATIVELW,3):UBOUND(SELF%DERIVATIVELW,3)))
  READ (KLUN) ZTMP3
  SELF%DERIVATIVELW = ZTMP3
  DEALLOCATE (ZTMP3)
ELSE
  NULLIFY (SELF%DERIVATIVELW)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TRADF (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TRADF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LEMTD = ALLOCATED (SELF%EMTD)
IF (LEMTD) THEN
  !$ACC ENTER DATA CREATE (SELF%EMTD)
  !$ACC UPDATE DEVICE (SELF%EMTD)
  !$ACC ENTER DATA ATTACH (SELF%EMTD)
ENDIF

LTRSW = ALLOCATED (SELF%TRSW)
IF (LTRSW) THEN
  !$ACC ENTER DATA CREATE (SELF%TRSW)
  !$ACC UPDATE DEVICE (SELF%TRSW)
  !$ACC ENTER DATA ATTACH (SELF%TRSW)
ENDIF

LEMTC = ALLOCATED (SELF%EMTC)
IF (LEMTC) THEN
  !$ACC ENTER DATA CREATE (SELF%EMTC)
  !$ACC UPDATE DEVICE (SELF%EMTC)
  !$ACC ENTER DATA ATTACH (SELF%EMTC)
ENDIF

LTRSC = ALLOCATED (SELF%TRSC)
IF (LTRSC) THEN
  !$ACC ENTER DATA CREATE (SELF%TRSC)
  !$ACC UPDATE DEVICE (SELF%TRSC)
  !$ACC ENTER DATA ATTACH (SELF%TRSC)
ENDIF

LEMTU = ALLOCATED (SELF%EMTU)
IF (LEMTU) THEN
  !$ACC ENTER DATA CREATE (SELF%EMTU)
  !$ACC UPDATE DEVICE (SELF%EMTU)
  !$ACC ENTER DATA ATTACH (SELF%EMTU)
ENDIF

LTAUAER = ALLOCATED (SELF%TAUAER)
IF (LTAUAER) THEN
  !$ACC ENTER DATA CREATE (SELF%TAUAER)
  !$ACC UPDATE DEVICE (SELF%TAUAER)
  !$ACC ENTER DATA ATTACH (SELF%TAUAER)
ENDIF

LSRSWD = ALLOCATED (SELF%SRSWD)
IF (LSRSWD) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWD)
  !$ACC UPDATE DEVICE (SELF%SRSWD)
  !$ACC ENTER DATA ATTACH (SELF%SRSWD)
ENDIF

LSRLWDC = ALLOCATED (SELF%SRLWDC)
IF (LSRLWDC) THEN
  !$ACC ENTER DATA CREATE (SELF%SRLWDC)
  !$ACC UPDATE DEVICE (SELF%SRLWDC)
  !$ACC ENTER DATA ATTACH (SELF%SRLWDC)
ENDIF

LSRLWD = ALLOCATED (SELF%SRLWD)
IF (LSRLWD) THEN
  !$ACC ENTER DATA CREATE (SELF%SRLWD)
  !$ACC UPDATE DEVICE (SELF%SRLWD)
  !$ACC ENTER DATA ATTACH (SELF%SRLWD)
ENDIF

LSRSWDC = ALLOCATED (SELF%SRSWDC)
IF (LSRSWDC) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWDC)
  !$ACC UPDATE DEVICE (SELF%SRSWDC)
  !$ACC ENTER DATA ATTACH (SELF%SRSWDC)
ENDIF

LSRSWDCS = ALLOCATED (SELF%SRSWDCS)
IF (LSRSWDCS) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWDCS)
  !$ACC UPDATE DEVICE (SELF%SRSWDCS)
  !$ACC ENTER DATA ATTACH (SELF%SRSWDCS)
ENDIF

LSRLWDCS = ALLOCATED (SELF%SRLWDCS)
IF (LSRLWDCS) THEN
  !$ACC ENTER DATA CREATE (SELF%SRLWDCS)
  !$ACC UPDATE DEVICE (SELF%SRLWDCS)
  !$ACC ENTER DATA ATTACH (SELF%SRLWDCS)
ENDIF

LSRSWDV = ALLOCATED (SELF%SRSWDV)
IF (LSRSWDV) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWDV)
  !$ACC UPDATE DEVICE (SELF%SRSWDV)
  !$ACC ENTER DATA ATTACH (SELF%SRSWDV)
ENDIF

LSRSWDUV = ALLOCATED (SELF%SRSWDUV)
IF (LSRSWDUV) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWDUV)
  !$ACC UPDATE DEVICE (SELF%SRSWDUV)
  !$ACC ENTER DATA ATTACH (SELF%SRSWDUV)
ENDIF

LEDRO = ALLOCATED (SELF%EDRO)
IF (LEDRO) THEN
  !$ACC ENTER DATA CREATE (SELF%EDRO)
  !$ACC UPDATE DEVICE (SELF%EDRO)
  !$ACC ENTER DATA ATTACH (SELF%EDRO)
ENDIF

LSRSWPAR = ALLOCATED (SELF%SRSWPAR)
IF (LSRSWPAR) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWPAR)
  !$ACC UPDATE DEVICE (SELF%SRSWPAR)
  !$ACC ENTER DATA ATTACH (SELF%SRSWPAR)
ENDIF

LSRSWUVB = ALLOCATED (SELF%SRSWUVB)
IF (LSRSWUVB) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWUVB)
  !$ACC UPDATE DEVICE (SELF%SRSWUVB)
  !$ACC ENTER DATA ATTACH (SELF%SRSWUVB)
ENDIF

LSRSWPARC = ALLOCATED (SELF%SRSWPARC)
IF (LSRSWPARC) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWPARC)
  !$ACC UPDATE DEVICE (SELF%SRSWPARC)
  !$ACC ENTER DATA ATTACH (SELF%SRSWPARC)
ENDIF

LSRSWTINC = ALLOCATED (SELF%SRSWTINC)
IF (LSRSWTINC) THEN
  !$ACC ENTER DATA CREATE (SELF%SRSWTINC)
  !$ACC UPDATE DEVICE (SELF%SRSWTINC)
  !$ACC ENTER DATA ATTACH (SELF%SRSWTINC)
ENDIF

LSRFDIR = ALLOCATED (SELF%SRFDIR)
IF (LSRFDIR) THEN
  !$ACC ENTER DATA CREATE (SELF%SRFDIR)
  !$ACC UPDATE DEVICE (SELF%SRFDIR)
  !$ACC ENTER DATA ATTACH (SELF%SRFDIR)
ENDIF

LSRCDIR = ALLOCATED (SELF%SRCDIR)
IF (LSRCDIR) THEN
  !$ACC ENTER DATA CREATE (SELF%SRCDIR)
  !$ACC UPDATE DEVICE (SELF%SRCDIR)
  !$ACC ENTER DATA ATTACH (SELF%SRCDIR)
ENDIF

LRMOON = ALLOCATED (SELF%RMOON)
IF (LRMOON) THEN
  !$ACC ENTER DATA CREATE (SELF%RMOON)
  !$ACC UPDATE DEVICE (SELF%RMOON)
  !$ACC ENTER DATA ATTACH (SELF%RMOON)
ENDIF

LDERIVATIVELW = ASSOCIATED (SELF%DERIVATIVELW)
IF (LDERIVATIVELW) THEN
  !$ACC ENTER DATA CREATE (SELF%DERIVATIVELW)
  !$ACC UPDATE DEVICE (SELF%DERIVATIVELW)
  !$ACC ENTER DATA ATTACH (SELF%DERIVATIVELW)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TRADF (SELF)

IMPLICIT NONE
TYPE (TRADF), TARGET :: SELF
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TRADF (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TRADF), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%EMTD), CDPATH//'%EMTD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%TRSW), CDPATH//'%TRSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%EMTC), CDPATH//'%EMTC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%TRSC), CDPATH//'%TRSC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%EMTU), CDPATH//'%EMTU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%TAUAER), CDPATH//'%TAUAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWD), CDPATH//'%SRSWD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRLWDC), CDPATH//'%SRLWDC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRLWD), CDPATH//'%SRLWD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWDC), CDPATH//'%SRSWDC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWDCS), CDPATH//'%SRSWDCS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRLWDCS), CDPATH//'%SRLWDCS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWDV), CDPATH//'%SRSWDV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWDUV), CDPATH//'%SRSWDUV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%EDRO), CDPATH//'%EDRO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWPAR), CDPATH//'%SRSWPAR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWUVB), CDPATH//'%SRSWUVB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWPARC), CDPATH//'%SRSWPARC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRSWTINC), CDPATH//'%SRSWTINC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRFDIR), CDPATH//'%SRFDIR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SRCDIR), CDPATH//'%SRCDIR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RMOON), CDPATH//'%RMOON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%DERIVATIVELW), CDPATH//'%DERIVATIVELW'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TRADF (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TRADF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LEMTD = ALLOCATED (SELF%EMTD)
IF (LEMTD) THEN
  !$ACC EXIT DATA DETACH (SELF%EMTD)
  !$ACC EXIT DATA DELETE (SELF%EMTD)
ENDIF

LTRSW = ALLOCATED (SELF%TRSW)
IF (LTRSW) THEN
  !$ACC EXIT DATA DETACH (SELF%TRSW)
  !$ACC EXIT DATA DELETE (SELF%TRSW)
ENDIF

LEMTC = ALLOCATED (SELF%EMTC)
IF (LEMTC) THEN
  !$ACC EXIT DATA DETACH (SELF%EMTC)
  !$ACC EXIT DATA DELETE (SELF%EMTC)
ENDIF

LTRSC = ALLOCATED (SELF%TRSC)
IF (LTRSC) THEN
  !$ACC EXIT DATA DETACH (SELF%TRSC)
  !$ACC EXIT DATA DELETE (SELF%TRSC)
ENDIF

LEMTU = ALLOCATED (SELF%EMTU)
IF (LEMTU) THEN
  !$ACC EXIT DATA DETACH (SELF%EMTU)
  !$ACC EXIT DATA DELETE (SELF%EMTU)
ENDIF

LTAUAER = ALLOCATED (SELF%TAUAER)
IF (LTAUAER) THEN
  !$ACC EXIT DATA DETACH (SELF%TAUAER)
  !$ACC EXIT DATA DELETE (SELF%TAUAER)
ENDIF

LSRSWD = ALLOCATED (SELF%SRSWD)
IF (LSRSWD) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWD)
  !$ACC EXIT DATA DELETE (SELF%SRSWD)
ENDIF

LSRLWDC = ALLOCATED (SELF%SRLWDC)
IF (LSRLWDC) THEN
  !$ACC EXIT DATA DETACH (SELF%SRLWDC)
  !$ACC EXIT DATA DELETE (SELF%SRLWDC)
ENDIF

LSRLWD = ALLOCATED (SELF%SRLWD)
IF (LSRLWD) THEN
  !$ACC EXIT DATA DETACH (SELF%SRLWD)
  !$ACC EXIT DATA DELETE (SELF%SRLWD)
ENDIF

LSRSWDC = ALLOCATED (SELF%SRSWDC)
IF (LSRSWDC) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWDC)
  !$ACC EXIT DATA DELETE (SELF%SRSWDC)
ENDIF

LSRSWDCS = ALLOCATED (SELF%SRSWDCS)
IF (LSRSWDCS) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWDCS)
  !$ACC EXIT DATA DELETE (SELF%SRSWDCS)
ENDIF

LSRLWDCS = ALLOCATED (SELF%SRLWDCS)
IF (LSRLWDCS) THEN
  !$ACC EXIT DATA DETACH (SELF%SRLWDCS)
  !$ACC EXIT DATA DELETE (SELF%SRLWDCS)
ENDIF

LSRSWDV = ALLOCATED (SELF%SRSWDV)
IF (LSRSWDV) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWDV)
  !$ACC EXIT DATA DELETE (SELF%SRSWDV)
ENDIF

LSRSWDUV = ALLOCATED (SELF%SRSWDUV)
IF (LSRSWDUV) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWDUV)
  !$ACC EXIT DATA DELETE (SELF%SRSWDUV)
ENDIF

LEDRO = ALLOCATED (SELF%EDRO)
IF (LEDRO) THEN
  !$ACC EXIT DATA DETACH (SELF%EDRO)
  !$ACC EXIT DATA DELETE (SELF%EDRO)
ENDIF

LSRSWPAR = ALLOCATED (SELF%SRSWPAR)
IF (LSRSWPAR) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWPAR)
  !$ACC EXIT DATA DELETE (SELF%SRSWPAR)
ENDIF

LSRSWUVB = ALLOCATED (SELF%SRSWUVB)
IF (LSRSWUVB) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWUVB)
  !$ACC EXIT DATA DELETE (SELF%SRSWUVB)
ENDIF

LSRSWPARC = ALLOCATED (SELF%SRSWPARC)
IF (LSRSWPARC) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWPARC)
  !$ACC EXIT DATA DELETE (SELF%SRSWPARC)
ENDIF

LSRSWTINC = ALLOCATED (SELF%SRSWTINC)
IF (LSRSWTINC) THEN
  !$ACC EXIT DATA DETACH (SELF%SRSWTINC)
  !$ACC EXIT DATA DELETE (SELF%SRSWTINC)
ENDIF

LSRFDIR = ALLOCATED (SELF%SRFDIR)
IF (LSRFDIR) THEN
  !$ACC EXIT DATA DETACH (SELF%SRFDIR)
  !$ACC EXIT DATA DELETE (SELF%SRFDIR)
ENDIF

LSRCDIR = ALLOCATED (SELF%SRCDIR)
IF (LSRCDIR) THEN
  !$ACC EXIT DATA DETACH (SELF%SRCDIR)
  !$ACC EXIT DATA DELETE (SELF%SRCDIR)
ENDIF

LRMOON = ALLOCATED (SELF%RMOON)
IF (LRMOON) THEN
  !$ACC EXIT DATA DETACH (SELF%RMOON)
  !$ACC EXIT DATA DELETE (SELF%RMOON)
ENDIF

LDERIVATIVELW = ASSOCIATED (SELF%DERIVATIVELW)
IF (LDERIVATIVELW) THEN
  !$ACC EXIT DATA DETACH (SELF%DERIVATIVELW)
  !$ACC EXIT DATA DELETE (SELF%DERIVATIVELW)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TRADF (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TRADF),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LDERIVATIVELW, LEDRO, LEMTC, LEMTD, LEMTU, LRMOON, LSRCDIR, LSRFDIR, LSRLWD, LSRLWDC
LOGICAL :: LSRLWDCS, LSRSWD, LSRSWDC, LSRSWDCS, LSRSWDUV, LSRSWDV, LSRSWPAR, LSRSWPARC, LSRSWTINC, LSRSWUVB
LOGICAL :: LTAUAER, LTRSC, LTRSW
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LEMTD = ALLOCATED (SELF%EMTD)
IF (LEMTD) THEN
  ISIZE = KIND (SELF%EMTD) * SIZE (SELF%EMTD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%EMTD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTRSW = ALLOCATED (SELF%TRSW)
IF (LTRSW) THEN
  ISIZE = KIND (SELF%TRSW) * SIZE (SELF%TRSW)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TRSW'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LEMTC = ALLOCATED (SELF%EMTC)
IF (LEMTC) THEN
  ISIZE = KIND (SELF%EMTC) * SIZE (SELF%EMTC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%EMTC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTRSC = ALLOCATED (SELF%TRSC)
IF (LTRSC) THEN
  ISIZE = KIND (SELF%TRSC) * SIZE (SELF%TRSC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TRSC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LEMTU = ALLOCATED (SELF%EMTU)
IF (LEMTU) THEN
  ISIZE = KIND (SELF%EMTU) * SIZE (SELF%EMTU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%EMTU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTAUAER = ALLOCATED (SELF%TAUAER)
IF (LTAUAER) THEN
  ISIZE = KIND (SELF%TAUAER) * SIZE (SELF%TAUAER)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TAUAER'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWD = ALLOCATED (SELF%SRSWD)
IF (LSRSWD) THEN
  ISIZE = KIND (SELF%SRSWD) * SIZE (SELF%SRSWD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRLWDC = ALLOCATED (SELF%SRLWDC)
IF (LSRLWDC) THEN
  ISIZE = KIND (SELF%SRLWDC) * SIZE (SELF%SRLWDC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRLWDC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRLWD = ALLOCATED (SELF%SRLWD)
IF (LSRLWD) THEN
  ISIZE = KIND (SELF%SRLWD) * SIZE (SELF%SRLWD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRLWD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWDC = ALLOCATED (SELF%SRSWDC)
IF (LSRSWDC) THEN
  ISIZE = KIND (SELF%SRSWDC) * SIZE (SELF%SRSWDC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWDC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWDCS = ALLOCATED (SELF%SRSWDCS)
IF (LSRSWDCS) THEN
  ISIZE = KIND (SELF%SRSWDCS) * SIZE (SELF%SRSWDCS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWDCS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRLWDCS = ALLOCATED (SELF%SRLWDCS)
IF (LSRLWDCS) THEN
  ISIZE = KIND (SELF%SRLWDCS) * SIZE (SELF%SRLWDCS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRLWDCS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWDV = ALLOCATED (SELF%SRSWDV)
IF (LSRSWDV) THEN
  ISIZE = KIND (SELF%SRSWDV) * SIZE (SELF%SRSWDV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWDV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWDUV = ALLOCATED (SELF%SRSWDUV)
IF (LSRSWDUV) THEN
  ISIZE = KIND (SELF%SRSWDUV) * SIZE (SELF%SRSWDUV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWDUV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LEDRO = ALLOCATED (SELF%EDRO)
IF (LEDRO) THEN
  ISIZE = KIND (SELF%EDRO) * SIZE (SELF%EDRO)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%EDRO'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWPAR = ALLOCATED (SELF%SRSWPAR)
IF (LSRSWPAR) THEN
  ISIZE = KIND (SELF%SRSWPAR) * SIZE (SELF%SRSWPAR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWPAR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWUVB = ALLOCATED (SELF%SRSWUVB)
IF (LSRSWUVB) THEN
  ISIZE = KIND (SELF%SRSWUVB) * SIZE (SELF%SRSWUVB)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWUVB'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWPARC = ALLOCATED (SELF%SRSWPARC)
IF (LSRSWPARC) THEN
  ISIZE = KIND (SELF%SRSWPARC) * SIZE (SELF%SRSWPARC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWPARC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRSWTINC = ALLOCATED (SELF%SRSWTINC)
IF (LSRSWTINC) THEN
  ISIZE = KIND (SELF%SRSWTINC) * SIZE (SELF%SRSWTINC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRSWTINC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRFDIR = ALLOCATED (SELF%SRFDIR)
IF (LSRFDIR) THEN
  ISIZE = KIND (SELF%SRFDIR) * SIZE (SELF%SRFDIR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRFDIR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSRCDIR = ALLOCATED (SELF%SRCDIR)
IF (LSRCDIR) THEN
  ISIZE = KIND (SELF%SRCDIR) * SIZE (SELF%SRCDIR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SRCDIR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRMOON = ALLOCATED (SELF%RMOON)
IF (LRMOON) THEN
  ISIZE = KIND (SELF%RMOON) * SIZE (SELF%RMOON)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RMOON'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LDERIVATIVELW = ASSOCIATED (SELF%DERIVATIVELW)
IF (LDERIVATIVELW) THEN
  ISIZE = KIND (SELF%DERIVATIVELW) * SIZE (SELF%DERIVATIVELW)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%DERIVATIVELW'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
