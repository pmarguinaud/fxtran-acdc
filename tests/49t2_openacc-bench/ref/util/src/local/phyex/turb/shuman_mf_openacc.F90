
MODULE MODI_SHUMAN_MF_OPENACC


IMPLICIT NONE



INTERFACE
  SUBROUTINE DZF_MF_OPENACC (D, PA, PDZF, YDSTACK)
  !$ACC ROUTINE (DZF_MF_OPENACC) SEQ
  USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
  USE FXTRAN_ACDC_STACK_MOD
  USE FXTRAN_ACDC_ABORT_MOD
  
  IMPLICIT NONE
  
  TYPE (DIMPHYEX_T), INTENT (IN)::D
  REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
  REAL, INTENT (OUT)::PDZF(D%NIJT, D%NKT)
  TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
  
  END SUBROUTINE DZF_MF_OPENACC
  
  SUBROUTINE DZM_MF_OPENACC (D, PA, PDZM, YDSTACK)
  !$ACC ROUTINE (DZM_MF_OPENACC) SEQ
  USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
  USE FXTRAN_ACDC_STACK_MOD
  USE FXTRAN_ACDC_ABORT_MOD
  
  IMPLICIT NONE
  
  TYPE (DIMPHYEX_T), INTENT (IN)::D
  REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
  REAL, INTENT (OUT)::PDZM(D%NIJT, D%NKT)
  TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
  
  END SUBROUTINE DZM_MF_OPENACC
  
  SUBROUTINE MZF_MF_OPENACC (D, PA, PMZF, YDSTACK)
  !$ACC ROUTINE (MZF_MF_OPENACC) SEQ
  USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
  USE FXTRAN_ACDC_STACK_MOD
  USE FXTRAN_ACDC_ABORT_MOD
  
  IMPLICIT NONE
  
  TYPE (DIMPHYEX_T), INTENT (IN)::D
  REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
  REAL, INTENT (OUT)::PMZF(D%NIJT, D%NKT)
  TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
  
  END SUBROUTINE MZF_MF_OPENACC
  
  SUBROUTINE MZM_MF_OPENACC (D, PA, PMZM, YDSTACK)
  !$ACC ROUTINE (MZM_MF_OPENACC) SEQ
  USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
  USE FXTRAN_ACDC_STACK_MOD
  USE FXTRAN_ACDC_ABORT_MOD
  
  IMPLICIT NONE
  
  TYPE (DIMPHYEX_T), INTENT (IN)::D
  REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
  REAL, INTENT (OUT)::PMZM(D%NIJT, D%NKT)
  TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
  
  END SUBROUTINE MZM_MF_OPENACC
  
  SUBROUTINE GZ_M_W_MF_OPENACC (D, PY, PDZZ, PGZ_M_W, YDSTACK)
  !$ACC ROUTINE (GZ_M_W_MF_OPENACC) SEQ
  USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
  USE FXTRAN_ACDC_STACK_MOD
  USE FXTRAN_ACDC_ABORT_MOD
  
  IMPLICIT NONE
  
  TYPE (DIMPHYEX_T), INTENT (IN)::D
  REAL, INTENT (IN)::PDZZ(D%NIJT, D%NKT)
  REAL, INTENT (IN)::PY(D%NIJT, D%NKT)
  REAL, INTENT (OUT)::PGZ_M_W(D%NIJT, D%NKT)
  TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
  
  END SUBROUTINE GZ_M_W_MF_OPENACC
  
ENDINTERFACE

ENDMODULE MODI_SHUMAN_MF_OPENACC

SUBROUTINE MZF_MF_OPENACC (D, PA, PMZF, YDSTACK)
!$ACC ROUTINE (MZF_MF_OPENACC) SEQ
USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE

TYPE (DIMPHYEX_T), INTENT (IN)::D
REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
REAL, INTENT (OUT)::PMZF(D%NIJT, D%NKT)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER::JI
INTEGER::JK
INTEGER::IIJE
INTEGER::IIJB
INTEGER::IKT
INTEGER::IKU
INTEGER::IKA
INTEGER::IKL

JI = D%NIB


IIJE=D%NIJE
IIJB=D%NIJB
IKA=D%NKA
IKU=D%NKU
IKT=D%NKT
IKL=D%NKL

DO JK=2, IKT-1
  
  PMZF (JI, JK)=0.5*(PA (JI, JK)+PA (JI, JK+IKL))
  
ENDDO


PMZF (JI, IKA)=0.5*(PA (JI, IKA)+PA (JI, IKA+IKL))
PMZF (JI, IKU)=PA (JI, IKU)

END SUBROUTINE MZF_MF_OPENACC

SUBROUTINE MZM_MF_OPENACC (D, PA, PMZM, YDSTACK)
!$ACC ROUTINE (MZM_MF_OPENACC) SEQ
USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE

TYPE (DIMPHYEX_T), INTENT (IN)::D
REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
REAL, INTENT (OUT)::PMZM(D%NIJT, D%NKT)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER::JI
INTEGER::JK
INTEGER::IIJE
INTEGER::IIJB
INTEGER::IKL
INTEGER::IKT
INTEGER::IKU
INTEGER::IKA

JI = D%NIB


IIJE=D%NIJE
IIJB=D%NIJB
IKA=D%NKA
IKU=D%NKU
IKT=D%NKT
IKL=D%NKL

DO JK=2, IKT-1
  
  PMZM (JI, JK)=0.5*(PA (JI, JK)+PA (JI, JK-IKL))
  
ENDDO


PMZM (JI, IKA)=PA (JI, IKA)
PMZM (JI, IKU)=0.5*(PA (JI, IKU)+PA (JI, IKU-IKL))

END SUBROUTINE MZM_MF_OPENACC

SUBROUTINE DZF_MF_OPENACC (D, PA, PDZF, YDSTACK)
!$ACC ROUTINE (DZF_MF_OPENACC) SEQ
USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE

TYPE (DIMPHYEX_T), INTENT (IN)::D
REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
REAL, INTENT (OUT)::PDZF(D%NIJT, D%NKT)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER::JI
INTEGER::JK
INTEGER::IIJE
INTEGER::IIJB
INTEGER::IKL
INTEGER::IKT
INTEGER::IKU
INTEGER::IKA

JI = D%NIB


IIJE=D%NIJE
IIJB=D%NIJB
IKA=D%NKA
IKU=D%NKU
IKT=D%NKT
IKL=D%NKL

DO JK=2, IKT-1
  
  PDZF (JI, JK)=PA (JI, JK+IKL)-PA (JI, JK)
  
ENDDO


PDZF (JI, IKA)=PA (JI, IKA+IKL)-PA (JI, IKA)
PDZF (JI, IKU)=0.

END SUBROUTINE DZF_MF_OPENACC

SUBROUTINE DZM_MF_OPENACC (D, PA, PDZM, YDSTACK)
!$ACC ROUTINE (DZM_MF_OPENACC) SEQ
USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE

TYPE (DIMPHYEX_T), INTENT (IN)::D
REAL, INTENT (IN)::PA(D%NIJT, D%NKT)
REAL, INTENT (OUT)::PDZM(D%NIJT, D%NKT)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER::JI
INTEGER::JK
INTEGER::IIJE
INTEGER::IIJB
INTEGER::IKL
INTEGER::IKT
INTEGER::IKU
INTEGER::IKA

JI = D%NIB


IIJE=D%NIJE
IIJB=D%NIJB
IKA=D%NKA
IKU=D%NKU
IKT=D%NKT
IKL=D%NKL

DO JK=2, IKT-1
  
  PDZM (JI, JK)=PA (JI, JK)-PA (JI, JK-IKL)
  
ENDDO


PDZM (JI, IKA)=0.
PDZM (JI, IKU)=PA (JI, IKU)-PA (JI, IKU-IKL)

END SUBROUTINE DZM_MF_OPENACC

SUBROUTINE GZ_M_W_MF_OPENACC (D, PY, PDZZ, PGZ_M_W, YDSTACK)
!$ACC ROUTINE (GZ_M_W_MF_OPENACC) SEQ
USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE

TYPE (DIMPHYEX_T), INTENT (IN)::D
REAL, INTENT (IN)::PDZZ(D%NIJT, D%NKT)
REAL, INTENT (IN)::PY(D%NIJT, D%NKT)
REAL, INTENT (OUT)::PGZ_M_W(D%NIJT, D%NKT)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER JI
INTEGER JK
INTEGER::IIJE
INTEGER::IIJB
INTEGER::IKL
INTEGER::IKT
INTEGER::IKU
INTEGER::IKA

JI = D%NIB


IIJE=D%NIJE
IIJB=D%NIJB
IKA=D%NKA
IKU=D%NKU
IKT=D%NKT
IKL=D%NKL

DO JK=2, IKT-1
  
  PGZ_M_W (JI, JK)=(PY (JI, JK)-PY (JI, JK-IKL))/PDZZ (JI, JK)
  
ENDDO


PGZ_M_W (JI, IKA)=0.
PGZ_M_W (JI, IKU)=(PY (JI, IKU)-PY (JI, IKU-IKL))/PDZZ (JI, IKU)

END SUBROUTINE GZ_M_W_MF_OPENACC
