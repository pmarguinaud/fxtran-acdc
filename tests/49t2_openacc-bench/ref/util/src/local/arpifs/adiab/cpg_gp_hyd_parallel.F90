SUBROUTINE CPG_GP_HYD_PARALLEL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDVARS, YDCPG_DYN0, YDCPG_DYN9,&
& YDMODEL, YD_P_OROGLL_T0, YD_P_OROGMM_T0, YD_P_OROGLM_T0, YD_P_GDW_T0, YD_P_GWHT_T0, YDCPG_TND)
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_TND_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE TYPE_MODEL,ONLY:MODEL

USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE YOMGWDIAG,ONLY:LGWDIAGS_ON, UPDATE_GWDIAG
USE INTDYN_MOD,ONLY:TPG_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (CPG_DYN_TYPE), INTENT (INOUT)::YDCPG_DYN0
TYPE (CPG_DYN_TYPE), INTENT (INOUT)::YDCPG_DYN9
TYPE (MODEL), INTENT (IN)::YDMODEL
CLASS (FIELD_2RB), POINTER :: YD_P_OROGLL_T0
REAL (KIND=JPRB), POINTER::P_OROGLL_T0 (:,:)
CLASS (FIELD_2RB), POINTER :: YD_P_OROGMM_T0
REAL (KIND=JPRB), POINTER::P_OROGMM_T0 (:,:)
CLASS (FIELD_2RB), POINTER :: YD_P_OROGLM_T0
REAL (KIND=JPRB), POINTER::P_OROGLM_T0 (:,:)
CLASS (FIELD_3RB), POINTER :: YD_P_GDW_T0
REAL (KIND=JPRB), POINTER::P_GDW_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_P_GWHT_T0
REAL (KIND=JPRB), POINTER::P_GWHT_T0 (:,:,:)
TYPE (CPG_TND_TYPE), INTENT (INOUT)::YDCPG_TND
#include "gphpre_expl.intfb.h"
#include "abor1.intfb.h"
#include "gphpre_expl_openacc.intfb.h"
#include "gpgrxyb_expl.intfb.h"
#include "gpgrxyb_expl_openacc.intfb.h"
#include "gprcp_expl_parallel.intfb.h"
#include "gprt.intfb.h"
#include "gprt_openacc.intfb.h"
#include "gpcty_expl.intfb.h"
#include "gpcty_expl_openacc.intfb.h"
#include "gpgeo_expl.intfb.h"
#include "gpgeo_expl_openacc.intfb.h"
#include "gpgrgeo_expl.intfb.h"
#include "gpgrgeo_expl_openacc.intfb.h"
#include "gphlwi.intfb.h"
#include "gphlwi_openacc.intfb.h"
#include "gphluv_expl.intfb.h"
#include "gphluv_expl_openacc.intfb.h"
#include "gpuvs.intfb.h"
#include "gpuvs_openacc.intfb.h"
#include "gpgrp_expl.intfb.h"
#include "gpgrp_expl_openacc.intfb.h"
#include "gpxx.intfb.h"
#include "gpxx_openacc.intfb.h"
#include "gpgw.intfb.h"
#include "gpgw_openacc.intfb.h"
#include "gp_tndlagadiab_uv.intfb.h"
#include "gp_tndlagadiab_uv_openacc.intfb.h"
CLASS (FIELD_3RB), POINTER :: YL_Z_DPHYCTY_T0
REAL (KIND=JPRB), POINTER::Z_DPHYCTY_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_DVER_T0
REAL (KIND=JPRB), POINTER::Z_DVER_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_GPHL_T0
REAL (KIND=JPRB), POINTER::Z_GPHL_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_GPHM_T0
REAL (KIND=JPRB), POINTER::Z_GPHM_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_NHXT_T0
REAL (KIND=JPRB), POINTER::Z_NHXT_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_PSGRTL_T0
REAL (KIND=JPRB), POINTER::Z_PSGRTL_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_PSGRTM_T0
REAL (KIND=JPRB), POINTER::Z_PSGRTM_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_RDT_T0
REAL (KIND=JPRB), POINTER::Z_RDT_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_RPREF_T0
REAL (KIND=JPRB), POINTER::Z_RPREF_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_RT_T0
REAL (KIND=JPRB), POINTER::Z_RT_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_SGRTL_T0
REAL (KIND=JPRB), POINTER::Z_SGRTL_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_SGRTM_T0
REAL (KIND=JPRB), POINTER::Z_SGRTM_T0 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_Z_US_T0
REAL (KIND=JPRB), POINTER::Z_US_T0 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_Z_VS_T0
REAL (KIND=JPRB), POINTER::Z_VS_T0 (:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_ALPHL_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_ALPHL_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_ALPHM_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_ALPHM_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_ALPHPLL_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_ALPHPLL_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_ALPHPLM_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_ALPHPLM_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_COEFAPL_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_COEFAPL_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_COEFA_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_COEFA_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_COEFD_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_COEFD_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_LNPRL_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_LNPRL_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_XYBDER_LNPRM_T0
REAL (KIND=JPRB), POINTER::Z_XYBDER_LNPRM_T0 (:,:,:)
LOGICAL::LLUVH
LOGICAL::LLGPXX
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
LOGICAL, PARAMETER::LLDER=.FALSE.
LOGICAL, PARAMETER::LLGWF0=.TRUE.
LOGICAL, PARAMETER::LLGDWI=.FALSE.
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_DIVDP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_EVEL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_PSDIV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_PSDVBC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_VVEL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_GWFT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_KENE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_NHX(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_OROGL(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_OROGM(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PHI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PHIFL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PHIFM(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PREL(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PREM(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_RCP_KAP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_RCP_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_RTL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_RTM(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_UVH_UH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_UVH_VH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_UVH_WWI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_ALPH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_LNPR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_RPP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_RPRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_RTGR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDU_NOC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_TND_TNDV_NOC(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_DIV_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_EDOT_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDL_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROG_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RCORI_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_PHYCTY_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_RSPEC_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_RSPEC_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SGRTL_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SGRTL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SGRTM_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SGRTM_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:,:,:)
IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_Z_XYBDER_LNPRM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_LNPRL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_COEFD_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_COEFA_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_COEFAPL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_ALPHPLM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_ALPHPLL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_ALPHM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_XYBDER_ALPHL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
&%NFLEVG, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_VS_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_US_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_SGRTM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_SGRTL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_RT_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_RPREF_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_RDT_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_PSGRTM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_PSGRTL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_NHXT_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_GPHM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_GPHL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_DVER_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_DPHYCTY_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)







IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE.AND..NOT.YDGEOMETRY%YRVERT_GEOM%YRCVER&
  &%LVFE_ECMWF.OR..NOT.((YDMODEL%YRML_PHY_MF%YRPHY%LMPHYS.OR.YDMODEL%YRML_PHY_MF&
  &%YRSIMPHL%LSIMPH).AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0)) THEN
  LLGPXX=.FALSE.
ELSE
  LLGPXX=.TRUE.
ENDIF

LLUVH=LLGPXX.OR.YDMODEL%YRML_DYN%YRDYNA%LSLHD
IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_HYD_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
  Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
  Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
  Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
  Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
  Z_XYBDER_COEFAPL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFAPL_T0)
  Z_XYBDER_COEFA_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFA_T0)
  Z_XYBDER_COEFD_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFD_T0)
  Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
  Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHX)
  Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
  Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
  Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    Z_YDCPG_DYN0_NHX (:,:, JBLK)=0.0_JPRB
    Z_YDCPG_DYN0_GWFT (:,:, JBLK)=0.0_JPRB
    CALL GPHPRE_EXPL (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDCPG_OPTS%TOPPRES, YDMODEL%YRCST, YDGEOMETRY&
    &%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRVERT_GEOM&
    &%YRVAB, Z_YDCPG_DYN0_PRE(:,:, JBLK), PRESF=Z_YDCPG_DYN0_PREF(:,:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP&
    &(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK&
    &), PALPH=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE&
    &(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP(:,:, JBLK))

    IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_RPREF_T0 (JROF, JLEV, JBLK)=1.0_JPRB/Z_YDCPG_DYN0_PREF (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF


    IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
      CALL GPGRXYB_EXPL (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG,.FALSE., YDGEOMETRY%YRVERT_GEOM%YRVAB, Z_YDCPG_DYN0_PREL(:, JBLK), Z_YDCPG_DYN0_PREM&
      &(:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP&
      &(:,:, JBLK), PALPH=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE&
      &(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP(:,:, JBLK), PCOEFD_DER=Z_XYBDER_COEFD_T0(:,:, JBLK), PLNPRL_DER&
      &=Z_XYBDER_LNPRL_T0(:,:, JBLK), PLNPRM_DER=Z_XYBDER_LNPRM_T0(:,:, JBLK), PCOEFA_DER=Z_XYBDER_COEFA_T0&
      &(:,:, JBLK), PCOEFAPL_DER=Z_XYBDER_COEFAPL_T0(:,:, JBLK), PALPHPLL_DER=Z_XYBDER_ALPHPLL_T0(:,:, JBLK&
      &), PALPHPLM_DER=Z_XYBDER_ALPHPLM_T0(:,:, JBLK), PALPHL_DER=Z_XYBDER_ALPHL_T0(:,:, JBLK), PALPHM_DER=Z_XYBDER_ALPHM_T0&
      &(:,:, JBLK))
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
    Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
    Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
    Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
    Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
    Z_XYBDER_COEFAPL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFAPL_T0)
    Z_XYBDER_COEFA_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFA_T0)
    Z_XYBDER_COEFD_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFD_T0)
    Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
    Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHX)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
    Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_RPREF_T0 => NULL ()
  Z_XYBDER_ALPHL_T0 => NULL ()
  Z_XYBDER_ALPHM_T0 => NULL ()
  Z_XYBDER_ALPHPLL_T0 => NULL ()
  Z_XYBDER_ALPHPLM_T0 => NULL ()
  Z_XYBDER_COEFAPL_T0 => NULL ()
  Z_XYBDER_COEFA_T0 => NULL ()
  Z_XYBDER_COEFD_T0 => NULL ()
  Z_XYBDER_LNPRL_T0 => NULL ()
  Z_XYBDER_LNPRM_T0 => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_NHX => NULL ()
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN0_XYB_RPP => NULL ()
  Z_YDCPG_DYN0_XYB_RPRE => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_HYD_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
  Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
  Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
  Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
  Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
  Z_XYBDER_COEFAPL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFAPL_T0)
  Z_XYBDER_COEFA_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFA_T0)
  Z_XYBDER_COEFD_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFD_T0)
  Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
  Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHX)
  Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
  Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
  Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      Z_YDCPG_DYN0_NHX (JROF,:, JBLK)=0.0_JPRB
      Z_YDCPG_DYN0_GWFT (JROF,:, JBLK)=0.0_JPRB
      CALL GPHPRE_EXPL_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDCPG_OPTS%TOPPRES, YDMODEL%YRCST, YDGEOMETRY&
      &%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRVERT_GEOM&
      &%YRVAB, Z_YDCPG_DYN0_PRE(:,:, JBLK), PRESF=Z_YDCPG_DYN0_PREF(:,:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP&
      &(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK), PALPH&
      &=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE&
      &(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_RPREF_T0 (JROF, JLEV, JBLK)=1.0_JPRB/Z_YDCPG_DYN0_PREF (JROF, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
        CALL GPGRXYB_EXPL_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG,.FALSE., YDGEOMETRY%YRVERT_GEOM%YRVAB, Z_YDCPG_DYN0_PREL&
        &(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR&
        &(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK), PALPH=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK&
        &), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP&
        &(:,:, JBLK), PCOEFD_DER=Z_XYBDER_COEFD_T0(:,:, JBLK), PLNPRL_DER=Z_XYBDER_LNPRL_T0(:,:, JBLK&
        &), PLNPRM_DER=Z_XYBDER_LNPRM_T0(:,:, JBLK), PCOEFA_DER=Z_XYBDER_COEFA_T0(:,:, JBLK), PCOEFAPL_DER&
        &=Z_XYBDER_COEFAPL_T0(:,:, JBLK), PALPHPLL_DER=Z_XYBDER_ALPHPLL_T0(:,:, JBLK), PALPHPLM_DER=Z_XYBDER_ALPHPLM_T0&
        &(:,:, JBLK), PALPHL_DER=Z_XYBDER_ALPHL_T0(:,:, JBLK), PALPHM_DER=Z_XYBDER_ALPHM_T0(:,:, JBLK&
        &),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
    Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
    Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
    Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
    Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
    Z_XYBDER_COEFAPL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFAPL_T0)
    Z_XYBDER_COEFA_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFA_T0)
    Z_XYBDER_COEFD_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFD_T0)
    Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
    Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHX)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
    Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_RPREF_T0 => NULL ()
  Z_XYBDER_ALPHL_T0 => NULL ()
  Z_XYBDER_ALPHM_T0 => NULL ()
  Z_XYBDER_ALPHPLL_T0 => NULL ()
  Z_XYBDER_ALPHPLM_T0 => NULL ()
  Z_XYBDER_COEFAPL_T0 => NULL ()
  Z_XYBDER_COEFA_T0 => NULL ()
  Z_XYBDER_COEFD_T0 => NULL ()
  Z_XYBDER_LNPRL_T0 => NULL ()
  Z_XYBDER_LNPRM_T0 => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_NHX => NULL ()
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN0_XYB_RPP => NULL ()
  Z_YDCPG_DYN0_XYB_RPRE => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_HYD_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_RPREF_T0 => GET_DEVICE_DATA_RDWR (YL_Z_RPREF_T0)
  Z_XYBDER_ALPHL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
  Z_XYBDER_ALPHM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
  Z_XYBDER_ALPHPLL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
  Z_XYBDER_ALPHPLM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
  Z_XYBDER_COEFAPL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_COEFAPL_T0)
  Z_XYBDER_COEFA_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_COEFA_T0)
  Z_XYBDER_COEFD_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_COEFD_T0)
  Z_XYBDER_LNPRL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
  Z_XYBDER_LNPRM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
  Z_YDCPG_DYN0_GWFT => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_NHX => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_NHX)
  Z_YDCPG_DYN0_PRE => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREF => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PREF)
  Z_YDCPG_DYN0_PREL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_XYB_ALPH => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN0_XYB_RPP => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
  Z_YDCPG_DYN0_XYB_RPRE => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
  Z_YDCPG_DYN0_XYB_RTGR => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, Z_RPREF_T0, &
    !$ACC&         Z_XYBDER_ALPHL_T0, Z_XYBDER_ALPHM_T0, Z_XYBDER_ALPHPLL_T0, &
    !$ACC&         Z_XYBDER_ALPHPLM_T0, Z_XYBDER_COEFAPL_T0, Z_XYBDER_COEFA_T0, &
    !$ACC&         Z_XYBDER_COEFD_T0, Z_XYBDER_LNPRL_T0, Z_XYBDER_LNPRM_T0, &
    !$ACC&         Z_YDCPG_DYN0_GWFT, Z_YDCPG_DYN0_NHX, Z_YDCPG_DYN0_PRE, Z_YDCPG_DYN0_PREF, &
    !$ACC&         Z_YDCPG_DYN0_PREL, Z_YDCPG_DYN0_PREM, Z_YDCPG_DYN0_XYB_ALPH, &
    !$ACC&         Z_YDCPG_DYN0_XYB_DELP, Z_YDCPG_DYN0_XYB_LNPR, Z_YDCPG_DYN0_XYB_RDELP, &
    !$ACC&         Z_YDCPG_DYN0_XYB_RPP, Z_YDCPG_DYN0_XYB_RPRE, Z_YDCPG_DYN0_XYB_RTGR) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      Z_YDCPG_DYN0_NHX (JROF,:, JBLK)=0.0_JPRB
      Z_YDCPG_DYN0_GWFT (JROF,:, JBLK)=0.0_JPRB
      CALL GPHPRE_EXPL_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDCPG_OPTS%TOPPRES, YDMODEL%YRCST, YDGEOMETRY&
      &%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRVERT_GEOM&
      &%YRVAB, Z_YDCPG_DYN0_PRE(:,:, JBLK), PRESF=Z_YDCPG_DYN0_PREF(:,:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP&
      &(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK), PALPH&
      &=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE&
      &(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_RPREF_T0 (JROF, JLEV, JBLK)=1.0_JPRB/Z_YDCPG_DYN0_PREF (JROF, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
        CALL GPGRXYB_EXPL_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG,.FALSE., YDGEOMETRY%YRVERT_GEOM%YRVAB, Z_YDCPG_DYN0_PREL&
        &(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR&
        &(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK), PALPH=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK&
        &), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP&
        &(:,:, JBLK), PCOEFD_DER=Z_XYBDER_COEFD_T0(:,:, JBLK), PLNPRL_DER=Z_XYBDER_LNPRL_T0(:,:, JBLK&
        &), PLNPRM_DER=Z_XYBDER_LNPRM_T0(:,:, JBLK), PCOEFA_DER=Z_XYBDER_COEFA_T0(:,:, JBLK), PCOEFAPL_DER&
        &=Z_XYBDER_COEFAPL_T0(:,:, JBLK), PALPHPLL_DER=Z_XYBDER_ALPHPLL_T0(:,:, JBLK), PALPHPLM_DER=Z_XYBDER_ALPHPLM_T0&
        &(:,:, JBLK), PALPHL_DER=Z_XYBDER_ALPHL_T0(:,:, JBLK), PALPHM_DER=Z_XYBDER_ALPHM_T0(:,:, JBLK&
        &),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
    Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
    Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
    Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
    Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
    Z_XYBDER_COEFAPL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFAPL_T0)
    Z_XYBDER_COEFA_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFA_T0)
    Z_XYBDER_COEFD_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_COEFD_T0)
    Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
    Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHX)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
    Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_RPREF_T0 => NULL ()
  Z_XYBDER_ALPHL_T0 => NULL ()
  Z_XYBDER_ALPHM_T0 => NULL ()
  Z_XYBDER_ALPHPLL_T0 => NULL ()
  Z_XYBDER_ALPHPLM_T0 => NULL ()
  Z_XYBDER_COEFAPL_T0 => NULL ()
  Z_XYBDER_COEFA_T0 => NULL ()
  Z_XYBDER_COEFD_T0 => NULL ()
  Z_XYBDER_LNPRL_T0 => NULL ()
  Z_XYBDER_LNPRM_T0 => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_NHX => NULL ()
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN0_XYB_RPP => NULL ()
  Z_YDCPG_DYN0_XYB_RPRE => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_HYD_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)
CALL GPRCP_EXPL_PARALLEL (YDMODEL%YRCST, YDCPG_BNDS, YDCPG_OPTS, YDVARS=YDVARS, YD_PCP&
&=YDCPG_DYN0%RCP%F_CP, YD_PR=YDCPG_DYN0%RCP%F_R, YD_PKAP=YDCPG_DYN0%RCP%F_KAP)
IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_HYD_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_DPHYCTY_T0 => GET_HOST_DATA_RDWR (YL_Z_DPHYCTY_T0)
  Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
  Z_RPREF_T0 => GET_HOST_DATA_RDONLY (YL_Z_RPREF_T0)
  Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
  Z_YDCPG_DYN0_CTY_DIVDP => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_DIVDP)
  Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_DYN0_CTY_PSDIV => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDIV)
  Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDONLY (YDCPG_DYN0%RCP%F_R)
  Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
  Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RPP)
  Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RPRE)
  Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RTGR)
  Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDONLY (YDVARS%DIV%FT0)
  Z_YDVARS_EDOT_T0 => GET_HOST_DATA_RDONLY (YDVARS%EDOT%FT0)
  Z_YDVARS_PHYCTY_T0 => GET_HOST_DATA_RDONLY (YDVARS%PHYCTY%FT0)
  Z_YDVARS_Q_DL => GET_HOST_DATA_RDONLY (YDVARS%Q%FDL)
  Z_YDVARS_Q_DM => GET_HOST_DATA_RDONLY (YDVARS%Q%FDM)
  Z_YDVARS_RSPEC_DL => GET_HOST_DATA_RDONLY (YDVARS%RSPEC%FDL)
  Z_YDVARS_RSPEC_DM => GET_HOST_DATA_RDONLY (YDVARS%RSPEC%FDM)
  Z_YDVARS_T_DL => GET_HOST_DATA_RDONLY (YDVARS%T%FDL)
  Z_YDVARS_T_DM => GET_HOST_DATA_RDONLY (YDVARS%T%FDM)
  Z_YDVARS_T_T0 => GET_HOST_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF (YDMODEL%YRML_GCONF%YGFL%YRSPEC%LGP) THEN
      CALL GPRT (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV, Z_YDCPG_DYN0_RCP_R(:,:, JBLK), Z_YDVARS_T_T0&
      &(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK), Z_YDVARS_Q_DL(:,:, JBLK), Z_YDVARS_Q_DM&
      &(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK), PRL=Z_YDVARS_RSPEC_DL&
      &(:,:, JBLK), PRM=Z_YDVARS_RSPEC_DM(:,:, JBLK))
    ELSEIF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
      CALL GPRT (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV,&
      & Z_YDCPG_DYN0_RCP_R(:,:, JBLK), Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK&
      &), Z_YDVARS_T_DM(:,:, JBLK), Z_YDVARS_Q_DL(:,:, JBLK), Z_YDVARS_Q_DM(:,:, JBLK), Z_RT_T0&
      &(:,:, JBLK), Z_YDCPG_DYN0_RTL(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK))
    ENDIF


    IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_RDT_T0 (JROF, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDVARS_T_T0 (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

    ELSE
      Z_RDT_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_RT_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
    ENDIF


    IF (YDMODEL%YRML_GCONF%YGFL%YPHYCTY%LACTIVE) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_DPHYCTY_T0 (JROF, JLEV, JBLK)=Z_YDVARS_PHYCTY_T0 (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

    ELSE
      Z_DPHYCTY_T0 (:,:, JBLK)=0.0_JPRB
    ENDIF

    CALL GPCTY_EXPL (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY%YRDIM%NPROMA&
    &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN%YRDYNA%LRUBC, YDGEOMETRY&
    &%YRVERT_GEOM%YRVAB, YDGEOMETRY%YRVERT_GEOM%YRVETA, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK&
    &), Z_YDVARS_DIV_T0(:,:, JBLK), Z_YDVARS_EDOT_T0(:,:, JBLK), PSPL=Z_YDCPG_DYN0_PREL(:, JBLK), PSPM=Z_YDCPG_DYN0_PREM&
    &(:, JBLK), PRPREF=Z_RPREF_T0(:,:, JBLK), PDPHYCTY=Z_DPHYCTY_T0(:,:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP&
    &(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK), PALPH&
    &=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE&
    &(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP(:,:, JBLK), PEVEL=Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), PVVEL=Z_YDCPG_DYN0_CTY_VVEL&
    &(:,:, JBLK), PPSDIV=Z_YDCPG_DYN0_CTY_PSDIV(:,:, JBLK), PPSDVBC=Z_YDCPG_DYN0_CTY_PSDVBC(:,:, JBLK), PDIVDP&
    &=Z_YDCPG_DYN0_CTY_DIVDP(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_DPHYCTY_T0 => GET_HOST_DATA_RDWR (YL_Z_DPHYCTY_T0)
    Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
    Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
    Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
    Z_YDCPG_DYN0_CTY_DIVDP => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_DIVDP)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_DYN0_CTY_PSDIV => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDIV)
    Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_R)
    Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
    Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
    Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_EDOT_T0 => GET_HOST_DATA_RDWR (YDVARS%EDOT%FT0)
    Z_YDVARS_PHYCTY_T0 => GET_HOST_DATA_RDWR (YDVARS%PHYCTY%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR (YDVARS%Q%FDL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR (YDVARS%Q%FDM)
    Z_YDVARS_RSPEC_DL => GET_HOST_DATA_RDWR (YDVARS%RSPEC%FDL)
    Z_YDVARS_RSPEC_DM => GET_HOST_DATA_RDWR (YDVARS%RSPEC%FDM)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_DPHYCTY_T0 => NULL ()
  Z_RDT_T0 => NULL ()
  Z_RPREF_T0 => NULL ()
  Z_RT_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_DIVDP => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_DYN0_CTY_PSDIV => NULL ()
  Z_YDCPG_DYN0_CTY_PSDVBC => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_RCP_R => NULL ()
  Z_YDCPG_DYN0_RTL => NULL ()
  Z_YDCPG_DYN0_RTM => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN0_XYB_RPP => NULL ()
  Z_YDCPG_DYN0_XYB_RPRE => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_EDOT_T0 => NULL ()
  Z_YDVARS_PHYCTY_T0 => NULL ()
  Z_YDVARS_Q_DL => NULL ()
  Z_YDVARS_Q_DM => NULL ()
  Z_YDVARS_RSPEC_DL => NULL ()
  Z_YDVARS_RSPEC_DM => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_HYD_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_DPHYCTY_T0 => GET_HOST_DATA_RDWR (YL_Z_DPHYCTY_T0)
  Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
  Z_RPREF_T0 => GET_HOST_DATA_RDONLY (YL_Z_RPREF_T0)
  Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
  Z_YDCPG_DYN0_CTY_DIVDP => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_DIVDP)
  Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_DYN0_CTY_PSDIV => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDIV)
  Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDONLY (YDCPG_DYN0%RCP%F_R)
  Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
  Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RPP)
  Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RPRE)
  Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RTGR)
  Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDONLY (YDVARS%DIV%FT0)
  Z_YDVARS_EDOT_T0 => GET_HOST_DATA_RDONLY (YDVARS%EDOT%FT0)
  Z_YDVARS_PHYCTY_T0 => GET_HOST_DATA_RDONLY (YDVARS%PHYCTY%FT0)
  Z_YDVARS_Q_DL => GET_HOST_DATA_RDONLY (YDVARS%Q%FDL)
  Z_YDVARS_Q_DM => GET_HOST_DATA_RDONLY (YDVARS%Q%FDM)
  Z_YDVARS_RSPEC_DL => GET_HOST_DATA_RDONLY (YDVARS%RSPEC%FDL)
  Z_YDVARS_RSPEC_DM => GET_HOST_DATA_RDONLY (YDVARS%RSPEC%FDM)
  Z_YDVARS_T_DL => GET_HOST_DATA_RDONLY (YDVARS%T%FDL)
  Z_YDVARS_T_DM => GET_HOST_DATA_RDONLY (YDVARS%T%FDM)
  Z_YDVARS_T_T0 => GET_HOST_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (YDMODEL%YRML_GCONF%YGFL%YRSPEC%LGP) THEN
        CALL GPRT_OPENACC (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV, Z_YDCPG_DYN0_RCP_R(:,:, JBLK),&
        & Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK), Z_YDVARS_Q_DL(:,:, JBLK&
        &), Z_YDVARS_Q_DM(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK&
        &), PRL=Z_YDVARS_RSPEC_DL(:,:, JBLK), PRM=Z_YDVARS_RSPEC_DM(:,:, JBLK),YDSTACK=YLSTACK)
      ELSEIF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
        CALL GPRT_OPENACC (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
        &, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV, Z_YDCPG_DYN0_RCP_R&
        &(:,:, JBLK), Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK&
        &), Z_YDVARS_Q_DL(:,:, JBLK), Z_YDVARS_Q_DM(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL&
        &(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_RDT_T0 (JROF, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDVARS_T_T0 (JROF, JLEV, JBLK)
        
        ENDDO

      ELSE
        Z_RDT_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_RT_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
      ENDIF


      IF (YDMODEL%YRML_GCONF%YGFL%YPHYCTY%LACTIVE) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_DPHYCTY_T0 (JROF, JLEV, JBLK)=Z_YDVARS_PHYCTY_T0 (JROF, JLEV, JBLK)
        
        ENDDO

      ELSE
        Z_DPHYCTY_T0 (JROF,:, JBLK)=0.0_JPRB
      ENDIF

      CALL GPCTY_EXPL_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY&
      &%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN&
      &%YRDYNA%LRUBC, YDGEOMETRY%YRVERT_GEOM%YRVAB, YDGEOMETRY%YRVERT_GEOM%YRVETA, Z_YDVARS_U_T0(:,&
      &:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_DIV_T0(:,:, JBLK), Z_YDVARS_EDOT_T0(:,:, JBLK),&
      & PSPL=Z_YDCPG_DYN0_PREL(:, JBLK), PSPM=Z_YDCPG_DYN0_PREM(:, JBLK), PRPREF=Z_RPREF_T0(:,:, JBLK&
      &), PDPHYCTY=Z_DPHYCTY_T0(:,:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR&
      &(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK), PALPH=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK&
      &), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP&
      &(:,:, JBLK), PEVEL=Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), PVVEL=Z_YDCPG_DYN0_CTY_VVEL(:,:, JBLK),&
      & PPSDIV=Z_YDCPG_DYN0_CTY_PSDIV(:,:, JBLK), PPSDVBC=Z_YDCPG_DYN0_CTY_PSDVBC(:,:, JBLK), PDIVDP&
      &=Z_YDCPG_DYN0_CTY_DIVDP(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_DPHYCTY_T0 => GET_HOST_DATA_RDWR (YL_Z_DPHYCTY_T0)
    Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
    Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
    Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
    Z_YDCPG_DYN0_CTY_DIVDP => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_DIVDP)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_DYN0_CTY_PSDIV => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDIV)
    Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_R)
    Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
    Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
    Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_EDOT_T0 => GET_HOST_DATA_RDWR (YDVARS%EDOT%FT0)
    Z_YDVARS_PHYCTY_T0 => GET_HOST_DATA_RDWR (YDVARS%PHYCTY%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR (YDVARS%Q%FDL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR (YDVARS%Q%FDM)
    Z_YDVARS_RSPEC_DL => GET_HOST_DATA_RDWR (YDVARS%RSPEC%FDL)
    Z_YDVARS_RSPEC_DM => GET_HOST_DATA_RDWR (YDVARS%RSPEC%FDM)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_DPHYCTY_T0 => NULL ()
  Z_RDT_T0 => NULL ()
  Z_RPREF_T0 => NULL ()
  Z_RT_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_DIVDP => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_DYN0_CTY_PSDIV => NULL ()
  Z_YDCPG_DYN0_CTY_PSDVBC => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_RCP_R => NULL ()
  Z_YDCPG_DYN0_RTL => NULL ()
  Z_YDCPG_DYN0_RTM => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN0_XYB_RPP => NULL ()
  Z_YDCPG_DYN0_XYB_RPRE => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_EDOT_T0 => NULL ()
  Z_YDVARS_PHYCTY_T0 => NULL ()
  Z_YDVARS_Q_DL => NULL ()
  Z_YDVARS_Q_DM => NULL ()
  Z_YDVARS_RSPEC_DL => NULL ()
  Z_YDVARS_RSPEC_DM => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_HYD_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_DPHYCTY_T0 => GET_DEVICE_DATA_RDWR (YL_Z_DPHYCTY_T0)
  Z_RDT_T0 => GET_DEVICE_DATA_RDWR (YL_Z_RDT_T0)
  Z_RPREF_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_RPREF_T0)
  Z_RT_T0 => GET_DEVICE_DATA_RDWR (YL_Z_RT_T0)
  Z_YDCPG_DYN0_CTY_DIVDP => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%CTY%F_DIVDP)
  Z_YDCPG_DYN0_CTY_EVEL => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_DYN0_CTY_PSDIV => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDIV)
  Z_YDCPG_DYN0_CTY_PSDVBC => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
  Z_YDCPG_DYN0_CTY_VVEL => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_PREL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_RCP_R => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%RCP%F_R)
  Z_YDCPG_DYN0_RTL => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_RTL)
  Z_YDCPG_DYN0_RTM => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_RTM)
  Z_YDCPG_DYN0_XYB_ALPH => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN0_XYB_RPP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_RPP)
  Z_YDCPG_DYN0_XYB_RPRE => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_RPRE)
  Z_YDCPG_DYN0_XYB_RTGR => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_RTGR)
  Z_YDVARS_DIV_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%DIV%FT0)
  Z_YDVARS_EDOT_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%EDOT%FT0)
  Z_YDVARS_PHYCTY_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%PHYCTY%FT0)
  Z_YDVARS_Q_DL => GET_DEVICE_DATA_RDONLY (YDVARS%Q%FDL)
  Z_YDVARS_Q_DM => GET_DEVICE_DATA_RDONLY (YDVARS%Q%FDM)
  Z_YDVARS_RSPEC_DL => GET_DEVICE_DATA_RDONLY (YDVARS%RSPEC%FDL)
  Z_YDVARS_RSPEC_DM => GET_DEVICE_DATA_RDONLY (YDVARS%RSPEC%FDM)
  Z_YDVARS_T_DL => GET_DEVICE_DATA_RDONLY (YDVARS%T%FDL)
  Z_YDVARS_T_DM => GET_DEVICE_DATA_RDONLY (YDVARS%T%FDM)
  Z_YDVARS_T_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, Z_DPHYCTY_T0, &
    !$ACC&         Z_RDT_T0, Z_RPREF_T0, Z_RT_T0, Z_YDCPG_DYN0_CTY_DIVDP, Z_YDCPG_DYN0_CTY_EVEL, &
    !$ACC&         Z_YDCPG_DYN0_CTY_PSDIV, Z_YDCPG_DYN0_CTY_PSDVBC, Z_YDCPG_DYN0_CTY_VVEL, &
    !$ACC&         Z_YDCPG_DYN0_PREL, Z_YDCPG_DYN0_PREM, Z_YDCPG_DYN0_RCP_R, &
    !$ACC&         Z_YDCPG_DYN0_RTL, Z_YDCPG_DYN0_RTM, Z_YDCPG_DYN0_XYB_ALPH, &
    !$ACC&         Z_YDCPG_DYN0_XYB_DELP, Z_YDCPG_DYN0_XYB_LNPR, Z_YDCPG_DYN0_XYB_RDELP, &
    !$ACC&         Z_YDCPG_DYN0_XYB_RPP, Z_YDCPG_DYN0_XYB_RPRE, Z_YDCPG_DYN0_XYB_RTGR, &
    !$ACC&         Z_YDVARS_DIV_T0, Z_YDVARS_EDOT_T0, Z_YDVARS_PHYCTY_T0, Z_YDVARS_Q_DL, &
    !$ACC&         Z_YDVARS_Q_DM, Z_YDVARS_RSPEC_DL, Z_YDVARS_RSPEC_DM, Z_YDVARS_T_DL, &
    !$ACC&         Z_YDVARS_T_DM, Z_YDVARS_T_T0, Z_YDVARS_U_T0, Z_YDVARS_V_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (YDMODEL%YRML_GCONF%YGFL%YRSPEC%LGP) THEN
        CALL GPRT_OPENACC (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV, Z_YDCPG_DYN0_RCP_R(:,:, JBLK),&
        & Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK), Z_YDVARS_Q_DL(:,:, JBLK&
        &), Z_YDVARS_Q_DM(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK&
        &), PRL=Z_YDVARS_RSPEC_DL(:,:, JBLK), PRM=Z_YDVARS_RSPEC_DM(:,:, JBLK),YDSTACK=YLSTACK)
      ELSEIF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
        CALL GPRT_OPENACC (YDMODEL%YRML_DYN%YRDYNA%LSPRT, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
        &, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRCST%RD, YDMODEL%YRCST%RV, Z_YDCPG_DYN0_RCP_R&
        &(:,:, JBLK), Z_YDVARS_T_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK&
        &), Z_YDVARS_Q_DL(:,:, JBLK), Z_YDVARS_Q_DM(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL&
        &(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_RDT_T0 (JROF, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDVARS_T_T0 (JROF, JLEV, JBLK)
        
        ENDDO

      ELSE
        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_RDT_T0 (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, JBLK), Z_RT_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
      ENDIF


      IF (YDMODEL%YRML_GCONF%YGFL%YPHYCTY%LACTIVE) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_DPHYCTY_T0 (JROF, JLEV, JBLK)=Z_YDVARS_PHYCTY_T0 (JROF, JLEV, JBLK)
        
        ENDDO

      ELSE
        Z_DPHYCTY_T0 (JROF,:, JBLK)=0.0_JPRB
      ENDIF

      CALL GPCTY_EXPL_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER, YDGEOMETRY&
      &%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDMODEL%YRML_DYN&
      &%YRDYNA%LRUBC, YDGEOMETRY%YRVERT_GEOM%YRVAB, YDGEOMETRY%YRVERT_GEOM%YRVETA, Z_YDVARS_U_T0(:,&
      &:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_DIV_T0(:,:, JBLK), Z_YDVARS_EDOT_T0(:,:, JBLK),&
      & PSPL=Z_YDCPG_DYN0_PREL(:, JBLK), PSPM=Z_YDCPG_DYN0_PREM(:, JBLK), PRPREF=Z_RPREF_T0(:,:, JBLK&
      &), PDPHYCTY=Z_DPHYCTY_T0(:,:, JBLK), PDELP=Z_YDCPG_DYN0_XYB_DELP(:,:, JBLK), PLNPR=Z_YDCPG_DYN0_XYB_LNPR&
      &(:,:, JBLK), PRDELP=Z_YDCPG_DYN0_XYB_RDELP(:,:, JBLK), PALPH=Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK&
      &), PRTGR=Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), PRPRE=Z_YDCPG_DYN0_XYB_RPRE(:,:, JBLK), PRPP=Z_YDCPG_DYN0_XYB_RPP&
      &(:,:, JBLK), PEVEL=Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), PVVEL=Z_YDCPG_DYN0_CTY_VVEL(:,:, JBLK),&
      & PPSDIV=Z_YDCPG_DYN0_CTY_PSDIV(:,:, JBLK), PPSDVBC=Z_YDCPG_DYN0_CTY_PSDVBC(:,:, JBLK), PDIVDP&
      &=Z_YDCPG_DYN0_CTY_DIVDP(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_DPHYCTY_T0 => GET_HOST_DATA_RDWR (YL_Z_DPHYCTY_T0)
    Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
    Z_RPREF_T0 => GET_HOST_DATA_RDWR (YL_Z_RPREF_T0)
    Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
    Z_YDCPG_DYN0_CTY_DIVDP => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_DIVDP)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_DYN0_CTY_PSDIV => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDIV)
    Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_R)
    Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
    Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN0_XYB_RPP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPP)
    Z_YDCPG_DYN0_XYB_RPRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RPRE)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_EDOT_T0 => GET_HOST_DATA_RDWR (YDVARS%EDOT%FT0)
    Z_YDVARS_PHYCTY_T0 => GET_HOST_DATA_RDWR (YDVARS%PHYCTY%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR (YDVARS%Q%FDL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR (YDVARS%Q%FDM)
    Z_YDVARS_RSPEC_DL => GET_HOST_DATA_RDWR (YDVARS%RSPEC%FDL)
    Z_YDVARS_RSPEC_DM => GET_HOST_DATA_RDWR (YDVARS%RSPEC%FDM)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_DPHYCTY_T0 => NULL ()
  Z_RDT_T0 => NULL ()
  Z_RPREF_T0 => NULL ()
  Z_RT_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_DIVDP => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_DYN0_CTY_PSDIV => NULL ()
  Z_YDCPG_DYN0_CTY_PSDVBC => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_RCP_R => NULL ()
  Z_YDCPG_DYN0_RTL => NULL ()
  Z_YDCPG_DYN0_RTM => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN0_XYB_RPP => NULL ()
  Z_YDCPG_DYN0_XYB_RPRE => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_EDOT_T0 => NULL ()
  Z_YDVARS_PHYCTY_T0 => NULL ()
  Z_YDVARS_Q_DL => NULL ()
  Z_YDVARS_Q_DM => NULL ()
  Z_YDVARS_RSPEC_DL => NULL ()
  Z_YDVARS_RSPEC_DM => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_HYD_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)

IF (LGWDIAGS_ON) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDCPG_OPTS%LSFORC.AND.(YDCPG_OPTS%LSW_FRC.OR.YDCPG_OPTS%LSOMEGA_FRC)) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_HYD_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
  Z_DVER_T0 => GET_HOST_DATA_RDWR (YL_Z_DVER_T0)
  Z_GPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHL_T0)
  Z_GPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHM_T0)
  Z_NHXT_T0 => GET_HOST_DATA_RDWR (YL_Z_NHXT_T0)
  Z_PSGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTL_T0)
  Z_PSGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTM_T0)
  Z_RDT_T0 => GET_HOST_DATA_RDONLY (YL_Z_RDT_T0)
  Z_RT_T0 => GET_HOST_DATA_RDONLY (YL_Z_RT_T0)
  Z_SGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTL_T0)
  Z_SGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTM_T0)
  Z_US_T0 => GET_HOST_DATA_RDWR (YL_Z_US_T0)
  Z_VS_T0 => GET_HOST_DATA_RDWR (YL_Z_VS_T0)
  Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHL_T0)
  Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHM_T0)
  Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHPLL_T0)
  Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHPLM_T0)
  Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_LNPRL_T0)
  Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_LNPRM_T0)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_KENE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_KENE)
  Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_OROGL)
  Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_OROGM)
  Z_YDCPG_DYN0_PHI => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHI)
  Z_YDCPG_DYN0_PHIF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIF)
  Z_YDCPG_DYN0_PHIFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFL)
  Z_YDCPG_DYN0_PHIFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFM)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_RCP_KAP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%RCP%F_KAP)
  Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDONLY (YDCPG_DYN0%RCP%F_R)
  Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_RTL)
  Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_RTM)
  Z_YDCPG_DYN0_UVH_UH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_UH)
  Z_YDCPG_DYN0_UVH_VH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_VH)
  Z_YDCPG_DYN0_UVH_WWI => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_WWI)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RTGR)
  Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
  Z_YDCPG_TND_TNDU => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU)
  Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
  Z_YDCPG_TND_TNDV => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV)
  Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
  Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDONLY (YDVARS%DIV%FT0)
  Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_SGRTL_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT0)
  Z_YDVARS_SGRTL_T9 => GET_HOST_DATA_RDONLY (YDVARS%SGRTL%FT9)
  Z_YDVARS_SGRTM_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT0)
  Z_YDVARS_SGRTM_T9 => GET_HOST_DATA_RDONLY (YDVARS%SGRTM%FT9)
  Z_YDVARS_T_T0 => GET_HOST_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
      Z_YDCPG_DYN0_PHI (:, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_GEOMETRY_OROG_T0 (:, JBLK)
      CALL GPGEO_EXPL (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
      &%YRDIMV%NFLEVG, Z_YDCPG_DYN0_PHI(:,:, JBLK), Z_YDCPG_DYN0_PHIF(:,:, JBLK), Z_YDVARS_T_T0&
      &(:,:, JBLK), Z_YDCPG_DYN0_RCP_R(:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH&
      &(:,:, JBLK), YDGEOMETRY%YRVERT_GEOM)
      CALL GPGRGEO_EXPL (YDGEOMETRY, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
      & YDGEOMETRY%YRDIMV%NFLEVG, Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL(:,:, JBLK), Z_YDCPG_DYN0_RTM&
      &(:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), POROGL=Z_YDCPG_DYN0_OROGL&
      &(:, JBLK), POROGM=Z_YDCPG_DYN0_OROGM(:, JBLK), PHIFL=Z_YDCPG_DYN0_PHIFL(:,:, JBLK), PHIFM=Z_YDCPG_DYN0_PHIFM&
      &(:,:, JBLK), PHIHL=Z_GPHL_T0(:,:, JBLK), PHIHM=Z_GPHM_T0(:,:, JBLK), PLNPRL_DER=Z_XYBDER_LNPRL_T0&
      &(:,:, JBLK), PLNPRM_DER=Z_XYBDER_LNPRM_T0(:,:, JBLK), PALPHL_DER=Z_XYBDER_ALPHL_T0(:,:, JBLK&
      &), PALPHM_DER=Z_XYBDER_ALPHM_T0(:,:, JBLK))
    ENDIF


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDCPG_DYN0_KENE (JROF, JLEV, JBLK)=0.5_JPRB*(Z_YDVARS_U_T0 &
        &(JROF, JLEV, JBLK)**2+Z_YDVARS_V_T0 (JROF, JLEV, JBLK)**2)
      ENDDO

    ENDDO


    IF (LLUVH) THEN
      CALL GPHLWI (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVFE_COMPATIBLE, YDGEOMETRY%YRDIMV%NFLEVG&
      &, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_DYN0_XYB_LNPR&
      &(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), YDGEOMETRY%YRVERT_GEOM%YRVETA%VRDETAH&
      &, YDGEOMETRY%YRVERT_GEOM%YRVETA%VDETA_RATIO, Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK))
      CALL GPHLUV_EXPL (YDGEOMETRY%YRDIMV, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), PWWI=Z_YDCPG_DYN0_UVH_WWI(:&
      &,:, JBLK), PUH=Z_YDCPG_DYN0_UVH_UH(:,:, JBLK), PVH=Z_YDCPG_DYN0_UVH_VH(:,:, JBLK))
    ENDIF


    IF (LLGPXX.OR.YDMODEL%YRML_DYN%YRDYNA%LSLHD) THEN
      CALL GPUVS (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
      & LLDER, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_US_T0(:, JBLK), Z_VS_T0(:, JBLK))
    ENDIF


    IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGFSF) THEN
      CALL GPGRP_EXPL (YDGEOMETRY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL&
      &(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK), Z_YDCPG_DYN0_PREL(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK&
      &), Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PHIHL=Z_GPHL_T0(:,:, JBLK&
      &), PHIHM=Z_GPHM_T0(:,:, JBLK), PHIFL=Z_YDCPG_DYN0_PHIFL(:,:, JBLK), PHIFM=Z_YDCPG_DYN0_PHIFM&
      &(:,:, JBLK), PSGRTL=Z_PSGRTL_T0(:,:, JBLK), PSGRTM=Z_PSGRTM_T0(:,:, JBLK), PALPHPLL_DER=Z_XYBDER_ALPHPLL_T0&
      &(:,:, JBLK), PALPHPLM_DER=Z_XYBDER_ALPHPLM_T0(:,:, JBLK))
    ENDIF


    IF (YDMODEL%YRML_DYN%YRDYNA%LGRADSP) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_SGRTL_T0 (JROF, JLEV, JBLK)=Z_PSGRTL_T0 (JROF, JLEV, JBLK)-(Z_YDVARS_SGRTL_T9&
          & (JROF, JLEV, JBLK)-Z_YDVARS_SGRTL_T0 (JROF, JLEV, JBLK))
          Z_SGRTM_T0 (JROF, JLEV, JBLK)=Z_PSGRTM_T0 (JROF, JLEV, JBLK)-(Z_YDVARS_SGRTM_T9&
          & (JROF, JLEV, JBLK)-Z_YDVARS_SGRTM_T0 (JROF, JLEV, JBLK))
        ENDDO

      ENDDO

      Z_YDVARS_SGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
      &)=Z_PSGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
      Z_YDVARS_SGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
      &)=Z_PSGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
      Z_PSGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_SGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
      Z_PSGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_SGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
    ENDIF


    IF (LLGPXX) THEN
      CALL GPXX (YDGEOMETRY, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, Z_GPHL_T0(:,:, JBLK), Z_GPHM_T0(:,:, JBLK), Z_YDCPG_DYN0_PHIFL(:,:, JBLK&
      &), Z_YDCPG_DYN0_PHIFM(:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDVARS_U_T0&
      &(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDCPG_DYN0_UVH_UH(:,:, JBLK), Z_YDCPG_DYN0_UVH_VH&
      &(:,:, JBLK), Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK), Z_NHXT_T0(:,:, JBLK))

      IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_DVER_T0 (JROF, JLEV, JBLK)=-(Z_YDCPG_DYN0_RCP_R (JROF, JLEV, JBLK)/YDMODEL%YRCST%RD&
            &)*(Z_YDVARS_DIV_T0 (JROF, JLEV, JBLK)+Z_NHXT_T0 (JROF, JLEV, JBLK)+(1.0_JPRB-Z_YDCPG_DYN0_RCP_KAP&
            & (JROF, JLEV, JBLK))*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK))
          ENDDO

        ENDDO

      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_DVER_T0 (JROF, JLEV, JBLK)=-(Z_YDVARS_DIV_T0 (JROF, JLEV, JBLK)+Z_NHXT_T0 (JROF, JLEV, JBLK)+&
            &(1.0_JPRB-Z_YDCPG_DYN0_RCP_KAP (JROF, JLEV, JBLK))*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK))
          ENDDO

        ENDDO

      ENDIF

      CALL GPGW (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYNA%LNHDYN, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY&
      &%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLGWF0, LLGDWI, Z_YDCPG_DYN0_OROGL&
      &(:, JBLK), Z_YDCPG_DYN0_OROGM(:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH&
      &(:,:, JBLK), Z_US_T0(:, JBLK), Z_VS_T0(:, JBLK), Z_RDT_T0(:,:, JBLK), Z_DVER_T0(:,:&
      &, JBLK), P_GWHT_T0(:,:, JBLK), Z_YDCPG_DYN0_GWFT(:,:, JBLK))
    ENDIF

    CALL GP_TNDLAGADIAB_UV (YDCPG_OPTS%LRPLANE, YDGEOMETRY, YDMODEL%YRML_PHY_EC%YREPHY, YDMODEL%YRML_DYN&
    &%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_RCORI_T0(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_T0&
    &(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_T0(:, JBLK), Z_PSGRTL_T0(:,:, JBLK), Z_PSGRTM_T0(:,:, JBLK), Z_YDVARS_U_T0&
    &(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDCPG_TND_TNDU(:,:, JBLK), Z_YDCPG_TND_TNDV(:,:, JBLK), Z_YDCPG_TND_TNDU_NOC&
    &(:,:, JBLK), Z_YDCPG_TND_TNDV_NOC(:,:, JBLK))

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDCPG_TND_TNDT (JROF, JLEV, JBLK)=Z_YDCPG_DYN0_RCP_KAP (JROF, JLEV, JBLK)*Z_YDVARS_T_T0&
        & (JROF, JLEV, JBLK)*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:2')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
    Z_DVER_T0 => GET_HOST_DATA_RDWR (YL_Z_DVER_T0)
    Z_GPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHL_T0)
    Z_GPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHM_T0)
    Z_NHXT_T0 => GET_HOST_DATA_RDWR (YL_Z_NHXT_T0)
    Z_PSGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTL_T0)
    Z_PSGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTM_T0)
    Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
    Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
    Z_SGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTL_T0)
    Z_SGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTM_T0)
    Z_US_T0 => GET_HOST_DATA_RDWR (YL_Z_US_T0)
    Z_VS_T0 => GET_HOST_DATA_RDWR (YL_Z_VS_T0)
    Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
    Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
    Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
    Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
    Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
    Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_KENE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_KENE)
    Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
    Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
    Z_YDCPG_DYN0_PHI => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHI)
    Z_YDCPG_DYN0_PHIF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIF)
    Z_YDCPG_DYN0_PHIFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFL)
    Z_YDCPG_DYN0_PHIFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFM)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_RCP_KAP => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_KAP)
    Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_R)
    Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
    Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
    Z_YDCPG_DYN0_UVH_UH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_UH)
    Z_YDCPG_DYN0_UVH_VH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_VH)
    Z_YDCPG_DYN0_UVH_WWI => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_WWI)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
    Z_YDCPG_TND_TNDU => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU)
    Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
    Z_YDCPG_TND_TNDV => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV)
    Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_SGRTL_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT0)
    Z_YDVARS_SGRTL_T9 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT9)
    Z_YDVARS_SGRTM_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT0)
    Z_YDVARS_SGRTM_T9 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT9)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => NULL ()
  Z_DVER_T0 => NULL ()
  Z_GPHL_T0 => NULL ()
  Z_GPHM_T0 => NULL ()
  Z_NHXT_T0 => NULL ()
  Z_PSGRTL_T0 => NULL ()
  Z_PSGRTM_T0 => NULL ()
  Z_RDT_T0 => NULL ()
  Z_RT_T0 => NULL ()
  Z_SGRTL_T0 => NULL ()
  Z_SGRTM_T0 => NULL ()
  Z_US_T0 => NULL ()
  Z_VS_T0 => NULL ()
  Z_XYBDER_ALPHL_T0 => NULL ()
  Z_XYBDER_ALPHM_T0 => NULL ()
  Z_XYBDER_ALPHPLL_T0 => NULL ()
  Z_XYBDER_ALPHPLM_T0 => NULL ()
  Z_XYBDER_LNPRL_T0 => NULL ()
  Z_XYBDER_LNPRM_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_KENE => NULL ()
  Z_YDCPG_DYN0_OROGL => NULL ()
  Z_YDCPG_DYN0_OROGM => NULL ()
  Z_YDCPG_DYN0_PHI => NULL ()
  Z_YDCPG_DYN0_PHIF => NULL ()
  Z_YDCPG_DYN0_PHIFL => NULL ()
  Z_YDCPG_DYN0_PHIFM => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_RCP_KAP => NULL ()
  Z_YDCPG_DYN0_RCP_R => NULL ()
  Z_YDCPG_DYN0_RTL => NULL ()
  Z_YDCPG_DYN0_RTM => NULL ()
  Z_YDCPG_DYN0_UVH_UH => NULL ()
  Z_YDCPG_DYN0_UVH_VH => NULL ()
  Z_YDCPG_DYN0_UVH_WWI => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  Z_YDCPG_TND_TNDT => NULL ()
  Z_YDCPG_TND_TNDU => NULL ()
  Z_YDCPG_TND_TNDU_NOC => NULL ()
  Z_YDCPG_TND_TNDV => NULL ()
  Z_YDCPG_TND_TNDV_NOC => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  Z_YDVARS_SGRTL_T0 => NULL ()
  Z_YDVARS_SGRTL_T9 => NULL ()
  Z_YDVARS_SGRTM_T0 => NULL ()
  Z_YDVARS_SGRTM_T9 => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_HYD_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
  Z_DVER_T0 => GET_HOST_DATA_RDWR (YL_Z_DVER_T0)
  Z_GPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHL_T0)
  Z_GPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHM_T0)
  Z_NHXT_T0 => GET_HOST_DATA_RDWR (YL_Z_NHXT_T0)
  Z_PSGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTL_T0)
  Z_PSGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTM_T0)
  Z_RDT_T0 => GET_HOST_DATA_RDONLY (YL_Z_RDT_T0)
  Z_RT_T0 => GET_HOST_DATA_RDONLY (YL_Z_RT_T0)
  Z_SGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTL_T0)
  Z_SGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTM_T0)
  Z_US_T0 => GET_HOST_DATA_RDWR (YL_Z_US_T0)
  Z_VS_T0 => GET_HOST_DATA_RDWR (YL_Z_VS_T0)
  Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHL_T0)
  Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHM_T0)
  Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHPLL_T0)
  Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_ALPHPLM_T0)
  Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_LNPRL_T0)
  Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDONLY (YL_Z_XYBDER_LNPRM_T0)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_KENE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_KENE)
  Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_OROGL)
  Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_OROGM)
  Z_YDCPG_DYN0_PHI => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHI)
  Z_YDCPG_DYN0_PHIF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIF)
  Z_YDCPG_DYN0_PHIFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFL)
  Z_YDCPG_DYN0_PHIFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFM)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_RCP_KAP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%RCP%F_KAP)
  Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDONLY (YDCPG_DYN0%RCP%F_R)
  Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_RTL)
  Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_RTM)
  Z_YDCPG_DYN0_UVH_UH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_UH)
  Z_YDCPG_DYN0_UVH_VH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_VH)
  Z_YDCPG_DYN0_UVH_WWI => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_WWI)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RTGR)
  Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
  Z_YDCPG_TND_TNDU => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU)
  Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
  Z_YDCPG_TND_TNDV => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV)
  Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
  Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDONLY (YDVARS%DIV%FT0)
  Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_SGRTL_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT0)
  Z_YDVARS_SGRTL_T9 => GET_HOST_DATA_RDONLY (YDVARS%SGRTL%FT9)
  Z_YDVARS_SGRTM_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT0)
  Z_YDVARS_SGRTM_T9 => GET_HOST_DATA_RDONLY (YDVARS%SGRTM%FT9)
  Z_YDVARS_T_T0 => GET_HOST_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
        Z_YDCPG_DYN0_PHI (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
        CALL GPGEO_EXPL_OPENACC (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
        & YDGEOMETRY%YRDIMV%NFLEVG, Z_YDCPG_DYN0_PHI(:,:, JBLK), Z_YDCPG_DYN0_PHIF(:,:, JBLK)&
        &, Z_YDVARS_T_T0(:,:, JBLK), Z_YDCPG_DYN0_RCP_R(:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:&
        &, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), YDGEOMETRY%YRVERT_GEOM,YDSTACK=YLSTACK)
        CALL GPGRGEO_EXPL_OPENACC (YDGEOMETRY, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL(:,:, JBLK), Z_YDCPG_DYN0_RTM(&
        &:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), POROGL=Z_YDCPG_DYN0_OROGL&
        &(:, JBLK), POROGM=Z_YDCPG_DYN0_OROGM(:, JBLK), PHIFL=Z_YDCPG_DYN0_PHIFL(:,:, JBLK), PHIFM=Z_YDCPG_DYN0_PHIFM&
        &(:,:, JBLK), PHIHL=Z_GPHL_T0(:,:, JBLK), PHIHM=Z_GPHM_T0(:,:, JBLK), PLNPRL_DER=Z_XYBDER_LNPRL_T0&
        &(:,:, JBLK), PLNPRM_DER=Z_XYBDER_LNPRM_T0(:,:, JBLK), PALPHL_DER=Z_XYBDER_ALPHL_T0(:,:, JBLK),&
        & PALPHM_DER=Z_XYBDER_ALPHM_T0(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_DYN0_KENE (JROF, JLEV, JBLK)=0.5_JPRB*(Z_YDVARS_U_T0 &
        &(JROF, JLEV, JBLK)**2+Z_YDVARS_V_T0 (JROF, JLEV, JBLK)**2)
      
      ENDDO


      IF (LLUVH) THEN
        CALL GPHLWI_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVFE_COMPATIBLE, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_DYN0_XYB_LNPR(:,:,&
        & JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), YDGEOMETRY%YRVERT_GEOM%YRVETA%VRDETAH, YDGEOMETRY&
        &%YRVERT_GEOM%YRVETA%VDETA_RATIO, Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK),YDSTACK=YLSTACK)
        CALL GPHLUV_EXPL_OPENACC (YDGEOMETRY%YRDIMV, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), PWWI=Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK&
        &), PUH=Z_YDCPG_DYN0_UVH_UH(:,:, JBLK), PVH=Z_YDCPG_DYN0_UVH_VH(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (LLGPXX.OR.YDMODEL%YRML_DYN%YRDYNA%LSLHD) THEN
        CALL GPUVS_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, LLDER, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0(&
        &:,:, JBLK), Z_US_T0(:, JBLK), Z_VS_T0(:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGFSF) THEN
        CALL GPGRP_EXPL_OPENACC (YDGEOMETRY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL&
        &(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK), Z_YDCPG_DYN0_PREL(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK)&
        &, Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PHIHL=Z_GPHL_T0(:,:, JBLK)&
        &, PHIHM=Z_GPHM_T0(:,:, JBLK), PHIFL=Z_YDCPG_DYN0_PHIFL(:,:, JBLK), PHIFM=Z_YDCPG_DYN0_PHIFM(:,:,&
        & JBLK), PSGRTL=Z_PSGRTL_T0(:,:, JBLK), PSGRTM=Z_PSGRTM_T0(:,:, JBLK), PALPHPLL_DER=Z_XYBDER_ALPHPLL_T0&
        &(:,:, JBLK), PALPHPLM_DER=Z_XYBDER_ALPHPLM_T0(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (YDMODEL%YRML_DYN%YRDYNA%LGRADSP) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_SGRTL_T0 (JROF, JLEV, JBLK)=Z_PSGRTL_T0 (JROF, JLEV, JBLK)-(Z_YDVARS_SGRTL_T9&
          & (JROF, JLEV, JBLK)-Z_YDVARS_SGRTL_T0 (JROF, JLEV, JBLK))
          Z_SGRTM_T0 (JROF, JLEV, JBLK)=Z_PSGRTM_T0 (JROF, JLEV, JBLK)-(Z_YDVARS_SGRTM_T9&
          & (JROF, JLEV, JBLK)-Z_YDVARS_SGRTM_T0 (JROF, JLEV, JBLK))
        
        ENDDO

        Z_YDVARS_SGRTL_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
        &)=Z_PSGRTL_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
        Z_YDVARS_SGRTM_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK&
        &)=Z_PSGRTM_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
        Z_PSGRTL_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_SGRTL_T0&
        & (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
        Z_PSGRTM_T0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_SGRTM_T0&
        & (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
      ENDIF


      IF (LLGPXX) THEN
        CALL GPXX_OPENACC (YDGEOMETRY, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
        &, YLCPG_BNDS%KFDIA, Z_GPHL_T0(:,:, JBLK), Z_GPHM_T0(:,:, JBLK), Z_YDCPG_DYN0_PHIFL(:,:, JBLK)&
        &, Z_YDCPG_DYN0_PHIFM(:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDVARS_U_T0&
        &(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDCPG_DYN0_UVH_UH(:,:, JBLK), Z_YDCPG_DYN0_UVH_VH(:,&
        &:, JBLK), Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK), Z_NHXT_T0(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_DVER_T0 (JROF, JLEV, JBLK)=-(Z_YDCPG_DYN0_RCP_R (JROF, JLEV, JBLK)/YDMODEL%YRCST%RD&
            &)*(Z_YDVARS_DIV_T0 (JROF, JLEV, JBLK)+Z_NHXT_T0 (JROF, JLEV, JBLK)+(1.0_JPRB-Z_YDCPG_DYN0_RCP_KAP&
            & (JROF, JLEV, JBLK))*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK))
          
          ENDDO

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_DVER_T0 (JROF, JLEV, JBLK)=-(Z_YDVARS_DIV_T0 (JROF, JLEV, JBLK)+Z_NHXT_T0 (JROF, JLEV, JBLK)+&
            &(1.0_JPRB-Z_YDCPG_DYN0_RCP_KAP (JROF, JLEV, JBLK))*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK))
          
          ENDDO

        ENDIF

        CALL GPGW_OPENACC (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYNA%LNHDYN, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY&
        &%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLGWF0, LLGDWI, Z_YDCPG_DYN0_OROGL(:,&
        & JBLK), Z_YDCPG_DYN0_OROGM(:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH&
        &(:,:, JBLK), Z_US_T0(:, JBLK), Z_VS_T0(:, JBLK), Z_RDT_T0(:,:, JBLK), Z_DVER_T0(:,:, JBLK&
        &), P_GWHT_T0(:,:, JBLK), Z_YDCPG_DYN0_GWFT(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

      CALL GP_TNDLAGADIAB_UV_OPENACC (YDCPG_OPTS%LRPLANE, YDGEOMETRY, YDMODEL%YRML_PHY_EC%YREPHY&
      &, YDMODEL%YRML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_RCORI_T0&
      &(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_T0(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_T0(:, JBLK)&
      &, Z_PSGRTL_T0(:,:, JBLK), Z_PSGRTM_T0(:,:, JBLK), Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0&
      &(:,:, JBLK), Z_YDCPG_TND_TNDU(:,:, JBLK), Z_YDCPG_TND_TNDV(:,:, JBLK), Z_YDCPG_TND_TNDU_NOC&
      &(:,:, JBLK), Z_YDCPG_TND_TNDV_NOC(:,:, JBLK),YDSTACK=YLSTACK)

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_TND_TNDT (JROF, JLEV, JBLK)=Z_YDCPG_DYN0_RCP_KAP (JROF, JLEV, JBLK)*Z_YDVARS_T_T0&
        & (JROF, JLEV, JBLK)*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:2')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
    Z_DVER_T0 => GET_HOST_DATA_RDWR (YL_Z_DVER_T0)
    Z_GPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHL_T0)
    Z_GPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHM_T0)
    Z_NHXT_T0 => GET_HOST_DATA_RDWR (YL_Z_NHXT_T0)
    Z_PSGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTL_T0)
    Z_PSGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTM_T0)
    Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
    Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
    Z_SGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTL_T0)
    Z_SGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTM_T0)
    Z_US_T0 => GET_HOST_DATA_RDWR (YL_Z_US_T0)
    Z_VS_T0 => GET_HOST_DATA_RDWR (YL_Z_VS_T0)
    Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
    Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
    Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
    Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
    Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
    Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_KENE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_KENE)
    Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
    Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
    Z_YDCPG_DYN0_PHI => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHI)
    Z_YDCPG_DYN0_PHIF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIF)
    Z_YDCPG_DYN0_PHIFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFL)
    Z_YDCPG_DYN0_PHIFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFM)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_RCP_KAP => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_KAP)
    Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_R)
    Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
    Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
    Z_YDCPG_DYN0_UVH_UH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_UH)
    Z_YDCPG_DYN0_UVH_VH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_VH)
    Z_YDCPG_DYN0_UVH_WWI => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_WWI)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
    Z_YDCPG_TND_TNDU => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU)
    Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
    Z_YDCPG_TND_TNDV => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV)
    Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_SGRTL_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT0)
    Z_YDVARS_SGRTL_T9 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT9)
    Z_YDVARS_SGRTM_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT0)
    Z_YDVARS_SGRTM_T9 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT9)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => NULL ()
  Z_DVER_T0 => NULL ()
  Z_GPHL_T0 => NULL ()
  Z_GPHM_T0 => NULL ()
  Z_NHXT_T0 => NULL ()
  Z_PSGRTL_T0 => NULL ()
  Z_PSGRTM_T0 => NULL ()
  Z_RDT_T0 => NULL ()
  Z_RT_T0 => NULL ()
  Z_SGRTL_T0 => NULL ()
  Z_SGRTM_T0 => NULL ()
  Z_US_T0 => NULL ()
  Z_VS_T0 => NULL ()
  Z_XYBDER_ALPHL_T0 => NULL ()
  Z_XYBDER_ALPHM_T0 => NULL ()
  Z_XYBDER_ALPHPLL_T0 => NULL ()
  Z_XYBDER_ALPHPLM_T0 => NULL ()
  Z_XYBDER_LNPRL_T0 => NULL ()
  Z_XYBDER_LNPRM_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_KENE => NULL ()
  Z_YDCPG_DYN0_OROGL => NULL ()
  Z_YDCPG_DYN0_OROGM => NULL ()
  Z_YDCPG_DYN0_PHI => NULL ()
  Z_YDCPG_DYN0_PHIF => NULL ()
  Z_YDCPG_DYN0_PHIFL => NULL ()
  Z_YDCPG_DYN0_PHIFM => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_RCP_KAP => NULL ()
  Z_YDCPG_DYN0_RCP_R => NULL ()
  Z_YDCPG_DYN0_RTL => NULL ()
  Z_YDCPG_DYN0_RTM => NULL ()
  Z_YDCPG_DYN0_UVH_UH => NULL ()
  Z_YDCPG_DYN0_UVH_VH => NULL ()
  Z_YDCPG_DYN0_UVH_WWI => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  Z_YDCPG_TND_TNDT => NULL ()
  Z_YDCPG_TND_TNDU => NULL ()
  Z_YDCPG_TND_TNDU_NOC => NULL ()
  Z_YDCPG_TND_TNDV => NULL ()
  Z_YDCPG_TND_TNDV_NOC => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  Z_YDVARS_SGRTL_T0 => NULL ()
  Z_YDVARS_SGRTL_T9 => NULL ()
  Z_YDVARS_SGRTM_T0 => NULL ()
  Z_YDVARS_SGRTM_T9 => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_HYD_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => GET_DEVICE_DATA_RDWR (YD_P_GWHT_T0)
  Z_DVER_T0 => GET_DEVICE_DATA_RDWR (YL_Z_DVER_T0)
  Z_GPHL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_GPHL_T0)
  Z_GPHM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_GPHM_T0)
  Z_NHXT_T0 => GET_DEVICE_DATA_RDWR (YL_Z_NHXT_T0)
  Z_PSGRTL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_PSGRTL_T0)
  Z_PSGRTM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_PSGRTM_T0)
  Z_RDT_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_RDT_T0)
  Z_RT_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_RT_T0)
  Z_SGRTL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_SGRTL_T0)
  Z_SGRTM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_SGRTM_T0)
  Z_US_T0 => GET_DEVICE_DATA_RDWR (YL_Z_US_T0)
  Z_VS_T0 => GET_DEVICE_DATA_RDWR (YL_Z_VS_T0)
  Z_XYBDER_ALPHL_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_XYBDER_ALPHL_T0)
  Z_XYBDER_ALPHM_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_XYBDER_ALPHM_T0)
  Z_XYBDER_ALPHPLL_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_XYBDER_ALPHPLL_T0)
  Z_XYBDER_ALPHPLM_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_XYBDER_ALPHPLM_T0)
  Z_XYBDER_LNPRL_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_XYBDER_LNPRL_T0)
  Z_XYBDER_LNPRM_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_XYBDER_LNPRM_T0)
  Z_YDCPG_DYN0_CTY_VVEL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_GWFT => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_KENE => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_KENE)
  Z_YDCPG_DYN0_OROGL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_OROGL)
  Z_YDCPG_DYN0_OROGM => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_OROGM)
  Z_YDCPG_DYN0_PHI => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PHI)
  Z_YDCPG_DYN0_PHIF => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PHIF)
  Z_YDCPG_DYN0_PHIFL => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PHIFL)
  Z_YDCPG_DYN0_PHIFM => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PHIFM)
  Z_YDCPG_DYN0_PREL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN0_RCP_KAP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%RCP%F_KAP)
  Z_YDCPG_DYN0_RCP_R => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%RCP%F_R)
  Z_YDCPG_DYN0_RTL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_RTL)
  Z_YDCPG_DYN0_RTM => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_RTM)
  Z_YDCPG_DYN0_UVH_UH => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%UVH%F_UH)
  Z_YDCPG_DYN0_UVH_VH => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%UVH%F_VH)
  Z_YDCPG_DYN0_UVH_WWI => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%UVH%F_WWI)
  Z_YDCPG_DYN0_XYB_ALPH => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_LNPR => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RTGR => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_RTGR)
  Z_YDCPG_TND_TNDT => GET_DEVICE_DATA_RDWR (YDCPG_TND%F_TNDT)
  Z_YDCPG_TND_TNDU => GET_DEVICE_DATA_RDWR (YDCPG_TND%F_TNDU)
  Z_YDCPG_TND_TNDU_NOC => GET_DEVICE_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
  Z_YDCPG_TND_TNDV => GET_DEVICE_DATA_RDWR (YDCPG_TND%F_TNDV)
  Z_YDCPG_TND_TNDV_NOC => GET_DEVICE_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
  Z_YDVARS_DIV_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%DIV%FT0)
  Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  Z_YDVARS_GEOMETRY_OROG_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  Z_YDVARS_SGRTL_T0 => GET_DEVICE_DATA_RDWR (YDVARS%SGRTL%FT0)
  Z_YDVARS_SGRTL_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SGRTL%FT9)
  Z_YDVARS_SGRTM_T0 => GET_DEVICE_DATA_RDWR (YDVARS%SGRTM%FT0)
  Z_YDVARS_SGRTM_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SGRTM%FT9)
  Z_YDVARS_T_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%T%FT0)
  Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (P_GWHT_T0, YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, &
    !$ACC&         Z_DVER_T0, Z_GPHL_T0, Z_GPHM_T0, Z_NHXT_T0, Z_PSGRTL_T0, Z_PSGRTM_T0, &
    !$ACC&         Z_RDT_T0, Z_RT_T0, Z_SGRTL_T0, Z_SGRTM_T0, Z_US_T0, Z_VS_T0, Z_XYBDER_ALPHL_T0, &
    !$ACC&         Z_XYBDER_ALPHM_T0, Z_XYBDER_ALPHPLL_T0, Z_XYBDER_ALPHPLM_T0, &
    !$ACC&         Z_XYBDER_LNPRL_T0, Z_XYBDER_LNPRM_T0, Z_YDCPG_DYN0_CTY_VVEL, &
    !$ACC&         Z_YDCPG_DYN0_GWFT, Z_YDCPG_DYN0_KENE, Z_YDCPG_DYN0_OROGL, &
    !$ACC&         Z_YDCPG_DYN0_OROGM, Z_YDCPG_DYN0_PHI, Z_YDCPG_DYN0_PHIF, &
    !$ACC&         Z_YDCPG_DYN0_PHIFL, Z_YDCPG_DYN0_PHIFM, Z_YDCPG_DYN0_PREL, &
    !$ACC&         Z_YDCPG_DYN0_PREM, Z_YDCPG_DYN0_RCP_KAP, Z_YDCPG_DYN0_RCP_R, &
    !$ACC&         Z_YDCPG_DYN0_RTL, Z_YDCPG_DYN0_RTM, Z_YDCPG_DYN0_UVH_UH, &
    !$ACC&         Z_YDCPG_DYN0_UVH_VH, Z_YDCPG_DYN0_UVH_WWI, Z_YDCPG_DYN0_XYB_ALPH, &
    !$ACC&         Z_YDCPG_DYN0_XYB_LNPR, Z_YDCPG_DYN0_XYB_RTGR, Z_YDCPG_TND_TNDT, &
    !$ACC&         Z_YDCPG_TND_TNDU, Z_YDCPG_TND_TNDU_NOC, Z_YDCPG_TND_TNDV, &
    !$ACC&         Z_YDCPG_TND_TNDV_NOC, Z_YDVARS_DIV_T0, Z_YDVARS_GEOMETRY_GNORDL_T0, &
    !$ACC&         Z_YDVARS_GEOMETRY_GNORDM_T0, Z_YDVARS_GEOMETRY_OROG_T0, &
    !$ACC&         Z_YDVARS_GEOMETRY_RCORI_T0, Z_YDVARS_SGRTL_T0, Z_YDVARS_SGRTL_T9, &
    !$ACC&         Z_YDVARS_SGRTM_T0, Z_YDVARS_SGRTM_T9, Z_YDVARS_T_T0, Z_YDVARS_U_T0, &
    !$ACC&         Z_YDVARS_V_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGREUSE) THEN
        Z_YDCPG_DYN0_PHI (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
        CALL GPGEO_EXPL_OPENACC (YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
        & YDGEOMETRY%YRDIMV%NFLEVG, Z_YDCPG_DYN0_PHI(:,:, JBLK), Z_YDCPG_DYN0_PHIF(:,:, JBLK)&
        &, Z_YDVARS_T_T0(:,:, JBLK), Z_YDCPG_DYN0_RCP_R(:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:&
        &, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), YDGEOMETRY%YRVERT_GEOM,YDSTACK=YLSTACK)
        CALL GPGRGEO_EXPL_OPENACC (YDGEOMETRY, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL(:,:, JBLK), Z_YDCPG_DYN0_RTM(&
        &:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), POROGL=Z_YDCPG_DYN0_OROGL&
        &(:, JBLK), POROGM=Z_YDCPG_DYN0_OROGM(:, JBLK), PHIFL=Z_YDCPG_DYN0_PHIFL(:,:, JBLK), PHIFM=Z_YDCPG_DYN0_PHIFM&
        &(:,:, JBLK), PHIHL=Z_GPHL_T0(:,:, JBLK), PHIHM=Z_GPHM_T0(:,:, JBLK), PLNPRL_DER=Z_XYBDER_LNPRL_T0&
        &(:,:, JBLK), PLNPRM_DER=Z_XYBDER_LNPRM_T0(:,:, JBLK), PALPHL_DER=Z_XYBDER_ALPHL_T0(:,:, JBLK),&
        & PALPHM_DER=Z_XYBDER_ALPHM_T0(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_DYN0_KENE (JROF, JLEV, JBLK)=0.5_JPRB*(Z_YDVARS_U_T0 &
        &(JROF, JLEV, JBLK)**2+Z_YDVARS_V_T0 (JROF, JLEV, JBLK)**2)
      
      ENDDO


      IF (LLUVH) THEN
        CALL GPHLWI_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVFE_COMPATIBLE, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_DYN0_XYB_LNPR(:,:,&
        & JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), YDGEOMETRY%YRVERT_GEOM%YRVETA%VRDETAH, YDGEOMETRY&
        &%YRVERT_GEOM%YRVETA%VDETA_RATIO, Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK),YDSTACK=YLSTACK)
        CALL GPHLUV_EXPL_OPENACC (YDGEOMETRY%YRDIMV, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), PWWI=Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK&
        &), PUH=Z_YDCPG_DYN0_UVH_UH(:,:, JBLK), PVH=Z_YDCPG_DYN0_UVH_VH(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (LLGPXX.OR.YDMODEL%YRML_DYN%YRDYNA%LSLHD) THEN
        CALL GPUVS_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, LLDER, Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0(&
        &:,:, JBLK), Z_US_T0(:, JBLK), Z_VS_T0(:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGFSF) THEN
        CALL GPGRP_EXPL_OPENACC (YDGEOMETRY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_RT_T0(:,:, JBLK), Z_YDCPG_DYN0_RTL&
        &(:,:, JBLK), Z_YDCPG_DYN0_RTM(:,:, JBLK), Z_YDCPG_DYN0_PREL(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK)&
        &, Z_YDCPG_DYN0_XYB_RTGR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH(:,:, JBLK), PHIHL=Z_GPHL_T0(:,:, JBLK)&
        &, PHIHM=Z_GPHM_T0(:,:, JBLK), PHIFL=Z_YDCPG_DYN0_PHIFL(:,:, JBLK), PHIFM=Z_YDCPG_DYN0_PHIFM(:,:,&
        & JBLK), PSGRTL=Z_PSGRTL_T0(:,:, JBLK), PSGRTM=Z_PSGRTM_T0(:,:, JBLK), PALPHPLL_DER=Z_XYBDER_ALPHPLL_T0&
        &(:,:, JBLK), PALPHPLM_DER=Z_XYBDER_ALPHPLM_T0(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF


      IF (YDMODEL%YRML_DYN%YRDYNA%LGRADSP) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_SGRTL_T0 (JROF, JLEV, JBLK)=Z_PSGRTL_T0 (JROF, JLEV, JBLK)-(Z_YDVARS_SGRTL_T9&
          & (JROF, JLEV, JBLK)-Z_YDVARS_SGRTL_T0 (JROF, JLEV, JBLK))
          Z_SGRTM_T0 (JROF, JLEV, JBLK)=Z_PSGRTM_T0 (JROF, JLEV, JBLK)-(Z_YDVARS_SGRTM_T9&
          & (JROF, JLEV, JBLK)-Z_YDVARS_SGRTM_T0 (JROF, JLEV, JBLK))
        
        ENDDO

        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDVARS_SGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, JBLK), Z_PSGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_YDVARS_SGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, JBLK), Z_PSGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_PSGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, JBLK), Z_SGRTL_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JROF, Z_PSGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV&
        &%NFLEVG, JBLK), Z_SGRTM_T0 (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
      ENDIF


      IF (LLGPXX) THEN
        CALL GPXX_OPENACC (YDGEOMETRY, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
        &, YLCPG_BNDS%KFDIA, Z_GPHL_T0(:,:, JBLK), Z_GPHM_T0(:,:, JBLK), Z_YDCPG_DYN0_PHIFL(:,:, JBLK)&
        &, Z_YDCPG_DYN0_PHIFM(:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_RT_T0(:,:, JBLK), Z_YDVARS_U_T0&
        &(:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDCPG_DYN0_UVH_UH(:,:, JBLK), Z_YDCPG_DYN0_UVH_VH(:,&
        &:, JBLK), Z_YDCPG_DYN0_UVH_WWI(:,:, JBLK), Z_NHXT_T0(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDMODEL%YRML_DYN%YRDYNA%L_RDRY_VD) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_DVER_T0 (JROF, JLEV, JBLK)=-(Z_YDCPG_DYN0_RCP_R (JROF, JLEV, JBLK)/YDMODEL%YRCST%RD&
            &)*(Z_YDVARS_DIV_T0 (JROF, JLEV, JBLK)+Z_NHXT_T0 (JROF, JLEV, JBLK)+(1.0_JPRB-Z_YDCPG_DYN0_RCP_KAP&
            & (JROF, JLEV, JBLK))*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK))
          
          ENDDO

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_DVER_T0 (JROF, JLEV, JBLK)=-(Z_YDVARS_DIV_T0 (JROF, JLEV, JBLK)+Z_NHXT_T0 (JROF, JLEV, JBLK)+&
            &(1.0_JPRB-Z_YDCPG_DYN0_RCP_KAP (JROF, JLEV, JBLK))*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK))
          
          ENDDO

        ENDIF

        CALL GPGW_OPENACC (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYNA%LNHDYN, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY&
        &%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, LLGWF0, LLGDWI, Z_YDCPG_DYN0_OROGL(:,&
        & JBLK), Z_YDCPG_DYN0_OROGM(:, JBLK), Z_YDCPG_DYN0_XYB_LNPR(:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH&
        &(:,:, JBLK), Z_US_T0(:, JBLK), Z_VS_T0(:, JBLK), Z_RDT_T0(:,:, JBLK), Z_DVER_T0(:,:, JBLK&
        &), P_GWHT_T0(:,:, JBLK), Z_YDCPG_DYN0_GWFT(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

      CALL GP_TNDLAGADIAB_UV_OPENACC (YDCPG_OPTS%LRPLANE, YDGEOMETRY, YDMODEL%YRML_PHY_EC%YREPHY&
      &, YDMODEL%YRML_DYN%YRDYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_GEOMETRY_RCORI_T0&
      &(:, JBLK), Z_YDVARS_GEOMETRY_GNORDL_T0(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_T0(:, JBLK)&
      &, Z_PSGRTL_T0(:,:, JBLK), Z_PSGRTM_T0(:,:, JBLK), Z_YDVARS_U_T0(:,:, JBLK), Z_YDVARS_V_T0&
      &(:,:, JBLK), Z_YDCPG_TND_TNDU(:,:, JBLK), Z_YDCPG_TND_TNDV(:,:, JBLK), Z_YDCPG_TND_TNDU_NOC&
      &(:,:, JBLK), Z_YDCPG_TND_TNDV_NOC(:,:, JBLK),YDSTACK=YLSTACK)

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_TND_TNDT (JROF, JLEV, JBLK)=Z_YDCPG_DYN0_RCP_KAP (JROF, JLEV, JBLK)*Z_YDVARS_T_T0&
        & (JROF, JLEV, JBLK)*Z_YDCPG_DYN0_CTY_VVEL (JROF, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:2')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
    Z_DVER_T0 => GET_HOST_DATA_RDWR (YL_Z_DVER_T0)
    Z_GPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHL_T0)
    Z_GPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_GPHM_T0)
    Z_NHXT_T0 => GET_HOST_DATA_RDWR (YL_Z_NHXT_T0)
    Z_PSGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTL_T0)
    Z_PSGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_PSGRTM_T0)
    Z_RDT_T0 => GET_HOST_DATA_RDWR (YL_Z_RDT_T0)
    Z_RT_T0 => GET_HOST_DATA_RDWR (YL_Z_RT_T0)
    Z_SGRTL_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTL_T0)
    Z_SGRTM_T0 => GET_HOST_DATA_RDWR (YL_Z_SGRTM_T0)
    Z_US_T0 => GET_HOST_DATA_RDWR (YL_Z_US_T0)
    Z_VS_T0 => GET_HOST_DATA_RDWR (YL_Z_VS_T0)
    Z_XYBDER_ALPHL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHL_T0)
    Z_XYBDER_ALPHM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHM_T0)
    Z_XYBDER_ALPHPLL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLL_T0)
    Z_XYBDER_ALPHPLM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_ALPHPLM_T0)
    Z_XYBDER_LNPRL_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRL_T0)
    Z_XYBDER_LNPRM_T0 => GET_HOST_DATA_RDWR (YL_Z_XYBDER_LNPRM_T0)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_KENE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_KENE)
    Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
    Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
    Z_YDCPG_DYN0_PHI => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHI)
    Z_YDCPG_DYN0_PHIF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIF)
    Z_YDCPG_DYN0_PHIFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFL)
    Z_YDCPG_DYN0_PHIFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PHIFM)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN0_RCP_KAP => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_KAP)
    Z_YDCPG_DYN0_RCP_R => GET_HOST_DATA_RDWR (YDCPG_DYN0%RCP%F_R)
    Z_YDCPG_DYN0_RTL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTL)
    Z_YDCPG_DYN0_RTM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_RTM)
    Z_YDCPG_DYN0_UVH_UH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_UH)
    Z_YDCPG_DYN0_UVH_VH => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_VH)
    Z_YDCPG_DYN0_UVH_WWI => GET_HOST_DATA_RDWR (YDCPG_DYN0%UVH%F_WWI)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RTGR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RTGR)
    Z_YDCPG_TND_TNDT => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDT)
    Z_YDCPG_TND_TNDU => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU)
    Z_YDCPG_TND_TNDU_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDU_NOC)
    Z_YDCPG_TND_TNDV => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV)
    Z_YDCPG_TND_TNDV_NOC => GET_HOST_DATA_RDWR (YDCPG_TND%F_TNDV_NOC)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    Z_YDVARS_SGRTL_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT0)
    Z_YDVARS_SGRTL_T9 => GET_HOST_DATA_RDWR (YDVARS%SGRTL%FT9)
    Z_YDVARS_SGRTM_T0 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT0)
    Z_YDVARS_SGRTM_T9 => GET_HOST_DATA_RDWR (YDVARS%SGRTM%FT9)
    Z_YDVARS_T_T0 => GET_HOST_DATA_RDWR (YDVARS%T%FT0)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => NULL ()
  Z_DVER_T0 => NULL ()
  Z_GPHL_T0 => NULL ()
  Z_GPHM_T0 => NULL ()
  Z_NHXT_T0 => NULL ()
  Z_PSGRTL_T0 => NULL ()
  Z_PSGRTM_T0 => NULL ()
  Z_RDT_T0 => NULL ()
  Z_RT_T0 => NULL ()
  Z_SGRTL_T0 => NULL ()
  Z_SGRTM_T0 => NULL ()
  Z_US_T0 => NULL ()
  Z_VS_T0 => NULL ()
  Z_XYBDER_ALPHL_T0 => NULL ()
  Z_XYBDER_ALPHM_T0 => NULL ()
  Z_XYBDER_ALPHPLL_T0 => NULL ()
  Z_XYBDER_ALPHPLM_T0 => NULL ()
  Z_XYBDER_LNPRL_T0 => NULL ()
  Z_XYBDER_LNPRM_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_KENE => NULL ()
  Z_YDCPG_DYN0_OROGL => NULL ()
  Z_YDCPG_DYN0_OROGM => NULL ()
  Z_YDCPG_DYN0_PHI => NULL ()
  Z_YDCPG_DYN0_PHIF => NULL ()
  Z_YDCPG_DYN0_PHIFL => NULL ()
  Z_YDCPG_DYN0_PHIFM => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN0_RCP_KAP => NULL ()
  Z_YDCPG_DYN0_RCP_R => NULL ()
  Z_YDCPG_DYN0_RTL => NULL ()
  Z_YDCPG_DYN0_RTM => NULL ()
  Z_YDCPG_DYN0_UVH_UH => NULL ()
  Z_YDCPG_DYN0_UVH_VH => NULL ()
  Z_YDCPG_DYN0_UVH_WWI => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RTGR => NULL ()
  Z_YDCPG_TND_TNDT => NULL ()
  Z_YDCPG_TND_TNDU => NULL ()
  Z_YDCPG_TND_TNDU_NOC => NULL ()
  Z_YDCPG_TND_TNDV => NULL ()
  Z_YDCPG_TND_TNDV_NOC => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  Z_YDVARS_SGRTL_T0 => NULL ()
  Z_YDVARS_SGRTL_T9 => NULL ()
  Z_YDVARS_SGRTM_T0 => NULL ()
  Z_YDVARS_SGRTM_T9 => NULL ()
  Z_YDVARS_T_T0 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_HYD_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:2',1,ZHOOK_HANDLE_PARALLEL)

IF (.NOT.YDMODEL%YRML_DYN%YRDYNA%LTWOTL.AND.YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_HYD_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    P_GWHT_T0 (:,:, JBLK)=0.0_JPRB
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:3')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_HYD_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      
      P_GWHT_T0 (JROF,:, JBLK)=0.0_JPRB
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:3')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_HYD_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => GET_DEVICE_DATA_RDWR (YD_P_GWHT_T0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (P_GWHT_T0, YDCPG_OPTS, YFXTRAN_ACDC_STACK) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      
      P_GWHT_T0 (JROF,:, JBLK)=0.0_JPRB
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_HYD_PARALLEL:3')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    P_GWHT_T0 => GET_HOST_DATA_RDWR (YD_P_GWHT_T0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  P_GWHT_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_HYD_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL:3',1,ZHOOK_HANDLE_PARALLEL)




CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_Z_DPHYCTY_T0)) CALL FIELD_DELETE (YL_Z_DPHYCTY_T0)
IF (ASSOCIATED (YL_Z_DVER_T0)) CALL FIELD_DELETE (YL_Z_DVER_T0)
IF (ASSOCIATED (YL_Z_GPHL_T0)) CALL FIELD_DELETE (YL_Z_GPHL_T0)
IF (ASSOCIATED (YL_Z_GPHM_T0)) CALL FIELD_DELETE (YL_Z_GPHM_T0)
IF (ASSOCIATED (YL_Z_NHXT_T0)) CALL FIELD_DELETE (YL_Z_NHXT_T0)
IF (ASSOCIATED (YL_Z_PSGRTL_T0)) CALL FIELD_DELETE (YL_Z_PSGRTL_T0)
IF (ASSOCIATED (YL_Z_PSGRTM_T0)) CALL FIELD_DELETE (YL_Z_PSGRTM_T0)
IF (ASSOCIATED (YL_Z_RDT_T0)) CALL FIELD_DELETE (YL_Z_RDT_T0)
IF (ASSOCIATED (YL_Z_RPREF_T0)) CALL FIELD_DELETE (YL_Z_RPREF_T0)
IF (ASSOCIATED (YL_Z_RT_T0)) CALL FIELD_DELETE (YL_Z_RT_T0)
IF (ASSOCIATED (YL_Z_SGRTL_T0)) CALL FIELD_DELETE (YL_Z_SGRTL_T0)
IF (ASSOCIATED (YL_Z_SGRTM_T0)) CALL FIELD_DELETE (YL_Z_SGRTM_T0)
IF (ASSOCIATED (YL_Z_US_T0)) CALL FIELD_DELETE (YL_Z_US_T0)
IF (ASSOCIATED (YL_Z_VS_T0)) CALL FIELD_DELETE (YL_Z_VS_T0)
IF (ASSOCIATED (YL_Z_XYBDER_ALPHL_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_ALPHL_T0)
IF (ASSOCIATED (YL_Z_XYBDER_ALPHM_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_ALPHM_T0)
IF (ASSOCIATED (YL_Z_XYBDER_ALPHPLL_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_ALPHPLL_T0)
IF (ASSOCIATED (YL_Z_XYBDER_ALPHPLM_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_ALPHPLM_T0)
IF (ASSOCIATED (YL_Z_XYBDER_COEFAPL_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_COEFAPL_T0)
IF (ASSOCIATED (YL_Z_XYBDER_COEFA_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_COEFA_T0)
IF (ASSOCIATED (YL_Z_XYBDER_COEFD_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_COEFD_T0)
IF (ASSOCIATED (YL_Z_XYBDER_LNPRL_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_LNPRL_T0)
IF (ASSOCIATED (YL_Z_XYBDER_LNPRM_T0)) CALL FIELD_DELETE (YL_Z_XYBDER_LNPRM_T0)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('CPG_GP_HYD_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE CPG_GP_HYD_PARALLEL
