MODULE UTIL_MODEL_MOD

USE TYPE_MODEL, ONLY : MODEL

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_MODEL
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_MODEL
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_MODEL
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_MODEL
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_MODEL
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_MODEL
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_MODEL
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_MODEL (SELF, KLUN)
USE UTIL_MODEL_ATMOS_OCEAN_COUPLING_TYPE_MOD
USE UTIL_MODEL_CHEM_TYPE_MOD
USE UTIL_MODEL_DIAGNOSTICS_TYPE_MOD
USE UTIL_MODEL_DYNAMICS_TYPE_MOD
USE UTIL_MODEL_GENERAL_CONF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_AEROSOL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_ECMWF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_GENERAL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_MF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_RADIATION_TYPE_MOD
USE UTIL_MODEL_PHYSICS_SIMPLINEAR_TYPE_MOD
USE UTIL_MODEL_PHYSICS_STOCHAST_TYPE_MOD
USE UTIL_TCST_MOD
USE UTIL_TELBC_MODEL_MOD
USE UTIL_TEWCOU_MOD
IMPLICIT NONE
TYPE (MODEL), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRCST
WRITE (KLUN) SELF%LINEAR_MODEL
CALL ACDC_SAVE_MODEL_GENERAL_CONF_TYPE (SELF%YRML_GCONF, KLUN)
CALL ACDC_SAVE_MODEL_ATMOS_OCEAN_COUPLING_TYPE (SELF%YRML_AOC, KLUN)
CALL ACDC_SAVE_MODEL_DYNAMICS_TYPE (SELF%YRML_DYN, KLUN)
CALL ACDC_SAVE_MODEL_PHYSICS_GENERAL_TYPE (SELF%YRML_PHY_G, KLUN)
CALL ACDC_SAVE_MODEL_PHYSICS_ECMWF_TYPE (SELF%YRML_PHY_EC, KLUN)
CALL ACDC_SAVE_MODEL_PHYSICS_SIMPLINEAR_TYPE (SELF%YRML_PHY_SLIN, KLUN)
CALL ACDC_SAVE_MODEL_PHYSICS_AEROSOL_TYPE (SELF%YRML_PHY_AER, KLUN)
CALL ACDC_SAVE_MODEL_PHYSICS_RADIATION_TYPE (SELF%YRML_PHY_RAD, KLUN)
CALL ACDC_SAVE_MODEL_PHYSICS_STOCHAST_TYPE (SELF%YRML_PHY_STOCH, KLUN)
CALL ACDC_SAVE_MODEL_PHYSICS_MF_TYPE (SELF%YRML_PHY_MF, KLUN)
CALL ACDC_SAVE_MODEL_CHEM_TYPE (SELF%YRML_CHEM, KLUN)
CALL ACDC_SAVE_MODEL_DIAGNOSTICS_TYPE (SELF%YRML_DIAG, KLUN)
CALL ACDC_SAVE_TEWCOU (SELF%YREWCOU, KLUN)
LYRCST = ASSOCIATED (SELF%YRCST)
WRITE (KLUN) LYRCST
IF (LYRCST) THEN
  CALL ACDC_SAVE_TCST (SELF%YRCST, KLUN)
ENDIF
CALL ACDC_SAVE_TELBC_MODEL (SELF%YRML_LBC, KLUN)
WRITE (KLUN) SELF%MOBJECT_ID
WRITE (KLUN) SELF%COBJECT_ID
END SUBROUTINE

SUBROUTINE ACDC_LOAD_MODEL (SELF, KLUN)
USE UTIL_MODEL_ATMOS_OCEAN_COUPLING_TYPE_MOD
USE UTIL_MODEL_CHEM_TYPE_MOD
USE UTIL_MODEL_DIAGNOSTICS_TYPE_MOD
USE UTIL_MODEL_DYNAMICS_TYPE_MOD
USE UTIL_MODEL_GENERAL_CONF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_AEROSOL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_ECMWF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_GENERAL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_MF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_RADIATION_TYPE_MOD
USE UTIL_MODEL_PHYSICS_SIMPLINEAR_TYPE_MOD
USE UTIL_MODEL_PHYSICS_STOCHAST_TYPE_MOD
USE UTIL_TCST_MOD
USE UTIL_TELBC_MODEL_MOD
USE UTIL_TEWCOU_MOD
IMPLICIT NONE
TYPE (MODEL), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRCST
READ (KLUN) SELF%LINEAR_MODEL
CALL ACDC_LOAD_MODEL_GENERAL_CONF_TYPE (SELF%YRML_GCONF, KLUN)
CALL ACDC_LOAD_MODEL_ATMOS_OCEAN_COUPLING_TYPE (SELF%YRML_AOC, KLUN)
CALL ACDC_LOAD_MODEL_DYNAMICS_TYPE (SELF%YRML_DYN, KLUN)
CALL ACDC_LOAD_MODEL_PHYSICS_GENERAL_TYPE (SELF%YRML_PHY_G, KLUN)
CALL ACDC_LOAD_MODEL_PHYSICS_ECMWF_TYPE (SELF%YRML_PHY_EC, KLUN)
CALL ACDC_LOAD_MODEL_PHYSICS_SIMPLINEAR_TYPE (SELF%YRML_PHY_SLIN, KLUN)
CALL ACDC_LOAD_MODEL_PHYSICS_AEROSOL_TYPE (SELF%YRML_PHY_AER, KLUN)
CALL ACDC_LOAD_MODEL_PHYSICS_RADIATION_TYPE (SELF%YRML_PHY_RAD, KLUN)
CALL ACDC_LOAD_MODEL_PHYSICS_STOCHAST_TYPE (SELF%YRML_PHY_STOCH, KLUN)
CALL ACDC_LOAD_MODEL_PHYSICS_MF_TYPE (SELF%YRML_PHY_MF, KLUN)
CALL ACDC_LOAD_MODEL_CHEM_TYPE (SELF%YRML_CHEM, KLUN)
CALL ACDC_LOAD_MODEL_DIAGNOSTICS_TYPE (SELF%YRML_DIAG, KLUN)
CALL ACDC_LOAD_TEWCOU (SELF%YREWCOU, KLUN)
READ (KLUN) LYRCST
IF (LYRCST) THEN
  ALLOCATE (SELF%YRCST)
  CALL ACDC_LOAD_TCST (SELF%YRCST, KLUN)
ELSE
  NULLIFY (SELF%YRCST)
ENDIF
CALL ACDC_LOAD_TELBC_MODEL (SELF%YRML_LBC, KLUN)
READ (KLUN) SELF%MOBJECT_ID
READ (KLUN) SELF%COBJECT_ID
END SUBROUTINE

SUBROUTINE ACDC_COPY_MODEL (SELF, LDCREATED, LDFIELDAPI)
USE UTIL_MODEL_ATMOS_OCEAN_COUPLING_TYPE_MOD
USE UTIL_MODEL_CHEM_TYPE_MOD
USE UTIL_MODEL_DIAGNOSTICS_TYPE_MOD
USE UTIL_MODEL_DYNAMICS_TYPE_MOD
USE UTIL_MODEL_GENERAL_CONF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_AEROSOL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_ECMWF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_GENERAL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_MF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_RADIATION_TYPE_MOD
USE UTIL_MODEL_PHYSICS_SIMPLINEAR_TYPE_MOD
USE UTIL_MODEL_PHYSICS_STOCHAST_TYPE_MOD
USE UTIL_TCST_MOD
USE UTIL_TELBC_MODEL_MOD
USE UTIL_TEWCOU_MOD
IMPLICIT NONE
TYPE (MODEL), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LYRCST
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

CALL ACDC_COPY_MODEL_GENERAL_CONF_TYPE (SELF%YRML_GCONF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_ATMOS_OCEAN_COUPLING_TYPE (SELF%YRML_AOC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_DYNAMICS_TYPE (SELF%YRML_DYN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_PHYSICS_GENERAL_TYPE (SELF%YRML_PHY_G, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_PHYSICS_ECMWF_TYPE (SELF%YRML_PHY_EC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_PHYSICS_SIMPLINEAR_TYPE (SELF%YRML_PHY_SLIN, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_PHYSICS_AEROSOL_TYPE (SELF%YRML_PHY_AER, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_PHYSICS_RADIATION_TYPE (SELF%YRML_PHY_RAD, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_PHYSICS_STOCHAST_TYPE (SELF%YRML_PHY_STOCH, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_PHYSICS_MF_TYPE (SELF%YRML_PHY_MF, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_CHEM_TYPE (SELF%YRML_CHEM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_MODEL_DIAGNOSTICS_TYPE (SELF%YRML_DIAG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TEWCOU (SELF%YREWCOU, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LYRCST = ASSOCIATED (SELF%YRCST)
IF (LYRCST) THEN
  !$ACC ENTER DATA CREATE (SELF%YRCST)
  !$ACC UPDATE DEVICE (SELF%YRCST)
  CALL ACDC_COPY_TCST (SELF%YRCST, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YRCST)
ENDIF

CALL ACDC_COPY_TELBC_MODEL (SELF%YRML_LBC, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

END SUBROUTINE

SUBROUTINE ACDC_HOST_MODEL (SELF)
USE UTIL_MODEL_ATMOS_OCEAN_COUPLING_TYPE_MOD
USE UTIL_MODEL_CHEM_TYPE_MOD
USE UTIL_MODEL_DIAGNOSTICS_TYPE_MOD
USE UTIL_MODEL_DYNAMICS_TYPE_MOD
USE UTIL_MODEL_GENERAL_CONF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_AEROSOL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_ECMWF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_GENERAL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_MF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_RADIATION_TYPE_MOD
USE UTIL_MODEL_PHYSICS_SIMPLINEAR_TYPE_MOD
USE UTIL_MODEL_PHYSICS_STOCHAST_TYPE_MOD
USE UTIL_TCST_MOD
USE UTIL_TELBC_MODEL_MOD
USE UTIL_TEWCOU_MOD
IMPLICIT NONE
TYPE (MODEL), TARGET :: SELF
LOGICAL :: LYRCST

CALL ACDC_HOST_MODEL_GENERAL_CONF_TYPE (SELF%YRML_GCONF)

CALL ACDC_HOST_MODEL_ATMOS_OCEAN_COUPLING_TYPE (SELF%YRML_AOC)

CALL ACDC_HOST_MODEL_DYNAMICS_TYPE (SELF%YRML_DYN)

CALL ACDC_HOST_MODEL_PHYSICS_GENERAL_TYPE (SELF%YRML_PHY_G)

CALL ACDC_HOST_MODEL_PHYSICS_ECMWF_TYPE (SELF%YRML_PHY_EC)

CALL ACDC_HOST_MODEL_PHYSICS_SIMPLINEAR_TYPE (SELF%YRML_PHY_SLIN)

CALL ACDC_HOST_MODEL_PHYSICS_AEROSOL_TYPE (SELF%YRML_PHY_AER)

CALL ACDC_HOST_MODEL_PHYSICS_RADIATION_TYPE (SELF%YRML_PHY_RAD)

CALL ACDC_HOST_MODEL_PHYSICS_STOCHAST_TYPE (SELF%YRML_PHY_STOCH)

CALL ACDC_HOST_MODEL_PHYSICS_MF_TYPE (SELF%YRML_PHY_MF)

CALL ACDC_HOST_MODEL_CHEM_TYPE (SELF%YRML_CHEM)

CALL ACDC_HOST_MODEL_DIAGNOSTICS_TYPE (SELF%YRML_DIAG)

CALL ACDC_HOST_TEWCOU (SELF%YREWCOU)

LYRCST = ASSOCIATED (SELF%YRCST)
IF (LYRCST) THEN
  CALL ACDC_HOST_TCST (SELF%YRCST)
ENDIF

CALL ACDC_HOST_TELBC_MODEL (SELF%YRML_LBC)

END SUBROUTINE



SUBROUTINE ACDC_CRC64_MODEL (SELF, KLUN, CDPATH)
USE UTIL_MODEL_ATMOS_OCEAN_COUPLING_TYPE_MOD
USE UTIL_MODEL_CHEM_TYPE_MOD
USE UTIL_MODEL_DIAGNOSTICS_TYPE_MOD
USE UTIL_MODEL_DYNAMICS_TYPE_MOD
USE UTIL_MODEL_GENERAL_CONF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_AEROSOL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_ECMWF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_GENERAL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_MF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_RADIATION_TYPE_MOD
USE UTIL_MODEL_PHYSICS_SIMPLINEAR_TYPE_MOD
USE UTIL_MODEL_PHYSICS_STOCHAST_TYPE_MOD
USE UTIL_TCST_MOD
USE UTIL_TELBC_MODEL_MOD
USE UTIL_TEWCOU_MOD
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (MODEL), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LYRCST
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LINEAR_MODEL), CDPATH//'%LINEAR_MODEL'

CLIND = ''
CALL ACDC_CRC64_MODEL_GENERAL_CONF_TYPE (SELF%YRML_GCONF, KLUN, CDPATH//'%YRML_GCONF'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_ATMOS_OCEAN_COUPLING_TYPE (SELF%YRML_AOC, KLUN, CDPATH//'%YRML_AOC'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_DYNAMICS_TYPE (SELF%YRML_DYN, KLUN, CDPATH//'%YRML_DYN'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_PHYSICS_GENERAL_TYPE (SELF%YRML_PHY_G, KLUN, CDPATH//'%YRML_PHY_G'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_PHYSICS_ECMWF_TYPE (SELF%YRML_PHY_EC, KLUN, CDPATH//'%YRML_PHY_EC'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_PHYSICS_SIMPLINEAR_TYPE (SELF%YRML_PHY_SLIN, KLUN, CDPATH//'%YRML_PHY_SLIN'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_PHYSICS_AEROSOL_TYPE (SELF%YRML_PHY_AER, KLUN, CDPATH//'%YRML_PHY_AER'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_PHYSICS_RADIATION_TYPE (SELF%YRML_PHY_RAD, KLUN, CDPATH//'%YRML_PHY_RAD'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_PHYSICS_STOCHAST_TYPE (SELF%YRML_PHY_STOCH, KLUN, CDPATH//'%YRML_PHY_STOCH'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_PHYSICS_MF_TYPE (SELF%YRML_PHY_MF, KLUN, CDPATH//'%YRML_PHY_MF'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_CHEM_TYPE (SELF%YRML_CHEM, KLUN, CDPATH//'%YRML_CHEM'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_MODEL_DIAGNOSTICS_TYPE (SELF%YRML_DIAG, KLUN, CDPATH//'%YRML_DIAG'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TEWCOU (SELF%YREWCOU, KLUN, CDPATH//'%YREWCOU'//TRIM(CLIND))

LYRCST = ASSOCIATED (SELF%YRCST)
IF (LYRCST) THEN
  CLIND = ''
  CALL ACDC_CRC64_TCST (SELF%YRCST, KLUN, CDPATH//'%YRCST'//TRIM(CLIND))
ENDIF

CLIND = ''
CALL ACDC_CRC64_TELBC_MODEL (SELF%YRML_LBC, KLUN, CDPATH//'%YRML_LBC'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MOBJECT_ID), CDPATH//'%MOBJECT_ID'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%COBJECT_ID), CDPATH//'%COBJECT_ID'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_MODEL (SELF, LDDELETED, LDFIELDAPI)
USE UTIL_MODEL_ATMOS_OCEAN_COUPLING_TYPE_MOD
USE UTIL_MODEL_CHEM_TYPE_MOD
USE UTIL_MODEL_DIAGNOSTICS_TYPE_MOD
USE UTIL_MODEL_DYNAMICS_TYPE_MOD
USE UTIL_MODEL_GENERAL_CONF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_AEROSOL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_ECMWF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_GENERAL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_MF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_RADIATION_TYPE_MOD
USE UTIL_MODEL_PHYSICS_SIMPLINEAR_TYPE_MOD
USE UTIL_MODEL_PHYSICS_STOCHAST_TYPE_MOD
USE UTIL_TCST_MOD
USE UTIL_TELBC_MODEL_MOD
USE UTIL_TEWCOU_MOD
IMPLICIT NONE
TYPE (MODEL), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LYRCST
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

CALL ACDC_WIPE_MODEL_GENERAL_CONF_TYPE (SELF%YRML_GCONF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_ATMOS_OCEAN_COUPLING_TYPE (SELF%YRML_AOC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_DYNAMICS_TYPE (SELF%YRML_DYN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_PHYSICS_GENERAL_TYPE (SELF%YRML_PHY_G, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_PHYSICS_ECMWF_TYPE (SELF%YRML_PHY_EC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_PHYSICS_SIMPLINEAR_TYPE (SELF%YRML_PHY_SLIN, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_PHYSICS_AEROSOL_TYPE (SELF%YRML_PHY_AER, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_PHYSICS_RADIATION_TYPE (SELF%YRML_PHY_RAD, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_PHYSICS_STOCHAST_TYPE (SELF%YRML_PHY_STOCH, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_PHYSICS_MF_TYPE (SELF%YRML_PHY_MF, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_CHEM_TYPE (SELF%YRML_CHEM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_MODEL_DIAGNOSTICS_TYPE (SELF%YRML_DIAG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TEWCOU (SELF%YREWCOU, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LYRCST = ASSOCIATED (SELF%YRCST)
IF (LYRCST) THEN
  !$ACC EXIT DATA DETACH (SELF%YRCST)
  CALL ACDC_WIPE_TCST (SELF%YRCST, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DELETE (SELF%YRCST)
ENDIF

CALL ACDC_WIPE_TELBC_MODEL (SELF%YRML_LBC, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_MODEL (SELF, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_MODEL_ATMOS_OCEAN_COUPLING_TYPE_MOD
USE UTIL_MODEL_CHEM_TYPE_MOD
USE UTIL_MODEL_DIAGNOSTICS_TYPE_MOD
USE UTIL_MODEL_DYNAMICS_TYPE_MOD
USE UTIL_MODEL_GENERAL_CONF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_AEROSOL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_ECMWF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_GENERAL_TYPE_MOD
USE UTIL_MODEL_PHYSICS_MF_TYPE_MOD
USE UTIL_MODEL_PHYSICS_RADIATION_TYPE_MOD
USE UTIL_MODEL_PHYSICS_SIMPLINEAR_TYPE_MOD
USE UTIL_MODEL_PHYSICS_STOCHAST_TYPE_MOD
USE UTIL_TCST_MOD
USE UTIL_TELBC_MODEL_MOD
USE UTIL_TEWCOU_MOD
IMPLICIT NONE
TYPE (MODEL),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LYRCST
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%LINEAR_MODEL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LINEAR_MODEL'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_GENERAL_CONF_TYPE (SELF%YRML_GCONF, CLPATH//'%YRML_GCONF', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_GCONF'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_ATMOS_OCEAN_COUPLING_TYPE (SELF%YRML_AOC, CLPATH//'%YRML_AOC', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_AOC'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_DYNAMICS_TYPE (SELF%YRML_DYN, CLPATH//'%YRML_DYN', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_DYN'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_PHYSICS_GENERAL_TYPE (SELF%YRML_PHY_G, CLPATH//'%YRML_PHY_G', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_PHY_G'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_PHYSICS_ECMWF_TYPE (SELF%YRML_PHY_EC, CLPATH//'%YRML_PHY_EC', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_PHY_EC'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_PHYSICS_SIMPLINEAR_TYPE (SELF%YRML_PHY_SLIN, CLPATH//'%YRML_PHY_SLIN', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_PHY_SLIN'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_PHYSICS_AEROSOL_TYPE (SELF%YRML_PHY_AER, CLPATH//'%YRML_PHY_AER', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_PHY_AER'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_PHYSICS_RADIATION_TYPE (SELF%YRML_PHY_RAD, CLPATH//'%YRML_PHY_RAD', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_PHY_RAD'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_PHYSICS_STOCHAST_TYPE (SELF%YRML_PHY_STOCH, CLPATH//'%YRML_PHY_STOCH', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_PHY_STOCH'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_PHYSICS_MF_TYPE (SELF%YRML_PHY_MF, CLPATH//'%YRML_PHY_MF', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_PHY_MF'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_CHEM_TYPE (SELF%YRML_CHEM, CLPATH//'%YRML_CHEM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_CHEM'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_MODEL_DIAGNOSTICS_TYPE (SELF%YRML_DIAG, CLPATH//'%YRML_DIAG', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_DIAG'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TEWCOU (SELF%YREWCOU, CLPATH//'%YREWCOU', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREWCOU'
ENDIF
LYRCST = ASSOCIATED (SELF%YRCST)
IF (LYRCST) THEN
  JSIZE = 0
  ISIZE = ACDC_SIZE_TCST (SELF%YRCST, CLPATH//'%YRCST', .FALSE.)
  JSIZE = JSIZE + ISIZE
  KSIZE = KSIZE + ISIZE
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
    WRITE (*, *) TRIM (CLPATH)//'%YRCST'
  ENDIF
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TELBC_MODEL (SELF%YRML_LBC, CLPATH//'%YRML_LBC', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRML_LBC'
ENDIF
ISIZE = KIND (SELF%MOBJECT_ID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MOBJECT_ID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%COBJECT_ID) * LEN (SELF%COBJECT_ID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%COBJECT_ID'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
