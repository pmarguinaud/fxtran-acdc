SUBMODULE (YOMLAP) YOMLAP_TLAP_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TLAP (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TLAP), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LMYMS, LNASM0, LNASM0G, LNASN0, LNSE0L, LNSPZERO, LNVALUE, LRLAPDI, LRLAPIN
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LNASN0 = ALLOCATED (SELF%NASN0)
IF (LNASN0) THEN
  !$ACC EXIT DATA DETACH (SELF%NASN0)
  !$ACC EXIT DATA DELETE (SELF%NASN0)
ENDIF

LNASM0 = ALLOCATED (SELF%NASM0)
IF (LNASM0) THEN
  !$ACC EXIT DATA DETACH (SELF%NASM0)
  !$ACC EXIT DATA DELETE (SELF%NASM0)
ENDIF

LNASM0G = ALLOCATED (SELF%NASM0G)
IF (LNASM0G) THEN
  !$ACC EXIT DATA DETACH (SELF%NASM0G)
  !$ACC EXIT DATA DELETE (SELF%NASM0G)
ENDIF

LNVALUE = ALLOCATED (SELF%NVALUE)
IF (LNVALUE) THEN
  !$ACC EXIT DATA DETACH (SELF%NVALUE)
  !$ACC EXIT DATA DELETE (SELF%NVALUE)
ENDIF

LMYMS = ALLOCATED (SELF%MYMS)
IF (LMYMS) THEN
  !$ACC EXIT DATA DETACH (SELF%MYMS)
  !$ACC EXIT DATA DELETE (SELF%MYMS)
ENDIF

LNSPZERO = ALLOCATED (SELF%NSPZERO)
IF (LNSPZERO) THEN
  !$ACC EXIT DATA DETACH (SELF%NSPZERO)
  !$ACC EXIT DATA DELETE (SELF%NSPZERO)
ENDIF

LNSE0L = ALLOCATED (SELF%NSE0L)
IF (LNSE0L) THEN
  !$ACC EXIT DATA DETACH (SELF%NSE0L)
  !$ACC EXIT DATA DELETE (SELF%NSE0L)
ENDIF

LRLAPDI = ALLOCATED (SELF%RLAPDI)
IF (LRLAPDI) THEN
  !$ACC EXIT DATA DETACH (SELF%RLAPDI)
  !$ACC EXIT DATA DELETE (SELF%RLAPDI)
ENDIF

LRLAPIN = ALLOCATED (SELF%RLAPIN)
IF (LRLAPIN) THEN
  !$ACC EXIT DATA DETACH (SELF%RLAPIN)
  !$ACC EXIT DATA DELETE (SELF%RLAPIN)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
