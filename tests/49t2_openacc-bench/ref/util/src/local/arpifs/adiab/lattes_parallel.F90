SUBROUTINE LATTES_PARALLEL (YDCST, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDVARS&
&, YDCPG_SL1, YDCPG_SL2, YDRIP, YDML_DYN, PDTS2, YD_PBDT, PESGP, PESGM, YD_POROGL&
&, YD_POROGM, YD_PSDIV0, YD_PSDIV9, YD_PSDVBC, YD_PRES0, YD_PMIXNL)
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE

USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE YOMCST,ONLY:TCST
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1B_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE YOMRIP,ONLY:TRIP
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (CPG_SL1B_TYPE), INTENT (INOUT)::YDCPG_SL1
TYPE (CPG_SL2_TYPE), INTENT (INOUT)::YDCPG_SL2
TYPE (TRIP), INTENT (IN)::YDRIP
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
REAL (KIND=JPRB), INTENT (IN)::PDTS2
CLASS (FIELD_2RB), POINTER :: YD_PBDT
REAL (KIND=JPRB), POINTER::PBDT (:,:)
REAL (KIND=JPRB), INTENT (IN)::PESGP
REAL (KIND=JPRB), INTENT (IN)::PESGM
CLASS (FIELD_2RB), POINTER :: YD_POROGL
REAL (KIND=JPRB), POINTER::POROGL (:,:)
CLASS (FIELD_2RB), POINTER :: YD_POROGM
REAL (KIND=JPRB), POINTER::POROGM (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSDIV0
REAL (KIND=JPRB), POINTER::PSDIV0 (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSDIV9
REAL (KIND=JPRB), POINTER::PSDIV9 (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSDVBC
REAL (KIND=JPRB), POINTER::PSDVBC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PRES0
REAL (KIND=JPRB), POINTER::PRES0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMIXNL
REAL (KIND=JPRB), POINTER::PMIXNL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMOY1SP
REAL (KIND=JPRB), POINTER::ZMOY1SP (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZMOYSPNL
REAL (KIND=JPRB), POINTER::ZMOYSPNL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSPNLT0
REAL (KIND=JPRB), POINTER::ZSPNLT0 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSPNLT1
REAL (KIND=JPRB), POINTER::ZSPNLT1 (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSPNLT_FE
REAL (KIND=JPRB), POINTER::ZSPNLT_FE (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSPTB
REAL (KIND=JPRB), POINTER::ZSPTB (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSPT1
REAL (KIND=JPRB), POINTER::ZSPT1 (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVWEI
REAL (KIND=JPRB), POINTER::ZVWEI (:,:,:)
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZXIGP
REAL (KIND=JPRB)::ZCMSLP
REAL (KIND=JPRB)::ZXIDT9
REAL (KIND=JPRB)::ZXIDT0
REAL (KIND=JPRB)::ZMIXNL
REAL (KIND=JPRB)::ZSETTLS
REAL (KIND=JPRB)::ZNESC
LOGICAL::LLCTC
LOGICAL::LLCT
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
#include "verdisint.intfb.h"
#include "abor1.intfb.h"
#include "verdisint_openacc.intfb.h"
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_C9_NL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_C9_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_SP9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_SPSI(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CSPNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROG_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPNL_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DL(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DM(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_T1(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_T9(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:,:,:)
IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZVWEI, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPTB, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPNLT_FE, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&+1, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPNLT1, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPNLT0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMOYSPNL, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMOY1SP, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)



LLCT=YDML_DYN%YRDYNA%LPC_FULL.AND.YDML_DYN%YRDYN%NCURRENT_ITER>0
LLCTC=YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER>0
ZXIDT0=1.0_JPRB+YDML_DYN%YRDYN%XIDT
ZXIDT9=1.0_JPRB+YDML_DYN%YRDYN%XIDT
ZXIGP=1.0_JPRB+YDML_DYN%YRDYN%XIDT
ZCMSLP=YDML_DYN%YRDYN%RCMSLP0/(YDCST%RD*YDCPG_OPTS%RTSUR)
IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LATTES_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => GET_HOST_DATA_RDONLY (YD_PBDT)
  PMIXNL => GET_HOST_DATA_RDONLY (YD_PMIXNL)
  POROGL => GET_HOST_DATA_RDONLY (YD_POROGL)
  POROGM => GET_HOST_DATA_RDONLY (YD_POROGM)
  PRES0 => GET_HOST_DATA_RDONLY (YD_PRES0)
  PSDIV0 => GET_HOST_DATA_RDONLY (YD_PSDIV0)
  PSDIV9 => GET_HOST_DATA_RDONLY (YD_PSDIV9)
  PSDVBC => GET_HOST_DATA_RDONLY (YD_PSDVBC)
  ZMOY1SP => GET_HOST_DATA_RDWR (YL_ZMOY1SP)
  ZMOYSPNL => GET_HOST_DATA_RDWR (YL_ZMOYSPNL)
  ZSPNLT0 => GET_HOST_DATA_RDWR (YL_ZSPNLT0)
  ZSPNLT1 => GET_HOST_DATA_RDWR (YL_ZSPNLT1)
  ZSPNLT_FE => GET_HOST_DATA_RDWR (YL_ZSPNLT_FE)
  ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
  ZSPTB => GET_HOST_DATA_RDWR (YL_ZSPTB)
  ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
  Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
  Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
  Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
  Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
  Z_YDVARS_CSPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPNL%FT9)
  Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_SPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPNL%FT9)
  Z_YDVARS_SP_DL => GET_HOST_DATA_RDONLY (YDVARS%SP%FDL)
  Z_YDVARS_SP_DM => GET_HOST_DATA_RDONLY (YDVARS%SP%FDM)
  Z_YDVARS_SP_T0 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT0)
  Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
  Z_YDVARS_SP_T9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT9)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, ZMIXNL, ZNESC, ZSETTLS) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZSPTB (JROF, JBLK)=PSDVBC (JROF, YDGEOMETRY%YRDIMV%NFLEVG&
      &, JBLK)/PRES0 (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
    ENDDO


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
      ZVWEI (:, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
    ENDDO


    DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      Z_YDCPG_SL2_SPSI (JROF, JBLK)=PBDT (JROF, JBLK)*PSDIV0 (JROF, JBLK)
      ZSPTB (JROF, JBLK)=-PDTS2*ZSPTB (JROF, JBLK)
    ENDDO


    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZMOY1SP (JROF, JLEV, JBLK)=PDTS2*(Z_YDVARS_U_T0 (JROF, JLEV, JBLK)*(Z_YDVARS_SP_DL&
        & (JROF, JBLK)+ZCMSLP*POROGL (JROF, JBLK))+Z_YDVARS_V_T0 (JROF, JLEV, JBLK&
        &)*(Z_YDVARS_SP_DM (JROF, JBLK)+ZCMSLP*POROGM (JROF, JBLK)))
      ENDDO


      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZMOY1SP (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZSPTB (JROF, JBLK)
      ENDDO

    ENDDO


    IF (YDML_DYN%YRDYNA%LTWOTL) THEN

      IF (.NOT.LLCT) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZSPNLT0 (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT0*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          ENDDO


          IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN

            IF (YDCPG_OPTS%NSTEP<=YDRIP%NFOST.OR.YDML_DYN%YRDYNA%LNESC) THEN

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF&
                &, JLEV, JBLK)+PESGM*ZMOY1SP (JROF, JLEV, JBLK)
              ENDDO


              IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT0 (JROF, JBLK)*ZVWEI (JROF, JLEV&
                  &, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
                ENDDO

              ELSE

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
                  &+PESGP*ZVWEI (JROF, JLEV, JBLK)*ZSPNLT0 (JROF, JBLK)
                ENDDO

              ENDIF

            ELSEIF (YDML_DYN%YRDYNA%LSETTLS) THEN

              IF (YDML_DYN%YRDYNA%LPC_CHEAP) THEN

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  ZNESC=PESGM*ZMOY1SP (JROF, JLEV, JBLK)
                  ZSETTLS=ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)
                  ZMIXNL=PMIXNL (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+ZNESC
                  Z_YDCPG_SL1_C9_NL_P (JROF, JLEV, JBLK)=ZMIXNL*ZSETTLS
                ENDDO

              ELSE

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  ZNESC=PESGM*ZMOY1SP (JROF, JLEV, JBLK)
                  ZSETTLS=ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)
                  ZMIXNL=PMIXNL (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+ZNESC+ZMIXNL*ZSETTLS
                ENDDO

              ENDIF


              IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT0 (JROF, JBLK)*PESGP*ZVWEI (JROF&
                  &, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)
                ENDDO

              ELSE

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
                  &+PESGP*ZVWEI (JROF, JLEV, JBLK)*ZSPNLT0 (JROF, JBLK)
                ENDDO

              ENDIF

            ELSE

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM*ZMOY1SP (JROF&
                &, JLEV, JBLK)+0.5_JPRB*PESGM*(ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK))
              ENDDO


              IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  ZSPNLT_FE (JROF, JLEV, JBLK)=(1.5_JPRB*ZSPNLT0 (JROF, JBLK)-0.5_JPRB*Z_YDVARS_SPNL_T9 (JROF, JLEV&
                  &, JBLK))*ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
                ENDDO

              ELSE

                DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+PESGP*ZVWEI (JROF, JLEV, JBLK&
                  &)*(1.5_JPRB*ZSPNLT0 (JROF, JBLK)-0.5_JPRB*Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK))
                ENDDO

              ENDIF

            ENDIF

          ENDIF


          IF (YDML_DYN%YRDYNA%LPC_FULL) THEN
            Z_YDVARS_CSPNL_T9 (:, JLEV, JBLK)=ZMOY1SP (:, JLEV, JBLK)
          ENDIF


          IF (.NOT.YDML_DYN%YRDYNA%LNESC) THEN

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT9*Z_YDCPG_SL2_SPSI (JROF, JBLK)
            ENDDO

          ENDIF

        ENDDO


        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN
            ZSPNLT_FE (:, 0, JBLK)=0.0_JPRB
            ZSPNLT_FE (:, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
            CALL VERDISINT (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
            &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
            & YDGEOMETRY%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK))

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
            ENDDO

          ENDIF

        ENDIF


        IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T0&
            & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK&
            &)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          ENDDO

        ENDIF

      ELSE

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZSPNLT1 (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT9*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          ENDDO


          IF (.NOT.LLCTC) THEN

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF,&
              & JLEV, JBLK)+PESGM*Z_YDVARS_CSPNL_T9 (JROF, JLEV, JBLK)
            ENDDO

          ENDIF


          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT1 (JROF, JBLK)*ZVWEI (JROF, JLEV&
              &, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
            ENDDO

          ELSE

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
              &+ZVWEI (JROF, JLEV, JBLK)*ZSPNLT1 (JROF, JBLK)*PESGP
            ENDDO

          ENDIF

        ENDDO


        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
          ZSPNLT_FE (:, 0, JBLK)=0.0_JPRB
          ZSPNLT_FE (:, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
          CALL VERDISINT (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
          &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
          & YDGEOMETRY%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK))

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
          ENDDO

        ENDIF


        IF (.NOT.LLCTC) THEN

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T9&
            & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          ENDDO

        ENDIF


        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK&
          &)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
        ENDDO

      ENDIF


      IF (YDML_DYN%YRDYN%XIDT>0.0_JPRB) THEN

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-ZXIGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=ZXIGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        ENDDO

      ELSE

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        ENDDO

      ENDIF

    ELSE

      IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN

        IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZMOYSPNL (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+Z_YDCPG_SL2_SPSI (JROF, JBLK)
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM&
              &*ZMOYSPNL (JROF, JBLK)-PESGM*PBDT (JROF, JBLK)*PSDIV9 (JROF, JBLK)
              ZSPNLT_FE (JROF, JLEV, JBLK)=PESGP*ZVWEI (JROF, JLEV, JBLK)*ZMOYSPNL (JROF, JBLK)
            ENDDO

          ENDDO

          ZSPNLT_FE (:, 0, JBLK)=0.0_JPRB
          ZSPNLT_FE (:, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
          CALL VERDISINT (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
          &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
          & YDGEOMETRY%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK))

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
          ENDDO

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZMOYSPNL (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+Z_YDCPG_SL2_SPSI (JROF, JBLK)
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM&
              &*ZMOYSPNL (JROF, JBLK)-PESGM*PBDT (JROF, JBLK)*PSDIV9 (JROF, JBLK)
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+PESGP&
              &*ZVWEI (JROF, JLEV, JBLK)*ZMOYSPNL (JROF, JBLK)
            ENDDO

          ENDDO

        ENDIF


        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T9&
          & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0&
          & (JROF, JBLK)-PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        ENDDO

      ENDIF

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LATTES_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PBDT => GET_HOST_DATA_RDWR (YD_PBDT)
    PMIXNL => GET_HOST_DATA_RDWR (YD_PMIXNL)
    POROGL => GET_HOST_DATA_RDWR (YD_POROGL)
    POROGM => GET_HOST_DATA_RDWR (YD_POROGM)
    PRES0 => GET_HOST_DATA_RDWR (YD_PRES0)
    PSDIV0 => GET_HOST_DATA_RDWR (YD_PSDIV0)
    PSDIV9 => GET_HOST_DATA_RDWR (YD_PSDIV9)
    PSDVBC => GET_HOST_DATA_RDWR (YD_PSDVBC)
    ZMOY1SP => GET_HOST_DATA_RDWR (YL_ZMOY1SP)
    ZMOYSPNL => GET_HOST_DATA_RDWR (YL_ZMOYSPNL)
    ZSPNLT0 => GET_HOST_DATA_RDWR (YL_ZSPNLT0)
    ZSPNLT1 => GET_HOST_DATA_RDWR (YL_ZSPNLT1)
    ZSPNLT_FE => GET_HOST_DATA_RDWR (YL_ZSPNLT_FE)
    ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
    ZSPTB => GET_HOST_DATA_RDWR (YL_ZSPTB)
    ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
    Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
    Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
    Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
    Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
    Z_YDVARS_CSPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPNL%FT9)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_SPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPNL%FT9)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_T0 => GET_HOST_DATA_RDWR (YDVARS%SP%FT0)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => NULL ()
  PMIXNL => NULL ()
  POROGL => NULL ()
  POROGM => NULL ()
  PRES0 => NULL ()
  PSDIV0 => NULL ()
  PSDIV9 => NULL ()
  PSDVBC => NULL ()
  ZMOY1SP => NULL ()
  ZMOYSPNL => NULL ()
  ZSPNLT0 => NULL ()
  ZSPNLT1 => NULL ()
  ZSPNLT_FE => NULL ()
  ZSPT1 => NULL ()
  ZSPTB => NULL ()
  ZVWEI => NULL ()
  Z_YDCPG_SL1_C9_NL_P => NULL ()
  Z_YDCPG_SL1_C9_P => NULL ()
  Z_YDCPG_SL1_SP9_P => NULL ()
  Z_YDCPG_SL2_SPSI => NULL ()
  Z_YDVARS_CSPNL_T9 => NULL ()
  Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
  Z_YDVARS_SPNL_T9 => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_T0 => NULL ()
  Z_YDVARS_SP_T1 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LATTES_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => GET_HOST_DATA_RDONLY (YD_PBDT)
  PMIXNL => GET_HOST_DATA_RDONLY (YD_PMIXNL)
  POROGL => GET_HOST_DATA_RDONLY (YD_POROGL)
  POROGM => GET_HOST_DATA_RDONLY (YD_POROGM)
  PRES0 => GET_HOST_DATA_RDONLY (YD_PRES0)
  PSDIV0 => GET_HOST_DATA_RDONLY (YD_PSDIV0)
  PSDIV9 => GET_HOST_DATA_RDONLY (YD_PSDIV9)
  PSDVBC => GET_HOST_DATA_RDONLY (YD_PSDVBC)
  ZMOY1SP => GET_HOST_DATA_RDWR (YL_ZMOY1SP)
  ZMOYSPNL => GET_HOST_DATA_RDWR (YL_ZMOYSPNL)
  ZSPNLT0 => GET_HOST_DATA_RDWR (YL_ZSPNLT0)
  ZSPNLT1 => GET_HOST_DATA_RDWR (YL_ZSPNLT1)
  ZSPNLT_FE => GET_HOST_DATA_RDWR (YL_ZSPNLT_FE)
  ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
  ZSPTB => GET_HOST_DATA_RDWR (YL_ZSPTB)
  ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
  Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
  Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
  Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
  Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
  Z_YDVARS_CSPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPNL%FT9)
  Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_SPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPNL%FT9)
  Z_YDVARS_SP_DL => GET_HOST_DATA_RDONLY (YDVARS%SP%FDL)
  Z_YDVARS_SP_DM => GET_HOST_DATA_RDONLY (YDVARS%SP%FDM)
  Z_YDVARS_SP_T0 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT0)
  Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
  Z_YDVARS_SP_T9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT9)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK, ZMIXNL, ZNESC, ZSETTLS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      
      ZSPTB (JROF, JBLK)=PSDVBC (JROF, YDGEOMETRY%YRDIMV%NFLEVG&
      &, JBLK)/PRES0 (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        ZVWEI (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
      ENDDO

      
      Z_YDCPG_SL2_SPSI (JROF, JBLK)=PBDT (JROF, JBLK)*PSDIV0 (JROF, JBLK)
      ZSPTB (JROF, JBLK)=-PDTS2*ZSPTB (JROF, JBLK)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        ZMOY1SP (JROF, JLEV, JBLK)=PDTS2*(Z_YDVARS_U_T0 (JROF, JLEV, JBLK)*(Z_YDVARS_SP_DL&
        & (JROF, JBLK)+ZCMSLP*POROGL (JROF, JBLK))+Z_YDVARS_V_T0 (JROF, JLEV, JBLK&
        &)*(Z_YDVARS_SP_DM (JROF, JBLK)+ZCMSLP*POROGM (JROF, JBLK)))
        
        
        ZMOY1SP (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZSPTB (JROF, JBLK)
      
      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN

        IF (.NOT.LLCT) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPNLT0 (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT0*Z_YDCPG_SL2_SPSI (JROF, JBLK)

            

            IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN

              IF (YDCPG_OPTS%NSTEP<=YDRIP%NFOST.OR.YDML_DYN%YRDYNA%LNESC) THEN
                
                Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF&
                &, JLEV, JBLK)+PESGM*ZMOY1SP (JROF, JLEV, JBLK)

                

                IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
                  
                  ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT0 (JROF, JBLK)*ZVWEI (JROF, JLEV&
                  &, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
                
                ELSE
                  
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
                  &+PESGP*ZVWEI (JROF, JLEV, JBLK)*ZSPNLT0 (JROF, JBLK)
                
                ENDIF

              ELSEIF (YDML_DYN%YRDYNA%LSETTLS) THEN

                IF (YDML_DYN%YRDYNA%LPC_CHEAP) THEN
                  
                  ZNESC=PESGM*ZMOY1SP (JROF, JLEV, JBLK)
                  ZSETTLS=ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)
                  ZMIXNL=PMIXNL (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+ZNESC
                  Z_YDCPG_SL1_C9_NL_P (JROF, JLEV, JBLK)=ZMIXNL*ZSETTLS
                
                ELSE
                  
                  ZNESC=PESGM*ZMOY1SP (JROF, JLEV, JBLK)
                  ZSETTLS=ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)
                  ZMIXNL=PMIXNL (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+ZNESC+ZMIXNL*ZSETTLS
                
                ENDIF


                IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
                  
                  ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT0 (JROF, JBLK)*PESGP*ZVWEI (JROF&
                  &, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)
                
                ELSE
                  
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
                  &+PESGP*ZVWEI (JROF, JLEV, JBLK)*ZSPNLT0 (JROF, JBLK)
                
                ENDIF

              ELSE
                
                Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM*ZMOY1SP (JROF&
                &, JLEV, JBLK)+0.5_JPRB*PESGM*(ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK))

                

                IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
                  
                  ZSPNLT_FE (JROF, JLEV, JBLK)=(1.5_JPRB*ZSPNLT0 (JROF, JBLK)-0.5_JPRB*Z_YDVARS_SPNL_T9 (JROF, JLEV&
                  &, JBLK))*ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
                
                ELSE
                  
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+PESGP*ZVWEI (JROF, JLEV, JBLK&
                  &)*(1.5_JPRB*ZSPNLT0 (JROF, JBLK)-0.5_JPRB*Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK))
                
                ENDIF

              ENDIF

            ENDIF


            IF (YDML_DYN%YRDYNA%LPC_FULL) THEN
              Z_YDVARS_CSPNL_T9 (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)
            ENDIF


            IF (.NOT.YDML_DYN%YRDYNA%LNESC) THEN
              
              Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT9*Z_YDCPG_SL2_SPSI (JROF, JBLK)
            
            ENDIF

          ENDDO


          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

            IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN
              ZSPNLT_FE (JROF, 0, JBLK)=0.0_JPRB
              ZSPNLT_FE (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
              CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
              &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
              &%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK),YDSTACK=YLSTACK)
              
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
            
            ENDIF

          ENDIF


          IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN
            
            Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T0&
            & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK&
            &)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          
          ENDIF

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPNLT1 (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT9*Z_YDCPG_SL2_SPSI (JROF, JBLK)

            

            IF (.NOT.LLCTC) THEN
              
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF,&
              & JLEV, JBLK)+PESGM*Z_YDVARS_CSPNL_T9 (JROF, JLEV, JBLK)
            
            ENDIF


            IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
              
              ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT1 (JROF, JBLK)*ZVWEI (JROF, JLEV&
              &, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
            
            ELSE
              
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
              &+ZVWEI (JROF, JLEV, JBLK)*ZSPNLT1 (JROF, JBLK)*PESGP
            
            ENDIF

          ENDDO


          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
            ZSPNLT_FE (JROF, 0, JBLK)=0.0_JPRB
            ZSPNLT_FE (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
            CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
            &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
            &%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK),YDSTACK=YLSTACK)
            
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
          
          ENDIF


          IF (.NOT.LLCTC) THEN
            
            Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T9&
            & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          
          ENDIF

          
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK&
          &)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
        
        ENDIF


        IF (YDML_DYN%YRDYN%XIDT>0.0_JPRB) THEN
          
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-ZXIGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=ZXIGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        
        ELSE
          
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        
        ENDIF

      ELSE

        IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN

          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              ZMOYSPNL (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+Z_YDCPG_SL2_SPSI (JROF, JBLK)
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM&
              &*ZMOYSPNL (JROF, JBLK)-PESGM*PBDT (JROF, JBLK)*PSDIV9 (JROF, JBLK)
              ZSPNLT_FE (JROF, JLEV, JBLK)=PESGP*ZVWEI (JROF, JLEV, JBLK)*ZMOYSPNL (JROF, JBLK)
            
            ENDDO

            ZSPNLT_FE (JROF, 0, JBLK)=0.0_JPRB
            ZSPNLT_FE (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
            CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
            &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
            &%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK),YDSTACK=YLSTACK)
            
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
          
          ELSE

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              ZMOYSPNL (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+Z_YDCPG_SL2_SPSI (JROF, JBLK)
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM&
              &*ZMOYSPNL (JROF, JBLK)-PESGM*PBDT (JROF, JBLK)*PSDIV9 (JROF, JBLK)
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+PESGP&
              &*ZVWEI (JROF, JLEV, JBLK)*ZMOYSPNL (JROF, JBLK)
            
            ENDDO

          ENDIF

          
          Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T9&
          & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0&
          & (JROF, JBLK)-PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        
        ENDIF

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LATTES_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PBDT => GET_HOST_DATA_RDWR (YD_PBDT)
    PMIXNL => GET_HOST_DATA_RDWR (YD_PMIXNL)
    POROGL => GET_HOST_DATA_RDWR (YD_POROGL)
    POROGM => GET_HOST_DATA_RDWR (YD_POROGM)
    PRES0 => GET_HOST_DATA_RDWR (YD_PRES0)
    PSDIV0 => GET_HOST_DATA_RDWR (YD_PSDIV0)
    PSDIV9 => GET_HOST_DATA_RDWR (YD_PSDIV9)
    PSDVBC => GET_HOST_DATA_RDWR (YD_PSDVBC)
    ZMOY1SP => GET_HOST_DATA_RDWR (YL_ZMOY1SP)
    ZMOYSPNL => GET_HOST_DATA_RDWR (YL_ZMOYSPNL)
    ZSPNLT0 => GET_HOST_DATA_RDWR (YL_ZSPNLT0)
    ZSPNLT1 => GET_HOST_DATA_RDWR (YL_ZSPNLT1)
    ZSPNLT_FE => GET_HOST_DATA_RDWR (YL_ZSPNLT_FE)
    ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
    ZSPTB => GET_HOST_DATA_RDWR (YL_ZSPTB)
    ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
    Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
    Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
    Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
    Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
    Z_YDVARS_CSPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPNL%FT9)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_SPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPNL%FT9)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_T0 => GET_HOST_DATA_RDWR (YDVARS%SP%FT0)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => NULL ()
  PMIXNL => NULL ()
  POROGL => NULL ()
  POROGM => NULL ()
  PRES0 => NULL ()
  PSDIV0 => NULL ()
  PSDIV9 => NULL ()
  PSDVBC => NULL ()
  ZMOY1SP => NULL ()
  ZMOYSPNL => NULL ()
  ZSPNLT0 => NULL ()
  ZSPNLT1 => NULL ()
  ZSPNLT_FE => NULL ()
  ZSPT1 => NULL ()
  ZSPTB => NULL ()
  ZVWEI => NULL ()
  Z_YDCPG_SL1_C9_NL_P => NULL ()
  Z_YDCPG_SL1_C9_P => NULL ()
  Z_YDCPG_SL1_SP9_P => NULL ()
  Z_YDCPG_SL2_SPSI => NULL ()
  Z_YDVARS_CSPNL_T9 => NULL ()
  Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
  Z_YDVARS_SPNL_T9 => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_T0 => NULL ()
  Z_YDVARS_SP_T1 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LATTES_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => GET_DEVICE_DATA_RDONLY (YD_PBDT)
  PMIXNL => GET_DEVICE_DATA_RDONLY (YD_PMIXNL)
  POROGL => GET_DEVICE_DATA_RDONLY (YD_POROGL)
  POROGM => GET_DEVICE_DATA_RDONLY (YD_POROGM)
  PRES0 => GET_DEVICE_DATA_RDONLY (YD_PRES0)
  PSDIV0 => GET_DEVICE_DATA_RDONLY (YD_PSDIV0)
  PSDIV9 => GET_DEVICE_DATA_RDONLY (YD_PSDIV9)
  PSDVBC => GET_DEVICE_DATA_RDONLY (YD_PSDVBC)
  ZMOY1SP => GET_DEVICE_DATA_RDWR (YL_ZMOY1SP)
  ZMOYSPNL => GET_DEVICE_DATA_RDWR (YL_ZMOYSPNL)
  ZSPNLT0 => GET_DEVICE_DATA_RDWR (YL_ZSPNLT0)
  ZSPNLT1 => GET_DEVICE_DATA_RDWR (YL_ZSPNLT1)
  ZSPNLT_FE => GET_DEVICE_DATA_RDWR (YL_ZSPNLT_FE)
  ZSPT1 => GET_DEVICE_DATA_RDWR (YL_ZSPT1)
  ZSPTB => GET_DEVICE_DATA_RDWR (YL_ZSPTB)
  ZVWEI => GET_DEVICE_DATA_RDWR (YL_ZVWEI)
  Z_YDCPG_SL1_C9_NL_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
  Z_YDCPG_SL1_C9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%C9%F_P)
  Z_YDCPG_SL1_SP9_P => GET_DEVICE_DATA_RDWR (YDCPG_SL1%SP9%F_P)
  Z_YDCPG_SL2_SPSI => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_SPSI)
  Z_YDVARS_CSPNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%CSPNL%FT9)
  Z_YDVARS_GEOMETRY_OROG_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
  Z_YDVARS_SPNL_T9 => GET_DEVICE_DATA_RDWR (YDVARS%SPNL%FT9)
  Z_YDVARS_SP_DL => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FDL)
  Z_YDVARS_SP_DM => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FDM)
  Z_YDVARS_SP_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FT0)
  Z_YDVARS_SP_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SP%FT1)
  Z_YDVARS_SP_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FT9)
  Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PBDT, PMIXNL, POROGL, POROGM, PRES0, PSDIV0, PSDIV9, PSDVBC, YDCPG_OPTS, &
    !$ACC&         YDGEOMETRY, YDML_DYN, YDRIP, YFXTRAN_ACDC_STACK, ZMOY1SP, ZMOYSPNL, &
    !$ACC&         ZSPNLT0, ZSPNLT1, ZSPNLT_FE, ZSPT1, ZSPTB, ZVWEI, Z_YDCPG_SL1_C9_NL_P, &
    !$ACC&         Z_YDCPG_SL1_C9_P, Z_YDCPG_SL1_SP9_P, Z_YDCPG_SL2_SPSI, Z_YDVARS_CSPNL_T9, &
    !$ACC&         Z_YDVARS_GEOMETRY_OROG_T0, Z_YDVARS_SPNL_T9, Z_YDVARS_SP_DL, &
    !$ACC&         Z_YDVARS_SP_DM, Z_YDVARS_SP_T0, Z_YDVARS_SP_T1, Z_YDVARS_SP_T9, &
    !$ACC&         Z_YDVARS_U_T0, Z_YDVARS_V_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK, ZMIXNL, ZNESC, ZSETTLS) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      
      ZSPTB (JROF, JBLK)=PSDVBC (JROF, YDGEOMETRY%YRDIMV%NFLEVG&
      &, JBLK)/PRES0 (JROF, YDGEOMETRY%YRDIMV%NFLEVG, JBLK)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        ZVWEI (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVAB%VDELB (JLEV)
      ENDDO

      
      Z_YDCPG_SL2_SPSI (JROF, JBLK)=PBDT (JROF, JBLK)*PSDIV0 (JROF, JBLK)
      ZSPTB (JROF, JBLK)=-PDTS2*ZSPTB (JROF, JBLK)

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        ZMOY1SP (JROF, JLEV, JBLK)=PDTS2*(Z_YDVARS_U_T0 (JROF, JLEV, JBLK)*(Z_YDVARS_SP_DL&
        & (JROF, JBLK)+ZCMSLP*POROGL (JROF, JBLK))+Z_YDVARS_V_T0 (JROF, JLEV, JBLK&
        &)*(Z_YDVARS_SP_DM (JROF, JBLK)+ZCMSLP*POROGM (JROF, JBLK)))
        
        
        ZMOY1SP (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZSPTB (JROF, JBLK)
      
      ENDDO


      IF (YDML_DYN%YRDYNA%LTWOTL) THEN

        IF (.NOT.LLCT) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPNLT0 (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT0*Z_YDCPG_SL2_SPSI (JROF, JBLK)

            

            IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN

              IF (YDCPG_OPTS%NSTEP<=YDRIP%NFOST.OR.YDML_DYN%YRDYNA%LNESC) THEN
                
                Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF&
                &, JLEV, JBLK)+PESGM*ZMOY1SP (JROF, JLEV, JBLK)

                

                IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
                  
                  ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT0 (JROF, JBLK)*ZVWEI (JROF, JLEV&
                  &, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
                
                ELSE
                  
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
                  &+PESGP*ZVWEI (JROF, JLEV, JBLK)*ZSPNLT0 (JROF, JBLK)
                
                ENDIF

              ELSEIF (YDML_DYN%YRDYNA%LSETTLS) THEN

                IF (YDML_DYN%YRDYNA%LPC_CHEAP) THEN
                  
                  ZNESC=PESGM*ZMOY1SP (JROF, JLEV, JBLK)
                  ZSETTLS=ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)
                  ZMIXNL=PMIXNL (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+ZNESC
                  Z_YDCPG_SL1_C9_NL_P (JROF, JLEV, JBLK)=ZMIXNL*ZSETTLS
                
                ELSE
                  
                  ZNESC=PESGM*ZMOY1SP (JROF, JLEV, JBLK)
                  ZSETTLS=ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)
                  ZMIXNL=PMIXNL (JROF, JLEV, JBLK)
                  Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+ZNESC+ZMIXNL*ZSETTLS
                
                ENDIF


                IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
                  
                  ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT0 (JROF, JBLK)*PESGP*ZVWEI (JROF&
                  &, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)
                
                ELSE
                  
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
                  &+PESGP*ZVWEI (JROF, JLEV, JBLK)*ZSPNLT0 (JROF, JBLK)
                
                ENDIF

              ELSE
                
                Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM*ZMOY1SP (JROF&
                &, JLEV, JBLK)+0.5_JPRB*PESGM*(ZSPNLT0 (JROF, JBLK)-Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK))

                

                IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
                  
                  ZSPNLT_FE (JROF, JLEV, JBLK)=(1.5_JPRB*ZSPNLT0 (JROF, JBLK)-0.5_JPRB*Z_YDVARS_SPNL_T9 (JROF, JLEV&
                  &, JBLK))*ZVWEI (JROF, JLEV, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
                
                ELSE
                  
                  Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+PESGP*ZVWEI (JROF, JLEV, JBLK&
                  &)*(1.5_JPRB*ZSPNLT0 (JROF, JBLK)-0.5_JPRB*Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK))
                
                ENDIF

              ENDIF

            ENDIF


            IF (YDML_DYN%YRDYNA%LPC_FULL) THEN
              Z_YDVARS_CSPNL_T9 (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)
            ENDIF


            IF (.NOT.YDML_DYN%YRDYNA%LNESC) THEN
              
              Z_YDVARS_SPNL_T9 (JROF, JLEV, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT9*Z_YDCPG_SL2_SPSI (JROF, JBLK)
            
            ENDIF

          ENDDO


          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

            IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN
              ZSPNLT_FE (JROF, 0, JBLK)=0.0_JPRB
              ZSPNLT_FE (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
              CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
              &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
              &%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK),YDSTACK=YLSTACK)
              
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
            
            ENDIF

          ENDIF


          IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN
            
            Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T0&
            & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK&
            &)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          
          ENDIF

        ELSE

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            ZSPNLT1 (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+ZXIDT9*Z_YDCPG_SL2_SPSI (JROF, JBLK)

            

            IF (.NOT.LLCTC) THEN
              
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF,&
              & JLEV, JBLK)+PESGM*Z_YDVARS_CSPNL_T9 (JROF, JLEV, JBLK)
            
            ENDIF


            IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
              
              ZSPNLT_FE (JROF, JLEV, JBLK)=ZSPNLT1 (JROF, JBLK)*ZVWEI (JROF, JLEV&
              &, JBLK)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VFE_RDETAH (JLEV)*PESGP
            
            ELSE
              
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)&
              &+ZVWEI (JROF, JLEV, JBLK)*ZSPNLT1 (JROF, JBLK)*PESGP
            
            ENDIF

          ENDDO


          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN
            ZSPNLT_FE (JROF, 0, JBLK)=0.0_JPRB
            ZSPNLT_FE (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
            CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
            &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
            &%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK),YDSTACK=YLSTACK)
            
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
          
          ENDIF


          IF (.NOT.LLCTC) THEN
            
            Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T9&
            & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          
          ENDIF

          
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK&
          &)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
        
        ENDIF


        IF (YDML_DYN%YRDYN%XIDT>0.0_JPRB) THEN
          
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-ZXIGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=ZXIGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        
        ELSE
          
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        
        ENDIF

      ELSE

        IF (YDML_DYN%YRDYN%NVLAG==2.OR.YDML_DYN%YRDYN%NVLAG==3) THEN

          IF (YDGEOMETRY%YRVERT_GEOM%YRCVER%LVERTFE) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              ZMOYSPNL (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+Z_YDCPG_SL2_SPSI (JROF, JBLK)
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM&
              &*ZMOYSPNL (JROF, JBLK)-PESGM*PBDT (JROF, JBLK)*PSDIV9 (JROF, JBLK)
              ZSPNLT_FE (JROF, JLEV, JBLK)=PESGP*ZVWEI (JROF, JLEV, JBLK)*ZMOYSPNL (JROF, JBLK)
            
            ENDDO

            ZSPNLT_FE (JROF, 0, JBLK)=0.0_JPRB
            ZSPNLT_FE (JROF, YDGEOMETRY%YRDIMV%NFLEVG+1, JBLK)=0.0_JPRB
            CALL VERDISINT_OPENACC (YDGEOMETRY%YRVERT_GEOM%YRVFE, YDGEOMETRY%YRVERT_GEOM%YRCVER&
            &,'ITOP','11', YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
            &%YRDIMV%NFLEVG, ZSPNLT_FE(:,:, JBLK), POUTS=ZSPT1(:, JBLK),YDSTACK=YLSTACK)
            
            Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+ZSPT1 (JROF, JBLK)
          
          ELSE

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              ZMOYSPNL (JROF, JBLK)=ZMOY1SP (JROF, JLEV, JBLK)+Z_YDCPG_SL2_SPSI (JROF, JBLK)
              Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)=Z_YDCPG_SL1_C9_P (JROF, JLEV, JBLK)+PESGM&
              &*ZMOYSPNL (JROF, JBLK)-PESGM*PBDT (JROF, JBLK)*PSDIV9 (JROF, JBLK)
              Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)+PESGP&
              &*ZVWEI (JROF, JLEV, JBLK)*ZMOYSPNL (JROF, JBLK)
            
            ENDDO

          ENDIF

          
          Z_YDCPG_SL1_SP9_P (JROF, JBLK)=Z_YDCPG_SL1_SP9_P (JROF, JBLK)+Z_YDVARS_SP_T9&
          & (JROF, JBLK)+ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0 (JROF, JBLK)
          Z_YDVARS_SP_T1 (JROF, JBLK)=Z_YDVARS_SP_T1 (JROF, JBLK)-ZCMSLP*Z_YDVARS_GEOMETRY_OROG_T0&
          & (JROF, JBLK)-PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
          Z_YDCPG_SL2_SPSI (JROF, JBLK)=PESGP*Z_YDCPG_SL2_SPSI (JROF, JBLK)
        
        ENDIF

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LATTES_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PBDT => GET_HOST_DATA_RDWR (YD_PBDT)
    PMIXNL => GET_HOST_DATA_RDWR (YD_PMIXNL)
    POROGL => GET_HOST_DATA_RDWR (YD_POROGL)
    POROGM => GET_HOST_DATA_RDWR (YD_POROGM)
    PRES0 => GET_HOST_DATA_RDWR (YD_PRES0)
    PSDIV0 => GET_HOST_DATA_RDWR (YD_PSDIV0)
    PSDIV9 => GET_HOST_DATA_RDWR (YD_PSDIV9)
    PSDVBC => GET_HOST_DATA_RDWR (YD_PSDVBC)
    ZMOY1SP => GET_HOST_DATA_RDWR (YL_ZMOY1SP)
    ZMOYSPNL => GET_HOST_DATA_RDWR (YL_ZMOYSPNL)
    ZSPNLT0 => GET_HOST_DATA_RDWR (YL_ZSPNLT0)
    ZSPNLT1 => GET_HOST_DATA_RDWR (YL_ZSPNLT1)
    ZSPNLT_FE => GET_HOST_DATA_RDWR (YL_ZSPNLT_FE)
    ZSPT1 => GET_HOST_DATA_RDWR (YL_ZSPT1)
    ZSPTB => GET_HOST_DATA_RDWR (YL_ZSPTB)
    ZVWEI => GET_HOST_DATA_RDWR (YL_ZVWEI)
    Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
    Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
    Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
    Z_YDCPG_SL2_SPSI => GET_HOST_DATA_RDWR (YDCPG_SL2%F_SPSI)
    Z_YDVARS_CSPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%CSPNL%FT9)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
    Z_YDVARS_SPNL_T9 => GET_HOST_DATA_RDWR (YDVARS%SPNL%FT9)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_T0 => GET_HOST_DATA_RDWR (YDVARS%SP%FT0)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PBDT => NULL ()
  PMIXNL => NULL ()
  POROGL => NULL ()
  POROGM => NULL ()
  PRES0 => NULL ()
  PSDIV0 => NULL ()
  PSDIV9 => NULL ()
  PSDVBC => NULL ()
  ZMOY1SP => NULL ()
  ZMOYSPNL => NULL ()
  ZSPNLT0 => NULL ()
  ZSPNLT1 => NULL ()
  ZSPNLT_FE => NULL ()
  ZSPT1 => NULL ()
  ZSPTB => NULL ()
  ZVWEI => NULL ()
  Z_YDCPG_SL1_C9_NL_P => NULL ()
  Z_YDCPG_SL1_C9_P => NULL ()
  Z_YDCPG_SL1_SP9_P => NULL ()
  Z_YDCPG_SL2_SPSI => NULL ()
  Z_YDVARS_CSPNL_T9 => NULL ()
  Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
  Z_YDVARS_SPNL_T9 => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_T0 => NULL ()
  Z_YDVARS_SP_T1 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LATTES_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)




CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZMOY1SP)) CALL FIELD_DELETE (YL_ZMOY1SP)
IF (ASSOCIATED (YL_ZMOYSPNL)) CALL FIELD_DELETE (YL_ZMOYSPNL)
IF (ASSOCIATED (YL_ZSPNLT0)) CALL FIELD_DELETE (YL_ZSPNLT0)
IF (ASSOCIATED (YL_ZSPNLT1)) CALL FIELD_DELETE (YL_ZSPNLT1)
IF (ASSOCIATED (YL_ZSPNLT_FE)) CALL FIELD_DELETE (YL_ZSPNLT_FE)
IF (ASSOCIATED (YL_ZSPT1)) CALL FIELD_DELETE (YL_ZSPT1)
IF (ASSOCIATED (YL_ZSPTB)) CALL FIELD_DELETE (YL_ZSPTB)
IF (ASSOCIATED (YL_ZVWEI)) CALL FIELD_DELETE (YL_ZVWEI)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('LATTES_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE LATTES_PARALLEL
