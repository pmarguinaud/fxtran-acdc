MODULE UTIL_TTRC_MOD

USE YOMTRC, ONLY : TTRC

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TTRC
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TTRC
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TTRC
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TTRC
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TTRC
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TTRC
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TTRC
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TTRC (SELF, KLUN)

IMPLICIT NONE
TYPE (TTRC), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2
LGRSURF = ALLOCATED (SELF%GRSURF)
WRITE (KLUN) LGRSURF
IF (LGRSURF) THEN
  WRITE (KLUN) LBOUND (SELF%GRSURF)
  WRITE (KLUN) UBOUND (SELF%GRSURF)
  WRITE (KLUN) SELF%GRSURF
ENDIF
LGDEOTI = ALLOCATED (SELF%GDEOTI)
WRITE (KLUN) LGDEOTI
IF (LGDEOTI) THEN
  WRITE (KLUN) LBOUND (SELF%GDEOTI)
  WRITE (KLUN) UBOUND (SELF%GDEOTI)
  WRITE (KLUN) SELF%GDEOTI
ENDIF
LGDEOTI2 = ALLOCATED (SELF%GDEOTI2)
WRITE (KLUN) LGDEOTI2
IF (LGDEOTI2) THEN
  WRITE (KLUN) LBOUND (SELF%GDEOTI2)
  WRITE (KLUN) UBOUND (SELF%GDEOTI2)
  WRITE (KLUN) SELF%GDEOTI2
ENDIF
LGUEOTI = ALLOCATED (SELF%GUEOTI)
WRITE (KLUN) LGUEOTI
IF (LGUEOTI) THEN
  WRITE (KLUN) LBOUND (SELF%GUEOTI)
  WRITE (KLUN) UBOUND (SELF%GUEOTI)
  WRITE (KLUN) SELF%GUEOTI
ENDIF
LGUEOTI2 = ALLOCATED (SELF%GUEOTI2)
WRITE (KLUN) LGUEOTI2
IF (LGUEOTI2) THEN
  WRITE (KLUN) LBOUND (SELF%GUEOTI2)
  WRITE (KLUN) UBOUND (SELF%GUEOTI2)
  WRITE (KLUN) SELF%GUEOTI2
ENDIF
LGEOLT = ALLOCATED (SELF%GEOLT)
WRITE (KLUN) LGEOLT
IF (LGEOLT) THEN
  WRITE (KLUN) LBOUND (SELF%GEOLT)
  WRITE (KLUN) UBOUND (SELF%GEOLT)
  WRITE (KLUN) SELF%GEOLT
ENDIF
LGEOXT = ALLOCATED (SELF%GEOXT)
WRITE (KLUN) LGEOXT
IF (LGEOXT) THEN
  WRITE (KLUN) LBOUND (SELF%GEOXT)
  WRITE (KLUN) UBOUND (SELF%GEOXT)
  WRITE (KLUN) SELF%GEOXT
ENDIF
LGRPROX = ALLOCATED (SELF%GRPROX)
WRITE (KLUN) LGRPROX
IF (LGRPROX) THEN
  WRITE (KLUN) LBOUND (SELF%GRPROX)
  WRITE (KLUN) UBOUND (SELF%GRPROX)
  WRITE (KLUN) SELF%GRPROX
ENDIF
LGMIXP = ALLOCATED (SELF%GMIXP)
WRITE (KLUN) LGMIXP
IF (LGMIXP) THEN
  WRITE (KLUN) LBOUND (SELF%GMIXP)
  WRITE (KLUN) UBOUND (SELF%GMIXP)
  WRITE (KLUN) SELF%GMIXP
ENDIF
LGFLUXC = ALLOCATED (SELF%GFLUXC)
WRITE (KLUN) LGFLUXC
IF (LGFLUXC) THEN
  WRITE (KLUN) LBOUND (SELF%GFLUXC)
  WRITE (KLUN) UBOUND (SELF%GFLUXC)
  WRITE (KLUN) SELF%GFLUXC
ENDIF
LGDEOSI = ALLOCATED (SELF%GDEOSI)
WRITE (KLUN) LGDEOSI
IF (LGDEOSI) THEN
  WRITE (KLUN) LBOUND (SELF%GDEOSI)
  WRITE (KLUN) UBOUND (SELF%GDEOSI)
  WRITE (KLUN) SELF%GDEOSI
ENDIF
LGUEOSI = ALLOCATED (SELF%GUEOSI)
WRITE (KLUN) LGUEOSI
IF (LGUEOSI) THEN
  WRITE (KLUN) LBOUND (SELF%GUEOSI)
  WRITE (KLUN) UBOUND (SELF%GUEOSI)
  WRITE (KLUN) SELF%GUEOSI
ENDIF
LGMU0 = ALLOCATED (SELF%GMU0)
WRITE (KLUN) LGMU0
IF (LGMU0) THEN
  WRITE (KLUN) LBOUND (SELF%GMU0)
  WRITE (KLUN) UBOUND (SELF%GMU0)
  WRITE (KLUN) SELF%GMU0
ENDIF
LGMU0_MIN = ALLOCATED (SELF%GMU0_MIN)
WRITE (KLUN) LGMU0_MIN
IF (LGMU0_MIN) THEN
  WRITE (KLUN) LBOUND (SELF%GMU0_MIN)
  WRITE (KLUN) UBOUND (SELF%GMU0_MIN)
  WRITE (KLUN) SELF%GMU0_MIN
ENDIF
LGMU0_MAX = ALLOCATED (SELF%GMU0_MAX)
WRITE (KLUN) LGMU0_MAX
IF (LGMU0_MAX) THEN
  WRITE (KLUN) LBOUND (SELF%GMU0_MAX)
  WRITE (KLUN) UBOUND (SELF%GMU0_MAX)
  WRITE (KLUN) SELF%GMU0_MAX
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TTRC (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TTRC), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL2(2), IU2(2), IL3(3), IU3(3), IL4(4), IU4(4)
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) LGRSURF
IF (LGRSURF) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%GRSURF (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%GRSURF,1):UBOUND(SELF%GRSURF,1), LBOUND(SELF%GRSURF,2):UBOUND(SELF%GRSURF,2)))
  READ (KLUN) ZTMP2
  SELF%GRSURF = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LGDEOTI
IF (LGDEOTI) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GDEOTI (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GDEOTI,1):UBOUND(SELF%GDEOTI,1), LBOUND(SELF%GDEOTI,2):UBOUND(SELF%GDEOTI,2), LBOUND(SELF%GDEOTI,3):UBOUND(SELF%GDEOTI,3)))
  READ (KLUN) ZTMP3
  SELF%GDEOTI = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGDEOTI2
IF (LGDEOTI2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GDEOTI2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GDEOTI2,1):UBOUND(SELF%GDEOTI2,1), LBOUND(SELF%GDEOTI2,2):UBOUND(SELF%GDEOTI2,2), LBOUND(SELF%GDEOTI2,3):UBOUND(SELF%GDEOTI2,3)))
  READ (KLUN) ZTMP3
  SELF%GDEOTI2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGUEOTI
IF (LGUEOTI) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GUEOTI (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GUEOTI,1):UBOUND(SELF%GUEOTI,1), LBOUND(SELF%GUEOTI,2):UBOUND(SELF%GUEOTI,2), LBOUND(SELF%GUEOTI,3):UBOUND(SELF%GUEOTI,3)))
  READ (KLUN) ZTMP3
  SELF%GUEOTI = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGUEOTI2
IF (LGUEOTI2) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GUEOTI2 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GUEOTI2,1):UBOUND(SELF%GUEOTI2,1), LBOUND(SELF%GUEOTI2,2):UBOUND(SELF%GUEOTI2,2), LBOUND(SELF%GUEOTI2,3):UBOUND(SELF%GUEOTI2,3)))
  READ (KLUN) ZTMP3
  SELF%GUEOTI2 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGEOLT
IF (LGEOLT) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GEOLT (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GEOLT,1):UBOUND(SELF%GEOLT,1), LBOUND(SELF%GEOLT,2):UBOUND(SELF%GEOLT,2), LBOUND(SELF%GEOLT,3):UBOUND(SELF%GEOLT,3)))
  READ (KLUN) ZTMP3
  SELF%GEOLT = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGEOXT
IF (LGEOXT) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GEOXT (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GEOXT,1):UBOUND(SELF%GEOXT,1), LBOUND(SELF%GEOXT,2):UBOUND(SELF%GEOXT,2), LBOUND(SELF%GEOXT,3):UBOUND(SELF%GEOXT,3)))
  READ (KLUN) ZTMP3
  SELF%GEOXT = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGRPROX
IF (LGRPROX) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GRPROX (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GRPROX,1):UBOUND(SELF%GRPROX,1), LBOUND(SELF%GRPROX,2):UBOUND(SELF%GRPROX,2), LBOUND(SELF%GRPROX,3):UBOUND(SELF%GRPROX,3)))
  READ (KLUN) ZTMP3
  SELF%GRPROX = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGMIXP
IF (LGMIXP) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GMIXP (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GMIXP,1):UBOUND(SELF%GMIXP,1), LBOUND(SELF%GMIXP,2):UBOUND(SELF%GMIXP,2), LBOUND(SELF%GMIXP,3):UBOUND(SELF%GMIXP,3)))
  READ (KLUN) ZTMP3
  SELF%GMIXP = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGFLUXC
IF (LGFLUXC) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GFLUXC (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GFLUXC,1):UBOUND(SELF%GFLUXC,1), LBOUND(SELF%GFLUXC,2):UBOUND(SELF%GFLUXC,2), LBOUND(SELF%GFLUXC,3):UBOUND(SELF%GFLUXC,3)))
  READ (KLUN) ZTMP3
  SELF%GFLUXC = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGDEOSI
IF (LGDEOSI) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%GDEOSI (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%GDEOSI,1):UBOUND(SELF%GDEOSI,1), LBOUND(SELF%GDEOSI,2):UBOUND(SELF%GDEOSI,2), LBOUND(SELF%GDEOSI,3):UBOUND(SELF%GDEOSI,3), LBOUND(SELF%GDEOSI,4):UBOUND(SELF%GDEOSI,4)))
  READ (KLUN) ZTMP4
  SELF%GDEOSI = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LGUEOSI
IF (LGUEOSI) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%GUEOSI (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%GUEOSI,1):UBOUND(SELF%GUEOSI,1), LBOUND(SELF%GUEOSI,2):UBOUND(SELF%GUEOSI,2), LBOUND(SELF%GUEOSI,3):UBOUND(SELF%GUEOSI,3), LBOUND(SELF%GUEOSI,4):UBOUND(SELF%GUEOSI,4)))
  READ (KLUN) ZTMP4
  SELF%GUEOSI = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LGMU0
IF (LGMU0) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%GMU0 (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%GMU0,1):UBOUND(SELF%GMU0,1), LBOUND(SELF%GMU0,2):UBOUND(SELF%GMU0,2), LBOUND(SELF%GMU0,3):UBOUND(SELF%GMU0,3)))
  READ (KLUN) ZTMP3
  SELF%GMU0 = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LGMU0_MIN
IF (LGMU0_MIN) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%GMU0_MIN (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%GMU0_MIN,1):UBOUND(SELF%GMU0_MIN,1), LBOUND(SELF%GMU0_MIN,2):UBOUND(SELF%GMU0_MIN,2)))
  READ (KLUN) ZTMP2
  SELF%GMU0_MIN = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LGMU0_MAX
IF (LGMU0_MAX) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%GMU0_MAX (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%GMU0_MAX,1):UBOUND(SELF%GMU0_MAX,1), LBOUND(SELF%GMU0_MAX,2):UBOUND(SELF%GMU0_MAX,2)))
  READ (KLUN) ZTMP2
  SELF%GMU0_MAX = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TTRC (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTRC), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LGRSURF = ALLOCATED (SELF%GRSURF)
IF (LGRSURF) THEN
  !$ACC ENTER DATA CREATE (SELF%GRSURF)
  !$ACC UPDATE DEVICE (SELF%GRSURF)
  !$ACC ENTER DATA ATTACH (SELF%GRSURF)
ENDIF

LGDEOTI = ALLOCATED (SELF%GDEOTI)
IF (LGDEOTI) THEN
  !$ACC ENTER DATA CREATE (SELF%GDEOTI)
  !$ACC UPDATE DEVICE (SELF%GDEOTI)
  !$ACC ENTER DATA ATTACH (SELF%GDEOTI)
ENDIF

LGDEOTI2 = ALLOCATED (SELF%GDEOTI2)
IF (LGDEOTI2) THEN
  !$ACC ENTER DATA CREATE (SELF%GDEOTI2)
  !$ACC UPDATE DEVICE (SELF%GDEOTI2)
  !$ACC ENTER DATA ATTACH (SELF%GDEOTI2)
ENDIF

LGUEOTI = ALLOCATED (SELF%GUEOTI)
IF (LGUEOTI) THEN
  !$ACC ENTER DATA CREATE (SELF%GUEOTI)
  !$ACC UPDATE DEVICE (SELF%GUEOTI)
  !$ACC ENTER DATA ATTACH (SELF%GUEOTI)
ENDIF

LGUEOTI2 = ALLOCATED (SELF%GUEOTI2)
IF (LGUEOTI2) THEN
  !$ACC ENTER DATA CREATE (SELF%GUEOTI2)
  !$ACC UPDATE DEVICE (SELF%GUEOTI2)
  !$ACC ENTER DATA ATTACH (SELF%GUEOTI2)
ENDIF

LGEOLT = ALLOCATED (SELF%GEOLT)
IF (LGEOLT) THEN
  !$ACC ENTER DATA CREATE (SELF%GEOLT)
  !$ACC UPDATE DEVICE (SELF%GEOLT)
  !$ACC ENTER DATA ATTACH (SELF%GEOLT)
ENDIF

LGEOXT = ALLOCATED (SELF%GEOXT)
IF (LGEOXT) THEN
  !$ACC ENTER DATA CREATE (SELF%GEOXT)
  !$ACC UPDATE DEVICE (SELF%GEOXT)
  !$ACC ENTER DATA ATTACH (SELF%GEOXT)
ENDIF

LGRPROX = ALLOCATED (SELF%GRPROX)
IF (LGRPROX) THEN
  !$ACC ENTER DATA CREATE (SELF%GRPROX)
  !$ACC UPDATE DEVICE (SELF%GRPROX)
  !$ACC ENTER DATA ATTACH (SELF%GRPROX)
ENDIF

LGMIXP = ALLOCATED (SELF%GMIXP)
IF (LGMIXP) THEN
  !$ACC ENTER DATA CREATE (SELF%GMIXP)
  !$ACC UPDATE DEVICE (SELF%GMIXP)
  !$ACC ENTER DATA ATTACH (SELF%GMIXP)
ENDIF

LGFLUXC = ALLOCATED (SELF%GFLUXC)
IF (LGFLUXC) THEN
  !$ACC ENTER DATA CREATE (SELF%GFLUXC)
  !$ACC UPDATE DEVICE (SELF%GFLUXC)
  !$ACC ENTER DATA ATTACH (SELF%GFLUXC)
ENDIF

LGDEOSI = ALLOCATED (SELF%GDEOSI)
IF (LGDEOSI) THEN
  !$ACC ENTER DATA CREATE (SELF%GDEOSI)
  !$ACC UPDATE DEVICE (SELF%GDEOSI)
  !$ACC ENTER DATA ATTACH (SELF%GDEOSI)
ENDIF

LGUEOSI = ALLOCATED (SELF%GUEOSI)
IF (LGUEOSI) THEN
  !$ACC ENTER DATA CREATE (SELF%GUEOSI)
  !$ACC UPDATE DEVICE (SELF%GUEOSI)
  !$ACC ENTER DATA ATTACH (SELF%GUEOSI)
ENDIF

LGMU0 = ALLOCATED (SELF%GMU0)
IF (LGMU0) THEN
  !$ACC ENTER DATA CREATE (SELF%GMU0)
  !$ACC UPDATE DEVICE (SELF%GMU0)
  !$ACC ENTER DATA ATTACH (SELF%GMU0)
ENDIF

LGMU0_MIN = ALLOCATED (SELF%GMU0_MIN)
IF (LGMU0_MIN) THEN
  !$ACC ENTER DATA CREATE (SELF%GMU0_MIN)
  !$ACC UPDATE DEVICE (SELF%GMU0_MIN)
  !$ACC ENTER DATA ATTACH (SELF%GMU0_MIN)
ENDIF

LGMU0_MAX = ALLOCATED (SELF%GMU0_MAX)
IF (LGMU0_MAX) THEN
  !$ACC ENTER DATA CREATE (SELF%GMU0_MAX)
  !$ACC UPDATE DEVICE (SELF%GMU0_MAX)
  !$ACC ENTER DATA ATTACH (SELF%GMU0_MAX)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TTRC (SELF)

IMPLICIT NONE
TYPE (TTRC), TARGET :: SELF
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TTRC (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TTRC), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GRSURF), CDPATH//'%GRSURF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GDEOTI), CDPATH//'%GDEOTI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GDEOTI2), CDPATH//'%GDEOTI2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GUEOTI), CDPATH//'%GUEOTI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GUEOTI2), CDPATH//'%GUEOTI2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GEOLT), CDPATH//'%GEOLT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GEOXT), CDPATH//'%GEOXT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GRPROX), CDPATH//'%GRPROX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GMIXP), CDPATH//'%GMIXP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GFLUXC), CDPATH//'%GFLUXC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GDEOSI), CDPATH//'%GDEOSI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GUEOSI), CDPATH//'%GUEOSI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GMU0), CDPATH//'%GMU0'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GMU0_MIN), CDPATH//'%GMU0_MIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%GMU0_MAX), CDPATH//'%GMU0_MAX'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TTRC (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TTRC), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LGRSURF = ALLOCATED (SELF%GRSURF)
IF (LGRSURF) THEN
  !$ACC EXIT DATA DETACH (SELF%GRSURF)
  !$ACC EXIT DATA DELETE (SELF%GRSURF)
ENDIF

LGDEOTI = ALLOCATED (SELF%GDEOTI)
IF (LGDEOTI) THEN
  !$ACC EXIT DATA DETACH (SELF%GDEOTI)
  !$ACC EXIT DATA DELETE (SELF%GDEOTI)
ENDIF

LGDEOTI2 = ALLOCATED (SELF%GDEOTI2)
IF (LGDEOTI2) THEN
  !$ACC EXIT DATA DETACH (SELF%GDEOTI2)
  !$ACC EXIT DATA DELETE (SELF%GDEOTI2)
ENDIF

LGUEOTI = ALLOCATED (SELF%GUEOTI)
IF (LGUEOTI) THEN
  !$ACC EXIT DATA DETACH (SELF%GUEOTI)
  !$ACC EXIT DATA DELETE (SELF%GUEOTI)
ENDIF

LGUEOTI2 = ALLOCATED (SELF%GUEOTI2)
IF (LGUEOTI2) THEN
  !$ACC EXIT DATA DETACH (SELF%GUEOTI2)
  !$ACC EXIT DATA DELETE (SELF%GUEOTI2)
ENDIF

LGEOLT = ALLOCATED (SELF%GEOLT)
IF (LGEOLT) THEN
  !$ACC EXIT DATA DETACH (SELF%GEOLT)
  !$ACC EXIT DATA DELETE (SELF%GEOLT)
ENDIF

LGEOXT = ALLOCATED (SELF%GEOXT)
IF (LGEOXT) THEN
  !$ACC EXIT DATA DETACH (SELF%GEOXT)
  !$ACC EXIT DATA DELETE (SELF%GEOXT)
ENDIF

LGRPROX = ALLOCATED (SELF%GRPROX)
IF (LGRPROX) THEN
  !$ACC EXIT DATA DETACH (SELF%GRPROX)
  !$ACC EXIT DATA DELETE (SELF%GRPROX)
ENDIF

LGMIXP = ALLOCATED (SELF%GMIXP)
IF (LGMIXP) THEN
  !$ACC EXIT DATA DETACH (SELF%GMIXP)
  !$ACC EXIT DATA DELETE (SELF%GMIXP)
ENDIF

LGFLUXC = ALLOCATED (SELF%GFLUXC)
IF (LGFLUXC) THEN
  !$ACC EXIT DATA DETACH (SELF%GFLUXC)
  !$ACC EXIT DATA DELETE (SELF%GFLUXC)
ENDIF

LGDEOSI = ALLOCATED (SELF%GDEOSI)
IF (LGDEOSI) THEN
  !$ACC EXIT DATA DETACH (SELF%GDEOSI)
  !$ACC EXIT DATA DELETE (SELF%GDEOSI)
ENDIF

LGUEOSI = ALLOCATED (SELF%GUEOSI)
IF (LGUEOSI) THEN
  !$ACC EXIT DATA DETACH (SELF%GUEOSI)
  !$ACC EXIT DATA DELETE (SELF%GUEOSI)
ENDIF

LGMU0 = ALLOCATED (SELF%GMU0)
IF (LGMU0) THEN
  !$ACC EXIT DATA DETACH (SELF%GMU0)
  !$ACC EXIT DATA DELETE (SELF%GMU0)
ENDIF

LGMU0_MIN = ALLOCATED (SELF%GMU0_MIN)
IF (LGMU0_MIN) THEN
  !$ACC EXIT DATA DETACH (SELF%GMU0_MIN)
  !$ACC EXIT DATA DELETE (SELF%GMU0_MIN)
ENDIF

LGMU0_MAX = ALLOCATED (SELF%GMU0_MAX)
IF (LGMU0_MAX) THEN
  !$ACC EXIT DATA DETACH (SELF%GMU0_MAX)
  !$ACC EXIT DATA DELETE (SELF%GMU0_MAX)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TTRC (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TTRC),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LGDEOSI, LGDEOTI, LGDEOTI2, LGEOLT, LGEOXT, LGFLUXC, LGMIXP, LGMU0, LGMU0_MAX, LGMU0_MIN
LOGICAL :: LGRPROX, LGRSURF, LGUEOSI, LGUEOTI, LGUEOTI2
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LGRSURF = ALLOCATED (SELF%GRSURF)
IF (LGRSURF) THEN
  ISIZE = KIND (SELF%GRSURF) * SIZE (SELF%GRSURF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GRSURF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGDEOTI = ALLOCATED (SELF%GDEOTI)
IF (LGDEOTI) THEN
  ISIZE = KIND (SELF%GDEOTI) * SIZE (SELF%GDEOTI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GDEOTI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGDEOTI2 = ALLOCATED (SELF%GDEOTI2)
IF (LGDEOTI2) THEN
  ISIZE = KIND (SELF%GDEOTI2) * SIZE (SELF%GDEOTI2)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GDEOTI2'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGUEOTI = ALLOCATED (SELF%GUEOTI)
IF (LGUEOTI) THEN
  ISIZE = KIND (SELF%GUEOTI) * SIZE (SELF%GUEOTI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GUEOTI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGUEOTI2 = ALLOCATED (SELF%GUEOTI2)
IF (LGUEOTI2) THEN
  ISIZE = KIND (SELF%GUEOTI2) * SIZE (SELF%GUEOTI2)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GUEOTI2'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGEOLT = ALLOCATED (SELF%GEOLT)
IF (LGEOLT) THEN
  ISIZE = KIND (SELF%GEOLT) * SIZE (SELF%GEOLT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GEOLT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGEOXT = ALLOCATED (SELF%GEOXT)
IF (LGEOXT) THEN
  ISIZE = KIND (SELF%GEOXT) * SIZE (SELF%GEOXT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GEOXT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGRPROX = ALLOCATED (SELF%GRPROX)
IF (LGRPROX) THEN
  ISIZE = KIND (SELF%GRPROX) * SIZE (SELF%GRPROX)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GRPROX'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGMIXP = ALLOCATED (SELF%GMIXP)
IF (LGMIXP) THEN
  ISIZE = KIND (SELF%GMIXP) * SIZE (SELF%GMIXP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GMIXP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGFLUXC = ALLOCATED (SELF%GFLUXC)
IF (LGFLUXC) THEN
  ISIZE = KIND (SELF%GFLUXC) * SIZE (SELF%GFLUXC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GFLUXC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGDEOSI = ALLOCATED (SELF%GDEOSI)
IF (LGDEOSI) THEN
  ISIZE = KIND (SELF%GDEOSI) * SIZE (SELF%GDEOSI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GDEOSI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGUEOSI = ALLOCATED (SELF%GUEOSI)
IF (LGUEOSI) THEN
  ISIZE = KIND (SELF%GUEOSI) * SIZE (SELF%GUEOSI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GUEOSI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGMU0 = ALLOCATED (SELF%GMU0)
IF (LGMU0) THEN
  ISIZE = KIND (SELF%GMU0) * SIZE (SELF%GMU0)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GMU0'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGMU0_MIN = ALLOCATED (SELF%GMU0_MIN)
IF (LGMU0_MIN) THEN
  ISIZE = KIND (SELF%GMU0_MIN) * SIZE (SELF%GMU0_MIN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GMU0_MIN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LGMU0_MAX = ALLOCATED (SELF%GMU0_MAX)
IF (LGMU0_MAX) THEN
  ISIZE = KIND (SELF%GMU0_MAX) * SIZE (SELF%GMU0_MAX)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%GMU0_MAX'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
