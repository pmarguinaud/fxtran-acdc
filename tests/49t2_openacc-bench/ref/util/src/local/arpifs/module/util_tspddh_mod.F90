MODULE UTIL_TSPDDH_MOD

USE YOMSPDDH, ONLY : TSPDDH

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TSPDDH
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TSPDDH
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TSPDDH
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TSPDDH
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TSPDDH
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TSPDDH
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TSPDDH
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TSPDDH (SELF, KLUN)

IMPLICIT NONE
TYPE (TSPDDH), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
LSPTNDHD_VOR = ALLOCATED (SELF%SPTNDHD_VOR)
WRITE (KLUN) LSPTNDHD_VOR
IF (LSPTNDHD_VOR) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDHD_VOR)
  WRITE (KLUN) UBOUND (SELF%SPTNDHD_VOR)
  WRITE (KLUN) SELF%SPTNDHD_VOR
ENDIF
LSPTNDHD_DIV = ALLOCATED (SELF%SPTNDHD_DIV)
WRITE (KLUN) LSPTNDHD_DIV
IF (LSPTNDHD_DIV) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDHD_DIV)
  WRITE (KLUN) UBOUND (SELF%SPTNDHD_DIV)
  WRITE (KLUN) SELF%SPTNDHD_DIV
ENDIF
LSPTNDHD_T = ALLOCATED (SELF%SPTNDHD_T)
WRITE (KLUN) LSPTNDHD_T
IF (LSPTNDHD_T) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDHD_T)
  WRITE (KLUN) UBOUND (SELF%SPTNDHD_T)
  WRITE (KLUN) SELF%SPTNDHD_T
ENDIF
LSPTNDHD_SPD = ALLOCATED (SELF%SPTNDHD_SPD)
WRITE (KLUN) LSPTNDHD_SPD
IF (LSPTNDHD_SPD) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDHD_SPD)
  WRITE (KLUN) UBOUND (SELF%SPTNDHD_SPD)
  WRITE (KLUN) SELF%SPTNDHD_SPD
ENDIF
LSPTNDHD_SVD = ALLOCATED (SELF%SPTNDHD_SVD)
WRITE (KLUN) LSPTNDHD_SVD
IF (LSPTNDHD_SVD) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDHD_SVD)
  WRITE (KLUN) UBOUND (SELF%SPTNDHD_SVD)
  WRITE (KLUN) SELF%SPTNDHD_SVD
ENDIF
LSPTNDHD_SNHX = ALLOCATED (SELF%SPTNDHD_SNHX)
WRITE (KLUN) LSPTNDHD_SNHX
IF (LSPTNDHD_SNHX) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDHD_SNHX)
  WRITE (KLUN) UBOUND (SELF%SPTNDHD_SNHX)
  WRITE (KLUN) SELF%SPTNDHD_SNHX
ENDIF
LSPTNDHD_GFL = ALLOCATED (SELF%SPTNDHD_GFL)
WRITE (KLUN) LSPTNDHD_GFL
IF (LSPTNDHD_GFL) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDHD_GFL)
  WRITE (KLUN) UBOUND (SELF%SPTNDHD_GFL)
  WRITE (KLUN) SELF%SPTNDHD_GFL
ENDIF
LSPTNDSI_VOR = ALLOCATED (SELF%SPTNDSI_VOR)
WRITE (KLUN) LSPTNDSI_VOR
IF (LSPTNDSI_VOR) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDSI_VOR)
  WRITE (KLUN) UBOUND (SELF%SPTNDSI_VOR)
  WRITE (KLUN) SELF%SPTNDSI_VOR
ENDIF
LSPTNDSI_DIV = ALLOCATED (SELF%SPTNDSI_DIV)
WRITE (KLUN) LSPTNDSI_DIV
IF (LSPTNDSI_DIV) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDSI_DIV)
  WRITE (KLUN) UBOUND (SELF%SPTNDSI_DIV)
  WRITE (KLUN) SELF%SPTNDSI_DIV
ENDIF
LSPTNDSI_T = ALLOCATED (SELF%SPTNDSI_T)
WRITE (KLUN) LSPTNDSI_T
IF (LSPTNDSI_T) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDSI_T)
  WRITE (KLUN) UBOUND (SELF%SPTNDSI_T)
  WRITE (KLUN) SELF%SPTNDSI_T
ENDIF
LSPTNDSI_SPD = ALLOCATED (SELF%SPTNDSI_SPD)
WRITE (KLUN) LSPTNDSI_SPD
IF (LSPTNDSI_SPD) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDSI_SPD)
  WRITE (KLUN) UBOUND (SELF%SPTNDSI_SPD)
  WRITE (KLUN) SELF%SPTNDSI_SPD
ENDIF
LSPTNDSI_SVD = ALLOCATED (SELF%SPTNDSI_SVD)
WRITE (KLUN) LSPTNDSI_SVD
IF (LSPTNDSI_SVD) THEN
  WRITE (KLUN) LBOUND (SELF%SPTNDSI_SVD)
  WRITE (KLUN) UBOUND (SELF%SPTNDSI_SVD)
  WRITE (KLUN) SELF%SPTNDSI_SVD
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TSPDDH (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TSPDDH), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL2(2), IU2(2), IL3(3), IU3(3)
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
READ (KLUN) LSPTNDHD_VOR
IF (LSPTNDHD_VOR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDHD_VOR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDHD_VOR,1):UBOUND(SELF%SPTNDHD_VOR,1), LBOUND(SELF%SPTNDHD_VOR,2):UBOUND(SELF%SPTNDHD_VOR,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDHD_VOR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_DIV
IF (LSPTNDHD_DIV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDHD_DIV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDHD_DIV,1):UBOUND(SELF%SPTNDHD_DIV,1), LBOUND(SELF%SPTNDHD_DIV,2):UBOUND(SELF%SPTNDHD_DIV,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDHD_DIV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_T
IF (LSPTNDHD_T) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDHD_T (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDHD_T,1):UBOUND(SELF%SPTNDHD_T,1), LBOUND(SELF%SPTNDHD_T,2):UBOUND(SELF%SPTNDHD_T,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDHD_T = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_SPD
IF (LSPTNDHD_SPD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDHD_SPD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDHD_SPD,1):UBOUND(SELF%SPTNDHD_SPD,1), LBOUND(SELF%SPTNDHD_SPD,2):UBOUND(SELF%SPTNDHD_SPD,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDHD_SPD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_SVD
IF (LSPTNDHD_SVD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDHD_SVD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDHD_SVD,1):UBOUND(SELF%SPTNDHD_SVD,1), LBOUND(SELF%SPTNDHD_SVD,2):UBOUND(SELF%SPTNDHD_SVD,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDHD_SVD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_SNHX
IF (LSPTNDHD_SNHX) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDHD_SNHX (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDHD_SNHX,1):UBOUND(SELF%SPTNDHD_SNHX,1), LBOUND(SELF%SPTNDHD_SNHX,2):UBOUND(SELF%SPTNDHD_SNHX,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDHD_SNHX = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDHD_GFL
IF (LSPTNDHD_GFL) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%SPTNDHD_GFL (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%SPTNDHD_GFL,1):UBOUND(SELF%SPTNDHD_GFL,1), LBOUND(SELF%SPTNDHD_GFL,2):UBOUND(SELF%SPTNDHD_GFL,2), LBOUND(SELF%SPTNDHD_GFL,3):UBOUND(SELF%SPTNDHD_GFL,3)))
  READ (KLUN) ZTMP3
  SELF%SPTNDHD_GFL = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LSPTNDSI_VOR
IF (LSPTNDSI_VOR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDSI_VOR (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDSI_VOR,1):UBOUND(SELF%SPTNDSI_VOR,1), LBOUND(SELF%SPTNDSI_VOR,2):UBOUND(SELF%SPTNDSI_VOR,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDSI_VOR = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_DIV
IF (LSPTNDSI_DIV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDSI_DIV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDSI_DIV,1):UBOUND(SELF%SPTNDSI_DIV,1), LBOUND(SELF%SPTNDSI_DIV,2):UBOUND(SELF%SPTNDSI_DIV,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDSI_DIV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_T
IF (LSPTNDSI_T) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDSI_T (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDSI_T,1):UBOUND(SELF%SPTNDSI_T,1), LBOUND(SELF%SPTNDSI_T,2):UBOUND(SELF%SPTNDSI_T,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDSI_T = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_SPD
IF (LSPTNDSI_SPD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDSI_SPD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDSI_SPD,1):UBOUND(SELF%SPTNDSI_SPD,1), LBOUND(SELF%SPTNDSI_SPD,2):UBOUND(SELF%SPTNDSI_SPD,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDSI_SPD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSPTNDSI_SVD
IF (LSPTNDSI_SVD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SPTNDSI_SVD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SPTNDSI_SVD,1):UBOUND(SELF%SPTNDSI_SVD,1), LBOUND(SELF%SPTNDSI_SVD,2):UBOUND(SELF%SPTNDSI_SVD,2)))
  READ (KLUN) ZTMP2
  SELF%SPTNDSI_SVD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TSPDDH (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSPDDH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LSPTNDHD_VOR = ALLOCATED (SELF%SPTNDHD_VOR)
IF (LSPTNDHD_VOR) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDHD_VOR)
  !$ACC UPDATE DEVICE (SELF%SPTNDHD_VOR)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDHD_VOR)
ENDIF

LSPTNDHD_DIV = ALLOCATED (SELF%SPTNDHD_DIV)
IF (LSPTNDHD_DIV) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDHD_DIV)
  !$ACC UPDATE DEVICE (SELF%SPTNDHD_DIV)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDHD_DIV)
ENDIF

LSPTNDHD_T = ALLOCATED (SELF%SPTNDHD_T)
IF (LSPTNDHD_T) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDHD_T)
  !$ACC UPDATE DEVICE (SELF%SPTNDHD_T)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDHD_T)
ENDIF

LSPTNDHD_SPD = ALLOCATED (SELF%SPTNDHD_SPD)
IF (LSPTNDHD_SPD) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDHD_SPD)
  !$ACC UPDATE DEVICE (SELF%SPTNDHD_SPD)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDHD_SPD)
ENDIF

LSPTNDHD_SVD = ALLOCATED (SELF%SPTNDHD_SVD)
IF (LSPTNDHD_SVD) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDHD_SVD)
  !$ACC UPDATE DEVICE (SELF%SPTNDHD_SVD)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDHD_SVD)
ENDIF

LSPTNDHD_SNHX = ALLOCATED (SELF%SPTNDHD_SNHX)
IF (LSPTNDHD_SNHX) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDHD_SNHX)
  !$ACC UPDATE DEVICE (SELF%SPTNDHD_SNHX)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDHD_SNHX)
ENDIF

LSPTNDHD_GFL = ALLOCATED (SELF%SPTNDHD_GFL)
IF (LSPTNDHD_GFL) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDHD_GFL)
  !$ACC UPDATE DEVICE (SELF%SPTNDHD_GFL)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDHD_GFL)
ENDIF

LSPTNDSI_VOR = ALLOCATED (SELF%SPTNDSI_VOR)
IF (LSPTNDSI_VOR) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDSI_VOR)
  !$ACC UPDATE DEVICE (SELF%SPTNDSI_VOR)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDSI_VOR)
ENDIF

LSPTNDSI_DIV = ALLOCATED (SELF%SPTNDSI_DIV)
IF (LSPTNDSI_DIV) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDSI_DIV)
  !$ACC UPDATE DEVICE (SELF%SPTNDSI_DIV)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDSI_DIV)
ENDIF

LSPTNDSI_T = ALLOCATED (SELF%SPTNDSI_T)
IF (LSPTNDSI_T) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDSI_T)
  !$ACC UPDATE DEVICE (SELF%SPTNDSI_T)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDSI_T)
ENDIF

LSPTNDSI_SPD = ALLOCATED (SELF%SPTNDSI_SPD)
IF (LSPTNDSI_SPD) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDSI_SPD)
  !$ACC UPDATE DEVICE (SELF%SPTNDSI_SPD)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDSI_SPD)
ENDIF

LSPTNDSI_SVD = ALLOCATED (SELF%SPTNDSI_SVD)
IF (LSPTNDSI_SVD) THEN
  !$ACC ENTER DATA CREATE (SELF%SPTNDSI_SVD)
  !$ACC UPDATE DEVICE (SELF%SPTNDSI_SVD)
  !$ACC ENTER DATA ATTACH (SELF%SPTNDSI_SVD)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TSPDDH (SELF)

IMPLICIT NONE
TYPE (TSPDDH), TARGET :: SELF
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TSPDDH (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TSPDDH), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDHD_VOR), CDPATH//'%SPTNDHD_VOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDHD_DIV), CDPATH//'%SPTNDHD_DIV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDHD_T), CDPATH//'%SPTNDHD_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDHD_SPD), CDPATH//'%SPTNDHD_SPD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDHD_SVD), CDPATH//'%SPTNDHD_SVD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDHD_SNHX), CDPATH//'%SPTNDHD_SNHX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDHD_GFL), CDPATH//'%SPTNDHD_GFL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDSI_VOR), CDPATH//'%SPTNDSI_VOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDSI_DIV), CDPATH//'%SPTNDSI_DIV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDSI_T), CDPATH//'%SPTNDSI_T'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDSI_SPD), CDPATH//'%SPTNDSI_SPD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SPTNDSI_SVD), CDPATH//'%SPTNDSI_SVD'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TSPDDH (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TSPDDH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LSPTNDHD_VOR = ALLOCATED (SELF%SPTNDHD_VOR)
IF (LSPTNDHD_VOR) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDHD_VOR)
  !$ACC EXIT DATA DELETE (SELF%SPTNDHD_VOR)
ENDIF

LSPTNDHD_DIV = ALLOCATED (SELF%SPTNDHD_DIV)
IF (LSPTNDHD_DIV) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDHD_DIV)
  !$ACC EXIT DATA DELETE (SELF%SPTNDHD_DIV)
ENDIF

LSPTNDHD_T = ALLOCATED (SELF%SPTNDHD_T)
IF (LSPTNDHD_T) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDHD_T)
  !$ACC EXIT DATA DELETE (SELF%SPTNDHD_T)
ENDIF

LSPTNDHD_SPD = ALLOCATED (SELF%SPTNDHD_SPD)
IF (LSPTNDHD_SPD) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDHD_SPD)
  !$ACC EXIT DATA DELETE (SELF%SPTNDHD_SPD)
ENDIF

LSPTNDHD_SVD = ALLOCATED (SELF%SPTNDHD_SVD)
IF (LSPTNDHD_SVD) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDHD_SVD)
  !$ACC EXIT DATA DELETE (SELF%SPTNDHD_SVD)
ENDIF

LSPTNDHD_SNHX = ALLOCATED (SELF%SPTNDHD_SNHX)
IF (LSPTNDHD_SNHX) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDHD_SNHX)
  !$ACC EXIT DATA DELETE (SELF%SPTNDHD_SNHX)
ENDIF

LSPTNDHD_GFL = ALLOCATED (SELF%SPTNDHD_GFL)
IF (LSPTNDHD_GFL) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDHD_GFL)
  !$ACC EXIT DATA DELETE (SELF%SPTNDHD_GFL)
ENDIF

LSPTNDSI_VOR = ALLOCATED (SELF%SPTNDSI_VOR)
IF (LSPTNDSI_VOR) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDSI_VOR)
  !$ACC EXIT DATA DELETE (SELF%SPTNDSI_VOR)
ENDIF

LSPTNDSI_DIV = ALLOCATED (SELF%SPTNDSI_DIV)
IF (LSPTNDSI_DIV) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDSI_DIV)
  !$ACC EXIT DATA DELETE (SELF%SPTNDSI_DIV)
ENDIF

LSPTNDSI_T = ALLOCATED (SELF%SPTNDSI_T)
IF (LSPTNDSI_T) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDSI_T)
  !$ACC EXIT DATA DELETE (SELF%SPTNDSI_T)
ENDIF

LSPTNDSI_SPD = ALLOCATED (SELF%SPTNDSI_SPD)
IF (LSPTNDSI_SPD) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDSI_SPD)
  !$ACC EXIT DATA DELETE (SELF%SPTNDSI_SPD)
ENDIF

LSPTNDSI_SVD = ALLOCATED (SELF%SPTNDSI_SVD)
IF (LSPTNDSI_SVD) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTNDSI_SVD)
  !$ACC EXIT DATA DELETE (SELF%SPTNDSI_SVD)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TSPDDH (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TSPDDH),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LSPTNDHD_DIV, LSPTNDHD_GFL, LSPTNDHD_SNHX, LSPTNDHD_SPD, LSPTNDHD_SVD, LSPTNDHD_T, LSPTNDHD_VOR, LSPTNDSI_DIV, LSPTNDSI_SPD, LSPTNDSI_SVD
LOGICAL :: LSPTNDSI_T, LSPTNDSI_VOR
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LSPTNDHD_VOR = ALLOCATED (SELF%SPTNDHD_VOR)
IF (LSPTNDHD_VOR) THEN
  ISIZE = KIND (SELF%SPTNDHD_VOR) * SIZE (SELF%SPTNDHD_VOR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_VOR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_DIV = ALLOCATED (SELF%SPTNDHD_DIV)
IF (LSPTNDHD_DIV) THEN
  ISIZE = KIND (SELF%SPTNDHD_DIV) * SIZE (SELF%SPTNDHD_DIV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_DIV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_T = ALLOCATED (SELF%SPTNDHD_T)
IF (LSPTNDHD_T) THEN
  ISIZE = KIND (SELF%SPTNDHD_T) * SIZE (SELF%SPTNDHD_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_SPD = ALLOCATED (SELF%SPTNDHD_SPD)
IF (LSPTNDHD_SPD) THEN
  ISIZE = KIND (SELF%SPTNDHD_SPD) * SIZE (SELF%SPTNDHD_SPD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_SPD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_SVD = ALLOCATED (SELF%SPTNDHD_SVD)
IF (LSPTNDHD_SVD) THEN
  ISIZE = KIND (SELF%SPTNDHD_SVD) * SIZE (SELF%SPTNDHD_SVD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_SVD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_SNHX = ALLOCATED (SELF%SPTNDHD_SNHX)
IF (LSPTNDHD_SNHX) THEN
  ISIZE = KIND (SELF%SPTNDHD_SNHX) * SIZE (SELF%SPTNDHD_SNHX)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_SNHX'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDHD_GFL = ALLOCATED (SELF%SPTNDHD_GFL)
IF (LSPTNDHD_GFL) THEN
  ISIZE = KIND (SELF%SPTNDHD_GFL) * SIZE (SELF%SPTNDHD_GFL)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDHD_GFL'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_VOR = ALLOCATED (SELF%SPTNDSI_VOR)
IF (LSPTNDSI_VOR) THEN
  ISIZE = KIND (SELF%SPTNDSI_VOR) * SIZE (SELF%SPTNDSI_VOR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_VOR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_DIV = ALLOCATED (SELF%SPTNDSI_DIV)
IF (LSPTNDSI_DIV) THEN
  ISIZE = KIND (SELF%SPTNDSI_DIV) * SIZE (SELF%SPTNDSI_DIV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_DIV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_T = ALLOCATED (SELF%SPTNDSI_T)
IF (LSPTNDSI_T) THEN
  ISIZE = KIND (SELF%SPTNDSI_T) * SIZE (SELF%SPTNDSI_T)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_T'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_SPD = ALLOCATED (SELF%SPTNDSI_SPD)
IF (LSPTNDSI_SPD) THEN
  ISIZE = KIND (SELF%SPTNDSI_SPD) * SIZE (SELF%SPTNDSI_SPD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_SPD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSPTNDSI_SVD = ALLOCATED (SELF%SPTNDSI_SVD)
IF (LSPTNDSI_SVD) THEN
  ISIZE = KIND (SELF%SPTNDSI_SVD) * SIZE (SELF%SPTNDSI_SVD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SPTNDSI_SVD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
