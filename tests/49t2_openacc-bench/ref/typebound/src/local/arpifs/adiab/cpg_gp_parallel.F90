SUBROUTINE CPG_GP_PARALLEL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_TND, YDCPG_MISC, YDCPG_GPAR,&
& YDCPG_DYN0, YDCPG_DYN9, YDHGRAD, YDMF_PHYS_SURF, YDVARS, YDMODEL, YDCPG_SL2, YDPGTERM, YDDDH)
USE TYPE_MODEL,ONLY:MODEL
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_GPAR_TYPE, CPG_MISC_TYPE, CPG_TND_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE YOMDGRADIENT_TYPE_MOD,ONLY:GRADIENT_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE DDH_MIX,ONLY:TYP_DDH

USE YOMHOOK,ONLY:DR_HOOK, LHOOK, JPHOOK
USE INTDYN_MOD,ONLY:TPG_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_TND_TYPE), INTENT (INOUT)::YDCPG_TND
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_GPAR_TYPE), INTENT (INOUT)::YDCPG_GPAR
TYPE (CPG_DYN_TYPE), INTENT (INOUT)::YDCPG_DYN0
TYPE (CPG_DYN_TYPE), INTENT (INOUT)::YDCPG_DYN9
TYPE (GRADIENT_TYPE), INTENT (INOUT)::YDHGRAD
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (CPG_SL2_TYPE), INTENT (INOUT)::YDCPG_SL2
TYPE (TPG_TYPE), INTENT (INOUT)::YDPGTERM
TYPE (TYP_DDH), INTENT (INOUT)::YDDDH
#include "abor1.intfb.h"
#include "gpinislb_part1_expl.intfb.h"
#include "gpinislb_part1_expl_openacc.intfb.h"
#include "gpinislb_part2_expl_parallel.intfb.h"
#include "gpinislb_part3_expl.intfb.h"
#include "gpinislb_part3_expl_openacc.intfb.h"
#include "gpmpfc_expl_parallel.intfb.h"
#include "gp_spv.intfb.h"
#include "gp_spv_openacc.intfb.h"
#include "gptf2_expl_2tl.intfb.h"
#include "gptf2_expl_2tl_openacc.intfb.h"
#include "cpg_gp_hyd_parallel.intfb.h"
CLASS (FIELD_3RB), POINTER :: YL_Z_GDW_T0
REAL (KIND=JPRB), POINTER::Z_GDW_T0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_Z_GWHT_T0
REAL (KIND=JPRB), POINTER::Z_GWHT_T0 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_Z_OROGLL_T0
REAL (KIND=JPRB), POINTER::Z_OROGLL_T0 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_Z_OROGLM_T0
REAL (KIND=JPRB), POINTER::Z_OROGLM_T0 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_Z_OROGMM_T0
REAL (KIND=JPRB), POINTER::Z_OROGMM_T0 (:,:)
INTEGER (KIND=JPIM)::JGFL
INTEGER (KIND=JPIM)::IFLAG
INTEGER (KIND=JPIM)::JROF
LOGICAL::LLSTR
REAL (KIND=JPRB)::ZEPS
REAL (KIND=JPRB)::ZGM2
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_VVEL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_GWFT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_OROGL(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_OROGM(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PREL(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PREM(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_NHX(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_PRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_PREL(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_PREM(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QGRAUPEL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QICE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QLI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QRAIN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QSNOW(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_GDW(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_GWF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_GWS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_VVEL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROGLL_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROGLM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROGL_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROGMM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROGM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_G_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_G_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_I_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_I_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_L_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_L_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_NHX_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_R_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_R_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DL(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DL9(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DM(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DM9(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_T1(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_T9(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_S_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_S_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T9(:,:,:)
IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_Z_OROGMM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_OROGLM_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_OROGLL_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_GWHT_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_Z_GDW_T0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)



ZEPS=100.0_JPRB*TINY (1.0_JPRB)
LLSTR=(ABS (YDGEOMETRY%YRGEM%RSTRET-1.0_JPRB)>ZEPS)

IF (YDMODEL%YRML_DYN%YRSPNG%LNSPONGE) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN

  IF (YDMODEL%YRML_DYN%YRDYNA%LTWOTL) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_PARALLEL:GPTF2_EXPL_2TL')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
      Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
      Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
      Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        CALL GPTF2_EXPL_2TL (YDGEOMETRY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
        &%LFSTEP, P0U=Z_YDVARS_U_T0(:,:, JBLK), P0V=Z_YDVARS_V_T0(:,:, JBLK), P9U&
        &=Z_YDVARS_U_T9(:,:, JBLK), P9V=Z_YDVARS_V_T9(:,:, JBLK))
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
        Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
        Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
        Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_U_T0 => NULL ()
      Z_YDVARS_U_T9 => NULL ()
      Z_YDVARS_V_T0 => NULL ()
      Z_YDVARS_V_T9 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_PARALLEL:GPTF2_EXPL_2TL')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
      Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
      Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
      Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          
          CALL GPTF2_EXPL_2TL_OPENACC (YDGEOMETRY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
          &%LFSTEP, P0U=Z_YDVARS_U_T0(:,:, JBLK), P0V=Z_YDVARS_V_T0(:,:, JBLK), P9U=Z_YDVARS_U_T9&
          &(:,:, JBLK), P9V=Z_YDVARS_V_T9(:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
        Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
        Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
        Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_U_T0 => NULL ()
      Z_YDVARS_U_T9 => NULL ()
      Z_YDVARS_V_T0 => NULL ()
      Z_YDVARS_V_T9 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_PARALLEL:GPTF2_EXPL_2TL')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT0)
      Z_YDVARS_U_T9 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT9)
      Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT0)
      Z_YDVARS_V_T9 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT9)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YFXTRAN_ACDC_STACK, Z_YDVARS_U_T0, &
        !$ACC&         Z_YDVARS_U_T9, Z_YDVARS_V_T0, Z_YDVARS_V_T9) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
          
          CALL GPTF2_EXPL_2TL_OPENACC (YDGEOMETRY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
          &%LFSTEP, P0U=Z_YDVARS_U_T0(:,:, JBLK), P0V=Z_YDVARS_V_T0(:,:, JBLK), P9U=Z_YDVARS_U_T9&
          &(:,:, JBLK), P9V=Z_YDVARS_V_T9(:,:, JBLK),YDSTACK=YLSTACK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
        Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
        Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
        Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_U_T0 => NULL ()
      Z_YDVARS_U_T9 => NULL ()
      Z_YDVARS_V_T0 => NULL ()
      Z_YDVARS_V_T9 => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPTF2_EXPL_2TL',1,ZHOOK_HANDLE_PARALLEL)
  ELSE
    
    
    
    CALL ABOR1 ("ERROR: WRONG SETTINGS")
    
  ENDIF

ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_PARALLEL:MAP_FACTOR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_OROGLL_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLL_T0)
  Z_OROGLM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLM_T0)
  Z_OROGMM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGMM_T0)
  Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
  Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  Z_YDVARS_GEOMETRY_OROGLL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGLL%FT0)
  Z_YDVARS_GEOMETRY_OROGLM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGLM%FT0)
  Z_YDVARS_GEOMETRY_OROGL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGL%FT0)
  Z_YDVARS_GEOMETRY_OROGMM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGMM%FT0)
  Z_YDVARS_GEOMETRY_OROGM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGM%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, ZGM2) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    Z_YDCPG_DYN0_OROGL (:, JBLK)=Z_YDVARS_GEOMETRY_OROGL_T0 (:, JBLK)*Z_YDVARS_GEOMETRY_GM_T0 (:, JBLK)
    Z_YDCPG_DYN0_OROGM (:, JBLK)=Z_YDVARS_GEOMETRY_OROGM_T0 (:, JBLK)*Z_YDVARS_GEOMETRY_GM_T0 (:, JBLK)

    IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN) THEN

      DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZGM2=Z_YDVARS_GEOMETRY_GM_T0 (JROF, JBLK)**2
        Z_OROGLL_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGLL_T0 (JROF, JBLK)*ZGM2
        Z_OROGMM_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGMM_T0 (JROF, JBLK)*ZGM2
        Z_OROGLM_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGLM_T0 (JROF, JBLK)*ZGM2
      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:MAP_FACTOR')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_OROGLL_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLL_T0)
    Z_OROGLM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLM_T0)
    Z_OROGMM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGMM_T0)
    Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
    Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    Z_YDVARS_GEOMETRY_OROGLL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGLL%FT0)
    Z_YDVARS_GEOMETRY_OROGLM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGLM%FT0)
    Z_YDVARS_GEOMETRY_OROGL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGL%FT0)
    Z_YDVARS_GEOMETRY_OROGMM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGMM%FT0)
    Z_YDVARS_GEOMETRY_OROGM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGM%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_OROGLL_T0 => NULL ()
  Z_OROGLM_T0 => NULL ()
  Z_OROGMM_T0 => NULL ()
  Z_YDCPG_DYN0_OROGL => NULL ()
  Z_YDCPG_DYN0_OROGM => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGLL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGLM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGMM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_PARALLEL:MAP_FACTOR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_OROGLL_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLL_T0)
  Z_OROGLM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLM_T0)
  Z_OROGMM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGMM_T0)
  Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
  Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  Z_YDVARS_GEOMETRY_OROGLL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGLL%FT0)
  Z_YDVARS_GEOMETRY_OROGLM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGLM%FT0)
  Z_YDVARS_GEOMETRY_OROGL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGL%FT0)
  Z_YDVARS_GEOMETRY_OROGMM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGMM%FT0)
  Z_YDVARS_GEOMETRY_OROGM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROGM%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, ZGM2)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      
      Z_YDCPG_DYN0_OROGL (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGL_T0&
      & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GM_T0 (JROF, JBLK)
      Z_YDCPG_DYN0_OROGM (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGM_T0&
      & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GM_T0 (JROF, JBLK)

      IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN) THEN
        
        ZGM2=Z_YDVARS_GEOMETRY_GM_T0 (JROF, JBLK)**2
        Z_OROGLL_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGLL_T0 (JROF, JBLK)*ZGM2
        Z_OROGMM_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGMM_T0 (JROF, JBLK)*ZGM2
        Z_OROGLM_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGLM_T0 (JROF, JBLK)*ZGM2
      
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:MAP_FACTOR')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_OROGLL_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLL_T0)
    Z_OROGLM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLM_T0)
    Z_OROGMM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGMM_T0)
    Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
    Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    Z_YDVARS_GEOMETRY_OROGLL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGLL%FT0)
    Z_YDVARS_GEOMETRY_OROGLM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGLM%FT0)
    Z_YDVARS_GEOMETRY_OROGL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGL%FT0)
    Z_YDVARS_GEOMETRY_OROGMM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGMM%FT0)
    Z_YDVARS_GEOMETRY_OROGM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGM%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_OROGLL_T0 => NULL ()
  Z_OROGLM_T0 => NULL ()
  Z_OROGMM_T0 => NULL ()
  Z_YDCPG_DYN0_OROGL => NULL ()
  Z_YDCPG_DYN0_OROGM => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGLL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGLM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGMM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_PARALLEL:MAP_FACTOR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_OROGLL_T0 => GET_DEVICE_DATA_RDWR (YL_Z_OROGLL_T0)
  Z_OROGLM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_OROGLM_T0)
  Z_OROGMM_T0 => GET_DEVICE_DATA_RDWR (YL_Z_OROGMM_T0)
  Z_YDCPG_DYN0_OROGL => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_OROGL)
  Z_YDCPG_DYN0_OROGM => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_OROGM)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  Z_YDVARS_GEOMETRY_OROGLL_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROGLL%FT0)
  Z_YDVARS_GEOMETRY_OROGLM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROGLM%FT0)
  Z_YDVARS_GEOMETRY_OROGL_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROGL%FT0)
  Z_YDVARS_GEOMETRY_OROGMM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROGMM%FT0)
  Z_YDVARS_GEOMETRY_OROGM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROGM%FT0)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, Z_OROGLL_T0, Z_OROGLM_T0, &
    !$ACC&         Z_OROGMM_T0, Z_YDCPG_DYN0_OROGL, Z_YDCPG_DYN0_OROGM, Z_YDVARS_GEOMETRY_GM_T0, &
    !$ACC&         Z_YDVARS_GEOMETRY_OROGLL_T0, Z_YDVARS_GEOMETRY_OROGLM_T0, &
    !$ACC&         Z_YDVARS_GEOMETRY_OROGL_T0, Z_YDVARS_GEOMETRY_OROGMM_T0, &
    !$ACC&         Z_YDVARS_GEOMETRY_OROGM_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JROF, YLCPG_BNDS, ZGM2) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      
      Z_YDCPG_DYN0_OROGL (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGL_T0&
      & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GM_T0 (JROF, JBLK)
      Z_YDCPG_DYN0_OROGM (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGM_T0&
      & (JROF, JBLK)*Z_YDVARS_GEOMETRY_GM_T0 (JROF, JBLK)

      IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN) THEN
        
        ZGM2=Z_YDVARS_GEOMETRY_GM_T0 (JROF, JBLK)**2
        Z_OROGLL_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGLL_T0 (JROF, JBLK)*ZGM2
        Z_OROGMM_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGMM_T0 (JROF, JBLK)*ZGM2
        Z_OROGLM_T0 (JROF, JBLK)=Z_YDVARS_GEOMETRY_OROGLM_T0 (JROF, JBLK)*ZGM2
      
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:MAP_FACTOR')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_OROGLL_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLL_T0)
    Z_OROGLM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGLM_T0)
    Z_OROGMM_T0 => GET_HOST_DATA_RDWR (YL_Z_OROGMM_T0)
    Z_YDCPG_DYN0_OROGL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGL)
    Z_YDCPG_DYN0_OROGM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_OROGM)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    Z_YDVARS_GEOMETRY_OROGLL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGLL%FT0)
    Z_YDVARS_GEOMETRY_OROGLM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGLM%FT0)
    Z_YDVARS_GEOMETRY_OROGL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGL%FT0)
    Z_YDVARS_GEOMETRY_OROGMM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGMM%FT0)
    Z_YDVARS_GEOMETRY_OROGM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROGM%FT0)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_OROGLL_T0 => NULL ()
  Z_OROGLM_T0 => NULL ()
  Z_OROGMM_T0 => NULL ()
  Z_YDCPG_DYN0_OROGL => NULL ()
  Z_YDCPG_DYN0_OROGM => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGLL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGLM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGMM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_OROGM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:MAP_FACTOR',1,ZHOOK_HANDLE_PARALLEL)

IF (LLSTR.AND.(.NOT.YDMODEL%YRML_DYN%YRDYNA%LPGFSF)) THEN
  IFLAG=0
  CALL GPMPFC_EXPL_PARALLEL (YDVARS, YDMODEL%YRML_GCONF, YDMODEL%YRML_DYN%YRDYN, YDMODEL&
  &%YRML_DYN%YRDYNA, YDCPG_OPTS, YDCPG_BNDS, IFLAG, YDVARS%GEOMETRY%GM%FT0)
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_PARALLEL:GP_SPV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
  Z_YDCPG_DYN9_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREL)
  Z_YDCPG_DYN9_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREM)
  Z_YDVARS_SP_DL => GET_HOST_DATA_RDONLY (YDVARS%SP%FDL)
  Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FDL9)
  Z_YDVARS_SP_DM => GET_HOST_DATA_RDONLY (YDVARS%SP%FDM)
  Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FDM9)
  Z_YDVARS_SP_T0 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT0)
  Z_YDVARS_SP_T9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT9)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL GP_SPV (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYN, YDMODEL%YRML_DYN%YRDYNA, YDMODEL%YRML_PHY_MF%YRSIMPHL&
    &,.FALSE., YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_SP_T0(:, JBLK), Z_YDVARS_SP_DL(:, JBLK)&
    &, Z_YDVARS_SP_DM(:, JBLK), Z_YDVARS_SP_T9(:, JBLK), Z_YDVARS_SP_DL9(:, JBLK), Z_YDVARS_SP_DM9(&
    &:, JBLK), Z_YDCPG_DYN0_PRE(:,:, JBLK), Z_YDCPG_DYN0_PREL(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK),&
    & Z_YDCPG_DYN9_PRE(:,:, JBLK), Z_YDCPG_DYN9_PREL(:, JBLK), Z_YDCPG_DYN9_PREM(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GP_SPV')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
    Z_YDCPG_DYN9_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREL)
    Z_YDCPG_DYN9_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREM)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
    Z_YDVARS_SP_T0 => GET_HOST_DATA_RDWR (YDVARS%SP%FT0)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN9_PRE => NULL ()
  Z_YDCPG_DYN9_PREL => NULL ()
  Z_YDCPG_DYN9_PREM => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DL9 => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_DM9 => NULL ()
  Z_YDVARS_SP_T0 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_PARALLEL:GP_SPV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
  Z_YDCPG_DYN9_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREL)
  Z_YDCPG_DYN9_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREM)
  Z_YDVARS_SP_DL => GET_HOST_DATA_RDONLY (YDVARS%SP%FDL)
  Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FDL9)
  Z_YDVARS_SP_DM => GET_HOST_DATA_RDONLY (YDVARS%SP%FDM)
  Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FDM9)
  Z_YDVARS_SP_T0 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT0)
  Z_YDVARS_SP_T9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT9)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GP_SPV_OPENACC (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYN, YDMODEL%YRML_DYN%YRDYNA, YDMODEL%YRML_PHY_MF&
      &%YRSIMPHL,.FALSE., YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_SP_T0(:, JBLK), Z_YDVARS_SP_DL(:, JBLK&
      &), Z_YDVARS_SP_DM(:, JBLK), Z_YDVARS_SP_T9(:, JBLK), Z_YDVARS_SP_DL9(:, JBLK), Z_YDVARS_SP_DM9(:, JBLK&
      &), Z_YDCPG_DYN0_PRE(:,:, JBLK), Z_YDCPG_DYN0_PREL(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK), Z_YDCPG_DYN9_PRE&
      &(:,:, JBLK), Z_YDCPG_DYN9_PREL(:, JBLK), Z_YDCPG_DYN9_PREM(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GP_SPV')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
    Z_YDCPG_DYN9_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREL)
    Z_YDCPG_DYN9_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREM)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
    Z_YDVARS_SP_T0 => GET_HOST_DATA_RDWR (YDVARS%SP%FT0)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN9_PRE => NULL ()
  Z_YDCPG_DYN9_PREL => NULL ()
  Z_YDCPG_DYN9_PREM => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DL9 => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_DM9 => NULL ()
  Z_YDVARS_SP_T0 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_PARALLEL:GP_SPV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_PRE => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREL => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PREL)
  Z_YDCPG_DYN0_PREM => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%F_PREM)
  Z_YDCPG_DYN9_PRE => GET_DEVICE_DATA_RDWR (YDCPG_DYN9%F_PRE)
  Z_YDCPG_DYN9_PREL => GET_DEVICE_DATA_RDWR (YDCPG_DYN9%F_PREL)
  Z_YDCPG_DYN9_PREM => GET_DEVICE_DATA_RDWR (YDCPG_DYN9%F_PREM)
  Z_YDVARS_SP_DL => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FDL)
  Z_YDVARS_SP_DL9 => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FDL9)
  Z_YDVARS_SP_DM => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FDM)
  Z_YDVARS_SP_DM9 => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FDM9)
  Z_YDVARS_SP_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FT0)
  Z_YDVARS_SP_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FT9)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDCPG_DYN0_PRE, &
    !$ACC&         Z_YDCPG_DYN0_PREL, Z_YDCPG_DYN0_PREM, Z_YDCPG_DYN9_PRE, Z_YDCPG_DYN9_PREL, &
    !$ACC&         Z_YDCPG_DYN9_PREM, Z_YDVARS_SP_DL, Z_YDVARS_SP_DL9, Z_YDVARS_SP_DM, &
    !$ACC&         Z_YDVARS_SP_DM9, Z_YDVARS_SP_T0, Z_YDVARS_SP_T9) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GP_SPV_OPENACC (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYN, YDMODEL%YRML_DYN%YRDYNA, YDMODEL%YRML_PHY_MF&
      &%YRSIMPHL,.FALSE., YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDVARS_SP_T0(:, JBLK), Z_YDVARS_SP_DL(:, JBLK&
      &), Z_YDVARS_SP_DM(:, JBLK), Z_YDVARS_SP_T9(:, JBLK), Z_YDVARS_SP_DL9(:, JBLK), Z_YDVARS_SP_DM9(:, JBLK&
      &), Z_YDCPG_DYN0_PRE(:,:, JBLK), Z_YDCPG_DYN0_PREL(:, JBLK), Z_YDCPG_DYN0_PREM(:, JBLK), Z_YDCPG_DYN9_PRE&
      &(:,:, JBLK), Z_YDCPG_DYN9_PREL(:, JBLK), Z_YDCPG_DYN9_PREM(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GP_SPV')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREL)
    Z_YDCPG_DYN0_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREM)
    Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
    Z_YDCPG_DYN9_PREL => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREL)
    Z_YDCPG_DYN9_PREM => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREM)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
    Z_YDVARS_SP_T0 => GET_HOST_DATA_RDWR (YDVARS%SP%FT0)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREL => NULL ()
  Z_YDCPG_DYN0_PREM => NULL ()
  Z_YDCPG_DYN9_PRE => NULL ()
  Z_YDCPG_DYN9_PREL => NULL ()
  Z_YDCPG_DYN9_PREM => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DL9 => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_DM9 => NULL ()
  Z_YDVARS_SP_T0 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GP_SPV',1,ZHOOK_HANDLE_PARALLEL)

IF (YDCPG_OPTS%LSFORC.AND.YDCPG_OPTS%LSPS_FRC) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN

  IF (YDCPG_OPTS%LDIAB.OR.YDMODEL%YRML_PHY_SLIN%YRPHLC%LSPHLC&
    &.OR.YDMODEL%YRML_PHY_MF%YRSIMPHL%LSIMPH) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_PARALLEL:SETZERO')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        Z_YDCPG_MISC_QS (:, JBLK)=0.0_JPRB
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SETZERO')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_MISC_QS => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_GP_PARALLEL:SETZERO')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          
          Z_YDCPG_MISC_QS (JROF, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SETZERO')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_MISC_QS => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_GP_PARALLEL:SETZERO')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QS)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDCPG_MISC_QS) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF
          
          Z_YDCPG_MISC_QS (JROF, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SETZERO')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_MISC_QS => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SETZERO',1,ZHOOK_HANDLE_PARALLEL)

    IF (YDCPG_OPTS%LFSTEP.AND..NOT.YDMODEL%YRML_DYN%YRDYNA%LTWOTL) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('UPDATEVIEW','CPG_GP_PARALLEL:SET9TO0')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        CALL YDMF_PHYS_SURF%ACDC_HOST ()
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YDMF_PHYS_SURF%UPDATE_VIEW (JBLK)
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL YDMF_PHYS_SURF%SET9TO0 (YDCPG_OPTS, YLCPG_BNDS)
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SET9TO0')) THEN
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET9TO0',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

  ENDIF


  IF (YDCPG_OPTS%LDIAB) THEN

    IF (YDMODEL%YRML_PHY_G%YRDPHY%NTOZ3D>0.OR.YDMODEL%YRML_PHY_G%YRDPHY%NTOZ2D>0.OR.YDMODEL&
      &%YRML_PHY_G%YRDPHY%NTOZ1D>0.AND.(.NOT.YDMODEL%YRML_PHY_EC%YREPHY%LEO3CH)) THEN
      
      
      CALL ABOR1 ("ERROR: WRONG SETTINGS")
      
    ENDIF

  ENDIF


  IF (YDCPG_OPTS%LNUDG.AND.(.NOT.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE)) THEN
    
    
    CALL ABOR1 ("ERROR: WRONG SETTINGS")
    
  ENDIF

ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LNHQE) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSEIF (YDMODEL%YRML_DYN%YRDYNA%LNHEE) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSEIF (YDMODEL%YRML_DYN%YRDYNA%LNHHY) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSEIF (YDMODEL%YRML_DYN%YRDYNA%LSACC) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSE
  CALL CPG_GP_HYD_PARALLEL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDVARS, YDCPG_DYN0, YDCPG_DYN9, YDMODEL&
  &, YL_Z_OROGLL_T0, YL_Z_OROGMM_T0, YL_Z_OROGLM_T0, YL_Z_GDW_T0, YL_Z_GWHT_T0, YDCPG_TND)
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_PARALLEL:GPINISLB_PART1_EXPL')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN9_NHX => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_NHX)
  Z_YDCPG_MISC_QGRAUPEL => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QGRAUPEL)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDCPG_MISC_QRAIN => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QRAIN)
  Z_YDCPG_MISC_QSNOW => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QSNOW)
  Z_YDVARS_G_T0 => GET_HOST_DATA_RDONLY (YDVARS%G%FT0)
  Z_YDVARS_G_T9 => GET_HOST_DATA_RDONLY (YDVARS%G%FT9)
  Z_YDVARS_I_T0 => GET_HOST_DATA_RDONLY (YDVARS%I%FT0)
  Z_YDVARS_I_T9 => GET_HOST_DATA_RDONLY (YDVARS%I%FT9)
  Z_YDVARS_L_T0 => GET_HOST_DATA_RDONLY (YDVARS%L%FT0)
  Z_YDVARS_L_T9 => GET_HOST_DATA_RDONLY (YDVARS%L%FT9)
  Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
  Z_YDVARS_R_T0 => GET_HOST_DATA_RDONLY (YDVARS%R%FT0)
  Z_YDVARS_R_T9 => GET_HOST_DATA_RDONLY (YDVARS%R%FT9)
  Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
  Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SPD%FT9)
  Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
  Z_YDVARS_SP_T9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT9)
  Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
  Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SVD%FT9)
  Z_YDVARS_S_T0 => GET_HOST_DATA_RDONLY (YDVARS%S%FT0)
  Z_YDVARS_S_T9 => GET_HOST_DATA_RDONLY (YDVARS%S%FT9)
  Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
  Z_YDVARS_T_T9 => GET_HOST_DATA_RDONLY (YDVARS%T%FT9)
  Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
  Z_YDVARS_U_T9 => GET_HOST_DATA_RDONLY (YDVARS%U%FT9)
  Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
  Z_YDVARS_V_T9 => GET_HOST_DATA_RDONLY (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL GPINISLB_PART1_EXPL (YDGEOMETRY, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_DYN%YRDYN, YDMODEL%YRML_DYN&
    &%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%ZTE, Z_YDVARS_U_T9(:,:, JBLK), Z_YDVARS_V_T9&
    &(:,:, JBLK), Z_YDVARS_T_T9(:,:, JBLK), Z_YDVARS_SPD_T9(:,:, JBLK), Z_YDVARS_SVD_T9(:,:, JBLK), Z_YDCPG_DYN9_NHX&
    &(:,:, JBLK), Z_YDVARS_SP_T9(:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDVARS_V_T1(:,:, JBLK), Z_YDVARS_T_T1&
    &(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK), Z_YDVARS_NHX_T1(:,:, JBLK), Z_YDVARS_SP_T1&
    &(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDCPG_MISC_QRAIN(:,:, JBLK),&
    & Z_YDCPG_MISC_QSNOW(:,:, JBLK), Z_YDCPG_MISC_QGRAUPEL(:,:, JBLK), PL0=Z_YDVARS_L_T0(:,:, JBLK), PL9=Z_YDVARS_L_T9&
    &(:,:, JBLK), PI0=Z_YDVARS_I_T0(:,:, JBLK), PI9=Z_YDVARS_I_T9(:,:, JBLK), PR0=Z_YDVARS_R_T0(:,:, JBLK&
    &), PR9=Z_YDVARS_R_T9(:,:, JBLK), PS0=Z_YDVARS_S_T0(:,:, JBLK), PS9=Z_YDVARS_S_T9(:,:, JBLK), PG0=Z_YDVARS_G_T0&
    &(:,:, JBLK), PG9=Z_YDVARS_G_T9(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN9_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHX)
    Z_YDCPG_MISC_QGRAUPEL => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QGRAUPEL)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDCPG_MISC_QRAIN => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QRAIN)
    Z_YDCPG_MISC_QSNOW => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QSNOW)
    Z_YDVARS_G_T0 => GET_HOST_DATA_RDWR (YDVARS%G%FT0)
    Z_YDVARS_G_T9 => GET_HOST_DATA_RDWR (YDVARS%G%FT9)
    Z_YDVARS_I_T0 => GET_HOST_DATA_RDWR (YDVARS%I%FT0)
    Z_YDVARS_I_T9 => GET_HOST_DATA_RDWR (YDVARS%I%FT9)
    Z_YDVARS_L_T0 => GET_HOST_DATA_RDWR (YDVARS%L%FT0)
    Z_YDVARS_L_T9 => GET_HOST_DATA_RDWR (YDVARS%L%FT9)
    Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
    Z_YDVARS_R_T0 => GET_HOST_DATA_RDWR (YDVARS%R%FT0)
    Z_YDVARS_R_T9 => GET_HOST_DATA_RDWR (YDVARS%R%FT9)
    Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
    Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT9)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT9)
    Z_YDVARS_S_T0 => GET_HOST_DATA_RDWR (YDVARS%S%FT0)
    Z_YDVARS_S_T9 => GET_HOST_DATA_RDWR (YDVARS%S%FT9)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    Z_YDVARS_T_T9 => GET_HOST_DATA_RDWR (YDVARS%T%FT9)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN9_NHX => NULL ()
  Z_YDCPG_MISC_QGRAUPEL => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDCPG_MISC_QRAIN => NULL ()
  Z_YDCPG_MISC_QSNOW => NULL ()
  Z_YDVARS_G_T0 => NULL ()
  Z_YDVARS_G_T9 => NULL ()
  Z_YDVARS_I_T0 => NULL ()
  Z_YDVARS_I_T9 => NULL ()
  Z_YDVARS_L_T0 => NULL ()
  Z_YDVARS_L_T9 => NULL ()
  Z_YDVARS_NHX_T1 => NULL ()
  Z_YDVARS_R_T0 => NULL ()
  Z_YDVARS_R_T9 => NULL ()
  Z_YDVARS_SPD_T1 => NULL ()
  Z_YDVARS_SPD_T9 => NULL ()
  Z_YDVARS_SP_T1 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  Z_YDVARS_SVD_T1 => NULL ()
  Z_YDVARS_SVD_T9 => NULL ()
  Z_YDVARS_S_T0 => NULL ()
  Z_YDVARS_S_T9 => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  Z_YDVARS_T_T9 => NULL ()
  Z_YDVARS_U_T1 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_V_T1 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','CPG_GP_PARALLEL:GPINISLB_PART1_EXPL')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN9_NHX => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_NHX)
  Z_YDCPG_MISC_QGRAUPEL => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QGRAUPEL)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDCPG_MISC_QRAIN => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QRAIN)
  Z_YDCPG_MISC_QSNOW => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QSNOW)
  Z_YDVARS_G_T0 => GET_HOST_DATA_RDONLY (YDVARS%G%FT0)
  Z_YDVARS_G_T9 => GET_HOST_DATA_RDONLY (YDVARS%G%FT9)
  Z_YDVARS_I_T0 => GET_HOST_DATA_RDONLY (YDVARS%I%FT0)
  Z_YDVARS_I_T9 => GET_HOST_DATA_RDONLY (YDVARS%I%FT9)
  Z_YDVARS_L_T0 => GET_HOST_DATA_RDONLY (YDVARS%L%FT0)
  Z_YDVARS_L_T9 => GET_HOST_DATA_RDONLY (YDVARS%L%FT9)
  Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
  Z_YDVARS_R_T0 => GET_HOST_DATA_RDONLY (YDVARS%R%FT0)
  Z_YDVARS_R_T9 => GET_HOST_DATA_RDONLY (YDVARS%R%FT9)
  Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
  Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SPD%FT9)
  Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
  Z_YDVARS_SP_T9 => GET_HOST_DATA_RDONLY (YDVARS%SP%FT9)
  Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
  Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDONLY (YDVARS%SVD%FT9)
  Z_YDVARS_S_T0 => GET_HOST_DATA_RDONLY (YDVARS%S%FT0)
  Z_YDVARS_S_T9 => GET_HOST_DATA_RDONLY (YDVARS%S%FT9)
  Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
  Z_YDVARS_T_T9 => GET_HOST_DATA_RDONLY (YDVARS%T%FT9)
  Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
  Z_YDVARS_U_T9 => GET_HOST_DATA_RDONLY (YDVARS%U%FT9)
  Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
  Z_YDVARS_V_T9 => GET_HOST_DATA_RDONLY (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GPINISLB_PART1_EXPL_OPENACC (YDGEOMETRY, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_DYN%YRDYN,&
      & YDMODEL%YRML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%ZTE, Z_YDVARS_U_T9(:&
      &,:, JBLK), Z_YDVARS_V_T9(:,:, JBLK), Z_YDVARS_T_T9(:,:, JBLK), Z_YDVARS_SPD_T9(:,:, JBLK), Z_YDVARS_SVD_T9&
      &(:,:, JBLK), Z_YDCPG_DYN9_NHX(:,:, JBLK), Z_YDVARS_SP_T9(:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDVARS_V_T1&
      &(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK)&
      &, Z_YDVARS_NHX_T1(:,:, JBLK), Z_YDVARS_SP_T1(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI&
      &(:,:, JBLK), Z_YDCPG_MISC_QRAIN(:,:, JBLK), Z_YDCPG_MISC_QSNOW(:,:, JBLK), Z_YDCPG_MISC_QGRAUPEL&
      &(:,:, JBLK), PL0=Z_YDVARS_L_T0(:,:, JBLK), PL9=Z_YDVARS_L_T9(:,:, JBLK), PI0=Z_YDVARS_I_T0(:,&
      &:, JBLK), PI9=Z_YDVARS_I_T9(:,:, JBLK), PR0=Z_YDVARS_R_T0(:,:, JBLK), PR9=Z_YDVARS_R_T9(:,:, JBLK&
      &), PS0=Z_YDVARS_S_T0(:,:, JBLK), PS9=Z_YDVARS_S_T9(:,:, JBLK), PG0=Z_YDVARS_G_T0(:,:, JBLK), PG9&
      &=Z_YDVARS_G_T9(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN9_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHX)
    Z_YDCPG_MISC_QGRAUPEL => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QGRAUPEL)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDCPG_MISC_QRAIN => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QRAIN)
    Z_YDCPG_MISC_QSNOW => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QSNOW)
    Z_YDVARS_G_T0 => GET_HOST_DATA_RDWR (YDVARS%G%FT0)
    Z_YDVARS_G_T9 => GET_HOST_DATA_RDWR (YDVARS%G%FT9)
    Z_YDVARS_I_T0 => GET_HOST_DATA_RDWR (YDVARS%I%FT0)
    Z_YDVARS_I_T9 => GET_HOST_DATA_RDWR (YDVARS%I%FT9)
    Z_YDVARS_L_T0 => GET_HOST_DATA_RDWR (YDVARS%L%FT0)
    Z_YDVARS_L_T9 => GET_HOST_DATA_RDWR (YDVARS%L%FT9)
    Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
    Z_YDVARS_R_T0 => GET_HOST_DATA_RDWR (YDVARS%R%FT0)
    Z_YDVARS_R_T9 => GET_HOST_DATA_RDWR (YDVARS%R%FT9)
    Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
    Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT9)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT9)
    Z_YDVARS_S_T0 => GET_HOST_DATA_RDWR (YDVARS%S%FT0)
    Z_YDVARS_S_T9 => GET_HOST_DATA_RDWR (YDVARS%S%FT9)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    Z_YDVARS_T_T9 => GET_HOST_DATA_RDWR (YDVARS%T%FT9)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN9_NHX => NULL ()
  Z_YDCPG_MISC_QGRAUPEL => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDCPG_MISC_QRAIN => NULL ()
  Z_YDCPG_MISC_QSNOW => NULL ()
  Z_YDVARS_G_T0 => NULL ()
  Z_YDVARS_G_T9 => NULL ()
  Z_YDVARS_I_T0 => NULL ()
  Z_YDVARS_I_T9 => NULL ()
  Z_YDVARS_L_T0 => NULL ()
  Z_YDVARS_L_T9 => NULL ()
  Z_YDVARS_NHX_T1 => NULL ()
  Z_YDVARS_R_T0 => NULL ()
  Z_YDVARS_R_T9 => NULL ()
  Z_YDVARS_SPD_T1 => NULL ()
  Z_YDVARS_SPD_T9 => NULL ()
  Z_YDVARS_SP_T1 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  Z_YDVARS_SVD_T1 => NULL ()
  Z_YDVARS_SVD_T9 => NULL ()
  Z_YDVARS_S_T0 => NULL ()
  Z_YDVARS_S_T9 => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  Z_YDVARS_T_T9 => NULL ()
  Z_YDVARS_U_T1 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_V_T1 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','CPG_GP_PARALLEL:GPINISLB_PART1_EXPL')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN9_NHX => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%F_NHX)
  Z_YDCPG_MISC_QGRAUPEL => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QGRAUPEL)
  Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDCPG_MISC_QRAIN => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QRAIN)
  Z_YDCPG_MISC_QSNOW => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QSNOW)
  Z_YDVARS_G_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%G%FT0)
  Z_YDVARS_G_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%G%FT9)
  Z_YDVARS_I_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%I%FT0)
  Z_YDVARS_I_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%I%FT9)
  Z_YDVARS_L_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%L%FT0)
  Z_YDVARS_L_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%L%FT9)
  Z_YDVARS_NHX_T1 => GET_DEVICE_DATA_RDWR (YDVARS%NHX%FT1)
  Z_YDVARS_R_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%R%FT0)
  Z_YDVARS_R_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%R%FT9)
  Z_YDVARS_SPD_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SPD%FT1)
  Z_YDVARS_SPD_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SPD%FT9)
  Z_YDVARS_SP_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SP%FT1)
  Z_YDVARS_SP_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SP%FT9)
  Z_YDVARS_SVD_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SVD%FT1)
  Z_YDVARS_SVD_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%SVD%FT9)
  Z_YDVARS_S_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%S%FT0)
  Z_YDVARS_S_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%S%FT9)
  Z_YDVARS_T_T1 => GET_DEVICE_DATA_RDWR (YDVARS%T%FT1)
  Z_YDVARS_T_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%T%FT9)
  Z_YDVARS_U_T1 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT1)
  Z_YDVARS_U_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%U%FT9)
  Z_YDVARS_V_T1 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT1)
  Z_YDVARS_V_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDCPG_DYN9_NHX, &
    !$ACC&         Z_YDCPG_MISC_QGRAUPEL, Z_YDCPG_MISC_QICE, Z_YDCPG_MISC_QLI, &
    !$ACC&         Z_YDCPG_MISC_QRAIN, Z_YDCPG_MISC_QSNOW, Z_YDVARS_G_T0, Z_YDVARS_G_T9, &
    !$ACC&         Z_YDVARS_I_T0, Z_YDVARS_I_T9, Z_YDVARS_L_T0, Z_YDVARS_L_T9, &
    !$ACC&         Z_YDVARS_NHX_T1, Z_YDVARS_R_T0, Z_YDVARS_R_T9, Z_YDVARS_SPD_T1, &
    !$ACC&         Z_YDVARS_SPD_T9, Z_YDVARS_SP_T1, Z_YDVARS_SP_T9, Z_YDVARS_SVD_T1, &
    !$ACC&         Z_YDVARS_SVD_T9, Z_YDVARS_S_T0, Z_YDVARS_S_T9, Z_YDVARS_T_T1, &
    !$ACC&         Z_YDVARS_T_T9, Z_YDVARS_U_T1, Z_YDVARS_U_T9, Z_YDVARS_V_T1, &
    !$ACC&         Z_YDVARS_V_T9) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GPINISLB_PART1_EXPL_OPENACC (YDGEOMETRY, YDMODEL%YRML_GCONF%YGFL, YDMODEL%YRML_DYN%YRDYN,&
      & YDMODEL%YRML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%ZTE, Z_YDVARS_U_T9(:&
      &,:, JBLK), Z_YDVARS_V_T9(:,:, JBLK), Z_YDVARS_T_T9(:,:, JBLK), Z_YDVARS_SPD_T9(:,:, JBLK), Z_YDVARS_SVD_T9&
      &(:,:, JBLK), Z_YDCPG_DYN9_NHX(:,:, JBLK), Z_YDVARS_SP_T9(:, JBLK), Z_YDVARS_U_T1(:,:, JBLK), Z_YDVARS_V_T1&
      &(:,:, JBLK), Z_YDVARS_T_T1(:,:, JBLK), Z_YDVARS_SPD_T1(:,:, JBLK), Z_YDVARS_SVD_T1(:,:, JBLK)&
      &, Z_YDVARS_NHX_T1(:,:, JBLK), Z_YDVARS_SP_T1(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI&
      &(:,:, JBLK), Z_YDCPG_MISC_QRAIN(:,:, JBLK), Z_YDCPG_MISC_QSNOW(:,:, JBLK), Z_YDCPG_MISC_QGRAUPEL&
      &(:,:, JBLK), PL0=Z_YDVARS_L_T0(:,:, JBLK), PL9=Z_YDVARS_L_T9(:,:, JBLK), PI0=Z_YDVARS_I_T0(:,&
      &:, JBLK), PI9=Z_YDVARS_I_T9(:,:, JBLK), PR0=Z_YDVARS_R_T0(:,:, JBLK), PR9=Z_YDVARS_R_T9(:,:, JBLK&
      &), PS0=Z_YDVARS_S_T0(:,:, JBLK), PS9=Z_YDVARS_S_T9(:,:, JBLK), PG0=Z_YDVARS_G_T0(:,:, JBLK), PG9&
      &=Z_YDVARS_G_T9(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN9_NHX => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHX)
    Z_YDCPG_MISC_QGRAUPEL => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QGRAUPEL)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDCPG_MISC_QRAIN => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QRAIN)
    Z_YDCPG_MISC_QSNOW => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QSNOW)
    Z_YDVARS_G_T0 => GET_HOST_DATA_RDWR (YDVARS%G%FT0)
    Z_YDVARS_G_T9 => GET_HOST_DATA_RDWR (YDVARS%G%FT9)
    Z_YDVARS_I_T0 => GET_HOST_DATA_RDWR (YDVARS%I%FT0)
    Z_YDVARS_I_T9 => GET_HOST_DATA_RDWR (YDVARS%I%FT9)
    Z_YDVARS_L_T0 => GET_HOST_DATA_RDWR (YDVARS%L%FT0)
    Z_YDVARS_L_T9 => GET_HOST_DATA_RDWR (YDVARS%L%FT9)
    Z_YDVARS_NHX_T1 => GET_HOST_DATA_RDWR (YDVARS%NHX%FT1)
    Z_YDVARS_R_T0 => GET_HOST_DATA_RDWR (YDVARS%R%FT0)
    Z_YDVARS_R_T9 => GET_HOST_DATA_RDWR (YDVARS%R%FT9)
    Z_YDVARS_SPD_T1 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT1)
    Z_YDVARS_SPD_T9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FT9)
    Z_YDVARS_SP_T1 => GET_HOST_DATA_RDWR (YDVARS%SP%FT1)
    Z_YDVARS_SP_T9 => GET_HOST_DATA_RDWR (YDVARS%SP%FT9)
    Z_YDVARS_SVD_T1 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT1)
    Z_YDVARS_SVD_T9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FT9)
    Z_YDVARS_S_T0 => GET_HOST_DATA_RDWR (YDVARS%S%FT0)
    Z_YDVARS_S_T9 => GET_HOST_DATA_RDWR (YDVARS%S%FT9)
    Z_YDVARS_T_T1 => GET_HOST_DATA_RDWR (YDVARS%T%FT1)
    Z_YDVARS_T_T9 => GET_HOST_DATA_RDWR (YDVARS%T%FT9)
    Z_YDVARS_U_T1 => GET_HOST_DATA_RDWR (YDVARS%U%FT1)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_V_T1 => GET_HOST_DATA_RDWR (YDVARS%V%FT1)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN9_NHX => NULL ()
  Z_YDCPG_MISC_QGRAUPEL => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDCPG_MISC_QRAIN => NULL ()
  Z_YDCPG_MISC_QSNOW => NULL ()
  Z_YDVARS_G_T0 => NULL ()
  Z_YDVARS_G_T9 => NULL ()
  Z_YDVARS_I_T0 => NULL ()
  Z_YDVARS_I_T9 => NULL ()
  Z_YDVARS_L_T0 => NULL ()
  Z_YDVARS_L_T9 => NULL ()
  Z_YDVARS_NHX_T1 => NULL ()
  Z_YDVARS_R_T0 => NULL ()
  Z_YDVARS_R_T9 => NULL ()
  Z_YDVARS_SPD_T1 => NULL ()
  Z_YDVARS_SPD_T9 => NULL ()
  Z_YDVARS_SP_T1 => NULL ()
  Z_YDVARS_SP_T9 => NULL ()
  Z_YDVARS_SVD_T1 => NULL ()
  Z_YDVARS_SVD_T9 => NULL ()
  Z_YDVARS_S_T0 => NULL ()
  Z_YDVARS_S_T9 => NULL ()
  Z_YDVARS_T_T1 => NULL ()
  Z_YDVARS_T_T9 => NULL ()
  Z_YDVARS_U_T1 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_V_T1 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART1_EXPL',1,ZHOOK_HANDLE_PARALLEL)
CALL GPINISLB_PART2_EXPL_PARALLEL (YDMODEL%YRML_DYN%YRDYN, YDMODEL&
&%YRML_DYN%YRDYNA, YDCPG_BNDS, YDCPG_OPTS, YDVARS)
IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_GP_PARALLEL:GPINISLB_PART3_EXPL')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_GDW_T0 => GET_HOST_DATA_RDONLY (YL_Z_GDW_T0)
  Z_GWHT_T0 => GET_HOST_DATA_RDONLY (YL_Z_GWHT_T0)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREF)
  Z_YDCPG_SL2_GDW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GDW)
  Z_YDCPG_SL2_GWF => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWF)
  Z_YDCPG_SL2_GWS => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWS)
  Z_YDCPG_SL2_VVEL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VVEL)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL GPINISLB_PART3_EXPL (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYNA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
    &, Z_YDCPG_DYN0_CTY_VVEL (:, 1:, JBLK), Z_YDCPG_DYN0_PREF(:,:, JBLK), Z_YDCPG_SL2_VVEL (:,:, JBLK&
    &), Z_YDCPG_SL2_GWF (:,:, JBLK), Z_YDCPG_SL2_GDW (:,:, JBLK), Z_YDCPG_SL2_GWS (:,:, JBLK), Z_YDCPG_DYN0_GWFT&
    &(:,:, JBLK), Z_GDW_T0(:,:, JBLK), Z_GWHT_T0 (:, YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_GDW_T0 => GET_HOST_DATA_RDWR (YL_Z_GDW_T0)
    Z_GWHT_T0 => GET_HOST_DATA_RDWR (YL_Z_GWHT_T0)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_SL2_GDW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GDW)
    Z_YDCPG_SL2_GWF => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWF)
    Z_YDCPG_SL2_GWS => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWS)
    Z_YDCPG_SL2_VVEL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VVEL)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_GDW_T0 => NULL ()
  Z_GWHT_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_SL2_GDW => NULL ()
  Z_YDCPG_SL2_GWF => NULL ()
  Z_YDCPG_SL2_GWS => NULL ()
  Z_YDCPG_SL2_VVEL => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','CPG_GP_PARALLEL:GPINISLB_PART3_EXPL')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_GDW_T0 => GET_HOST_DATA_RDONLY (YL_Z_GDW_T0)
  Z_GWHT_T0 => GET_HOST_DATA_RDONLY (YL_Z_GWHT_T0)
  Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREF)
  Z_YDCPG_SL2_GDW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GDW)
  Z_YDCPG_SL2_GWF => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWF)
  Z_YDCPG_SL2_GWS => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWS)
  Z_YDCPG_SL2_VVEL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VVEL)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GPINISLB_PART3_EXPL_OPENACC (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYNA, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, Z_YDCPG_DYN0_CTY_VVEL (:, 1:, JBLK), Z_YDCPG_DYN0_PREF(:,:, JBLK&
      &), Z_YDCPG_SL2_VVEL (:,:, JBLK), Z_YDCPG_SL2_GWF (:,:, JBLK), Z_YDCPG_SL2_GDW (:,&
      &:, JBLK), Z_YDCPG_SL2_GWS (:,:, JBLK), Z_YDCPG_DYN0_GWFT(:,:, JBLK), Z_GDW_T0(:,:&
      &, JBLK), Z_GWHT_T0 (:, YDGEOMETRY%YRDIMV%NFLEVG, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_GDW_T0 => GET_HOST_DATA_RDWR (YL_Z_GDW_T0)
    Z_GWHT_T0 => GET_HOST_DATA_RDWR (YL_Z_GWHT_T0)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_SL2_GDW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GDW)
    Z_YDCPG_SL2_GWF => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWF)
    Z_YDCPG_SL2_GWS => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWS)
    Z_YDCPG_SL2_VVEL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VVEL)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_GDW_T0 => NULL ()
  Z_GWHT_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_SL2_GDW => NULL ()
  Z_YDCPG_SL2_GWF => NULL ()
  Z_YDCPG_SL2_GWS => NULL ()
  Z_YDCPG_SL2_VVEL => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','CPG_GP_PARALLEL:GPINISLB_PART3_EXPL')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_GDW_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_GDW_T0)
  Z_GWHT_T0 => GET_DEVICE_DATA_RDONLY (YL_Z_GWHT_T0)
  Z_YDCPG_DYN0_CTY_VVEL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%CTY%F_VVEL)
  Z_YDCPG_DYN0_GWFT => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_PREF => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREF)
  Z_YDCPG_SL2_GDW => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_GDW)
  Z_YDCPG_SL2_GWF => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_GWF)
  Z_YDCPG_SL2_GWS => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_GWS)
  Z_YDCPG_SL2_VVEL => GET_DEVICE_DATA_RDWR (YDCPG_SL2%F_VVEL)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, Z_GDW_T0, &
    !$ACC&         Z_GWHT_T0, Z_YDCPG_DYN0_CTY_VVEL, Z_YDCPG_DYN0_GWFT, Z_YDCPG_DYN0_PREF, &
    !$ACC&         Z_YDCPG_SL2_GDW, Z_YDCPG_SL2_GWF, Z_YDCPG_SL2_GWS, Z_YDCPG_SL2_VVEL) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GPINISLB_PART3_EXPL_OPENACC (YDGEOMETRY, YDMODEL%YRML_DYN%YRDYNA, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, Z_YDCPG_DYN0_CTY_VVEL (:, 1:, JBLK), Z_YDCPG_DYN0_PREF(:,:, JBLK&
      &), Z_YDCPG_SL2_VVEL (:,:, JBLK), Z_YDCPG_SL2_GWF (:,:, JBLK), Z_YDCPG_SL2_GDW (:,&
      &:, JBLK), Z_YDCPG_SL2_GWS (:,:, JBLK), Z_YDCPG_DYN0_GWFT(:,:, JBLK), Z_GDW_T0(:,:&
      &, JBLK), Z_GWHT_T0 (:, YDGEOMETRY%YRDIMV%NFLEVG, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL')) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_GDW_T0 => GET_HOST_DATA_RDWR (YL_Z_GDW_T0)
    Z_GWHT_T0 => GET_HOST_DATA_RDWR (YL_Z_GWHT_T0)
    Z_YDCPG_DYN0_CTY_VVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_VVEL)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_SL2_GDW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GDW)
    Z_YDCPG_SL2_GWF => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWF)
    Z_YDCPG_SL2_GWS => GET_HOST_DATA_RDWR (YDCPG_SL2%F_GWS)
    Z_YDCPG_SL2_VVEL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VVEL)
    IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_GDW_T0 => NULL ()
  Z_GWHT_T0 => NULL ()
  Z_YDCPG_DYN0_CTY_VVEL => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_SL2_GDW => NULL ()
  Z_YDCPG_SL2_GWF => NULL ()
  Z_YDCPG_SL2_GWS => NULL ()
  Z_YDCPG_SL2_VVEL => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:GPINISLB_PART3_EXPL',1,ZHOOK_HANDLE_PARALLEL)

IF (YDMODEL%YRML_DYN%YRDYN%NCURRENT_ITER==0) THEN

  IF (YDCPG_OPTS%LDIAB.OR.YDMODEL%YRML_PHY_MF%YRSIMPHL%LSIMPH) THEN

    IF (YDMODEL%YRML_DYN%YRDYNA%LTWOTL) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('UPDATEVIEW','CPG_GP_PARALLEL:SET1TO0')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        CALL YDMF_PHYS_SURF%ACDC_HOST ()
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YDMF_PHYS_SURF%UPDATE_VIEW (JBLK)
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL YDMF_PHYS_SURF%SET1TO0 (YDCPG_OPTS, YLCPG_BNDS)
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SET1TO0')) THEN
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPMETHOD','CPG_GP_PARALLEL:SET1TO0')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YDMF_PHYS_SURF%SET1TO0_HOST_PARALLEL (YDCPG_OPTS, YLCPG_BNDS)
        
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SET1TO0')) THEN
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCMETHOD','CPG_GP_PARALLEL:SET1TO0')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YDMF_PHYS_SURF%SET1TO0_DEVICE_PARALLEL (YDCPG_OPTS, YLCPG_BNDS)
        
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SET1TO0')) THEN
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO0',1,ZHOOK_HANDLE_PARALLEL)
    ELSE
      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('UPDATEVIEW','CPG_GP_PARALLEL:SET1TO9')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        CALL YDMF_PHYS_SURF%ACDC_HOST ()
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YDMF_PHYS_SURF%UPDATE_VIEW (JBLK)
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL YDMF_PHYS_SURF%SET1TO9 (YDCPG_OPTS, YLCPG_BNDS)
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SET1TO9')) THEN
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPMETHOD','CPG_GP_PARALLEL:SET1TO9')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YDMF_PHYS_SURF%SET1TO9_HOST_PARALLEL (YDCPG_OPTS, YLCPG_BNDS)
        
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SET1TO9')) THEN
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCMETHOD','CPG_GP_PARALLEL:SET1TO9')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YDMF_PHYS_SURF%SET1TO9_DEVICE_PARALLEL (YDCPG_OPTS, YLCPG_BNDS)
        
        
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('CPG_GP_PARALLEL:SET1TO9')) THEN
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('CPG_GP_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL:SET1TO9',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

  ENDIF

ENDIF


IF (YDCPG_OPTS%LSFORC) THEN
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF





CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_Z_GDW_T0)) CALL FIELD_DELETE (YL_Z_GDW_T0)
IF (ASSOCIATED (YL_Z_GWHT_T0)) CALL FIELD_DELETE (YL_Z_GWHT_T0)
IF (ASSOCIATED (YL_Z_OROGLL_T0)) CALL FIELD_DELETE (YL_Z_OROGLL_T0)
IF (ASSOCIATED (YL_Z_OROGLM_T0)) CALL FIELD_DELETE (YL_Z_OROGLM_T0)
IF (ASSOCIATED (YL_Z_OROGMM_T0)) CALL FIELD_DELETE (YL_Z_OROGMM_T0)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('CPG_GP_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE CPG_GP_PARALLEL
