MODULE UTIL_TCSGLEG_MOD

USE YOMLEG, ONLY : TCSGLEG

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TCSGLEG
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TCSGLEG
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TCSGLEG
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TCSGLEG
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TCSGLEG
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TCSGLEG
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TCSGLEG
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TCSGLEG (SELF, KLUN)

IMPLICIT NONE
TYPE (TCSGLEG), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LR1MU2, LR1MUA, LR1MUI, LR1QM2, LRACTHE, LRLATI, LRLATIG, LRMU, LRSQM2, LRW
LRW = ALLOCATED (SELF%RW)
WRITE (KLUN) LRW
IF (LRW) THEN
  WRITE (KLUN) LBOUND (SELF%RW)
  WRITE (KLUN) UBOUND (SELF%RW)
  WRITE (KLUN) SELF%RW
ENDIF
LRMU = ALLOCATED (SELF%RMU)
WRITE (KLUN) LRMU
IF (LRMU) THEN
  WRITE (KLUN) LBOUND (SELF%RMU)
  WRITE (KLUN) UBOUND (SELF%RMU)
  WRITE (KLUN) SELF%RMU
ENDIF
LR1MU2 = ALLOCATED (SELF%R1MU2)
WRITE (KLUN) LR1MU2
IF (LR1MU2) THEN
  WRITE (KLUN) LBOUND (SELF%R1MU2)
  WRITE (KLUN) UBOUND (SELF%R1MU2)
  WRITE (KLUN) SELF%R1MU2
ENDIF
LR1MUI = ALLOCATED (SELF%R1MUI)
WRITE (KLUN) LR1MUI
IF (LR1MUI) THEN
  WRITE (KLUN) LBOUND (SELF%R1MUI)
  WRITE (KLUN) UBOUND (SELF%R1MUI)
  WRITE (KLUN) SELF%R1MUI
ENDIF
LR1MUA = ALLOCATED (SELF%R1MUA)
WRITE (KLUN) LR1MUA
IF (LR1MUA) THEN
  WRITE (KLUN) LBOUND (SELF%R1MUA)
  WRITE (KLUN) UBOUND (SELF%R1MUA)
  WRITE (KLUN) SELF%R1MUA
ENDIF
LRSQM2 = ALLOCATED (SELF%RSQM2)
WRITE (KLUN) LRSQM2
IF (LRSQM2) THEN
  WRITE (KLUN) LBOUND (SELF%RSQM2)
  WRITE (KLUN) UBOUND (SELF%RSQM2)
  WRITE (KLUN) SELF%RSQM2
ENDIF
LR1QM2 = ALLOCATED (SELF%R1QM2)
WRITE (KLUN) LR1QM2
IF (LR1QM2) THEN
  WRITE (KLUN) LBOUND (SELF%R1QM2)
  WRITE (KLUN) UBOUND (SELF%R1QM2)
  WRITE (KLUN) SELF%R1QM2
ENDIF
LRACTHE = ALLOCATED (SELF%RACTHE)
WRITE (KLUN) LRACTHE
IF (LRACTHE) THEN
  WRITE (KLUN) LBOUND (SELF%RACTHE)
  WRITE (KLUN) UBOUND (SELF%RACTHE)
  WRITE (KLUN) SELF%RACTHE
ENDIF
LRLATIG = ALLOCATED (SELF%RLATIG)
WRITE (KLUN) LRLATIG
IF (LRLATIG) THEN
  WRITE (KLUN) LBOUND (SELF%RLATIG)
  WRITE (KLUN) UBOUND (SELF%RLATIG)
  WRITE (KLUN) SELF%RLATIG
ENDIF
LRLATI = ALLOCATED (SELF%RLATI)
WRITE (KLUN) LRLATI
IF (LRLATI) THEN
  WRITE (KLUN) LBOUND (SELF%RLATI)
  WRITE (KLUN) UBOUND (SELF%RLATI)
  WRITE (KLUN) SELF%RLATI
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TCSGLEG (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TCSGLEG), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LR1MU2, LR1MUA, LR1MUI, LR1QM2, LRACTHE, LRLATI, LRLATIG, LRMU, LRSQM2, LRW
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) LRW
IF (LRW) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RW (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RW,1):UBOUND(SELF%RW,1)))
  READ (KLUN) ZTMP1
  SELF%RW = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRMU
IF (LRMU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RMU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RMU,1):UBOUND(SELF%RMU,1)))
  READ (KLUN) ZTMP1
  SELF%RMU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LR1MU2
IF (LR1MU2) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%R1MU2 (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%R1MU2,1):UBOUND(SELF%R1MU2,1)))
  READ (KLUN) ZTMP1
  SELF%R1MU2 = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LR1MUI
IF (LR1MUI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%R1MUI (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%R1MUI,1):UBOUND(SELF%R1MUI,1)))
  READ (KLUN) ZTMP1
  SELF%R1MUI = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LR1MUA
IF (LR1MUA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%R1MUA (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%R1MUA,1):UBOUND(SELF%R1MUA,1)))
  READ (KLUN) ZTMP1
  SELF%R1MUA = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRSQM2
IF (LRSQM2) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RSQM2 (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RSQM2,1):UBOUND(SELF%RSQM2,1)))
  READ (KLUN) ZTMP1
  SELF%RSQM2 = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LR1QM2
IF (LR1QM2) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%R1QM2 (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%R1QM2,1):UBOUND(SELF%R1QM2,1)))
  READ (KLUN) ZTMP1
  SELF%R1QM2 = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRACTHE
IF (LRACTHE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RACTHE (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RACTHE,1):UBOUND(SELF%RACTHE,1)))
  READ (KLUN) ZTMP1
  SELF%RACTHE = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRLATIG
IF (LRLATIG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RLATIG (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RLATIG,1):UBOUND(SELF%RLATIG,1)))
  READ (KLUN) ZTMP1
  SELF%RLATIG = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRLATI
IF (LRLATI) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RLATI (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RLATI,1):UBOUND(SELF%RLATI,1)))
  READ (KLUN) ZTMP1
  SELF%RLATI = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TCSGLEG (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCSGLEG), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LR1MU2, LR1MUA, LR1MUI, LR1QM2, LRACTHE, LRLATI, LRLATIG, LRMU, LRSQM2, LRW
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LRW = ALLOCATED (SELF%RW)
IF (LRW) THEN
  !$ACC ENTER DATA CREATE (SELF%RW)
  !$ACC UPDATE DEVICE (SELF%RW)
  !$ACC ENTER DATA ATTACH (SELF%RW)
ENDIF

LRMU = ALLOCATED (SELF%RMU)
IF (LRMU) THEN
  !$ACC ENTER DATA CREATE (SELF%RMU)
  !$ACC UPDATE DEVICE (SELF%RMU)
  !$ACC ENTER DATA ATTACH (SELF%RMU)
ENDIF

LR1MU2 = ALLOCATED (SELF%R1MU2)
IF (LR1MU2) THEN
  !$ACC ENTER DATA CREATE (SELF%R1MU2)
  !$ACC UPDATE DEVICE (SELF%R1MU2)
  !$ACC ENTER DATA ATTACH (SELF%R1MU2)
ENDIF

LR1MUI = ALLOCATED (SELF%R1MUI)
IF (LR1MUI) THEN
  !$ACC ENTER DATA CREATE (SELF%R1MUI)
  !$ACC UPDATE DEVICE (SELF%R1MUI)
  !$ACC ENTER DATA ATTACH (SELF%R1MUI)
ENDIF

LR1MUA = ALLOCATED (SELF%R1MUA)
IF (LR1MUA) THEN
  !$ACC ENTER DATA CREATE (SELF%R1MUA)
  !$ACC UPDATE DEVICE (SELF%R1MUA)
  !$ACC ENTER DATA ATTACH (SELF%R1MUA)
ENDIF

LRSQM2 = ALLOCATED (SELF%RSQM2)
IF (LRSQM2) THEN
  !$ACC ENTER DATA CREATE (SELF%RSQM2)
  !$ACC UPDATE DEVICE (SELF%RSQM2)
  !$ACC ENTER DATA ATTACH (SELF%RSQM2)
ENDIF

LR1QM2 = ALLOCATED (SELF%R1QM2)
IF (LR1QM2) THEN
  !$ACC ENTER DATA CREATE (SELF%R1QM2)
  !$ACC UPDATE DEVICE (SELF%R1QM2)
  !$ACC ENTER DATA ATTACH (SELF%R1QM2)
ENDIF

LRACTHE = ALLOCATED (SELF%RACTHE)
IF (LRACTHE) THEN
  !$ACC ENTER DATA CREATE (SELF%RACTHE)
  !$ACC UPDATE DEVICE (SELF%RACTHE)
  !$ACC ENTER DATA ATTACH (SELF%RACTHE)
ENDIF

LRLATIG = ALLOCATED (SELF%RLATIG)
IF (LRLATIG) THEN
  !$ACC ENTER DATA CREATE (SELF%RLATIG)
  !$ACC UPDATE DEVICE (SELF%RLATIG)
  !$ACC ENTER DATA ATTACH (SELF%RLATIG)
ENDIF

LRLATI = ALLOCATED (SELF%RLATI)
IF (LRLATI) THEN
  !$ACC ENTER DATA CREATE (SELF%RLATI)
  !$ACC UPDATE DEVICE (SELF%RLATI)
  !$ACC ENTER DATA ATTACH (SELF%RLATI)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TCSGLEG (SELF)

IMPLICIT NONE
TYPE (TCSGLEG), TARGET :: SELF
LOGICAL :: LR1MU2, LR1MUA, LR1MUI, LR1QM2, LRACTHE, LRLATI, LRLATIG, LRMU, LRSQM2, LRW

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TCSGLEG (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TCSGLEG), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LR1MU2, LR1MUA, LR1MUI, LR1QM2, LRACTHE, LRLATI, LRLATIG, LRMU, LRSQM2, LRW
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RW), CDPATH//'%RW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RMU), CDPATH//'%RMU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R1MU2), CDPATH//'%R1MU2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R1MUI), CDPATH//'%R1MUI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R1MUA), CDPATH//'%R1MUA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSQM2), CDPATH//'%RSQM2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%R1QM2), CDPATH//'%R1QM2'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RACTHE), CDPATH//'%RACTHE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RLATIG), CDPATH//'%RLATIG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RLATI), CDPATH//'%RLATI'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TCSGLEG (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TCSGLEG), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LR1MU2, LR1MUA, LR1MUI, LR1QM2, LRACTHE, LRLATI, LRLATIG, LRMU, LRSQM2, LRW
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LRW = ALLOCATED (SELF%RW)
IF (LRW) THEN
  !$ACC EXIT DATA DETACH (SELF%RW)
  !$ACC EXIT DATA DELETE (SELF%RW)
ENDIF

LRMU = ALLOCATED (SELF%RMU)
IF (LRMU) THEN
  !$ACC EXIT DATA DETACH (SELF%RMU)
  !$ACC EXIT DATA DELETE (SELF%RMU)
ENDIF

LR1MU2 = ALLOCATED (SELF%R1MU2)
IF (LR1MU2) THEN
  !$ACC EXIT DATA DETACH (SELF%R1MU2)
  !$ACC EXIT DATA DELETE (SELF%R1MU2)
ENDIF

LR1MUI = ALLOCATED (SELF%R1MUI)
IF (LR1MUI) THEN
  !$ACC EXIT DATA DETACH (SELF%R1MUI)
  !$ACC EXIT DATA DELETE (SELF%R1MUI)
ENDIF

LR1MUA = ALLOCATED (SELF%R1MUA)
IF (LR1MUA) THEN
  !$ACC EXIT DATA DETACH (SELF%R1MUA)
  !$ACC EXIT DATA DELETE (SELF%R1MUA)
ENDIF

LRSQM2 = ALLOCATED (SELF%RSQM2)
IF (LRSQM2) THEN
  !$ACC EXIT DATA DETACH (SELF%RSQM2)
  !$ACC EXIT DATA DELETE (SELF%RSQM2)
ENDIF

LR1QM2 = ALLOCATED (SELF%R1QM2)
IF (LR1QM2) THEN
  !$ACC EXIT DATA DETACH (SELF%R1QM2)
  !$ACC EXIT DATA DELETE (SELF%R1QM2)
ENDIF

LRACTHE = ALLOCATED (SELF%RACTHE)
IF (LRACTHE) THEN
  !$ACC EXIT DATA DETACH (SELF%RACTHE)
  !$ACC EXIT DATA DELETE (SELF%RACTHE)
ENDIF

LRLATIG = ALLOCATED (SELF%RLATIG)
IF (LRLATIG) THEN
  !$ACC EXIT DATA DETACH (SELF%RLATIG)
  !$ACC EXIT DATA DELETE (SELF%RLATIG)
ENDIF

LRLATI = ALLOCATED (SELF%RLATI)
IF (LRLATI) THEN
  !$ACC EXIT DATA DETACH (SELF%RLATI)
  !$ACC EXIT DATA DELETE (SELF%RLATI)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TCSGLEG (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TCSGLEG),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LR1MU2, LR1MUA, LR1MUI, LR1QM2, LRACTHE, LRLATI, LRLATIG, LRMU, LRSQM2, LRW
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LRW = ALLOCATED (SELF%RW)
IF (LRW) THEN
  ISIZE = KIND (SELF%RW) * SIZE (SELF%RW)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RW'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRMU = ALLOCATED (SELF%RMU)
IF (LRMU) THEN
  ISIZE = KIND (SELF%RMU) * SIZE (SELF%RMU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RMU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LR1MU2 = ALLOCATED (SELF%R1MU2)
IF (LR1MU2) THEN
  ISIZE = KIND (SELF%R1MU2) * SIZE (SELF%R1MU2)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%R1MU2'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LR1MUI = ALLOCATED (SELF%R1MUI)
IF (LR1MUI) THEN
  ISIZE = KIND (SELF%R1MUI) * SIZE (SELF%R1MUI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%R1MUI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LR1MUA = ALLOCATED (SELF%R1MUA)
IF (LR1MUA) THEN
  ISIZE = KIND (SELF%R1MUA) * SIZE (SELF%R1MUA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%R1MUA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRSQM2 = ALLOCATED (SELF%RSQM2)
IF (LRSQM2) THEN
  ISIZE = KIND (SELF%RSQM2) * SIZE (SELF%RSQM2)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RSQM2'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LR1QM2 = ALLOCATED (SELF%R1QM2)
IF (LR1QM2) THEN
  ISIZE = KIND (SELF%R1QM2) * SIZE (SELF%R1QM2)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%R1QM2'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRACTHE = ALLOCATED (SELF%RACTHE)
IF (LRACTHE) THEN
  ISIZE = KIND (SELF%RACTHE) * SIZE (SELF%RACTHE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RACTHE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRLATIG = ALLOCATED (SELF%RLATIG)
IF (LRLATIG) THEN
  ISIZE = KIND (SELF%RLATIG) * SIZE (SELF%RLATIG)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RLATIG'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRLATI = ALLOCATED (SELF%RLATI)
IF (LRLATI) THEN
  ISIZE = KIND (SELF%RLATI) * SIZE (SELF%RLATI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RLATI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
