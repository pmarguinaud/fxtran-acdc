
SUBROUTINE LARMES_PARALLEL (YDGEOMETRY, YDGEOMVARS, YDCST, YDRIP, YDML_DYN, YDCPG_OPTS, YDCPG_BNDS&
&, YDSL, YDCPG_SL1, YDCPG_SL2, YDMASK_SL2, YDA_KVSEPC, YDA_KVSEPL, YD_PSCO, YD_PLEV, YD_PCCO&
&, YD_PUF, YD_PVF, YD_PWF, YD_KL0, YD_KLH0, YD_KLEV, YD_PLSCAW, YD_PRSCAW)
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY

USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE YOMCST,ONLY:TCST
USE YOMRIP,ONLY:TRIP
USE EINT_MOD,ONLY:SL_STRUCT
USE FIELD_VARIABLES_MOD,ONLY:GEOMETRY_VARIABLES
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1F_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_SL_MASK_TYPE_MOD,ONLY:CPG_SL_MASK_TYPE
USE FIELD_ARRAY_MODULE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (GEOMETRY_VARIABLES), INTENT (IN)::YDGEOMVARS
TYPE (TCST), INTENT (IN)::YDCST
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
TYPE (TRIP), INTENT (IN)::YDRIP
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (SL_STRUCT), INTENT (IN)::YDSL
TYPE (CPG_SL1F_TYPE), INTENT (IN)::YDCPG_SL1
TYPE (CPG_SL2_TYPE), INTENT (IN)::YDCPG_SL2
TYPE (CPG_SL_MASK_TYPE), INTENT (INOUT)::YDMASK_SL2
TYPE (FIELD_2IM_ARRAY), INTENT (INOUT)::YDA_KVSEPC
TYPE (FIELD_2IM_ARRAY), INTENT (INOUT)::YDA_KVSEPL
CLASS (FIELD_4RB), POINTER :: YD_PSCO
REAL (KIND=JPRB), POINTER::PSCO (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLEV
REAL (KIND=JPRB), POINTER::PLEV (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PCCO
REAL (KIND=JPRB), POINTER::PCCO (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PUF
REAL (KIND=JPRB), POINTER::PUF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PVF
REAL (KIND=JPRB), POINTER::PVF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PWF
REAL (KIND=JPRB), POINTER::PWF (:,:,:)
CLASS (FIELD_4IM), POINTER :: YD_KL0
INTEGER (KIND=JPIM), POINTER::KL0 (:,:,:,:)
CLASS (FIELD_4IM), POINTER :: YD_KLH0
INTEGER (KIND=JPIM), POINTER::KLH0 (:,:,:,:)
CLASS (FIELD_3IM), POINTER :: YD_KLEV
INTEGER (KIND=JPIM), POINTER::KLEV (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PLSCAW
REAL (KIND=JPRB), POINTER::PLSCAW (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PRSCAW
REAL (KIND=JPRB), POINTER::PRSCAW (:,:,:,:)
INTEGER (KIND=JPIM)::IHVI
INTEGER (KIND=JPIM)::IROT
CLASS (FIELD_2IM), POINTER :: YL_ISTESB
INTEGER (KIND=JPIM), POINTER::ISTESB (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ISTEST
INTEGER (KIND=JPIM), POINTER::ISTEST (:,:)
INTEGER (KIND=JPIM)::ITIP
INTEGER (KIND=JPIM)::JITER
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
CLASS (FIELD_4IM), POINTER :: YL_IL0A
INTEGER (KIND=JPIM), POINTER::IL0A (:,:,:,:)
CLASS (FIELD_3IM), POINTER :: YL_IDEP
INTEGER (KIND=JPIM), POINTER::IDEP (:,:,:)
CLASS (FIELD_3IM), POINTER :: YL_INOWENO
INTEGER (KIND=JPIM), POINTER::INOWENO (:,:,:)
LOGICAL::LLINTV
LOGICAL::LSMOOTH
LOGICAL::LLO
LOGICAL::LLSLHDQUAD
LOGICAL::LLSLHD
REAL (KIND=JPRB)::ZDTSA
REAL (KIND=JPRB)::ZDTS62
REAL (KIND=JPRB)::ZDTS22
REAL (KIND=JPRB)::ZINT
REAL (KIND=JPRB)::ZLEVT
REAL (KIND=JPRB)::ZLEVO
REAL (KIND=JPRB)::ZLEVB
REAL (KIND=JPRB)::ZNOR2
REAL (KIND=JPRB)::ZPV
REAL (KIND=JPRB)::ZPU
REAL (KIND=JPRB)::ZSPHSV
REAL (KIND=JPRB)::Z2COPHI
REAL (KIND=JPRB), PARAMETER::ZEPS=1.E-6_JPRB
REAL (KIND=JPRB)::ZVETAOX
REAL (KIND=JPRB)::ZVETAON
CLASS (FIELD_3RB), POINTER :: YL_ZXF
REAL (KIND=JPRB), POINTER::ZXF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZYF
REAL (KIND=JPRB), POINTER::ZYF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZZF
REAL (KIND=JPRB), POINTER::ZZF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZWF
REAL (KIND=JPRB), POINTER::ZWF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZWFSM
REAL (KIND=JPRB), POINTER::ZWFSM (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZWFASM
REAL (KIND=JPRB), POINTER::ZWFASM (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZSCO
REAL (KIND=JPRB), POINTER::ZSCO (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPLEV
REAL (KIND=JPRB), POINTER::ZPLEV (:,:,:)
REAL (KIND=JPRB)::ZUN_KAPPAH (1)
REAL (KIND=JPRB)::ZUN_KAPPAM (1)
REAL (KIND=JPRB)::ZUN_KAPPAT (1)
REAL (KIND=JPRB)::ZUN_KAPPA (1)
REAL (KIND=JPRB)::ZPV0
REAL (KIND=JPRB)::ZPU0
REAL (KIND=JPRB)::ZVDISP
REAL (KIND=JPRB)::ZVDISP_2
REAL (KIND=JPRB)::ZZ
REAL (KIND=JPRB)::ZVDISP_1
CLASS (FIELD_3RB), POINTER :: YL_ZWO_2
REAL (KIND=JPRB), POINTER::ZWO_2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZWF_2
REAL (KIND=JPRB), POINTER::ZWF_2 (:,:,:)
REAL (KIND=JPRB)::ZEO
REAL (KIND=JPRB)::ZEF
REAL (KIND=JPRB)::ZFX
REAL (KIND=JPRB)::ZFN
REAL (KIND=JPRB)::ZHVETAOX
REAL (KIND=JPRB)::ZHVETAON
CLASS (FIELD_3RB), POINTER :: YL_ZX0
REAL (KIND=JPRB), POINTER::ZX0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZY0
REAL (KIND=JPRB), POINTER::ZY0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZZ0
REAL (KIND=JPRB), POINTER::ZZ0 (:,:,:)
#include "abor1.intfb.h"
#include "larcina.intfb.h"
#include "larcina_openacc.intfb.h"
#include "laismoa.intfb.h"
#include "laismoa_openacc.intfb.h"
#include "lamaxwind.intfb.h"
#include "lamaxwind_openacc.intfb.h"
#include "latrajout.intfb.h"
#include "latrajout_openacc.intfb.h"
#include "mcoords.intfb.h"
#include "mcoords_openacc.intfb.h"
#include "rotuv.intfb.h"
#include "rotuv_openacc.intfb.h"
#include "rotuvgeo.intfb.h"
#include "rotuvgeo_openacc.intfb.h"
#include "cart2local.intfb.h"
#include "cart2local_openacc.intfb.h"
#include "local2cart.intfb.h"
#include "local2cart_openacc.intfb.h"
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
INTEGER(KIND=JPIM), POINTER :: Z_YDA_KVSEPC_P(:,:)
INTEGER(KIND=JPIM), POINTER :: Z_YDA_KVSEPL_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_UR0_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VR0_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_WR0_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_WRA_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_ZR0_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_STDDISU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_STDDISV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_STDDISW(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_URL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_VRL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_WRL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDGEOMVARS_GECLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDGEOMVARS_GEMU_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDGEOMVARS_GESLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDGEOMVARS_GNORDL_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDGEOMVARS_GNORDM_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDGEOMVARS_GSQM2_P(:,:)
REAL(KIND=JPRD), POINTER :: Z_YDGEOMVARS_RCOLON_P(:,:)
REAL(KIND=JPRD), POINTER :: Z_YDGEOMVARS_RSILON_P(:,:)
INTEGER (KIND=JPIM), POINTER :: Z_YDMASK_SL2_P(:)
IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZZF, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZZ0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZYF, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZY0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZXF, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZX0, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWO_2, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWF_2, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWFSM, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWFASM, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWF, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSCO, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, YDML_DYN%YYTSCO&
&%NDIM, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPLEV, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ISTEST, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ISTESB, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_INOWENO, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_IL0A, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG, 3&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_IDEP, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)





IF (YDML_DYN%YRDYNA%LTWOTL) THEN
  LLO=.NOT.YDML_DYN%YRDYNA%LELTRA
ELSE
  LLO=.FALSE.
ENDIF


IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
  ZDTS22=YDRIP%RDTS22*4._JPRB
  ZDTSA=YDRIP%RDTSA*2._JPRB
  ZDTS62=YDRIP%RDTS62*4._JPRB
ELSE

  IF (YDML_DYN%YRDYNA%LTWOTL)  THEN
    CALL ABOR1 (' LARMES 1.2 ')
  ENDIF

  ZDTS22=YDRIP%RDTS22
  ZDTSA=YDRIP%RDTSA
  ZDTS62=YDRIP%RDTS62
ENDIF

LLSLHD=.FALSE.
LLSLHDQUAD=.FALSE.
LSMOOTH=YDML_DYN%YRDYN%LSVTSM.AND.(YDCPG_OPTS%NCONF==1.OR.YDCPG_OPTS%NCONF==302)
IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARMES_PARALLEL:LARMES')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
  IL0A => GET_HOST_DATA_RDWR (YL_IL0A)
  INOWENO => GET_HOST_DATA_RDWR (YL_INOWENO)
  ISTESB => GET_HOST_DATA_RDWR (YL_ISTESB)
  ISTEST => GET_HOST_DATA_RDWR (YL_ISTEST)
  KL0 => GET_HOST_DATA_RDWR (YD_KL0)
  KLEV => GET_HOST_DATA_RDWR (YD_KLEV)
  KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
  PCCO => GET_HOST_DATA_RDWR (YD_PCCO)
  PLEV => GET_HOST_DATA_RDWR (YD_PLEV)
  PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
  PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
  PSCO => GET_HOST_DATA_RDWR (YD_PSCO)
  PUF => GET_HOST_DATA_RDWR (YD_PUF)
  PVF => GET_HOST_DATA_RDWR (YD_PVF)
  PWF => GET_HOST_DATA_RDWR (YD_PWF)
  ZPLEV => GET_HOST_DATA_RDWR (YL_ZPLEV)
  ZSCO => GET_HOST_DATA_RDWR (YL_ZSCO)
  ZWF => GET_HOST_DATA_RDWR (YL_ZWF)
  ZWFASM => GET_HOST_DATA_RDWR (YL_ZWFASM)
  ZWFSM => GET_HOST_DATA_RDWR (YL_ZWFSM)
  ZWF_2 => GET_HOST_DATA_RDWR (YL_ZWF_2)
  ZWO_2 => GET_HOST_DATA_RDWR (YL_ZWO_2)
  ZX0 => GET_HOST_DATA_RDWR (YL_ZX0)
  ZXF => GET_HOST_DATA_RDWR (YL_ZXF)
  ZY0 => GET_HOST_DATA_RDWR (YL_ZY0)
  ZYF => GET_HOST_DATA_RDWR (YL_ZYF)
  ZZ0 => GET_HOST_DATA_RDWR (YL_ZZ0)
  ZZF => GET_HOST_DATA_RDWR (YL_ZZF)
  Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
  Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
  Z_YDCPG_SL1_UR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UR0%F_P)
  Z_YDCPG_SL1_VR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VR0%F_P)
  Z_YDCPG_SL1_WR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%WR0%F_P)
  Z_YDCPG_SL1_WRA_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%WRA%F_P)
  Z_YDCPG_SL1_ZR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%ZR0%F_P)
  Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISU)
  Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISV)
  Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISW)
  Z_YDCPG_SL2_URL => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_URL)
  Z_YDCPG_SL2_VRL => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_VRL)
  Z_YDCPG_SL2_WRL => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_WRL)
  Z_YDGEOMVARS_GECLO_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GECLO%FT0)
  Z_YDGEOMVARS_GEMU_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GEMU%FT0)
  Z_YDGEOMVARS_GESLO_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GESLO%FT0)
  Z_YDGEOMVARS_GNORDL_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GNORDL%FT0)
  Z_YDGEOMVARS_GNORDM_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GNORDM%FT0)
  Z_YDGEOMVARS_GSQM2_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GSQM2%FT0)
  Z_YDGEOMVARS_RCOLON_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%RCOLON%FT0)
  Z_YDGEOMVARS_RSILON_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%RSILON%FT0)
  Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (IHVI, IROT, ITIP, JBLK, JITER, JLEV, JROF, LLINTV, Z2COPHI, ZEF, ZEO, ZFN, ZFX, ZHVETAON, ZHVETAOX, ZLEVB, ZLEVO, ZLEVT, ZPU, ZPV, ZVDISP, ZVDISP_1, ZVDISP_2, ZVETAON, ZVETAOX, ZZ) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL LAMAXWIND (YDML_DYN, YDCST, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
    &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL&
    &(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK))

    IF (YDML_DYN%YRDYN%LSVTSM) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINLA, JBLK)=Z_YDGEOMVARS_GEMU_P (JROF, JBLK)-ZEPS
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COSCO, JBLK)=Z_YDGEOMVARS_GSQM2_P (JROF, JBLK)
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)=ZEPS
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)=1.0_JPRB-ZEPS
          ZPLEV (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
        ENDDO

      ENDDO

      IHVI=0
      IROT=0
      ITIP=1
      LLINTV=.FALSE.
      CALL LARCINA (YDGEOMETRY, YDCST, YDML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDSL, IHVI, YDML_DYN&
      &%YRDYN%LFINDVSEP, LLSLHD, LLSLHDQUAD, LLINTV, ITIP, IROT,.FALSE., ZSCO(:,:,:, JBLK), ZPLEV(:,:&
      &, JBLK), ZUN_KAPPA, ZUN_KAPPAT, ZUN_KAPPAM, ZUN_KAPPAH, Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV&
      &(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), Z_YDCPG_SL1_UR0_P(:,:), Z_YDCPG_SL1_VR0_P(:,:), Z_YDCPG_SL1_ZR0_P&
      &(:,:), Z_YDCPG_SL1_WRA_P(:,:), Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK&
      &), PCCO(:,:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), ZZF(:,:, JBLK), ZWF(:,:, JBLK), ZWFASM(:&
      &,:, JBLK), IL0A(:,:,:, JBLK), KLH0(:,:,:, JBLK), KLEV(:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(&
      &:,:,:, JBLK), IDEP(:,:, JBLK), INOWENO(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_RSILON_P&
      &(:, JBLK), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:&
      &, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK))
      CALL LAISMOA (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW&
      & (:,:, YDML_DYN%YYTLSCAW%M_WDLO, JBLK), IL0A(:,:,:, JBLK), PLSCAW (:,:, YDML_DYN&
      &%YYTLSCAW%M_WDVER, JBLK), Z_YDCPG_SL1_WRA_P(:,:), ZWFASM(:,:, JBLK))
    ENDIF

    ZLEVT=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (0)
    ZLEVB=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG+1)
    ZVETAON=(1.0_JPRB-YDML_DYN%YRDYN%VETAON)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH&
    & (0)+YDML_DYN%YRDYN%VETAON*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (1)
    ZVETAOX=(1.0_JPRB-YDML_DYN%YRDYN%VETAOX)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (YDGEOMETRY%YRDIMV%NFLEVG&
    &)+YDML_DYN%YRDYN%VETAOX*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG)

    IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
      ZHVETAON=0.5_JPRB*ZVETAON
      ZHVETAOX=1.0_JPRB-0.5_JPRB*(1.0_JPRB-ZVETAOX)
    ENDIF


    DO JITER=1, YDML_DYN%YRDYN%NITMP
      ISTEST (:, JBLK)=0
      ISTESB (:, JBLK)=0

      IF (JITER==1) THEN

        IF (YDML_DYN%YRDYN%LSLDP_CURV.AND..NOT.YDML_DYN%YRDYNA%LELTRA) THEN
          CALL LOCAL2CART (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
          &, YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK), Z_YDGEOMVARS_GECLO_P&
          &(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK), Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P&
          &(:, JBLK), Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL(:,:, JBLK), ZX0(:,:, JBLK),&
          & ZY0(:,:, JBLK), ZZ0(:,:, JBLK), LDROT=.TRUE.)
        ENDIF

        CALL MCOORDS (YDML_DYN%YYTSCO, YDRIP, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDCST%RA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK&
        &), Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), Z_YDCPG_SL2_URL(:,:, JBLK)&
        &, Z_YDCPG_SL2_VRL(:,:, JBLK), PSCO(:,:,:, JBLK), LLO, LD2TLM=.TRUE., LDROT=.TRUE.)

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
            ZFN=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-ZHVETAON
            ZFX=ZHVETAOX-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
            ZEF=1._JPRB/ZFN+1._JPRB/ZFX
          ENDIF


          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

            IF (YDGEOMETRY%YRSTA%STPREH(JLEV)>YDML_DYN%YRDYN%RPRES_SVTSM.OR..NOT.LSMOOTH) THEN
              ZWF (JROF, JLEV, JBLK)=Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK)
            ELSE
              ZWF (JROF, JLEV, JBLK)=ZWFASM (JROF, JLEV, JBLK)
            ENDIF


            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZVDISP_1=-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
              ZZ=EXP (ZVDISP_1*ZEF)*ZFN/ZFX
              ZVDISP_2=(ZHVETAON+ZHVETAOX*ZZ)/(1.0_JPRB+ZZ)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZVDISP=SIGN (1.0_JPRB, ZVDISP_1)*MIN (ABS (ZVDISP_1), ABS (ZVDISP_2))
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)+ZVDISP
            ELSE
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
            ENDIF

            ISTEST (JROF, JBLK)=ISTEST (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVO-ZLEVT-0.5_JPRB)))
            ISTESB (JROF, JBLK)=ISTESB (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVB-ZLEVO-0.5_JPRB)))
            ZLEVO=MIN (ZVETAOX, MAX (ZVETAON, ZLEVO))

            IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
              PLEV (JROF, JLEV, JBLK)=ZLEVO
            ELSE
              PLEV (JROF, JLEV, JBLK)=0.5_JPRB*(ZLEVO+YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV))
            ENDIF

          ENDDO

        ENDDO

      ELSE

        IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN

          IF (LLO) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                ZXF (JROF, JLEV, JBLK)=0.5_JPRB*(PUF (JROF, JLEV, JBLK)+ZX0 (JROF, JLEV, JBLK))
                ZYF (JROF, JLEV, JBLK)=0.5_JPRB*(PVF (JROF, JLEV, JBLK)+ZY0 (JROF, JLEV, JBLK))
                ZZF (JROF, JLEV, JBLK)=0.5_JPRB*(ZZF (JROF, JLEV, JBLK)+ZZ0 (JROF, JLEV, JBLK))
              ENDDO

            ENDDO

          ENDIF

          CALL CART2LOCAL (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
          &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(&
          &:, JBLK), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK), ZXF(:&
          &,:, JBLK), ZYF(:,:, JBLK), ZZF(:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK))
        ELSE
          CALL ROTUV (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, PUF(:,:, JBLK), PVF(:,:, JBLK), PCCO (:,:, YDML_DYN%YYTCCO%M_RQX, JBLK), PCCO (&
          &:,:, YDML_DYN%YYTCCO%M_RQY, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), LDIR=.FALSE.)

          IF (LLO) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                ZPU=PUF (JROF, JLEV, JBLK)
                ZPV=PVF (JROF, JLEV, JBLK)
                PUF (JROF, JLEV, JBLK)=0.5_JPRB*(ZPU+Z_YDCPG_SL2_URL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDM_P&
                & (JROF, JBLK)-Z_YDCPG_SL2_VRL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDL_P (JROF, JBLK))
                PVF (JROF, JLEV, JBLK)=0.5_JPRB*(ZPV+Z_YDCPG_SL2_URL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDL_P&
                & (JROF, JBLK)+Z_YDCPG_SL2_VRL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDM_P (JROF, JBLK))
              ENDDO

            ENDDO

          ENDIF

        ENDIF

        CALL MCOORDS (YDML_DYN%YYTSCO, YDRIP, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCST%RA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P&
        &(:, JBLK), Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), PUF(:,:,&
        & JBLK), PVF(:,:, JBLK), PSCO(:,:,:, JBLK), LLO, LD2TLM=.TRUE.)

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
            ZFN=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-ZHVETAON
            ZFX=ZHVETAOX-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
            ZEF=1._JPRB/ZFN+1._JPRB/ZFX
          ENDIF


          IF (LLO) THEN

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

              IF (YDGEOMETRY%YRSTA%STPREH(JLEV)>YDML_DYN%YRDYN%RPRES_SVTSM.OR..NOT.LSMOOTH) THEN

                IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
                  ZWF_2 (JROF, JLEV, JBLK)=ZWF (JROF, JLEV, JBLK)
                  ZWO_2 (JROF, JLEV, JBLK)=Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK)
                ENDIF

                ZWF (JROF, JLEV, JBLK)=0.5_JPRB*(ZWF (JROF, JLEV, JBLK)+Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK))
              ELSE

                IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
                  ZWF_2 (JROF, JLEV, JBLK)=ZWFASM (JROF, JLEV, JBLK)
                  ZWO_2 (JROF, JLEV, JBLK)=ZWFSM (JROF, JLEV, JBLK)
                ENDIF

                ZWF (JROF, JLEV, JBLK)=0.5_JPRB*(ZWFSM (JROF, JLEV, JBLK)+ZWFASM (JROF, JLEV, JBLK))
              ENDIF

            ENDDO

          ENDIF


          IF (YDML_DYN%YRDYNA%LSLDIA.AND.(JITER==YDML_DYN%YRDYN%NITMP)) THEN
            PWF (:, JLEV, JBLK)=ZWF (:, JLEV, JBLK)
          ENDIF


          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZVDISP_1=-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
              ZEO=1._JPRB/(PLEV (JROF, JLEV, JBLK)-ZHVETAON)+1._JPRB/(ZHVETAOX-PLEV (JROF, JLEV, JBLK))

              IF (LLO) THEN
                ZZ=EXP (-0.5_JPRB*YDRIP%RTDT*ZWF_2 (JROF, JLEV, JBLK)*ZEF-0&
                &.5_JPRB*YDRIP%RTDT*ZWO_2 (JROF, JLEV, JBLK)*ZEO)*ZFN/ZFX
              ELSE
                ZZ=EXP (-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)*ZEO)*ZFN/ZFX
              ENDIF

              ZVDISP_2=(ZHVETAON+ZHVETAOX*ZZ)/(1.0_JPRB+ZZ)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZVDISP=SIGN (1.0_JPRB, ZVDISP_1)*MIN (ABS (ZVDISP_1), ABS (ZVDISP_2))
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)+ZVDISP
            ELSE
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
            ENDIF

            ISTEST (JROF, JBLK)=ISTEST (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVO-ZLEVT-0.5_JPRB)))
            ISTESB (JROF, JBLK)=ISTESB (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVB-ZLEVO-0.5_JPRB)))
            ZLEVO=MIN (ZVETAOX, MAX (ZVETAON, ZLEVO))

            IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
              PLEV (JROF, JLEV, JBLK)=ZLEVO
            ELSE
              PLEV (JROF, JLEV, JBLK)=0.5_JPRB*(ZLEVO+YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV))
            ENDIF

          ENDDO

        ENDDO


        IF (JITER==YDML_DYN%YRDYN%NITMP) THEN
          CALL ROTUVGEO (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA,&
          & YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK),&
          & PUF(:,:, JBLK), PVF(:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), LDIR=.FALSE.)
        ENDIF

      ENDIF


      IF (JITER==YDML_DYN%YRDYN%NITMP) THEN
        CALL LATRAJOUT (YDCST, YDML_DYN%YRDYNA%LRPRSLTRJ, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY&
        &%YRDIMV%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, ISTEST(:, JBLK), ISTESB(:, JBLK&
        &), ZWF(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK))
      ENDIF


      IF (JITER/=YDML_DYN%YRDYN%NITMP) THEN
        IHVI=0

        IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN
          IROT=0
        ELSE
          IROT=1
        ENDIF

        ITIP=1
        LLINTV=.TRUE.
        CALL LARCINA (YDGEOMETRY, YDCST, YDML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDSL, IHVI, YDML_DYN&
        &%YRDYN%LFINDVSEP, LLSLHD, LLSLHDQUAD, LLINTV, ITIP, IROT,.FALSE., PSCO(:,:,:, JBLK), PLEV(:,:&
        &, JBLK), ZUN_KAPPA, ZUN_KAPPAT, ZUN_KAPPAM, ZUN_KAPPAH, Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV&
        &(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), Z_YDCPG_SL1_UR0_P(:,:), Z_YDCPG_SL1_VR0_P(:,:), Z_YDCPG_SL1_ZR0_P&
        &(:,:), Z_YDCPG_SL1_WR0_P(:,:), Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK&
        &), PCCO(:,:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), ZZF(:,:, JBLK), ZWF(:,:, JBLK), ZWFSM(:&
        &,:, JBLK), KL0(:,:,:, JBLK), KLH0(:,:,:, JBLK), KLEV(:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(&
        &:,:,:, JBLK), IDEP(:,:, JBLK), INOWENO(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_RSILON_P&
        &(:, JBLK), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(&
        &:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK))
      ENDIF

    ENDDO


    IF (.NOT.(LLO.OR.YDML_DYN%YRDYNA%LELTRA)) THEN

      IF (YDML_DYN%YRDYNA%LTWOTL)  THEN
        CALL ABOR1 (' LARMES 3 ')
      ENDIF

      ZVETAON=(1.0_JPRB-YDML_DYN%YRDYN%VETAON)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH&
      & (0)+YDML_DYN%YRDYN%VETAON*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (1)
      ZVETAOX=(1.0_JPRB-YDML_DYN%YRDYN%VETAOX)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (YDGEOMETRY%YRDIMV%NFLEVG&
      &)+YDML_DYN%YRDYN%VETAOX*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG)

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z2COPHI=2.0_JPRB*PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINLA, JBLK)=Z2COPHI*PSCO (JROF, JLEV&
          &, YDML_DYN%YYTSCO%M_SINLA, JBLK)-Z_YDGEOMVARS_GEMU_P (JROF, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)=Z2COPHI&
          &*PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COSCO, JBLK)=Z2COPHI*PSCO (JROF, JLEV&
          &, YDML_DYN%YYTSCO%M_COSCO, JBLK)-Z_YDGEOMVARS_GSQM2_P (JROF, JBLK)
          PLEV (JROF, JLEV, JBLK)=2.0_JPRB*PLEV (JROF, JLEV, JBLK)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
          PLEV (JROF, JLEV, JBLK)=MAX (ZVETAON, MIN (ZVETAOX, PLEV (JROF, JLEV, JBLK)))
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)=Z2COPHI*PSCO&
          & (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)-1.0_JPRB
        ENDDO

      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LARMES_PARALLEL:LARMES')) THEN
    IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
    IL0A => GET_HOST_DATA_RDWR (YL_IL0A)
    INOWENO => GET_HOST_DATA_RDWR (YL_INOWENO)
    ISTESB => GET_HOST_DATA_RDWR (YL_ISTESB)
    ISTEST => GET_HOST_DATA_RDWR (YL_ISTEST)
    KL0 => GET_HOST_DATA_RDWR (YD_KL0)
    KLEV => GET_HOST_DATA_RDWR (YD_KLEV)
    KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
    PCCO => GET_HOST_DATA_RDWR (YD_PCCO)
    PLEV => GET_HOST_DATA_RDWR (YD_PLEV)
    PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
    PSCO => GET_HOST_DATA_RDWR (YD_PSCO)
    PUF => GET_HOST_DATA_RDWR (YD_PUF)
    PVF => GET_HOST_DATA_RDWR (YD_PVF)
    PWF => GET_HOST_DATA_RDWR (YD_PWF)
    ZPLEV => GET_HOST_DATA_RDWR (YL_ZPLEV)
    ZSCO => GET_HOST_DATA_RDWR (YL_ZSCO)
    ZWF => GET_HOST_DATA_RDWR (YL_ZWF)
    ZWFASM => GET_HOST_DATA_RDWR (YL_ZWFASM)
    ZWFSM => GET_HOST_DATA_RDWR (YL_ZWFSM)
    ZWF_2 => GET_HOST_DATA_RDWR (YL_ZWF_2)
    ZWO_2 => GET_HOST_DATA_RDWR (YL_ZWO_2)
    ZX0 => GET_HOST_DATA_RDWR (YL_ZX0)
    ZXF => GET_HOST_DATA_RDWR (YL_ZXF)
    ZY0 => GET_HOST_DATA_RDWR (YL_ZY0)
    ZYF => GET_HOST_DATA_RDWR (YL_ZYF)
    ZZ0 => GET_HOST_DATA_RDWR (YL_ZZ0)
    ZZF => GET_HOST_DATA_RDWR (YL_ZZF)
    Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
    Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
    Z_YDCPG_SL1_UR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UR0%F_P)
    Z_YDCPG_SL1_VR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VR0%F_P)
    Z_YDCPG_SL1_WR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%WR0%F_P)
    Z_YDCPG_SL1_WRA_P => GET_HOST_DATA_RDWR (YDCPG_SL1%WRA%F_P)
    Z_YDCPG_SL1_ZR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%ZR0%F_P)
    Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISU)
    Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISV)
    Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISW)
    Z_YDCPG_SL2_URL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_URL)
    Z_YDCPG_SL2_VRL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VRL)
    Z_YDCPG_SL2_WRL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_WRL)
    Z_YDGEOMVARS_GECLO_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GECLO%FT0)
    Z_YDGEOMVARS_GEMU_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GEMU%FT0)
    Z_YDGEOMVARS_GESLO_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GESLO%FT0)
    Z_YDGEOMVARS_GNORDL_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GNORDL%FT0)
    Z_YDGEOMVARS_GNORDM_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GNORDM%FT0)
    Z_YDGEOMVARS_GSQM2_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GSQM2%FT0)
    Z_YDGEOMVARS_RCOLON_P => GET_HOST_DATA_RDWR (YDGEOMVARS%RCOLON%FT0)
    Z_YDGEOMVARS_RSILON_P => GET_HOST_DATA_RDWR (YDGEOMVARS%RSILON%FT0)
    Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => NULL ()
  IL0A => NULL ()
  INOWENO => NULL ()
  ISTESB => NULL ()
  ISTEST => NULL ()
  KL0 => NULL ()
  KLEV => NULL ()
  KLH0 => NULL ()
  PCCO => NULL ()
  PLEV => NULL ()
  PLSCAW => NULL ()
  PRSCAW => NULL ()
  PSCO => NULL ()
  PUF => NULL ()
  PVF => NULL ()
  PWF => NULL ()
  ZPLEV => NULL ()
  ZSCO => NULL ()
  ZWF => NULL ()
  ZWFASM => NULL ()
  ZWFSM => NULL ()
  ZWF_2 => NULL ()
  ZWO_2 => NULL ()
  ZX0 => NULL ()
  ZXF => NULL ()
  ZY0 => NULL ()
  ZYF => NULL ()
  ZZ0 => NULL ()
  ZZF => NULL ()
  Z_YDA_KVSEPC_P => NULL ()
  Z_YDA_KVSEPL_P => NULL ()
  Z_YDCPG_SL1_UR0_P => NULL ()
  Z_YDCPG_SL1_VR0_P => NULL ()
  Z_YDCPG_SL1_WR0_P => NULL ()
  Z_YDCPG_SL1_WRA_P => NULL ()
  Z_YDCPG_SL1_ZR0_P => NULL ()
  Z_YDCPG_SL2_STDDISU => NULL ()
  Z_YDCPG_SL2_STDDISV => NULL ()
  Z_YDCPG_SL2_STDDISW => NULL ()
  Z_YDCPG_SL2_URL => NULL ()
  Z_YDCPG_SL2_VRL => NULL ()
  Z_YDCPG_SL2_WRL => NULL ()
  Z_YDGEOMVARS_GECLO_P => NULL ()
  Z_YDGEOMVARS_GEMU_P => NULL ()
  Z_YDGEOMVARS_GESLO_P => NULL ()
  Z_YDGEOMVARS_GNORDL_P => NULL ()
  Z_YDGEOMVARS_GNORDM_P => NULL ()
  Z_YDGEOMVARS_GSQM2_P => NULL ()
  Z_YDGEOMVARS_RCOLON_P => NULL ()
  Z_YDGEOMVARS_RSILON_P => NULL ()
  Z_YDMASK_SL2_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARMES_PARALLEL:LARMES')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
  IL0A => GET_HOST_DATA_RDWR (YL_IL0A)
  INOWENO => GET_HOST_DATA_RDWR (YL_INOWENO)
  ISTESB => GET_HOST_DATA_RDWR (YL_ISTESB)
  ISTEST => GET_HOST_DATA_RDWR (YL_ISTEST)
  KL0 => GET_HOST_DATA_RDWR (YD_KL0)
  KLEV => GET_HOST_DATA_RDWR (YD_KLEV)
  KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
  PCCO => GET_HOST_DATA_RDWR (YD_PCCO)
  PLEV => GET_HOST_DATA_RDWR (YD_PLEV)
  PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
  PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
  PSCO => GET_HOST_DATA_RDWR (YD_PSCO)
  PUF => GET_HOST_DATA_RDWR (YD_PUF)
  PVF => GET_HOST_DATA_RDWR (YD_PVF)
  PWF => GET_HOST_DATA_RDWR (YD_PWF)
  ZPLEV => GET_HOST_DATA_RDWR (YL_ZPLEV)
  ZSCO => GET_HOST_DATA_RDWR (YL_ZSCO)
  ZWF => GET_HOST_DATA_RDWR (YL_ZWF)
  ZWFASM => GET_HOST_DATA_RDWR (YL_ZWFASM)
  ZWFSM => GET_HOST_DATA_RDWR (YL_ZWFSM)
  ZWF_2 => GET_HOST_DATA_RDWR (YL_ZWF_2)
  ZWO_2 => GET_HOST_DATA_RDWR (YL_ZWO_2)
  ZX0 => GET_HOST_DATA_RDWR (YL_ZX0)
  ZXF => GET_HOST_DATA_RDWR (YL_ZXF)
  ZY0 => GET_HOST_DATA_RDWR (YL_ZY0)
  ZYF => GET_HOST_DATA_RDWR (YL_ZYF)
  ZZ0 => GET_HOST_DATA_RDWR (YL_ZZ0)
  ZZF => GET_HOST_DATA_RDWR (YL_ZZF)
  Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
  Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
  Z_YDCPG_SL1_UR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UR0%F_P)
  Z_YDCPG_SL1_VR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VR0%F_P)
  Z_YDCPG_SL1_WR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%WR0%F_P)
  Z_YDCPG_SL1_WRA_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%WRA%F_P)
  Z_YDCPG_SL1_ZR0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%ZR0%F_P)
  Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISU)
  Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISV)
  Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISW)
  Z_YDCPG_SL2_URL => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_URL)
  Z_YDCPG_SL2_VRL => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_VRL)
  Z_YDCPG_SL2_WRL => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_WRL)
  Z_YDGEOMVARS_GECLO_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GECLO%FT0)
  Z_YDGEOMVARS_GEMU_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GEMU%FT0)
  Z_YDGEOMVARS_GESLO_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GESLO%FT0)
  Z_YDGEOMVARS_GNORDL_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GNORDL%FT0)
  Z_YDGEOMVARS_GNORDM_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GNORDM%FT0)
  Z_YDGEOMVARS_GSQM2_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%GSQM2%FT0)
  Z_YDGEOMVARS_RCOLON_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%RCOLON%FT0)
  Z_YDGEOMVARS_RSILON_P => GET_HOST_DATA_RDONLY (YDGEOMVARS%RSILON%FT0)
  Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (IHVI, IROT, ITIP, JBLK, JITER, JLEV, JROF, LLINTV, YLCPG_BNDS, YLSTACK, Z2COPHI, ZEF, ZEO, ZFN, ZFX, ZHVETAON, ZHVETAOX, ZLEVB, ZLEVO, ZLEVT, ZPU, ZPV, ZVDISP, ZVDISP_1, ZVDISP_2, ZVETAON, ZVETAOX, ZZ)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL LAMAXWIND_OPENACC (YDML_DYN, YDCST, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL(:,:, JBLK&
      &), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK),YDSTACK=YLSTACK)

      IF (YDML_DYN%YRDYN%LSVTSM) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINLA, JBLK)=Z_YDGEOMVARS_GEMU_P (JROF, JBLK)-ZEPS
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COSCO, JBLK)=Z_YDGEOMVARS_GSQM2_P (JROF, JBLK)
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)=ZEPS
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)=1.0_JPRB-ZEPS
          ZPLEV (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
        
        ENDDO

        IHVI=0
        IROT=0
        ITIP=1
        LLINTV=.FALSE.
        CALL LARCINA_OPENACC (YDGEOMETRY, YDCST, YDML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDSL, IHVI&
        &, YDML_DYN%YRDYN%LFINDVSEP, LLSLHD, LLSLHDQUAD, LLINTV, ITIP, IROT,.FALSE., ZSCO(:,:,:, JBLK), ZPLEV&
        &(:,:, JBLK), ZUN_KAPPA, ZUN_KAPPAT, ZUN_KAPPAM, ZUN_KAPPAH, Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV&
        &(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), Z_YDCPG_SL1_UR0_P(:,:), Z_YDCPG_SL1_VR0_P(:,:), Z_YDCPG_SL1_ZR0_P&
        &(:,:), Z_YDCPG_SL1_WRA_P(:,:), Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK&
        &), PCCO(:,:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), ZZF(:,:, JBLK), ZWF(:,:, JBLK), ZWFASM(:,:&
        &, JBLK), IL0A(:,:,:, JBLK), KLH0(:,:,:, JBLK), KLEV(:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
        &:, JBLK), IDEP(:,:, JBLK), INOWENO(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_RSILON_P&
        &(:, JBLK), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK&
        &), Z_YDGEOMVARS_GSQM2_P(:, JBLK),YDSTACK=YLSTACK)
        CALL LAISMOA_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW&
        & (:,:, YDML_DYN%YYTLSCAW%M_WDLO, JBLK), IL0A(:,:,:, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW&
        &%M_WDVER, JBLK), Z_YDCPG_SL1_WRA_P(:,:), ZWFASM(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

      ZLEVT=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (0)
      ZLEVB=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG+1)
      ZVETAON=(1.0_JPRB-YDML_DYN%YRDYN%VETAON)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH&
      & (0)+YDML_DYN%YRDYN%VETAON*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (1)
      ZVETAOX=(1.0_JPRB-YDML_DYN%YRDYN%VETAOX)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (YDGEOMETRY%YRDIMV%NFLEVG&
      &)+YDML_DYN%YRDYN%VETAOX*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG)

      IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
        ZHVETAON=0.5_JPRB*ZVETAON
        ZHVETAOX=1.0_JPRB-0.5_JPRB*(1.0_JPRB-ZVETAOX)
      ENDIF


      DO JITER=1, YDML_DYN%YRDYN%NITMP
        ISTEST (JROF, JBLK)=0
        ISTESB (JROF, JBLK)=0

        IF (JITER==1) THEN

          IF (YDML_DYN%YRDYN%LSLDP_CURV.AND..NOT.YDML_DYN%YRDYNA%LELTRA) THEN
            CALL LOCAL2CART_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
            &, YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK), Z_YDGEOMVARS_GECLO_P&
            &(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK), Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P&
            &(:, JBLK), Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL(:,:, JBLK), ZX0(:,:, JBLK), ZY0(&
            &:,:, JBLK), ZZ0(:,:, JBLK), LDROT=.TRUE.,YDSTACK=YLSTACK)
          ENDIF

          CALL MCOORDS_OPENACC (YDML_DYN%YYTSCO, YDRIP, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
          &%KIDIA, YLCPG_BNDS%KFDIA, YDCST%RA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK), Z_YDGEOMVARS_GNORDM_P&
          &(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL(:,:, JBLK), PSCO&
          &(:,:,:, JBLK), LLO, LD2TLM=.TRUE., LDROT=.TRUE.,YDSTACK=YLSTACK)

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZFN=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-ZHVETAON
              ZFX=ZHVETAOX-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZEF=1._JPRB/ZFN+1._JPRB/ZFX
            ENDIF


            

            IF (YDGEOMETRY%YRSTA%STPREH(JLEV)>YDML_DYN%YRDYN%RPRES_SVTSM.OR..NOT.LSMOOTH) THEN
              ZWF (JROF, JLEV, JBLK)=Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK)
            ELSE
              ZWF (JROF, JLEV, JBLK)=ZWFASM (JROF, JLEV, JBLK)
            ENDIF


            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZVDISP_1=-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
              ZZ=EXP (ZVDISP_1*ZEF)*ZFN/ZFX
              ZVDISP_2=(ZHVETAON+ZHVETAOX*ZZ)/(1.0_JPRB+ZZ)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZVDISP=SIGN (1.0_JPRB, ZVDISP_1)*MIN (ABS (ZVDISP_1), ABS (ZVDISP_2))
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)+ZVDISP
            ELSE
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
            ENDIF

            ISTEST (JROF, JBLK)=ISTEST (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVO-ZLEVT-0.5_JPRB)))
            ISTESB (JROF, JBLK)=ISTESB (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVB-ZLEVO-0.5_JPRB)))
            ZLEVO=MIN (ZVETAOX, MAX (ZVETAON, ZLEVO))

            IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
              PLEV (JROF, JLEV, JBLK)=ZLEVO
            ELSE
              PLEV (JROF, JLEV, JBLK)=0.5_JPRB*(ZLEVO+YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV))
            ENDIF

          
          ENDDO

        ELSE

          IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN

            IF (LLO) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                ZXF (JROF, JLEV, JBLK)=0.5_JPRB*(PUF (JROF, JLEV, JBLK)+ZX0 (JROF, JLEV, JBLK))
                ZYF (JROF, JLEV, JBLK)=0.5_JPRB*(PVF (JROF, JLEV, JBLK)+ZY0 (JROF, JLEV, JBLK))
                ZZF (JROF, JLEV, JBLK)=0.5_JPRB*(ZZF (JROF, JLEV, JBLK)+ZZ0 (JROF, JLEV, JBLK))
              
              ENDDO

            ENDIF

            CALL CART2LOCAL_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
            &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK&
            &), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK), ZXF(:,:, JBLK), ZYF&
            &(:,:, JBLK), ZZF(:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK),YDSTACK=YLSTACK)
          ELSE
            CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
            &%KFDIA, PUF(:,:, JBLK), PVF(:,:, JBLK), PCCO (:,:, YDML_DYN%YYTCCO%M_RQX, JBLK), PCCO (:,:, YDML_DYN&
            &%YYTCCO%M_RQY, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), LDIR=.FALSE.,YDSTACK=YLSTACK)

            IF (LLO) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                ZPU=PUF (JROF, JLEV, JBLK)
                ZPV=PVF (JROF, JLEV, JBLK)
                PUF (JROF, JLEV, JBLK)=0.5_JPRB*(ZPU+Z_YDCPG_SL2_URL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDM_P&
                & (JROF, JBLK)-Z_YDCPG_SL2_VRL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDL_P (JROF, JBLK))
                PVF (JROF, JLEV, JBLK)=0.5_JPRB*(ZPV+Z_YDCPG_SL2_URL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDL_P&
                & (JROF, JBLK)+Z_YDCPG_SL2_VRL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDM_P (JROF, JBLK))
              
              ENDDO

            ENDIF

          ENDIF

          CALL MCOORDS_OPENACC (YDML_DYN%YYTSCO, YDRIP, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCST%RA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P&
          &(:, JBLK), Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), PUF(:,:, JBLK)&
          &, PVF(:,:, JBLK), PSCO(:,:,:, JBLK), LLO, LD2TLM=.TRUE.,YDSTACK=YLSTACK)

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZFN=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-ZHVETAON
              ZFX=ZHVETAOX-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZEF=1._JPRB/ZFN+1._JPRB/ZFX
            ENDIF


            IF (LLO) THEN

              

              IF (YDGEOMETRY%YRSTA%STPREH(JLEV)>YDML_DYN%YRDYN%RPRES_SVTSM.OR..NOT.LSMOOTH) THEN

                IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
                  ZWF_2 (JROF, JLEV, JBLK)=ZWF (JROF, JLEV, JBLK)
                  ZWO_2 (JROF, JLEV, JBLK)=Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK)
                ENDIF

                ZWF (JROF, JLEV, JBLK)=0.5_JPRB*(ZWF (JROF, JLEV, JBLK)+Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK))
              ELSE

                IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
                  ZWF_2 (JROF, JLEV, JBLK)=ZWFASM (JROF, JLEV, JBLK)
                  ZWO_2 (JROF, JLEV, JBLK)=ZWFSM (JROF, JLEV, JBLK)
                ENDIF

                ZWF (JROF, JLEV, JBLK)=0.5_JPRB*(ZWFSM (JROF, JLEV, JBLK)+ZWFASM (JROF, JLEV, JBLK))
              ENDIF

            
            ENDIF


            IF (YDML_DYN%YRDYNA%LSLDIA.AND.(JITER==YDML_DYN%YRDYN%NITMP)) THEN
              PWF (JROF, JLEV, JBLK)=ZWF (JROF, JLEV, JBLK)
            ENDIF


            

            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZVDISP_1=-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
              ZEO=1._JPRB/(PLEV (JROF, JLEV, JBLK)-ZHVETAON)+1._JPRB/(ZHVETAOX-PLEV (JROF, JLEV, JBLK))

              IF (LLO) THEN
                ZZ=EXP (-0.5_JPRB*YDRIP%RTDT*ZWF_2 (JROF, JLEV, JBLK)*ZEF-0&
                &.5_JPRB*YDRIP%RTDT*ZWO_2 (JROF, JLEV, JBLK)*ZEO)*ZFN/ZFX
              ELSE
                ZZ=EXP (-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)*ZEO)*ZFN/ZFX
              ENDIF

              ZVDISP_2=(ZHVETAON+ZHVETAOX*ZZ)/(1.0_JPRB+ZZ)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZVDISP=SIGN (1.0_JPRB, ZVDISP_1)*MIN (ABS (ZVDISP_1), ABS (ZVDISP_2))
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)+ZVDISP
            ELSE
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
            ENDIF

            ISTEST (JROF, JBLK)=ISTEST (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVO-ZLEVT-0.5_JPRB)))
            ISTESB (JROF, JBLK)=ISTESB (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVB-ZLEVO-0.5_JPRB)))
            ZLEVO=MIN (ZVETAOX, MAX (ZVETAON, ZLEVO))

            IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
              PLEV (JROF, JLEV, JBLK)=ZLEVO
            ELSE
              PLEV (JROF, JLEV, JBLK)=0.5_JPRB*(ZLEVO+YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV))
            ENDIF

          
          ENDDO


          IF (JITER==YDML_DYN%YRDYN%NITMP) THEN
            CALL ROTUVGEO_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA,&
            & YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), PUF(:,:&
            &, JBLK), PVF(:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), LDIR=.FALSE.,YDSTACK=YLSTACK)
          ENDIF

        ENDIF


        IF (JITER==YDML_DYN%YRDYN%NITMP) THEN
          CALL LATRAJOUT_OPENACC (YDCST, YDML_DYN%YRDYNA%LRPRSLTRJ, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, ISTEST(:, JBLK), ISTESB(:, JBLK), ZWF(:&
          &,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (JITER/=YDML_DYN%YRDYN%NITMP) THEN
          IHVI=0

          IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN
            IROT=0
          ELSE
            IROT=1
          ENDIF

          ITIP=1
          LLINTV=.TRUE.
          CALL LARCINA_OPENACC (YDGEOMETRY, YDCST, YDML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDSL, IHVI&
          &, YDML_DYN%YRDYN%LFINDVSEP, LLSLHD, LLSLHDQUAD, LLINTV, ITIP, IROT,.FALSE., PSCO(:,:,:, JBLK), PLEV&
          &(:,:, JBLK), ZUN_KAPPA, ZUN_KAPPAT, ZUN_KAPPAM, ZUN_KAPPAH, Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV&
          &(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), Z_YDCPG_SL1_UR0_P(:,:), Z_YDCPG_SL1_VR0_P(:,:), Z_YDCPG_SL1_ZR0_P&
          &(:,:), Z_YDCPG_SL1_WR0_P(:,:), Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK&
          &), PCCO(:,:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), ZZF(:,:, JBLK), ZWF(:,:, JBLK), ZWFSM(:,:,&
          & JBLK), KL0(:,:,:, JBLK), KLH0(:,:,:, JBLK), KLEV(:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:,&
          & JBLK), IDEP(:,:, JBLK), INOWENO(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_RSILON_P&
          &(:, JBLK), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK&
          &), Z_YDGEOMVARS_GSQM2_P(:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO


      IF (.NOT.(LLO.OR.YDML_DYN%YRDYNA%LELTRA)) THEN

        IF (YDML_DYN%YRDYNA%LTWOTL)  THEN
          CALL FXTRAN_ACDC_ABORT (' LARMES 3 ')
        ENDIF

        ZVETAON=(1.0_JPRB-YDML_DYN%YRDYN%VETAON)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH&
        & (0)+YDML_DYN%YRDYN%VETAON*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (1)
        ZVETAOX=(1.0_JPRB-YDML_DYN%YRDYN%VETAOX)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (YDGEOMETRY%YRDIMV%NFLEVG&
        &)+YDML_DYN%YRDYN%VETAOX*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG)

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z2COPHI=2.0_JPRB*PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINLA, JBLK)=Z2COPHI*PSCO (JROF, JLEV&
          &, YDML_DYN%YYTSCO%M_SINLA, JBLK)-Z_YDGEOMVARS_GEMU_P (JROF, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)=Z2COPHI&
          &*PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COSCO, JBLK)=Z2COPHI*PSCO (JROF, JLEV&
          &, YDML_DYN%YYTSCO%M_COSCO, JBLK)-Z_YDGEOMVARS_GSQM2_P (JROF, JBLK)
          PLEV (JROF, JLEV, JBLK)=2.0_JPRB*PLEV (JROF, JLEV, JBLK)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
          PLEV (JROF, JLEV, JBLK)=MAX (ZVETAON, MIN (ZVETAOX, PLEV (JROF, JLEV, JBLK)))
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)=Z2COPHI*PSCO&
          & (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)-1.0_JPRB
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LARMES_PARALLEL:LARMES')) THEN
    IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
    IL0A => GET_HOST_DATA_RDWR (YL_IL0A)
    INOWENO => GET_HOST_DATA_RDWR (YL_INOWENO)
    ISTESB => GET_HOST_DATA_RDWR (YL_ISTESB)
    ISTEST => GET_HOST_DATA_RDWR (YL_ISTEST)
    KL0 => GET_HOST_DATA_RDWR (YD_KL0)
    KLEV => GET_HOST_DATA_RDWR (YD_KLEV)
    KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
    PCCO => GET_HOST_DATA_RDWR (YD_PCCO)
    PLEV => GET_HOST_DATA_RDWR (YD_PLEV)
    PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
    PSCO => GET_HOST_DATA_RDWR (YD_PSCO)
    PUF => GET_HOST_DATA_RDWR (YD_PUF)
    PVF => GET_HOST_DATA_RDWR (YD_PVF)
    PWF => GET_HOST_DATA_RDWR (YD_PWF)
    ZPLEV => GET_HOST_DATA_RDWR (YL_ZPLEV)
    ZSCO => GET_HOST_DATA_RDWR (YL_ZSCO)
    ZWF => GET_HOST_DATA_RDWR (YL_ZWF)
    ZWFASM => GET_HOST_DATA_RDWR (YL_ZWFASM)
    ZWFSM => GET_HOST_DATA_RDWR (YL_ZWFSM)
    ZWF_2 => GET_HOST_DATA_RDWR (YL_ZWF_2)
    ZWO_2 => GET_HOST_DATA_RDWR (YL_ZWO_2)
    ZX0 => GET_HOST_DATA_RDWR (YL_ZX0)
    ZXF => GET_HOST_DATA_RDWR (YL_ZXF)
    ZY0 => GET_HOST_DATA_RDWR (YL_ZY0)
    ZYF => GET_HOST_DATA_RDWR (YL_ZYF)
    ZZ0 => GET_HOST_DATA_RDWR (YL_ZZ0)
    ZZF => GET_HOST_DATA_RDWR (YL_ZZF)
    Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
    Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
    Z_YDCPG_SL1_UR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UR0%F_P)
    Z_YDCPG_SL1_VR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VR0%F_P)
    Z_YDCPG_SL1_WR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%WR0%F_P)
    Z_YDCPG_SL1_WRA_P => GET_HOST_DATA_RDWR (YDCPG_SL1%WRA%F_P)
    Z_YDCPG_SL1_ZR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%ZR0%F_P)
    Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISU)
    Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISV)
    Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISW)
    Z_YDCPG_SL2_URL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_URL)
    Z_YDCPG_SL2_VRL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VRL)
    Z_YDCPG_SL2_WRL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_WRL)
    Z_YDGEOMVARS_GECLO_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GECLO%FT0)
    Z_YDGEOMVARS_GEMU_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GEMU%FT0)
    Z_YDGEOMVARS_GESLO_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GESLO%FT0)
    Z_YDGEOMVARS_GNORDL_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GNORDL%FT0)
    Z_YDGEOMVARS_GNORDM_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GNORDM%FT0)
    Z_YDGEOMVARS_GSQM2_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GSQM2%FT0)
    Z_YDGEOMVARS_RCOLON_P => GET_HOST_DATA_RDWR (YDGEOMVARS%RCOLON%FT0)
    Z_YDGEOMVARS_RSILON_P => GET_HOST_DATA_RDWR (YDGEOMVARS%RSILON%FT0)
    Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => NULL ()
  IL0A => NULL ()
  INOWENO => NULL ()
  ISTESB => NULL ()
  ISTEST => NULL ()
  KL0 => NULL ()
  KLEV => NULL ()
  KLH0 => NULL ()
  PCCO => NULL ()
  PLEV => NULL ()
  PLSCAW => NULL ()
  PRSCAW => NULL ()
  PSCO => NULL ()
  PUF => NULL ()
  PVF => NULL ()
  PWF => NULL ()
  ZPLEV => NULL ()
  ZSCO => NULL ()
  ZWF => NULL ()
  ZWFASM => NULL ()
  ZWFSM => NULL ()
  ZWF_2 => NULL ()
  ZWO_2 => NULL ()
  ZX0 => NULL ()
  ZXF => NULL ()
  ZY0 => NULL ()
  ZYF => NULL ()
  ZZ0 => NULL ()
  ZZF => NULL ()
  Z_YDA_KVSEPC_P => NULL ()
  Z_YDA_KVSEPL_P => NULL ()
  Z_YDCPG_SL1_UR0_P => NULL ()
  Z_YDCPG_SL1_VR0_P => NULL ()
  Z_YDCPG_SL1_WR0_P => NULL ()
  Z_YDCPG_SL1_WRA_P => NULL ()
  Z_YDCPG_SL1_ZR0_P => NULL ()
  Z_YDCPG_SL2_STDDISU => NULL ()
  Z_YDCPG_SL2_STDDISV => NULL ()
  Z_YDCPG_SL2_STDDISW => NULL ()
  Z_YDCPG_SL2_URL => NULL ()
  Z_YDCPG_SL2_VRL => NULL ()
  Z_YDCPG_SL2_WRL => NULL ()
  Z_YDGEOMVARS_GECLO_P => NULL ()
  Z_YDGEOMVARS_GEMU_P => NULL ()
  Z_YDGEOMVARS_GESLO_P => NULL ()
  Z_YDGEOMVARS_GNORDL_P => NULL ()
  Z_YDGEOMVARS_GNORDM_P => NULL ()
  Z_YDGEOMVARS_GSQM2_P => NULL ()
  Z_YDGEOMVARS_RCOLON_P => NULL ()
  Z_YDGEOMVARS_RSILON_P => NULL ()
  Z_YDMASK_SL2_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARMES_PARALLEL:LARMES')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => GET_DEVICE_DATA_RDWR (YL_IDEP)
  IL0A => GET_DEVICE_DATA_RDWR (YL_IL0A)
  INOWENO => GET_DEVICE_DATA_RDWR (YL_INOWENO)
  ISTESB => GET_DEVICE_DATA_RDWR (YL_ISTESB)
  ISTEST => GET_DEVICE_DATA_RDWR (YL_ISTEST)
  KL0 => GET_DEVICE_DATA_RDWR (YD_KL0)
  KLEV => GET_DEVICE_DATA_RDWR (YD_KLEV)
  KLH0 => GET_DEVICE_DATA_RDWR (YD_KLH0)
  PCCO => GET_DEVICE_DATA_RDWR (YD_PCCO)
  PLEV => GET_DEVICE_DATA_RDWR (YD_PLEV)
  PLSCAW => GET_DEVICE_DATA_RDWR (YD_PLSCAW)
  PRSCAW => GET_DEVICE_DATA_RDWR (YD_PRSCAW)
  PSCO => GET_DEVICE_DATA_RDWR (YD_PSCO)
  PUF => GET_DEVICE_DATA_RDWR (YD_PUF)
  PVF => GET_DEVICE_DATA_RDWR (YD_PVF)
  PWF => GET_DEVICE_DATA_RDWR (YD_PWF)
  ZPLEV => GET_DEVICE_DATA_RDWR (YL_ZPLEV)
  ZSCO => GET_DEVICE_DATA_RDWR (YL_ZSCO)
  ZWF => GET_DEVICE_DATA_RDWR (YL_ZWF)
  ZWFASM => GET_DEVICE_DATA_RDWR (YL_ZWFASM)
  ZWFSM => GET_DEVICE_DATA_RDWR (YL_ZWFSM)
  ZWF_2 => GET_DEVICE_DATA_RDWR (YL_ZWF_2)
  ZWO_2 => GET_DEVICE_DATA_RDWR (YL_ZWO_2)
  ZX0 => GET_DEVICE_DATA_RDWR (YL_ZX0)
  ZXF => GET_DEVICE_DATA_RDWR (YL_ZXF)
  ZY0 => GET_DEVICE_DATA_RDWR (YL_ZY0)
  ZYF => GET_DEVICE_DATA_RDWR (YL_ZYF)
  ZZ0 => GET_DEVICE_DATA_RDWR (YL_ZZ0)
  ZZF => GET_DEVICE_DATA_RDWR (YL_ZZF)
  Z_YDA_KVSEPC_P => GET_DEVICE_DATA_RDWR (YDA_KVSEPC%F_P)
  Z_YDA_KVSEPL_P => GET_DEVICE_DATA_RDWR (YDA_KVSEPL%F_P)
  Z_YDCPG_SL1_UR0_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%UR0%F_P)
  Z_YDCPG_SL1_VR0_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%VR0%F_P)
  Z_YDCPG_SL1_WR0_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%WR0%F_P)
  Z_YDCPG_SL1_WRA_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%WRA%F_P)
  Z_YDCPG_SL1_ZR0_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%ZR0%F_P)
  Z_YDCPG_SL2_STDDISU => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_STDDISU)
  Z_YDCPG_SL2_STDDISV => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_STDDISV)
  Z_YDCPG_SL2_STDDISW => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_STDDISW)
  Z_YDCPG_SL2_URL => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_URL)
  Z_YDCPG_SL2_VRL => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_VRL)
  Z_YDCPG_SL2_WRL => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_WRL)
  Z_YDGEOMVARS_GECLO_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%GECLO%FT0)
  Z_YDGEOMVARS_GEMU_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%GEMU%FT0)
  Z_YDGEOMVARS_GESLO_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%GESLO%FT0)
  Z_YDGEOMVARS_GNORDL_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%GNORDL%FT0)
  Z_YDGEOMVARS_GNORDM_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%GNORDM%FT0)
  Z_YDGEOMVARS_GSQM2_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%GSQM2%FT0)
  Z_YDGEOMVARS_RCOLON_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%RCOLON%FT0)
  Z_YDGEOMVARS_RSILON_P => GET_DEVICE_DATA_RDONLY (YDGEOMVARS%RSILON%FT0)
  Z_YDMASK_SL2_P => GET_DEVICE_DATA_RDWR (YDMASK_SL2%F_P)
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (IDEP, IL0A, INOWENO, ISTESB, ISTEST, KL0, KLEV, KLH0, PCCO, PLEV, PLSCAW, &
    !$ACC&         PRSCAW, PSCO, PUF, PVF, PWF, YDCPG_OPTS, YDCST, YDGEOMETRY, YDML_DYN, &
    !$ACC&         YDRIP, YDSL, YFXTRAN_ACDC_STACK, ZPLEV, ZSCO, ZWF, ZWFASM, ZWFSM, ZWF_2, &
    !$ACC&         ZWO_2, ZX0, ZXF, ZY0, ZYF, ZZ0, ZZF, Z_YDA_KVSEPC_P, Z_YDA_KVSEPL_P, &
    !$ACC&         Z_YDCPG_SL1_UR0_P, Z_YDCPG_SL1_VR0_P, Z_YDCPG_SL1_WR0_P, &
    !$ACC&         Z_YDCPG_SL1_WRA_P, Z_YDCPG_SL1_ZR0_P, Z_YDCPG_SL2_STDDISU, &
    !$ACC&         Z_YDCPG_SL2_STDDISV, Z_YDCPG_SL2_STDDISW, Z_YDCPG_SL2_URL, &
    !$ACC&         Z_YDCPG_SL2_VRL, Z_YDCPG_SL2_WRL, Z_YDGEOMVARS_GECLO_P, Z_YDGEOMVARS_GEMU_P, &
    !$ACC&         Z_YDGEOMVARS_GESLO_P, Z_YDGEOMVARS_GNORDL_P, Z_YDGEOMVARS_GNORDM_P, &
    !$ACC&         Z_YDGEOMVARS_GSQM2_P, Z_YDGEOMVARS_RCOLON_P, Z_YDGEOMVARS_RSILON_P, &
    !$ACC&         Z_YDMASK_SL2_P) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (IHVI, IROT, ITIP, JITER, JLEV, JROF, LLINTV, YLCPG_BNDS, YLSTACK, Z2COPHI, &
    !$ACC&         ZEF, ZEO, ZFN, ZFX, ZHVETAON, ZHVETAOX, ZLEVB, ZLEVO, ZLEVT, ZPU, ZPV, ZVDISP, &
    !$ACC&         ZVDISP_1, ZVDISP_2, ZVETAON, ZVETAOX, ZZ) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL LAMAXWIND_OPENACC (YDML_DYN, YDCST, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL(:,:, JBLK&
      &), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK),YDSTACK=YLSTACK)

      IF (YDML_DYN%YRDYN%LSVTSM) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINLA, JBLK)=Z_YDGEOMVARS_GEMU_P (JROF, JBLK)-ZEPS
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COSCO, JBLK)=Z_YDGEOMVARS_GSQM2_P (JROF, JBLK)
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)=ZEPS
          ZSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)=1.0_JPRB-ZEPS
          ZPLEV (JROF, JLEV, JBLK)=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
        
        ENDDO

        IHVI=0
        IROT=0
        ITIP=1
        LLINTV=.FALSE.
        CALL LARCINA_OPENACC (YDGEOMETRY, YDCST, YDML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDSL, IHVI&
        &, YDML_DYN%YRDYN%LFINDVSEP, LLSLHD, LLSLHDQUAD, LLINTV, ITIP, IROT,.FALSE., ZSCO(:,:,:, JBLK), ZPLEV&
        &(:,:, JBLK), ZUN_KAPPA, ZUN_KAPPAT, ZUN_KAPPAM, ZUN_KAPPAH, Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV&
        &(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), Z_YDCPG_SL1_UR0_P(:,:), Z_YDCPG_SL1_VR0_P(:,:), Z_YDCPG_SL1_ZR0_P&
        &(:,:), Z_YDCPG_SL1_WRA_P(:,:), Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK&
        &), PCCO(:,:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), ZZF(:,:, JBLK), ZWF(:,:, JBLK), ZWFASM(:,:&
        &, JBLK), IL0A(:,:,:, JBLK), KLH0(:,:,:, JBLK), KLEV(:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
        &:, JBLK), IDEP(:,:, JBLK), INOWENO(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_RSILON_P&
        &(:, JBLK), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK&
        &), Z_YDGEOMVARS_GSQM2_P(:, JBLK),YDSTACK=YLSTACK)
        CALL LAISMOA_OPENACC (YDSL%NASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW&
        & (:,:, YDML_DYN%YYTLSCAW%M_WDLO, JBLK), IL0A(:,:,:, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW&
        &%M_WDVER, JBLK), Z_YDCPG_SL1_WRA_P(:,:), ZWFASM(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

      ZLEVT=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (0)
      ZLEVB=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG+1)
      ZVETAON=(1.0_JPRB-YDML_DYN%YRDYN%VETAON)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH&
      & (0)+YDML_DYN%YRDYN%VETAON*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (1)
      ZVETAOX=(1.0_JPRB-YDML_DYN%YRDYN%VETAOX)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (YDGEOMETRY%YRDIMV%NFLEVG&
      &)+YDML_DYN%YRDYN%VETAOX*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG)

      IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
        ZHVETAON=0.5_JPRB*ZVETAON
        ZHVETAOX=1.0_JPRB-0.5_JPRB*(1.0_JPRB-ZVETAOX)
      ENDIF


      DO JITER=1, YDML_DYN%YRDYN%NITMP
        ISTEST (JROF, JBLK)=0
        ISTESB (JROF, JBLK)=0

        IF (JITER==1) THEN

          IF (YDML_DYN%YRDYN%LSLDP_CURV.AND..NOT.YDML_DYN%YRDYNA%LELTRA) THEN
            CALL LOCAL2CART_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA&
            &, YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK), Z_YDGEOMVARS_GECLO_P&
            &(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK), Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P&
            &(:, JBLK), Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL(:,:, JBLK), ZX0(:,:, JBLK), ZY0(&
            &:,:, JBLK), ZZ0(:,:, JBLK), LDROT=.TRUE.,YDSTACK=YLSTACK)
          ENDIF

          CALL MCOORDS_OPENACC (YDML_DYN%YYTSCO, YDRIP, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
          &%KIDIA, YLCPG_BNDS%KFDIA, YDCST%RA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK), Z_YDGEOMVARS_GNORDM_P&
          &(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), Z_YDCPG_SL2_URL(:,:, JBLK), Z_YDCPG_SL2_VRL(:,:, JBLK), PSCO&
          &(:,:,:, JBLK), LLO, LD2TLM=.TRUE., LDROT=.TRUE.,YDSTACK=YLSTACK)

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZFN=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-ZHVETAON
              ZFX=ZHVETAOX-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZEF=1._JPRB/ZFN+1._JPRB/ZFX
            ENDIF


            

            IF (YDGEOMETRY%YRSTA%STPREH(JLEV)>YDML_DYN%YRDYN%RPRES_SVTSM.OR..NOT.LSMOOTH) THEN
              ZWF (JROF, JLEV, JBLK)=Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK)
            ELSE
              ZWF (JROF, JLEV, JBLK)=ZWFASM (JROF, JLEV, JBLK)
            ENDIF


            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZVDISP_1=-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
              ZZ=EXP (ZVDISP_1*ZEF)*ZFN/ZFX
              ZVDISP_2=(ZHVETAON+ZHVETAOX*ZZ)/(1.0_JPRB+ZZ)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZVDISP=SIGN (1.0_JPRB, ZVDISP_1)*MIN (ABS (ZVDISP_1), ABS (ZVDISP_2))
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)+ZVDISP
            ELSE
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
            ENDIF

            ISTEST (JROF, JBLK)=ISTEST (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVO-ZLEVT-0.5_JPRB)))
            ISTESB (JROF, JBLK)=ISTESB (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVB-ZLEVO-0.5_JPRB)))
            ZLEVO=MIN (ZVETAOX, MAX (ZVETAON, ZLEVO))

            IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
              PLEV (JROF, JLEV, JBLK)=ZLEVO
            ELSE
              PLEV (JROF, JLEV, JBLK)=0.5_JPRB*(ZLEVO+YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV))
            ENDIF

          
          ENDDO

        ELSE

          IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN

            IF (LLO) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                ZXF (JROF, JLEV, JBLK)=0.5_JPRB*(PUF (JROF, JLEV, JBLK)+ZX0 (JROF, JLEV, JBLK))
                ZYF (JROF, JLEV, JBLK)=0.5_JPRB*(PVF (JROF, JLEV, JBLK)+ZY0 (JROF, JLEV, JBLK))
                ZZF (JROF, JLEV, JBLK)=0.5_JPRB*(ZZF (JROF, JLEV, JBLK)+ZZ0 (JROF, JLEV, JBLK))
              
              ENDDO

            ENDIF

            CALL CART2LOCAL_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
            &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P(:, JBLK&
            &), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK), ZXF(:,:, JBLK), ZYF&
            &(:,:, JBLK), ZZF(:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK),YDSTACK=YLSTACK)
          ELSE
            CALL ROTUV_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
            &%KFDIA, PUF(:,:, JBLK), PVF(:,:, JBLK), PCCO (:,:, YDML_DYN%YYTCCO%M_RQX, JBLK), PCCO (:,:, YDML_DYN&
            &%YYTCCO%M_RQY, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), LDIR=.FALSE.,YDSTACK=YLSTACK)

            IF (LLO) THEN

              DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
                
                ZPU=PUF (JROF, JLEV, JBLK)
                ZPV=PVF (JROF, JLEV, JBLK)
                PUF (JROF, JLEV, JBLK)=0.5_JPRB*(ZPU+Z_YDCPG_SL2_URL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDM_P&
                & (JROF, JBLK)-Z_YDCPG_SL2_VRL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDL_P (JROF, JBLK))
                PVF (JROF, JLEV, JBLK)=0.5_JPRB*(ZPV+Z_YDCPG_SL2_URL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDL_P&
                & (JROF, JBLK)+Z_YDCPG_SL2_VRL (JROF, JLEV, JBLK)*Z_YDGEOMVARS_GNORDM_P (JROF, JBLK))
              
              ENDDO

            ENDIF

          ENDIF

          CALL MCOORDS_OPENACC (YDML_DYN%YYTSCO, YDRIP, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCST%RA, Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GSQM2_P&
          &(:, JBLK), Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), PUF(:,:, JBLK)&
          &, PVF(:,:, JBLK), PSCO(:,:,:, JBLK), LLO, LD2TLM=.TRUE.,YDSTACK=YLSTACK)

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZFN=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-ZHVETAON
              ZFX=ZHVETAOX-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZEF=1._JPRB/ZFN+1._JPRB/ZFX
            ENDIF


            IF (LLO) THEN

              

              IF (YDGEOMETRY%YRSTA%STPREH(JLEV)>YDML_DYN%YRDYN%RPRES_SVTSM.OR..NOT.LSMOOTH) THEN

                IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
                  ZWF_2 (JROF, JLEV, JBLK)=ZWF (JROF, JLEV, JBLK)
                  ZWO_2 (JROF, JLEV, JBLK)=Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK)
                ENDIF

                ZWF (JROF, JLEV, JBLK)=0.5_JPRB*(ZWF (JROF, JLEV, JBLK)+Z_YDCPG_SL2_WRL (JROF, JLEV, JBLK))
              ELSE

                IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
                  ZWF_2 (JROF, JLEV, JBLK)=ZWFASM (JROF, JLEV, JBLK)
                  ZWO_2 (JROF, JLEV, JBLK)=ZWFSM (JROF, JLEV, JBLK)
                ENDIF

                ZWF (JROF, JLEV, JBLK)=0.5_JPRB*(ZWFSM (JROF, JLEV, JBLK)+ZWFASM (JROF, JLEV, JBLK))
              ENDIF

            
            ENDIF


            IF (YDML_DYN%YRDYNA%LSLDIA.AND.(JITER==YDML_DYN%YRDYN%NITMP)) THEN
              PWF (JROF, JLEV, JBLK)=ZWF (JROF, JLEV, JBLK)
            ENDIF


            

            IF (YDML_DYN%YRDYNA%LRALTVDISP) THEN
              ZVDISP_1=-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
              ZEO=1._JPRB/(PLEV (JROF, JLEV, JBLK)-ZHVETAON)+1._JPRB/(ZHVETAOX-PLEV (JROF, JLEV, JBLK))

              IF (LLO) THEN
                ZZ=EXP (-0.5_JPRB*YDRIP%RTDT*ZWF_2 (JROF, JLEV, JBLK)*ZEF-0&
                &.5_JPRB*YDRIP%RTDT*ZWO_2 (JROF, JLEV, JBLK)*ZEO)*ZFN/ZFX
              ELSE
                ZZ=EXP (-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)*ZEO)*ZFN/ZFX
              ENDIF

              ZVDISP_2=(ZHVETAON+ZHVETAOX*ZZ)/(1.0_JPRB+ZZ)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
              ZVDISP=SIGN (1.0_JPRB, ZVDISP_1)*MIN (ABS (ZVDISP_1), ABS (ZVDISP_2))
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)+ZVDISP
            ELSE
              ZLEVO=YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)-YDRIP%RTDT*ZWF (JROF, JLEV, JBLK)
            ENDIF

            ISTEST (JROF, JBLK)=ISTEST (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVO-ZLEVT-0.5_JPRB)))
            ISTESB (JROF, JBLK)=ISTESB (JROF, JBLK)-MIN (0, MAX (-1, NINT (ZLEVB-ZLEVO-0.5_JPRB)))
            ZLEVO=MIN (ZVETAOX, MAX (ZVETAON, ZLEVO))

            IF (LLO.OR.YDML_DYN%YRDYNA%LELTRA) THEN
              PLEV (JROF, JLEV, JBLK)=ZLEVO
            ELSE
              PLEV (JROF, JLEV, JBLK)=0.5_JPRB*(ZLEVO+YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV))
            ENDIF

          
          ENDDO


          IF (JITER==YDML_DYN%YRDYN%NITMP) THEN
            CALL ROTUVGEO_OPENACC (YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA,&
            & YLCPG_BNDS%KFDIA, Z_YDGEOMVARS_GNORDM_P(:, JBLK), Z_YDGEOMVARS_GNORDL_P(:, JBLK), PUF(:,:&
            &, JBLK), PVF(:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), LDIR=.FALSE.,YDSTACK=YLSTACK)
          ENDIF

        ENDIF


        IF (JITER==YDML_DYN%YRDYN%NITMP) THEN
          CALL LATRAJOUT_OPENACC (YDCST, YDML_DYN%YRDYNA%LRPRSLTRJ, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, ISTEST(:, JBLK), ISTESB(:, JBLK), ZWF(:&
          &,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (JITER/=YDML_DYN%YRDYN%NITMP) THEN
          IHVI=0

          IF (YDML_DYN%YRDYN%LSLDP_CURV) THEN
            IROT=0
          ELSE
            IROT=1
          ENDIF

          ITIP=1
          LLINTV=.TRUE.
          CALL LARCINA_OPENACC (YDGEOMETRY, YDCST, YDML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDSL, IHVI&
          &, YDML_DYN%YRDYN%LFINDVSEP, LLSLHD, LLSLHDQUAD, LLINTV, ITIP, IROT,.FALSE., PSCO(:,:,:, JBLK), PLEV&
          &(:,:, JBLK), ZUN_KAPPA, ZUN_KAPPAT, ZUN_KAPPAM, ZUN_KAPPAH, Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV&
          &(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), Z_YDCPG_SL1_UR0_P(:,:), Z_YDCPG_SL1_VR0_P(:,:), Z_YDCPG_SL1_ZR0_P&
          &(:,:), Z_YDCPG_SL1_WR0_P(:,:), Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK&
          &), PCCO(:,:,:, JBLK), PUF(:,:, JBLK), PVF(:,:, JBLK), ZZF(:,:, JBLK), ZWF(:,:, JBLK), ZWFSM(:,:,&
          & JBLK), KL0(:,:,:, JBLK), KLH0(:,:,:, JBLK), KLEV(:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:,&
          & JBLK), IDEP(:,:, JBLK), INOWENO(:,:, JBLK), Z_YDGEOMVARS_RCOLON_P(:, JBLK), Z_YDGEOMVARS_RSILON_P&
          &(:, JBLK), Z_YDGEOMVARS_GECLO_P(:, JBLK), Z_YDGEOMVARS_GEMU_P(:, JBLK), Z_YDGEOMVARS_GESLO_P(:, JBLK&
          &), Z_YDGEOMVARS_GSQM2_P(:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO


      IF (.NOT.(LLO.OR.YDML_DYN%YRDYNA%LELTRA)) THEN

        IF (YDML_DYN%YRDYNA%LTWOTL)  THEN
          CALL FXTRAN_ACDC_ABORT (' LARMES 3 ')
        ENDIF

        ZVETAON=(1.0_JPRB-YDML_DYN%YRDYN%VETAON)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH&
        & (0)+YDML_DYN%YRDYN%VETAON*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (1)
        ZVETAOX=(1.0_JPRB-YDML_DYN%YRDYN%VETAOX)*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAH (YDGEOMETRY%YRDIMV%NFLEVG&
        &)+YDML_DYN%YRDYN%VETAOX*YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (YDGEOMETRY%YRDIMV%NFLEVG)

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z2COPHI=2.0_JPRB*PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINLA, JBLK)=Z2COPHI*PSCO (JROF, JLEV&
          &, YDML_DYN%YYTSCO%M_SINLA, JBLK)-Z_YDGEOMVARS_GEMU_P (JROF, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)=Z2COPHI&
          &*PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_SINCO, JBLK)
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COSCO, JBLK)=Z2COPHI*PSCO (JROF, JLEV&
          &, YDML_DYN%YYTSCO%M_COSCO, JBLK)-Z_YDGEOMVARS_GSQM2_P (JROF, JBLK)
          PLEV (JROF, JLEV, JBLK)=2.0_JPRB*PLEV (JROF, JLEV, JBLK)-YDGEOMETRY%YRVERT_GEOM%YRVETA%VETAF (JLEV)
          PLEV (JROF, JLEV, JBLK)=MAX (ZVETAON, MIN (ZVETAOX, PLEV (JROF, JLEV, JBLK)))
          PSCO (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)=Z2COPHI*PSCO&
          & (JROF, JLEV, YDML_DYN%YYTSCO%M_COPHI, JBLK)-1.0_JPRB
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LARMES_PARALLEL:LARMES')) THEN
    IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
    IL0A => GET_HOST_DATA_RDWR (YL_IL0A)
    INOWENO => GET_HOST_DATA_RDWR (YL_INOWENO)
    ISTESB => GET_HOST_DATA_RDWR (YL_ISTESB)
    ISTEST => GET_HOST_DATA_RDWR (YL_ISTEST)
    KL0 => GET_HOST_DATA_RDWR (YD_KL0)
    KLEV => GET_HOST_DATA_RDWR (YD_KLEV)
    KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
    PCCO => GET_HOST_DATA_RDWR (YD_PCCO)
    PLEV => GET_HOST_DATA_RDWR (YD_PLEV)
    PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
    PSCO => GET_HOST_DATA_RDWR (YD_PSCO)
    PUF => GET_HOST_DATA_RDWR (YD_PUF)
    PVF => GET_HOST_DATA_RDWR (YD_PVF)
    PWF => GET_HOST_DATA_RDWR (YD_PWF)
    ZPLEV => GET_HOST_DATA_RDWR (YL_ZPLEV)
    ZSCO => GET_HOST_DATA_RDWR (YL_ZSCO)
    ZWF => GET_HOST_DATA_RDWR (YL_ZWF)
    ZWFASM => GET_HOST_DATA_RDWR (YL_ZWFASM)
    ZWFSM => GET_HOST_DATA_RDWR (YL_ZWFSM)
    ZWF_2 => GET_HOST_DATA_RDWR (YL_ZWF_2)
    ZWO_2 => GET_HOST_DATA_RDWR (YL_ZWO_2)
    ZX0 => GET_HOST_DATA_RDWR (YL_ZX0)
    ZXF => GET_HOST_DATA_RDWR (YL_ZXF)
    ZY0 => GET_HOST_DATA_RDWR (YL_ZY0)
    ZYF => GET_HOST_DATA_RDWR (YL_ZYF)
    ZZ0 => GET_HOST_DATA_RDWR (YL_ZZ0)
    ZZF => GET_HOST_DATA_RDWR (YL_ZZF)
    Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
    Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
    Z_YDCPG_SL1_UR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UR0%F_P)
    Z_YDCPG_SL1_VR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VR0%F_P)
    Z_YDCPG_SL1_WR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%WR0%F_P)
    Z_YDCPG_SL1_WRA_P => GET_HOST_DATA_RDWR (YDCPG_SL1%WRA%F_P)
    Z_YDCPG_SL1_ZR0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%ZR0%F_P)
    Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISU)
    Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISV)
    Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISW)
    Z_YDCPG_SL2_URL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_URL)
    Z_YDCPG_SL2_VRL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_VRL)
    Z_YDCPG_SL2_WRL => GET_HOST_DATA_RDWR (YDCPG_SL2%F_WRL)
    Z_YDGEOMVARS_GECLO_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GECLO%FT0)
    Z_YDGEOMVARS_GEMU_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GEMU%FT0)
    Z_YDGEOMVARS_GESLO_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GESLO%FT0)
    Z_YDGEOMVARS_GNORDL_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GNORDL%FT0)
    Z_YDGEOMVARS_GNORDM_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GNORDM%FT0)
    Z_YDGEOMVARS_GSQM2_P => GET_HOST_DATA_RDWR (YDGEOMVARS%GSQM2%FT0)
    Z_YDGEOMVARS_RCOLON_P => GET_HOST_DATA_RDWR (YDGEOMVARS%RCOLON%FT0)
    Z_YDGEOMVARS_RSILON_P => GET_HOST_DATA_RDWR (YDGEOMVARS%RSILON%FT0)
    Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => NULL ()
  IL0A => NULL ()
  INOWENO => NULL ()
  ISTESB => NULL ()
  ISTEST => NULL ()
  KL0 => NULL ()
  KLEV => NULL ()
  KLH0 => NULL ()
  PCCO => NULL ()
  PLEV => NULL ()
  PLSCAW => NULL ()
  PRSCAW => NULL ()
  PSCO => NULL ()
  PUF => NULL ()
  PVF => NULL ()
  PWF => NULL ()
  ZPLEV => NULL ()
  ZSCO => NULL ()
  ZWF => NULL ()
  ZWFASM => NULL ()
  ZWFSM => NULL ()
  ZWF_2 => NULL ()
  ZWO_2 => NULL ()
  ZX0 => NULL ()
  ZXF => NULL ()
  ZY0 => NULL ()
  ZYF => NULL ()
  ZZ0 => NULL ()
  ZZF => NULL ()
  Z_YDA_KVSEPC_P => NULL ()
  Z_YDA_KVSEPL_P => NULL ()
  Z_YDCPG_SL1_UR0_P => NULL ()
  Z_YDCPG_SL1_VR0_P => NULL ()
  Z_YDCPG_SL1_WR0_P => NULL ()
  Z_YDCPG_SL1_WRA_P => NULL ()
  Z_YDCPG_SL1_ZR0_P => NULL ()
  Z_YDCPG_SL2_STDDISU => NULL ()
  Z_YDCPG_SL2_STDDISV => NULL ()
  Z_YDCPG_SL2_STDDISW => NULL ()
  Z_YDCPG_SL2_URL => NULL ()
  Z_YDCPG_SL2_VRL => NULL ()
  Z_YDCPG_SL2_WRL => NULL ()
  Z_YDGEOMVARS_GECLO_P => NULL ()
  Z_YDGEOMVARS_GEMU_P => NULL ()
  Z_YDGEOMVARS_GESLO_P => NULL ()
  Z_YDGEOMVARS_GNORDL_P => NULL ()
  Z_YDGEOMVARS_GNORDM_P => NULL ()
  Z_YDGEOMVARS_GSQM2_P => NULL ()
  Z_YDGEOMVARS_RCOLON_P => NULL ()
  Z_YDGEOMVARS_RSILON_P => NULL ()
  Z_YDMASK_SL2_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LARMES_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL:LARMES',1,ZHOOK_HANDLE_PARALLEL)



CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_IDEP)) CALL FIELD_DELETE (YL_IDEP)
IF (ASSOCIATED (YL_IL0A)) CALL FIELD_DELETE (YL_IL0A)
IF (ASSOCIATED (YL_INOWENO)) CALL FIELD_DELETE (YL_INOWENO)
IF (ASSOCIATED (YL_ISTESB)) CALL FIELD_DELETE (YL_ISTESB)
IF (ASSOCIATED (YL_ISTEST)) CALL FIELD_DELETE (YL_ISTEST)
IF (ASSOCIATED (YL_ZPLEV)) CALL FIELD_DELETE (YL_ZPLEV)
IF (ASSOCIATED (YL_ZSCO)) CALL FIELD_DELETE (YL_ZSCO)
IF (ASSOCIATED (YL_ZWF)) CALL FIELD_DELETE (YL_ZWF)
IF (ASSOCIATED (YL_ZWFASM)) CALL FIELD_DELETE (YL_ZWFASM)
IF (ASSOCIATED (YL_ZWFSM)) CALL FIELD_DELETE (YL_ZWFSM)
IF (ASSOCIATED (YL_ZWF_2)) CALL FIELD_DELETE (YL_ZWF_2)
IF (ASSOCIATED (YL_ZWO_2)) CALL FIELD_DELETE (YL_ZWO_2)
IF (ASSOCIATED (YL_ZX0)) CALL FIELD_DELETE (YL_ZX0)
IF (ASSOCIATED (YL_ZXF)) CALL FIELD_DELETE (YL_ZXF)
IF (ASSOCIATED (YL_ZY0)) CALL FIELD_DELETE (YL_ZY0)
IF (ASSOCIATED (YL_ZYF)) CALL FIELD_DELETE (YL_ZYF)
IF (ASSOCIATED (YL_ZZ0)) CALL FIELD_DELETE (YL_ZZ0)
IF (ASSOCIATED (YL_ZZF)) CALL FIELD_DELETE (YL_ZZF)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('LARMES_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE LARMES_PARALLEL
