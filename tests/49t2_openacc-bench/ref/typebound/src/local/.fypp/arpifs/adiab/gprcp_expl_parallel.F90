SUBROUTINE GPRCP_EXPL_PARALLEL (YDCST, YDCPG_BNDS, YDCPG_OPTS&
&, YD_PCP, YD_PR, YD_PKAP, YDVARS, KGFLTYP)

USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK
USE YOMCST,ONLY:TCST
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
INTEGER (KIND=JPIM), OPTIONAL, INTENT (IN)::KGFLTYP
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
CLASS (FIELD_3RB), POINTER, OPTIONAL  :: YD_PCP
REAL (KIND=JPRB), POINTER::PCP (:,:,:)
CLASS (FIELD_3RB), POINTER, OPTIONAL  :: YD_PR
REAL (KIND=JPRB), POINTER::PR (:,:,:)
CLASS (FIELD_3RB), POINTER, OPTIONAL  :: YD_PKAP
REAL (KIND=JPRB), POINTER::PKAP (:,:,:)
#include "abor1.intfb.h"
CLASS (FIELD_3RB), POINTER :: YL_ZR
REAL (KIND=JPRB), POINTER::ZR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCP
REAL (KIND=JPRB), POINTER::ZCP (:,:,:)
LOGICAL::LLCP
CLASS (FIELD_3RB), POINTER :: YL_ZR0
REAL (KIND=JPRB), POINTER::ZR0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCP0
REAL (KIND=JPRB), POINTER::ZCP0 (:,:,:)
INTEGER (KIND=JPIM)::IFLD
INTEGER (KIND=JPIM)::JFLD
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::IGFLTYP
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GFL_PTR_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GFL_PTR_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GFL_PTR_T9(:,:,:)
IF (LHOOK) CALL DR_HOOK ("GPRCP_EXPL_PARALLEL", 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZR0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCP0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)



IF (PRESENT(YD_PR)) THEN
  YL_ZR => YD_PR
ELSEIF (PRESENT(YD_PKAP)) THEN
  YL_ZR => YL_ZR0
ELSE
  CALL ABOR1 ('GPRCP_EXPL: EXPECTED PR OR PKAP')
ENDIF

LLCP=.TRUE.

IF (PRESENT(YD_PCP)) THEN
  YL_ZCP => YD_PCP
ELSEIF (PRESENT(YD_PKAP)) THEN
  YL_ZCP => YL_ZCP0
ELSE
  YL_ZCP => NULL ()
  LLCP=.FALSE.
ENDIF

IGFLTYP=0

IF (PRESENT (KGFLTYP))  THEN
  IGFLTYP=KGFLTYP
ENDIF

IFLD=SIZE (YDVARS%GFL_PTR)
IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPRCP_EXPL_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
  ZR => GET_HOST_DATA_RDWR (YL_ZR)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    ZR (:,:, JBLK)=0._JPRB

    IF (LLCP) THEN
      ZCP (:,:, JBLK)=0._JPRB
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZR => GET_HOST_DATA_RDWR (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => NULL ()
  ZR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPRCP_EXPL_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
  ZR => GET_HOST_DATA_RDWR (YL_ZR)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      ZR (JLON,:, JBLK)=0._JPRB

      IF (LLCP) THEN
        ZCP (JLON,:, JBLK)=0._JPRB
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZR => GET_HOST_DATA_RDWR (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => NULL ()
  ZR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPRCP_EXPL_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => GET_DEVICE_DATA_RDWR (YL_ZCP)
  ZR => GET_DEVICE_DATA_RDWR (YL_ZR)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZCP, ZR) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      ZR (JLON,:, JBLK)=0._JPRB

      IF (LLCP) THEN
        ZCP (JLON,:, JBLK)=0._JPRB
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZR => GET_HOST_DATA_RDWR (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => NULL ()
  ZR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('GPRCP_EXPL_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)

SELECTCASE (IGFLTYP)
CASE (0)

  DO JFLD=1, IFLD

    IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LTHERMACT) THEN
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPRCP_EXPL_PARALLEL:1')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
        ZR => GET_HOST_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT0)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)

          

          DO JLEV=1, YDCPG_OPTS%KFLEVG

            DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T0  (JLON, JLEV, JBLK)
            ENDDO

          ENDDO


          IF (LLCP) THEN

            DO JLEV=1, YDCPG_OPTS%KFLEVG

              DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T0  (JLON, JLEV, JBLK)
              ENDDO

            ENDDO

          ENDIF

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:1')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT0)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T0 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPRCP_EXPL_PARALLEL:1')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
        ZR => GET_HOST_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT0)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JLON
            YLCPG_BNDS%KFDIA = JLON

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG
              
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T0  (JLON, JLEV, JBLK)
            
            ENDDO


            IF (LLCP) THEN

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T0  (JLON, JLEV, JBLK)
              
              ENDDO

            ENDIF

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:1')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT0)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T0 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPRCP_EXPL_PARALLEL:1')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_DEVICE_DATA_RDWR (YL_ZCP)
        ZR => GET_DEVICE_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT0)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (YDCPG_OPTS, YDCST, YDVARS, YFXTRAN_ACDC_STACK, ZCP, ZR, Z_YDVARS_GFL_PTR_T0) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

          

          DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JLON
            YLCPG_BNDS%KFDIA = JLON

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG
              
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T0  (JLON, JLEV, JBLK)
            
            ENDDO


            IF (LLCP) THEN

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T0  (JLON, JLEV, JBLK)
              
              ENDDO

            ENDIF

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:1')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT0)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T0 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('GPRCP_EXPL_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

  ENDDO

CASE (1)

  DO JFLD=1, IFLD

    IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LTHERMACT) THEN
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPRCP_EXPL_PARALLEL:2')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
        ZR => GET_HOST_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT1)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)

          

          DO JLEV=1, YDCPG_OPTS%KFLEVG

            DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T1  (JLON, JLEV, JBLK)
            ENDDO

          ENDDO


          IF (LLCP) THEN

            DO JLEV=1, YDCPG_OPTS%KFLEVG

              DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T1  (JLON, JLEV, JBLK)
              ENDDO

            ENDDO

          ENDIF

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:2')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T1 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPRCP_EXPL_PARALLEL:2')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
        ZR => GET_HOST_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT1)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JLON
            YLCPG_BNDS%KFDIA = JLON

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG
              
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T1  (JLON, JLEV, JBLK)
            
            ENDDO


            IF (LLCP) THEN

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T1  (JLON, JLEV, JBLK)
              
              ENDDO

            ENDIF

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:2')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T1 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPRCP_EXPL_PARALLEL:2')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_DEVICE_DATA_RDWR (YL_ZCP)
        ZR => GET_DEVICE_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT1)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (YDCPG_OPTS, YDCST, YDVARS, YFXTRAN_ACDC_STACK, ZCP, ZR, Z_YDVARS_GFL_PTR_T1) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

          

          DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JLON
            YLCPG_BNDS%KFDIA = JLON

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG
              
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T1  (JLON, JLEV, JBLK)
            
            ENDDO


            IF (LLCP) THEN

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T1  (JLON, JLEV, JBLK)
              
              ENDDO

            ENDIF

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:2')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T1 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('GPRCP_EXPL_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:2',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

  ENDDO

CASE (9)

  DO JFLD=1, IFLD

    IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LTHERMACT) THEN
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPRCP_EXPL_PARALLEL:3')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
        ZR => GET_HOST_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT9)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)

          

          DO JLEV=1, YDCPG_OPTS%KFLEVG

            DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T9  (JLON, JLEV, JBLK)
            ENDDO

          ENDDO


          IF (LLCP) THEN

            DO JLEV=1, YDCPG_OPTS%KFLEVG

              DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T9  (JLON, JLEV, JBLK)
              ENDDO

            ENDDO

          ENDIF

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:3')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T9 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPRCP_EXPL_PARALLEL:3')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
        ZR => GET_HOST_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT9)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JLON
            YLCPG_BNDS%KFDIA = JLON

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG
              
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T9  (JLON, JLEV, JBLK)
            
            ENDDO


            IF (LLCP) THEN

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T9  (JLON, JLEV, JBLK)
              
              ENDDO

            ENDIF

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:3')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T9 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPRCP_EXPL_PARALLEL:3')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => GET_DEVICE_DATA_RDWR (YL_ZCP)
        ZR => GET_DEVICE_DATA_RDWR (YL_ZR)
        Z_YDVARS_GFL_PTR_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%GFL_PTR (JFLD)%FT9)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (YDCPG_OPTS, YDCST, YDVARS, YFXTRAN_ACDC_STACK, ZCP, ZR, Z_YDVARS_GFL_PTR_T9) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

          

          DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JLON
            YLCPG_BNDS%KFDIA = JLON

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG
              
              ZR (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
              &)%YCOMP%R-YDCST%RD)*Z_YDVARS_GFL_PTR_T9  (JLON, JLEV, JBLK)
            
            ENDDO


            IF (LLCP) THEN

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                ZCP (JLON, JLEV, JBLK)=ZCP (JLON, JLEV, JBLK)+(YDVARS%GFL_PTR (JFLD&
                &)%YCOMP%RCP-YDCST%RCPD)*Z_YDVARS_GFL_PTR_T9  (JLON, JLEV, JBLK)
              
              ENDDO

            ENDIF

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:3')) THEN
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
          ZR => GET_HOST_DATA_RDWR (YL_ZR)
          Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JFLD)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        ZCP => NULL ()
        ZR => NULL ()
        Z_YDVARS_GFL_PTR_T9 => NULL ()
        IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('GPRCP_EXPL_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:3',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

  ENDDO

CASE DEFAULT
  CALL ABOR1 ('UNEXPECTED IGFLTYP')
ENDSELECT

IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPRCP_EXPL_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
  ZR => GET_HOST_DATA_RDWR (YL_ZR)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZR (JLON, JLEV, JBLK)=YDCST%RD+ZR (JLON, JLEV, JBLK)
      ENDDO

    ENDDO


    IF (LLCP) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZCP (JLON, JLEV, JBLK)=YDCST%RCPD+ZCP (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:4')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZR => GET_HOST_DATA_RDWR (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => NULL ()
  ZR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPRCP_EXPL_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
  ZR => GET_HOST_DATA_RDWR (YL_ZR)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZR (JLON, JLEV, JBLK)=YDCST%RD+ZR (JLON, JLEV, JBLK)
      
      ENDDO


      IF (LLCP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZCP (JLON, JLEV, JBLK)=YDCST%RCPD+ZCP (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:4')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZR => GET_HOST_DATA_RDWR (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => NULL ()
  ZR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPRCP_EXPL_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => GET_DEVICE_DATA_RDWR (YL_ZCP)
  ZR => GET_DEVICE_DATA_RDWR (YL_ZR)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDCST, YFXTRAN_ACDC_STACK, ZCP, ZR) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZR (JLON, JLEV, JBLK)=YDCST%RD+ZR (JLON, JLEV, JBLK)
      
      ENDDO


      IF (LLCP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZCP (JLON, JLEV, JBLK)=YDCST%RCPD+ZCP (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:4')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZR => GET_HOST_DATA_RDWR (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCP => NULL ()
  ZR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('GPRCP_EXPL_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:4',1,ZHOOK_HANDLE_PARALLEL)

IF (PRESENT(YD_PKAP)) THEN
  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPRCP_EXPL_PARALLEL:5')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PKAP => GET_HOST_DATA_RDWR (YD_PKAP)
    ZCP => GET_HOST_DATA_RDONLY (YL_ZCP)
    ZR => GET_HOST_DATA_RDONLY (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PKAP (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)/ZCP (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:5')) THEN
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PKAP => GET_HOST_DATA_RDWR (YD_PKAP)
      ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
      ZR => GET_HOST_DATA_RDWR (YL_ZR)
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PKAP => NULL ()
    ZCP => NULL ()
    ZR => NULL ()
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPRCP_EXPL_PARALLEL:5')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PKAP => GET_HOST_DATA_RDWR (YD_PKAP)
    ZCP => GET_HOST_DATA_RDONLY (YL_ZCP)
    ZR => GET_HOST_DATA_RDONLY (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          PKAP (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)/ZCP (JLON, JLEV, JBLK)
        
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:5')) THEN
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PKAP => GET_HOST_DATA_RDWR (YD_PKAP)
      ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
      ZR => GET_HOST_DATA_RDWR (YL_ZR)
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PKAP => NULL ()
    ZCP => NULL ()
    ZR => NULL ()
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPRCP_EXPL_PARALLEL:5')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PKAP => GET_DEVICE_DATA_RDWR (YD_PKAP)
    ZCP => GET_DEVICE_DATA_RDONLY (YL_ZCP)
    ZR => GET_DEVICE_DATA_RDONLY (YL_ZR)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (PKAP, YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZCP, ZR) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          PKAP (JLON, JLEV, JBLK)=ZR (JLON, JLEV, JBLK)/ZCP (JLON, JLEV, JBLK)
        
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('GPRCP_EXPL_PARALLEL:5')) THEN
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PKAP => GET_HOST_DATA_RDWR (YD_PKAP)
      ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
      ZR => GET_HOST_DATA_RDWR (YL_ZR)
      IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PKAP => NULL ()
    ZCP => NULL ()
    ZR => NULL ()
    IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('GPRCP_EXPL_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPRCP_EXPL_PARALLEL:5',1,ZHOOK_HANDLE_PARALLEL)
ENDIF



CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZCP0)) CALL FIELD_DELETE (YL_ZCP0)
IF (ASSOCIATED (YL_ZR0)) CALL FIELD_DELETE (YL_ZR0)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ("GPRCP_EXPL_PARALLEL", 1, ZHOOK_HANDLE)
END SUBROUTINE GPRCP_EXPL_PARALLEL
