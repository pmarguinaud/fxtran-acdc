MODULE UTIL_TECUCONVCA_MOD

USE YOE_CUCONVCA, ONLY : TECUCONVCA

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TECUCONVCA
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TECUCONVCA
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TECUCONVCA
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TECUCONVCA
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TECUCONVCA
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TECUCONVCA
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TECUCONVCA
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TECUCONVCA (SELF, KLUN)

IMPLICIT NONE
TYPE (TECUCONVCA), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LNBEW, LNBLS, LNBNS, LNBSS, LNCELLCU, LNFERTCU, LNRNBLS, LNRNBSS, LRCAPECONVCA, LRCUCONVCA
LOGICAL :: LRLATDEP, LRLATLONNBLS, LRLATLONNBSS, LRLONDEP, LRNLCONVCA, LRWASALIVE, LRWGHTCU, LSLDDLAT, LSLDLAT, LSLDLONG
LOGICAL :: LSLLAT, LSLLONG
WRITE (KLUN) SELF%NLIVES
WRITE (KLUN) SELF%NFERTYRS
WRITE (KLUN) SELF%NSPINUP
LNCELLCU = ALLOCATED (SELF%NCELLCU)
WRITE (KLUN) LNCELLCU
IF (LNCELLCU) THEN
  WRITE (KLUN) LBOUND (SELF%NCELLCU)
  WRITE (KLUN) UBOUND (SELF%NCELLCU)
  WRITE (KLUN) SELF%NCELLCU
ENDIF
LNFERTCU = ALLOCATED (SELF%NFERTCU)
WRITE (KLUN) LNFERTCU
IF (LNFERTCU) THEN
  WRITE (KLUN) LBOUND (SELF%NFERTCU)
  WRITE (KLUN) UBOUND (SELF%NFERTCU)
  WRITE (KLUN) SELF%NFERTCU
ENDIF
LNBLS = ALLOCATED (SELF%NBLS)
WRITE (KLUN) LNBLS
IF (LNBLS) THEN
  WRITE (KLUN) LBOUND (SELF%NBLS)
  WRITE (KLUN) UBOUND (SELF%NBLS)
  WRITE (KLUN) SELF%NBLS
ENDIF
LNBSS = ALLOCATED (SELF%NBSS)
WRITE (KLUN) LNBSS
IF (LNBSS) THEN
  WRITE (KLUN) LBOUND (SELF%NBSS)
  WRITE (KLUN) UBOUND (SELF%NBSS)
  WRITE (KLUN) SELF%NBSS
ENDIF
LNRNBLS = ALLOCATED (SELF%NRNBLS)
WRITE (KLUN) LNRNBLS
IF (LNRNBLS) THEN
  WRITE (KLUN) LBOUND (SELF%NRNBLS)
  WRITE (KLUN) UBOUND (SELF%NRNBLS)
  WRITE (KLUN) SELF%NRNBLS
ENDIF
LNRNBSS = ALLOCATED (SELF%NRNBSS)
WRITE (KLUN) LNRNBSS
IF (LNRNBSS) THEN
  WRITE (KLUN) LBOUND (SELF%NRNBSS)
  WRITE (KLUN) UBOUND (SELF%NRNBSS)
  WRITE (KLUN) SELF%NRNBSS
ENDIF
LNBEW = ALLOCATED (SELF%NBEW)
WRITE (KLUN) LNBEW
IF (LNBEW) THEN
  WRITE (KLUN) LBOUND (SELF%NBEW)
  WRITE (KLUN) UBOUND (SELF%NBEW)
  WRITE (KLUN) SELF%NBEW
ENDIF
LNBNS = ALLOCATED (SELF%NBNS)
WRITE (KLUN) LNBNS
IF (LNBNS) THEN
  WRITE (KLUN) LBOUND (SELF%NBNS)
  WRITE (KLUN) UBOUND (SELF%NBNS)
  WRITE (KLUN) SELF%NBNS
ENDIF
LRCUCONVCA = ALLOCATED (SELF%RCUCONVCA)
WRITE (KLUN) LRCUCONVCA
IF (LRCUCONVCA) THEN
  WRITE (KLUN) LBOUND (SELF%RCUCONVCA)
  WRITE (KLUN) UBOUND (SELF%RCUCONVCA)
  WRITE (KLUN) SELF%RCUCONVCA
ENDIF
LRNLCONVCA = ALLOCATED (SELF%RNLCONVCA)
WRITE (KLUN) LRNLCONVCA
IF (LRNLCONVCA) THEN
  WRITE (KLUN) LBOUND (SELF%RNLCONVCA)
  WRITE (KLUN) UBOUND (SELF%RNLCONVCA)
  WRITE (KLUN) SELF%RNLCONVCA
ENDIF
LRCAPECONVCA = ALLOCATED (SELF%RCAPECONVCA)
WRITE (KLUN) LRCAPECONVCA
IF (LRCAPECONVCA) THEN
  WRITE (KLUN) LBOUND (SELF%RCAPECONVCA)
  WRITE (KLUN) UBOUND (SELF%RCAPECONVCA)
  WRITE (KLUN) SELF%RCAPECONVCA
ENDIF
LRWASALIVE = ALLOCATED (SELF%RWASALIVE)
WRITE (KLUN) LRWASALIVE
IF (LRWASALIVE) THEN
  WRITE (KLUN) LBOUND (SELF%RWASALIVE)
  WRITE (KLUN) UBOUND (SELF%RWASALIVE)
  WRITE (KLUN) SELF%RWASALIVE
ENDIF
LRWGHTCU = ALLOCATED (SELF%RWGHTCU)
WRITE (KLUN) LRWGHTCU
IF (LRWGHTCU) THEN
  WRITE (KLUN) LBOUND (SELF%RWGHTCU)
  WRITE (KLUN) UBOUND (SELF%RWGHTCU)
  WRITE (KLUN) SELF%RWGHTCU
ENDIF
LRLATLONNBLS = ALLOCATED (SELF%RLATLONNBLS)
WRITE (KLUN) LRLATLONNBLS
IF (LRLATLONNBLS) THEN
  WRITE (KLUN) LBOUND (SELF%RLATLONNBLS)
  WRITE (KLUN) UBOUND (SELF%RLATLONNBLS)
  WRITE (KLUN) SELF%RLATLONNBLS
ENDIF
LRLATLONNBSS = ALLOCATED (SELF%RLATLONNBSS)
WRITE (KLUN) LRLATLONNBSS
IF (LRLATLONNBSS) THEN
  WRITE (KLUN) LBOUND (SELF%RLATLONNBSS)
  WRITE (KLUN) UBOUND (SELF%RLATLONNBSS)
  WRITE (KLUN) SELF%RLATLONNBSS
ENDIF
WRITE (KLUN) SELF%RPROB_SURVIVE
WRITE (KLUN) SELF%RPROB_BIRTH
WRITE (KLUN) SELF%RPROB_FUN_FERT_S
WRITE (KLUN) SELF%RPROB_FUN_UW_DW_S
WRITE (KLUN) SELF%RPROB_FUN_FERT_B
WRITE (KLUN) SELF%RPROB_FUN_UW_DW_B
LRLONDEP = ALLOCATED (SELF%RLONDEP)
WRITE (KLUN) LRLONDEP
IF (LRLONDEP) THEN
  WRITE (KLUN) LBOUND (SELF%RLONDEP)
  WRITE (KLUN) UBOUND (SELF%RLONDEP)
  WRITE (KLUN) SELF%RLONDEP
ENDIF
LRLATDEP = ALLOCATED (SELF%RLATDEP)
WRITE (KLUN) LRLATDEP
IF (LRLATDEP) THEN
  WRITE (KLUN) LBOUND (SELF%RLATDEP)
  WRITE (KLUN) UBOUND (SELF%RLATDEP)
  WRITE (KLUN) SELF%RLATDEP
ENDIF
WRITE (KLUN) SELF%RCA_SEEDPROB
WRITE (KLUN) SELF%RCADELX
WRITE (KLUN) SELF%LCUCONV_CA
WRITE (KLUN) SELF%LCA_ADVECT
WRITE (KLUN) SELF%LCA_GLOBAL
WRITE (KLUN) SELF%LCA_SMOOTH
WRITE (KLUN) SELF%LCA_TEST
WRITE (KLUN) SELF%LCA_ADVTEST
WRITE (KLUN) SELF%LCA_RANTROP
WRITE (KLUN) SELF%LCA_NBDEBUG
WRITE (KLUN) SELF%LCA_EXTRACT
WRITE (KLUN) SELF%CA_FORC
WRITE (KLUN) SELF%CA_WIND
WRITE (KLUN) SELF%CA_PROB
WRITE (KLUN) SELF%NFRCASEED
WRITE (KLUN) SELF%NTESTPROC
WRITE (KLUN) SELF%NTESTGP
WRITE (KLUN) SELF%NDXUNREAL
WRITE (KLUN) SELF%NDYUNREAL
LSLLONG = ALLOCATED (SELF%SLLONG)
WRITE (KLUN) LSLLONG
IF (LSLLONG) THEN
  WRITE (KLUN) LBOUND (SELF%SLLONG)
  WRITE (KLUN) UBOUND (SELF%SLLONG)
  WRITE (KLUN) SELF%SLLONG
ENDIF
LSLLAT = ALLOCATED (SELF%SLLAT)
WRITE (KLUN) LSLLAT
IF (LSLLAT) THEN
  WRITE (KLUN) LBOUND (SELF%SLLAT)
  WRITE (KLUN) UBOUND (SELF%SLLAT)
  WRITE (KLUN) SELF%SLLAT
ENDIF
LSLDLONG = ALLOCATED (SELF%SLDLONG)
WRITE (KLUN) LSLDLONG
IF (LSLDLONG) THEN
  WRITE (KLUN) LBOUND (SELF%SLDLONG)
  WRITE (KLUN) UBOUND (SELF%SLDLONG)
  WRITE (KLUN) SELF%SLDLONG
ENDIF
LSLDLAT = ALLOCATED (SELF%SLDLAT)
WRITE (KLUN) LSLDLAT
IF (LSLDLAT) THEN
  WRITE (KLUN) LBOUND (SELF%SLDLAT)
  WRITE (KLUN) UBOUND (SELF%SLDLAT)
  WRITE (KLUN) SELF%SLDLAT
ENDIF
LSLDDLAT = ALLOCATED (SELF%SLDDLAT)
WRITE (KLUN) LSLDDLAT
IF (LSLDDLAT) THEN
  WRITE (KLUN) LBOUND (SELF%SLDDLAT)
  WRITE (KLUN) UBOUND (SELF%SLDDLAT)
  WRITE (KLUN) SELF%SLDDLAT
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TECUCONVCA (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TECUCONVCA), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL3(3), IU3(3), IL4(4), IU4(4)
LOGICAL :: LNBEW, LNBLS, LNBNS, LNBSS, LNCELLCU, LNFERTCU, LNRNBLS, LNRNBSS, LRCAPECONVCA, LRCUCONVCA
LOGICAL :: LRLATDEP, LRLATLONNBLS, LRLATLONNBSS, LRLONDEP, LRNLCONVCA, LRWASALIVE, LRWGHTCU, LSLDDLAT, LSLDLAT, LSLDLONG
LOGICAL :: LSLLAT, LSLLONG
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) SELF%NLIVES
READ (KLUN) SELF%NFERTYRS
READ (KLUN) SELF%NSPINUP
READ (KLUN) LNCELLCU
IF (LNCELLCU) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NCELLCU (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NCELLCU
ENDIF
READ (KLUN) LNFERTCU
IF (LNFERTCU) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NFERTCU (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NFERTCU
ENDIF
READ (KLUN) LNBLS
IF (LNBLS) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NBLS (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NBLS
ENDIF
READ (KLUN) LNBSS
IF (LNBSS) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%NBSS (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  READ (KLUN) SELF%NBSS
ENDIF
READ (KLUN) LNRNBLS
IF (LNRNBLS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%NRNBLS (IL1(1):IU1(1)))
  READ (KLUN) SELF%NRNBLS
ENDIF
READ (KLUN) LNRNBSS
IF (LNRNBSS) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NRNBSS (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NRNBSS
ENDIF
READ (KLUN) LNBEW
IF (LNBEW) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%NBEW (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  READ (KLUN) SELF%NBEW
ENDIF
READ (KLUN) LNBNS
IF (LNBNS) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%NBNS (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  READ (KLUN) SELF%NBNS
ENDIF
READ (KLUN) LRCUCONVCA
IF (LRCUCONVCA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RCUCONVCA (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RCUCONVCA,1):UBOUND(SELF%RCUCONVCA,1)))
  READ (KLUN) ZTMP1
  SELF%RCUCONVCA = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRNLCONVCA
IF (LRNLCONVCA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RNLCONVCA (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RNLCONVCA,1):UBOUND(SELF%RNLCONVCA,1)))
  READ (KLUN) ZTMP1
  SELF%RNLCONVCA = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRCAPECONVCA
IF (LRCAPECONVCA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RCAPECONVCA (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RCAPECONVCA,1):UBOUND(SELF%RCAPECONVCA,1)))
  READ (KLUN) ZTMP1
  SELF%RCAPECONVCA = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRWASALIVE
IF (LRWASALIVE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RWASALIVE (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RWASALIVE,1):UBOUND(SELF%RWASALIVE,1)))
  READ (KLUN) ZTMP1
  SELF%RWASALIVE = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRWGHTCU
IF (LRWGHTCU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RWGHTCU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RWGHTCU,1):UBOUND(SELF%RWGHTCU,1)))
  READ (KLUN) ZTMP1
  SELF%RWGHTCU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRLATLONNBLS
IF (LRLATLONNBLS) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%RLATLONNBLS (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%RLATLONNBLS,1):UBOUND(SELF%RLATLONNBLS,1), LBOUND(SELF%RLATLONNBLS,2):UBOUND(SELF%RLATLONNBLS,2), LBOUND(SELF%RLATLONNBLS,3):UBOUND(SELF%RLATLONNBLS,3)))
  READ (KLUN) ZTMP3
  SELF%RLATLONNBLS = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LRLATLONNBSS
IF (LRLATLONNBSS) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%RLATLONNBSS (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%RLATLONNBSS,1):UBOUND(SELF%RLATLONNBSS,1), LBOUND(SELF%RLATLONNBSS,2):UBOUND(SELF%RLATLONNBSS,2), LBOUND(SELF%RLATLONNBSS,3):UBOUND(SELF%RLATLONNBSS,3), LBOUND(SELF%RLATLONNBSS,4):UBOUND(SELF%RLATLONNBSS,4)))
  READ (KLUN) ZTMP4
  SELF%RLATLONNBSS = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
ALLOCATE (ZTMP2(LBOUND(SELF%RPROB_SURVIVE,1):UBOUND(SELF%RPROB_SURVIVE,1), LBOUND(SELF%RPROB_SURVIVE,2):UBOUND(SELF%RPROB_SURVIVE,2)))
READ (KLUN) ZTMP2
SELF%RPROB_SURVIVE = ZTMP2
DEALLOCATE (ZTMP2)
ALLOCATE (ZTMP2(LBOUND(SELF%RPROB_BIRTH,1):UBOUND(SELF%RPROB_BIRTH,1), LBOUND(SELF%RPROB_BIRTH,2):UBOUND(SELF%RPROB_BIRTH,2)))
READ (KLUN) ZTMP2
SELF%RPROB_BIRTH = ZTMP2
DEALLOCATE (ZTMP2)
ALLOCATE (ZTMP1(LBOUND(SELF%RPROB_FUN_FERT_S,1):UBOUND(SELF%RPROB_FUN_FERT_S,1)))
READ (KLUN) ZTMP1
SELF%RPROB_FUN_FERT_S = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%RPROB_FUN_UW_DW_S,1):UBOUND(SELF%RPROB_FUN_UW_DW_S,1)))
READ (KLUN) ZTMP1
SELF%RPROB_FUN_UW_DW_S = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%RPROB_FUN_FERT_B,1):UBOUND(SELF%RPROB_FUN_FERT_B,1)))
READ (KLUN) ZTMP1
SELF%RPROB_FUN_FERT_B = ZTMP1
DEALLOCATE (ZTMP1)
ALLOCATE (ZTMP1(LBOUND(SELF%RPROB_FUN_UW_DW_B,1):UBOUND(SELF%RPROB_FUN_UW_DW_B,1)))
READ (KLUN) ZTMP1
SELF%RPROB_FUN_UW_DW_B = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) LRLONDEP
IF (LRLONDEP) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%RLONDEP (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%RLONDEP,1):UBOUND(SELF%RLONDEP,1), LBOUND(SELF%RLONDEP,2):UBOUND(SELF%RLONDEP,2), LBOUND(SELF%RLONDEP,3):UBOUND(SELF%RLONDEP,3)))
  READ (KLUN) ZTMP3
  SELF%RLONDEP = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LRLATDEP
IF (LRLATDEP) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%RLATDEP (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%RLATDEP,1):UBOUND(SELF%RLATDEP,1), LBOUND(SELF%RLATDEP,2):UBOUND(SELF%RLATDEP,2), LBOUND(SELF%RLATDEP,3):UBOUND(SELF%RLATDEP,3)))
  READ (KLUN) ZTMP3
  SELF%RLATDEP = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) ZTMP0
SELF%RCA_SEEDPROB = ZTMP0
READ (KLUN) ZTMP0
SELF%RCADELX = ZTMP0
READ (KLUN) SELF%LCUCONV_CA
READ (KLUN) SELF%LCA_ADVECT
READ (KLUN) SELF%LCA_GLOBAL
READ (KLUN) SELF%LCA_SMOOTH
READ (KLUN) SELF%LCA_TEST
READ (KLUN) SELF%LCA_ADVTEST
READ (KLUN) SELF%LCA_RANTROP
READ (KLUN) SELF%LCA_NBDEBUG
READ (KLUN) SELF%LCA_EXTRACT
READ (KLUN) SELF%CA_FORC
READ (KLUN) SELF%CA_WIND
READ (KLUN) SELF%CA_PROB
READ (KLUN) SELF%NFRCASEED
READ (KLUN) SELF%NTESTPROC
READ (KLUN) SELF%NTESTGP
READ (KLUN) SELF%NDXUNREAL
READ (KLUN) SELF%NDYUNREAL
READ (KLUN) LSLLONG
IF (LSLLONG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%SLLONG (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%SLLONG,1):UBOUND(SELF%SLLONG,1)))
  READ (KLUN) ZTMP1
  SELF%SLLONG = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSLLAT
IF (LSLLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%SLLAT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%SLLAT,1):UBOUND(SELF%SLLAT,1)))
  READ (KLUN) ZTMP1
  SELF%SLLAT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSLDLONG
IF (LSLDLONG) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%SLDLONG (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%SLDLONG,1):UBOUND(SELF%SLDLONG,1)))
  READ (KLUN) ZTMP1
  SELF%SLDLONG = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSLDLAT
IF (LSLDLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%SLDLAT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%SLDLAT,1):UBOUND(SELF%SLDLAT,1)))
  READ (KLUN) ZTMP1
  SELF%SLDLAT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LSLDDLAT
IF (LSLDDLAT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%SLDDLAT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%SLDDLAT,1):UBOUND(SELF%SLDDLAT,1)))
  READ (KLUN) ZTMP1
  SELF%SLDDLAT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TECUCONVCA (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TECUCONVCA), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LNBEW, LNBLS, LNBNS, LNBSS, LNCELLCU, LNFERTCU, LNRNBLS, LNRNBSS, LRCAPECONVCA, LRCUCONVCA
LOGICAL :: LRLATDEP, LRLATLONNBLS, LRLATLONNBSS, LRLONDEP, LRNLCONVCA, LRWASALIVE, LRWGHTCU, LSLDDLAT, LSLDLAT, LSLDLONG
LOGICAL :: LSLLAT, LSLLONG
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

LNCELLCU = ALLOCATED (SELF%NCELLCU)
IF (LNCELLCU) THEN
  !$ACC ENTER DATA CREATE (SELF%NCELLCU)
  !$ACC UPDATE DEVICE (SELF%NCELLCU)
  !$ACC ENTER DATA ATTACH (SELF%NCELLCU)
ENDIF

LNFERTCU = ALLOCATED (SELF%NFERTCU)
IF (LNFERTCU) THEN
  !$ACC ENTER DATA CREATE (SELF%NFERTCU)
  !$ACC UPDATE DEVICE (SELF%NFERTCU)
  !$ACC ENTER DATA ATTACH (SELF%NFERTCU)
ENDIF

LNBLS = ALLOCATED (SELF%NBLS)
IF (LNBLS) THEN
  !$ACC ENTER DATA CREATE (SELF%NBLS)
  !$ACC UPDATE DEVICE (SELF%NBLS)
  !$ACC ENTER DATA ATTACH (SELF%NBLS)
ENDIF

LNBSS = ALLOCATED (SELF%NBSS)
IF (LNBSS) THEN
  !$ACC ENTER DATA CREATE (SELF%NBSS)
  !$ACC UPDATE DEVICE (SELF%NBSS)
  !$ACC ENTER DATA ATTACH (SELF%NBSS)
ENDIF

LNRNBLS = ALLOCATED (SELF%NRNBLS)
IF (LNRNBLS) THEN
  !$ACC ENTER DATA CREATE (SELF%NRNBLS)
  !$ACC UPDATE DEVICE (SELF%NRNBLS)
  !$ACC ENTER DATA ATTACH (SELF%NRNBLS)
ENDIF

LNRNBSS = ALLOCATED (SELF%NRNBSS)
IF (LNRNBSS) THEN
  !$ACC ENTER DATA CREATE (SELF%NRNBSS)
  !$ACC UPDATE DEVICE (SELF%NRNBSS)
  !$ACC ENTER DATA ATTACH (SELF%NRNBSS)
ENDIF

LNBEW = ALLOCATED (SELF%NBEW)
IF (LNBEW) THEN
  !$ACC ENTER DATA CREATE (SELF%NBEW)
  !$ACC UPDATE DEVICE (SELF%NBEW)
  !$ACC ENTER DATA ATTACH (SELF%NBEW)
ENDIF

LNBNS = ALLOCATED (SELF%NBNS)
IF (LNBNS) THEN
  !$ACC ENTER DATA CREATE (SELF%NBNS)
  !$ACC UPDATE DEVICE (SELF%NBNS)
  !$ACC ENTER DATA ATTACH (SELF%NBNS)
ENDIF

LRCUCONVCA = ALLOCATED (SELF%RCUCONVCA)
IF (LRCUCONVCA) THEN
  !$ACC ENTER DATA CREATE (SELF%RCUCONVCA)
  !$ACC UPDATE DEVICE (SELF%RCUCONVCA)
  !$ACC ENTER DATA ATTACH (SELF%RCUCONVCA)
ENDIF

LRNLCONVCA = ALLOCATED (SELF%RNLCONVCA)
IF (LRNLCONVCA) THEN
  !$ACC ENTER DATA CREATE (SELF%RNLCONVCA)
  !$ACC UPDATE DEVICE (SELF%RNLCONVCA)
  !$ACC ENTER DATA ATTACH (SELF%RNLCONVCA)
ENDIF

LRCAPECONVCA = ALLOCATED (SELF%RCAPECONVCA)
IF (LRCAPECONVCA) THEN
  !$ACC ENTER DATA CREATE (SELF%RCAPECONVCA)
  !$ACC UPDATE DEVICE (SELF%RCAPECONVCA)
  !$ACC ENTER DATA ATTACH (SELF%RCAPECONVCA)
ENDIF

LRWASALIVE = ALLOCATED (SELF%RWASALIVE)
IF (LRWASALIVE) THEN
  !$ACC ENTER DATA CREATE (SELF%RWASALIVE)
  !$ACC UPDATE DEVICE (SELF%RWASALIVE)
  !$ACC ENTER DATA ATTACH (SELF%RWASALIVE)
ENDIF

LRWGHTCU = ALLOCATED (SELF%RWGHTCU)
IF (LRWGHTCU) THEN
  !$ACC ENTER DATA CREATE (SELF%RWGHTCU)
  !$ACC UPDATE DEVICE (SELF%RWGHTCU)
  !$ACC ENTER DATA ATTACH (SELF%RWGHTCU)
ENDIF

LRLATLONNBLS = ALLOCATED (SELF%RLATLONNBLS)
IF (LRLATLONNBLS) THEN
  !$ACC ENTER DATA CREATE (SELF%RLATLONNBLS)
  !$ACC UPDATE DEVICE (SELF%RLATLONNBLS)
  !$ACC ENTER DATA ATTACH (SELF%RLATLONNBLS)
ENDIF

LRLATLONNBSS = ALLOCATED (SELF%RLATLONNBSS)
IF (LRLATLONNBSS) THEN
  !$ACC ENTER DATA CREATE (SELF%RLATLONNBSS)
  !$ACC UPDATE DEVICE (SELF%RLATLONNBSS)
  !$ACC ENTER DATA ATTACH (SELF%RLATLONNBSS)
ENDIF

LRLONDEP = ALLOCATED (SELF%RLONDEP)
IF (LRLONDEP) THEN
  !$ACC ENTER DATA CREATE (SELF%RLONDEP)
  !$ACC UPDATE DEVICE (SELF%RLONDEP)
  !$ACC ENTER DATA ATTACH (SELF%RLONDEP)
ENDIF

LRLATDEP = ALLOCATED (SELF%RLATDEP)
IF (LRLATDEP) THEN
  !$ACC ENTER DATA CREATE (SELF%RLATDEP)
  !$ACC UPDATE DEVICE (SELF%RLATDEP)
  !$ACC ENTER DATA ATTACH (SELF%RLATDEP)
ENDIF

LSLLONG = ALLOCATED (SELF%SLLONG)
IF (LSLLONG) THEN
  !$ACC ENTER DATA CREATE (SELF%SLLONG)
  !$ACC UPDATE DEVICE (SELF%SLLONG)
  !$ACC ENTER DATA ATTACH (SELF%SLLONG)
ENDIF

LSLLAT = ALLOCATED (SELF%SLLAT)
IF (LSLLAT) THEN
  !$ACC ENTER DATA CREATE (SELF%SLLAT)
  !$ACC UPDATE DEVICE (SELF%SLLAT)
  !$ACC ENTER DATA ATTACH (SELF%SLLAT)
ENDIF

LSLDLONG = ALLOCATED (SELF%SLDLONG)
IF (LSLDLONG) THEN
  !$ACC ENTER DATA CREATE (SELF%SLDLONG)
  !$ACC UPDATE DEVICE (SELF%SLDLONG)
  !$ACC ENTER DATA ATTACH (SELF%SLDLONG)
ENDIF

LSLDLAT = ALLOCATED (SELF%SLDLAT)
IF (LSLDLAT) THEN
  !$ACC ENTER DATA CREATE (SELF%SLDLAT)
  !$ACC UPDATE DEVICE (SELF%SLDLAT)
  !$ACC ENTER DATA ATTACH (SELF%SLDLAT)
ENDIF

LSLDDLAT = ALLOCATED (SELF%SLDDLAT)
IF (LSLDDLAT) THEN
  !$ACC ENTER DATA CREATE (SELF%SLDDLAT)
  !$ACC UPDATE DEVICE (SELF%SLDDLAT)
  !$ACC ENTER DATA ATTACH (SELF%SLDDLAT)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TECUCONVCA (SELF)

IMPLICIT NONE
TYPE (TECUCONVCA), TARGET :: SELF
LOGICAL :: LNBEW, LNBLS, LNBNS, LNBSS, LNCELLCU, LNFERTCU, LNRNBLS, LNRNBSS, LRCAPECONVCA, LRCUCONVCA
LOGICAL :: LRLATDEP, LRLATLONNBLS, LRLATLONNBSS, LRLONDEP, LRNLCONVCA, LRWASALIVE, LRWGHTCU, LSLDDLAT, LSLDLAT, LSLDLONG
LOGICAL :: LSLLAT, LSLLONG

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TECUCONVCA (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TECUCONVCA), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LNBEW, LNBLS, LNBNS, LNBSS, LNCELLCU, LNFERTCU, LNRNBLS, LNRNBSS, LRCAPECONVCA, LRCUCONVCA
LOGICAL :: LRLATDEP, LRLATLONNBLS, LRLATLONNBSS, LRLONDEP, LRNLCONVCA, LRWASALIVE, LRWGHTCU, LSLDDLAT, LSLDLAT, LSLDLONG
LOGICAL :: LSLLAT, LSLLONG
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLIVES), CDPATH//'%NLIVES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NFERTYRS), CDPATH//'%NFERTYRS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSPINUP), CDPATH//'%NSPINUP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCELLCU), CDPATH//'%NCELLCU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NFERTCU), CDPATH//'%NFERTCU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBLS), CDPATH//'%NBLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBSS), CDPATH//'%NBSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRNBLS), CDPATH//'%NRNBLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRNBSS), CDPATH//'%NRNBSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBEW), CDPATH//'%NBEW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBNS), CDPATH//'%NBNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCUCONVCA), CDPATH//'%RCUCONVCA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RNLCONVCA), CDPATH//'%RNLCONVCA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCAPECONVCA), CDPATH//'%RCAPECONVCA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RWASALIVE), CDPATH//'%RWASALIVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RWGHTCU), CDPATH//'%RWGHTCU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RLATLONNBLS), CDPATH//'%RLATLONNBLS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RLATLONNBSS), CDPATH//'%RLATLONNBSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPROB_SURVIVE), CDPATH//'%RPROB_SURVIVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPROB_BIRTH), CDPATH//'%RPROB_BIRTH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPROB_FUN_FERT_S), CDPATH//'%RPROB_FUN_FERT_S'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPROB_FUN_UW_DW_S), CDPATH//'%RPROB_FUN_UW_DW_S'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPROB_FUN_FERT_B), CDPATH//'%RPROB_FUN_FERT_B'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPROB_FUN_UW_DW_B), CDPATH//'%RPROB_FUN_UW_DW_B'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RLONDEP), CDPATH//'%RLONDEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RLATDEP), CDPATH//'%RLATDEP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCA_SEEDPROB), CDPATH//'%RCA_SEEDPROB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCADELX), CDPATH//'%RCADELX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCUCONV_CA), CDPATH//'%LCUCONV_CA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_ADVECT), CDPATH//'%LCA_ADVECT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_GLOBAL), CDPATH//'%LCA_GLOBAL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_SMOOTH), CDPATH//'%LCA_SMOOTH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_TEST), CDPATH//'%LCA_TEST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_ADVTEST), CDPATH//'%LCA_ADVTEST'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_RANTROP), CDPATH//'%LCA_RANTROP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_NBDEBUG), CDPATH//'%LCA_NBDEBUG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCA_EXTRACT), CDPATH//'%LCA_EXTRACT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CA_FORC), CDPATH//'%CA_FORC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CA_WIND), CDPATH//'%CA_WIND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CA_PROB), CDPATH//'%CA_PROB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NFRCASEED), CDPATH//'%NFRCASEED'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTESTPROC), CDPATH//'%NTESTPROC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTESTGP), CDPATH//'%NTESTGP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDXUNREAL), CDPATH//'%NDXUNREAL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDYUNREAL), CDPATH//'%NDYUNREAL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SLLONG), CDPATH//'%SLLONG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SLLAT), CDPATH//'%SLLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SLDLONG), CDPATH//'%SLDLONG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SLDLAT), CDPATH//'%SLDLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SLDDLAT), CDPATH//'%SLDDLAT'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TECUCONVCA (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TECUCONVCA), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LNBEW, LNBLS, LNBNS, LNBSS, LNCELLCU, LNFERTCU, LNRNBLS, LNRNBSS, LRCAPECONVCA, LRCUCONVCA
LOGICAL :: LRLATDEP, LRLATLONNBLS, LRLATLONNBSS, LRLONDEP, LRNLCONVCA, LRWASALIVE, LRWGHTCU, LSLDDLAT, LSLDLAT, LSLDLONG
LOGICAL :: LSLLAT, LSLLONG
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LNCELLCU = ALLOCATED (SELF%NCELLCU)
IF (LNCELLCU) THEN
  !$ACC EXIT DATA DETACH (SELF%NCELLCU)
  !$ACC EXIT DATA DELETE (SELF%NCELLCU)
ENDIF

LNFERTCU = ALLOCATED (SELF%NFERTCU)
IF (LNFERTCU) THEN
  !$ACC EXIT DATA DETACH (SELF%NFERTCU)
  !$ACC EXIT DATA DELETE (SELF%NFERTCU)
ENDIF

LNBLS = ALLOCATED (SELF%NBLS)
IF (LNBLS) THEN
  !$ACC EXIT DATA DETACH (SELF%NBLS)
  !$ACC EXIT DATA DELETE (SELF%NBLS)
ENDIF

LNBSS = ALLOCATED (SELF%NBSS)
IF (LNBSS) THEN
  !$ACC EXIT DATA DETACH (SELF%NBSS)
  !$ACC EXIT DATA DELETE (SELF%NBSS)
ENDIF

LNRNBLS = ALLOCATED (SELF%NRNBLS)
IF (LNRNBLS) THEN
  !$ACC EXIT DATA DETACH (SELF%NRNBLS)
  !$ACC EXIT DATA DELETE (SELF%NRNBLS)
ENDIF

LNRNBSS = ALLOCATED (SELF%NRNBSS)
IF (LNRNBSS) THEN
  !$ACC EXIT DATA DETACH (SELF%NRNBSS)
  !$ACC EXIT DATA DELETE (SELF%NRNBSS)
ENDIF

LNBEW = ALLOCATED (SELF%NBEW)
IF (LNBEW) THEN
  !$ACC EXIT DATA DETACH (SELF%NBEW)
  !$ACC EXIT DATA DELETE (SELF%NBEW)
ENDIF

LNBNS = ALLOCATED (SELF%NBNS)
IF (LNBNS) THEN
  !$ACC EXIT DATA DETACH (SELF%NBNS)
  !$ACC EXIT DATA DELETE (SELF%NBNS)
ENDIF

LRCUCONVCA = ALLOCATED (SELF%RCUCONVCA)
IF (LRCUCONVCA) THEN
  !$ACC EXIT DATA DETACH (SELF%RCUCONVCA)
  !$ACC EXIT DATA DELETE (SELF%RCUCONVCA)
ENDIF

LRNLCONVCA = ALLOCATED (SELF%RNLCONVCA)
IF (LRNLCONVCA) THEN
  !$ACC EXIT DATA DETACH (SELF%RNLCONVCA)
  !$ACC EXIT DATA DELETE (SELF%RNLCONVCA)
ENDIF

LRCAPECONVCA = ALLOCATED (SELF%RCAPECONVCA)
IF (LRCAPECONVCA) THEN
  !$ACC EXIT DATA DETACH (SELF%RCAPECONVCA)
  !$ACC EXIT DATA DELETE (SELF%RCAPECONVCA)
ENDIF

LRWASALIVE = ALLOCATED (SELF%RWASALIVE)
IF (LRWASALIVE) THEN
  !$ACC EXIT DATA DETACH (SELF%RWASALIVE)
  !$ACC EXIT DATA DELETE (SELF%RWASALIVE)
ENDIF

LRWGHTCU = ALLOCATED (SELF%RWGHTCU)
IF (LRWGHTCU) THEN
  !$ACC EXIT DATA DETACH (SELF%RWGHTCU)
  !$ACC EXIT DATA DELETE (SELF%RWGHTCU)
ENDIF

LRLATLONNBLS = ALLOCATED (SELF%RLATLONNBLS)
IF (LRLATLONNBLS) THEN
  !$ACC EXIT DATA DETACH (SELF%RLATLONNBLS)
  !$ACC EXIT DATA DELETE (SELF%RLATLONNBLS)
ENDIF

LRLATLONNBSS = ALLOCATED (SELF%RLATLONNBSS)
IF (LRLATLONNBSS) THEN
  !$ACC EXIT DATA DETACH (SELF%RLATLONNBSS)
  !$ACC EXIT DATA DELETE (SELF%RLATLONNBSS)
ENDIF

LRLONDEP = ALLOCATED (SELF%RLONDEP)
IF (LRLONDEP) THEN
  !$ACC EXIT DATA DETACH (SELF%RLONDEP)
  !$ACC EXIT DATA DELETE (SELF%RLONDEP)
ENDIF

LRLATDEP = ALLOCATED (SELF%RLATDEP)
IF (LRLATDEP) THEN
  !$ACC EXIT DATA DETACH (SELF%RLATDEP)
  !$ACC EXIT DATA DELETE (SELF%RLATDEP)
ENDIF

LSLLONG = ALLOCATED (SELF%SLLONG)
IF (LSLLONG) THEN
  !$ACC EXIT DATA DETACH (SELF%SLLONG)
  !$ACC EXIT DATA DELETE (SELF%SLLONG)
ENDIF

LSLLAT = ALLOCATED (SELF%SLLAT)
IF (LSLLAT) THEN
  !$ACC EXIT DATA DETACH (SELF%SLLAT)
  !$ACC EXIT DATA DELETE (SELF%SLLAT)
ENDIF

LSLDLONG = ALLOCATED (SELF%SLDLONG)
IF (LSLDLONG) THEN
  !$ACC EXIT DATA DETACH (SELF%SLDLONG)
  !$ACC EXIT DATA DELETE (SELF%SLDLONG)
ENDIF

LSLDLAT = ALLOCATED (SELF%SLDLAT)
IF (LSLDLAT) THEN
  !$ACC EXIT DATA DETACH (SELF%SLDLAT)
  !$ACC EXIT DATA DELETE (SELF%SLDLAT)
ENDIF

LSLDDLAT = ALLOCATED (SELF%SLDDLAT)
IF (LSLDDLAT) THEN
  !$ACC EXIT DATA DETACH (SELF%SLDDLAT)
  !$ACC EXIT DATA DELETE (SELF%SLDDLAT)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TECUCONVCA (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TECUCONVCA),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LNBEW, LNBLS, LNBNS, LNBSS, LNCELLCU, LNFERTCU, LNRNBLS, LNRNBSS, LRCAPECONVCA, LRCUCONVCA
LOGICAL :: LRLATDEP, LRLATLONNBLS, LRLATLONNBSS, LRLONDEP, LRNLCONVCA, LRWASALIVE, LRWGHTCU, LSLDDLAT, LSLDLAT, LSLDLONG
LOGICAL :: LSLLAT, LSLLONG
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%NLIVES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLIVES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NFERTYRS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFERTYRS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSPINUP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSPINUP'
ENDIF
KSIZE = KSIZE + ISIZE
LNCELLCU = ALLOCATED (SELF%NCELLCU)
IF (LNCELLCU) THEN
  ISIZE = KIND (SELF%NCELLCU) * SIZE (SELF%NCELLCU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NCELLCU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNFERTCU = ALLOCATED (SELF%NFERTCU)
IF (LNFERTCU) THEN
  ISIZE = KIND (SELF%NFERTCU) * SIZE (SELF%NFERTCU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NFERTCU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNBLS = ALLOCATED (SELF%NBLS)
IF (LNBLS) THEN
  ISIZE = KIND (SELF%NBLS) * SIZE (SELF%NBLS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NBLS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNBSS = ALLOCATED (SELF%NBSS)
IF (LNBSS) THEN
  ISIZE = KIND (SELF%NBSS) * SIZE (SELF%NBSS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NBSS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNRNBLS = ALLOCATED (SELF%NRNBLS)
IF (LNRNBLS) THEN
  ISIZE = KIND (SELF%NRNBLS) * SIZE (SELF%NRNBLS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NRNBLS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNRNBSS = ALLOCATED (SELF%NRNBSS)
IF (LNRNBSS) THEN
  ISIZE = KIND (SELF%NRNBSS) * SIZE (SELF%NRNBSS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NRNBSS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNBEW = ALLOCATED (SELF%NBEW)
IF (LNBEW) THEN
  ISIZE = KIND (SELF%NBEW) * SIZE (SELF%NBEW)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NBEW'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LNBNS = ALLOCATED (SELF%NBNS)
IF (LNBNS) THEN
  ISIZE = KIND (SELF%NBNS) * SIZE (SELF%NBNS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NBNS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRCUCONVCA = ALLOCATED (SELF%RCUCONVCA)
IF (LRCUCONVCA) THEN
  ISIZE = KIND (SELF%RCUCONVCA) * SIZE (SELF%RCUCONVCA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RCUCONVCA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRNLCONVCA = ALLOCATED (SELF%RNLCONVCA)
IF (LRNLCONVCA) THEN
  ISIZE = KIND (SELF%RNLCONVCA) * SIZE (SELF%RNLCONVCA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RNLCONVCA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRCAPECONVCA = ALLOCATED (SELF%RCAPECONVCA)
IF (LRCAPECONVCA) THEN
  ISIZE = KIND (SELF%RCAPECONVCA) * SIZE (SELF%RCAPECONVCA)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RCAPECONVCA'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRWASALIVE = ALLOCATED (SELF%RWASALIVE)
IF (LRWASALIVE) THEN
  ISIZE = KIND (SELF%RWASALIVE) * SIZE (SELF%RWASALIVE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RWASALIVE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRWGHTCU = ALLOCATED (SELF%RWGHTCU)
IF (LRWGHTCU) THEN
  ISIZE = KIND (SELF%RWGHTCU) * SIZE (SELF%RWGHTCU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RWGHTCU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRLATLONNBLS = ALLOCATED (SELF%RLATLONNBLS)
IF (LRLATLONNBLS) THEN
  ISIZE = KIND (SELF%RLATLONNBLS) * SIZE (SELF%RLATLONNBLS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RLATLONNBLS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRLATLONNBSS = ALLOCATED (SELF%RLATLONNBSS)
IF (LRLATLONNBSS) THEN
  ISIZE = KIND (SELF%RLATLONNBSS) * SIZE (SELF%RLATLONNBSS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RLATLONNBSS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (SELF%RPROB_SURVIVE) * SIZE (SELF%RPROB_SURVIVE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPROB_SURVIVE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RPROB_BIRTH) * SIZE (SELF%RPROB_BIRTH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPROB_BIRTH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RPROB_FUN_FERT_S) * SIZE (SELF%RPROB_FUN_FERT_S)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPROB_FUN_FERT_S'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RPROB_FUN_UW_DW_S) * SIZE (SELF%RPROB_FUN_UW_DW_S)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPROB_FUN_UW_DW_S'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RPROB_FUN_FERT_B) * SIZE (SELF%RPROB_FUN_FERT_B)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPROB_FUN_FERT_B'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RPROB_FUN_UW_DW_B) * SIZE (SELF%RPROB_FUN_UW_DW_B)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPROB_FUN_UW_DW_B'
ENDIF
KSIZE = KSIZE + ISIZE
LRLONDEP = ALLOCATED (SELF%RLONDEP)
IF (LRLONDEP) THEN
  ISIZE = KIND (SELF%RLONDEP) * SIZE (SELF%RLONDEP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RLONDEP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRLATDEP = ALLOCATED (SELF%RLATDEP)
IF (LRLATDEP) THEN
  ISIZE = KIND (SELF%RLATDEP) * SIZE (SELF%RLATDEP)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RLATDEP'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (SELF%RCA_SEEDPROB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCA_SEEDPROB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCADELX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCADELX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCUCONV_CA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCUCONV_CA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_ADVECT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_ADVECT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_GLOBAL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_GLOBAL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_SMOOTH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_SMOOTH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_TEST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_TEST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_ADVTEST)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_ADVTEST'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_RANTROP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_RANTROP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_NBDEBUG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_NBDEBUG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCA_EXTRACT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCA_EXTRACT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CA_FORC) * LEN (SELF%CA_FORC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CA_FORC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CA_WIND) * LEN (SELF%CA_WIND)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CA_WIND'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CA_PROB) * LEN (SELF%CA_PROB)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CA_PROB'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NFRCASEED)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NFRCASEED'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTESTPROC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTESTPROC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTESTGP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTESTGP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDXUNREAL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDXUNREAL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDYUNREAL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDYUNREAL'
ENDIF
KSIZE = KSIZE + ISIZE
LSLLONG = ALLOCATED (SELF%SLLONG)
IF (LSLLONG) THEN
  ISIZE = KIND (SELF%SLLONG) * SIZE (SELF%SLLONG)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SLLONG'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSLLAT = ALLOCATED (SELF%SLLAT)
IF (LSLLAT) THEN
  ISIZE = KIND (SELF%SLLAT) * SIZE (SELF%SLLAT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SLLAT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSLDLONG = ALLOCATED (SELF%SLDLONG)
IF (LSLDLONG) THEN
  ISIZE = KIND (SELF%SLDLONG) * SIZE (SELF%SLDLONG)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SLDLONG'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSLDLAT = ALLOCATED (SELF%SLDLAT)
IF (LSLDLAT) THEN
  ISIZE = KIND (SELF%SLDLAT) * SIZE (SELF%SLDLAT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SLDLAT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSLDDLAT = ALLOCATED (SELF%SLDDLAT)
IF (LSLDDLAT) THEN
  ISIZE = KIND (SELF%SLDDLAT) * SIZE (SELF%SLDDLAT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SLDDLAT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
