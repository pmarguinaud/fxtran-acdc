SUBROUTINE APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL (YDMF_PHYS_BASE_STATE, YDMF_PHYS_NEXT_STATE&
&, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF&
&, YDVARS, YDMODEL, YDDDH, YD_PDIFEXT, YD_PDSA_CPS, YD_PMSC_FRMQ, YD_PPFL_FEFB1, YD_PPFL_FEFB2&
&, YD_PPFL_FEFB3, YD_PPFL_FTKE, YD_PPFL_FTKEI, YD_PFCHQ)
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK

USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE MF_PHYS_NEXT_STATE_TYPE_MOD,ONLY:MF_PHYS_NEXT_STATE_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE, CPG_DYN_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE TYPE_MODEL,ONLY:MODEL
USE DDH_MIX,ONLY:TYP_DDH
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (MF_PHYS_NEXT_STATE_TYPE), INTENT (INOUT)::YDMF_PHYS_NEXT_STATE
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (TYP_DDH), INTENT (INOUT)::YDDDH
CLASS (FIELD_4RB), POINTER :: YD_PDIFEXT
REAL (KIND=JPRB), POINTER::PDIFEXT (:,:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDSA_CPS
REAL (KIND=JPRB), POINTER::PDSA_CPS (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMSC_FRMQ
REAL (KIND=JPRB), POINTER::PMSC_FRMQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FEFB1
REAL (KIND=JPRB), POINTER::PPFL_FEFB1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FEFB2
REAL (KIND=JPRB), POINTER::PPFL_FEFB2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FEFB3
REAL (KIND=JPRB), POINTER::PPFL_FEFB3 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FTKE
REAL (KIND=JPRB), POINTER::PPFL_FTKE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FTKEI
REAL (KIND=JPRB), POINTER::PPFL_FTKEI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFCHQ
REAL (KIND=JPRB), POINTER::PFCHQ (:,:,:)
#include "cpmvvps.intfb.h"
#include "abor1.intfb.h"
#include "cpmvvps_openacc.intfb.h"
#include "cptend_new.intfb.h"
#include "cptend_new_openacc.intfb.h"
#include "cputqy_aplpar_expl_parallel.intfb.h"
CLASS (FIELD_3RB), POINTER :: YL_ZMSC_FHP
REAL (KIND=JPRB), POINTER::ZMSC_FHP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FP
REAL (KIND=JPRB), POINTER::ZPFL_FP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDD
REAL (KIND=JPRB), POINTER::ZTENDD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDEFB1
REAL (KIND=JPRB), POINTER::ZTENDEFB1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDEFB2
REAL (KIND=JPRB), POINTER::ZTENDEFB2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDEFB3
REAL (KIND=JPRB), POINTER::ZTENDEFB3 (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZTENDEXT
REAL (KIND=JPRB), POINTER::ZTENDEXT (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDG
REAL (KIND=JPRB), POINTER::ZTENDG (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDH
REAL (KIND=JPRB), POINTER::ZTENDH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDI
REAL (KIND=JPRB), POINTER::ZTENDI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDICONV
REAL (KIND=JPRB), POINTER::ZTENDICONV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDL
REAL (KIND=JPRB), POINTER::ZTENDL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDLCONV
REAL (KIND=JPRB), POINTER::ZTENDLCONV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDQ
REAL (KIND=JPRB), POINTER::ZTENDQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDR
REAL (KIND=JPRB), POINTER::ZTENDR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDRCONV
REAL (KIND=JPRB), POINTER::ZTENDRCONV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDS
REAL (KIND=JPRB), POINTER::ZTENDS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDSCONV
REAL (KIND=JPRB), POINTER::ZTENDSCONV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDTKE
REAL (KIND=JPRB), POINTER::ZTENDTKE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDU
REAL (KIND=JPRB), POINTER::ZTENDU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENDV
REAL (KIND=JPRB), POINTER::ZTENDV (:,:,:)
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_EVEL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_PSDVBC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_G(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_I(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_L(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_S(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_NEXT_STATE_SP_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQIC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQLC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCMPCQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCMPSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCMPSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCNEGQIC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCNEGQLC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCNEGQRC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCNEGQSC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQGNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQLNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQNNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQRNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQSNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEDQIC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEDQLC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEDQRC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEDQSC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEPFP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHPCG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHPCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHPCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHPSG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHPSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHPSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHSCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHSCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHSSG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHSSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FHSSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FIMCC(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRMH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSO(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTH(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TENDU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TENDV(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDL_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GNORDM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_ICONV_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_LCONV_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_RCONV_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SCONV_T0(:,:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZTENDV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDTKE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDSCONV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDRCONV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDLCONV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDICONV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDEXT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_GCONF%YGFL&
&%NGFL_EXT, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDEFB3, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDEFB2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDEFB1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENDD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMSC_FHP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL:CPTEND_NEW',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL:CPTEND_NEW')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PDIFEXT => GET_HOST_DATA_RDONLY (YD_PDIFEXT)
  PDSA_CPS => GET_HOST_DATA_RDONLY (YD_PDSA_CPS)
  PFCHQ => GET_HOST_DATA_RDONLY (YD_PFCHQ)
  PMSC_FRMQ => GET_HOST_DATA_RDONLY (YD_PMSC_FRMQ)
  PPFL_FEFB1 => GET_HOST_DATA_RDONLY (YD_PPFL_FEFB1)
  PPFL_FEFB2 => GET_HOST_DATA_RDONLY (YD_PPFL_FEFB2)
  PPFL_FEFB3 => GET_HOST_DATA_RDONLY (YD_PPFL_FEFB3)
  PPFL_FTKE => GET_HOST_DATA_RDONLY (YD_PPFL_FTKE)
  PPFL_FTKEI => GET_HOST_DATA_RDONLY (YD_PPFL_FTKEI)
  ZMSC_FHP => GET_HOST_DATA_RDWR (YL_ZMSC_FHP)
  ZPFL_FP => GET_HOST_DATA_RDWR (YL_ZPFL_FP)
  ZTENDD => GET_HOST_DATA_RDWR (YL_ZTENDD)
  ZTENDEFB1 => GET_HOST_DATA_RDWR (YL_ZTENDEFB1)
  ZTENDEFB2 => GET_HOST_DATA_RDWR (YL_ZTENDEFB2)
  ZTENDEFB3 => GET_HOST_DATA_RDWR (YL_ZTENDEFB3)
  ZTENDEXT => GET_HOST_DATA_RDWR (YL_ZTENDEXT)
  ZTENDG => GET_HOST_DATA_RDWR (YL_ZTENDG)
  ZTENDH => GET_HOST_DATA_RDWR (YL_ZTENDH)
  ZTENDI => GET_HOST_DATA_RDWR (YL_ZTENDI)
  ZTENDICONV => GET_HOST_DATA_RDWR (YL_ZTENDICONV)
  ZTENDL => GET_HOST_DATA_RDWR (YL_ZTENDL)
  ZTENDLCONV => GET_HOST_DATA_RDWR (YL_ZTENDLCONV)
  ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
  ZTENDR => GET_HOST_DATA_RDWR (YL_ZTENDR)
  ZTENDRCONV => GET_HOST_DATA_RDWR (YL_ZTENDRCONV)
  ZTENDS => GET_HOST_DATA_RDWR (YL_ZTENDS)
  ZTENDSCONV => GET_HOST_DATA_RDWR (YL_ZTENDSCONV)
  ZTENDTKE => GET_HOST_DATA_RDWR (YL_ZTENDTKE)
  ZTENDU => GET_HOST_DATA_RDWR (YL_ZTENDU)
  ZTENDV => GET_HOST_DATA_RDWR (YL_ZTENDV)
  Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
  Z_YDMF_PHYS_BASE_STATE_G => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_G)
  Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_R)
  Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_S)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_NEXT_STATE_SP_P => GET_HOST_DATA_RDWR (YDMF_PHYS_NEXT_STATE%SP%F_P)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCQIC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQIC)
  Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQL)
  Z_YDMF_PHYS_OUT_DIFCQLC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQLC)
  Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQN)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FCMPCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPCQ)
  Z_YDMF_PHYS_OUT_FCMPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSL)
  Z_YDMF_PHYS_OUT_FCMPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSN)
  Z_YDMF_PHYS_OUT_FCNEGQIC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQIC)
  Z_YDMF_PHYS_OUT_FCNEGQLC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQLC)
  Z_YDMF_PHYS_OUT_FCNEGQRC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQRC)
  Z_YDMF_PHYS_OUT_FCNEGQSC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQSC)
  Z_YDMF_PHYS_OUT_FCQGNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQGNG)
  Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQLNG)
  Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQNNG)
  Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQRNG)
  Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQSNG)
  Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FEDQIC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQIC)
  Z_YDMF_PHYS_OUT_FEDQLC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQLC)
  Z_YDMF_PHYS_OUT_FEDQRC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQRC)
  Z_YDMF_PHYS_OUT_FEDQSC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQSC)
  Z_YDMF_PHYS_OUT_FEPFP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEPFP)
  Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVL)
  Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVN)
  Z_YDMF_PHYS_OUT_FHPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCG)
  Z_YDMF_PHYS_OUT_FHPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCL)
  Z_YDMF_PHYS_OUT_FHPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCN)
  Z_YDMF_PHYS_OUT_FHPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSG)
  Z_YDMF_PHYS_OUT_FHPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSL)
  Z_YDMF_PHYS_OUT_FHPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSN)
  Z_YDMF_PHYS_OUT_FHSCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCL)
  Z_YDMF_PHYS_OUT_FHSCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCN)
  Z_YDMF_PHYS_OUT_FHSSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSG)
  Z_YDMF_PHYS_OUT_FHSSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSL)
  Z_YDMF_PHYS_OUT_FHSSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSN)
  Z_YDMF_PHYS_OUT_FIMCC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FIMCC)
  Z_YDMF_PHYS_OUT_FPEVPCG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCG)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPEVPSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSG)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPFPSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSG)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLCG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCG)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSG)
  Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
  Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRMH)
  Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCV)
  Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRDU)
  Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRDV)
  Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRMU)
  Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRMV)
  Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRTV)
  Z_YDMF_PHYS_OUT_TENDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDU)
  Z_YDMF_PHYS_OUT_TENDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDV)
  Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  Z_YDVARS_ICONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%ICONV%FT0)
  Z_YDVARS_LCONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%LCONV%FT0)
  Z_YDVARS_RCONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%RCONV%FT0)
  Z_YDVARS_SCONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%SCONV%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    ZTENDEFB1(:,:, JBLK)=0._JPRB
    ZTENDEFB2(:,:, JBLK)=0._JPRB
    ZTENDEFB3(:,:, JBLK)=0._JPRB
    ZTENDG(:,:, JBLK)=0._JPRB
    ZTENDI(:,:, JBLK)=0._JPRB
    ZTENDQ(:,:, JBLK)=0._JPRB
    ZTENDR(:,:, JBLK)=0._JPRB
    ZTENDS(:,:, JBLK)=0._JPRB
    ZTENDL(:,:, JBLK)=0._JPRB
    ZTENDICONV(:,:, JBLK)=0._JPRB
    ZTENDLCONV(:,:, JBLK)=0._JPRB
    ZTENDRCONV(:,:, JBLK)=0._JPRB
    ZTENDSCONV(:,:, JBLK)=0._JPRB
    ZTENDTKE(:,:, JBLK)=0._JPRB
    ZTENDD(:,:, JBLK)=0.0_JPRB
    CALL CPTEND_NEW (YDMODEL%YRCST, YDMODEL, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
    &%KFLEVG, Z_YDVARS_GEOMETRY_GNORDL_T0(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_T0(:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS&
    &(:,:, JBLK), PDIFEXT(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN(:,:, JBLK&
    &), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK&
    &), Z_YDMF_PHYS_OUT_FCCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:,:, JBLK&
    &), Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSG(:,:, JBLK&
    &), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCG(:,:, JBLK&
    &), Z_YDMF_PHYS_OUT_FPEVPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSG(:&
    &,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCG&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSG&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQLNG&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQRNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQSNG&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQGNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FRMH&
    &(:,:, JBLK), PMSC_FRMQ(:,:, JBLK), PFCHQ(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH&
    &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDU&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDV(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTV&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMV(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQLC&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FIMCC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQLC&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQRC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQSC&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQLC(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQRC&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQSC(:,:, JBLK), PPFL_FTKE(:,:, JBLK), PPFL_FTKEI(:,:, JBLK), PPFL_FEFB1&
    &(:,:, JBLK), PPFL_FEFB2(:,:, JBLK), PPFL_FEFB3(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(&
    &:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK),&
    & Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(&
    &:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_I(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_L(:,:, JBLK), Z_YDVARS_LCONV_T0&
    &(:,:, JBLK), Z_YDVARS_ICONV_T0(:,:, JBLK), Z_YDVARS_RCONV_T0(:,:, JBLK), Z_YDVARS_SCONV_T0(:,:, JBLK&
    &), Z_YDMF_PHYS_BASE_STATE_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_S(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_G&
    &(:,:, JBLK), PDSA_CPS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_OUT_FHSCL(:,:&
    &, JBLK), Z_YDMF_PHYS_OUT_FHSCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FHSSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHSSN(:&
    &,:, JBLK), Z_YDMF_PHYS_OUT_FHSSG(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCN&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCG(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSN&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSG(:,:, JBLK), ZMSC_FHP(:,:, JBLK), ZPFL_FP(:,:, JBLK), Z_YDMF_PHYS_OUT_FEPFP&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPSL&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_TENDU(:,:, JBLK), Z_YDMF_PHYS_OUT_TENDV(:,:, JBLK), ZTENDU(:,:, JBLK), ZTENDV&
    &(:,:, JBLK), ZTENDH(:,:, JBLK), ZTENDQ(:,:, JBLK), ZTENDI(:,:, JBLK), ZTENDL(:,:, JBLK), ZTENDLCONV(&
    &:,:, JBLK), ZTENDICONV(:,:, JBLK), ZTENDRCONV(:,:, JBLK), ZTENDSCONV(:,:, JBLK), ZTENDR(:,:, JBLK), ZTENDS&
    &(:,:, JBLK), ZTENDG(:,:, JBLK), ZTENDTKE(:,:, JBLK), ZTENDEFB1(:,:, JBLK), ZTENDEFB2(:,:, JBLK), ZTENDEFB3&
    &(:,:, JBLK), ZTENDEXT(:,:,:, JBLK), YDDDH)

    IF (YDMODEL%YRML_DYN%YRDYNA%LTWOTL) THEN
    ELSE

      IF ((YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI==1)) THEN

        DO JLEV=0, YDCPG_OPTS%KFLEVG

          DO JLON=1, YDCPG_OPTS%KLON
            Z_YDMF_PHYS_OUT_FEPFP (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPCQ (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPSN (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPSL (JLON, JLEV, JBLK)=0.0_JPRB
          ENDDO

        ENDDO

      ENDIF

    ENDIF


    IF (YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI==1) THEN
      CALL CPMVVPS (YDMODEL%YRCST, YDGEOMETRY%YRVERT_GEOM%YRVAB, YDCPG_OPTS%KLON, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%ZDTPHY, ZPFL_FP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      & (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_FEVL (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVN&
      & (:, 1, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), Z_YDCPG_DYN0_CTY_PSDVBC(:,:, JBLK),&
      & Z_YDMF_PHYS_NEXT_STATE_SP_P(:, JBLK))
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL:CPTEND_NEW')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
    &:CPTEND_NEW:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
    PDSA_CPS => GET_HOST_DATA_RDWR (YD_PDSA_CPS)
    PFCHQ => GET_HOST_DATA_RDWR (YD_PFCHQ)
    PMSC_FRMQ => GET_HOST_DATA_RDWR (YD_PMSC_FRMQ)
    PPFL_FEFB1 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB1)
    PPFL_FEFB2 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB2)
    PPFL_FEFB3 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB3)
    PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
    PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
    ZMSC_FHP => GET_HOST_DATA_RDWR (YL_ZMSC_FHP)
    ZPFL_FP => GET_HOST_DATA_RDWR (YL_ZPFL_FP)
    ZTENDD => GET_HOST_DATA_RDWR (YL_ZTENDD)
    ZTENDEFB1 => GET_HOST_DATA_RDWR (YL_ZTENDEFB1)
    ZTENDEFB2 => GET_HOST_DATA_RDWR (YL_ZTENDEFB2)
    ZTENDEFB3 => GET_HOST_DATA_RDWR (YL_ZTENDEFB3)
    ZTENDEXT => GET_HOST_DATA_RDWR (YL_ZTENDEXT)
    ZTENDG => GET_HOST_DATA_RDWR (YL_ZTENDG)
    ZTENDH => GET_HOST_DATA_RDWR (YL_ZTENDH)
    ZTENDI => GET_HOST_DATA_RDWR (YL_ZTENDI)
    ZTENDICONV => GET_HOST_DATA_RDWR (YL_ZTENDICONV)
    ZTENDL => GET_HOST_DATA_RDWR (YL_ZTENDL)
    ZTENDLCONV => GET_HOST_DATA_RDWR (YL_ZTENDLCONV)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDR => GET_HOST_DATA_RDWR (YL_ZTENDR)
    ZTENDRCONV => GET_HOST_DATA_RDWR (YL_ZTENDRCONV)
    ZTENDS => GET_HOST_DATA_RDWR (YL_ZTENDS)
    ZTENDSCONV => GET_HOST_DATA_RDWR (YL_ZTENDSCONV)
    ZTENDTKE => GET_HOST_DATA_RDWR (YL_ZTENDTKE)
    ZTENDU => GET_HOST_DATA_RDWR (YL_ZTENDU)
    ZTENDV => GET_HOST_DATA_RDWR (YL_ZTENDV)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
    Z_YDMF_PHYS_BASE_STATE_G => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_G)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_R)
    Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_S)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_NEXT_STATE_SP_P => GET_HOST_DATA_RDWR (YDMF_PHYS_NEXT_STATE%SP%F_P)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQIC)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_DIFCQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQLC)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCMPCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPCQ)
    Z_YDMF_PHYS_OUT_FCMPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSL)
    Z_YDMF_PHYS_OUT_FCMPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSN)
    Z_YDMF_PHYS_OUT_FCNEGQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQIC)
    Z_YDMF_PHYS_OUT_FCNEGQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQLC)
    Z_YDMF_PHYS_OUT_FCNEGQRC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQRC)
    Z_YDMF_PHYS_OUT_FCNEGQSC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQSC)
    Z_YDMF_PHYS_OUT_FCQGNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQGNG)
    Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
    Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
    Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FEDQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQIC)
    Z_YDMF_PHYS_OUT_FEDQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQLC)
    Z_YDMF_PHYS_OUT_FEDQRC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQRC)
    Z_YDMF_PHYS_OUT_FEDQSC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQSC)
    Z_YDMF_PHYS_OUT_FEPFP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEPFP)
    Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FHPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCG)
    Z_YDMF_PHYS_OUT_FHPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCL)
    Z_YDMF_PHYS_OUT_FHPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCN)
    Z_YDMF_PHYS_OUT_FHPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSG)
    Z_YDMF_PHYS_OUT_FHPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSL)
    Z_YDMF_PHYS_OUT_FHPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSN)
    Z_YDMF_PHYS_OUT_FHSCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCL)
    Z_YDMF_PHYS_OUT_FHSCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCN)
    Z_YDMF_PHYS_OUT_FHSSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSG)
    Z_YDMF_PHYS_OUT_FHSSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSL)
    Z_YDMF_PHYS_OUT_FHSSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSN)
    Z_YDMF_PHYS_OUT_FIMCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FIMCC)
    Z_YDMF_PHYS_OUT_FPEVPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCG)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPEVPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSG)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPFPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSG)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCG)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSG)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    Z_YDMF_PHYS_OUT_TENDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDU)
    Z_YDMF_PHYS_OUT_TENDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDV)
    Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_ICONV_T0 => GET_HOST_DATA_RDWR (YDVARS%ICONV%FT0)
    Z_YDVARS_LCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%LCONV%FT0)
    Z_YDVARS_RCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT0)
    Z_YDVARS_SCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
    &:CPTEND_NEW:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PDIFEXT => NULL ()
  PDSA_CPS => NULL ()
  PFCHQ => NULL ()
  PMSC_FRMQ => NULL ()
  PPFL_FEFB1 => NULL ()
  PPFL_FEFB2 => NULL ()
  PPFL_FEFB3 => NULL ()
  PPFL_FTKE => NULL ()
  PPFL_FTKEI => NULL ()
  ZMSC_FHP => NULL ()
  ZPFL_FP => NULL ()
  ZTENDD => NULL ()
  ZTENDEFB1 => NULL ()
  ZTENDEFB2 => NULL ()
  ZTENDEFB3 => NULL ()
  ZTENDEXT => NULL ()
  ZTENDG => NULL ()
  ZTENDH => NULL ()
  ZTENDI => NULL ()
  ZTENDICONV => NULL ()
  ZTENDL => NULL ()
  ZTENDLCONV => NULL ()
  ZTENDQ => NULL ()
  ZTENDR => NULL ()
  ZTENDRCONV => NULL ()
  ZTENDS => NULL ()
  ZTENDSCONV => NULL ()
  ZTENDTKE => NULL ()
  ZTENDU => NULL ()
  ZTENDV => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_DYN0_CTY_PSDVBC => NULL ()
  Z_YDMF_PHYS_BASE_STATE_G => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_S => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_NEXT_STATE_SP_P => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQIC => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQLC => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FCMPCQ => NULL ()
  Z_YDMF_PHYS_OUT_FCMPSL => NULL ()
  Z_YDMF_PHYS_OUT_FCMPSN => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQIC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQLC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQRC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQSC => NULL ()
  Z_YDMF_PHYS_OUT_FCQGNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQLNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQRNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQSNG => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FEDQIC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQLC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQRC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQSC => NULL ()
  Z_YDMF_PHYS_OUT_FEPFP => NULL ()
  Z_YDMF_PHYS_OUT_FEVL => NULL ()
  Z_YDMF_PHYS_OUT_FEVN => NULL ()
  Z_YDMF_PHYS_OUT_FHPCG => NULL ()
  Z_YDMF_PHYS_OUT_FHPCL => NULL ()
  Z_YDMF_PHYS_OUT_FHPCN => NULL ()
  Z_YDMF_PHYS_OUT_FHPSG => NULL ()
  Z_YDMF_PHYS_OUT_FHPSL => NULL ()
  Z_YDMF_PHYS_OUT_FHPSN => NULL ()
  Z_YDMF_PHYS_OUT_FHSCL => NULL ()
  Z_YDMF_PHYS_OUT_FHSCN => NULL ()
  Z_YDMF_PHYS_OUT_FHSSG => NULL ()
  Z_YDMF_PHYS_OUT_FHSSL => NULL ()
  Z_YDMF_PHYS_OUT_FHSSN => NULL ()
  Z_YDMF_PHYS_OUT_FIMCC => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCG => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSG => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSG => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCG => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSG => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  Z_YDMF_PHYS_OUT_FRMH => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDMF_PHYS_OUT_STRDU => NULL ()
  Z_YDMF_PHYS_OUT_STRDV => NULL ()
  Z_YDMF_PHYS_OUT_STRMU => NULL ()
  Z_YDMF_PHYS_OUT_STRMV => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  Z_YDMF_PHYS_OUT_TENDU => NULL ()
  Z_YDMF_PHYS_OUT_TENDV => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
  Z_YDVARS_ICONV_T0 => NULL ()
  Z_YDVARS_LCONV_T0 => NULL ()
  Z_YDVARS_RCONV_T0 => NULL ()
  Z_YDVARS_SCONV_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PDIFEXT => GET_HOST_DATA_RDONLY (YD_PDIFEXT)
  PDSA_CPS => GET_HOST_DATA_RDONLY (YD_PDSA_CPS)
  PFCHQ => GET_HOST_DATA_RDONLY (YD_PFCHQ)
  PMSC_FRMQ => GET_HOST_DATA_RDONLY (YD_PMSC_FRMQ)
  PPFL_FEFB1 => GET_HOST_DATA_RDONLY (YD_PPFL_FEFB1)
  PPFL_FEFB2 => GET_HOST_DATA_RDONLY (YD_PPFL_FEFB2)
  PPFL_FEFB3 => GET_HOST_DATA_RDONLY (YD_PPFL_FEFB3)
  PPFL_FTKE => GET_HOST_DATA_RDONLY (YD_PPFL_FTKE)
  PPFL_FTKEI => GET_HOST_DATA_RDONLY (YD_PPFL_FTKEI)
  ZMSC_FHP => GET_HOST_DATA_RDWR (YL_ZMSC_FHP)
  ZPFL_FP => GET_HOST_DATA_RDWR (YL_ZPFL_FP)
  ZTENDD => GET_HOST_DATA_RDWR (YL_ZTENDD)
  ZTENDEFB1 => GET_HOST_DATA_RDWR (YL_ZTENDEFB1)
  ZTENDEFB2 => GET_HOST_DATA_RDWR (YL_ZTENDEFB2)
  ZTENDEFB3 => GET_HOST_DATA_RDWR (YL_ZTENDEFB3)
  ZTENDEXT => GET_HOST_DATA_RDWR (YL_ZTENDEXT)
  ZTENDG => GET_HOST_DATA_RDWR (YL_ZTENDG)
  ZTENDH => GET_HOST_DATA_RDWR (YL_ZTENDH)
  ZTENDI => GET_HOST_DATA_RDWR (YL_ZTENDI)
  ZTENDICONV => GET_HOST_DATA_RDWR (YL_ZTENDICONV)
  ZTENDL => GET_HOST_DATA_RDWR (YL_ZTENDL)
  ZTENDLCONV => GET_HOST_DATA_RDWR (YL_ZTENDLCONV)
  ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
  ZTENDR => GET_HOST_DATA_RDWR (YL_ZTENDR)
  ZTENDRCONV => GET_HOST_DATA_RDWR (YL_ZTENDRCONV)
  ZTENDS => GET_HOST_DATA_RDWR (YL_ZTENDS)
  ZTENDSCONV => GET_HOST_DATA_RDWR (YL_ZTENDSCONV)
  ZTENDTKE => GET_HOST_DATA_RDWR (YL_ZTENDTKE)
  ZTENDU => GET_HOST_DATA_RDWR (YL_ZTENDU)
  ZTENDV => GET_HOST_DATA_RDWR (YL_ZTENDV)
  Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
  Z_YDMF_PHYS_BASE_STATE_G => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_G)
  Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_R)
  Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_S)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_NEXT_STATE_SP_P => GET_HOST_DATA_RDWR (YDMF_PHYS_NEXT_STATE%SP%F_P)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCQIC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQIC)
  Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQL)
  Z_YDMF_PHYS_OUT_DIFCQLC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQLC)
  Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQN)
  Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FCMPCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPCQ)
  Z_YDMF_PHYS_OUT_FCMPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSL)
  Z_YDMF_PHYS_OUT_FCMPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSN)
  Z_YDMF_PHYS_OUT_FCNEGQIC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQIC)
  Z_YDMF_PHYS_OUT_FCNEGQLC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQLC)
  Z_YDMF_PHYS_OUT_FCNEGQRC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQRC)
  Z_YDMF_PHYS_OUT_FCNEGQSC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQSC)
  Z_YDMF_PHYS_OUT_FCQGNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQGNG)
  Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQLNG)
  Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQNNG)
  Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQRNG)
  Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQSNG)
  Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FEDQIC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQIC)
  Z_YDMF_PHYS_OUT_FEDQLC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQLC)
  Z_YDMF_PHYS_OUT_FEDQRC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQRC)
  Z_YDMF_PHYS_OUT_FEDQSC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQSC)
  Z_YDMF_PHYS_OUT_FEPFP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEPFP)
  Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVL)
  Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVN)
  Z_YDMF_PHYS_OUT_FHPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCG)
  Z_YDMF_PHYS_OUT_FHPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCL)
  Z_YDMF_PHYS_OUT_FHPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCN)
  Z_YDMF_PHYS_OUT_FHPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSG)
  Z_YDMF_PHYS_OUT_FHPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSL)
  Z_YDMF_PHYS_OUT_FHPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSN)
  Z_YDMF_PHYS_OUT_FHSCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCL)
  Z_YDMF_PHYS_OUT_FHSCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCN)
  Z_YDMF_PHYS_OUT_FHSSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSG)
  Z_YDMF_PHYS_OUT_FHSSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSL)
  Z_YDMF_PHYS_OUT_FHSSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSN)
  Z_YDMF_PHYS_OUT_FIMCC => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FIMCC)
  Z_YDMF_PHYS_OUT_FPEVPCG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCG)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPEVPSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSG)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPFPSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSG)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLCG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCG)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSG)
  Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
  Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRMH)
  Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCV)
  Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRDU)
  Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRDV)
  Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRMU)
  Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRMV)
  Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRTV)
  Z_YDMF_PHYS_OUT_TENDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDU)
  Z_YDMF_PHYS_OUT_TENDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDV)
  Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  Z_YDVARS_ICONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%ICONV%FT0)
  Z_YDVARS_LCONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%LCONV%FT0)
  Z_YDVARS_RCONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%RCONV%FT0)
  Z_YDVARS_SCONV_T0 => GET_HOST_DATA_RDONLY (YDVARS%SCONV%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      ZTENDEFB1(JLON,:, JBLK)=0._JPRB
      ZTENDEFB2(JLON,:, JBLK)=0._JPRB
      ZTENDEFB3(JLON,:, JBLK)=0._JPRB
      ZTENDG(JLON,:, JBLK)=0._JPRB
      ZTENDI(JLON,:, JBLK)=0._JPRB
      ZTENDQ(JLON,:, JBLK)=0._JPRB
      ZTENDR(JLON,:, JBLK)=0._JPRB
      ZTENDS(JLON,:, JBLK)=0._JPRB
      ZTENDL(JLON,:, JBLK)=0._JPRB
      ZTENDICONV(JLON,:, JBLK)=0._JPRB
      ZTENDLCONV(JLON,:, JBLK)=0._JPRB
      ZTENDRCONV(JLON,:, JBLK)=0._JPRB
      ZTENDSCONV(JLON,:, JBLK)=0._JPRB
      ZTENDTKE(JLON,:, JBLK)=0._JPRB
      ZTENDD(JLON,:, JBLK)=0.0_JPRB
      CALL CPTEND_NEW_OPENACC (YDMODEL%YRCST, YDMODEL, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
      & YDCPG_OPTS%KFLEVG, Z_YDVARS_GEOMETRY_GNORDL_T0(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_T0(:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS&
      &(:,:, JBLK), PDIFEXT(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FCCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSG(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCG(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FPEVPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSG(:&
      &,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQLNG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQRNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQSNG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQGNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FRMH&
      &(:,:, JBLK), PMSC_FRMQ(:,:, JBLK), PFCHQ(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDV(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTV&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMV(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQLC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FIMCC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQLC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQRC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQSC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQLC(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQRC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQSC(:,:, JBLK), PPFL_FTKE(:,:, JBLK), PPFL_FTKEI(:,:, JBLK), PPFL_FEFB1&
      &(:,:, JBLK), PPFL_FEFB2(:,:, JBLK), PPFL_FEFB3(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(&
      &:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK),&
      & Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(&
      &:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_I(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_L(:,:, JBLK), Z_YDVARS_LCONV_T0&
      &(:,:, JBLK), Z_YDVARS_ICONV_T0(:,:, JBLK), Z_YDVARS_RCONV_T0(:,:, JBLK), Z_YDVARS_SCONV_T0(:,:, JBLK&
      &), Z_YDMF_PHYS_BASE_STATE_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_S(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_G&
      &(:,:, JBLK), PDSA_CPS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_OUT_FHSCL(:,:&
      &, JBLK), Z_YDMF_PHYS_OUT_FHSCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FHSSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHSSN(:&
      &,:, JBLK), Z_YDMF_PHYS_OUT_FHSSG(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCG(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSG(:,:, JBLK), ZMSC_FHP(:,:, JBLK), ZPFL_FP(:,:, JBLK), Z_YDMF_PHYS_OUT_FEPFP&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPSL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_TENDU(:,:, JBLK), Z_YDMF_PHYS_OUT_TENDV(:,:, JBLK), ZTENDU(:,:, JBLK), ZTENDV&
      &(:,:, JBLK), ZTENDH(:,:, JBLK), ZTENDQ(:,:, JBLK), ZTENDI(:,:, JBLK), ZTENDL(:,:, JBLK), ZTENDLCONV(&
      &:,:, JBLK), ZTENDICONV(:,:, JBLK), ZTENDRCONV(:,:, JBLK), ZTENDSCONV(:,:, JBLK), ZTENDR(:,:, JBLK), ZTENDS&
      &(:,:, JBLK), ZTENDG(:,:, JBLK), ZTENDTKE(:,:, JBLK), ZTENDEFB1(:,:, JBLK), ZTENDEFB2(:,:, JBLK), ZTENDEFB3&
      &(:,:, JBLK), ZTENDEXT(:,:,:, JBLK), YDDDH,YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_DYN%YRDYNA%LTWOTL) THEN
      ELSE

        IF ((YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI==1)) THEN

          DO JLEV=0, YDCPG_OPTS%KFLEVG
            
            Z_YDMF_PHYS_OUT_FEPFP (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPCQ (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPSN (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPSL (JLON, JLEV, JBLK)=0.0_JPRB
          
          ENDDO

        ENDIF

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI==1) THEN
        CALL CPMVVPS_OPENACC (YDMODEL%YRCST, YDGEOMETRY%YRVERT_GEOM%YRVAB, YDCPG_OPTS%KLON, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%ZDTPHY, ZPFL_FP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        & (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_FEVL (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVN (:&
        &, 1, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), Z_YDCPG_DYN0_CTY_PSDVBC(:,:, JBLK), Z_YDMF_PHYS_NEXT_STATE_SP_P&
        &(:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL:CPTEND_NEW')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
    &:CPTEND_NEW:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
    PDSA_CPS => GET_HOST_DATA_RDWR (YD_PDSA_CPS)
    PFCHQ => GET_HOST_DATA_RDWR (YD_PFCHQ)
    PMSC_FRMQ => GET_HOST_DATA_RDWR (YD_PMSC_FRMQ)
    PPFL_FEFB1 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB1)
    PPFL_FEFB2 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB2)
    PPFL_FEFB3 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB3)
    PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
    PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
    ZMSC_FHP => GET_HOST_DATA_RDWR (YL_ZMSC_FHP)
    ZPFL_FP => GET_HOST_DATA_RDWR (YL_ZPFL_FP)
    ZTENDD => GET_HOST_DATA_RDWR (YL_ZTENDD)
    ZTENDEFB1 => GET_HOST_DATA_RDWR (YL_ZTENDEFB1)
    ZTENDEFB2 => GET_HOST_DATA_RDWR (YL_ZTENDEFB2)
    ZTENDEFB3 => GET_HOST_DATA_RDWR (YL_ZTENDEFB3)
    ZTENDEXT => GET_HOST_DATA_RDWR (YL_ZTENDEXT)
    ZTENDG => GET_HOST_DATA_RDWR (YL_ZTENDG)
    ZTENDH => GET_HOST_DATA_RDWR (YL_ZTENDH)
    ZTENDI => GET_HOST_DATA_RDWR (YL_ZTENDI)
    ZTENDICONV => GET_HOST_DATA_RDWR (YL_ZTENDICONV)
    ZTENDL => GET_HOST_DATA_RDWR (YL_ZTENDL)
    ZTENDLCONV => GET_HOST_DATA_RDWR (YL_ZTENDLCONV)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDR => GET_HOST_DATA_RDWR (YL_ZTENDR)
    ZTENDRCONV => GET_HOST_DATA_RDWR (YL_ZTENDRCONV)
    ZTENDS => GET_HOST_DATA_RDWR (YL_ZTENDS)
    ZTENDSCONV => GET_HOST_DATA_RDWR (YL_ZTENDSCONV)
    ZTENDTKE => GET_HOST_DATA_RDWR (YL_ZTENDTKE)
    ZTENDU => GET_HOST_DATA_RDWR (YL_ZTENDU)
    ZTENDV => GET_HOST_DATA_RDWR (YL_ZTENDV)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
    Z_YDMF_PHYS_BASE_STATE_G => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_G)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_R)
    Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_S)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_NEXT_STATE_SP_P => GET_HOST_DATA_RDWR (YDMF_PHYS_NEXT_STATE%SP%F_P)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQIC)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_DIFCQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQLC)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCMPCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPCQ)
    Z_YDMF_PHYS_OUT_FCMPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSL)
    Z_YDMF_PHYS_OUT_FCMPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSN)
    Z_YDMF_PHYS_OUT_FCNEGQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQIC)
    Z_YDMF_PHYS_OUT_FCNEGQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQLC)
    Z_YDMF_PHYS_OUT_FCNEGQRC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQRC)
    Z_YDMF_PHYS_OUT_FCNEGQSC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQSC)
    Z_YDMF_PHYS_OUT_FCQGNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQGNG)
    Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
    Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
    Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FEDQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQIC)
    Z_YDMF_PHYS_OUT_FEDQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQLC)
    Z_YDMF_PHYS_OUT_FEDQRC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQRC)
    Z_YDMF_PHYS_OUT_FEDQSC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQSC)
    Z_YDMF_PHYS_OUT_FEPFP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEPFP)
    Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FHPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCG)
    Z_YDMF_PHYS_OUT_FHPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCL)
    Z_YDMF_PHYS_OUT_FHPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCN)
    Z_YDMF_PHYS_OUT_FHPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSG)
    Z_YDMF_PHYS_OUT_FHPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSL)
    Z_YDMF_PHYS_OUT_FHPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSN)
    Z_YDMF_PHYS_OUT_FHSCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCL)
    Z_YDMF_PHYS_OUT_FHSCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCN)
    Z_YDMF_PHYS_OUT_FHSSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSG)
    Z_YDMF_PHYS_OUT_FHSSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSL)
    Z_YDMF_PHYS_OUT_FHSSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSN)
    Z_YDMF_PHYS_OUT_FIMCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FIMCC)
    Z_YDMF_PHYS_OUT_FPEVPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCG)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPEVPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSG)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPFPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSG)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCG)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSG)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    Z_YDMF_PHYS_OUT_TENDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDU)
    Z_YDMF_PHYS_OUT_TENDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDV)
    Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_ICONV_T0 => GET_HOST_DATA_RDWR (YDVARS%ICONV%FT0)
    Z_YDVARS_LCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%LCONV%FT0)
    Z_YDVARS_RCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT0)
    Z_YDVARS_SCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
    &:CPTEND_NEW:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PDIFEXT => NULL ()
  PDSA_CPS => NULL ()
  PFCHQ => NULL ()
  PMSC_FRMQ => NULL ()
  PPFL_FEFB1 => NULL ()
  PPFL_FEFB2 => NULL ()
  PPFL_FEFB3 => NULL ()
  PPFL_FTKE => NULL ()
  PPFL_FTKEI => NULL ()
  ZMSC_FHP => NULL ()
  ZPFL_FP => NULL ()
  ZTENDD => NULL ()
  ZTENDEFB1 => NULL ()
  ZTENDEFB2 => NULL ()
  ZTENDEFB3 => NULL ()
  ZTENDEXT => NULL ()
  ZTENDG => NULL ()
  ZTENDH => NULL ()
  ZTENDI => NULL ()
  ZTENDICONV => NULL ()
  ZTENDL => NULL ()
  ZTENDLCONV => NULL ()
  ZTENDQ => NULL ()
  ZTENDR => NULL ()
  ZTENDRCONV => NULL ()
  ZTENDS => NULL ()
  ZTENDSCONV => NULL ()
  ZTENDTKE => NULL ()
  ZTENDU => NULL ()
  ZTENDV => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_DYN0_CTY_PSDVBC => NULL ()
  Z_YDMF_PHYS_BASE_STATE_G => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_S => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_NEXT_STATE_SP_P => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQIC => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQLC => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FCMPCQ => NULL ()
  Z_YDMF_PHYS_OUT_FCMPSL => NULL ()
  Z_YDMF_PHYS_OUT_FCMPSN => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQIC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQLC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQRC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQSC => NULL ()
  Z_YDMF_PHYS_OUT_FCQGNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQLNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQRNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQSNG => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FEDQIC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQLC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQRC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQSC => NULL ()
  Z_YDMF_PHYS_OUT_FEPFP => NULL ()
  Z_YDMF_PHYS_OUT_FEVL => NULL ()
  Z_YDMF_PHYS_OUT_FEVN => NULL ()
  Z_YDMF_PHYS_OUT_FHPCG => NULL ()
  Z_YDMF_PHYS_OUT_FHPCL => NULL ()
  Z_YDMF_PHYS_OUT_FHPCN => NULL ()
  Z_YDMF_PHYS_OUT_FHPSG => NULL ()
  Z_YDMF_PHYS_OUT_FHPSL => NULL ()
  Z_YDMF_PHYS_OUT_FHPSN => NULL ()
  Z_YDMF_PHYS_OUT_FHSCL => NULL ()
  Z_YDMF_PHYS_OUT_FHSCN => NULL ()
  Z_YDMF_PHYS_OUT_FHSSG => NULL ()
  Z_YDMF_PHYS_OUT_FHSSL => NULL ()
  Z_YDMF_PHYS_OUT_FHSSN => NULL ()
  Z_YDMF_PHYS_OUT_FIMCC => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCG => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSG => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSG => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCG => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSG => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  Z_YDMF_PHYS_OUT_FRMH => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDMF_PHYS_OUT_STRDU => NULL ()
  Z_YDMF_PHYS_OUT_STRDV => NULL ()
  Z_YDMF_PHYS_OUT_STRMU => NULL ()
  Z_YDMF_PHYS_OUT_STRMV => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  Z_YDMF_PHYS_OUT_TENDU => NULL ()
  Z_YDMF_PHYS_OUT_TENDV => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
  Z_YDVARS_ICONV_T0 => NULL ()
  Z_YDVARS_LCONV_T0 => NULL ()
  Z_YDVARS_RCONV_T0 => NULL ()
  Z_YDVARS_SCONV_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PDIFEXT => GET_DEVICE_DATA_RDONLY (YD_PDIFEXT)
  PDSA_CPS => GET_DEVICE_DATA_RDONLY (YD_PDSA_CPS)
  PFCHQ => GET_DEVICE_DATA_RDONLY (YD_PFCHQ)
  PMSC_FRMQ => GET_DEVICE_DATA_RDONLY (YD_PMSC_FRMQ)
  PPFL_FEFB1 => GET_DEVICE_DATA_RDONLY (YD_PPFL_FEFB1)
  PPFL_FEFB2 => GET_DEVICE_DATA_RDONLY (YD_PPFL_FEFB2)
  PPFL_FEFB3 => GET_DEVICE_DATA_RDONLY (YD_PPFL_FEFB3)
  PPFL_FTKE => GET_DEVICE_DATA_RDONLY (YD_PPFL_FTKE)
  PPFL_FTKEI => GET_DEVICE_DATA_RDONLY (YD_PPFL_FTKEI)
  ZMSC_FHP => GET_DEVICE_DATA_RDWR (YL_ZMSC_FHP)
  ZPFL_FP => GET_DEVICE_DATA_RDWR (YL_ZPFL_FP)
  ZTENDD => GET_DEVICE_DATA_RDWR (YL_ZTENDD)
  ZTENDEFB1 => GET_DEVICE_DATA_RDWR (YL_ZTENDEFB1)
  ZTENDEFB2 => GET_DEVICE_DATA_RDWR (YL_ZTENDEFB2)
  ZTENDEFB3 => GET_DEVICE_DATA_RDWR (YL_ZTENDEFB3)
  ZTENDEXT => GET_DEVICE_DATA_RDWR (YL_ZTENDEXT)
  ZTENDG => GET_DEVICE_DATA_RDWR (YL_ZTENDG)
  ZTENDH => GET_DEVICE_DATA_RDWR (YL_ZTENDH)
  ZTENDI => GET_DEVICE_DATA_RDWR (YL_ZTENDI)
  ZTENDICONV => GET_DEVICE_DATA_RDWR (YL_ZTENDICONV)
  ZTENDL => GET_DEVICE_DATA_RDWR (YL_ZTENDL)
  ZTENDLCONV => GET_DEVICE_DATA_RDWR (YL_ZTENDLCONV)
  ZTENDQ => GET_DEVICE_DATA_RDWR (YL_ZTENDQ)
  ZTENDR => GET_DEVICE_DATA_RDWR (YL_ZTENDR)
  ZTENDRCONV => GET_DEVICE_DATA_RDWR (YL_ZTENDRCONV)
  ZTENDS => GET_DEVICE_DATA_RDWR (YL_ZTENDS)
  ZTENDSCONV => GET_DEVICE_DATA_RDWR (YL_ZTENDSCONV)
  ZTENDTKE => GET_DEVICE_DATA_RDWR (YL_ZTENDTKE)
  ZTENDU => GET_DEVICE_DATA_RDWR (YL_ZTENDU)
  ZTENDV => GET_DEVICE_DATA_RDWR (YL_ZTENDV)
  Z_YDCPG_DYN0_CTY_EVEL => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_DYN0_CTY_PSDVBC => GET_DEVICE_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
  Z_YDMF_PHYS_BASE_STATE_G => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_G)
  Z_YDMF_PHYS_BASE_STATE_I => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_R => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_R)
  Z_YDMF_PHYS_BASE_STATE_S => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_S)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_NEXT_STATE_SP_P => GET_DEVICE_DATA_RDWR (YDMF_PHYS_NEXT_STATE%SP%F_P)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCQIC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQIC)
  Z_YDMF_PHYS_OUT_DIFCQL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQL)
  Z_YDMF_PHYS_OUT_DIFCQLC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQLC)
  Z_YDMF_PHYS_OUT_DIFCQN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQN)
  Z_YDMF_PHYS_OUT_DIFCS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_FCCQL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FCMPCQ => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPCQ)
  Z_YDMF_PHYS_OUT_FCMPSL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSL)
  Z_YDMF_PHYS_OUT_FCMPSN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSN)
  Z_YDMF_PHYS_OUT_FCNEGQIC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQIC)
  Z_YDMF_PHYS_OUT_FCNEGQLC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQLC)
  Z_YDMF_PHYS_OUT_FCNEGQRC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQRC)
  Z_YDMF_PHYS_OUT_FCNEGQSC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCNEGQSC)
  Z_YDMF_PHYS_OUT_FCQGNG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQGNG)
  Z_YDMF_PHYS_OUT_FCQLNG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQLNG)
  Z_YDMF_PHYS_OUT_FCQNG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCQNNG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQNNG)
  Z_YDMF_PHYS_OUT_FCQRNG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQRNG)
  Z_YDMF_PHYS_OUT_FCQSNG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCQSNG)
  Z_YDMF_PHYS_OUT_FCSQL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FEDQIC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQIC)
  Z_YDMF_PHYS_OUT_FEDQLC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQLC)
  Z_YDMF_PHYS_OUT_FEDQRC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQRC)
  Z_YDMF_PHYS_OUT_FEDQSC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FEDQSC)
  Z_YDMF_PHYS_OUT_FEPFP => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FEPFP)
  Z_YDMF_PHYS_OUT_FEVL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVL)
  Z_YDMF_PHYS_OUT_FEVN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVN)
  Z_YDMF_PHYS_OUT_FHPCG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCG)
  Z_YDMF_PHYS_OUT_FHPCL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCL)
  Z_YDMF_PHYS_OUT_FHPCN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCN)
  Z_YDMF_PHYS_OUT_FHPSG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSG)
  Z_YDMF_PHYS_OUT_FHPSL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSL)
  Z_YDMF_PHYS_OUT_FHPSN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSN)
  Z_YDMF_PHYS_OUT_FHSCL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCL)
  Z_YDMF_PHYS_OUT_FHSCN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCN)
  Z_YDMF_PHYS_OUT_FHSSG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSG)
  Z_YDMF_PHYS_OUT_FHSSL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSL)
  Z_YDMF_PHYS_OUT_FHSSN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSN)
  Z_YDMF_PHYS_OUT_FIMCC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FIMCC)
  Z_YDMF_PHYS_OUT_FPEVPCG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCG)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPEVPSG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSG)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPFPSG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSG)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLCG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCG)
  Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  Z_YDMF_PHYS_OUT_FPLSG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSG)
  Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
  Z_YDMF_PHYS_OUT_FRMH => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRMH)
  Z_YDMF_PHYS_OUT_FRSO => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRSO)
  Z_YDMF_PHYS_OUT_FRTH => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  Z_YDMF_PHYS_OUT_STRCU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCU)
  Z_YDMF_PHYS_OUT_STRCV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCV)
  Z_YDMF_PHYS_OUT_STRDU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRDU)
  Z_YDMF_PHYS_OUT_STRDV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRDV)
  Z_YDMF_PHYS_OUT_STRMU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRMU)
  Z_YDMF_PHYS_OUT_STRMV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRMV)
  Z_YDMF_PHYS_OUT_STRTU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRTV)
  Z_YDMF_PHYS_OUT_TENDU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_TENDU)
  Z_YDMF_PHYS_OUT_TENDV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_TENDV)
  Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDL%FT0)
  Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GNORDM%FT0)
  Z_YDVARS_ICONV_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%ICONV%FT0)
  Z_YDVARS_LCONV_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%LCONV%FT0)
  Z_YDVARS_RCONV_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%RCONV%FT0)
  Z_YDVARS_SCONV_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%SCONV%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PDIFEXT, PDSA_CPS, PFCHQ, PMSC_FRMQ, PPFL_FEFB1, PPFL_FEFB2, PPFL_FEFB3, &
    !$ACC&         PPFL_FTKE, PPFL_FTKEI, YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZMSC_FHP, ZPFL_FP, ZTENDD, ZTENDEFB1, ZTENDEFB2, ZTENDEFB3, ZTENDEXT, &
    !$ACC&         ZTENDG, ZTENDH, ZTENDI, ZTENDICONV, ZTENDL, ZTENDLCONV, ZTENDQ, ZTENDR, &
    !$ACC&         ZTENDRCONV, ZTENDS, ZTENDSCONV, ZTENDTKE, ZTENDU, ZTENDV, Z_YDCPG_DYN0_CTY_EVEL, &
    !$ACC&         Z_YDCPG_DYN0_CTY_PSDVBC, Z_YDMF_PHYS_BASE_STATE_G, Z_YDMF_PHYS_BASE_STATE_I, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_L, Z_YDMF_PHYS_BASE_STATE_Q, Z_YDMF_PHYS_BASE_STATE_R, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_S, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_NEXT_STATE_SP_P, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFCQ, Z_YDMF_PHYS_OUT_DIFCQIC, Z_YDMF_PHYS_OUT_DIFCQL, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFCQLC, Z_YDMF_PHYS_OUT_DIFCQN, Z_YDMF_PHYS_OUT_DIFCS, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFTQ, Z_YDMF_PHYS_OUT_DIFTQL, Z_YDMF_PHYS_OUT_DIFTQN, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFTS, Z_YDMF_PHYS_OUT_FCCQL, Z_YDMF_PHYS_OUT_FCCQN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCMPCQ, Z_YDMF_PHYS_OUT_FCMPSL, Z_YDMF_PHYS_OUT_FCMPSN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCNEGQIC, Z_YDMF_PHYS_OUT_FCNEGQLC, Z_YDMF_PHYS_OUT_FCNEGQRC, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCNEGQSC, Z_YDMF_PHYS_OUT_FCQGNG, Z_YDMF_PHYS_OUT_FCQLNG, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCQNG, Z_YDMF_PHYS_OUT_FCQNNG, Z_YDMF_PHYS_OUT_FCQRNG, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCQSNG, Z_YDMF_PHYS_OUT_FCSQL, Z_YDMF_PHYS_OUT_FCSQN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FEDQIC, Z_YDMF_PHYS_OUT_FEDQLC, Z_YDMF_PHYS_OUT_FEDQRC, &
    !$ACC&         Z_YDMF_PHYS_OUT_FEDQSC, Z_YDMF_PHYS_OUT_FEPFP, Z_YDMF_PHYS_OUT_FEVL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FEVN, Z_YDMF_PHYS_OUT_FHPCG, Z_YDMF_PHYS_OUT_FHPCL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FHPCN, Z_YDMF_PHYS_OUT_FHPSG, Z_YDMF_PHYS_OUT_FHPSL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FHPSN, Z_YDMF_PHYS_OUT_FHSCL, Z_YDMF_PHYS_OUT_FHSCN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FHSSG, Z_YDMF_PHYS_OUT_FHSSL, Z_YDMF_PHYS_OUT_FHSSN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FIMCC, Z_YDMF_PHYS_OUT_FPEVPCG, Z_YDMF_PHYS_OUT_FPEVPCL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPEVPCN, Z_YDMF_PHYS_OUT_FPEVPSG, Z_YDMF_PHYS_OUT_FPEVPSL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPEVPSN, Z_YDMF_PHYS_OUT_FPFPCL, Z_YDMF_PHYS_OUT_FPFPCN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPFPSG, Z_YDMF_PHYS_OUT_FPFPSL, Z_YDMF_PHYS_OUT_FPFPSN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPLCG, Z_YDMF_PHYS_OUT_FPLCL, Z_YDMF_PHYS_OUT_FPLCN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPLSG, Z_YDMF_PHYS_OUT_FPLSL, Z_YDMF_PHYS_OUT_FPLSN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FRMH, Z_YDMF_PHYS_OUT_FRSO, Z_YDMF_PHYS_OUT_FRTH, &
    !$ACC&         Z_YDMF_PHYS_OUT_STRCU, Z_YDMF_PHYS_OUT_STRCV, Z_YDMF_PHYS_OUT_STRDU, &
    !$ACC&         Z_YDMF_PHYS_OUT_STRDV, Z_YDMF_PHYS_OUT_STRMU, Z_YDMF_PHYS_OUT_STRMV, &
    !$ACC&         Z_YDMF_PHYS_OUT_STRTU, Z_YDMF_PHYS_OUT_STRTV, Z_YDMF_PHYS_OUT_TENDU, &
    !$ACC&         Z_YDMF_PHYS_OUT_TENDV, Z_YDVARS_GEOMETRY_GNORDL_T0, Z_YDVARS_GEOMETRY_GNORDM_T0, &
    !$ACC&         Z_YDVARS_ICONV_T0, Z_YDVARS_LCONV_T0, Z_YDVARS_RCONV_T0, &
    !$ACC&         Z_YDVARS_SCONV_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      ZTENDEFB1(JLON,:, JBLK)=0._JPRB
      ZTENDEFB2(JLON,:, JBLK)=0._JPRB
      ZTENDEFB3(JLON,:, JBLK)=0._JPRB
      ZTENDG(JLON,:, JBLK)=0._JPRB
      ZTENDI(JLON,:, JBLK)=0._JPRB
      ZTENDQ(JLON,:, JBLK)=0._JPRB
      ZTENDR(JLON,:, JBLK)=0._JPRB
      ZTENDS(JLON,:, JBLK)=0._JPRB
      ZTENDL(JLON,:, JBLK)=0._JPRB
      ZTENDICONV(JLON,:, JBLK)=0._JPRB
      ZTENDLCONV(JLON,:, JBLK)=0._JPRB
      ZTENDRCONV(JLON,:, JBLK)=0._JPRB
      ZTENDSCONV(JLON,:, JBLK)=0._JPRB
      ZTENDTKE(JLON,:, JBLK)=0._JPRB
      ZTENDD(JLON,:, JBLK)=0.0_JPRB
      CALL CPTEND_NEW_OPENACC (YDMODEL%YRCST, YDMODEL, YDCPG_OPTS%KLON, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
      & YDCPG_OPTS%KFLEVG, Z_YDVARS_GEOMETRY_GNORDL_T0(:, JBLK), Z_YDVARS_GEOMETRY_GNORDM_T0(:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS&
      &(:,:, JBLK), PDIFEXT(:,:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTS(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FCCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSG(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCG(:,:, JBLK&
      &), Z_YDMF_PHYS_OUT_FPEVPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSG(:&
      &,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQLNG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQRNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQSNG&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQGNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNG(:,:, JBLK), Z_YDMF_PHYS_OUT_FRMH&
      &(:,:, JBLK), PMSC_FRMQ(:,:, JBLK), PFCHQ(:,:, JBLK), Z_YDMF_PHYS_OUT_FRSO(:,:,:, JBLK), Z_YDMF_PHYS_OUT_FRTH&
      &(:,:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDV(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRTV&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMV(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQLC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FIMCC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQLC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQRC(:,:, JBLK), Z_YDMF_PHYS_OUT_FEDQSC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQLC(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQIC(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQRC&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCNEGQSC(:,:, JBLK), PPFL_FTKE(:,:, JBLK), PPFL_FTKEI(:,:, JBLK), PPFL_FEFB1&
      &(:,:, JBLK), PPFL_FEFB2(:,:, JBLK), PPFL_FEFB3(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(&
      &:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK),&
      & Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q(&
      &:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_I(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_L(:,:, JBLK), Z_YDVARS_LCONV_T0&
      &(:,:, JBLK), Z_YDVARS_ICONV_T0(:,:, JBLK), Z_YDVARS_RCONV_T0(:,:, JBLK), Z_YDVARS_SCONV_T0(:,:, JBLK&
      &), Z_YDMF_PHYS_BASE_STATE_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_S(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_G&
      &(:,:, JBLK), PDSA_CPS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_OUT_FHSCL(:,:&
      &, JBLK), Z_YDMF_PHYS_OUT_FHSCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FHSSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHSSN(:&
      &,:, JBLK), Z_YDMF_PHYS_OUT_FHSSG(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPCG(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FHPSG(:,:, JBLK), ZMSC_FHP(:,:, JBLK), ZPFL_FP(:,:, JBLK), Z_YDMF_PHYS_OUT_FEPFP&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPCQ(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCMPSL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_TENDU(:,:, JBLK), Z_YDMF_PHYS_OUT_TENDV(:,:, JBLK), ZTENDU(:,:, JBLK), ZTENDV&
      &(:,:, JBLK), ZTENDH(:,:, JBLK), ZTENDQ(:,:, JBLK), ZTENDI(:,:, JBLK), ZTENDL(:,:, JBLK), ZTENDLCONV(&
      &:,:, JBLK), ZTENDICONV(:,:, JBLK), ZTENDRCONV(:,:, JBLK), ZTENDSCONV(:,:, JBLK), ZTENDR(:,:, JBLK), ZTENDS&
      &(:,:, JBLK), ZTENDG(:,:, JBLK), ZTENDTKE(:,:, JBLK), ZTENDEFB1(:,:, JBLK), ZTENDEFB2(:,:, JBLK), ZTENDEFB3&
      &(:,:, JBLK), ZTENDEXT(:,:,:, JBLK), YDDDH,YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_DYN%YRDYNA%LTWOTL) THEN
      ELSE

        IF ((YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI==1)) THEN

          DO JLEV=0, YDCPG_OPTS%KFLEVG
            
            Z_YDMF_PHYS_OUT_FEPFP (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPCQ (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPSN (JLON, JLEV, JBLK)=0.0_JPRB
            Z_YDMF_PHYS_OUT_FCMPSL (JLON, JLEV, JBLK)=0.0_JPRB
          
          ENDDO

        ENDIF

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI==1) THEN
        CALL CPMVVPS_OPENACC (YDMODEL%YRCST, YDGEOMETRY%YRVERT_GEOM%YRVAB, YDCPG_OPTS%KLON, YLCPG_BNDS&
        &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%ZDTPHY, ZPFL_FP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        & (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_FEVL (:, 1, JBLK), Z_YDMF_PHYS_OUT_FEVN (:&
        &, 1, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), Z_YDCPG_DYN0_CTY_PSDVBC(:,:, JBLK), Z_YDMF_PHYS_NEXT_STATE_SP_P&
        &(:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL:CPTEND_NEW')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
    &:CPTEND_NEW:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PDIFEXT => GET_HOST_DATA_RDWR (YD_PDIFEXT)
    PDSA_CPS => GET_HOST_DATA_RDWR (YD_PDSA_CPS)
    PFCHQ => GET_HOST_DATA_RDWR (YD_PFCHQ)
    PMSC_FRMQ => GET_HOST_DATA_RDWR (YD_PMSC_FRMQ)
    PPFL_FEFB1 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB1)
    PPFL_FEFB2 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB2)
    PPFL_FEFB3 => GET_HOST_DATA_RDWR (YD_PPFL_FEFB3)
    PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
    PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
    ZMSC_FHP => GET_HOST_DATA_RDWR (YL_ZMSC_FHP)
    ZPFL_FP => GET_HOST_DATA_RDWR (YL_ZPFL_FP)
    ZTENDD => GET_HOST_DATA_RDWR (YL_ZTENDD)
    ZTENDEFB1 => GET_HOST_DATA_RDWR (YL_ZTENDEFB1)
    ZTENDEFB2 => GET_HOST_DATA_RDWR (YL_ZTENDEFB2)
    ZTENDEFB3 => GET_HOST_DATA_RDWR (YL_ZTENDEFB3)
    ZTENDEXT => GET_HOST_DATA_RDWR (YL_ZTENDEXT)
    ZTENDG => GET_HOST_DATA_RDWR (YL_ZTENDG)
    ZTENDH => GET_HOST_DATA_RDWR (YL_ZTENDH)
    ZTENDI => GET_HOST_DATA_RDWR (YL_ZTENDI)
    ZTENDICONV => GET_HOST_DATA_RDWR (YL_ZTENDICONV)
    ZTENDL => GET_HOST_DATA_RDWR (YL_ZTENDL)
    ZTENDLCONV => GET_HOST_DATA_RDWR (YL_ZTENDLCONV)
    ZTENDQ => GET_HOST_DATA_RDWR (YL_ZTENDQ)
    ZTENDR => GET_HOST_DATA_RDWR (YL_ZTENDR)
    ZTENDRCONV => GET_HOST_DATA_RDWR (YL_ZTENDRCONV)
    ZTENDS => GET_HOST_DATA_RDWR (YL_ZTENDS)
    ZTENDSCONV => GET_HOST_DATA_RDWR (YL_ZTENDSCONV)
    ZTENDTKE => GET_HOST_DATA_RDWR (YL_ZTENDTKE)
    ZTENDU => GET_HOST_DATA_RDWR (YL_ZTENDU)
    ZTENDV => GET_HOST_DATA_RDWR (YL_ZTENDV)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_DYN0_CTY_PSDVBC => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_PSDVBC)
    Z_YDMF_PHYS_BASE_STATE_G => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_G)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_R)
    Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_S)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_NEXT_STATE_SP_P => GET_HOST_DATA_RDWR (YDMF_PHYS_NEXT_STATE%SP%F_P)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQIC)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_DIFCQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQLC)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCMPCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPCQ)
    Z_YDMF_PHYS_OUT_FCMPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSL)
    Z_YDMF_PHYS_OUT_FCMPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCMPSN)
    Z_YDMF_PHYS_OUT_FCNEGQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQIC)
    Z_YDMF_PHYS_OUT_FCNEGQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQLC)
    Z_YDMF_PHYS_OUT_FCNEGQRC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQRC)
    Z_YDMF_PHYS_OUT_FCNEGQSC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCNEGQSC)
    Z_YDMF_PHYS_OUT_FCQGNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQGNG)
    Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
    Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
    Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FEDQIC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQIC)
    Z_YDMF_PHYS_OUT_FEDQLC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQLC)
    Z_YDMF_PHYS_OUT_FEDQRC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQRC)
    Z_YDMF_PHYS_OUT_FEDQSC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEDQSC)
    Z_YDMF_PHYS_OUT_FEPFP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEPFP)
    Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FHPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCG)
    Z_YDMF_PHYS_OUT_FHPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCL)
    Z_YDMF_PHYS_OUT_FHPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPCN)
    Z_YDMF_PHYS_OUT_FHPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSG)
    Z_YDMF_PHYS_OUT_FHPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSL)
    Z_YDMF_PHYS_OUT_FHPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHPSN)
    Z_YDMF_PHYS_OUT_FHSCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCL)
    Z_YDMF_PHYS_OUT_FHSCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSCN)
    Z_YDMF_PHYS_OUT_FHSSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSG)
    Z_YDMF_PHYS_OUT_FHSSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSL)
    Z_YDMF_PHYS_OUT_FHSSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FHSSN)
    Z_YDMF_PHYS_OUT_FIMCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FIMCC)
    Z_YDMF_PHYS_OUT_FPEVPCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCG)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPEVPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSG)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPFPSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSG)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLCG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCG)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSG)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
    Z_YDMF_PHYS_OUT_FRSO => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSO)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    Z_YDMF_PHYS_OUT_TENDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDU)
    Z_YDMF_PHYS_OUT_TENDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TENDV)
    Z_YDVARS_GEOMETRY_GNORDL_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDL%FT0)
    Z_YDVARS_GEOMETRY_GNORDM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GNORDM%FT0)
    Z_YDVARS_ICONV_T0 => GET_HOST_DATA_RDWR (YDVARS%ICONV%FT0)
    Z_YDVARS_LCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%LCONV%FT0)
    Z_YDVARS_RCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT0)
    Z_YDVARS_SCONV_T0 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
    &:CPTEND_NEW:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PDIFEXT => NULL ()
  PDSA_CPS => NULL ()
  PFCHQ => NULL ()
  PMSC_FRMQ => NULL ()
  PPFL_FEFB1 => NULL ()
  PPFL_FEFB2 => NULL ()
  PPFL_FEFB3 => NULL ()
  PPFL_FTKE => NULL ()
  PPFL_FTKEI => NULL ()
  ZMSC_FHP => NULL ()
  ZPFL_FP => NULL ()
  ZTENDD => NULL ()
  ZTENDEFB1 => NULL ()
  ZTENDEFB2 => NULL ()
  ZTENDEFB3 => NULL ()
  ZTENDEXT => NULL ()
  ZTENDG => NULL ()
  ZTENDH => NULL ()
  ZTENDI => NULL ()
  ZTENDICONV => NULL ()
  ZTENDL => NULL ()
  ZTENDLCONV => NULL ()
  ZTENDQ => NULL ()
  ZTENDR => NULL ()
  ZTENDRCONV => NULL ()
  ZTENDS => NULL ()
  ZTENDSCONV => NULL ()
  ZTENDTKE => NULL ()
  ZTENDU => NULL ()
  ZTENDV => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_DYN0_CTY_PSDVBC => NULL ()
  Z_YDMF_PHYS_BASE_STATE_G => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_S => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_NEXT_STATE_SP_P => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQIC => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQLC => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFCS => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FCMPCQ => NULL ()
  Z_YDMF_PHYS_OUT_FCMPSL => NULL ()
  Z_YDMF_PHYS_OUT_FCMPSN => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQIC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQLC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQRC => NULL ()
  Z_YDMF_PHYS_OUT_FCNEGQSC => NULL ()
  Z_YDMF_PHYS_OUT_FCQGNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQLNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQRNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQSNG => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FEDQIC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQLC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQRC => NULL ()
  Z_YDMF_PHYS_OUT_FEDQSC => NULL ()
  Z_YDMF_PHYS_OUT_FEPFP => NULL ()
  Z_YDMF_PHYS_OUT_FEVL => NULL ()
  Z_YDMF_PHYS_OUT_FEVN => NULL ()
  Z_YDMF_PHYS_OUT_FHPCG => NULL ()
  Z_YDMF_PHYS_OUT_FHPCL => NULL ()
  Z_YDMF_PHYS_OUT_FHPCN => NULL ()
  Z_YDMF_PHYS_OUT_FHPSG => NULL ()
  Z_YDMF_PHYS_OUT_FHPSL => NULL ()
  Z_YDMF_PHYS_OUT_FHPSN => NULL ()
  Z_YDMF_PHYS_OUT_FHSCL => NULL ()
  Z_YDMF_PHYS_OUT_FHSCN => NULL ()
  Z_YDMF_PHYS_OUT_FHSSG => NULL ()
  Z_YDMF_PHYS_OUT_FHSSL => NULL ()
  Z_YDMF_PHYS_OUT_FHSSN => NULL ()
  Z_YDMF_PHYS_OUT_FIMCC => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCG => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSG => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSG => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLCG => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSG => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  Z_YDMF_PHYS_OUT_FRMH => NULL ()
  Z_YDMF_PHYS_OUT_FRSO => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  Z_YDMF_PHYS_OUT_STRCU => NULL ()
  Z_YDMF_PHYS_OUT_STRCV => NULL ()
  Z_YDMF_PHYS_OUT_STRDU => NULL ()
  Z_YDMF_PHYS_OUT_STRDV => NULL ()
  Z_YDMF_PHYS_OUT_STRMU => NULL ()
  Z_YDMF_PHYS_OUT_STRMV => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  Z_YDMF_PHYS_OUT_TENDU => NULL ()
  Z_YDMF_PHYS_OUT_TENDV => NULL ()
  Z_YDVARS_GEOMETRY_GNORDL_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GNORDM_T0 => NULL ()
  Z_YDVARS_ICONV_T0 => NULL ()
  Z_YDVARS_LCONV_T0 => NULL ()
  Z_YDVARS_RCONV_T0 => NULL ()
  Z_YDVARS_SCONV_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL&
  &:CPTEND_NEW:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL:CPTEND_NEW',1,ZHOOK_HANDLE_PARALLEL)
CALL CPUTQY_APLPAR_EXPL_PARALLEL (YDMODEL%YRCST, YDCPG_BNDS, YDCPG_OPTS, YDMODEL%YRML_DYN%YRDYNA, YDMF_PHYS_NEXT_STATE&
&, YDMF_PHYS_BASE_STATE, YDVARS, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_OPTS%ZDTPHY, YL_ZTENDH, YDMF_PHYS&
&%OUT%F_TENDU, YDMF_PHYS%OUT%F_TENDV, YL_ZTENDU, YL_ZTENDV, YL_ZTENDD, YL_ZTENDEFB1, YL_ZTENDEFB2, YL_ZTENDEFB3&
&, YL_ZTENDG, YL_ZTENDICONV, YL_ZTENDI, YL_ZTENDLCONV, YL_ZTENDL, YL_ZTENDQ, YL_ZTENDRCONV, YL_ZTENDR&
&, YL_ZTENDSCONV, YL_ZTENDS, YL_ZTENDTKE, YDMF_PHYS%OUT%F_FDIS)


CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZMSC_FHP)) CALL FIELD_DELETE (YL_ZMSC_FHP)
IF (ASSOCIATED (YL_ZPFL_FP)) CALL FIELD_DELETE (YL_ZPFL_FP)
IF (ASSOCIATED (YL_ZTENDD)) CALL FIELD_DELETE (YL_ZTENDD)
IF (ASSOCIATED (YL_ZTENDEFB1)) CALL FIELD_DELETE (YL_ZTENDEFB1)
IF (ASSOCIATED (YL_ZTENDEFB2)) CALL FIELD_DELETE (YL_ZTENDEFB2)
IF (ASSOCIATED (YL_ZTENDEFB3)) CALL FIELD_DELETE (YL_ZTENDEFB3)
IF (ASSOCIATED (YL_ZTENDEXT)) CALL FIELD_DELETE (YL_ZTENDEXT)
IF (ASSOCIATED (YL_ZTENDG)) CALL FIELD_DELETE (YL_ZTENDG)
IF (ASSOCIATED (YL_ZTENDH)) CALL FIELD_DELETE (YL_ZTENDH)
IF (ASSOCIATED (YL_ZTENDI)) CALL FIELD_DELETE (YL_ZTENDI)
IF (ASSOCIATED (YL_ZTENDICONV)) CALL FIELD_DELETE (YL_ZTENDICONV)
IF (ASSOCIATED (YL_ZTENDL)) CALL FIELD_DELETE (YL_ZTENDL)
IF (ASSOCIATED (YL_ZTENDLCONV)) CALL FIELD_DELETE (YL_ZTENDLCONV)
IF (ASSOCIATED (YL_ZTENDQ)) CALL FIELD_DELETE (YL_ZTENDQ)
IF (ASSOCIATED (YL_ZTENDR)) CALL FIELD_DELETE (YL_ZTENDR)
IF (ASSOCIATED (YL_ZTENDRCONV)) CALL FIELD_DELETE (YL_ZTENDRCONV)
IF (ASSOCIATED (YL_ZTENDS)) CALL FIELD_DELETE (YL_ZTENDS)
IF (ASSOCIATED (YL_ZTENDSCONV)) CALL FIELD_DELETE (YL_ZTENDSCONV)
IF (ASSOCIATED (YL_ZTENDTKE)) CALL FIELD_DELETE (YL_ZTENDTKE)
IF (ASSOCIATED (YL_ZTENDU)) CALL FIELD_DELETE (YL_ZTENDU)
IF (ASSOCIATED (YL_ZTENDV)) CALL FIELD_DELETE (YL_ZTENDV)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL
