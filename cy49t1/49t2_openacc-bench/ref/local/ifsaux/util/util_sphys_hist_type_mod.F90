MODULE UTIL_SPHYS_HIST_TYPE_MOD

USE YOMSPHYHIST, ONLY : SPHYS_HIST_TYPE

INTERFACE SAVE
MODULE PROCEDURE SAVE_SPHYS_HIST_TYPE
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_SPHYS_HIST_TYPE
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_SPHYS_HIST_TYPE
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_SPHYS_HIST_TYPE
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_SPHYS_HIST_TYPE
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_SPHYS_HIST_TYPE
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_SPHYS_HIST_TYPE
END INTERFACE


CONTAINS

SUBROUTINE SAVE_SPHYS_HIST_TYPE (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (SPHYS_HIST_TYPE), INTENT (IN), TARGET :: YD
LOGICAL :: LRADLWM, LRADLWM5, LTGWDWMSU, LTGWDWMSU5, LTGWDWMSV, LTGWDWMSV5, LYA5, LYI5, LYL5
LYA5 = ASSOCIATED (YD%YA5)
WRITE (KLUN) LYA5
IF (LYA5) THEN
  WRITE (KLUN) LBOUND (YD%YA5)
  WRITE (KLUN) UBOUND (YD%YA5)
  WRITE (KLUN) YD%YA5
ENDIF
LYL5 = ASSOCIATED (YD%YL5)
WRITE (KLUN) LYL5
IF (LYL5) THEN
  WRITE (KLUN) LBOUND (YD%YL5)
  WRITE (KLUN) UBOUND (YD%YL5)
  WRITE (KLUN) YD%YL5
ENDIF
LYI5 = ASSOCIATED (YD%YI5)
WRITE (KLUN) LYI5
IF (LYI5) THEN
  WRITE (KLUN) LBOUND (YD%YI5)
  WRITE (KLUN) UBOUND (YD%YI5)
  WRITE (KLUN) YD%YI5
ENDIF
LRADLWM = ASSOCIATED (YD%RADLWM)
WRITE (KLUN) LRADLWM
IF (LRADLWM) THEN
  WRITE (KLUN) LBOUND (YD%RADLWM)
  WRITE (KLUN) UBOUND (YD%RADLWM)
  WRITE (KLUN) YD%RADLWM
ENDIF
LRADLWM5 = ASSOCIATED (YD%RADLWM5)
WRITE (KLUN) LRADLWM5
IF (LRADLWM5) THEN
  WRITE (KLUN) LBOUND (YD%RADLWM5)
  WRITE (KLUN) UBOUND (YD%RADLWM5)
  WRITE (KLUN) YD%RADLWM5
ENDIF
LTGWDWMSU = ASSOCIATED (YD%TGWDWMSU)
WRITE (KLUN) LTGWDWMSU
IF (LTGWDWMSU) THEN
  WRITE (KLUN) LBOUND (YD%TGWDWMSU)
  WRITE (KLUN) UBOUND (YD%TGWDWMSU)
  WRITE (KLUN) YD%TGWDWMSU
ENDIF
LTGWDWMSU5 = ASSOCIATED (YD%TGWDWMSU5)
WRITE (KLUN) LTGWDWMSU5
IF (LTGWDWMSU5) THEN
  WRITE (KLUN) LBOUND (YD%TGWDWMSU5)
  WRITE (KLUN) UBOUND (YD%TGWDWMSU5)
  WRITE (KLUN) YD%TGWDWMSU5
ENDIF
LTGWDWMSV = ASSOCIATED (YD%TGWDWMSV)
WRITE (KLUN) LTGWDWMSV
IF (LTGWDWMSV) THEN
  WRITE (KLUN) LBOUND (YD%TGWDWMSV)
  WRITE (KLUN) UBOUND (YD%TGWDWMSV)
  WRITE (KLUN) YD%TGWDWMSV
ENDIF
LTGWDWMSV5 = ASSOCIATED (YD%TGWDWMSV5)
WRITE (KLUN) LTGWDWMSV5
IF (LTGWDWMSV5) THEN
  WRITE (KLUN) LBOUND (YD%TGWDWMSV5)
  WRITE (KLUN) UBOUND (YD%TGWDWMSV5)
  WRITE (KLUN) YD%TGWDWMSV5
ENDIF
END SUBROUTINE

SUBROUTINE LOAD_SPHYS_HIST_TYPE (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (SPHYS_HIST_TYPE), INTENT (OUT), TARGET :: YD
INTEGER :: IL2(2), IU2(2)
LOGICAL :: LRADLWM, LRADLWM5, LTGWDWMSU, LTGWDWMSU5, LTGWDWMSV, LTGWDWMSV5, LYA5, LYI5, LYL5
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) LYA5
IF (LYA5) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%YA5 (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%YA5,1):UBOUND(YD%YA5,1), LBOUND(YD%YA5,2):UBOUND(YD%YA5,2)))
  READ (KLUN) ZTMP2
  YD%YA5 = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%YA5)
ENDIF
READ (KLUN) LYL5
IF (LYL5) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%YL5 (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%YL5,1):UBOUND(YD%YL5,1), LBOUND(YD%YL5,2):UBOUND(YD%YL5,2)))
  READ (KLUN) ZTMP2
  YD%YL5 = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%YL5)
ENDIF
READ (KLUN) LYI5
IF (LYI5) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%YI5 (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%YI5,1):UBOUND(YD%YI5,1), LBOUND(YD%YI5,2):UBOUND(YD%YI5,2)))
  READ (KLUN) ZTMP2
  YD%YI5 = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%YI5)
ENDIF
READ (KLUN) LRADLWM
IF (LRADLWM) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%RADLWM (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%RADLWM,1):UBOUND(YD%RADLWM,1), LBOUND(YD%RADLWM,2):UBOUND(YD%RADLWM,2)))
  READ (KLUN) ZTMP2
  YD%RADLWM = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%RADLWM)
ENDIF
READ (KLUN) LRADLWM5
IF (LRADLWM5) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%RADLWM5 (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%RADLWM5,1):UBOUND(YD%RADLWM5,1), LBOUND(YD%RADLWM5,2):UBOUND(YD%RADLWM5,2)))
  READ (KLUN) ZTMP2
  YD%RADLWM5 = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%RADLWM5)
ENDIF
READ (KLUN) LTGWDWMSU
IF (LTGWDWMSU) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%TGWDWMSU (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%TGWDWMSU,1):UBOUND(YD%TGWDWMSU,1), LBOUND(YD%TGWDWMSU,2):UBOUND(YD%TGWDWMSU,2)))
  READ (KLUN) ZTMP2
  YD%TGWDWMSU = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%TGWDWMSU)
ENDIF
READ (KLUN) LTGWDWMSU5
IF (LTGWDWMSU5) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%TGWDWMSU5 (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%TGWDWMSU5,1):UBOUND(YD%TGWDWMSU5,1), LBOUND(YD%TGWDWMSU5,2):UBOUND(YD%TGWDWMSU5,2)))
  READ (KLUN) ZTMP2
  YD%TGWDWMSU5 = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%TGWDWMSU5)
ENDIF
READ (KLUN) LTGWDWMSV
IF (LTGWDWMSV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%TGWDWMSV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%TGWDWMSV,1):UBOUND(YD%TGWDWMSV,1), LBOUND(YD%TGWDWMSV,2):UBOUND(YD%TGWDWMSV,2)))
  READ (KLUN) ZTMP2
  YD%TGWDWMSV = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%TGWDWMSV)
ENDIF
READ (KLUN) LTGWDWMSV5
IF (LTGWDWMSV5) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (YD%TGWDWMSV5 (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(YD%TGWDWMSV5,1):UBOUND(YD%TGWDWMSV5,1), LBOUND(YD%TGWDWMSV5,2):UBOUND(YD%TGWDWMSV5,2)))
  READ (KLUN) ZTMP2
  YD%TGWDWMSV5 = ZTMP2
  DEALLOCATE (ZTMP2)
ELSE
  NULLIFY (YD%TGWDWMSV5)
ENDIF
END SUBROUTINE


SUBROUTINE COPY_SPHYS_HIST_TYPE (YD, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (SPHYS_HIST_TYPE), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRADLWM, LRADLWM5, LTGWDWMSU, LTGWDWMSU5, LTGWDWMSV, LTGWDWMSV5, LYA5, LYI5, LYL5

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF
LYA5 = ASSOCIATED (YD%YA5)
IF (LYA5) THEN
  !$ACC ENTER DATA CREATE (YD%YA5)
  !$ACC UPDATE DEVICE (YD%YA5)
  !$ACC ENTER DATA ATTACH (YD%YA5)
ENDIF

LYL5 = ASSOCIATED (YD%YL5)
IF (LYL5) THEN
  !$ACC ENTER DATA CREATE (YD%YL5)
  !$ACC UPDATE DEVICE (YD%YL5)
  !$ACC ENTER DATA ATTACH (YD%YL5)
ENDIF

LYI5 = ASSOCIATED (YD%YI5)
IF (LYI5) THEN
  !$ACC ENTER DATA CREATE (YD%YI5)
  !$ACC UPDATE DEVICE (YD%YI5)
  !$ACC ENTER DATA ATTACH (YD%YI5)
ENDIF

LRADLWM = ASSOCIATED (YD%RADLWM)
IF (LRADLWM) THEN
  !$ACC ENTER DATA CREATE (YD%RADLWM)
  !$ACC UPDATE DEVICE (YD%RADLWM)
  !$ACC ENTER DATA ATTACH (YD%RADLWM)
ENDIF

LRADLWM5 = ASSOCIATED (YD%RADLWM5)
IF (LRADLWM5) THEN
  !$ACC ENTER DATA CREATE (YD%RADLWM5)
  !$ACC UPDATE DEVICE (YD%RADLWM5)
  !$ACC ENTER DATA ATTACH (YD%RADLWM5)
ENDIF

LTGWDWMSU = ASSOCIATED (YD%TGWDWMSU)
IF (LTGWDWMSU) THEN
  !$ACC ENTER DATA CREATE (YD%TGWDWMSU)
  !$ACC UPDATE DEVICE (YD%TGWDWMSU)
  !$ACC ENTER DATA ATTACH (YD%TGWDWMSU)
ENDIF

LTGWDWMSU5 = ASSOCIATED (YD%TGWDWMSU5)
IF (LTGWDWMSU5) THEN
  !$ACC ENTER DATA CREATE (YD%TGWDWMSU5)
  !$ACC UPDATE DEVICE (YD%TGWDWMSU5)
  !$ACC ENTER DATA ATTACH (YD%TGWDWMSU5)
ENDIF

LTGWDWMSV = ASSOCIATED (YD%TGWDWMSV)
IF (LTGWDWMSV) THEN
  !$ACC ENTER DATA CREATE (YD%TGWDWMSV)
  !$ACC UPDATE DEVICE (YD%TGWDWMSV)
  !$ACC ENTER DATA ATTACH (YD%TGWDWMSV)
ENDIF

LTGWDWMSV5 = ASSOCIATED (YD%TGWDWMSV5)
IF (LTGWDWMSV5) THEN
  !$ACC ENTER DATA CREATE (YD%TGWDWMSV5)
  !$ACC UPDATE DEVICE (YD%TGWDWMSV5)
  !$ACC ENTER DATA ATTACH (YD%TGWDWMSV5)
ENDIF

END SUBROUTINE

SUBROUTINE HOST_SPHYS_HIST_TYPE (YD)

IMPLICIT NONE
TYPE (SPHYS_HIST_TYPE), TARGET :: YD
LOGICAL :: LRADLWM, LRADLWM5, LTGWDWMSU, LTGWDWMSU5, LTGWDWMSV, LTGWDWMSV5, LYA5, LYI5, LYL5









END SUBROUTINE

     

SUBROUTINE CRC64_SPHYS_HIST_TYPE (YD, KLUN, CDPATH)
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (SPHYS_HIST_TYPE), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LRADLWM, LRADLWM5, LTGWDWMSU, LTGWDWMSU5, LTGWDWMSV, LTGWDWMSV5, LYA5, LYI5, LYL5
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%YA5), CDPATH//'%YA5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%YL5), CDPATH//'%YL5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%YI5), CDPATH//'%YI5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RADLWM), CDPATH//'%RADLWM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RADLWM5), CDPATH//'%RADLWM5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TGWDWMSU), CDPATH//'%TGWDWMSU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TGWDWMSU5), CDPATH//'%TGWDWMSU5'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TGWDWMSV), CDPATH//'%TGWDWMSV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TGWDWMSV5), CDPATH//'%TGWDWMSV5'

END SUBROUTINE

SUBROUTINE WIPE_SPHYS_HIST_TYPE (YD, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (SPHYS_HIST_TYPE), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRADLWM, LRADLWM5, LTGWDWMSU, LTGWDWMSU5, LTGWDWMSV, LTGWDWMSV5, LYA5, LYI5, LYL5

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LYA5 = ASSOCIATED (YD%YA5)
IF (LYA5) THEN
  !$ACC EXIT DATA DETACH (YD%YA5)
  !$ACC EXIT DATA DETACH (YD%YA5)
ENDIF

LYL5 = ASSOCIATED (YD%YL5)
IF (LYL5) THEN
  !$ACC EXIT DATA DETACH (YD%YL5)
  !$ACC EXIT DATA DETACH (YD%YL5)
ENDIF

LYI5 = ASSOCIATED (YD%YI5)
IF (LYI5) THEN
  !$ACC EXIT DATA DETACH (YD%YI5)
  !$ACC EXIT DATA DETACH (YD%YI5)
ENDIF

LRADLWM = ASSOCIATED (YD%RADLWM)
IF (LRADLWM) THEN
  !$ACC EXIT DATA DETACH (YD%RADLWM)
  !$ACC EXIT DATA DETACH (YD%RADLWM)
ENDIF

LRADLWM5 = ASSOCIATED (YD%RADLWM5)
IF (LRADLWM5) THEN
  !$ACC EXIT DATA DETACH (YD%RADLWM5)
  !$ACC EXIT DATA DETACH (YD%RADLWM5)
ENDIF

LTGWDWMSU = ASSOCIATED (YD%TGWDWMSU)
IF (LTGWDWMSU) THEN
  !$ACC EXIT DATA DETACH (YD%TGWDWMSU)
  !$ACC EXIT DATA DETACH (YD%TGWDWMSU)
ENDIF

LTGWDWMSU5 = ASSOCIATED (YD%TGWDWMSU5)
IF (LTGWDWMSU5) THEN
  !$ACC EXIT DATA DETACH (YD%TGWDWMSU5)
  !$ACC EXIT DATA DETACH (YD%TGWDWMSU5)
ENDIF

LTGWDWMSV = ASSOCIATED (YD%TGWDWMSV)
IF (LTGWDWMSV) THEN
  !$ACC EXIT DATA DETACH (YD%TGWDWMSV)
  !$ACC EXIT DATA DETACH (YD%TGWDWMSV)
ENDIF

LTGWDWMSV5 = ASSOCIATED (YD%TGWDWMSV5)
IF (LTGWDWMSV5) THEN
  !$ACC EXIT DATA DETACH (YD%TGWDWMSV5)
  !$ACC EXIT DATA DETACH (YD%TGWDWMSV5)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_SPHYS_HIST_TYPE (YD, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (SPHYS_HIST_TYPE),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LRADLWM, LRADLWM5, LTGWDWMSU, LTGWDWMSU5, LTGWDWMSV, LTGWDWMSV5, LYA5, LYI5, LYL5

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LYA5 = ASSOCIATED (YD%YA5)
IF (LYA5) THEN
  ISIZE = KIND (YD%YA5) * SIZE (YD%YA5)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%YA5'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LYL5 = ASSOCIATED (YD%YL5)
IF (LYL5) THEN
  ISIZE = KIND (YD%YL5) * SIZE (YD%YL5)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%YL5'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LYI5 = ASSOCIATED (YD%YI5)
IF (LYI5) THEN
  ISIZE = KIND (YD%YI5) * SIZE (YD%YI5)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%YI5'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRADLWM = ASSOCIATED (YD%RADLWM)
IF (LRADLWM) THEN
  ISIZE = KIND (YD%RADLWM) * SIZE (YD%RADLWM)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RADLWM'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRADLWM5 = ASSOCIATED (YD%RADLWM5)
IF (LRADLWM5) THEN
  ISIZE = KIND (YD%RADLWM5) * SIZE (YD%RADLWM5)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RADLWM5'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTGWDWMSU = ASSOCIATED (YD%TGWDWMSU)
IF (LTGWDWMSU) THEN
  ISIZE = KIND (YD%TGWDWMSU) * SIZE (YD%TGWDWMSU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TGWDWMSU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTGWDWMSU5 = ASSOCIATED (YD%TGWDWMSU5)
IF (LTGWDWMSU5) THEN
  ISIZE = KIND (YD%TGWDWMSU5) * SIZE (YD%TGWDWMSU5)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TGWDWMSU5'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTGWDWMSV = ASSOCIATED (YD%TGWDWMSV)
IF (LTGWDWMSV) THEN
  ISIZE = KIND (YD%TGWDWMSV) * SIZE (YD%TGWDWMSV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TGWDWMSV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LTGWDWMSV5 = ASSOCIATED (YD%TGWDWMSV5)
IF (LTGWDWMSV5) THEN
  ISIZE = KIND (YD%TGWDWMSV5) * SIZE (YD%TGWDWMSV5)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%TGWDWMSV5'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
