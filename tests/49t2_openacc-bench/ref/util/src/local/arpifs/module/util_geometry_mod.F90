MODULE UTIL_GEOMETRY_MOD

USE TYPE_GEOMETRY, ONLY : GEOMETRY

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_GEOMETRY
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_GEOMETRY
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_GEOMETRY
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_GEOMETRY
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_GEOMETRY
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_GEOMETRY
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_GEOMETRY
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_GEOMETRY (SELF, KLUN)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRELBC_GEO
WRITE (KLUN) SELF%LNHX_GEOM
CALL ACDC_SAVE_TVERTICAL_GEOM (SELF%YRVERT_GEOM, KLUN)
CALL ACDC_SAVE_TSTA (SELF%YRSTA, KLUN)
CALL ACDC_SAVE_TLAP (SELF%YRLAP, KLUN)
CALL ACDC_SAVE_TCSGLEG (SELF%YRCSGLEG, KLUN)
CALL ACDC_SAVE_TDIM (SELF%YRDIM, KLUN)
CALL ACDC_SAVE_TDIMV (SELF%YRDIMV, KLUN)
CALL ACDC_SAVE_TMP (SELF%YRMP, KLUN)
CALL ACDC_SAVE_TGEM (SELF%YRGEM, KLUN)
WRITE (KLUN) SELF%AD_GEOM
CALL ACDC_SAVE_TOROG_BLOCKED (SELF%YROROG_B, KLUN)
CALL ACDC_SAVE_TSPGEOM (SELF%YSPGEOM, KLUN)
CALL ACDC_SAVE_TVAB (SELF%YVABIO, KLUN)
CALL ACDC_SAVE_TEDIM (SELF%YREDIM, KLUN)
CALL ACDC_SAVE_TEGEO (SELF%YREGEO, KLUN)
CALL ACDC_SAVE_TEMMP (SELF%YREMP, KLUN)
CALL ACDC_SAVE_TLEP (SELF%YRELAP, KLUN)
CALL ACDC_SAVE_TEGSL (SELF%YREGSL, KLUN)
LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
WRITE (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  CALL ACDC_SAVE_TELBC_GEO (SELF%YRELBC_GEO, KLUN)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_GEOMETRY (SELF, KLUN)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LYRELBC_GEO
READ (KLUN) SELF%LNHX_GEOM
CALL ACDC_LOAD_TVERTICAL_GEOM (SELF%YRVERT_GEOM, KLUN)
CALL ACDC_LOAD_TSTA (SELF%YRSTA, KLUN)
CALL ACDC_LOAD_TLAP (SELF%YRLAP, KLUN)
CALL ACDC_LOAD_TCSGLEG (SELF%YRCSGLEG, KLUN)
CALL ACDC_LOAD_TDIM (SELF%YRDIM, KLUN)
CALL ACDC_LOAD_TDIMV (SELF%YRDIMV, KLUN)
CALL ACDC_LOAD_TMP (SELF%YRMP, KLUN)
CALL ACDC_LOAD_TGEM (SELF%YRGEM, KLUN)
NULLIFY (SELF%YRCSGEOM)
NULLIFY (SELF%YRGSGEOM)
READ (KLUN) SELF%AD_GEOM
NULLIFY (SELF%YRCSGEOMAD)
NULLIFY (SELF%YRGSGEOMAD)
CALL ACDC_LOAD_TOROG_BLOCKED (SELF%YROROG_B, KLUN)
CALL ACDC_LOAD_TSPGEOM (SELF%YSPGEOM, KLUN)
CALL ACDC_LOAD_TVAB (SELF%YVABIO, KLUN)
CALL ACDC_LOAD_TEDIM (SELF%YREDIM, KLUN)
CALL ACDC_LOAD_TEGEO (SELF%YREGEO, KLUN)
CALL ACDC_LOAD_TEMMP (SELF%YREMP, KLUN)
CALL ACDC_LOAD_TLEP (SELF%YRELAP, KLUN)
CALL ACDC_LOAD_TEGSL (SELF%YREGSL, KLUN)
READ (KLUN) LYRELBC_GEO
IF (LYRELBC_GEO) THEN
  ALLOCATE (SELF%YRELBC_GEO)
  CALL ACDC_LOAD_TELBC_GEO (SELF%YRELBC_GEO, KLUN)
ELSE
  NULLIFY (SELF%YRELBC_GEO)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_GEOMETRY (SELF, LDCREATED, LDFIELDAPI)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LYRELBC_GEO
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

CALL ACDC_COPY_TVERTICAL_GEOM (SELF%YRVERT_GEOM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TSTA (SELF%YRSTA, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TLAP (SELF%YRLAP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TCSGLEG (SELF%YRCSGLEG, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TDIM (SELF%YRDIM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TDIMV (SELF%YRDIMV, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TMP (SELF%YRMP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TGEM (SELF%YRGEM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TOROG_BLOCKED (SELF%YROROG_B, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TSPGEOM (SELF%YSPGEOM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TVAB (SELF%YVABIO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TEDIM (SELF%YREDIM, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TEGEO (SELF%YREGEO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TEMMP (SELF%YREMP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TLEP (SELF%YRELAP, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_COPY_TEGSL (SELF%YREGSL, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  !$ACC ENTER DATA CREATE (SELF%YRELBC_GEO)
  !$ACC UPDATE DEVICE (SELF%YRELBC_GEO)
  CALL ACDC_COPY_TELBC_GEO (SELF%YRELBC_GEO, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC ENTER DATA ATTACH (SELF%YRELBC_GEO)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_GEOMETRY (SELF)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY), TARGET :: SELF
LOGICAL :: LYRELBC_GEO

CALL ACDC_HOST_TVERTICAL_GEOM (SELF%YRVERT_GEOM)

CALL ACDC_HOST_TSTA (SELF%YRSTA)

CALL ACDC_HOST_TLAP (SELF%YRLAP)

CALL ACDC_HOST_TCSGLEG (SELF%YRCSGLEG)

CALL ACDC_HOST_TDIM (SELF%YRDIM)

CALL ACDC_HOST_TDIMV (SELF%YRDIMV)

CALL ACDC_HOST_TMP (SELF%YRMP)

CALL ACDC_HOST_TGEM (SELF%YRGEM)

CALL ACDC_HOST_TOROG_BLOCKED (SELF%YROROG_B)

CALL ACDC_HOST_TSPGEOM (SELF%YSPGEOM)

CALL ACDC_HOST_TVAB (SELF%YVABIO)

CALL ACDC_HOST_TEDIM (SELF%YREDIM)

CALL ACDC_HOST_TEGEO (SELF%YREGEO)

CALL ACDC_HOST_TEMMP (SELF%YREMP)

CALL ACDC_HOST_TLEP (SELF%YRELAP)

CALL ACDC_HOST_TEGSL (SELF%YREGSL)

LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  CALL ACDC_HOST_TELBC_GEO (SELF%YRELBC_GEO)
ENDIF

END SUBROUTINE



SUBROUTINE ACDC_CRC64_GEOMETRY (SELF, KLUN, CDPATH)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (GEOMETRY), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LYRELBC_GEO
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LNHX_GEOM), CDPATH//'%LNHX_GEOM'

CLIND = ''
CALL ACDC_CRC64_TVERTICAL_GEOM (SELF%YRVERT_GEOM, KLUN, CDPATH//'%YRVERT_GEOM'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TSTA (SELF%YRSTA, KLUN, CDPATH//'%YRSTA'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TLAP (SELF%YRLAP, KLUN, CDPATH//'%YRLAP'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TCSGLEG (SELF%YRCSGLEG, KLUN, CDPATH//'%YRCSGLEG'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TDIM (SELF%YRDIM, KLUN, CDPATH//'%YRDIM'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TDIMV (SELF%YRDIMV, KLUN, CDPATH//'%YRDIMV'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TMP (SELF%YRMP, KLUN, CDPATH//'%YRMP'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TGEM (SELF%YRGEM, KLUN, CDPATH//'%YRGEM'//TRIM(CLIND))

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%AD_GEOM), CDPATH//'%AD_GEOM'

CLIND = ''
CALL ACDC_CRC64_TOROG_BLOCKED (SELF%YROROG_B, KLUN, CDPATH//'%YROROG_B'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TSPGEOM (SELF%YSPGEOM, KLUN, CDPATH//'%YSPGEOM'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TVAB (SELF%YVABIO, KLUN, CDPATH//'%YVABIO'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TEDIM (SELF%YREDIM, KLUN, CDPATH//'%YREDIM'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TEGEO (SELF%YREGEO, KLUN, CDPATH//'%YREGEO'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TEMMP (SELF%YREMP, KLUN, CDPATH//'%YREMP'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TLEP (SELF%YRELAP, KLUN, CDPATH//'%YRELAP'//TRIM(CLIND))

CLIND = ''
CALL ACDC_CRC64_TEGSL (SELF%YREGSL, KLUN, CDPATH//'%YREGSL'//TRIM(CLIND))

LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  CLIND = ''
  CALL ACDC_CRC64_TELBC_GEO (SELF%YRELBC_GEO, KLUN, CDPATH//'%YRELBC_GEO'//TRIM(CLIND))
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_WIPE_GEOMETRY (SELF, LDDELETED, LDFIELDAPI)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LYRELBC_GEO
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

CALL ACDC_WIPE_TVERTICAL_GEOM (SELF%YRVERT_GEOM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TSTA (SELF%YRSTA, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TLAP (SELF%YRLAP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TCSGLEG (SELF%YRCSGLEG, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TDIM (SELF%YRDIM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TDIMV (SELF%YRDIMV, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TMP (SELF%YRMP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TGEM (SELF%YRGEM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TOROG_BLOCKED (SELF%YROROG_B, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TSPGEOM (SELF%YSPGEOM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TVAB (SELF%YVABIO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TEDIM (SELF%YREDIM, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TEGEO (SELF%YREGEO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TEMMP (SELF%YREMP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TLEP (SELF%YRELAP, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

CALL ACDC_WIPE_TEGSL (SELF%YREGSL, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  !$ACC EXIT DATA DETACH (SELF%YRELBC_GEO)
  CALL ACDC_WIPE_TELBC_GEO (SELF%YRELBC_GEO, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)
  !$ACC EXIT DATA DELETE (SELF%YRELBC_GEO)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_GEOMETRY (SELF, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_TCSGLEG_MOD
USE UTIL_TDIMV_MOD
USE UTIL_TDIM_MOD
USE UTIL_TEDIM_MOD
USE UTIL_TEGEO_MOD
USE UTIL_TEGSL_MOD
USE UTIL_TELBC_GEO_MOD
USE UTIL_TEMMP_MOD
USE UTIL_TGEM_MOD
USE UTIL_TLAP_MOD
USE UTIL_TLEP_MOD
USE UTIL_TMP_MOD
USE UTIL_TOROG_BLOCKED_MOD
USE UTIL_TSPGEOM_MOD
USE UTIL_TSTA_MOD
USE UTIL_TVAB_MOD
USE UTIL_TVERTICAL_GEOM_MOD
IMPLICIT NONE
TYPE (GEOMETRY),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LYRELBC_GEO
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%LNHX_GEOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNHX_GEOM'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = ACDC_SIZE_TVERTICAL_GEOM (SELF%YRVERT_GEOM, CLPATH//'%YRVERT_GEOM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRVERT_GEOM'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TSTA (SELF%YRSTA, CLPATH//'%YRSTA', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRSTA'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TLAP (SELF%YRLAP, CLPATH//'%YRLAP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRLAP'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TCSGLEG (SELF%YRCSGLEG, CLPATH//'%YRCSGLEG', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRCSGLEG'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TDIM (SELF%YRDIM, CLPATH//'%YRDIM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRDIM'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TDIMV (SELF%YRDIMV, CLPATH//'%YRDIMV', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRDIMV'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TMP (SELF%YRMP, CLPATH//'%YRMP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRMP'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TGEM (SELF%YRGEM, CLPATH//'%YRGEM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRGEM'
ENDIF
ISIZE = KIND (SELF%AD_GEOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%AD_GEOM'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = ACDC_SIZE_TOROG_BLOCKED (SELF%YROROG_B, CLPATH//'%YROROG_B', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YROROG_B'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TSPGEOM (SELF%YSPGEOM, CLPATH//'%YSPGEOM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YSPGEOM'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TVAB (SELF%YVABIO, CLPATH//'%YVABIO', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YVABIO'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TEDIM (SELF%YREDIM, CLPATH//'%YREDIM', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREDIM'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TEGEO (SELF%YREGEO, CLPATH//'%YREGEO', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREGEO'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TEMMP (SELF%YREMP, CLPATH//'%YREMP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREMP'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TLEP (SELF%YRELAP, CLPATH//'%YRELAP', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YRELAP'
ENDIF
JSIZE = 0
ISIZE = ACDC_SIZE_TEGSL (SELF%YREGSL, CLPATH//'%YREGSL', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YREGSL'
ENDIF
LYRELBC_GEO = ASSOCIATED (SELF%YRELBC_GEO)
IF (LYRELBC_GEO) THEN
  JSIZE = 0
  ISIZE = ACDC_SIZE_TELBC_GEO (SELF%YRELBC_GEO, CLPATH//'%YRELBC_GEO', .FALSE.)
  JSIZE = JSIZE + ISIZE
  KSIZE = KSIZE + ISIZE
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
    WRITE (*, *) TRIM (CLPATH)//'%YRELBC_GEO'
  ENDIF
ENDIF
END FUNCTION

END MODULE
