MODULE UTIL_TERAD_MOD

USE YOERAD, ONLY : TERAD

INTERFACE SAVE
MODULE PROCEDURE SAVE_TERAD
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TERAD
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TERAD
END INTERFACE

INTERFACE HOST
MODULE PROCEDURE HOST_TERAD
END INTERFACE

     
INTERFACE CRC64
MODULE PROCEDURE CRC64_TERAD
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TERAD
END INTERFACE

INTERFACE SIZE
MODULE PROCEDURE SIZE_TERAD
END INTERFACE


CONTAINS

SUBROUTINE SAVE_TERAD (KLUN, YD)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TERAD), INTENT (IN), TARGET :: YD
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
WRITE (KLUN) YD%NAER
WRITE (KLUN) YD%NMODE
WRITE (KLUN) YD%NOZOCL
WRITE (KLUN) YD%NRADFR
WRITE (KLUN) YD%NRADPFR
WRITE (KLUN) YD%NRADPLA
WRITE (KLUN) YD%NRADINT
WRITE (KLUN) YD%NRADRES
WRITE (KLUN) YD%NRADNFR
WRITE (KLUN) YD%NRADSFR
WRITE (KLUN) YD%NRADE1H
WRITE (KLUN) YD%NRADE3H
WRITE (KLUN) YD%NRADELG
WRITE (KLUN) YD%NOVLP
WRITE (KLUN) YD%NRPROMA
WRITE (KLUN) YD%NLW
WRITE (KLUN) YD%NSWNL
WRITE (KLUN) YD%NSWTL
WRITE (KLUN) YD%NTLW
WRITE (KLUN) YD%NTSW
WRITE (KLUN) YD%NUV
WRITE (KLUN) YD%NCSRADF
WRITE (KLUN) YD%NINHOM
WRITE (KLUN) YD%NLAYINH
WRITE (KLUN) YD%NLNGR1H
WRITE (KLUN) YD%NPERTAER
WRITE (KLUN) YD%NPERTOZ
WRITE (KLUN) YD%NSCEN
WRITE (KLUN) YD%NHINCSOL
WRITE (KLUN) YD%NMCICA
WRITE (KLUN) YD%NGHGRAD
WRITE (KLUN) YD%NVOLCVERT
WRITE (KLUN) YD%NREDGLW
WRITE (KLUN) YD%NREDGSW
WRITE (KLUN) YD%NSPMAPL
WRITE (KLUN) YD%NSPMAPS
WRITE (KLUN) YD%NSW
WRITE (KLUN) YD%NLWEMISS
WRITE (KLUN) YD%NICEOPT
WRITE (KLUN) YD%NLIQOPT
WRITE (KLUN) YD%NRADIP
WRITE (KLUN) YD%NRADLP
WRITE (KLUN) YD%NLWOUT
WRITE (KLUN) YD%NDECOLAT
WRITE (KLUN) YD%NMINICE
WRITE (KLUN) YD%NAERMACC
WRITE (KLUN) YD%NMCVAR
WRITE (KLUN) YD%NLWSCATTERING
WRITE (KLUN) YD%NSWSOLVER
WRITE (KLUN) YD%NLWSOLVER
WRITE (KLUN) YD%NSOLARSPECTRUM
WRITE (KLUN) YD%NDUMPBADINPUTS
WRITE (KLUN) YD%NDUMPINPUTS
WRITE (KLUN) YD%NCLOUDOVERLAP
WRITE (KLUN) YD%RCLOUD_FRAC_STD
WRITE (KLUN) YD%RCLOUD_SEPARATION_SCALE_TOA
WRITE (KLUN) YD%RCLOUD_SEPARATION_SCALE_SURF
WRITE (KLUN) YD%LFU_LW_ICE_OPTICS_BUG
WRITE (KLUN) YD%LDIAGFORCING
WRITE (KLUN) YD%LAPPROXLWUPDATE
WRITE (KLUN) YD%LAPPROXSWUPDATE
WRITE (KLUN) YD%NSWICEOPT
WRITE (KLUN) YD%NSWLIQOPT
WRITE (KLUN) YD%NLWICEOPT
WRITE (KLUN) YD%NLWLIQOPT
WRITE (KLUN) YD%LCCNL
WRITE (KLUN) YD%LCCNO
WRITE (KLUN) YD%RCCNLND
WRITE (KLUN) YD%RCCNSEA
WRITE (KLUN) YD%RRE2DE
WRITE (KLUN) YD%RMINICE
WRITE (KLUN) YD%NMCLAT
WRITE (KLUN) YD%NMCLON
WRITE (KLUN) YD%NMCLEV
WRITE (KLUN) YD%NSWGASOPTICS
WRITE (KLUN) YD%NLWGASOPTICS
WRITE (KLUN) YD%NGASOPTICSSCHEME
WRITE (KLUN) YD%KMODTS
WRITE (KLUN) YD%NSWWVCONTINUUM
WRITE (KLUN) YD%NRTCALL
WRITE (KLUN) YD%IRTCALLREF
WRITE (KLUN) YD%IRTCALLCLN
WRITE (KLUN) YD%LINTERPINCLOUDMEAN
WRITE (KLUN) YD%LERAD1H
WRITE (KLUN) YD%LEPO3RA
WRITE (KLUN) YD%LONEWSW
WRITE (KLUN) YD%LECSRAD
WRITE (KLUN) YD%LRRTM
WRITE (KLUN) YD%LSRTM
WRITE (KLUN) YD%LDIFFC
WRITE (KLUN) YD%LHVOLCA
WRITE (KLUN) YD%LNEWAER
WRITE (KLUN) YD%LNOTROAER
WRITE (KLUN) YD%LRAYL
WRITE (KLUN) YD%LOPTRPROMA
WRITE (KLUN) YD%LECO2VAR
WRITE (KLUN) YD%LHGHG
WRITE (KLUN) YD%LESO4HIS
WRITE (KLUN) YD%LETRACGMS
WRITE (KLUN) YD%LAERCLIM
WRITE (KLUN) YD%LAERVISI
WRITE (KLUN) YD%LAER3D
WRITE (KLUN) YD%LVOLCSPEC
WRITE (KLUN) YD%LVOLCDAMP
WRITE (KLUN) YD%LAERADCLI
WRITE (KLUN) YD%LAERADJDU
WRITE (KLUN) YD%LMANNERSSWUPDATE
WRITE (KLUN) YD%LCENTREDTIMESZA
WRITE (KLUN) YD%LAVERAGESZA
WRITE (KLUN) YD%LECOMPGRID
WRITE (KLUN) YD%LUSEPRE2017RAD
WRITE (KLUN) YD%LDUSEASON
WRITE (KLUN) YD%LPERPET
WRITE (KLUN) YD%LCLEAN
WRITE (KLUN) YD%RAOVLP
WRITE (KLUN) YD%RBOVLP
WRITE (KLUN) YD%LEDBUG
WRITE (KLUN) YD%RPERTOZ
WRITE (KLUN) YD%RLWINHF
WRITE (KLUN) YD%RSWINHF
WRITE (KLUN) YD%RVOLCSPEC
WRITE (KLUN) YD%RNS
WRITE (KLUN) YD%RSIGAIR
WRITE (KLUN) YD%RAESHSS
WRITE (KLUN) YD%RAESHDU
WRITE (KLUN) YD%RAESHOM
WRITE (KLUN) YD%RAESHBC
WRITE (KLUN) YD%RAESHSU
WRITE (KLUN) YD%TRBKG
WRITE (KLUN) YD%STBKG
WRITE (KLUN) YD%CGHGCLIMFILE
WRITE (KLUN) YD%CGHGTIMESERIESFILE
WRITE (KLUN) YD%CSOLARIRRADIANCEFILE
WRITE (KLUN) YD%RRATSEA
WRITE (KLUN) YD%RRATLAND
WRITE (KLUN) YD%RRATDRI
WRITE (KLUN) YD%RCADECOR
WRITE (KLUN) YD%RCBDECOR
WRITE (KLUN) YD%RFACDICE
LCVDAESS = ALLOCATED (YD%CVDAESS)
WRITE (KLUN) LCVDAESS
IF (LCVDAESS) THEN
  WRITE (KLUN) LBOUND (YD%CVDAESS)
  WRITE (KLUN) UBOUND (YD%CVDAESS)
  WRITE (KLUN) YD%CVDAESS
ENDIF
LCVDAEDU = ALLOCATED (YD%CVDAEDU)
WRITE (KLUN) LCVDAEDU
IF (LCVDAEDU) THEN
  WRITE (KLUN) LBOUND (YD%CVDAEDU)
  WRITE (KLUN) UBOUND (YD%CVDAEDU)
  WRITE (KLUN) YD%CVDAEDU
ENDIF
LCVDAEOM = ALLOCATED (YD%CVDAEOM)
WRITE (KLUN) LCVDAEOM
IF (LCVDAEOM) THEN
  WRITE (KLUN) LBOUND (YD%CVDAEOM)
  WRITE (KLUN) UBOUND (YD%CVDAEOM)
  WRITE (KLUN) YD%CVDAEOM
ENDIF
LCVDAEBC = ALLOCATED (YD%CVDAEBC)
WRITE (KLUN) LCVDAEBC
IF (LCVDAEBC) THEN
  WRITE (KLUN) LBOUND (YD%CVDAEBC)
  WRITE (KLUN) UBOUND (YD%CVDAEBC)
  WRITE (KLUN) YD%CVDAEBC
ENDIF
LCVDAESU = ALLOCATED (YD%CVDAESU)
WRITE (KLUN) LCVDAESU
IF (LCVDAESU) THEN
  WRITE (KLUN) LBOUND (YD%CVDAESU)
  WRITE (KLUN) UBOUND (YD%CVDAESU)
  WRITE (KLUN) YD%CVDAESU
ENDIF
WRITE (KLUN) YD%CECRADARCH
WRITE (KLUN) YD%LECRADACC
WRITE (KLUN) YD%NECRADLEN
CALL SAVE_TSPECTRALPLANCK (KLUN, YD%YSPECTPLANCK)
END SUBROUTINE

SUBROUTINE LOAD_TERAD (KLUN, YD)
USE UTIL_TSPECTRALPLANCK_MOD
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TERAD), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) YD%NAER
READ (KLUN) YD%NMODE
READ (KLUN) YD%NOZOCL
READ (KLUN) YD%NRADFR
READ (KLUN) YD%NRADPFR
READ (KLUN) YD%NRADPLA
READ (KLUN) YD%NRADINT
READ (KLUN) YD%NRADRES
READ (KLUN) YD%NRADNFR
READ (KLUN) YD%NRADSFR
READ (KLUN) YD%NRADE1H
READ (KLUN) YD%NRADE3H
READ (KLUN) YD%NRADELG
READ (KLUN) YD%NOVLP
READ (KLUN) YD%NRPROMA
READ (KLUN) YD%NLW
READ (KLUN) YD%NSWNL
READ (KLUN) YD%NSWTL
READ (KLUN) YD%NTLW
READ (KLUN) YD%NTSW
READ (KLUN) YD%NUV
READ (KLUN) YD%NCSRADF
READ (KLUN) YD%NINHOM
READ (KLUN) YD%NLAYINH
READ (KLUN) YD%NLNGR1H
READ (KLUN) YD%NPERTAER
READ (KLUN) YD%NPERTOZ
READ (KLUN) YD%NSCEN
READ (KLUN) YD%NHINCSOL
READ (KLUN) YD%NMCICA
READ (KLUN) YD%NGHGRAD
READ (KLUN) YD%NVOLCVERT
READ (KLUN) YD%NREDGLW
READ (KLUN) YD%NREDGSW
READ (KLUN) YD%NSPMAPL
READ (KLUN) YD%NSPMAPS
READ (KLUN) YD%NSW
READ (KLUN) YD%NLWEMISS
READ (KLUN) YD%NICEOPT
READ (KLUN) YD%NLIQOPT
READ (KLUN) YD%NRADIP
READ (KLUN) YD%NRADLP
READ (KLUN) YD%NLWOUT
READ (KLUN) YD%NDECOLAT
READ (KLUN) YD%NMINICE
READ (KLUN) YD%NAERMACC
READ (KLUN) YD%NMCVAR
READ (KLUN) YD%NLWSCATTERING
READ (KLUN) YD%NSWSOLVER
READ (KLUN) YD%NLWSOLVER
READ (KLUN) YD%NSOLARSPECTRUM
READ (KLUN) YD%NDUMPBADINPUTS
READ (KLUN) YD%NDUMPINPUTS
READ (KLUN) YD%NCLOUDOVERLAP
READ (KLUN) ZTMP0
YD%RCLOUD_FRAC_STD = ZTMP0
READ (KLUN) ZTMP0
YD%RCLOUD_SEPARATION_SCALE_TOA = ZTMP0
READ (KLUN) ZTMP0
YD%RCLOUD_SEPARATION_SCALE_SURF = ZTMP0
READ (KLUN) YD%LFU_LW_ICE_OPTICS_BUG
READ (KLUN) YD%LDIAGFORCING
READ (KLUN) YD%LAPPROXLWUPDATE
READ (KLUN) YD%LAPPROXSWUPDATE
READ (KLUN) YD%NSWICEOPT
READ (KLUN) YD%NSWLIQOPT
READ (KLUN) YD%NLWICEOPT
READ (KLUN) YD%NLWLIQOPT
READ (KLUN) YD%LCCNL
READ (KLUN) YD%LCCNO
READ (KLUN) ZTMP0
YD%RCCNLND = ZTMP0
READ (KLUN) ZTMP0
YD%RCCNSEA = ZTMP0
READ (KLUN) ZTMP0
YD%RRE2DE = ZTMP0
READ (KLUN) ZTMP0
YD%RMINICE = ZTMP0
READ (KLUN) YD%NMCLAT
READ (KLUN) YD%NMCLON
READ (KLUN) YD%NMCLEV
READ (KLUN) YD%NSWGASOPTICS
READ (KLUN) YD%NLWGASOPTICS
READ (KLUN) YD%NGASOPTICSSCHEME
READ (KLUN) YD%KMODTS
READ (KLUN) YD%NSWWVCONTINUUM
READ (KLUN) YD%NRTCALL
READ (KLUN) YD%IRTCALLREF
READ (KLUN) YD%IRTCALLCLN
READ (KLUN) YD%LINTERPINCLOUDMEAN
READ (KLUN) YD%LERAD1H
READ (KLUN) YD%LEPO3RA
READ (KLUN) YD%LONEWSW
READ (KLUN) YD%LECSRAD
READ (KLUN) YD%LRRTM
READ (KLUN) YD%LSRTM
READ (KLUN) YD%LDIFFC
READ (KLUN) YD%LHVOLCA
READ (KLUN) YD%LNEWAER
READ (KLUN) YD%LNOTROAER
READ (KLUN) YD%LRAYL
READ (KLUN) YD%LOPTRPROMA
READ (KLUN) YD%LECO2VAR
READ (KLUN) YD%LHGHG
READ (KLUN) YD%LESO4HIS
READ (KLUN) YD%LETRACGMS
READ (KLUN) YD%LAERCLIM
READ (KLUN) YD%LAERVISI
READ (KLUN) YD%LAER3D
READ (KLUN) YD%LVOLCSPEC
READ (KLUN) YD%LVOLCDAMP
READ (KLUN) YD%LAERADCLI
READ (KLUN) YD%LAERADJDU
READ (KLUN) YD%LMANNERSSWUPDATE
READ (KLUN) YD%LCENTREDTIMESZA
READ (KLUN) YD%LAVERAGESZA
READ (KLUN) YD%LECOMPGRID
READ (KLUN) YD%LUSEPRE2017RAD
READ (KLUN) YD%LDUSEASON
READ (KLUN) YD%LPERPET
READ (KLUN) YD%LCLEAN
READ (KLUN) ZTMP0
YD%RAOVLP = ZTMP0
READ (KLUN) ZTMP0
YD%RBOVLP = ZTMP0
READ (KLUN) YD%LEDBUG
READ (KLUN) ZTMP0
YD%RPERTOZ = ZTMP0
READ (KLUN) ZTMP0
YD%RLWINHF = ZTMP0
READ (KLUN) ZTMP0
YD%RSWINHF = ZTMP0
ALLOCATE (ZTMP1(LBOUND(YD%RVOLCSPEC,1):UBOUND(YD%RVOLCSPEC,1)))
READ (KLUN) ZTMP1
YD%RVOLCSPEC = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
YD%RNS = ZTMP0
READ (KLUN) ZTMP0
YD%RSIGAIR = ZTMP0
READ (KLUN) ZTMP0
YD%RAESHSS = ZTMP0
READ (KLUN) ZTMP0
YD%RAESHDU = ZTMP0
READ (KLUN) ZTMP0
YD%RAESHOM = ZTMP0
READ (KLUN) ZTMP0
YD%RAESHBC = ZTMP0
READ (KLUN) ZTMP0
YD%RAESHSU = ZTMP0
READ (KLUN) ZTMP0
YD%TRBKG = ZTMP0
READ (KLUN) ZTMP0
YD%STBKG = ZTMP0
READ (KLUN) YD%CGHGCLIMFILE
READ (KLUN) YD%CGHGTIMESERIESFILE
READ (KLUN) YD%CSOLARIRRADIANCEFILE
READ (KLUN) ZTMP0
YD%RRATSEA = ZTMP0
READ (KLUN) ZTMP0
YD%RRATLAND = ZTMP0
READ (KLUN) ZTMP0
YD%RRATDRI = ZTMP0
READ (KLUN) ZTMP0
YD%RCADECOR = ZTMP0
READ (KLUN) ZTMP0
YD%RCBDECOR = ZTMP0
READ (KLUN) ZTMP0
YD%RFACDICE = ZTMP0
READ (KLUN) LCVDAESS
IF (LCVDAESS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CVDAESS (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%CVDAESS,1):UBOUND(YD%CVDAESS,1)))
  READ (KLUN) ZTMP1
  YD%CVDAESS = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAEDU
IF (LCVDAEDU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CVDAEDU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%CVDAEDU,1):UBOUND(YD%CVDAEDU,1)))
  READ (KLUN) ZTMP1
  YD%CVDAEDU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAEOM
IF (LCVDAEOM) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CVDAEOM (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%CVDAEOM,1):UBOUND(YD%CVDAEOM,1)))
  READ (KLUN) ZTMP1
  YD%CVDAEOM = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAEBC
IF (LCVDAEBC) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CVDAEBC (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%CVDAEBC,1):UBOUND(YD%CVDAEBC,1)))
  READ (KLUN) ZTMP1
  YD%CVDAEBC = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAESU
IF (LCVDAESU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CVDAESU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%CVDAESU,1):UBOUND(YD%CVDAESU,1)))
  READ (KLUN) ZTMP1
  YD%CVDAESU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) YD%CECRADARCH
READ (KLUN) YD%LECRADACC
READ (KLUN) YD%NECRADLEN
CALL LOAD_TSPECTRALPLANCK (KLUN, YD%YSPECTPLANCK)
END SUBROUTINE


SUBROUTINE COPY_TERAD (YD, LDCREATED, LDFIELDAPI)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (YD)
  !$ACC UPDATE DEVICE (YD)
ENDIF











































































































































LCVDAESS = ALLOCATED (YD%CVDAESS)
IF (LCVDAESS) THEN
  !$ACC ENTER DATA CREATE (YD%CVDAESS)
  !$ACC UPDATE DEVICE (YD%CVDAESS)
  !$ACC ENTER DATA ATTACH (YD%CVDAESS)
ENDIF

LCVDAEDU = ALLOCATED (YD%CVDAEDU)
IF (LCVDAEDU) THEN
  !$ACC ENTER DATA CREATE (YD%CVDAEDU)
  !$ACC UPDATE DEVICE (YD%CVDAEDU)
  !$ACC ENTER DATA ATTACH (YD%CVDAEDU)
ENDIF

LCVDAEOM = ALLOCATED (YD%CVDAEOM)
IF (LCVDAEOM) THEN
  !$ACC ENTER DATA CREATE (YD%CVDAEOM)
  !$ACC UPDATE DEVICE (YD%CVDAEOM)
  !$ACC ENTER DATA ATTACH (YD%CVDAEOM)
ENDIF

LCVDAEBC = ALLOCATED (YD%CVDAEBC)
IF (LCVDAEBC) THEN
  !$ACC ENTER DATA CREATE (YD%CVDAEBC)
  !$ACC UPDATE DEVICE (YD%CVDAEBC)
  !$ACC ENTER DATA ATTACH (YD%CVDAEBC)
ENDIF

LCVDAESU = ALLOCATED (YD%CVDAESU)
IF (LCVDAESU) THEN
  !$ACC ENTER DATA CREATE (YD%CVDAESU)
  !$ACC UPDATE DEVICE (YD%CVDAESU)
  !$ACC ENTER DATA ATTACH (YD%CVDAESU)
ENDIF




CALL COPY_TSPECTRALPLANCK (YD%YSPECTPLANCK, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

END SUBROUTINE

SUBROUTINE HOST_TERAD (YD)
USE UTIL_TSPECTRALPLANCK_MOD

IMPLICIT NONE
TYPE (TERAD), TARGET :: YD
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU



















































































































































CALL HOST_TSPECTRALPLANCK (YD%YSPECTPLANCK)

END SUBROUTINE

     

SUBROUTINE CRC64_TERAD (YD, KLUN, CDPATH)
USE UTIL_TSPECTRALPLANCK_MOD
USE CRC64_INTRINSIC, ONLY : FCRC64 => CRC64

IMPLICIT NONE
TYPE (TERAD), TARGET :: YD
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NAER), CDPATH//'%NAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NMODE), CDPATH//'%NMODE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NOZOCL), CDPATH//'%NOZOCL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADFR), CDPATH//'%NRADFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADPFR), CDPATH//'%NRADPFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADPLA), CDPATH//'%NRADPLA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADINT), CDPATH//'%NRADINT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADRES), CDPATH//'%NRADRES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADNFR), CDPATH//'%NRADNFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADSFR), CDPATH//'%NRADSFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADE1H), CDPATH//'%NRADE1H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADE3H), CDPATH//'%NRADE3H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADELG), CDPATH//'%NRADELG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NOVLP), CDPATH//'%NOVLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRPROMA), CDPATH//'%NRPROMA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLW), CDPATH//'%NLW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSWNL), CDPATH//'%NSWNL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSWTL), CDPATH//'%NSWTL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTLW), CDPATH//'%NTLW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NTSW), CDPATH//'%NTSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NUV), CDPATH//'%NUV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCSRADF), CDPATH//'%NCSRADF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NINHOM), CDPATH//'%NINHOM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLAYINH), CDPATH//'%NLAYINH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLNGR1H), CDPATH//'%NLNGR1H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPERTAER), CDPATH//'%NPERTAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NPERTOZ), CDPATH//'%NPERTOZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSCEN), CDPATH//'%NSCEN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NHINCSOL), CDPATH//'%NHINCSOL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NMCICA), CDPATH//'%NMCICA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGHGRAD), CDPATH//'%NGHGRAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NVOLCVERT), CDPATH//'%NVOLCVERT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NREDGLW), CDPATH//'%NREDGLW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NREDGSW), CDPATH//'%NREDGSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSPMAPL), CDPATH//'%NSPMAPL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSPMAPS), CDPATH//'%NSPMAPS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSW), CDPATH//'%NSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLWEMISS), CDPATH//'%NLWEMISS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NICEOPT), CDPATH//'%NICEOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLIQOPT), CDPATH//'%NLIQOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADIP), CDPATH//'%NRADIP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRADLP), CDPATH//'%NRADLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLWOUT), CDPATH//'%NLWOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDECOLAT), CDPATH//'%NDECOLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NMINICE), CDPATH//'%NMINICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NAERMACC), CDPATH//'%NAERMACC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NMCVAR), CDPATH//'%NMCVAR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLWSCATTERING), CDPATH//'%NLWSCATTERING'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSWSOLVER), CDPATH//'%NSWSOLVER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLWSOLVER), CDPATH//'%NLWSOLVER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSOLARSPECTRUM), CDPATH//'%NSOLARSPECTRUM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDUMPBADINPUTS), CDPATH//'%NDUMPBADINPUTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NDUMPINPUTS), CDPATH//'%NDUMPINPUTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NCLOUDOVERLAP), CDPATH//'%NCLOUDOVERLAP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCLOUD_FRAC_STD), CDPATH//'%RCLOUD_FRAC_STD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCLOUD_SEPARATION_SCALE_TOA), CDPATH//'%RCLOUD_SEPARATION_SCALE_TOA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCLOUD_SEPARATION_SCALE_SURF), CDPATH//'%RCLOUD_SEPARATION_SCALE_SURF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LFU_LW_ICE_OPTICS_BUG), CDPATH//'%LFU_LW_ICE_OPTICS_BUG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LDIAGFORCING), CDPATH//'%LDIAGFORCING'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAPPROXLWUPDATE), CDPATH//'%LAPPROXLWUPDATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAPPROXSWUPDATE), CDPATH//'%LAPPROXSWUPDATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSWICEOPT), CDPATH//'%NSWICEOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSWLIQOPT), CDPATH//'%NSWLIQOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLWICEOPT), CDPATH//'%NLWICEOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLWLIQOPT), CDPATH//'%NLWLIQOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCCNL), CDPATH//'%LCCNL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCCNO), CDPATH//'%LCCNO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCNLND), CDPATH//'%RCCNLND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCCNSEA), CDPATH//'%RCCNSEA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RRE2DE), CDPATH//'%RRE2DE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RMINICE), CDPATH//'%RMINICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NMCLAT), CDPATH//'%NMCLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NMCLON), CDPATH//'%NMCLON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NMCLEV), CDPATH//'%NMCLEV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSWGASOPTICS), CDPATH//'%NSWGASOPTICS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NLWGASOPTICS), CDPATH//'%NLWGASOPTICS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NGASOPTICSSCHEME), CDPATH//'%NGASOPTICSSCHEME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%KMODTS), CDPATH//'%KMODTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NSWWVCONTINUUM), CDPATH//'%NSWWVCONTINUUM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NRTCALL), CDPATH//'%NRTCALL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IRTCALLREF), CDPATH//'%IRTCALLREF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%IRTCALLCLN), CDPATH//'%IRTCALLCLN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LINTERPINCLOUDMEAN), CDPATH//'%LINTERPINCLOUDMEAN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LERAD1H), CDPATH//'%LERAD1H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LEPO3RA), CDPATH//'%LEPO3RA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LONEWSW), CDPATH//'%LONEWSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LECSRAD), CDPATH//'%LECSRAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRRTM), CDPATH//'%LRRTM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LSRTM), CDPATH//'%LSRTM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LDIFFC), CDPATH//'%LDIFFC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LHVOLCA), CDPATH//'%LHVOLCA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNEWAER), CDPATH//'%LNEWAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LNOTROAER), CDPATH//'%LNOTROAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LRAYL), CDPATH//'%LRAYL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LOPTRPROMA), CDPATH//'%LOPTRPROMA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LECO2VAR), CDPATH//'%LECO2VAR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LHGHG), CDPATH//'%LHGHG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LESO4HIS), CDPATH//'%LESO4HIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LETRACGMS), CDPATH//'%LETRACGMS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERCLIM), CDPATH//'%LAERCLIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERVISI), CDPATH//'%LAERVISI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAER3D), CDPATH//'%LAER3D'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LVOLCSPEC), CDPATH//'%LVOLCSPEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LVOLCDAMP), CDPATH//'%LVOLCDAMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERADCLI), CDPATH//'%LAERADCLI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAERADJDU), CDPATH//'%LAERADJDU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LMANNERSSWUPDATE), CDPATH//'%LMANNERSSWUPDATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCENTREDTIMESZA), CDPATH//'%LCENTREDTIMESZA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LAVERAGESZA), CDPATH//'%LAVERAGESZA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LECOMPGRID), CDPATH//'%LECOMPGRID'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LUSEPRE2017RAD), CDPATH//'%LUSEPRE2017RAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LDUSEASON), CDPATH//'%LDUSEASON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LPERPET), CDPATH//'%LPERPET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LCLEAN), CDPATH//'%LCLEAN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAOVLP), CDPATH//'%RAOVLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RBOVLP), CDPATH//'%RBOVLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LEDBUG), CDPATH//'%LEDBUG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RPERTOZ), CDPATH//'%RPERTOZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RLWINHF), CDPATH//'%RLWINHF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSWINHF), CDPATH//'%RSWINHF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RVOLCSPEC), CDPATH//'%RVOLCSPEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RNS), CDPATH//'%RNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RSIGAIR), CDPATH//'%RSIGAIR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAESHSS), CDPATH//'%RAESHSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAESHDU), CDPATH//'%RAESHDU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAESHOM), CDPATH//'%RAESHOM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAESHBC), CDPATH//'%RAESHBC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RAESHSU), CDPATH//'%RAESHSU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%TRBKG), CDPATH//'%TRBKG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%STBKG), CDPATH//'%STBKG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CGHGCLIMFILE), CDPATH//'%CGHGCLIMFILE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CGHGTIMESERIESFILE), CDPATH//'%CGHGTIMESERIESFILE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CSOLARIRRADIANCEFILE), CDPATH//'%CSOLARIRRADIANCEFILE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RRATSEA), CDPATH//'%RRATSEA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RRATLAND), CDPATH//'%RRATLAND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RRATDRI), CDPATH//'%RRATDRI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCADECOR), CDPATH//'%RCADECOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RCBDECOR), CDPATH//'%RCBDECOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%RFACDICE), CDPATH//'%RFACDICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CVDAESS), CDPATH//'%CVDAESS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CVDAEDU), CDPATH//'%CVDAEDU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CVDAEOM), CDPATH//'%CVDAEOM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CVDAEBC), CDPATH//'%CVDAEBC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CVDAESU), CDPATH//'%CVDAESU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%CECRADARCH), CDPATH//'%CECRADARCH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%LECRADACC), CDPATH//'%LECRADACC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (YD%NECRADLEN), CDPATH//'%NECRADLEN'

CLIND = ''
CALL CRC64_TSPECTRALPLANCK (YD%YSPECTPLANCK, KLUN, CDPATH//'%YSPECTPLANCK'//TRIM(CLIND))

END SUBROUTINE

SUBROUTINE WIPE_TERAD (YD, LDDELETED, LDFIELDAPI)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU

LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF











































































































































LCVDAESS = ALLOCATED (YD%CVDAESS)
IF (LCVDAESS) THEN
  !$ACC EXIT DATA DETACH (YD%CVDAESS)
  !$ACC EXIT DATA DETACH (YD%CVDAESS)
ENDIF

LCVDAEDU = ALLOCATED (YD%CVDAEDU)
IF (LCVDAEDU) THEN
  !$ACC EXIT DATA DETACH (YD%CVDAEDU)
  !$ACC EXIT DATA DETACH (YD%CVDAEDU)
ENDIF

LCVDAEOM = ALLOCATED (YD%CVDAEOM)
IF (LCVDAEOM) THEN
  !$ACC EXIT DATA DETACH (YD%CVDAEOM)
  !$ACC EXIT DATA DETACH (YD%CVDAEOM)
ENDIF

LCVDAEBC = ALLOCATED (YD%CVDAEBC)
IF (LCVDAEBC) THEN
  !$ACC EXIT DATA DETACH (YD%CVDAEBC)
  !$ACC EXIT DATA DETACH (YD%CVDAEBC)
ENDIF

LCVDAESU = ALLOCATED (YD%CVDAESU)
IF (LCVDAESU) THEN
  !$ACC EXIT DATA DETACH (YD%CVDAESU)
  !$ACC EXIT DATA DETACH (YD%CVDAESU)
ENDIF




CALL WIPE_TSPECTRALPLANCK (YD%YSPECTPLANCK, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (YD)
ENDIF
END SUBROUTINE

INTEGER*8 FUNCTION SIZE_TERAD (YD, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD),     INTENT (IN), TARGET :: YD
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU

LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (YD%NAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NMODE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMODE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NOZOCL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NOZOCL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADPFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADPFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADPLA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADPLA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADINT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADINT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADRES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADRES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADNFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADNFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADSFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADSFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADE1H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADE1H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADE3H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADE3H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADELG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADELG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NOVLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NOVLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRPROMA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRPROMA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSWNL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWNL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSWTL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWTL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTLW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTLW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NTSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NUV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCSRADF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCSRADF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NINHOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NINHOM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLAYINH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLAYINH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLNGR1H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLNGR1H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPERTAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPERTAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NPERTOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPERTOZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSCEN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSCEN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NHINCSOL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NHINCSOL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NMCICA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCICA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NGHGRAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGHGRAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NVOLCVERT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVOLCVERT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NREDGLW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NREDGLW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NREDGSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NREDGSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSPMAPL) * SIZE (YD%NSPMAPL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSPMAPL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSPMAPS) * SIZE (YD%NSPMAPS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSPMAPS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLWEMISS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWEMISS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NICEOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NICEOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLIQOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLIQOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADIP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADIP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRADLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLWOUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWOUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDECOLAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDECOLAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NMINICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMINICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NAERMACC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NAERMACC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NMCVAR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCVAR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLWSCATTERING)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWSCATTERING'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSWSOLVER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWSOLVER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLWSOLVER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWSOLVER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSOLARSPECTRUM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSOLARSPECTRUM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDUMPBADINPUTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDUMPBADINPUTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NDUMPINPUTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDUMPINPUTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NCLOUDOVERLAP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLOUDOVERLAP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCLOUD_FRAC_STD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCLOUD_FRAC_STD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCLOUD_SEPARATION_SCALE_TOA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCLOUD_SEPARATION_SCALE_TOA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCLOUD_SEPARATION_SCALE_SURF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCLOUD_SEPARATION_SCALE_SURF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LFU_LW_ICE_OPTICS_BUG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LFU_LW_ICE_OPTICS_BUG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LDIAGFORCING)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDIAGFORCING'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAPPROXLWUPDATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAPPROXLWUPDATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAPPROXSWUPDATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAPPROXSWUPDATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSWICEOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWICEOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSWLIQOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWLIQOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLWICEOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWICEOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLWLIQOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWLIQOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCCNL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCCNL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCCNO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCCNO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCNLND)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCNLND'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCCNSEA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCNSEA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RRE2DE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRE2DE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RMINICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RMINICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NMCLAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCLAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NMCLON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCLON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NMCLEV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCLEV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSWGASOPTICS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWGASOPTICS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NLWGASOPTICS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWGASOPTICS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NGASOPTICSSCHEME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGASOPTICSSCHEME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%KMODTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KMODTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NSWWVCONTINUUM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWWVCONTINUUM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NRTCALL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRTCALL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IRTCALLREF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IRTCALLREF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%IRTCALLCLN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IRTCALLCLN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LINTERPINCLOUDMEAN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LINTERPINCLOUDMEAN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LERAD1H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LERAD1H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LEPO3RA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LEPO3RA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LONEWSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LONEWSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LECSRAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECSRAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRRTM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRRTM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LSRTM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSRTM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LDIFFC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDIFFC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LHVOLCA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LHVOLCA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNEWAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEWAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LNOTROAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNOTROAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LRAYL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRAYL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LOPTRPROMA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LOPTRPROMA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LECO2VAR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECO2VAR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LHGHG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LHGHG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LESO4HIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LESO4HIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LETRACGMS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LETRACGMS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERCLIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERCLIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERVISI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERVISI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAER3D)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAER3D'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LVOLCSPEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVOLCSPEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LVOLCDAMP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVOLCDAMP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERADCLI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERADCLI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAERADJDU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERADJDU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LMANNERSSWUPDATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMANNERSSWUPDATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCENTREDTIMESZA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCENTREDTIMESZA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LAVERAGESZA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAVERAGESZA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LECOMPGRID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECOMPGRID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LUSEPRE2017RAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LUSEPRE2017RAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LDUSEASON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDUSEASON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LPERPET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LPERPET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LCLEAN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCLEAN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RAOVLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAOVLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RBOVLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RBOVLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LEDBUG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LEDBUG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RPERTOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPERTOZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RLWINHF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RLWINHF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSWINHF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSWINHF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RVOLCSPEC) * SIZE (YD%RVOLCSPEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVOLCSPEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RSIGAIR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIGAIR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RAESHSS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHSS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RAESHDU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHDU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RAESHOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHOM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RAESHBC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHBC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RAESHSU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHSU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%TRBKG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TRBKG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%STBKG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%STBKG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CGHGCLIMFILE) * LEN (YD%CGHGCLIMFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CGHGCLIMFILE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CGHGTIMESERIESFILE) * LEN (YD%CGHGTIMESERIESFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CGHGTIMESERIESFILE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%CSOLARIRRADIANCEFILE) * LEN (YD%CSOLARIRRADIANCEFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CSOLARIRRADIANCEFILE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RRATSEA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRATSEA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RRATLAND)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRATLAND'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RRATDRI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRATDRI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCADECOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCADECOR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RCBDECOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCBDECOR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%RFACDICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RFACDICE'
ENDIF
KSIZE = KSIZE + ISIZE
LCVDAESS = ALLOCATED (YD%CVDAESS)
IF (LCVDAESS) THEN
  ISIZE = KIND (YD%CVDAESS) * SIZE (YD%CVDAESS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAESS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAEDU = ALLOCATED (YD%CVDAEDU)
IF (LCVDAEDU) THEN
  ISIZE = KIND (YD%CVDAEDU) * SIZE (YD%CVDAEDU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAEDU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAEOM = ALLOCATED (YD%CVDAEOM)
IF (LCVDAEOM) THEN
  ISIZE = KIND (YD%CVDAEOM) * SIZE (YD%CVDAEOM)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAEOM'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAEBC = ALLOCATED (YD%CVDAEBC)
IF (LCVDAEBC) THEN
  ISIZE = KIND (YD%CVDAEBC) * SIZE (YD%CVDAEBC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAEBC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAESU = ALLOCATED (YD%CVDAESU)
IF (LCVDAESU) THEN
  ISIZE = KIND (YD%CVDAESU) * SIZE (YD%CVDAESU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAESU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (YD%CECRADARCH) * LEN (YD%CECRADARCH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CECRADARCH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%LECRADACC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECRADACC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (YD%NECRADLEN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NECRADLEN'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = SIZE_TSPECTRALPLANCK (YD%YSPECTPLANCK, CLPATH//'%YSPECTPLANCK', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YSPECTPLANCK'
ENDIF
END FUNCTION

END MODULE
