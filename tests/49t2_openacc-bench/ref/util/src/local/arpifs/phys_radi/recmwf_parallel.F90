
SUBROUTINE RECMWF_PARALLEL (YDDIMV, YDMODEL, YDCPG_OPTS, YDCPG_BNDS, KOZOCL, KMACCAERO, KAERO&
&, YD_PALBD, YD_PALBP, YD_PAPRS, YD_PAPRSF, YD_PNEB, YD_PQO3, YD_PQCO2, YD_PQCH4, YD_PQN2O,&
& YD_PQNO2, YD_PQC11, YD_PQC12, YD_PQC22, YD_PQCL4, YD_PAER, YD_PAERO, YD_PAEROCPL, YD_PDELP&
&, YD_PEMIS, YD_PMU0M, YD_PQ, YD_PQSAT, YD_PQICE, YD_PQLIQ, YD_PS, YD_PRR, YD_PLSM, YD_PT, YD_PTS&
&, YD_PEMTD, YD_PEMTU, YD_PTRSO, YD_PLWFC, YD_PLWFT, YD_PSWFC, YD_PSWFT, YD_PSFSWDIR, YD_PSFSWDIF&
&, YD_PFSDNN, YD_PFSDNV, YD_PCTRSO, YD_PCEMTR, YD_PTRSOD, YD_PTRSODIR, YD_PTRSODIF, YD_PPIZA_DST&
&, YD_PCGA_DST, YD_PTAUREL_DST, YD_PAERINDS, YD_PGELAM, YD_PGEMU, YD_PSWDIR, YD_PSWDIF, YD_PMU0LU&
&, YD_PALB, YD_PVRMOON, YD_PCLDROP, YSPP_RSWINHF, YSPP_RLWINHF)
USE TYPE_MODEL,ONLY:MODEL
USE YOMDIMV,ONLY:TDIMV

USE YOMHOOK,ONLY:DR_HOOK, JPHOOK, LHOOK
USE SPP_MOD_TYPE,ONLY:APPLY_SPP, TSPP_CONFIG_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (TDIMV), INTENT (IN)::YDDIMV
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
INTEGER (KIND=JPIM), INTENT (IN)::KOZOCL
INTEGER (KIND=JPIM), INTENT (IN)::KMACCAERO
INTEGER (KIND=JPIM), INTENT (IN)::KAERO
CLASS (FIELD_2RB), POINTER :: YD_PGELAM
REAL (KIND=JPRB), POINTER::PGELAM (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PGEMU
REAL (KIND=JPRB), POINTER::PGEMU (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALBD
REAL (KIND=JPRB), POINTER::PALBD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALBP
REAL (KIND=JPRB), POINTER::PALBP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAPRS
REAL (KIND=JPRB), POINTER::PAPRS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAPRSF
REAL (KIND=JPRB), POINTER::PAPRSF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEB
REAL (KIND=JPRB), POINTER::PNEB (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQO3
REAL (KIND=JPRB), POINTER::PQO3 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQCO2
REAL (KIND=JPRB), POINTER::PQCO2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQCH4
REAL (KIND=JPRB), POINTER::PQCH4 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQN2O
REAL (KIND=JPRB), POINTER::PQN2O (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQNO2
REAL (KIND=JPRB), POINTER::PQNO2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQC11
REAL (KIND=JPRB), POINTER::PQC11 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQC12
REAL (KIND=JPRB), POINTER::PQC12 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQC22
REAL (KIND=JPRB), POINTER::PQC22 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQCL4
REAL (KIND=JPRB), POINTER::PQCL4 (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PAER
REAL (KIND=JPRB), POINTER::PAER (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PAERO
REAL (KIND=JPRB), POINTER::PAERO (:,:,:,:)
CLASS (FIELD_5RB), POINTER :: YD_PAEROCPL
REAL (KIND=JPRB), POINTER::PAEROCPL (:,:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAERINDS
REAL (KIND=JPRB), POINTER::PAERINDS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDELP
REAL (KIND=JPRB), POINTER::PDELP (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PEMIS
REAL (KIND=JPRB), POINTER::PEMIS (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PMU0M
REAL (KIND=JPRB), POINTER::PMU0M (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQ
REAL (KIND=JPRB), POINTER::PQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQSAT
REAL (KIND=JPRB), POINTER::PQSAT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQICE
REAL (KIND=JPRB), POINTER::PQICE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLIQ
REAL (KIND=JPRB), POINTER::PQLIQ (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PLSM
REAL (KIND=JPRB), POINTER::PLSM (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PT
REAL (KIND=JPRB), POINTER::PT (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PTS
REAL (KIND=JPRB), POINTER::PTS (:,:)
CLASS (FIELD_4RB), POINTER :: YD_PPIZA_DST
REAL (KIND=JPRB), POINTER::PPIZA_DST (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PCGA_DST
REAL (KIND=JPRB), POINTER::PCGA_DST (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PTAUREL_DST
REAL (KIND=JPRB), POINTER::PTAUREL_DST (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEMTD
REAL (KIND=JPRB), POINTER::PEMTD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEMTU
REAL (KIND=JPRB), POINTER::PEMTU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTRSO
REAL (KIND=JPRB), POINTER::PTRSO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCTRSO
REAL (KIND=JPRB), POINTER::PCTRSO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCEMTR
REAL (KIND=JPRB), POINTER::PCEMTR (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PTRSOD
REAL (KIND=JPRB), POINTER::PTRSOD (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLWFC
REAL (KIND=JPRB), POINTER::PLWFC (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PLWFT
REAL (KIND=JPRB), POINTER::PLWFT (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSWFC
REAL (KIND=JPRB), POINTER::PSWFC (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PSWFT
REAL (KIND=JPRB), POINTER::PSWFT (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIR
REAL (KIND=JPRB), POINTER::PSFSWDIR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIF
REAL (KIND=JPRB), POINTER::PSFSWDIF (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFSDNN
REAL (KIND=JPRB), POINTER::PFSDNN (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFSDNV
REAL (KIND=JPRB), POINTER::PFSDNV (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTRSODIR
REAL (KIND=JPRB), POINTER::PTRSODIR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTRSODIF
REAL (KIND=JPRB), POINTER::PTRSODIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PS
REAL (KIND=JPRB), POINTER::PS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PRR
REAL (KIND=JPRB), POINTER::PRR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSWDIR
REAL (KIND=JPRB), POINTER::PSWDIR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSWDIF
REAL (KIND=JPRB), POINTER::PSWDIF (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PMU0LU
REAL (KIND=JPRB), POINTER::PMU0LU (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PALB
REAL (KIND=JPRB), POINTER::PALB (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PVRMOON
REAL (KIND=JPRB), POINTER::PVRMOON (:,:)
CLASS (FIELD_3RB), POINTER, OPTIONAL  :: YD_PCLDROP
REAL (KIND=JPRB), POINTER::PCLDROP (:,:,:)
TYPE (TSPP_CONFIG_TYPE), INTENT (INOUT), OPTIONAL::YSPP_RLWINHF
TYPE (TSPP_CONFIG_TYPE), INTENT (INOUT), OPTIONAL::YSPP_RSWINHF
CLASS (FIELD_3RB), POINTER :: YL_ZTH
REAL (KIND=JPRB), POINTER::ZTH (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZRAER
REAL (KIND=JPRB), POINTER::ZRAER (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRCLC
REAL (KIND=JPRB), POINTER::ZRCLC (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRMU0
REAL (KIND=JPRB), POINTER::ZRMU0 (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQIWP
REAL (KIND=JPRB), POINTER::ZQIWP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQLWP
REAL (KIND=JPRB), POINTER::ZQLWP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPQO3
REAL (KIND=JPRB), POINTER::ZPQO3 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQS
REAL (KIND=JPRB), POINTER::ZQS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQ
REAL (KIND=JPRB), POINTER::ZQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCLDROP
REAL (KIND=JPRB), POINTER::ZCLDROP (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZNTOP
REAL (KIND=JPRB), POINTER::ZNTOP (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZNBAS
REAL (KIND=JPRB), POINTER::ZNBAS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCCNO
REAL (KIND=JPRB), POINTER::ZCCNO (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCCNL
REAL (KIND=JPRB), POINTER::ZCCNL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPFRSODC
REAL (KIND=JPRB), POINTER::ZPFRSODC (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPFRTEDC
REAL (KIND=JPRB), POINTER::ZPFRTEDC (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRNO2
REAL (KIND=JPRB), POINTER::ZRNO2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRN2O
REAL (KIND=JPRB), POINTER::ZRN2O (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRCO2
REAL (KIND=JPRB), POINTER::ZRCO2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRCH4
REAL (KIND=JPRB), POINTER::ZRCH4 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRCL4
REAL (KIND=JPRB), POINTER::ZRCL4 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRC22
REAL (KIND=JPRB), POINTER::ZRC22 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRC12
REAL (KIND=JPRB), POINTER::ZRC12 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRC11
REAL (KIND=JPRB), POINTER::ZRC11 (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZPAERO
REAL (KIND=JPRB), POINTER::ZPAERO (:,:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPCDIR
REAL (KIND=JPRB), POINTER::ZPCDIR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPFDIF
REAL (KIND=JPRB), POINTER::ZPFDIF (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPFDIR
REAL (KIND=JPRB), POINTER::ZPFDIR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLUX_PAR_CLEAR
REAL (KIND=JPRB), POINTER::ZFLUX_PAR_CLEAR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLUX_PAR
REAL (KIND=JPRB), POINTER::ZFLUX_PAR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLUX_UV
REAL (KIND=JPRB), POINTER::ZFLUX_UV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFRTED
REAL (KIND=JPRB), POINTER::ZFRTED (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLWDERIVATIVE
REAL (KIND=JPRB), POINTER::ZLWDERIVATIVE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSWDIFFUSEBAND
REAL (KIND=JPRB), POINTER::ZSWDIFFUSEBAND (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSWDIRECTBAND
REAL (KIND=JPRB), POINTER::ZSWDIRECTBAND (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZEMIT
REAL (KIND=JPRB), POINTER::ZEMIT (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFCT
REAL (KIND=JPRB), POINTER::ZFCT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFCS
REAL (KIND=JPRB), POINTER::ZFCS (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSUDU
REAL (KIND=JPRB), POINTER::ZSUDU (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFRSOD
REAL (KIND=JPRB), POINTER::ZFRSOD (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZTINCF
REAL (KIND=JPRB), POINTER::ZTINCF (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPARCF
REAL (KIND=JPRB), POINTER::ZPARCF (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZUVDF
REAL (KIND=JPRB), POINTER::ZUVDF (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPARF
REAL (KIND=JPRB), POINTER::ZPARF (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRLWINHF
REAL (KIND=JPRB), POINTER::ZRLWINHF (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRSWINHF
REAL (KIND=JPRB), POINTER::ZRSWINHF (:,:)
INTEGER (KIND=JPIM)::JEMIS
INTEGER (KIND=JPIM)::JSW
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZSW
REAL (KIND=JPRB)::ZFRAC
CLASS (FIELD_2RB), POINTER :: YL_ZEMIW
REAL (KIND=JPRB), POINTER::ZEMIW (:,:)
REAL (KIND=JPRB)::ZCRAE
CLASS (FIELD_3RB), POINTER :: YL_ZSPECTRALEMISS
REAL (KIND=JPRB), POINTER::ZSPECTRALEMISS (:,:,:)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
#include "radlsw.intfb.h"
#include "abor1.intfb.h"
#include "radlswr.intfb.h"
#include "radiation_scheme_cpu.intfb.h"
#include "radiation_scheme_gpu.intfb.h"
#include "acralu.intfb.h"
#include "acralu_openacc.intfb.h"
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZUVDF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTINCF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSWDIRECTBAND, UBOUNDS=[YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD&
&%NSW, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSWDIFFUSEBAND, UBOUNDS=[YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD&
&%NSW, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSUDU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSPECTRALEMISS, UBOUNDS=[YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_RAD%YRERAD%NLWEMISS&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRSWINHF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRNO2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRN2O, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRMU0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRLWINHF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRCO2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRCLC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRCL4, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRCH4, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRC22, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRC12, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRC11, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRAER, UBOUNDS=[YDCPG_OPTS%KLON, 6, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQLWP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQIWP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPQO3, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFRTEDC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFRSODC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFDIR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFDIF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPCDIR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPARF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPARCF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPAERO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, KAERO, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNTOP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNBAS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLWDERIVATIVE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFRTED, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFRSOD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLUX_UV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLUX_PAR_CLEAR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLUX_PAR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFCT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFCS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZEMIW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZEMIT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCLDROP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCCNO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCCNL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)



ZCRAE=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE*(YDMODEL%YRML_PHY_RAD%YRERDI%RRAE+2.0_JPRB)

IF (PRESENT(YD_PCLDROP)) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF

IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:PREPARE')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAER => GET_HOST_DATA_RDONLY (YD_PAER)
  PAERO => GET_HOST_DATA_RDONLY (YD_PAERO)
  PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
  PEMIS => GET_HOST_DATA_RDONLY (YD_PEMIS)
  PMU0M => GET_HOST_DATA_RDONLY (YD_PMU0M)
  PNEB => GET_HOST_DATA_RDONLY (YD_PNEB)
  PQ => GET_HOST_DATA_RDONLY (YD_PQ)
  PQC11 => GET_HOST_DATA_RDONLY (YD_PQC11)
  PQC12 => GET_HOST_DATA_RDONLY (YD_PQC12)
  PQC22 => GET_HOST_DATA_RDONLY (YD_PQC22)
  PQCH4 => GET_HOST_DATA_RDONLY (YD_PQCH4)
  PQCL4 => GET_HOST_DATA_RDONLY (YD_PQCL4)
  PQCO2 => GET_HOST_DATA_RDONLY (YD_PQCO2)
  PQICE => GET_HOST_DATA_RDONLY (YD_PQICE)
  PQLIQ => GET_HOST_DATA_RDONLY (YD_PQLIQ)
  PQN2O => GET_HOST_DATA_RDONLY (YD_PQN2O)
  PQNO2 => GET_HOST_DATA_RDONLY (YD_PQNO2)
  PQO3 => GET_HOST_DATA_RDONLY (YD_PQO3)
  PQSAT => GET_HOST_DATA_RDONLY (YD_PQSAT)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  PTS => GET_HOST_DATA_RDONLY (YD_PTS)
  ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
  ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
  ZEMIW => GET_HOST_DATA_RDWR (YL_ZEMIW)
  ZNBAS => GET_HOST_DATA_RDWR (YL_ZNBAS)
  ZNTOP => GET_HOST_DATA_RDWR (YL_ZNTOP)
  ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
  ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
  ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
  ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
  ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
  ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
  ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
  ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
  ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
  ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
  ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
  ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
  ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
  ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
  ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
  ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
  ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
  ZSPECTRALEMISS => GET_HOST_DATA_RDWR (YL_ZSPECTRALEMISS)
  ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JEMIS, JLEV, JLON, ZFRAC) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF (KOZOCL==4.OR.KOZOCL==5.OR.KOZOCL==6) THEN
      ZRCH4 (:,:, JBLK)=PQCH4 (:,:, JBLK)
      ZRN2O (:,:, JBLK)=PQN2O (:,:, JBLK)
      ZRNO2 (:,:, JBLK)=PQNO2 (:,:, JBLK)
      ZRC11 (:,:, JBLK)=PQC11 (:,:, JBLK)
      ZRC12 (:,:, JBLK)=PQC12 (:,:, JBLK)
      ZRC22 (:,:, JBLK)=PQC22 (:,:, JBLK)
      ZRCL4 (:,:, JBLK)=PQCL4 (:,:, JBLK)
      ZRCO2 (:,:, JBLK)=PQCO2 (:,:, JBLK)
    ELSE
      ZRCH4 (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCH4
      ZRN2O (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RN2O
      ZRNO2 (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RNO2
      ZRC11 (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC11
      ZRC12 (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC12
      ZRC22 (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC22
      ZRCL4 (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCCL4
      ZRCO2 (:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCARDI
    ENDIF


    IF (KAERO>0) THEN
      ZPAERO (:,:,:, JBLK)=PAERO (:,:,:, JBLK)
    ELSE
      ZPAERO (:,:,:, JBLK)=0.0_JPRB
    ENDIF

    ZRAER (:,:,:, JBLK)=0.0_JPRB
    ZNBAS (:, JBLK)=1.0_JPRB
    ZNTOP (:, JBLK)=1.0_JPRB
    ZCCNL (:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RCCNLND
    ZCCNO (:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RCCNSEA

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZPQO3 (JLON, JLEV, JBLK)=PQO3 (JLON, JLEV, JBLK)*PDELP (JLON, JLEV, JBLK)
        ZRCLC (JLON, JLEV, JBLK)=MAX (0.0_JPRB, MIN (1.0_JPRB, PNEB (JLON, JLEV, JBLK)))

        IF (YDMODEL%YRML_PHY_MF%YRPARAR%LICERAD) THEN
          ZFRAC=PQICE (JLON, JLEV, JBLK)/(PQLIQ (JLON, JLEV, JBLK)+PQICE (JLON, JLEV, JBLK)+1.0E-15_JPRB)
          ZRCLC (JLON, JLEV, JBLK)=ZFRAC+(1.0_JPRB-ZFRAC)*ZRCLC (JLON, JLEV, JBLK)
        ENDIF


        IF (ZRCLC (JLON, JLEV, JBLK)>YDMODEL%YRML_PHY_RAD%YRERDI%REPCLC) THEN
          ZQLWP (JLON, JLEV, JBLK)=PQLIQ (JLON, JLEV, JBLK)
          ZQIWP (JLON, JLEV, JBLK)=PQICE (JLON, JLEV, JBLK)
        ELSE
          ZQLWP (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O*ZRCLC (JLON, JLEV, JBLK)
          ZQIWP (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O*ZRCLC (JLON, JLEV, JBLK)
        ENDIF

        ZQS (JLON, JLEV, JBLK)=MAX (2.0_JPRB*YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O, PQSAT (JLON, JLEV, JBLK))
        ZQ (JLON, JLEV, JBLK)=MAX (YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O, MIN (PQ (JLON, JLEV&
        &, JBLK), ZQS (JLON, JLEV, JBLK)*(1.0_JPRB-YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O)))

        IF (YDMODEL%YRML_PHY_MF%YRPARAR%LQVTOP) THEN
          ZFRAC=MIN (1._JPRB, PAPRSF (JLON, JLEV, JBLK)/YDMODEL%YRML_PHY_MF%YRPARAR%GQVPLIM)
          ZQ (JLON, JLEV, JBLK)=ZFRAC*MAX (YDMODEL%YRML_PHY_MF%YRPARAR%XCQVR*PQSAT (JLON, JLEV,&
          & JBLK), ZQ (JLON, JLEV, JBLK))+(1._JPRB-ZFRAC)*YDMODEL%YRML_PHY_MF%YRPARAR%GQVTOP
        ENDIF

      ENDDO

    ENDDO


    DO JEMIS=1, YDMODEL%YRML_PHY_RAD%YRERAD%NLWEMISS
      ZSPECTRALEMISS (:, JEMIS, JBLK)=PEMIS (:, JBLK)
    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZEMIW (JLON, JBLK)=PEMIS (JLON, JBLK)
    ENDDO


    IF (YDMODEL%YRML_PHY_RAD%YRERAD%NAER==0) THEN
      ZRAER(:,:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YREAERD%RCAEROS
    ELSE

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROLAN)  THEN
            ZRAER (JLON, 1, JLEV, JBLK)=PAER (JLON, JLEV, 1, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSEA)  THEN
            ZRAER (JLON, 2, JLEV, JBLK)=PAER (JLON, JLEV, 2, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAERODES)  THEN
            ZRAER (JLON, 3, JLEV, JBLK)=PAER (JLON, JLEV, 3, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSOO)  THEN
            ZRAER (JLON, 4, JLEV, JBLK)=PAER (JLON, JLEV, 4, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROVOL)  THEN
            ZRAER (JLON, 5, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YREAERD%RCAEROS
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSUL)  THEN
            ZRAER (JLON, 6, JLEV, JBLK)=PAER (JLON, JLEV, 6, JBLK)
          ENDIF

        ENDDO

      ENDDO

    ENDIF


    DO JLEV=2, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZTH (JLON, JLEV-1, JBLK)=(PT (JLON, JLEV-1, JBLK)*PAPRSF (JLON, JLEV-1, JBLK)*(PAPRSF&
        & (JLON, JLEV, JBLK)-PAPRS (JLON, JLEV-1, JBLK))+PT (JLON, JLEV, JBLK)*PAPRSF (JLON, JLEV&
        &, JBLK)*(PAPRS (JLON, JLEV-1, JBLK)-PAPRSF (JLON, JLEV-1, JBLK)))*(1.0_JPRB/(PAPRS (JLON&
        &, JLEV-1, JBLK)*(PAPRSF (JLON, JLEV, JBLK)-PAPRSF (JLON, JLEV-1, JBLK))))
      ENDDO

    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZTH (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PTS (JLON, JBLK)
      ZTH (JLON, 0, JBLK)=PT (JLON, 1, JBLK)-PAPRSF (JLON, 1, JBLK)*(PT (JLON, 1, JBLK&
      &)-ZTH (JLON, 1, JBLK))/(PAPRSF (JLON, 1, JBLK)-PAPRS (JLON, 1, JBLK))
    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

      IF (PMU0M (JLON, JBLK)>1.E-10_JPRB) THEN
        ZRMU0 (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE/(SQRT&
        & (PMU0M (JLON, JBLK)**2+ZCRAE)-PMU0M (JLON, JBLK))
      ELSE
        ZRMU0 (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE/SQRT (ZCRAE)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:PREPARE')) THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PAERO => GET_HOST_DATA_RDWR (YD_PAERO)
    PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PEMIS => GET_HOST_DATA_RDWR (YD_PEMIS)
    PMU0M => GET_HOST_DATA_RDWR (YD_PMU0M)
    PNEB => GET_HOST_DATA_RDWR (YD_PNEB)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQC11 => GET_HOST_DATA_RDWR (YD_PQC11)
    PQC12 => GET_HOST_DATA_RDWR (YD_PQC12)
    PQC22 => GET_HOST_DATA_RDWR (YD_PQC22)
    PQCH4 => GET_HOST_DATA_RDWR (YD_PQCH4)
    PQCL4 => GET_HOST_DATA_RDWR (YD_PQCL4)
    PQCO2 => GET_HOST_DATA_RDWR (YD_PQCO2)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLIQ => GET_HOST_DATA_RDWR (YD_PQLIQ)
    PQN2O => GET_HOST_DATA_RDWR (YD_PQN2O)
    PQNO2 => GET_HOST_DATA_RDWR (YD_PQNO2)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    PQSAT => GET_HOST_DATA_RDWR (YD_PQSAT)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTS => GET_HOST_DATA_RDWR (YD_PTS)
    ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
    ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
    ZEMIW => GET_HOST_DATA_RDWR (YL_ZEMIW)
    ZNBAS => GET_HOST_DATA_RDWR (YL_ZNBAS)
    ZNTOP => GET_HOST_DATA_RDWR (YL_ZNTOP)
    ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
    ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
    ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
    ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
    ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
    ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
    ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
    ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
    ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
    ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
    ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
    ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
    ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
    ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
    ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
    ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
    ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
    ZSPECTRALEMISS => GET_HOST_DATA_RDWR (YL_ZSPECTRALEMISS)
    ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAER => NULL ()
  PAERO => NULL ()
  PAPRS => NULL ()
  PAPRSF => NULL ()
  PDELP => NULL ()
  PEMIS => NULL ()
  PMU0M => NULL ()
  PNEB => NULL ()
  PQ => NULL ()
  PQC11 => NULL ()
  PQC12 => NULL ()
  PQC22 => NULL ()
  PQCH4 => NULL ()
  PQCL4 => NULL ()
  PQCO2 => NULL ()
  PQICE => NULL ()
  PQLIQ => NULL ()
  PQN2O => NULL ()
  PQNO2 => NULL ()
  PQO3 => NULL ()
  PQSAT => NULL ()
  PT => NULL ()
  PTS => NULL ()
  ZCCNL => NULL ()
  ZCCNO => NULL ()
  ZEMIW => NULL ()
  ZNBAS => NULL ()
  ZNTOP => NULL ()
  ZPAERO => NULL ()
  ZPQO3 => NULL ()
  ZQ => NULL ()
  ZQIWP => NULL ()
  ZQLWP => NULL ()
  ZQS => NULL ()
  ZRAER => NULL ()
  ZRC11 => NULL ()
  ZRC12 => NULL ()
  ZRC22 => NULL ()
  ZRCH4 => NULL ()
  ZRCL4 => NULL ()
  ZRCLC => NULL ()
  ZRCO2 => NULL ()
  ZRMU0 => NULL ()
  ZRN2O => NULL ()
  ZRNO2 => NULL ()
  ZSPECTRALEMISS => NULL ()
  ZTH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','RECMWF_PARALLEL:PREPARE')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAER => GET_HOST_DATA_RDONLY (YD_PAER)
  PAERO => GET_HOST_DATA_RDONLY (YD_PAERO)
  PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
  PEMIS => GET_HOST_DATA_RDONLY (YD_PEMIS)
  PMU0M => GET_HOST_DATA_RDONLY (YD_PMU0M)
  PNEB => GET_HOST_DATA_RDONLY (YD_PNEB)
  PQ => GET_HOST_DATA_RDONLY (YD_PQ)
  PQC11 => GET_HOST_DATA_RDONLY (YD_PQC11)
  PQC12 => GET_HOST_DATA_RDONLY (YD_PQC12)
  PQC22 => GET_HOST_DATA_RDONLY (YD_PQC22)
  PQCH4 => GET_HOST_DATA_RDONLY (YD_PQCH4)
  PQCL4 => GET_HOST_DATA_RDONLY (YD_PQCL4)
  PQCO2 => GET_HOST_DATA_RDONLY (YD_PQCO2)
  PQICE => GET_HOST_DATA_RDONLY (YD_PQICE)
  PQLIQ => GET_HOST_DATA_RDONLY (YD_PQLIQ)
  PQN2O => GET_HOST_DATA_RDONLY (YD_PQN2O)
  PQNO2 => GET_HOST_DATA_RDONLY (YD_PQNO2)
  PQO3 => GET_HOST_DATA_RDONLY (YD_PQO3)
  PQSAT => GET_HOST_DATA_RDONLY (YD_PQSAT)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  PTS => GET_HOST_DATA_RDONLY (YD_PTS)
  ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
  ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
  ZEMIW => GET_HOST_DATA_RDWR (YL_ZEMIW)
  ZNBAS => GET_HOST_DATA_RDWR (YL_ZNBAS)
  ZNTOP => GET_HOST_DATA_RDWR (YL_ZNTOP)
  ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
  ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
  ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
  ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
  ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
  ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
  ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
  ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
  ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
  ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
  ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
  ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
  ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
  ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
  ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
  ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
  ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
  ZSPECTRALEMISS => GET_HOST_DATA_RDWR (YL_ZSPECTRALEMISS)
  ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JEMIS, JLEV, JLON, YLCPG_BNDS, ZFRAC)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF (KOZOCL==4.OR.KOZOCL==5.OR.KOZOCL==6) THEN
        ZRCH4 (JLON,:, JBLK)=PQCH4 (JLON,:, JBLK)
        ZRN2O (JLON,:, JBLK)=PQN2O (JLON,:, JBLK)
        ZRNO2 (JLON,:, JBLK)=PQNO2 (JLON,:, JBLK)
        ZRC11 (JLON,:, JBLK)=PQC11 (JLON,:, JBLK)
        ZRC12 (JLON,:, JBLK)=PQC12 (JLON,:, JBLK)
        ZRC22 (JLON,:, JBLK)=PQC22 (JLON,:, JBLK)
        ZRCL4 (JLON,:, JBLK)=PQCL4 (JLON,:, JBLK)
        ZRCO2 (JLON,:, JBLK)=PQCO2 (JLON,:, JBLK)
      ELSE
        ZRCH4 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCH4
        ZRN2O (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RN2O
        ZRNO2 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RNO2
        ZRC11 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC11
        ZRC12 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC12
        ZRC22 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC22
        ZRCL4 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCCL4
        ZRCO2 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCARDI
      ENDIF


      IF (KAERO>0) THEN
        ZPAERO (JLON,:,:, JBLK)=PAERO (JLON,:,:, JBLK)
      ELSE
        ZPAERO (JLON,:,:, JBLK)=0.0_JPRB
      ENDIF

      ZRAER (JLON,:,:, JBLK)=0.0_JPRB
      ZNBAS (JLON, JBLK)=1.0_JPRB
      ZNTOP (JLON, JBLK)=1.0_JPRB
      ZCCNL (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RCCNLND
      ZCCNO (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RCCNSEA

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZPQO3 (JLON, JLEV, JBLK)=PQO3 (JLON, JLEV, JBLK)*PDELP (JLON, JLEV, JBLK)
        ZRCLC (JLON, JLEV, JBLK)=MAX (0.0_JPRB, MIN (1.0_JPRB, PNEB (JLON, JLEV, JBLK)))

        IF (YDMODEL%YRML_PHY_MF%YRPARAR%LICERAD) THEN
          ZFRAC=PQICE (JLON, JLEV, JBLK)/(PQLIQ (JLON, JLEV, JBLK)+PQICE (JLON, JLEV, JBLK)+1.0E-15_JPRB)
          ZRCLC (JLON, JLEV, JBLK)=ZFRAC+(1.0_JPRB-ZFRAC)*ZRCLC (JLON, JLEV, JBLK)
        ENDIF


        IF (ZRCLC (JLON, JLEV, JBLK)>YDMODEL%YRML_PHY_RAD%YRERDI%REPCLC) THEN
          ZQLWP (JLON, JLEV, JBLK)=PQLIQ (JLON, JLEV, JBLK)
          ZQIWP (JLON, JLEV, JBLK)=PQICE (JLON, JLEV, JBLK)
        ELSE
          ZQLWP (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O*ZRCLC (JLON, JLEV, JBLK)
          ZQIWP (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O*ZRCLC (JLON, JLEV, JBLK)
        ENDIF

        ZQS (JLON, JLEV, JBLK)=MAX (2.0_JPRB*YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O, PQSAT (JLON, JLEV, JBLK))
        ZQ (JLON, JLEV, JBLK)=MAX (YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O, MIN (PQ (JLON, JLEV&
        &, JBLK), ZQS (JLON, JLEV, JBLK)*(1.0_JPRB-YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O)))

        IF (YDMODEL%YRML_PHY_MF%YRPARAR%LQVTOP) THEN
          ZFRAC=MIN (1._JPRB, PAPRSF (JLON, JLEV, JBLK)/YDMODEL%YRML_PHY_MF%YRPARAR%GQVPLIM)
          ZQ (JLON, JLEV, JBLK)=ZFRAC*MAX (YDMODEL%YRML_PHY_MF%YRPARAR%XCQVR*PQSAT (JLON, JLEV,&
          & JBLK), ZQ (JLON, JLEV, JBLK))+(1._JPRB-ZFRAC)*YDMODEL%YRML_PHY_MF%YRPARAR%GQVTOP
        ENDIF

      
      ENDDO


      DO JEMIS=1, YDMODEL%YRML_PHY_RAD%YRERAD%NLWEMISS
        ZSPECTRALEMISS (JLON, JEMIS, JBLK)=PEMIS (JLON, JBLK)
      ENDDO

      
      ZEMIW (JLON, JBLK)=PEMIS (JLON, JBLK)

      

      IF (YDMODEL%YRML_PHY_RAD%YRERAD%NAER==0) THEN
        ZRAER(JLON,:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YREAERD%RCAEROS
      ELSE

        DO JLEV=1, YDCPG_OPTS%KFLEVG

          

          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROLAN)  THEN
            ZRAER (JLON, 1, JLEV, JBLK)=PAER (JLON, JLEV, 1, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSEA)  THEN
            ZRAER (JLON, 2, JLEV, JBLK)=PAER (JLON, JLEV, 2, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAERODES)  THEN
            ZRAER (JLON, 3, JLEV, JBLK)=PAER (JLON, JLEV, 3, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSOO)  THEN
            ZRAER (JLON, 4, JLEV, JBLK)=PAER (JLON, JLEV, 4, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROVOL)  THEN
            ZRAER (JLON, 5, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YREAERD%RCAEROS
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSUL)  THEN
            ZRAER (JLON, 6, JLEV, JBLK)=PAER (JLON, JLEV, 6, JBLK)
          ENDIF

        
        ENDDO

      ENDIF


      DO JLEV=2, YDCPG_OPTS%KFLEVG
        
        ZTH (JLON, JLEV-1, JBLK)=(PT (JLON, JLEV-1, JBLK)*PAPRSF (JLON, JLEV-1, JBLK)*(PAPRSF&
        & (JLON, JLEV, JBLK)-PAPRS (JLON, JLEV-1, JBLK))+PT (JLON, JLEV, JBLK)*PAPRSF (JLON, JLEV&
        &, JBLK)*(PAPRS (JLON, JLEV-1, JBLK)-PAPRSF (JLON, JLEV-1, JBLK)))*(1.0_JPRB/(PAPRS (JLON&
        &, JLEV-1, JBLK)*(PAPRSF (JLON, JLEV, JBLK)-PAPRSF (JLON, JLEV-1, JBLK))))
      
      ENDDO

      
      ZTH (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PTS (JLON, JBLK)
      ZTH (JLON, 0, JBLK)=PT (JLON, 1, JBLK)-PAPRSF (JLON, 1, JBLK)*(PT (JLON, 1, JBLK&
      &)-ZTH (JLON, 1, JBLK))/(PAPRSF (JLON, 1, JBLK)-PAPRS (JLON, 1, JBLK))

      

      

      IF (PMU0M (JLON, JBLK)>1.E-10_JPRB) THEN
        ZRMU0 (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE/(SQRT&
        & (PMU0M (JLON, JBLK)**2+ZCRAE)-PMU0M (JLON, JBLK))
      ELSE
        ZRMU0 (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE/SQRT (ZCRAE)
      ENDIF

    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:PREPARE')) THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PAERO => GET_HOST_DATA_RDWR (YD_PAERO)
    PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PEMIS => GET_HOST_DATA_RDWR (YD_PEMIS)
    PMU0M => GET_HOST_DATA_RDWR (YD_PMU0M)
    PNEB => GET_HOST_DATA_RDWR (YD_PNEB)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQC11 => GET_HOST_DATA_RDWR (YD_PQC11)
    PQC12 => GET_HOST_DATA_RDWR (YD_PQC12)
    PQC22 => GET_HOST_DATA_RDWR (YD_PQC22)
    PQCH4 => GET_HOST_DATA_RDWR (YD_PQCH4)
    PQCL4 => GET_HOST_DATA_RDWR (YD_PQCL4)
    PQCO2 => GET_HOST_DATA_RDWR (YD_PQCO2)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLIQ => GET_HOST_DATA_RDWR (YD_PQLIQ)
    PQN2O => GET_HOST_DATA_RDWR (YD_PQN2O)
    PQNO2 => GET_HOST_DATA_RDWR (YD_PQNO2)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    PQSAT => GET_HOST_DATA_RDWR (YD_PQSAT)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTS => GET_HOST_DATA_RDWR (YD_PTS)
    ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
    ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
    ZEMIW => GET_HOST_DATA_RDWR (YL_ZEMIW)
    ZNBAS => GET_HOST_DATA_RDWR (YL_ZNBAS)
    ZNTOP => GET_HOST_DATA_RDWR (YL_ZNTOP)
    ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
    ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
    ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
    ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
    ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
    ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
    ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
    ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
    ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
    ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
    ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
    ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
    ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
    ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
    ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
    ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
    ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
    ZSPECTRALEMISS => GET_HOST_DATA_RDWR (YL_ZSPECTRALEMISS)
    ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAER => NULL ()
  PAERO => NULL ()
  PAPRS => NULL ()
  PAPRSF => NULL ()
  PDELP => NULL ()
  PEMIS => NULL ()
  PMU0M => NULL ()
  PNEB => NULL ()
  PQ => NULL ()
  PQC11 => NULL ()
  PQC12 => NULL ()
  PQC22 => NULL ()
  PQCH4 => NULL ()
  PQCL4 => NULL ()
  PQCO2 => NULL ()
  PQICE => NULL ()
  PQLIQ => NULL ()
  PQN2O => NULL ()
  PQNO2 => NULL ()
  PQO3 => NULL ()
  PQSAT => NULL ()
  PT => NULL ()
  PTS => NULL ()
  ZCCNL => NULL ()
  ZCCNO => NULL ()
  ZEMIW => NULL ()
  ZNBAS => NULL ()
  ZNTOP => NULL ()
  ZPAERO => NULL ()
  ZPQO3 => NULL ()
  ZQ => NULL ()
  ZQIWP => NULL ()
  ZQLWP => NULL ()
  ZQS => NULL ()
  ZRAER => NULL ()
  ZRC11 => NULL ()
  ZRC12 => NULL ()
  ZRC22 => NULL ()
  ZRCH4 => NULL ()
  ZRCL4 => NULL ()
  ZRCLC => NULL ()
  ZRCO2 => NULL ()
  ZRMU0 => NULL ()
  ZRN2O => NULL ()
  ZRNO2 => NULL ()
  ZSPECTRALEMISS => NULL ()
  ZTH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','RECMWF_PARALLEL:PREPARE')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAER => GET_DEVICE_DATA_RDONLY (YD_PAER)
  PAERO => GET_DEVICE_DATA_RDONLY (YD_PAERO)
  PAPRS => GET_DEVICE_DATA_RDONLY (YD_PAPRS)
  PAPRSF => GET_DEVICE_DATA_RDONLY (YD_PAPRSF)
  PDELP => GET_DEVICE_DATA_RDONLY (YD_PDELP)
  PEMIS => GET_DEVICE_DATA_RDONLY (YD_PEMIS)
  PMU0M => GET_DEVICE_DATA_RDONLY (YD_PMU0M)
  PNEB => GET_DEVICE_DATA_RDONLY (YD_PNEB)
  PQ => GET_DEVICE_DATA_RDONLY (YD_PQ)
  PQC11 => GET_DEVICE_DATA_RDONLY (YD_PQC11)
  PQC12 => GET_DEVICE_DATA_RDONLY (YD_PQC12)
  PQC22 => GET_DEVICE_DATA_RDONLY (YD_PQC22)
  PQCH4 => GET_DEVICE_DATA_RDONLY (YD_PQCH4)
  PQCL4 => GET_DEVICE_DATA_RDONLY (YD_PQCL4)
  PQCO2 => GET_DEVICE_DATA_RDONLY (YD_PQCO2)
  PQICE => GET_DEVICE_DATA_RDONLY (YD_PQICE)
  PQLIQ => GET_DEVICE_DATA_RDONLY (YD_PQLIQ)
  PQN2O => GET_DEVICE_DATA_RDONLY (YD_PQN2O)
  PQNO2 => GET_DEVICE_DATA_RDONLY (YD_PQNO2)
  PQO3 => GET_DEVICE_DATA_RDONLY (YD_PQO3)
  PQSAT => GET_DEVICE_DATA_RDONLY (YD_PQSAT)
  PT => GET_DEVICE_DATA_RDONLY (YD_PT)
  PTS => GET_DEVICE_DATA_RDONLY (YD_PTS)
  ZCCNL => GET_DEVICE_DATA_RDWR (YL_ZCCNL)
  ZCCNO => GET_DEVICE_DATA_RDWR (YL_ZCCNO)
  ZEMIW => GET_DEVICE_DATA_RDWR (YL_ZEMIW)
  ZNBAS => GET_DEVICE_DATA_RDWR (YL_ZNBAS)
  ZNTOP => GET_DEVICE_DATA_RDWR (YL_ZNTOP)
  ZPAERO => GET_DEVICE_DATA_RDWR (YL_ZPAERO)
  ZPQO3 => GET_DEVICE_DATA_RDWR (YL_ZPQO3)
  ZQ => GET_DEVICE_DATA_RDWR (YL_ZQ)
  ZQIWP => GET_DEVICE_DATA_RDWR (YL_ZQIWP)
  ZQLWP => GET_DEVICE_DATA_RDWR (YL_ZQLWP)
  ZQS => GET_DEVICE_DATA_RDWR (YL_ZQS)
  ZRAER => GET_DEVICE_DATA_RDWR (YL_ZRAER)
  ZRC11 => GET_DEVICE_DATA_RDWR (YL_ZRC11)
  ZRC12 => GET_DEVICE_DATA_RDWR (YL_ZRC12)
  ZRC22 => GET_DEVICE_DATA_RDWR (YL_ZRC22)
  ZRCH4 => GET_DEVICE_DATA_RDWR (YL_ZRCH4)
  ZRCL4 => GET_DEVICE_DATA_RDWR (YL_ZRCL4)
  ZRCLC => GET_DEVICE_DATA_RDWR (YL_ZRCLC)
  ZRCO2 => GET_DEVICE_DATA_RDWR (YL_ZRCO2)
  ZRMU0 => GET_DEVICE_DATA_RDWR (YL_ZRMU0)
  ZRN2O => GET_DEVICE_DATA_RDWR (YL_ZRN2O)
  ZRNO2 => GET_DEVICE_DATA_RDWR (YL_ZRNO2)
  ZSPECTRALEMISS => GET_DEVICE_DATA_RDWR (YL_ZSPECTRALEMISS)
  ZTH => GET_DEVICE_DATA_RDWR (YL_ZTH)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PAER, PAERO, PAPRS, PAPRSF, PDELP, PEMIS, PMU0M, PNEB, PQ, PQC11, PQC12, &
    !$ACC&         PQC22, PQCH4, PQCL4, PQCO2, PQICE, PQLIQ, PQN2O, PQNO2, PQO3, PQSAT, PT, &
    !$ACC&         PTS, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZCCNL, ZCCNO, ZEMIW, &
    !$ACC&         ZNBAS, ZNTOP, ZPAERO, ZPQO3, ZQ, ZQIWP, ZQLWP, ZQS, ZRAER, ZRC11, ZRC12, &
    !$ACC&         ZRC22, ZRCH4, ZRCL4, ZRCLC, ZRCO2, ZRMU0, ZRN2O, ZRNO2, ZSPECTRALEMISS, &
    !$ACC&         ZTH) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JEMIS, JLEV, JLON, YLCPG_BNDS, ZFRAC) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF (KOZOCL==4.OR.KOZOCL==5.OR.KOZOCL==6) THEN
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRCH4 (:,:, JBLK), PQCH4 (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRN2O (:,:, JBLK), PQN2O (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRNO2 (:,:, JBLK), PQNO2 (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRC11 (:,:, JBLK), PQC11 (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRC12 (:,:, JBLK), PQC12 (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRC22 (:,:, JBLK), PQC22 (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRCL4 (:,:, JBLK), PQCL4 (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZRCO2 (:,:, JBLK), PQCO2 (:,:, JBLK))
      ELSE
        ZRCH4 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCH4
        ZRN2O (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RN2O
        ZRNO2 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RNO2
        ZRC11 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC11
        ZRC12 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC12
        ZRC22 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCFC22
        ZRCL4 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCCL4
        ZRCO2 (JLON,:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RCARDI
      ENDIF


      IF (KAERO>0) THEN
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZPAERO (:,:,:, JBLK), PAERO (:,:,:, JBLK))
      ELSE
        ZPAERO (JLON,:,:, JBLK)=0.0_JPRB
      ENDIF

      ZRAER (JLON,:,:, JBLK)=0.0_JPRB
      ZNBAS (JLON, JBLK)=1.0_JPRB
      ZNTOP (JLON, JBLK)=1.0_JPRB
      ZCCNL (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RCCNLND
      ZCCNO (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RCCNSEA

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZPQO3 (JLON, JLEV, JBLK)=PQO3 (JLON, JLEV, JBLK)*PDELP (JLON, JLEV, JBLK)
        ZRCLC (JLON, JLEV, JBLK)=MAX (0.0_JPRB, MIN (1.0_JPRB, PNEB (JLON, JLEV, JBLK)))

        IF (YDMODEL%YRML_PHY_MF%YRPARAR%LICERAD) THEN
          ZFRAC=PQICE (JLON, JLEV, JBLK)/(PQLIQ (JLON, JLEV, JBLK)+PQICE (JLON, JLEV, JBLK)+1.0E-15_JPRB)
          ZRCLC (JLON, JLEV, JBLK)=ZFRAC+(1.0_JPRB-ZFRAC)*ZRCLC (JLON, JLEV, JBLK)
        ENDIF


        IF (ZRCLC (JLON, JLEV, JBLK)>YDMODEL%YRML_PHY_RAD%YRERDI%REPCLC) THEN
          ZQLWP (JLON, JLEV, JBLK)=PQLIQ (JLON, JLEV, JBLK)
          ZQIWP (JLON, JLEV, JBLK)=PQICE (JLON, JLEV, JBLK)
        ELSE
          ZQLWP (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O*ZRCLC (JLON, JLEV, JBLK)
          ZQIWP (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O*ZRCLC (JLON, JLEV, JBLK)
        ENDIF

        ZQS (JLON, JLEV, JBLK)=MAX (2.0_JPRB*YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O, PQSAT (JLON, JLEV, JBLK))
        ZQ (JLON, JLEV, JBLK)=MAX (YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O, MIN (PQ (JLON, JLEV&
        &, JBLK), ZQS (JLON, JLEV, JBLK)*(1.0_JPRB-YDMODEL%YRML_PHY_RAD%YRERDI%REPH2O)))

        IF (YDMODEL%YRML_PHY_MF%YRPARAR%LQVTOP) THEN
          ZFRAC=MIN (1._JPRB, PAPRSF (JLON, JLEV, JBLK)/YDMODEL%YRML_PHY_MF%YRPARAR%GQVPLIM)
          ZQ (JLON, JLEV, JBLK)=ZFRAC*MAX (YDMODEL%YRML_PHY_MF%YRPARAR%XCQVR*PQSAT (JLON, JLEV,&
          & JBLK), ZQ (JLON, JLEV, JBLK))+(1._JPRB-ZFRAC)*YDMODEL%YRML_PHY_MF%YRPARAR%GQVTOP
        ENDIF

      
      ENDDO


      DO JEMIS=1, YDMODEL%YRML_PHY_RAD%YRERAD%NLWEMISS
        ZSPECTRALEMISS (JLON, JEMIS, JBLK)=PEMIS (JLON, JBLK)
      ENDDO

      
      ZEMIW (JLON, JBLK)=PEMIS (JLON, JBLK)

      

      IF (YDMODEL%YRML_PHY_RAD%YRERAD%NAER==0) THEN
        ZRAER(JLON,:,:, JBLK)=YDMODEL%YRML_PHY_RAD%YREAERD%RCAEROS
      ELSE

        DO JLEV=1, YDCPG_OPTS%KFLEVG

          

          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROLAN)  THEN
            ZRAER (JLON, 1, JLEV, JBLK)=PAER (JLON, JLEV, 1, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSEA)  THEN
            ZRAER (JLON, 2, JLEV, JBLK)=PAER (JLON, JLEV, 2, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAERODES)  THEN
            ZRAER (JLON, 3, JLEV, JBLK)=PAER (JLON, JLEV, 3, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSOO)  THEN
            ZRAER (JLON, 4, JLEV, JBLK)=PAER (JLON, JLEV, 4, JBLK)
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROVOL)  THEN
            ZRAER (JLON, 5, JLEV, JBLK)=YDMODEL%YRML_PHY_RAD%YREAERD%RCAEROS
          ENDIF


          IF (YDMODEL%YRML_PHY_MF%YRPHY%LAEROSUL)  THEN
            ZRAER (JLON, 6, JLEV, JBLK)=PAER (JLON, JLEV, 6, JBLK)
          ENDIF

        
        ENDDO

      ENDIF


      DO JLEV=2, YDCPG_OPTS%KFLEVG
        
        ZTH (JLON, JLEV-1, JBLK)=(PT (JLON, JLEV-1, JBLK)*PAPRSF (JLON, JLEV-1, JBLK)*(PAPRSF&
        & (JLON, JLEV, JBLK)-PAPRS (JLON, JLEV-1, JBLK))+PT (JLON, JLEV, JBLK)*PAPRSF (JLON, JLEV&
        &, JBLK)*(PAPRS (JLON, JLEV-1, JBLK)-PAPRSF (JLON, JLEV-1, JBLK)))*(1.0_JPRB/(PAPRS (JLON&
        &, JLEV-1, JBLK)*(PAPRSF (JLON, JLEV, JBLK)-PAPRSF (JLON, JLEV-1, JBLK))))
      
      ENDDO

      
      ZTH (JLON, YDCPG_OPTS%KFLEVG, JBLK)=PTS (JLON, JBLK)
      ZTH (JLON, 0, JBLK)=PT (JLON, 1, JBLK)-PAPRSF (JLON, 1, JBLK)*(PT (JLON, 1, JBLK&
      &)-ZTH (JLON, 1, JBLK))/(PAPRSF (JLON, 1, JBLK)-PAPRS (JLON, 1, JBLK))

      

      

      IF (PMU0M (JLON, JBLK)>1.E-10_JPRB) THEN
        ZRMU0 (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE/(SQRT&
        & (PMU0M (JLON, JBLK)**2+ZCRAE)-PMU0M (JLON, JBLK))
      ELSE
        ZRMU0 (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERDI%RRAE/SQRT (ZCRAE)
      ENDIF

    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:PREPARE')) THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PAERO => GET_HOST_DATA_RDWR (YD_PAERO)
    PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PEMIS => GET_HOST_DATA_RDWR (YD_PEMIS)
    PMU0M => GET_HOST_DATA_RDWR (YD_PMU0M)
    PNEB => GET_HOST_DATA_RDWR (YD_PNEB)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQC11 => GET_HOST_DATA_RDWR (YD_PQC11)
    PQC12 => GET_HOST_DATA_RDWR (YD_PQC12)
    PQC22 => GET_HOST_DATA_RDWR (YD_PQC22)
    PQCH4 => GET_HOST_DATA_RDWR (YD_PQCH4)
    PQCL4 => GET_HOST_DATA_RDWR (YD_PQCL4)
    PQCO2 => GET_HOST_DATA_RDWR (YD_PQCO2)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLIQ => GET_HOST_DATA_RDWR (YD_PQLIQ)
    PQN2O => GET_HOST_DATA_RDWR (YD_PQN2O)
    PQNO2 => GET_HOST_DATA_RDWR (YD_PQNO2)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    PQSAT => GET_HOST_DATA_RDWR (YD_PQSAT)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTS => GET_HOST_DATA_RDWR (YD_PTS)
    ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
    ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
    ZEMIW => GET_HOST_DATA_RDWR (YL_ZEMIW)
    ZNBAS => GET_HOST_DATA_RDWR (YL_ZNBAS)
    ZNTOP => GET_HOST_DATA_RDWR (YL_ZNTOP)
    ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
    ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
    ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
    ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
    ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
    ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
    ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
    ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
    ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
    ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
    ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
    ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
    ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
    ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
    ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
    ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
    ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
    ZSPECTRALEMISS => GET_HOST_DATA_RDWR (YL_ZSPECTRALEMISS)
    ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAER => NULL ()
  PAERO => NULL ()
  PAPRS => NULL ()
  PAPRSF => NULL ()
  PDELP => NULL ()
  PEMIS => NULL ()
  PMU0M => NULL ()
  PNEB => NULL ()
  PQ => NULL ()
  PQC11 => NULL ()
  PQC12 => NULL ()
  PQC22 => NULL ()
  PQCH4 => NULL ()
  PQCL4 => NULL ()
  PQCO2 => NULL ()
  PQICE => NULL ()
  PQLIQ => NULL ()
  PQN2O => NULL ()
  PQNO2 => NULL ()
  PQO3 => NULL ()
  PQSAT => NULL ()
  PT => NULL ()
  PTS => NULL ()
  ZCCNL => NULL ()
  ZCCNO => NULL ()
  ZEMIW => NULL ()
  ZNBAS => NULL ()
  ZNTOP => NULL ()
  ZPAERO => NULL ()
  ZPQO3 => NULL ()
  ZQ => NULL ()
  ZQIWP => NULL ()
  ZQLWP => NULL ()
  ZQS => NULL ()
  ZRAER => NULL ()
  ZRC11 => NULL ()
  ZRC12 => NULL ()
  ZRC22 => NULL ()
  ZRCH4 => NULL ()
  ZRCL4 => NULL ()
  ZRCLC => NULL ()
  ZRCO2 => NULL ()
  ZRMU0 => NULL ()
  ZRN2O => NULL ()
  ZRNO2 => NULL ()
  ZSPECTRALEMISS => NULL ()
  ZTH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:PREPARE',1,ZHOOK_HANDLE_PARALLEL)

IF (PRESENT (YSPP_RSWINHF)) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSE
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:1')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRSWINHF => GET_HOST_DATA_RDWR (YL_ZRSWINHF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      ZRSWINHF (:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RSWINHF
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:1')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRSWINHF => GET_HOST_DATA_RDWR (YL_ZRSWINHF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRSWINHF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','RECMWF_PARALLEL:1')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRSWINHF => GET_HOST_DATA_RDWR (YL_ZRSWINHF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZRSWINHF (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RSWINHF
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:1')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRSWINHF => GET_HOST_DATA_RDWR (YL_ZRSWINHF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRSWINHF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','RECMWF_PARALLEL:1')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRSWINHF => GET_DEVICE_DATA_RDWR (YL_ZRSWINHF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZRSWINHF) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZRSWINHF (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RSWINHF
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:1')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRSWINHF => GET_HOST_DATA_RDWR (YL_ZRSWINHF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRSWINHF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (PRESENT (YSPP_RLWINHF)) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSE
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRLWINHF => GET_HOST_DATA_RDWR (YL_ZRLWINHF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      ZRLWINHF (:, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RLWINHF
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:2')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRLWINHF => GET_HOST_DATA_RDWR (YL_ZRLWINHF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRLWINHF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','RECMWF_PARALLEL:2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRLWINHF => GET_HOST_DATA_RDWR (YL_ZRLWINHF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZRLWINHF (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RLWINHF
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:2')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRLWINHF => GET_HOST_DATA_RDWR (YL_ZRLWINHF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRLWINHF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','RECMWF_PARALLEL:2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRLWINHF => GET_DEVICE_DATA_RDWR (YL_ZRLWINHF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZRLWINHF) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZRLWINHF (JLON, JBLK)=YDMODEL%YRML_PHY_RAD%YRERAD%RLWINHF
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:2')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRLWINHF => GET_HOST_DATA_RDWR (YL_ZRLWINHF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRLWINHF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:2',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:SRTM')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
    PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
    PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
    PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
    PEMIS => GET_HOST_DATA_RDONLY (YD_PEMIS)
    PGELAM => GET_HOST_DATA_RDONLY (YD_PGELAM)
    PGEMU => GET_HOST_DATA_RDONLY (YD_PGEMU)
    PLSM => GET_HOST_DATA_RDONLY (YD_PLSM)
    PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
    PNEB => GET_HOST_DATA_RDONLY (YD_PNEB)
    PRR => GET_HOST_DATA_RDONLY (YD_PRR)
    PS => GET_HOST_DATA_RDONLY (YD_PS)
    PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
    PT => GET_HOST_DATA_RDONLY (YD_PT)
    PTS => GET_HOST_DATA_RDONLY (YD_PTS)
    ZCCNL => GET_HOST_DATA_RDONLY (YL_ZCCNL)
    ZCCNO => GET_HOST_DATA_RDONLY (YL_ZCCNO)
    ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
    ZEMIW => GET_HOST_DATA_RDONLY (YL_ZEMIW)
    ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
    ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
    ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
    ZFRTED => GET_HOST_DATA_RDWR (YL_ZFRTED)
    ZLWDERIVATIVE => GET_HOST_DATA_RDWR (YL_ZLWDERIVATIVE)
    ZPAERO => GET_HOST_DATA_RDONLY (YL_ZPAERO)
    ZPARCF => GET_HOST_DATA_RDWR (YL_ZPARCF)
    ZPARF => GET_HOST_DATA_RDWR (YL_ZPARF)
    ZPCDIR => GET_HOST_DATA_RDWR (YL_ZPCDIR)
    ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
    ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
    ZPFRSODC => GET_HOST_DATA_RDWR (YL_ZPFRSODC)
    ZPFRTEDC => GET_HOST_DATA_RDWR (YL_ZPFRTEDC)
    ZPQO3 => GET_HOST_DATA_RDONLY (YL_ZPQO3)
    ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
    ZQIWP => GET_HOST_DATA_RDONLY (YL_ZQIWP)
    ZQLWP => GET_HOST_DATA_RDONLY (YL_ZQLWP)
    ZRAER => GET_HOST_DATA_RDONLY (YL_ZRAER)
    ZRC11 => GET_HOST_DATA_RDONLY (YL_ZRC11)
    ZRC12 => GET_HOST_DATA_RDONLY (YL_ZRC12)
    ZRC22 => GET_HOST_DATA_RDONLY (YL_ZRC22)
    ZRCH4 => GET_HOST_DATA_RDONLY (YL_ZRCH4)
    ZRCL4 => GET_HOST_DATA_RDONLY (YL_ZRCL4)
    ZRCO2 => GET_HOST_DATA_RDONLY (YL_ZRCO2)
    ZRMU0 => GET_HOST_DATA_RDONLY (YL_ZRMU0)
    ZRN2O => GET_HOST_DATA_RDONLY (YL_ZRN2O)
    ZRNO2 => GET_HOST_DATA_RDONLY (YL_ZRNO2)
    ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
    ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
    ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
    ZTH => GET_HOST_DATA_RDONLY (YL_ZTH)
    ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
    ZUVDF => GET_HOST_DATA_RDWR (YL_ZUVDF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL RADLSWR (YDDIMV, YDMODEL, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG&
      &, KAERO, YDMODEL%YRML_PHY_MF%YRPHY3%RII0, ZRAER(:,:,:, JBLK), ZPAERO(:,:,:, JBLK), PALBD(:,:, JBLK)&
      &, PALBP(:,:, JBLK), PAPRS(:,:, JBLK), PAPRSF(:,:, JBLK), ZCCNL(:, JBLK), ZCCNO(:, JBLK), PGELAM(:, JBLK&
      &), PGEMU(:, JBLK), ZRCO2(:,:, JBLK), ZRCH4(:,:, JBLK), ZRN2O(:,:, JBLK), ZRNO2(:,:, JBLK), ZRC11(:,&
      &:, JBLK), ZRC12(:,:, JBLK), ZRC22(:,:, JBLK), ZRCL4(:,:, JBLK), PNEB(:,:, JBLK), PDELP(:,:, JBLK), PEMIS&
      &(:, JBLK), ZEMIW(:, JBLK), PLSM(:, JBLK), ZRMU0(:, JBLK), ZPQO3(:,:, JBLK), ZQ(:,:, JBLK), ZQIWP(:,&
      &:, JBLK), PS(:,:, JBLK), ZQLWP(:,:, JBLK), PRR(:,:, JBLK), ZTH(:,:, JBLK), PT(:,:, JBLK), PTS(:, JBLK&
      &), ZEMIT(:, JBLK), ZFCT(:,:, JBLK), PLWFT (:,:, 1, JBLK), ZFCS(:,:, JBLK), PSWFT (:,:, 1, JBLK), ZFRSOD&
      &(:, JBLK), ZFRTED(:, JBLK), ZPFRSODC(:, JBLK), ZPFRTEDC(:, JBLK), ZSUDU(:, JBLK), ZUVDF(:, JBLK), ZPARF&
      &(:, JBLK), ZPARCF(:, JBLK), ZTINCF(:, JBLK), ZPFDIR(:, JBLK), ZPFDIF(:, JBLK), ZPCDIR(:, JBLK), ZLWDERIVATIVE&
      &(:,:, JBLK), ZSWDIFFUSEBAND(:,:, JBLK), ZSWDIRECTBAND(:,:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:SRTM')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
      PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
      PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
      PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
      PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
      PEMIS => GET_HOST_DATA_RDWR (YD_PEMIS)
      PGELAM => GET_HOST_DATA_RDWR (YD_PGELAM)
      PGEMU => GET_HOST_DATA_RDWR (YD_PGEMU)
      PLSM => GET_HOST_DATA_RDWR (YD_PLSM)
      PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
      PNEB => GET_HOST_DATA_RDWR (YD_PNEB)
      PRR => GET_HOST_DATA_RDWR (YD_PRR)
      PS => GET_HOST_DATA_RDWR (YD_PS)
      PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
      PT => GET_HOST_DATA_RDWR (YD_PT)
      PTS => GET_HOST_DATA_RDWR (YD_PTS)
      ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
      ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
      ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
      ZEMIW => GET_HOST_DATA_RDWR (YL_ZEMIW)
      ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
      ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
      ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
      ZFRTED => GET_HOST_DATA_RDWR (YL_ZFRTED)
      ZLWDERIVATIVE => GET_HOST_DATA_RDWR (YL_ZLWDERIVATIVE)
      ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
      ZPARCF => GET_HOST_DATA_RDWR (YL_ZPARCF)
      ZPARF => GET_HOST_DATA_RDWR (YL_ZPARF)
      ZPCDIR => GET_HOST_DATA_RDWR (YL_ZPCDIR)
      ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
      ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
      ZPFRSODC => GET_HOST_DATA_RDWR (YL_ZPFRSODC)
      ZPFRTEDC => GET_HOST_DATA_RDWR (YL_ZPFRTEDC)
      ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
      ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
      ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
      ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
      ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
      ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
      ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
      ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
      ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
      ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
      ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
      ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
      ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
      ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
      ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
      ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
      ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
      ZUVDF => GET_HOST_DATA_RDWR (YL_ZUVDF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PALBD => NULL ()
    PALBP => NULL ()
    PAPRS => NULL ()
    PAPRSF => NULL ()
    PDELP => NULL ()
    PEMIS => NULL ()
    PGELAM => NULL ()
    PGEMU => NULL ()
    PLSM => NULL ()
    PLWFT => NULL ()
    PNEB => NULL ()
    PRR => NULL ()
    PS => NULL ()
    PSWFT => NULL ()
    PT => NULL ()
    PTS => NULL ()
    ZCCNL => NULL ()
    ZCCNO => NULL ()
    ZEMIT => NULL ()
    ZEMIW => NULL ()
    ZFCS => NULL ()
    ZFCT => NULL ()
    ZFRSOD => NULL ()
    ZFRTED => NULL ()
    ZLWDERIVATIVE => NULL ()
    ZPAERO => NULL ()
    ZPARCF => NULL ()
    ZPARF => NULL ()
    ZPCDIR => NULL ()
    ZPFDIF => NULL ()
    ZPFDIR => NULL ()
    ZPFRSODC => NULL ()
    ZPFRTEDC => NULL ()
    ZPQO3 => NULL ()
    ZQ => NULL ()
    ZQIWP => NULL ()
    ZQLWP => NULL ()
    ZRAER => NULL ()
    ZRC11 => NULL ()
    ZRC12 => NULL ()
    ZRC22 => NULL ()
    ZRCH4 => NULL ()
    ZRCL4 => NULL ()
    ZRCO2 => NULL ()
    ZRMU0 => NULL ()
    ZRN2O => NULL ()
    ZRNO2 => NULL ()
    ZSUDU => NULL ()
    ZSWDIFFUSEBAND => NULL ()
    ZSWDIRECTBAND => NULL ()
    ZTH => NULL ()
    ZTINCF => NULL ()
    ZUVDF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:SRTM',1,ZHOOK_HANDLE_PARALLEL)
ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%LRRTM.AND..NOT.YDMODEL%YRML_PHY_RAD&
  &%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:RRTM')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PAERINDS => GET_HOST_DATA_RDONLY (YD_PAERINDS)
    PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
    PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
    PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
    PCGA_DST => GET_HOST_DATA_RDONLY (YD_PCGA_DST)
    PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
    PEMIS => GET_HOST_DATA_RDONLY (YD_PEMIS)
    PFSDNN => GET_HOST_DATA_RDWR (YD_PFSDNN)
    PFSDNV => GET_HOST_DATA_RDWR (YD_PFSDNV)
    PLSM => GET_HOST_DATA_RDONLY (YD_PLSM)
    PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
    PPIZA_DST => GET_HOST_DATA_RDONLY (YD_PPIZA_DST)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
    PT => GET_HOST_DATA_RDONLY (YD_PT)
    PTAUREL_DST => GET_HOST_DATA_RDONLY (YD_PTAUREL_DST)
    PTS => GET_HOST_DATA_RDONLY (YD_PTS)
    ZCCNL => GET_HOST_DATA_RDONLY (YL_ZCCNL)
    ZCCNO => GET_HOST_DATA_RDONLY (YL_ZCCNO)
    ZCLDROP => GET_HOST_DATA_RDONLY (YL_ZCLDROP)
    ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
    ZEMIW => GET_HOST_DATA_RDONLY (YL_ZEMIW)
    ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
    ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
    ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
    ZNBAS => GET_HOST_DATA_RDONLY (YL_ZNBAS)
    ZNTOP => GET_HOST_DATA_RDONLY (YL_ZNTOP)
    ZPARCF => GET_HOST_DATA_RDWR (YL_ZPARCF)
    ZPARF => GET_HOST_DATA_RDWR (YL_ZPARF)
    ZPQO3 => GET_HOST_DATA_RDONLY (YL_ZPQO3)
    ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
    ZQIWP => GET_HOST_DATA_RDONLY (YL_ZQIWP)
    ZQLWP => GET_HOST_DATA_RDONLY (YL_ZQLWP)
    ZQS => GET_HOST_DATA_RDONLY (YL_ZQS)
    ZRAER => GET_HOST_DATA_RDONLY (YL_ZRAER)
    ZRCLC => GET_HOST_DATA_RDONLY (YL_ZRCLC)
    ZRLWINHF => GET_HOST_DATA_RDONLY (YL_ZRLWINHF)
    ZRMU0 => GET_HOST_DATA_RDONLY (YL_ZRMU0)
    ZRSWINHF => GET_HOST_DATA_RDONLY (YL_ZRSWINHF)
    ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
    ZTH => GET_HOST_DATA_RDONLY (YL_ZTH)
    ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
    ZUVDF => GET_HOST_DATA_RDWR (YL_ZUVDF)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL RADLSW (YDDIMV, YDMODEL%YRML_PHY_RAD, YDMODEL%YRML_PHY_SLIN%YREPHLI, YDMODEL%YRML_PHY_SLIN&
      &%YRPHNC, YDMODEL%YRML_PHY_EC%YRECLD, YDMODEL%YRML_PHY_MF%YRPARAR, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_PHY_RAD%YRERAD%NMODE, YDMODEL%YRML_PHY_RAD&
      &%YRERAD%NAER, YDMODEL%YRML_PHY_MF%YRPHY3%RII0, ZRAER(:,:,:, JBLK), PALBD(:,:, JBLK), PALBP(:,:&
      &, JBLK), PAPRS(:,:, JBLK), PAPRSF(:,:, JBLK), ZCCNL(:, JBLK), ZCCNO(:, JBLK), YDMODEL%YRML_PHY_RAD&
      &%YRERDI%RCARDI, ZRCLC(:,:, JBLK), PDELP(:,:, JBLK), PEMIS(:, JBLK), ZEMIW(:, JBLK), PLSM(:, JBLK&
      &), ZRMU0(:, JBLK), ZPQO3(:,:, JBLK), ZQ(:,:, JBLK), ZQIWP(:,:, JBLK), ZQLWP(:,:, JBLK), ZQS(:,&
      &:, JBLK), ZTH(:,:, JBLK), PT(:,:, JBLK), PTS(:, JBLK), ZNBAS(:, JBLK), ZNTOP(:, JBLK), ZEMIT(:&
      &, JBLK), ZFCT(:,:, JBLK), PLWFT (:,:, 1, JBLK), ZFCS(:,:, JBLK), PSWFT (:,:, 1, JBLK), ZFRSOD(&
      &:, JBLK), ZSUDU(:, JBLK), ZPARF(:, JBLK), ZUVDF(:, JBLK), ZPARCF(:, JBLK), ZTINCF(:, JBLK), PSFSWDIR&
      &(:,:, JBLK), PSFSWDIF(:,:, JBLK), PFSDNN(:, JBLK), PFSDNV(:, JBLK), YDMODEL%YRML_PHY_MF%YRARPHY&
      &%LRDUST, PPIZA_DST(:,:,:, JBLK), PCGA_DST(:,:,:, JBLK), PTAUREL_DST(:,:,:, JBLK), PAERINDS(:,:&
      &, JBLK), ZRSWINHF(:, JBLK), ZRLWINHF(:, JBLK), ZCLDROP(:,:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:RRTM')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PAERINDS => GET_HOST_DATA_RDWR (YD_PAERINDS)
      PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
      PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
      PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
      PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
      PCGA_DST => GET_HOST_DATA_RDWR (YD_PCGA_DST)
      PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
      PEMIS => GET_HOST_DATA_RDWR (YD_PEMIS)
      PFSDNN => GET_HOST_DATA_RDWR (YD_PFSDNN)
      PFSDNV => GET_HOST_DATA_RDWR (YD_PFSDNV)
      PLSM => GET_HOST_DATA_RDWR (YD_PLSM)
      PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
      PPIZA_DST => GET_HOST_DATA_RDWR (YD_PPIZA_DST)
      PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
      PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
      PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
      PT => GET_HOST_DATA_RDWR (YD_PT)
      PTAUREL_DST => GET_HOST_DATA_RDWR (YD_PTAUREL_DST)
      PTS => GET_HOST_DATA_RDWR (YD_PTS)
      ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
      ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
      ZCLDROP => GET_HOST_DATA_RDWR (YL_ZCLDROP)
      ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
      ZEMIW => GET_HOST_DATA_RDWR (YL_ZEMIW)
      ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
      ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
      ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
      ZNBAS => GET_HOST_DATA_RDWR (YL_ZNBAS)
      ZNTOP => GET_HOST_DATA_RDWR (YL_ZNTOP)
      ZPARCF => GET_HOST_DATA_RDWR (YL_ZPARCF)
      ZPARF => GET_HOST_DATA_RDWR (YL_ZPARF)
      ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
      ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
      ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
      ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
      ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
      ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
      ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
      ZRLWINHF => GET_HOST_DATA_RDWR (YL_ZRLWINHF)
      ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
      ZRSWINHF => GET_HOST_DATA_RDWR (YL_ZRSWINHF)
      ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
      ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
      ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
      ZUVDF => GET_HOST_DATA_RDWR (YL_ZUVDF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PAERINDS => NULL ()
    PALBD => NULL ()
    PALBP => NULL ()
    PAPRS => NULL ()
    PAPRSF => NULL ()
    PCGA_DST => NULL ()
    PDELP => NULL ()
    PEMIS => NULL ()
    PFSDNN => NULL ()
    PFSDNV => NULL ()
    PLSM => NULL ()
    PLWFT => NULL ()
    PPIZA_DST => NULL ()
    PSFSWDIF => NULL ()
    PSFSWDIR => NULL ()
    PSWFT => NULL ()
    PT => NULL ()
    PTAUREL_DST => NULL ()
    PTS => NULL ()
    ZCCNL => NULL ()
    ZCCNO => NULL ()
    ZCLDROP => NULL ()
    ZEMIT => NULL ()
    ZEMIW => NULL ()
    ZFCS => NULL ()
    ZFCT => NULL ()
    ZFRSOD => NULL ()
    ZNBAS => NULL ()
    ZNTOP => NULL ()
    ZPARCF => NULL ()
    ZPARF => NULL ()
    ZPQO3 => NULL ()
    ZQ => NULL ()
    ZQIWP => NULL ()
    ZQLWP => NULL ()
    ZQS => NULL ()
    ZRAER => NULL ()
    ZRCLC => NULL ()
    ZRLWINHF => NULL ()
    ZRMU0 => NULL ()
    ZRSWINHF => NULL ()
    ZSUDU => NULL ()
    ZTH => NULL ()
    ZTINCF => NULL ()
    ZUVDF => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:RRTM',1,ZHOOK_HANDLE_PARALLEL)
ELSEIF (.NOT.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN

  IF (YDMODEL%YRML_PHY_RAD%YRERAD%CECRADARCH=='CPU') THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:ECRAD_CPU')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PAEROCPL => GET_HOST_DATA_RDONLY (YD_PAEROCPL)
      PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
      PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
      PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
      PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
      PGELAM => GET_HOST_DATA_RDONLY (YD_PGELAM)
      PGEMU => GET_HOST_DATA_RDONLY (YD_PGEMU)
      PLSM => GET_HOST_DATA_RDONLY (YD_PLSM)
      PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
      PRR => GET_HOST_DATA_RDONLY (YD_PRR)
      PS => GET_HOST_DATA_RDONLY (YD_PS)
      PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
      PT => GET_HOST_DATA_RDONLY (YD_PT)
      PTS => GET_HOST_DATA_RDONLY (YD_PTS)
      ZCCNL => GET_HOST_DATA_RDONLY (YL_ZCCNL)
      ZCCNO => GET_HOST_DATA_RDONLY (YL_ZCCNO)
      ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
      ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
      ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
      ZFLUX_PAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR)
      ZFLUX_PAR_CLEAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR_CLEAR)
      ZFLUX_UV => GET_HOST_DATA_RDWR (YL_ZFLUX_UV)
      ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
      ZFRTED => GET_HOST_DATA_RDWR (YL_ZFRTED)
      ZLWDERIVATIVE => GET_HOST_DATA_RDWR (YL_ZLWDERIVATIVE)
      ZPAERO => GET_HOST_DATA_RDONLY (YL_ZPAERO)
      ZPCDIR => GET_HOST_DATA_RDWR (YL_ZPCDIR)
      ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
      ZPFRSODC => GET_HOST_DATA_RDWR (YL_ZPFRSODC)
      ZPFRTEDC => GET_HOST_DATA_RDWR (YL_ZPFRTEDC)
      ZPQO3 => GET_HOST_DATA_RDONLY (YL_ZPQO3)
      ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
      ZQIWP => GET_HOST_DATA_RDONLY (YL_ZQIWP)
      ZQLWP => GET_HOST_DATA_RDONLY (YL_ZQLWP)
      ZRAER => GET_HOST_DATA_RDONLY (YL_ZRAER)
      ZRC11 => GET_HOST_DATA_RDONLY (YL_ZRC11)
      ZRC12 => GET_HOST_DATA_RDONLY (YL_ZRC12)
      ZRC22 => GET_HOST_DATA_RDONLY (YL_ZRC22)
      ZRCH4 => GET_HOST_DATA_RDONLY (YL_ZRCH4)
      ZRCL4 => GET_HOST_DATA_RDONLY (YL_ZRCL4)
      ZRCLC => GET_HOST_DATA_RDONLY (YL_ZRCLC)
      ZRCO2 => GET_HOST_DATA_RDONLY (YL_ZRCO2)
      ZRMU0 => GET_HOST_DATA_RDONLY (YL_ZRMU0)
      ZRN2O => GET_HOST_DATA_RDONLY (YL_ZRN2O)
      ZRNO2 => GET_HOST_DATA_RDONLY (YL_ZRNO2)
      ZSPECTRALEMISS => GET_HOST_DATA_RDONLY (YL_ZSPECTRALEMISS)
      ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
      ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
      ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
      ZTH => GET_HOST_DATA_RDONLY (YL_ZTH)
      ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        CALL RADIATION_SCHEME_CPU (YDMODEL, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG&
        &, KAERO, YDMODEL%YRML_PHY_MF%YRPHY3%RII0, ZRMU0(:, JBLK), PTS(:, JBLK), PALBD(:,:, JBLK), PALBP(:,:,&
        & JBLK), ZSPECTRALEMISS(:,:, JBLK), ZCCNL(:, JBLK), ZCCNO(:, JBLK), PGELAM(:, JBLK), PGEMU(:, JBLK), PLSM&
        &(:, JBLK), PAPRSF(:,:, JBLK), PT(:,:, JBLK), PAPRS(:,:, JBLK), ZTH(:,:, JBLK), ZQ(:,:, JBLK), ZRCO2(&
        &:,:, JBLK), ZRCH4(:,:, JBLK), ZRN2O(:,:, JBLK), ZRNO2(:,:, JBLK), ZRC11(:,:, JBLK), ZRC12(:,:, JBLK)&
        &, ZRC22(:,:, JBLK), ZRCL4(:,:, JBLK), ZPQO3(:,:, JBLK), ZRCLC(:,:, JBLK), ZQLWP(:,:, JBLK), ZQIWP(:,&
        &:, JBLK), PRR(:,:, JBLK), PS(:,:, JBLK), ZRAER(:,:,:, JBLK), ZPAERO(:,:,:, JBLK), PAEROCPL(:,:,:,:, JBLK&
        &), PSWFT (:,:, 1, JBLK), PLWFT (:,:, 1, JBLK), ZFCS(:,:, JBLK), ZFCT(:,:, JBLK), ZFRSOD(:, JBLK), ZFRTED&
        &(:, JBLK), ZPFRSODC(:, JBLK), ZPFRTEDC(:, JBLK), ZPFDIR(:, JBLK), ZPCDIR(:, JBLK), ZSUDU(:, JBLK), ZFLUX_UV&
        &(:, JBLK), ZFLUX_PAR(:, JBLK), ZFLUX_PAR_CLEAR(:, JBLK), ZTINCF(:, JBLK), ZEMIT(:, JBLK), ZLWDERIVATIVE&
        &(:,:, JBLK), ZSWDIFFUSEBAND(:,:, JBLK), ZSWDIRECTBAND(:,:, JBLK))
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:ECRAD_CPU')) THEN
        IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PAEROCPL => GET_HOST_DATA_RDWR (YD_PAEROCPL)
        PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
        PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
        PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
        PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
        PGELAM => GET_HOST_DATA_RDWR (YD_PGELAM)
        PGEMU => GET_HOST_DATA_RDWR (YD_PGEMU)
        PLSM => GET_HOST_DATA_RDWR (YD_PLSM)
        PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
        PRR => GET_HOST_DATA_RDWR (YD_PRR)
        PS => GET_HOST_DATA_RDWR (YD_PS)
        PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
        PT => GET_HOST_DATA_RDWR (YD_PT)
        PTS => GET_HOST_DATA_RDWR (YD_PTS)
        ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
        ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
        ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
        ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
        ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
        ZFLUX_PAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR)
        ZFLUX_PAR_CLEAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR_CLEAR)
        ZFLUX_UV => GET_HOST_DATA_RDWR (YL_ZFLUX_UV)
        ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
        ZFRTED => GET_HOST_DATA_RDWR (YL_ZFRTED)
        ZLWDERIVATIVE => GET_HOST_DATA_RDWR (YL_ZLWDERIVATIVE)
        ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
        ZPCDIR => GET_HOST_DATA_RDWR (YL_ZPCDIR)
        ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
        ZPFRSODC => GET_HOST_DATA_RDWR (YL_ZPFRSODC)
        ZPFRTEDC => GET_HOST_DATA_RDWR (YL_ZPFRTEDC)
        ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
        ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
        ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
        ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
        ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
        ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
        ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
        ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
        ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
        ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
        ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
        ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
        ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
        ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
        ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
        ZSPECTRALEMISS => GET_HOST_DATA_RDWR (YL_ZSPECTRALEMISS)
        ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
        ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
        ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
        ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
        ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
        IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PAEROCPL => NULL ()
      PALBD => NULL ()
      PALBP => NULL ()
      PAPRS => NULL ()
      PAPRSF => NULL ()
      PGELAM => NULL ()
      PGEMU => NULL ()
      PLSM => NULL ()
      PLWFT => NULL ()
      PRR => NULL ()
      PS => NULL ()
      PSWFT => NULL ()
      PT => NULL ()
      PTS => NULL ()
      ZCCNL => NULL ()
      ZCCNO => NULL ()
      ZEMIT => NULL ()
      ZFCS => NULL ()
      ZFCT => NULL ()
      ZFLUX_PAR => NULL ()
      ZFLUX_PAR_CLEAR => NULL ()
      ZFLUX_UV => NULL ()
      ZFRSOD => NULL ()
      ZFRTED => NULL ()
      ZLWDERIVATIVE => NULL ()
      ZPAERO => NULL ()
      ZPCDIR => NULL ()
      ZPFDIR => NULL ()
      ZPFRSODC => NULL ()
      ZPFRTEDC => NULL ()
      ZPQO3 => NULL ()
      ZQ => NULL ()
      ZQIWP => NULL ()
      ZQLWP => NULL ()
      ZRAER => NULL ()
      ZRC11 => NULL ()
      ZRC12 => NULL ()
      ZRC22 => NULL ()
      ZRCH4 => NULL ()
      ZRCL4 => NULL ()
      ZRCLC => NULL ()
      ZRCO2 => NULL ()
      ZRMU0 => NULL ()
      ZRN2O => NULL ()
      ZRNO2 => NULL ()
      ZSPECTRALEMISS => NULL ()
      ZSUDU => NULL ()
      ZSWDIFFUSEBAND => NULL ()
      ZSWDIRECTBAND => NULL ()
      ZTH => NULL ()
      ZTINCF => NULL ()
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_CPU',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF


  IF (YDMODEL%YRML_PHY_RAD%YRERAD%CECRADARCH=='GPU') THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:ECRAD_GPU')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      PAEROCPL => GET_HOST_DATA_RDONLY (YD_PAEROCPL)
      PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
      PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
      PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
      PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
      PGELAM => GET_HOST_DATA_RDONLY (YD_PGELAM)
      PGEMU => GET_HOST_DATA_RDONLY (YD_PGEMU)
      PLSM => GET_HOST_DATA_RDONLY (YD_PLSM)
      PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
      PRR => GET_HOST_DATA_RDONLY (YD_PRR)
      PS => GET_HOST_DATA_RDONLY (YD_PS)
      PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
      PT => GET_HOST_DATA_RDONLY (YD_PT)
      PTS => GET_HOST_DATA_RDONLY (YD_PTS)
      ZCCNL => GET_HOST_DATA_RDONLY (YL_ZCCNL)
      ZCCNO => GET_HOST_DATA_RDONLY (YL_ZCCNO)
      ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
      ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
      ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
      ZFLUX_PAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR)
      ZFLUX_PAR_CLEAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR_CLEAR)
      ZFLUX_UV => GET_HOST_DATA_RDWR (YL_ZFLUX_UV)
      ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
      ZFRTED => GET_HOST_DATA_RDWR (YL_ZFRTED)
      ZLWDERIVATIVE => GET_HOST_DATA_RDWR (YL_ZLWDERIVATIVE)
      ZPAERO => GET_HOST_DATA_RDONLY (YL_ZPAERO)
      ZPCDIR => GET_HOST_DATA_RDWR (YL_ZPCDIR)
      ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
      ZPFRSODC => GET_HOST_DATA_RDWR (YL_ZPFRSODC)
      ZPFRTEDC => GET_HOST_DATA_RDWR (YL_ZPFRTEDC)
      ZPQO3 => GET_HOST_DATA_RDONLY (YL_ZPQO3)
      ZQ => GET_HOST_DATA_RDONLY (YL_ZQ)
      ZQIWP => GET_HOST_DATA_RDONLY (YL_ZQIWP)
      ZQLWP => GET_HOST_DATA_RDONLY (YL_ZQLWP)
      ZRAER => GET_HOST_DATA_RDONLY (YL_ZRAER)
      ZRC11 => GET_HOST_DATA_RDONLY (YL_ZRC11)
      ZRC12 => GET_HOST_DATA_RDONLY (YL_ZRC12)
      ZRC22 => GET_HOST_DATA_RDONLY (YL_ZRC22)
      ZRCH4 => GET_HOST_DATA_RDONLY (YL_ZRCH4)
      ZRCL4 => GET_HOST_DATA_RDONLY (YL_ZRCL4)
      ZRCLC => GET_HOST_DATA_RDONLY (YL_ZRCLC)
      ZRCO2 => GET_HOST_DATA_RDONLY (YL_ZRCO2)
      ZRMU0 => GET_HOST_DATA_RDONLY (YL_ZRMU0)
      ZRN2O => GET_HOST_DATA_RDONLY (YL_ZRN2O)
      ZRNO2 => GET_HOST_DATA_RDONLY (YL_ZRNO2)
      ZSPECTRALEMISS => GET_HOST_DATA_RDONLY (YL_ZSPECTRALEMISS)
      ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
      ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
      ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
      ZTH => GET_HOST_DATA_RDONLY (YL_ZTH)
      ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        CALL RADIATION_SCHEME_GPU (YDMODEL, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS&
        &%KFLEVG, KAERO, YDMODEL%YRML_PHY_MF%YRPHY3%RII0, ZRMU0(:, JBLK), PTS(:, JBLK), PALBD(:,:, JBLK)&
        &, PALBP(:,:, JBLK), ZSPECTRALEMISS(:,:, JBLK), ZCCNL(:, JBLK), ZCCNO(:, JBLK), PGELAM(:, JBLK),&
        & PGEMU(:, JBLK), PLSM(:, JBLK), PAPRSF(:,:, JBLK), PT(:,:, JBLK), PAPRS(:,:, JBLK), ZTH(:,:, JBLK&
        &), ZQ(:,:, JBLK), ZRCO2(:,:, JBLK), ZRCH4(:,:, JBLK), ZRN2O(:,:, JBLK), ZRNO2(:,:, JBLK), ZRC11&
        &(:,:, JBLK), ZRC12(:,:, JBLK), ZRC22(:,:, JBLK), ZRCL4(:,:, JBLK), ZPQO3(:,:, JBLK), ZRCLC(:,:,&
        & JBLK), ZQLWP(:,:, JBLK), ZQIWP(:,:, JBLK), PRR(:,:, JBLK), PS(:,:, JBLK), ZRAER(:,:,:, JBLK), ZPAERO&
        &(:,:,:, JBLK), PAEROCPL(:,:,:,:, JBLK), PSWFT (:,:, 1, JBLK), PLWFT (:,:, 1, JBLK), ZFCS(:,:, JBLK&
        &), ZFCT(:,:, JBLK), ZFRSOD(:, JBLK), ZFRTED(:, JBLK), ZPFRSODC(:, JBLK), ZPFRTEDC(:, JBLK), ZPFDIR&
        &(:, JBLK), ZPCDIR(:, JBLK), ZSUDU(:, JBLK), ZFLUX_UV(:, JBLK), ZFLUX_PAR(:, JBLK), ZFLUX_PAR_CLEAR&
        &(:, JBLK), ZTINCF(:, JBLK), ZEMIT(:, JBLK), ZLWDERIVATIVE(:,:, JBLK), ZSWDIFFUSEBAND(:,:, JBLK)&
        &, ZSWDIRECTBAND(:,:, JBLK), LACC=YDMODEL%YRML_PHY_RAD%YRERAD%LECRADACC)
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:ECRAD_GPU')) THEN
        IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        PAEROCPL => GET_HOST_DATA_RDWR (YD_PAEROCPL)
        PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
        PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
        PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
        PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
        PGELAM => GET_HOST_DATA_RDWR (YD_PGELAM)
        PGEMU => GET_HOST_DATA_RDWR (YD_PGEMU)
        PLSM => GET_HOST_DATA_RDWR (YD_PLSM)
        PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
        PRR => GET_HOST_DATA_RDWR (YD_PRR)
        PS => GET_HOST_DATA_RDWR (YD_PS)
        PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
        PT => GET_HOST_DATA_RDWR (YD_PT)
        PTS => GET_HOST_DATA_RDWR (YD_PTS)
        ZCCNL => GET_HOST_DATA_RDWR (YL_ZCCNL)
        ZCCNO => GET_HOST_DATA_RDWR (YL_ZCCNO)
        ZEMIT => GET_HOST_DATA_RDWR (YL_ZEMIT)
        ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
        ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
        ZFLUX_PAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR)
        ZFLUX_PAR_CLEAR => GET_HOST_DATA_RDWR (YL_ZFLUX_PAR_CLEAR)
        ZFLUX_UV => GET_HOST_DATA_RDWR (YL_ZFLUX_UV)
        ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
        ZFRTED => GET_HOST_DATA_RDWR (YL_ZFRTED)
        ZLWDERIVATIVE => GET_HOST_DATA_RDWR (YL_ZLWDERIVATIVE)
        ZPAERO => GET_HOST_DATA_RDWR (YL_ZPAERO)
        ZPCDIR => GET_HOST_DATA_RDWR (YL_ZPCDIR)
        ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
        ZPFRSODC => GET_HOST_DATA_RDWR (YL_ZPFRSODC)
        ZPFRTEDC => GET_HOST_DATA_RDWR (YL_ZPFRTEDC)
        ZPQO3 => GET_HOST_DATA_RDWR (YL_ZPQO3)
        ZQ => GET_HOST_DATA_RDWR (YL_ZQ)
        ZQIWP => GET_HOST_DATA_RDWR (YL_ZQIWP)
        ZQLWP => GET_HOST_DATA_RDWR (YL_ZQLWP)
        ZRAER => GET_HOST_DATA_RDWR (YL_ZRAER)
        ZRC11 => GET_HOST_DATA_RDWR (YL_ZRC11)
        ZRC12 => GET_HOST_DATA_RDWR (YL_ZRC12)
        ZRC22 => GET_HOST_DATA_RDWR (YL_ZRC22)
        ZRCH4 => GET_HOST_DATA_RDWR (YL_ZRCH4)
        ZRCL4 => GET_HOST_DATA_RDWR (YL_ZRCL4)
        ZRCLC => GET_HOST_DATA_RDWR (YL_ZRCLC)
        ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
        ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
        ZRN2O => GET_HOST_DATA_RDWR (YL_ZRN2O)
        ZRNO2 => GET_HOST_DATA_RDWR (YL_ZRNO2)
        ZSPECTRALEMISS => GET_HOST_DATA_RDWR (YL_ZSPECTRALEMISS)
        ZSUDU => GET_HOST_DATA_RDWR (YL_ZSUDU)
        ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
        ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
        ZTH => GET_HOST_DATA_RDWR (YL_ZTH)
        ZTINCF => GET_HOST_DATA_RDWR (YL_ZTINCF)
        IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      PAEROCPL => NULL ()
      PALBD => NULL ()
      PALBP => NULL ()
      PAPRS => NULL ()
      PAPRSF => NULL ()
      PGELAM => NULL ()
      PGEMU => NULL ()
      PLSM => NULL ()
      PLWFT => NULL ()
      PRR => NULL ()
      PS => NULL ()
      PSWFT => NULL ()
      PT => NULL ()
      PTS => NULL ()
      ZCCNL => NULL ()
      ZCCNO => NULL ()
      ZEMIT => NULL ()
      ZFCS => NULL ()
      ZFCT => NULL ()
      ZFLUX_PAR => NULL ()
      ZFLUX_PAR_CLEAR => NULL ()
      ZFLUX_UV => NULL ()
      ZFRSOD => NULL ()
      ZFRTED => NULL ()
      ZLWDERIVATIVE => NULL ()
      ZPAERO => NULL ()
      ZPCDIR => NULL ()
      ZPFDIR => NULL ()
      ZPFRSODC => NULL ()
      ZPFRTEDC => NULL ()
      ZPQO3 => NULL ()
      ZQ => NULL ()
      ZQIWP => NULL ()
      ZQLWP => NULL ()
      ZRAER => NULL ()
      ZRC11 => NULL ()
      ZRC12 => NULL ()
      ZRC22 => NULL ()
      ZRCH4 => NULL ()
      ZRCL4 => NULL ()
      ZRCLC => NULL ()
      ZRCO2 => NULL ()
      ZRMU0 => NULL ()
      ZRN2O => NULL ()
      ZRNO2 => NULL ()
      ZSPECTRALEMISS => NULL ()
      ZSUDU => NULL ()
      ZSWDIFFUSEBAND => NULL ()
      ZSWDIRECTBAND => NULL ()
      ZTH => NULL ()
      ZTINCF => NULL ()
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_GPU',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:ECRAD_POST')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZFRSOD => GET_HOST_DATA_RDONLY (YL_ZFRSOD)
    ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
    ZPFDIR => GET_HOST_DATA_RDONLY (YL_ZPFDIR)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      ZPFDIF (:, JBLK)=ZFRSOD (:, JBLK)-ZPFDIR (:, JBLK)
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:ECRAD_POST')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
      ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
      ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZFRSOD => NULL ()
    ZPFDIF => NULL ()
    ZPFDIR => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','RECMWF_PARALLEL:ECRAD_POST')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZFRSOD => GET_HOST_DATA_RDONLY (YL_ZFRSOD)
    ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
    ZPFDIR => GET_HOST_DATA_RDONLY (YL_ZPFDIR)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZPFDIF (JLON, JBLK)=ZFRSOD (JLON, JBLK)-ZPFDIR (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:ECRAD_POST')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
      ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
      ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZFRSOD => NULL ()
    ZPFDIF => NULL ()
    ZPFDIR => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','RECMWF_PARALLEL:ECRAD_POST')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZFRSOD => GET_DEVICE_DATA_RDONLY (YL_ZFRSOD)
    ZPFDIF => GET_DEVICE_DATA_RDWR (YL_ZPFDIF)
    ZPFDIR => GET_DEVICE_DATA_RDONLY (YL_ZPFDIR)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZFRSOD, ZPFDIF, ZPFDIR) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZPFDIF (JLON, JBLK)=ZFRSOD (JLON, JBLK)-ZPFDIR (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:ECRAD_POST')) THEN
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
      ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
      ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
      IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZFRSOD => NULL ()
    ZPFDIF => NULL ()
    ZPFDIR => NULL ()
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:ECRAD_POST',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','RECMWF_PARALLEL:FINISH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAER => GET_HOST_DATA_RDONLY (YD_PAER)
  PALB => GET_HOST_DATA_RDONLY (YD_PALB)
  PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
  PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
  PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
  PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
  PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
  PEMTD => GET_HOST_DATA_RDWR (YD_PEMTD)
  PEMTU => GET_HOST_DATA_RDWR (YD_PEMTU)
  PFSDNN => GET_HOST_DATA_RDONLY (YD_PFSDNN)
  PFSDNV => GET_HOST_DATA_RDONLY (YD_PFSDNV)
  PLWFC => GET_HOST_DATA_RDWR (YD_PLWFC)
  PLWFT => GET_HOST_DATA_RDONLY (YD_PLWFT)
  PMU0LU => GET_HOST_DATA_RDONLY (YD_PMU0LU)
  PMU0M => GET_HOST_DATA_RDONLY (YD_PMU0M)
  PNEB => GET_HOST_DATA_RDONLY (YD_PNEB)
  PQ => GET_HOST_DATA_RDONLY (YD_PQ)
  PQICE => GET_HOST_DATA_RDONLY (YD_PQICE)
  PQLIQ => GET_HOST_DATA_RDONLY (YD_PQLIQ)
  PQO3 => GET_HOST_DATA_RDONLY (YD_PQO3)
  PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
  PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
  PSWDIF => GET_HOST_DATA_RDWR (YD_PSWDIF)
  PSWDIR => GET_HOST_DATA_RDWR (YD_PSWDIR)
  PSWFC => GET_HOST_DATA_RDWR (YD_PSWFC)
  PSWFT => GET_HOST_DATA_RDONLY (YD_PSWFT)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  PTRSO => GET_HOST_DATA_RDWR (YD_PTRSO)
  PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
  PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
  PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
  PVRMOON => GET_HOST_DATA_RDWR (YD_PVRMOON)
  ZFCS => GET_HOST_DATA_RDONLY (YL_ZFCS)
  ZFCT => GET_HOST_DATA_RDONLY (YL_ZFCT)
  ZFRSOD => GET_HOST_DATA_RDONLY (YL_ZFRSOD)
  ZPFDIF => GET_HOST_DATA_RDONLY (YL_ZPFDIF)
  ZPFDIR => GET_HOST_DATA_RDONLY (YL_ZPFDIR)
  ZRCO2 => GET_HOST_DATA_RDONLY (YL_ZRCO2)
  ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
  ZSWDIFFUSEBAND => GET_HOST_DATA_RDONLY (YL_ZSWDIFFUSEBAND)
  ZSWDIRECTBAND => GET_HOST_DATA_RDONLY (YL_ZSWDIRECTBAND)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, JSW, ZSW) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      PSWFC (JLON, 0, JBLK)=ZFCS (JLON, 0, JBLK)
      PSWFC (JLON, 1, JBLK)=ZFCS (JLON, YDCPG_OPTS%KFLEVG+0, JBLK)
      PLWFC (JLON, 0, JBLK)=ZFCT (JLON, 0, JBLK)
      PLWFC (JLON, 1, JBLK)=ZFCT (JLON, YDCPG_OPTS%KFLEVG+0, JBLK)
    ENDDO

    PEMTD(:,:, JBLK)=PLWFT (:,:, 1, JBLK)
    PEMTU(:,:, JBLK)=PLWFT (:,:, 1, JBLK)
    PCEMTR(:,:, JBLK)=PLWFC(:,:, JBLK)

    IF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND..NOT.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN

      DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PTRSODIR (JLON, JSW, JBLK)=ZSWDIRECTBAND (JLON, JSW, JBLK)*(1.-PALBP (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=ZSWDIFFUSEBAND (JLON, JSW, JBLK)*(1.-PALBD (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        ENDDO

      ENDDO

    ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
      ZSW=REAL (YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JPRB)

      DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PTRSODIR (JLON, JSW, JBLK)=ZPFDIR (JLON, JBLK)*(1.-PALBP (JLON, JSW,&
          & JBLK))/ZSW/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=ZPFDIF (JLON, JBLK)*(1.-PALBD (JLON, JSW,&
          & JBLK))/ZSW/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        ENDDO

      ENDDO

    ELSE

      DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PTRSODIR (JLON, JSW, JBLK)=PSFSWDIR (JLON, JSW, JBLK)*(1.-PALBP (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=PSFSWDIF (JLON, JSW, JBLK)*(1.-PALBD (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        ENDDO

      ENDDO

    ENDIF


    DO JLEV=0, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PTRSO (JLON, JLEV, JBLK)=PSWFT (JLON, JLEV, 1, JBLK)/(YDMODEL&
        &%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
      ENDDO

    ENDDO


    DO JLEV=0, 1

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PCTRSO (JLON, JLEV, JBLK)=PSWFC (JLON, JLEV, JBLK)/(YDMODEL&
        &%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
      ENDDO

    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      PTRSOD (JLON, JBLK)=MAX (0.0_JPRB, MIN (1.0_JPRB, ZFRSOD (JLON, JBLK&
      &)/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))))
    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

      IF (PMU0M (JLON, JBLK)<1.E-10_JPRB) THEN
        ZRMU0 (JLON, JBLK)=0.0_JPRB
        PSFSWDIR (JLON,:, JBLK)=0.0_JPRB
        PSFSWDIF (JLON,:, JBLK)=0.0_JPRB
      ENDIF

    ENDDO


    IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN

      IF (YDMODEL%YRML_PHY_RAD%YRERAD%NSW==6) THEN

        DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
          PSWDIR (:, JSW, JBLK)=PTRSODIR (:, JSW, JBLK)
          PSWDIF (:, JSW, JBLK)=PTRSODIF (:, JSW, JBLK)
        ENDDO

      ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%NSW==1) THEN
        PSWDIR (:, 1, JBLK)=PFSDNN (:, JBLK)+PFSDNV (:, JBLK)
        PSWDIF (:, 1, JBLK)=0.0_JPRB
      ENDIF

    ENDIF


    IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAYLU) THEN
      CALL ACRALU (YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY3, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTRADI, YDCPG_OPTS%KFLEVG, PAPRS&
      &(:,:, JBLK), PAPRSF(:,:, JBLK), PDELP(:,:, JBLK), PNEB(:,:, JBLK), PQ(:,:, JBLK), ZRCO2&
      &(:,:, JBLK), PQICE(:,:, JBLK), PQLIQ(:,:, JBLK), PQO3(:,:, JBLK), PT(:,:, JBLK), PALB&
      &(:, JBLK), PMU0LU(:, JBLK), PVRMOON(:, JBLK), PAER(:,:,:, JBLK))
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:FINISH')) THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PALB => GET_HOST_DATA_RDWR (YD_PALB)
    PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
    PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
    PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PEMTD => GET_HOST_DATA_RDWR (YD_PEMTD)
    PEMTU => GET_HOST_DATA_RDWR (YD_PEMTU)
    PFSDNN => GET_HOST_DATA_RDWR (YD_PFSDNN)
    PFSDNV => GET_HOST_DATA_RDWR (YD_PFSDNV)
    PLWFC => GET_HOST_DATA_RDWR (YD_PLWFC)
    PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
    PMU0LU => GET_HOST_DATA_RDWR (YD_PMU0LU)
    PMU0M => GET_HOST_DATA_RDWR (YD_PMU0M)
    PNEB => GET_HOST_DATA_RDWR (YD_PNEB)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLIQ => GET_HOST_DATA_RDWR (YD_PQLIQ)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSWDIF => GET_HOST_DATA_RDWR (YD_PSWDIF)
    PSWDIR => GET_HOST_DATA_RDWR (YD_PSWDIR)
    PSWFC => GET_HOST_DATA_RDWR (YD_PSWFC)
    PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTRSO => GET_HOST_DATA_RDWR (YD_PTRSO)
    PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
    PVRMOON => GET_HOST_DATA_RDWR (YD_PVRMOON)
    ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
    ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
    ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
    ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
    ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
    ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
    ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
    ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
    ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAER => NULL ()
  PALB => NULL ()
  PALBD => NULL ()
  PALBP => NULL ()
  PAPRS => NULL ()
  PAPRSF => NULL ()
  PCEMTR => NULL ()
  PCTRSO => NULL ()
  PDELP => NULL ()
  PEMTD => NULL ()
  PEMTU => NULL ()
  PFSDNN => NULL ()
  PFSDNV => NULL ()
  PLWFC => NULL ()
  PLWFT => NULL ()
  PMU0LU => NULL ()
  PMU0M => NULL ()
  PNEB => NULL ()
  PQ => NULL ()
  PQICE => NULL ()
  PQLIQ => NULL ()
  PQO3 => NULL ()
  PSFSWDIF => NULL ()
  PSFSWDIR => NULL ()
  PSWDIF => NULL ()
  PSWDIR => NULL ()
  PSWFC => NULL ()
  PSWFT => NULL ()
  PT => NULL ()
  PTRSO => NULL ()
  PTRSOD => NULL ()
  PTRSODIF => NULL ()
  PTRSODIR => NULL ()
  PVRMOON => NULL ()
  ZFCS => NULL ()
  ZFCT => NULL ()
  ZFRSOD => NULL ()
  ZPFDIF => NULL ()
  ZPFDIR => NULL ()
  ZRCO2 => NULL ()
  ZRMU0 => NULL ()
  ZSWDIFFUSEBAND => NULL ()
  ZSWDIRECTBAND => NULL ()
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','RECMWF_PARALLEL:FINISH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAER => GET_HOST_DATA_RDONLY (YD_PAER)
  PALB => GET_HOST_DATA_RDONLY (YD_PALB)
  PALBD => GET_HOST_DATA_RDONLY (YD_PALBD)
  PALBP => GET_HOST_DATA_RDONLY (YD_PALBP)
  PAPRS => GET_HOST_DATA_RDONLY (YD_PAPRS)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
  PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
  PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
  PEMTD => GET_HOST_DATA_RDWR (YD_PEMTD)
  PEMTU => GET_HOST_DATA_RDWR (YD_PEMTU)
  PFSDNN => GET_HOST_DATA_RDONLY (YD_PFSDNN)
  PFSDNV => GET_HOST_DATA_RDONLY (YD_PFSDNV)
  PLWFC => GET_HOST_DATA_RDWR (YD_PLWFC)
  PLWFT => GET_HOST_DATA_RDONLY (YD_PLWFT)
  PMU0LU => GET_HOST_DATA_RDONLY (YD_PMU0LU)
  PMU0M => GET_HOST_DATA_RDONLY (YD_PMU0M)
  PNEB => GET_HOST_DATA_RDONLY (YD_PNEB)
  PQ => GET_HOST_DATA_RDONLY (YD_PQ)
  PQICE => GET_HOST_DATA_RDONLY (YD_PQICE)
  PQLIQ => GET_HOST_DATA_RDONLY (YD_PQLIQ)
  PQO3 => GET_HOST_DATA_RDONLY (YD_PQO3)
  PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
  PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
  PSWDIF => GET_HOST_DATA_RDWR (YD_PSWDIF)
  PSWDIR => GET_HOST_DATA_RDWR (YD_PSWDIR)
  PSWFC => GET_HOST_DATA_RDWR (YD_PSWFC)
  PSWFT => GET_HOST_DATA_RDONLY (YD_PSWFT)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  PTRSO => GET_HOST_DATA_RDWR (YD_PTRSO)
  PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
  PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
  PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
  PVRMOON => GET_HOST_DATA_RDWR (YD_PVRMOON)
  ZFCS => GET_HOST_DATA_RDONLY (YL_ZFCS)
  ZFCT => GET_HOST_DATA_RDONLY (YL_ZFCT)
  ZFRSOD => GET_HOST_DATA_RDONLY (YL_ZFRSOD)
  ZPFDIF => GET_HOST_DATA_RDONLY (YL_ZPFDIF)
  ZPFDIR => GET_HOST_DATA_RDONLY (YL_ZPFDIR)
  ZRCO2 => GET_HOST_DATA_RDONLY (YL_ZRCO2)
  ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
  ZSWDIFFUSEBAND => GET_HOST_DATA_RDONLY (YL_ZSWDIFFUSEBAND)
  ZSWDIRECTBAND => GET_HOST_DATA_RDONLY (YL_ZSWDIRECTBAND)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, JSW, YLCPG_BNDS, YLSTACK, ZSW)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      
      PSWFC (JLON, 0, JBLK)=ZFCS (JLON, 0, JBLK)
      PSWFC (JLON, 1, JBLK)=ZFCS (JLON, YDCPG_OPTS%KFLEVG+0, JBLK)
      PLWFC (JLON, 0, JBLK)=ZFCT (JLON, 0, JBLK)
      PLWFC (JLON, 1, JBLK)=ZFCT (JLON, YDCPG_OPTS%KFLEVG+0, JBLK)
      
      PEMTD(JLON,:, JBLK)=PLWFT (JLON,:, 1, JBLK)
      PEMTU(JLON,:, JBLK)=PLWFT (JLON,:, 1, JBLK)
      PCEMTR(JLON,:, JBLK)=PLWFC(JLON,:, JBLK)

      IF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND..NOT.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN

        DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
          
          PTRSODIR (JLON, JSW, JBLK)=ZSWDIRECTBAND (JLON, JSW, JBLK)*(1.-PALBP (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=ZSWDIFFUSEBAND (JLON, JSW, JBLK)*(1.-PALBD (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        
        ENDDO

      ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
        ZSW=REAL (YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JPRB)

        DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
          
          PTRSODIR (JLON, JSW, JBLK)=ZPFDIR (JLON, JBLK)*(1.-PALBP (JLON, JSW,&
          & JBLK))/ZSW/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=ZPFDIF (JLON, JBLK)*(1.-PALBD (JLON, JSW,&
          & JBLK))/ZSW/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        
        ENDDO

      ELSE

        DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
          
          PTRSODIR (JLON, JSW, JBLK)=PSFSWDIR (JLON, JSW, JBLK)*(1.-PALBP (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=PSFSWDIF (JLON, JSW, JBLK)*(1.-PALBD (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        
        ENDDO

      ENDIF


      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        PTRSO (JLON, JLEV, JBLK)=PSWFT (JLON, JLEV, 1, JBLK)/(YDMODEL&
        &%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
      
      ENDDO


      DO JLEV=0, 1
        
        PCTRSO (JLON, JLEV, JBLK)=PSWFC (JLON, JLEV, JBLK)/(YDMODEL&
        &%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
      
      ENDDO

      
      PTRSOD (JLON, JBLK)=MAX (0.0_JPRB, MIN (1.0_JPRB, ZFRSOD (JLON, JBLK&
      &)/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))))

      

      

      IF (PMU0M (JLON, JBLK)<1.E-10_JPRB) THEN
        ZRMU0 (JLON, JBLK)=0.0_JPRB
        PSFSWDIR (JLON,:, JBLK)=0.0_JPRB
        PSFSWDIF (JLON,:, JBLK)=0.0_JPRB
      ENDIF


      

      IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN

        IF (YDMODEL%YRML_PHY_RAD%YRERAD%NSW==6) THEN

          DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
            PSWDIR (JLON, JSW, JBLK)=PTRSODIR (JLON, JSW, JBLK)
            PSWDIF (JLON, JSW, JBLK)=PTRSODIF (JLON, JSW, JBLK)
          ENDDO

        ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%NSW==1) THEN
          PSWDIR (JLON, 1, JBLK)=PFSDNN (JLON, JBLK)+PFSDNV (JLON, JBLK)
          PSWDIF (JLON, 1, JBLK)=0.0_JPRB
        ENDIF

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAYLU) THEN
        CALL ACRALU_OPENACC (YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY3, YLCPG_BNDS%KIDIA&
        &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTRADI, YDCPG_OPTS%KFLEVG&
        &, PAPRS(:,:, JBLK), PAPRSF(:,:, JBLK), PDELP(:,:, JBLK), PNEB(:,:, JBLK), PQ(:,:, JBLK),&
        & ZRCO2(:,:, JBLK), PQICE(:,:, JBLK), PQLIQ(:,:, JBLK), PQO3(:,:, JBLK), PT(:,:, JBLK), PALB&
        &(:, JBLK), PMU0LU(:, JBLK), PVRMOON(:, JBLK), PAER(:,:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:FINISH')) THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PALB => GET_HOST_DATA_RDWR (YD_PALB)
    PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
    PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
    PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PEMTD => GET_HOST_DATA_RDWR (YD_PEMTD)
    PEMTU => GET_HOST_DATA_RDWR (YD_PEMTU)
    PFSDNN => GET_HOST_DATA_RDWR (YD_PFSDNN)
    PFSDNV => GET_HOST_DATA_RDWR (YD_PFSDNV)
    PLWFC => GET_HOST_DATA_RDWR (YD_PLWFC)
    PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
    PMU0LU => GET_HOST_DATA_RDWR (YD_PMU0LU)
    PMU0M => GET_HOST_DATA_RDWR (YD_PMU0M)
    PNEB => GET_HOST_DATA_RDWR (YD_PNEB)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLIQ => GET_HOST_DATA_RDWR (YD_PQLIQ)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSWDIF => GET_HOST_DATA_RDWR (YD_PSWDIF)
    PSWDIR => GET_HOST_DATA_RDWR (YD_PSWDIR)
    PSWFC => GET_HOST_DATA_RDWR (YD_PSWFC)
    PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTRSO => GET_HOST_DATA_RDWR (YD_PTRSO)
    PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
    PVRMOON => GET_HOST_DATA_RDWR (YD_PVRMOON)
    ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
    ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
    ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
    ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
    ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
    ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
    ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
    ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
    ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAER => NULL ()
  PALB => NULL ()
  PALBD => NULL ()
  PALBP => NULL ()
  PAPRS => NULL ()
  PAPRSF => NULL ()
  PCEMTR => NULL ()
  PCTRSO => NULL ()
  PDELP => NULL ()
  PEMTD => NULL ()
  PEMTU => NULL ()
  PFSDNN => NULL ()
  PFSDNV => NULL ()
  PLWFC => NULL ()
  PLWFT => NULL ()
  PMU0LU => NULL ()
  PMU0M => NULL ()
  PNEB => NULL ()
  PQ => NULL ()
  PQICE => NULL ()
  PQLIQ => NULL ()
  PQO3 => NULL ()
  PSFSWDIF => NULL ()
  PSFSWDIR => NULL ()
  PSWDIF => NULL ()
  PSWDIR => NULL ()
  PSWFC => NULL ()
  PSWFT => NULL ()
  PT => NULL ()
  PTRSO => NULL ()
  PTRSOD => NULL ()
  PTRSODIF => NULL ()
  PTRSODIR => NULL ()
  PVRMOON => NULL ()
  ZFCS => NULL ()
  ZFCT => NULL ()
  ZFRSOD => NULL ()
  ZPFDIF => NULL ()
  ZPFDIR => NULL ()
  ZRCO2 => NULL ()
  ZRMU0 => NULL ()
  ZSWDIFFUSEBAND => NULL ()
  ZSWDIRECTBAND => NULL ()
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','RECMWF_PARALLEL:FINISH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAER => GET_DEVICE_DATA_RDONLY (YD_PAER)
  PALB => GET_DEVICE_DATA_RDONLY (YD_PALB)
  PALBD => GET_DEVICE_DATA_RDONLY (YD_PALBD)
  PALBP => GET_DEVICE_DATA_RDONLY (YD_PALBP)
  PAPRS => GET_DEVICE_DATA_RDONLY (YD_PAPRS)
  PAPRSF => GET_DEVICE_DATA_RDONLY (YD_PAPRSF)
  PCEMTR => GET_DEVICE_DATA_RDWR (YD_PCEMTR)
  PCTRSO => GET_DEVICE_DATA_RDWR (YD_PCTRSO)
  PDELP => GET_DEVICE_DATA_RDONLY (YD_PDELP)
  PEMTD => GET_DEVICE_DATA_RDWR (YD_PEMTD)
  PEMTU => GET_DEVICE_DATA_RDWR (YD_PEMTU)
  PFSDNN => GET_DEVICE_DATA_RDONLY (YD_PFSDNN)
  PFSDNV => GET_DEVICE_DATA_RDONLY (YD_PFSDNV)
  PLWFC => GET_DEVICE_DATA_RDWR (YD_PLWFC)
  PLWFT => GET_DEVICE_DATA_RDONLY (YD_PLWFT)
  PMU0LU => GET_DEVICE_DATA_RDONLY (YD_PMU0LU)
  PMU0M => GET_DEVICE_DATA_RDONLY (YD_PMU0M)
  PNEB => GET_DEVICE_DATA_RDONLY (YD_PNEB)
  PQ => GET_DEVICE_DATA_RDONLY (YD_PQ)
  PQICE => GET_DEVICE_DATA_RDONLY (YD_PQICE)
  PQLIQ => GET_DEVICE_DATA_RDONLY (YD_PQLIQ)
  PQO3 => GET_DEVICE_DATA_RDONLY (YD_PQO3)
  PSFSWDIF => GET_DEVICE_DATA_RDWR (YD_PSFSWDIF)
  PSFSWDIR => GET_DEVICE_DATA_RDWR (YD_PSFSWDIR)
  PSWDIF => GET_DEVICE_DATA_RDWR (YD_PSWDIF)
  PSWDIR => GET_DEVICE_DATA_RDWR (YD_PSWDIR)
  PSWFC => GET_DEVICE_DATA_RDWR (YD_PSWFC)
  PSWFT => GET_DEVICE_DATA_RDONLY (YD_PSWFT)
  PT => GET_DEVICE_DATA_RDONLY (YD_PT)
  PTRSO => GET_DEVICE_DATA_RDWR (YD_PTRSO)
  PTRSOD => GET_DEVICE_DATA_RDWR (YD_PTRSOD)
  PTRSODIF => GET_DEVICE_DATA_RDWR (YD_PTRSODIF)
  PTRSODIR => GET_DEVICE_DATA_RDWR (YD_PTRSODIR)
  PVRMOON => GET_DEVICE_DATA_RDWR (YD_PVRMOON)
  ZFCS => GET_DEVICE_DATA_RDONLY (YL_ZFCS)
  ZFCT => GET_DEVICE_DATA_RDONLY (YL_ZFCT)
  ZFRSOD => GET_DEVICE_DATA_RDONLY (YL_ZFRSOD)
  ZPFDIF => GET_DEVICE_DATA_RDONLY (YL_ZPFDIF)
  ZPFDIR => GET_DEVICE_DATA_RDONLY (YL_ZPFDIR)
  ZRCO2 => GET_DEVICE_DATA_RDONLY (YL_ZRCO2)
  ZRMU0 => GET_DEVICE_DATA_RDWR (YL_ZRMU0)
  ZSWDIFFUSEBAND => GET_DEVICE_DATA_RDONLY (YL_ZSWDIFFUSEBAND)
  ZSWDIRECTBAND => GET_DEVICE_DATA_RDONLY (YL_ZSWDIRECTBAND)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PAER, PALB, PALBD, PALBP, PAPRS, PAPRSF, PCEMTR, PCTRSO, PDELP, PEMTD, &
    !$ACC&         PEMTU, PFSDNN, PFSDNV, PLWFC, PLWFT, PMU0LU, PMU0M, PNEB, PQ, PQICE, PQLIQ, &
    !$ACC&         PQO3, PSFSWDIF, PSFSWDIR, PSWDIF, PSWDIR, PSWFC, PSWFT, PT, PTRSO, PTRSOD, &
    !$ACC&         PTRSODIF, PTRSODIR, PVRMOON, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZFCS, ZFCT, ZFRSOD, ZPFDIF, ZPFDIR, ZRCO2, ZRMU0, ZSWDIFFUSEBAND, ZSWDIRECTBAND) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, JSW, YLCPG_BNDS, YLSTACK, ZSW) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      
      PSWFC (JLON, 0, JBLK)=ZFCS (JLON, 0, JBLK)
      PSWFC (JLON, 1, JBLK)=ZFCS (JLON, YDCPG_OPTS%KFLEVG+0, JBLK)
      PLWFC (JLON, 0, JBLK)=ZFCT (JLON, 0, JBLK)
      PLWFC (JLON, 1, JBLK)=ZFCT (JLON, YDCPG_OPTS%KFLEVG+0, JBLK)
      
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, PEMTD(:,:, JBLK), PLWFT (:,:, 1, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, PEMTU(:,:, JBLK), PLWFT (:,:, 1, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, PCEMTR(:,:, JBLK), PLWFC(:,:, JBLK))

      IF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND..NOT.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN

        DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
          
          PTRSODIR (JLON, JSW, JBLK)=ZSWDIRECTBAND (JLON, JSW, JBLK)*(1.-PALBP (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=ZSWDIFFUSEBAND (JLON, JSW, JBLK)*(1.-PALBD (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        
        ENDDO

      ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%LSRTM.AND.YDMODEL%YRML_PHY_RAD%YRERAD%LUSEPRE2017RAD) THEN
        ZSW=REAL (YDMODEL%YRML_PHY_RAD%YRERAD%NSW, JPRB)

        DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
          
          PTRSODIR (JLON, JSW, JBLK)=ZPFDIR (JLON, JBLK)*(1.-PALBP (JLON, JSW,&
          & JBLK))/ZSW/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=ZPFDIF (JLON, JBLK)*(1.-PALBD (JLON, JSW,&
          & JBLK))/ZSW/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        
        ENDDO

      ELSE

        DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
          
          PTRSODIR (JLON, JSW, JBLK)=PSFSWDIR (JLON, JSW, JBLK)*(1.-PALBP (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
          PTRSODIF (JLON, JSW, JBLK)=PSFSWDIF (JLON, JSW, JBLK)*(1.-PALBD (JLON&
          &, JSW, JBLK))/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
        
        ENDDO

      ENDIF


      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        PTRSO (JLON, JLEV, JBLK)=PSWFT (JLON, JLEV, 1, JBLK)/(YDMODEL&
        &%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
      
      ENDDO


      DO JLEV=0, 1
        
        PCTRSO (JLON, JLEV, JBLK)=PSWFC (JLON, JLEV, JBLK)/(YDMODEL&
        &%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))
      
      ENDDO

      
      PTRSOD (JLON, JBLK)=MAX (0.0_JPRB, MIN (1.0_JPRB, ZFRSOD (JLON, JBLK&
      &)/(YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRMU0 (JLON, JBLK))))

      

      

      IF (PMU0M (JLON, JBLK)<1.E-10_JPRB) THEN
        ZRMU0 (JLON, JBLK)=0.0_JPRB
        PSFSWDIR (JLON,:, JBLK)=0.0_JPRB
        PSFSWDIF (JLON,:, JBLK)=0.0_JPRB
      ENDIF


      

      IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN

        IF (YDMODEL%YRML_PHY_RAD%YRERAD%NSW==6) THEN

          DO JSW=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
            PSWDIR (JLON, JSW, JBLK)=PTRSODIR (JLON, JSW, JBLK)
            PSWDIF (JLON, JSW, JBLK)=PTRSODIF (JLON, JSW, JBLK)
          ENDDO

        ELSEIF (YDMODEL%YRML_PHY_RAD%YRERAD%NSW==1) THEN
          PSWDIR (JLON, 1, JBLK)=PFSDNN (JLON, JBLK)+PFSDNV (JLON, JBLK)
          PSWDIF (JLON, 1, JBLK)=0.0_JPRB
        ENDIF

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LRAYLU) THEN
        CALL ACRALU_OPENACC (YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY3, YLCPG_BNDS%KIDIA&
        &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTRADI, YDCPG_OPTS%KFLEVG&
        &, PAPRS(:,:, JBLK), PAPRSF(:,:, JBLK), PDELP(:,:, JBLK), PNEB(:,:, JBLK), PQ(:,:, JBLK),&
        & ZRCO2(:,:, JBLK), PQICE(:,:, JBLK), PQLIQ(:,:, JBLK), PQO3(:,:, JBLK), PT(:,:, JBLK), PALB&
        &(:, JBLK), PMU0LU(:, JBLK), PVRMOON(:, JBLK), PAER(:,:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('RECMWF_PARALLEL:FINISH')) THEN
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PALB => GET_HOST_DATA_RDWR (YD_PALB)
    PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
    PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
    PAPRS => GET_HOST_DATA_RDWR (YD_PAPRS)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PEMTD => GET_HOST_DATA_RDWR (YD_PEMTD)
    PEMTU => GET_HOST_DATA_RDWR (YD_PEMTU)
    PFSDNN => GET_HOST_DATA_RDWR (YD_PFSDNN)
    PFSDNV => GET_HOST_DATA_RDWR (YD_PFSDNV)
    PLWFC => GET_HOST_DATA_RDWR (YD_PLWFC)
    PLWFT => GET_HOST_DATA_RDWR (YD_PLWFT)
    PMU0LU => GET_HOST_DATA_RDWR (YD_PMU0LU)
    PMU0M => GET_HOST_DATA_RDWR (YD_PMU0M)
    PNEB => GET_HOST_DATA_RDWR (YD_PNEB)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLIQ => GET_HOST_DATA_RDWR (YD_PQLIQ)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSWDIF => GET_HOST_DATA_RDWR (YD_PSWDIF)
    PSWDIR => GET_HOST_DATA_RDWR (YD_PSWDIR)
    PSWFC => GET_HOST_DATA_RDWR (YD_PSWFC)
    PSWFT => GET_HOST_DATA_RDWR (YD_PSWFT)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTRSO => GET_HOST_DATA_RDWR (YD_PTRSO)
    PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
    PVRMOON => GET_HOST_DATA_RDWR (YD_PVRMOON)
    ZFCS => GET_HOST_DATA_RDWR (YL_ZFCS)
    ZFCT => GET_HOST_DATA_RDWR (YL_ZFCT)
    ZFRSOD => GET_HOST_DATA_RDWR (YL_ZFRSOD)
    ZPFDIF => GET_HOST_DATA_RDWR (YL_ZPFDIF)
    ZPFDIR => GET_HOST_DATA_RDWR (YL_ZPFDIR)
    ZRCO2 => GET_HOST_DATA_RDWR (YL_ZRCO2)
    ZRMU0 => GET_HOST_DATA_RDWR (YL_ZRMU0)
    ZSWDIFFUSEBAND => GET_HOST_DATA_RDWR (YL_ZSWDIFFUSEBAND)
    ZSWDIRECTBAND => GET_HOST_DATA_RDWR (YL_ZSWDIRECTBAND)
    IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAER => NULL ()
  PALB => NULL ()
  PALBD => NULL ()
  PALBP => NULL ()
  PAPRS => NULL ()
  PAPRSF => NULL ()
  PCEMTR => NULL ()
  PCTRSO => NULL ()
  PDELP => NULL ()
  PEMTD => NULL ()
  PEMTU => NULL ()
  PFSDNN => NULL ()
  PFSDNV => NULL ()
  PLWFC => NULL ()
  PLWFT => NULL ()
  PMU0LU => NULL ()
  PMU0M => NULL ()
  PNEB => NULL ()
  PQ => NULL ()
  PQICE => NULL ()
  PQLIQ => NULL ()
  PQO3 => NULL ()
  PSFSWDIF => NULL ()
  PSFSWDIR => NULL ()
  PSWDIF => NULL ()
  PSWDIR => NULL ()
  PSWFC => NULL ()
  PSWFT => NULL ()
  PT => NULL ()
  PTRSO => NULL ()
  PTRSOD => NULL ()
  PTRSODIF => NULL ()
  PTRSODIR => NULL ()
  PVRMOON => NULL ()
  ZFCS => NULL ()
  ZFCT => NULL ()
  ZFRSOD => NULL ()
  ZPFDIF => NULL ()
  ZPFDIR => NULL ()
  ZRCO2 => NULL ()
  ZRMU0 => NULL ()
  ZSWDIFFUSEBAND => NULL ()
  ZSWDIRECTBAND => NULL ()
  IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('RECMWF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL:FINISH',1,ZHOOK_HANDLE_PARALLEL)




CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZCCNL)) CALL FIELD_DELETE (YL_ZCCNL)
IF (ASSOCIATED (YL_ZCCNO)) CALL FIELD_DELETE (YL_ZCCNO)
IF (ASSOCIATED (YL_ZCLDROP)) CALL FIELD_DELETE (YL_ZCLDROP)
IF (ASSOCIATED (YL_ZEMIT)) CALL FIELD_DELETE (YL_ZEMIT)
IF (ASSOCIATED (YL_ZEMIW)) CALL FIELD_DELETE (YL_ZEMIW)
IF (ASSOCIATED (YL_ZFCS)) CALL FIELD_DELETE (YL_ZFCS)
IF (ASSOCIATED (YL_ZFCT)) CALL FIELD_DELETE (YL_ZFCT)
IF (ASSOCIATED (YL_ZFLUX_PAR)) CALL FIELD_DELETE (YL_ZFLUX_PAR)
IF (ASSOCIATED (YL_ZFLUX_PAR_CLEAR)) CALL FIELD_DELETE (YL_ZFLUX_PAR_CLEAR)
IF (ASSOCIATED (YL_ZFLUX_UV)) CALL FIELD_DELETE (YL_ZFLUX_UV)
IF (ASSOCIATED (YL_ZFRSOD)) CALL FIELD_DELETE (YL_ZFRSOD)
IF (ASSOCIATED (YL_ZFRTED)) CALL FIELD_DELETE (YL_ZFRTED)
IF (ASSOCIATED (YL_ZLWDERIVATIVE)) CALL FIELD_DELETE (YL_ZLWDERIVATIVE)
IF (ASSOCIATED (YL_ZNBAS)) CALL FIELD_DELETE (YL_ZNBAS)
IF (ASSOCIATED (YL_ZNTOP)) CALL FIELD_DELETE (YL_ZNTOP)
IF (ASSOCIATED (YL_ZPAERO)) CALL FIELD_DELETE (YL_ZPAERO)
IF (ASSOCIATED (YL_ZPARCF)) CALL FIELD_DELETE (YL_ZPARCF)
IF (ASSOCIATED (YL_ZPARF)) CALL FIELD_DELETE (YL_ZPARF)
IF (ASSOCIATED (YL_ZPCDIR)) CALL FIELD_DELETE (YL_ZPCDIR)
IF (ASSOCIATED (YL_ZPFDIF)) CALL FIELD_DELETE (YL_ZPFDIF)
IF (ASSOCIATED (YL_ZPFDIR)) CALL FIELD_DELETE (YL_ZPFDIR)
IF (ASSOCIATED (YL_ZPFRSODC)) CALL FIELD_DELETE (YL_ZPFRSODC)
IF (ASSOCIATED (YL_ZPFRTEDC)) CALL FIELD_DELETE (YL_ZPFRTEDC)
IF (ASSOCIATED (YL_ZPQO3)) CALL FIELD_DELETE (YL_ZPQO3)
IF (ASSOCIATED (YL_ZQ)) CALL FIELD_DELETE (YL_ZQ)
IF (ASSOCIATED (YL_ZQIWP)) CALL FIELD_DELETE (YL_ZQIWP)
IF (ASSOCIATED (YL_ZQLWP)) CALL FIELD_DELETE (YL_ZQLWP)
IF (ASSOCIATED (YL_ZQS)) CALL FIELD_DELETE (YL_ZQS)
IF (ASSOCIATED (YL_ZRAER)) CALL FIELD_DELETE (YL_ZRAER)
IF (ASSOCIATED (YL_ZRC11)) CALL FIELD_DELETE (YL_ZRC11)
IF (ASSOCIATED (YL_ZRC12)) CALL FIELD_DELETE (YL_ZRC12)
IF (ASSOCIATED (YL_ZRC22)) CALL FIELD_DELETE (YL_ZRC22)
IF (ASSOCIATED (YL_ZRCH4)) CALL FIELD_DELETE (YL_ZRCH4)
IF (ASSOCIATED (YL_ZRCL4)) CALL FIELD_DELETE (YL_ZRCL4)
IF (ASSOCIATED (YL_ZRCLC)) CALL FIELD_DELETE (YL_ZRCLC)
IF (ASSOCIATED (YL_ZRCO2)) CALL FIELD_DELETE (YL_ZRCO2)
IF (ASSOCIATED (YL_ZRLWINHF)) CALL FIELD_DELETE (YL_ZRLWINHF)
IF (ASSOCIATED (YL_ZRMU0)) CALL FIELD_DELETE (YL_ZRMU0)
IF (ASSOCIATED (YL_ZRN2O)) CALL FIELD_DELETE (YL_ZRN2O)
IF (ASSOCIATED (YL_ZRNO2)) CALL FIELD_DELETE (YL_ZRNO2)
IF (ASSOCIATED (YL_ZRSWINHF)) CALL FIELD_DELETE (YL_ZRSWINHF)
IF (ASSOCIATED (YL_ZSPECTRALEMISS)) CALL FIELD_DELETE (YL_ZSPECTRALEMISS)
IF (ASSOCIATED (YL_ZSUDU)) CALL FIELD_DELETE (YL_ZSUDU)
IF (ASSOCIATED (YL_ZSWDIFFUSEBAND)) CALL FIELD_DELETE (YL_ZSWDIFFUSEBAND)
IF (ASSOCIATED (YL_ZSWDIRECTBAND)) CALL FIELD_DELETE (YL_ZSWDIRECTBAND)
IF (ASSOCIATED (YL_ZTH)) CALL FIELD_DELETE (YL_ZTH)
IF (ASSOCIATED (YL_ZTINCF)) CALL FIELD_DELETE (YL_ZTINCF)
IF (ASSOCIATED (YL_ZUVDF)) CALL FIELD_DELETE (YL_ZUVDF)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('RECMWF_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE RECMWF_PARALLEL
