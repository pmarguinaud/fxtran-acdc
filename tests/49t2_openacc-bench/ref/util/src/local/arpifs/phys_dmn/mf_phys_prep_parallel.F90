SUBROUTINE MF_PHYS_PREP_PARALLEL (YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDARPHY&
&, YDDYNA, YDCPG_DYN0, YDCPG_DYN9, YDCPG_PHY0, YDCPG_PHY9, YDVARS)
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES

USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_PHY_TYPE
USE YOMCST,ONLY:RG
USE YOMARPHY,ONLY:TARPHY
USE YOMDYNA,ONLY:TDYNA
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (TARPHY), INTENT (IN)::YDARPHY
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN9
TYPE (CPG_PHY_TYPE), INTENT (INOUT)::YDCPG_PHY0
TYPE (CPG_PHY_TYPE), INTENT (INOUT)::YDCPG_PHY9
TYPE (FIELD_VARIABLES), INTENT (IN)::YDVARS
REAL (KIND=JPRB)::ZUSG
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JLEV
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_GWFL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_GWFM(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_GWFT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_NHPREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_NHPREH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_PREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_ALPH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_LNPR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_GWFT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_NHPREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_NHPREH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_PRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_PREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_XYB_ALPH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_XYB_LNPR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN9_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_PRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_PREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_W(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_WL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_WM(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_XYB_ALPH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_XYB_LNPR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_PRE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_PREF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_W(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_XYB_ALPH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_XYB_LNPR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY9_XYB_RDELP(:,:,:)
#include "abor1.intfb.h"
IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)


ZUSG=1.0_JPRB/RG
IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','MF_PHYS_PREP_PARALLEL:PREP')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_GWFL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFL)
  Z_YDCPG_DYN0_GWFM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFM)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_NHPREF => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_NHPREF)
  Z_YDCPG_DYN0_NHPREH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_NHPREH)
  Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREF)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN9_GWFT => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_GWFT)
  Z_YDCPG_DYN9_NHPREF => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_NHPREF)
  Z_YDCPG_DYN9_NHPREH => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_NHPREH)
  Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_PRE)
  Z_YDCPG_DYN9_PREF => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_PREF)
  Z_YDCPG_DYN9_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_ALPH)
  Z_YDCPG_DYN9_XYB_DELP => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_DELP)
  Z_YDCPG_DYN9_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_LNPR)
  Z_YDCPG_DYN9_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_RDELP)
  Z_YDCPG_PHY0_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PRE)
  Z_YDCPG_PHY0_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREF)
  Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYD)
  Z_YDCPG_PHY0_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYDF)
  Z_YDCPG_PHY0_W => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_W)
  Z_YDCPG_PHY0_WL => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WL)
  Z_YDCPG_PHY0_WM => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WM)
  Z_YDCPG_PHY0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_ALPH)
  Z_YDCPG_PHY0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_DELP)
  Z_YDCPG_PHY0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_LNPR)
  Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
  Z_YDCPG_PHY9_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PRE)
  Z_YDCPG_PHY9_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREF)
  Z_YDCPG_PHY9_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYD)
  Z_YDCPG_PHY9_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYDF)
  Z_YDCPG_PHY9_W => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_W)
  Z_YDCPG_PHY9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_ALPH)
  Z_YDCPG_PHY9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_DELP)
  Z_YDCPG_PHY9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_LNPR)
  Z_YDCPG_PHY9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDCPG_PHY0_W (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFT (JLON, JLEV, JBLK)*ZUSG
      ENDDO

    ENDDO


    IF (YDARPHY%LMPA.AND.(.NOT.YDDYNA%LTWOTL)) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_PHY9_W (JLON, JLEV, JBLK)=Z_YDCPG_DYN9_GWFT (JLON, JLEV, JBLK)*ZUSG
        ENDDO

      ENDDO

    ELSEIF (.NOT.YDDYNA%LTWOTL) THEN
      Z_YDCPG_PHY9_W (:,:, JBLK)=0.0_JPRB
    ENDIF


    IF (YDDYNA%LNHDYN) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_PHY0_WL (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFL (JLON, JLEV, JBLK)*ZUSG
          Z_YDCPG_PHY0_WM (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFM (JLON, JLEV, JBLK)*ZUSG
        ENDDO

      ENDDO

    ELSE
      Z_YDCPG_PHY0_WL (:,:, JBLK)=0.0_JPRB
      Z_YDCPG_PHY0_WM (:,:, JBLK)=0.0_JPRB
    ENDIF

    Z_YDCPG_PHY0_PREF (:,:, JBLK)=0.0_JPRB
    Z_YDCPG_PHY0_PRE (:,:, JBLK)=0.0_JPRB

    IF (.NOT.YDDYNA%LTWOTL) THEN
      Z_YDCPG_PHY9_PREF (:,:, JBLK)=0.0_JPRB
      Z_YDCPG_PHY9_PRE (:,:, JBLK)=0.0_JPRB
    ENDIF


    IF (YDARPHY%LMPA) THEN

      IF (YDDYNA%LNHDYN.AND.YDDYNA%LTWOTL) THEN
        Z_YDCPG_PHY0_PREF (:,:, JBLK)=Z_YDCPG_DYN0_NHPREF (:,:, JBLK)
        Z_YDCPG_PHY0_PRE (:,:, JBLK)=Z_YDCPG_DYN0_NHPREH (:,:, JBLK)
      ELSEIF (YDDYNA%LNHDYN.AND.(.NOT.YDDYNA%LTWOTL)) THEN
        Z_YDCPG_PHY9_PREF (:,:, JBLK)=Z_YDCPG_DYN9_NHPREF (:,:, JBLK)
        Z_YDCPG_PHY9_PRE (:,:, JBLK)=Z_YDCPG_DYN9_NHPREH (:,:, JBLK)
      ELSEIF ((.NOT.YDDYNA%LNHDYN).AND.YDDYNA%LTWOTL) THEN
        Z_YDCPG_PHY0_PREF (:,:, JBLK)=Z_YDCPG_DYN0_PREF (:,:, JBLK)
        Z_YDCPG_PHY0_PRE (:,:, JBLK)=Z_YDCPG_DYN0_PRE (:,:, JBLK)
      ELSEIF ((.NOT.YDDYNA%LNHDYN).AND.(.NOT.YDDYNA%LTWOTL)) THEN
        Z_YDCPG_PHY9_PREF (:,:, JBLK)=Z_YDCPG_DYN9_PREF (:,:, JBLK)
        Z_YDCPG_PHY9_PRE (:,:, JBLK)=Z_YDCPG_DYN9_PRE (:,:, JBLK)
      ENDIF

    ENDIF

    Z_YDCPG_PHY0_PREHYDF (:,:, JBLK)=Z_YDCPG_DYN0_PREF (:,:, JBLK)
    Z_YDCPG_PHY0_PREHYD (:,:, JBLK)=Z_YDCPG_DYN0_PRE (:,:, JBLK)
    Z_YDCPG_PHY0_XYB_DELP (:,:, JBLK)=Z_YDCPG_DYN0_XYB_DELP (:,:, JBLK)
    Z_YDCPG_PHY0_XYB_RDELP (:,:, JBLK)=Z_YDCPG_DYN0_XYB_RDELP (:,:, JBLK)
    Z_YDCPG_PHY0_XYB_LNPR (:,:, JBLK)=Z_YDCPG_DYN0_XYB_LNPR (:,:, JBLK)
    Z_YDCPG_PHY0_XYB_ALPH (:,:, JBLK)=Z_YDCPG_DYN0_XYB_ALPH (:,:, JBLK)

    IF (.NOT.YDDYNA%LTWOTL) THEN
      Z_YDCPG_PHY9_PREHYDF (:,:, JBLK)=Z_YDCPG_DYN9_PREF (:,:, JBLK)
      Z_YDCPG_PHY9_PREHYD (:,:, JBLK)=Z_YDCPG_DYN9_PRE (:,:, JBLK)
      Z_YDCPG_PHY9_XYB_DELP (:,:, JBLK)=Z_YDCPG_DYN9_XYB_DELP (:,:, JBLK)
      Z_YDCPG_PHY9_XYB_RDELP (:,:, JBLK)=Z_YDCPG_DYN9_XYB_RDELP (:,:, JBLK)
      Z_YDCPG_PHY9_XYB_LNPR (:,:, JBLK)=Z_YDCPG_DYN9_XYB_LNPR (:,:, JBLK)
      Z_YDCPG_PHY9_XYB_ALPH (:,:, JBLK)=Z_YDCPG_DYN9_XYB_ALPH (:,:, JBLK)
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('MF_PHYS_PREP_PARALLEL:PREP')) THEN
    IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN0_GWFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFL)
    Z_YDCPG_DYN0_GWFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFM)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_NHPREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHPREF)
    Z_YDCPG_DYN0_NHPREH => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHPREH)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN9_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_GWFT)
    Z_YDCPG_DYN9_NHPREF => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHPREF)
    Z_YDCPG_DYN9_NHPREH => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHPREH)
    Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
    Z_YDCPG_DYN9_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREF)
    Z_YDCPG_DYN9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_ALPH)
    Z_YDCPG_DYN9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_DELP)
    Z_YDCPG_DYN9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_LNPR)
    Z_YDCPG_DYN9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_RDELP)
    Z_YDCPG_PHY0_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PRE)
    Z_YDCPG_PHY0_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREF)
    Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYD)
    Z_YDCPG_PHY0_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYDF)
    Z_YDCPG_PHY0_W => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_W)
    Z_YDCPG_PHY0_WL => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WL)
    Z_YDCPG_PHY0_WM => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WM)
    Z_YDCPG_PHY0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_ALPH)
    Z_YDCPG_PHY0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_DELP)
    Z_YDCPG_PHY0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_LNPR)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
    Z_YDCPG_PHY9_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PRE)
    Z_YDCPG_PHY9_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREF)
    Z_YDCPG_PHY9_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYD)
    Z_YDCPG_PHY9_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYDF)
    Z_YDCPG_PHY9_W => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_W)
    Z_YDCPG_PHY9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_ALPH)
    Z_YDCPG_PHY9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_DELP)
    Z_YDCPG_PHY9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_LNPR)
    Z_YDCPG_PHY9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_GWFL => NULL ()
  Z_YDCPG_DYN0_GWFM => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_NHPREF => NULL ()
  Z_YDCPG_DYN0_NHPREH => NULL ()
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN9_GWFT => NULL ()
  Z_YDCPG_DYN9_NHPREF => NULL ()
  Z_YDCPG_DYN9_NHPREH => NULL ()
  Z_YDCPG_DYN9_PRE => NULL ()
  Z_YDCPG_DYN9_PREF => NULL ()
  Z_YDCPG_DYN9_XYB_ALPH => NULL ()
  Z_YDCPG_DYN9_XYB_DELP => NULL ()
  Z_YDCPG_DYN9_XYB_LNPR => NULL ()
  Z_YDCPG_DYN9_XYB_RDELP => NULL ()
  Z_YDCPG_PHY0_PRE => NULL ()
  Z_YDCPG_PHY0_PREF => NULL ()
  Z_YDCPG_PHY0_PREHYD => NULL ()
  Z_YDCPG_PHY0_PREHYDF => NULL ()
  Z_YDCPG_PHY0_W => NULL ()
  Z_YDCPG_PHY0_WL => NULL ()
  Z_YDCPG_PHY0_WM => NULL ()
  Z_YDCPG_PHY0_XYB_ALPH => NULL ()
  Z_YDCPG_PHY0_XYB_DELP => NULL ()
  Z_YDCPG_PHY0_XYB_LNPR => NULL ()
  Z_YDCPG_PHY0_XYB_RDELP => NULL ()
  Z_YDCPG_PHY9_PRE => NULL ()
  Z_YDCPG_PHY9_PREF => NULL ()
  Z_YDCPG_PHY9_PREHYD => NULL ()
  Z_YDCPG_PHY9_PREHYDF => NULL ()
  Z_YDCPG_PHY9_W => NULL ()
  Z_YDCPG_PHY9_XYB_ALPH => NULL ()
  Z_YDCPG_PHY9_XYB_DELP => NULL ()
  Z_YDCPG_PHY9_XYB_LNPR => NULL ()
  Z_YDCPG_PHY9_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','MF_PHYS_PREP_PARALLEL:PREP')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_GWFL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFL)
  Z_YDCPG_DYN0_GWFM => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFM)
  Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_NHPREF => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_NHPREF)
  Z_YDCPG_DYN0_NHPREH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_NHPREH)
  Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDONLY (YDCPG_DYN0%F_PREF)
  Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN9_GWFT => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_GWFT)
  Z_YDCPG_DYN9_NHPREF => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_NHPREF)
  Z_YDCPG_DYN9_NHPREH => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_NHPREH)
  Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_PRE)
  Z_YDCPG_DYN9_PREF => GET_HOST_DATA_RDONLY (YDCPG_DYN9%F_PREF)
  Z_YDCPG_DYN9_XYB_ALPH => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_ALPH)
  Z_YDCPG_DYN9_XYB_DELP => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_DELP)
  Z_YDCPG_DYN9_XYB_LNPR => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_LNPR)
  Z_YDCPG_DYN9_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_DYN9%XYB%F_RDELP)
  Z_YDCPG_PHY0_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PRE)
  Z_YDCPG_PHY0_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREF)
  Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYD)
  Z_YDCPG_PHY0_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYDF)
  Z_YDCPG_PHY0_W => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_W)
  Z_YDCPG_PHY0_WL => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WL)
  Z_YDCPG_PHY0_WM => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WM)
  Z_YDCPG_PHY0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_ALPH)
  Z_YDCPG_PHY0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_DELP)
  Z_YDCPG_PHY0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_LNPR)
  Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
  Z_YDCPG_PHY9_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PRE)
  Z_YDCPG_PHY9_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREF)
  Z_YDCPG_PHY9_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYD)
  Z_YDCPG_PHY9_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYDF)
  Z_YDCPG_PHY9_W => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_W)
  Z_YDCPG_PHY9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_ALPH)
  Z_YDCPG_PHY9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_DELP)
  Z_YDCPG_PHY9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_LNPR)
  Z_YDCPG_PHY9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_PHY0_W (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFT (JLON, JLEV, JBLK)*ZUSG
      
      ENDDO


      IF (YDARPHY%LMPA.AND.(.NOT.YDDYNA%LTWOTL)) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_PHY9_W (JLON, JLEV, JBLK)=Z_YDCPG_DYN9_GWFT (JLON, JLEV, JBLK)*ZUSG
        
        ENDDO

      ELSEIF (.NOT.YDDYNA%LTWOTL) THEN
        Z_YDCPG_PHY9_W (JLON,:, JBLK)=0.0_JPRB
      ENDIF


      IF (YDDYNA%LNHDYN) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_PHY0_WL (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFL (JLON, JLEV, JBLK)*ZUSG
          Z_YDCPG_PHY0_WM (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFM (JLON, JLEV, JBLK)*ZUSG
        
        ENDDO

      ELSE
        Z_YDCPG_PHY0_WL (JLON,:, JBLK)=0.0_JPRB
        Z_YDCPG_PHY0_WM (JLON,:, JBLK)=0.0_JPRB
      ENDIF

      Z_YDCPG_PHY0_PREF (JLON,:, JBLK)=0.0_JPRB
      Z_YDCPG_PHY0_PRE (JLON,:, JBLK)=0.0_JPRB

      IF (.NOT.YDDYNA%LTWOTL) THEN
        Z_YDCPG_PHY9_PREF (JLON,:, JBLK)=0.0_JPRB
        Z_YDCPG_PHY9_PRE (JLON,:, JBLK)=0.0_JPRB
      ENDIF


      IF (YDARPHY%LMPA) THEN

        IF (YDDYNA%LNHDYN.AND.YDDYNA%LTWOTL) THEN
          Z_YDCPG_PHY0_PREF (JLON,:, JBLK)=Z_YDCPG_DYN0_NHPREF (JLON,:, JBLK)
          Z_YDCPG_PHY0_PRE (JLON,:, JBLK)=Z_YDCPG_DYN0_NHPREH (JLON,:, JBLK)
        ELSEIF (YDDYNA%LNHDYN.AND.(.NOT.YDDYNA%LTWOTL)) THEN
          Z_YDCPG_PHY9_PREF (JLON,:, JBLK)=Z_YDCPG_DYN9_NHPREF (JLON,:, JBLK)
          Z_YDCPG_PHY9_PRE (JLON,:, JBLK)=Z_YDCPG_DYN9_NHPREH (JLON,:, JBLK)
        ELSEIF ((.NOT.YDDYNA%LNHDYN).AND.YDDYNA%LTWOTL) THEN
          Z_YDCPG_PHY0_PREF (JLON,:, JBLK)=Z_YDCPG_DYN0_PREF (JLON,:, JBLK)
          Z_YDCPG_PHY0_PRE (JLON,:, JBLK)=Z_YDCPG_DYN0_PRE (JLON,:, JBLK)
        ELSEIF ((.NOT.YDDYNA%LNHDYN).AND.(.NOT.YDDYNA%LTWOTL)) THEN
          Z_YDCPG_PHY9_PREF (JLON,:, JBLK)=Z_YDCPG_DYN9_PREF (JLON,:, JBLK)
          Z_YDCPG_PHY9_PRE (JLON,:, JBLK)=Z_YDCPG_DYN9_PRE (JLON,:, JBLK)
        ENDIF

      ENDIF

      Z_YDCPG_PHY0_PREHYDF (JLON,:, JBLK)=Z_YDCPG_DYN0_PREF (JLON,:, JBLK)
      Z_YDCPG_PHY0_PREHYD (JLON,:, JBLK)=Z_YDCPG_DYN0_PRE (JLON,:, JBLK)
      Z_YDCPG_PHY0_XYB_DELP (JLON,:, JBLK)=Z_YDCPG_DYN0_XYB_DELP (JLON,:, JBLK)
      Z_YDCPG_PHY0_XYB_RDELP (JLON,:, JBLK)=Z_YDCPG_DYN0_XYB_RDELP (JLON,:, JBLK)
      Z_YDCPG_PHY0_XYB_LNPR (JLON,:, JBLK)=Z_YDCPG_DYN0_XYB_LNPR (JLON,:, JBLK)
      Z_YDCPG_PHY0_XYB_ALPH (JLON,:, JBLK)=Z_YDCPG_DYN0_XYB_ALPH (JLON,:, JBLK)

      IF (.NOT.YDDYNA%LTWOTL) THEN
        Z_YDCPG_PHY9_PREHYDF (JLON,:, JBLK)=Z_YDCPG_DYN9_PREF (JLON,:, JBLK)
        Z_YDCPG_PHY9_PREHYD (JLON,:, JBLK)=Z_YDCPG_DYN9_PRE (JLON,:, JBLK)
        Z_YDCPG_PHY9_XYB_DELP (JLON,:, JBLK)=Z_YDCPG_DYN9_XYB_DELP (JLON,:, JBLK)
        Z_YDCPG_PHY9_XYB_RDELP (JLON,:, JBLK)=Z_YDCPG_DYN9_XYB_RDELP (JLON,:, JBLK)
        Z_YDCPG_PHY9_XYB_LNPR (JLON,:, JBLK)=Z_YDCPG_DYN9_XYB_LNPR (JLON,:, JBLK)
        Z_YDCPG_PHY9_XYB_ALPH (JLON,:, JBLK)=Z_YDCPG_DYN9_XYB_ALPH (JLON,:, JBLK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('MF_PHYS_PREP_PARALLEL:PREP')) THEN
    IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN0_GWFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFL)
    Z_YDCPG_DYN0_GWFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFM)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_NHPREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHPREF)
    Z_YDCPG_DYN0_NHPREH => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHPREH)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN9_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_GWFT)
    Z_YDCPG_DYN9_NHPREF => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHPREF)
    Z_YDCPG_DYN9_NHPREH => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHPREH)
    Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
    Z_YDCPG_DYN9_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREF)
    Z_YDCPG_DYN9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_ALPH)
    Z_YDCPG_DYN9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_DELP)
    Z_YDCPG_DYN9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_LNPR)
    Z_YDCPG_DYN9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_RDELP)
    Z_YDCPG_PHY0_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PRE)
    Z_YDCPG_PHY0_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREF)
    Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYD)
    Z_YDCPG_PHY0_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYDF)
    Z_YDCPG_PHY0_W => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_W)
    Z_YDCPG_PHY0_WL => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WL)
    Z_YDCPG_PHY0_WM => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WM)
    Z_YDCPG_PHY0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_ALPH)
    Z_YDCPG_PHY0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_DELP)
    Z_YDCPG_PHY0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_LNPR)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
    Z_YDCPG_PHY9_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PRE)
    Z_YDCPG_PHY9_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREF)
    Z_YDCPG_PHY9_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYD)
    Z_YDCPG_PHY9_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYDF)
    Z_YDCPG_PHY9_W => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_W)
    Z_YDCPG_PHY9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_ALPH)
    Z_YDCPG_PHY9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_DELP)
    Z_YDCPG_PHY9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_LNPR)
    Z_YDCPG_PHY9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_GWFL => NULL ()
  Z_YDCPG_DYN0_GWFM => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_NHPREF => NULL ()
  Z_YDCPG_DYN0_NHPREH => NULL ()
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN9_GWFT => NULL ()
  Z_YDCPG_DYN9_NHPREF => NULL ()
  Z_YDCPG_DYN9_NHPREH => NULL ()
  Z_YDCPG_DYN9_PRE => NULL ()
  Z_YDCPG_DYN9_PREF => NULL ()
  Z_YDCPG_DYN9_XYB_ALPH => NULL ()
  Z_YDCPG_DYN9_XYB_DELP => NULL ()
  Z_YDCPG_DYN9_XYB_LNPR => NULL ()
  Z_YDCPG_DYN9_XYB_RDELP => NULL ()
  Z_YDCPG_PHY0_PRE => NULL ()
  Z_YDCPG_PHY0_PREF => NULL ()
  Z_YDCPG_PHY0_PREHYD => NULL ()
  Z_YDCPG_PHY0_PREHYDF => NULL ()
  Z_YDCPG_PHY0_W => NULL ()
  Z_YDCPG_PHY0_WL => NULL ()
  Z_YDCPG_PHY0_WM => NULL ()
  Z_YDCPG_PHY0_XYB_ALPH => NULL ()
  Z_YDCPG_PHY0_XYB_DELP => NULL ()
  Z_YDCPG_PHY0_XYB_LNPR => NULL ()
  Z_YDCPG_PHY0_XYB_RDELP => NULL ()
  Z_YDCPG_PHY9_PRE => NULL ()
  Z_YDCPG_PHY9_PREF => NULL ()
  Z_YDCPG_PHY9_PREHYD => NULL ()
  Z_YDCPG_PHY9_PREHYDF => NULL ()
  Z_YDCPG_PHY9_W => NULL ()
  Z_YDCPG_PHY9_XYB_ALPH => NULL ()
  Z_YDCPG_PHY9_XYB_DELP => NULL ()
  Z_YDCPG_PHY9_XYB_LNPR => NULL ()
  Z_YDCPG_PHY9_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','MF_PHYS_PREP_PARALLEL:PREP')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_GWFL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_GWFL)
  Z_YDCPG_DYN0_GWFM => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_GWFM)
  Z_YDCPG_DYN0_GWFT => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_GWFT)
  Z_YDCPG_DYN0_NHPREF => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_NHPREF)
  Z_YDCPG_DYN0_NHPREH => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_NHPREH)
  Z_YDCPG_DYN0_PRE => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PRE)
  Z_YDCPG_DYN0_PREF => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%F_PREF)
  Z_YDCPG_DYN0_XYB_ALPH => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_ALPH)
  Z_YDCPG_DYN0_XYB_DELP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_DELP)
  Z_YDCPG_DYN0_XYB_LNPR => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_LNPR)
  Z_YDCPG_DYN0_XYB_RDELP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%XYB%F_RDELP)
  Z_YDCPG_DYN9_GWFT => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%F_GWFT)
  Z_YDCPG_DYN9_NHPREF => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%F_NHPREF)
  Z_YDCPG_DYN9_NHPREH => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%F_NHPREH)
  Z_YDCPG_DYN9_PRE => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%F_PRE)
  Z_YDCPG_DYN9_PREF => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%F_PREF)
  Z_YDCPG_DYN9_XYB_ALPH => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%XYB%F_ALPH)
  Z_YDCPG_DYN9_XYB_DELP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%XYB%F_DELP)
  Z_YDCPG_DYN9_XYB_LNPR => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%XYB%F_LNPR)
  Z_YDCPG_DYN9_XYB_RDELP => GET_DEVICE_DATA_RDONLY (YDCPG_DYN9%XYB%F_RDELP)
  Z_YDCPG_PHY0_PRE => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%F_PRE)
  Z_YDCPG_PHY0_PREF => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%F_PREF)
  Z_YDCPG_PHY0_PREHYD => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%F_PREHYD)
  Z_YDCPG_PHY0_PREHYDF => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%F_PREHYDF)
  Z_YDCPG_PHY0_W => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%F_W)
  Z_YDCPG_PHY0_WL => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%F_WL)
  Z_YDCPG_PHY0_WM => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%F_WM)
  Z_YDCPG_PHY0_XYB_ALPH => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%XYB%F_ALPH)
  Z_YDCPG_PHY0_XYB_DELP => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%XYB%F_DELP)
  Z_YDCPG_PHY0_XYB_LNPR => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%XYB%F_LNPR)
  Z_YDCPG_PHY0_XYB_RDELP => GET_DEVICE_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
  Z_YDCPG_PHY9_PRE => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%F_PRE)
  Z_YDCPG_PHY9_PREF => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%F_PREF)
  Z_YDCPG_PHY9_PREHYD => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%F_PREHYD)
  Z_YDCPG_PHY9_PREHYDF => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%F_PREHYDF)
  Z_YDCPG_PHY9_W => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%F_W)
  Z_YDCPG_PHY9_XYB_ALPH => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%XYB%F_ALPH)
  Z_YDCPG_PHY9_XYB_DELP => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%XYB%F_DELP)
  Z_YDCPG_PHY9_XYB_LNPR => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%XYB%F_LNPR)
  Z_YDCPG_PHY9_XYB_RDELP => GET_DEVICE_DATA_RDWR (YDCPG_PHY9%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDARPHY, YDCPG_OPTS, YDDYNA, YDGEOMETRY, YFXTRAN_ACDC_STACK, &
    !$ACC&         Z_YDCPG_DYN0_GWFL, Z_YDCPG_DYN0_GWFM, Z_YDCPG_DYN0_GWFT, &
    !$ACC&         Z_YDCPG_DYN0_NHPREF, Z_YDCPG_DYN0_NHPREH, Z_YDCPG_DYN0_PRE, &
    !$ACC&         Z_YDCPG_DYN0_PREF, Z_YDCPG_DYN0_XYB_ALPH, Z_YDCPG_DYN0_XYB_DELP, &
    !$ACC&         Z_YDCPG_DYN0_XYB_LNPR, Z_YDCPG_DYN0_XYB_RDELP, Z_YDCPG_DYN9_GWFT, &
    !$ACC&         Z_YDCPG_DYN9_NHPREF, Z_YDCPG_DYN9_NHPREH, Z_YDCPG_DYN9_PRE, &
    !$ACC&         Z_YDCPG_DYN9_PREF, Z_YDCPG_DYN9_XYB_ALPH, Z_YDCPG_DYN9_XYB_DELP, &
    !$ACC&         Z_YDCPG_DYN9_XYB_LNPR, Z_YDCPG_DYN9_XYB_RDELP, Z_YDCPG_PHY0_PRE, &
    !$ACC&         Z_YDCPG_PHY0_PREF, Z_YDCPG_PHY0_PREHYD, Z_YDCPG_PHY0_PREHYDF, &
    !$ACC&         Z_YDCPG_PHY0_W, Z_YDCPG_PHY0_WL, Z_YDCPG_PHY0_WM, Z_YDCPG_PHY0_XYB_ALPH, &
    !$ACC&         Z_YDCPG_PHY0_XYB_DELP, Z_YDCPG_PHY0_XYB_LNPR, Z_YDCPG_PHY0_XYB_RDELP, &
    !$ACC&         Z_YDCPG_PHY9_PRE, Z_YDCPG_PHY9_PREF, Z_YDCPG_PHY9_PREHYD, &
    !$ACC&         Z_YDCPG_PHY9_PREHYDF, Z_YDCPG_PHY9_W, Z_YDCPG_PHY9_XYB_ALPH, &
    !$ACC&         Z_YDCPG_PHY9_XYB_DELP, Z_YDCPG_PHY9_XYB_LNPR, Z_YDCPG_PHY9_XYB_RDELP) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
        
        Z_YDCPG_PHY0_W (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFT (JLON, JLEV, JBLK)*ZUSG
      
      ENDDO


      IF (YDARPHY%LMPA.AND.(.NOT.YDDYNA%LTWOTL)) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_PHY9_W (JLON, JLEV, JBLK)=Z_YDCPG_DYN9_GWFT (JLON, JLEV, JBLK)*ZUSG
        
        ENDDO

      ELSEIF (.NOT.YDDYNA%LTWOTL) THEN
        Z_YDCPG_PHY9_W (JLON,:, JBLK)=0.0_JPRB
      ENDIF


      IF (YDDYNA%LNHDYN) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_PHY0_WL (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFL (JLON, JLEV, JBLK)*ZUSG
          Z_YDCPG_PHY0_WM (JLON, JLEV, JBLK)=Z_YDCPG_DYN0_GWFM (JLON, JLEV, JBLK)*ZUSG
        
        ENDDO

      ELSE
        Z_YDCPG_PHY0_WL (JLON,:, JBLK)=0.0_JPRB
        Z_YDCPG_PHY0_WM (JLON,:, JBLK)=0.0_JPRB
      ENDIF

      Z_YDCPG_PHY0_PREF (JLON,:, JBLK)=0.0_JPRB
      Z_YDCPG_PHY0_PRE (JLON,:, JBLK)=0.0_JPRB

      IF (.NOT.YDDYNA%LTWOTL) THEN
        Z_YDCPG_PHY9_PREF (JLON,:, JBLK)=0.0_JPRB
        Z_YDCPG_PHY9_PRE (JLON,:, JBLK)=0.0_JPRB
      ENDIF


      IF (YDARPHY%LMPA) THEN

        IF (YDDYNA%LNHDYN.AND.YDDYNA%LTWOTL) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_PREF (:,:, JBLK), Z_YDCPG_DYN0_NHPREF (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_PRE (:,:, JBLK), Z_YDCPG_DYN0_NHPREH (:,:, JBLK))
        ELSEIF (YDDYNA%LNHDYN.AND.(.NOT.YDDYNA%LTWOTL)) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_PREF (:,:, JBLK), Z_YDCPG_DYN9_NHPREF (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_PRE (:,:, JBLK), Z_YDCPG_DYN9_NHPREH (:,:, JBLK))
        ELSEIF ((.NOT.YDDYNA%LNHDYN).AND.YDDYNA%LTWOTL) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_PREF (:,:, JBLK), Z_YDCPG_DYN0_PREF (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_PRE (:,:, JBLK), Z_YDCPG_DYN0_PRE (:,:, JBLK))
        ELSEIF ((.NOT.YDDYNA%LNHDYN).AND.(.NOT.YDDYNA%LTWOTL)) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_PREF (:,:, JBLK), Z_YDCPG_DYN9_PREF (:,:, JBLK))
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_PRE (:,:, JBLK), Z_YDCPG_DYN9_PRE (:,:, JBLK))
        ENDIF

      ENDIF

      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_PREHYDF (:,:, JBLK), Z_YDCPG_DYN0_PREF (:,:, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_PREHYD (:,:, JBLK), Z_YDCPG_DYN0_PRE (:,:, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_XYB_DELP&
      & (:,:, JBLK), Z_YDCPG_DYN0_XYB_DELP (:,:, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_XYB_RDELP&
      & (:,:, JBLK), Z_YDCPG_DYN0_XYB_RDELP (:,:, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_XYB_LNPR&
      & (:,:, JBLK), Z_YDCPG_DYN0_XYB_LNPR (:,:, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY0_XYB_ALPH&
      & (:,:, JBLK), Z_YDCPG_DYN0_XYB_ALPH (:,:, JBLK))

      IF (.NOT.YDDYNA%LTWOTL) THEN
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_PREHYDF (:,:, JBLK), Z_YDCPG_DYN9_PREF (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_PREHYD (:,:, JBLK), Z_YDCPG_DYN9_PRE (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_XYB_DELP&
        & (:,:, JBLK), Z_YDCPG_DYN9_XYB_DELP (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_XYB_RDELP&
        & (:,:, JBLK), Z_YDCPG_DYN9_XYB_RDELP (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_XYB_LNPR&
        & (:,:, JBLK), Z_YDCPG_DYN9_XYB_LNPR (:,:, JBLK))
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_PHY9_XYB_ALPH&
        & (:,:, JBLK), Z_YDCPG_DYN9_XYB_ALPH (:,:, JBLK))
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('MF_PHYS_PREP_PARALLEL:PREP')) THEN
    IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDCPG_DYN0_GWFL => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFL)
    Z_YDCPG_DYN0_GWFM => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFM)
    Z_YDCPG_DYN0_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_GWFT)
    Z_YDCPG_DYN0_NHPREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHPREF)
    Z_YDCPG_DYN0_NHPREH => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_NHPREH)
    Z_YDCPG_DYN0_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PRE)
    Z_YDCPG_DYN0_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN0%F_PREF)
    Z_YDCPG_DYN0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_ALPH)
    Z_YDCPG_DYN0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_DELP)
    Z_YDCPG_DYN0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_LNPR)
    Z_YDCPG_DYN0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN0%XYB%F_RDELP)
    Z_YDCPG_DYN9_GWFT => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_GWFT)
    Z_YDCPG_DYN9_NHPREF => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHPREF)
    Z_YDCPG_DYN9_NHPREH => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_NHPREH)
    Z_YDCPG_DYN9_PRE => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PRE)
    Z_YDCPG_DYN9_PREF => GET_HOST_DATA_RDWR (YDCPG_DYN9%F_PREF)
    Z_YDCPG_DYN9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_ALPH)
    Z_YDCPG_DYN9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_DELP)
    Z_YDCPG_DYN9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_LNPR)
    Z_YDCPG_DYN9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_DYN9%XYB%F_RDELP)
    Z_YDCPG_PHY0_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PRE)
    Z_YDCPG_PHY0_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREF)
    Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYD)
    Z_YDCPG_PHY0_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYDF)
    Z_YDCPG_PHY0_W => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_W)
    Z_YDCPG_PHY0_WL => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WL)
    Z_YDCPG_PHY0_WM => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_WM)
    Z_YDCPG_PHY0_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_ALPH)
    Z_YDCPG_PHY0_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_DELP)
    Z_YDCPG_PHY0_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_LNPR)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
    Z_YDCPG_PHY9_PRE => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PRE)
    Z_YDCPG_PHY9_PREF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREF)
    Z_YDCPG_PHY9_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYD)
    Z_YDCPG_PHY9_PREHYDF => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_PREHYDF)
    Z_YDCPG_PHY9_W => GET_HOST_DATA_RDWR (YDCPG_PHY9%F_W)
    Z_YDCPG_PHY9_XYB_ALPH => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_ALPH)
    Z_YDCPG_PHY9_XYB_DELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_DELP)
    Z_YDCPG_PHY9_XYB_LNPR => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_LNPR)
    Z_YDCPG_PHY9_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY9%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDCPG_DYN0_GWFL => NULL ()
  Z_YDCPG_DYN0_GWFM => NULL ()
  Z_YDCPG_DYN0_GWFT => NULL ()
  Z_YDCPG_DYN0_NHPREF => NULL ()
  Z_YDCPG_DYN0_NHPREH => NULL ()
  Z_YDCPG_DYN0_PRE => NULL ()
  Z_YDCPG_DYN0_PREF => NULL ()
  Z_YDCPG_DYN0_XYB_ALPH => NULL ()
  Z_YDCPG_DYN0_XYB_DELP => NULL ()
  Z_YDCPG_DYN0_XYB_LNPR => NULL ()
  Z_YDCPG_DYN0_XYB_RDELP => NULL ()
  Z_YDCPG_DYN9_GWFT => NULL ()
  Z_YDCPG_DYN9_NHPREF => NULL ()
  Z_YDCPG_DYN9_NHPREH => NULL ()
  Z_YDCPG_DYN9_PRE => NULL ()
  Z_YDCPG_DYN9_PREF => NULL ()
  Z_YDCPG_DYN9_XYB_ALPH => NULL ()
  Z_YDCPG_DYN9_XYB_DELP => NULL ()
  Z_YDCPG_DYN9_XYB_LNPR => NULL ()
  Z_YDCPG_DYN9_XYB_RDELP => NULL ()
  Z_YDCPG_PHY0_PRE => NULL ()
  Z_YDCPG_PHY0_PREF => NULL ()
  Z_YDCPG_PHY0_PREHYD => NULL ()
  Z_YDCPG_PHY0_PREHYDF => NULL ()
  Z_YDCPG_PHY0_W => NULL ()
  Z_YDCPG_PHY0_WL => NULL ()
  Z_YDCPG_PHY0_WM => NULL ()
  Z_YDCPG_PHY0_XYB_ALPH => NULL ()
  Z_YDCPG_PHY0_XYB_DELP => NULL ()
  Z_YDCPG_PHY0_XYB_LNPR => NULL ()
  Z_YDCPG_PHY0_XYB_RDELP => NULL ()
  Z_YDCPG_PHY9_PRE => NULL ()
  Z_YDCPG_PHY9_PREF => NULL ()
  Z_YDCPG_PHY9_PREHYD => NULL ()
  Z_YDCPG_PHY9_PREHYDF => NULL ()
  Z_YDCPG_PHY9_W => NULL ()
  Z_YDCPG_PHY9_XYB_ALPH => NULL ()
  Z_YDCPG_PHY9_XYB_DELP => NULL ()
  Z_YDCPG_PHY9_XYB_LNPR => NULL ()
  Z_YDCPG_PHY9_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('MF_PHYS_PREP_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL:PREP',1,ZHOOK_HANDLE_PARALLEL)



CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('MF_PHYS_PREP_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE MF_PHYS_PREP_PARALLEL
