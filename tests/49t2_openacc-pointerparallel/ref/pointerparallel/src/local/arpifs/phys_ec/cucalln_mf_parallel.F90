SUBROUTINE CUCALLN_MF_PARALLEL (PPLDARE, PPLRG, KSTEP, YDTHF, YDCST, YDERAD, YDML_PHY_SLIN, YDML_PHY_EC&
&, YGFL, YDCHEM, YDSPP_CONFIG, YDPERTPAR, YDCPG_OPTS, YDCPG_BNDS, KLON, KSMAX, KLEV, YD_PDX, KSPPN2D&
&, LDMCAPEA, YD_LDLAND, LDSLPHY, PTSPHY, PVDIFTS, YD_PTM1, YD_PQM1, YD_PUM1, YD_PVM1, YD_PLITOT, YD_PVERVEL&
&, YD_PQHFL, YD_PAHFS, YD_PAPHM1, YD_PAP, YD_PAPH, YD_PGEO, YD_PGEOH, YD_PGAW, YD_PCUCONVCA, YD_PGP2DSPP&
&, YD_PTENT, YD_PTENQ, YD_PTENU, YD_PTENV, YD_PTENTA, YD_PTENQA, YD_PARPRC, YD_KTOPC, YD_KBASEC, YD_KTYPE&
&, YD_KCBOT, YD_KCTOP, YD_KBOTSC, YD_LDCUM, YD_LDSC, YD_KCBOT_LIG, YD_KCTOP_LIG, YD_LDCUM_LIG, YD_LDSHCV&
&, YD_PLCRIT_AER, YD_PLU, YD_PLUDE, YD_PLUDELI, YD_PSNDE, YD_PMFU, YD_PMFD, YD_PLGLAC, YD_PDIFCQ,&
& YD_PDIFCS, YD_PFHPCL, YD_PFHPCN, YD_PFPLCL, YD_PFPLCN, YD_PLRAIN, YD_PRSUD, YD_PSTRCU, YD_PSTRCV&
&, YD_PFCQLF, YD_PFCQIF, YD_PMFUDE_RATE, YD_PMFDDE_RATE, YD_PCAPE, YD_PWU, YD_PWMEAN, YD_PVDISCU,&
& YD_PDISS, KTRAC, YD_PCM1, YD_PTENC, PSCAV, PSCAV0)
USE MODEL_PHYSICS_ECMWF_MOD,ONLY:MODEL_PHYSICS_ECMWF_TYPE
USE MODEL_PHYSICS_SIMPLINEAR_MOD,ONLY:MODEL_PHYSICS_SIMPLINEAR_TYPE
USE YOERAD,ONLY:TERAD
USE YOM_YGFL,ONLY:TYPE_GFLD
USE YOMCHEM,ONLY:TCHEM
USE SPP_MOD,ONLY:TSPP_CONFIG

USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE YOMCST,ONLY:TCST
USE YOETHF,ONLY:TTHF
USE YOMPERTPAR,ONLY:TPERTPAR
USE CPG_OPTS_TYPE_MOD, ONLY : CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


REAL (KIND=JPRB), INTENT (IN)::PPLDARE
REAL (KIND=JPRB), INTENT (IN)::PPLRG
INTEGER (KIND=JPIM), INTENT (IN)::KSTEP
TYPE (TTHF), INTENT (IN)::YDTHF
TYPE (TCST), INTENT (IN)::YDCST
TYPE (TERAD), INTENT (IN)::YDERAD
TYPE (MODEL_PHYSICS_SIMPLINEAR_TYPE), INTENT (IN)::YDML_PHY_SLIN
TYPE (MODEL_PHYSICS_ECMWF_TYPE), INTENT (IN)::YDML_PHY_EC
TYPE (TYPE_GFLD), INTENT (IN)::YGFL
TYPE (TCHEM), INTENT (IN)::YDCHEM
TYPE (TSPP_CONFIG), INTENT (IN)::YDSPP_CONFIG
TYPE (TPERTPAR), INTENT (IN)::YDPERTPAR
INTEGER (KIND=JPIM), INTENT (IN)::KLON
INTEGER (KIND=JPIM), INTENT (IN)::KSMAX
INTEGER (KIND=JPIM), INTENT (IN)::KLEV
INTEGER (KIND=JPIM), INTENT (IN)::KSPPN2D
INTEGER (KIND=JPIM), INTENT (IN)::KTRAC
TYPE (CPG_OPTS_TYPE), INTENT (IN) :: YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN) :: YDCPG_BNDS
LOGICAL, INTENT (IN)::LDMCAPEA
CLASS (FIELD_2LM), POINTER :: YD_LDLAND
LOGICAL, POINTER::LDLAND (:,:)
LOGICAL, INTENT (IN)::LDSLPHY
REAL (KIND=JPRB), INTENT (IN)::PTSPHY
REAL (KIND=JPRB), INTENT (IN)::PVDIFTS
CLASS (FIELD_3RB), POINTER :: YD_PLCRIT_AER
REAL (KIND=JPRB), POINTER::PLCRIT_AER (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTM1
REAL (KIND=JPRB), POINTER::PTM1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQM1
REAL (KIND=JPRB), POINTER::PQM1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PUM1
REAL (KIND=JPRB), POINTER::PUM1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PVM1
REAL (KIND=JPRB), POINTER::PVM1 (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PCM1
REAL (KIND=JPRB), POINTER::PCM1 (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLITOT
REAL (KIND=JPRB), POINTER::PLITOT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PVERVEL
REAL (KIND=JPRB), POINTER::PVERVEL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQHFL
REAL (KIND=JPRB), POINTER::PQHFL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAHFS
REAL (KIND=JPRB), POINTER::PAHFS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAPHM1
REAL (KIND=JPRB), POINTER::PAPHM1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAP
REAL (KIND=JPRB), POINTER::PAP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAPH
REAL (KIND=JPRB), POINTER::PAPH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGEO
REAL (KIND=JPRB), POINTER::PGEO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGEOH
REAL (KIND=JPRB), POINTER::PGEOH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENT
REAL (KIND=JPRB), POINTER::PTENT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENQ
REAL (KIND=JPRB), POINTER::PTENQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENU
REAL (KIND=JPRB), POINTER::PTENU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENV
REAL (KIND=JPRB), POINTER::PTENV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENTA
REAL (KIND=JPRB), POINTER::PTENTA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENQA
REAL (KIND=JPRB), POINTER::PTENQA (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PGAW
REAL (KIND=JPRB), POINTER::PGAW (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCUCONVCA
REAL (KIND=JPRB), POINTER::PCUCONVCA (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PGP2DSPP
REAL (KIND=JPRB), POINTER::PGP2DSPP (:,:,:)
REAL (KIND=JPRB), INTENT (IN)::PSCAV (KTRAC)
REAL (KIND=JPRB), INTENT (IN)::PSCAV0 (KTRAC)
CLASS (FIELD_2RB), POINTER :: YD_PDX
REAL (KIND=JPRB), POINTER::PDX (:,:)
CLASS (FIELD_4RB), POINTER :: YD_PTENC
REAL (KIND=JPRB), POINTER::PTENC (:,:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PARPRC
REAL (KIND=JPRB), POINTER::PARPRC (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KTOPC
INTEGER (KIND=JPIM), POINTER::KTOPC (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KBASEC
INTEGER (KIND=JPIM), POINTER::KBASEC (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KTYPE
INTEGER (KIND=JPIM), POINTER::KTYPE (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KCBOT
INTEGER (KIND=JPIM), POINTER::KCBOT (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KCTOP
INTEGER (KIND=JPIM), POINTER::KCTOP (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KCBOT_LIG
INTEGER (KIND=JPIM), POINTER::KCBOT_LIG (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KCTOP_LIG
INTEGER (KIND=JPIM), POINTER::KCTOP_LIG (:,:)
CLASS (FIELD_2IM), POINTER :: YD_KBOTSC
INTEGER (KIND=JPIM), POINTER::KBOTSC (:,:)
CLASS (FIELD_2LM), POINTER :: YD_LDCUM
LOGICAL, POINTER::LDCUM (:,:)
CLASS (FIELD_2LM), POINTER :: YD_LDCUM_LIG
LOGICAL, POINTER::LDCUM_LIG (:,:)
CLASS (FIELD_2LM), POINTER :: YD_LDSC
LOGICAL, POINTER::LDSC (:,:)
CLASS (FIELD_2LM), POINTER :: YD_LDSHCV
LOGICAL, POINTER::LDSHCV (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLU
REAL (KIND=JPRB), POINTER::PLU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLUDE
REAL (KIND=JPRB), POINTER::PLUDE (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PLUDELI
REAL (KIND=JPRB), POINTER::PLUDELI (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PSNDE
REAL (KIND=JPRB), POINTER::PSNDE (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMFU
REAL (KIND=JPRB), POINTER::PMFU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMFD
REAL (KIND=JPRB), POINTER::PMFD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLGLAC
REAL (KIND=JPRB), POINTER::PLGLAC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCQ
REAL (KIND=JPRB), POINTER::PDIFCQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCS
REAL (KIND=JPRB), POINTER::PDIFCS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFHPCL
REAL (KIND=JPRB), POINTER::PFHPCL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFHPCN
REAL (KIND=JPRB), POINTER::PFHPCN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFPLCL
REAL (KIND=JPRB), POINTER::PFPLCL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFPLCN
REAL (KIND=JPRB), POINTER::PFPLCN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLRAIN
REAL (KIND=JPRB), POINTER::PLRAIN (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PRSUD
REAL (KIND=JPRB), POINTER::PRSUD (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSTRCU
REAL (KIND=JPRB), POINTER::PSTRCU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSTRCV
REAL (KIND=JPRB), POINTER::PSTRCV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFCQLF
REAL (KIND=JPRB), POINTER::PFCQLF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFCQIF
REAL (KIND=JPRB), POINTER::PFCQIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMFUDE_RATE
REAL (KIND=JPRB), POINTER::PMFUDE_RATE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMFDDE_RATE
REAL (KIND=JPRB), POINTER::PMFDDE_RATE (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCAPE
REAL (KIND=JPRB), POINTER::PCAPE (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PWMEAN
REAL (KIND=JPRB), POINTER::PWMEAN (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PVDISCU
REAL (KIND=JPRB), POINTER::PVDISCU (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PWU
REAL (KIND=JPRB), POINTER::PWU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDISS
REAL (KIND=JPRB), POINTER::PDISS (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRAIN
REAL (KIND=JPRB), POINTER::ZRAIN (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQSAT
REAL (KIND=JPRB), POINTER::ZQSAT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQU
REAL (KIND=JPRB), POINTER::ZQU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTU
REAL (KIND=JPRB), POINTER::ZTU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVP1
REAL (KIND=JPRB), POINTER::ZVP1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUP1
REAL (KIND=JPRB), POINTER::ZUP1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQP1
REAL (KIND=JPRB), POINTER::ZQP1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTP1
REAL (KIND=JPRB), POINTER::ZTP1 (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZCP1
REAL (KIND=JPRB), POINTER::ZCP1 (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZENTHS
REAL (KIND=JPRB), POINTER::ZENTHS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZENTHD
REAL (KIND=JPRB), POINTER::ZENTHD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUEA
REAL (KIND=JPRB), POINTER::ZUEA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVEA
REAL (KIND=JPRB), POINTER::ZVEA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTEA
REAL (KIND=JPRB), POINTER::ZTEA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQEA
REAL (KIND=JPRB), POINTER::ZQEA (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCONDFLN
REAL (KIND=JPRB), POINTER::ZCONDFLN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCONDFLL
REAL (KIND=JPRB), POINTER::ZCONDFLL (:,:)
INTEGER (KIND=JPIM)::JN
INTEGER (KIND=JPIM) :: JLON
INTEGER (KIND=JPIM)::JK
INTEGER (KIND=JPIM)::IFLAG
REAL (KIND=JPRB)::ZEPS
REAL (KIND=JPRB)::ZGDPH
REAL (KIND=JPRB)::ZCP
LOGICAL::LLTDKMF
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
#include "cuccdia.intfb.h"
#include "abor1.intfb.h"
#include "cumastrn.intfb.h"
#include "satur.intfb.h"
#include "fcttre.func.h"
#include "fcttrm.func.h"
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL', 0, ZHOOK_HANDLE)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZVP1, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVEA, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUP1, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUEA, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTU, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTP1, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTEA, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRAIN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQU, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQSAT, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQP1, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQEA, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZENTHS, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZENTHD, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCP1, UBOUNDS=[YDCPG_OPTS%KLON, KLEV, KTRAC, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCONDFLN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCONDFLL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)

IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CUCALLN_MF_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PFPLCL => GET_HOST_DATA_RDWR (YD_PFPLCL)
  PFPLCN => GET_HOST_DATA_RDWR (YD_PFPLCN)
  PTENQ => GET_HOST_DATA_RDONLY (YD_PTENQ)
  PTENT => GET_HOST_DATA_RDONLY (YD_PTENT)
  PTENU => GET_HOST_DATA_RDONLY (YD_PTENU)
  PTENV => GET_HOST_DATA_RDONLY (YD_PTENV)
  ZENTHD => GET_HOST_DATA_RDWR (YL_ZENTHD)
  ZENTHS => GET_HOST_DATA_RDWR (YL_ZENTHS)
  ZQEA => GET_HOST_DATA_RDWR (YL_ZQEA)
  ZTEA => GET_HOST_DATA_RDWR (YL_ZTEA)
  ZUEA => GET_HOST_DATA_RDWR (YL_ZUEA)
  ZVEA => GET_HOST_DATA_RDWR (YL_ZVEA)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JK=1, KLEV

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZQEA (JLON, JK, JBLK)=PTENQ (JLON, JK, JBLK)
        ZTEA (JLON, JK, JBLK)=PTENT (JLON, JK, JBLK)
        ZVEA (JLON, JK, JBLK)=PTENV (JLON, JK, JBLK)
        ZUEA (JLON, JK, JBLK)=PTENU (JLON, JK, JBLK)
        ZENTHD (JLON, JK, JBLK)=0.0_JPRB
        ZENTHS (JLON, JK, JBLK)=0.0_JPRB
      ENDDO

    ENDDO


    DO JK=1, KLEV+1

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PFPLCL (JLON, JK, JBLK)=0.0_JPRB
        PFPLCN (JLON, JK, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PFPLCL => NULL ()
  PFPLCN => NULL ()
  PTENQ => NULL ()
  PTENT => NULL ()
  PTENU => NULL ()
  PTENV => NULL ()
  ZENTHD => NULL ()
  ZENTHS => NULL ()
  ZQEA => NULL ()
  ZTEA => NULL ()
  ZUEA => NULL ()
  ZVEA => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CUCALLN_MF_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PFPLCL => GET_DEVICE_DATA_RDWR (YD_PFPLCL)
  PFPLCN => GET_DEVICE_DATA_RDWR (YD_PFPLCN)
  PTENQ => GET_DEVICE_DATA_RDONLY (YD_PTENQ)
  PTENT => GET_DEVICE_DATA_RDONLY (YD_PTENT)
  PTENU => GET_DEVICE_DATA_RDONLY (YD_PTENU)
  PTENV => GET_DEVICE_DATA_RDONLY (YD_PTENV)
  ZENTHD => GET_DEVICE_DATA_RDWR (YL_ZENTHD)
  ZENTHS => GET_DEVICE_DATA_RDWR (YL_ZENTHS)
  ZQEA => GET_DEVICE_DATA_RDWR (YL_ZQEA)
  ZTEA => GET_DEVICE_DATA_RDWR (YL_ZTEA)
  ZUEA => GET_DEVICE_DATA_RDWR (YL_ZUEA)
  ZVEA => GET_DEVICE_DATA_RDWR (YL_ZVEA)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PFPLCL, PFPLCN, PTENQ, PTENT, PTENU, PTENV, YFXTRAN_ACDC_STACK, ZENTHD, &
    !$ACC&         ZENTHS, ZQEA, ZTEA, ZUEA, ZVEA) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JK, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JK=1, KLEV
        
        ZQEA (JLON, JK, JBLK)=PTENQ (JLON, JK, JBLK)
        ZTEA (JLON, JK, JBLK)=PTENT (JLON, JK, JBLK)
        ZVEA (JLON, JK, JBLK)=PTENV (JLON, JK, JBLK)
        ZUEA (JLON, JK, JBLK)=PTENU (JLON, JK, JBLK)
        ZENTHD (JLON, JK, JBLK)=0.0_JPRB
        ZENTHS (JLON, JK, JBLK)=0.0_JPRB
      
      ENDDO


      DO JK=1, KLEV+1
        
        PFPLCL (JLON, JK, JBLK)=0.0_JPRB
        PFPLCN (JLON, JK, JBLK)=0.0_JPRB
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PFPLCL => NULL ()
  PFPLCN => NULL ()
  PTENQ => NULL ()
  PTENT => NULL ()
  PTENU => NULL ()
  PTENV => NULL ()
  ZENTHD => NULL ()
  ZENTHS => NULL ()
  ZQEA => NULL ()
  ZTEA => NULL ()
  ZUEA => NULL ()
  ZVEA => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CUCALLN_MF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)
ZEPS=1.0E-10_JPRB
IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CUCALLN_MF_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PCM1 => GET_HOST_DATA_RDONLY (YD_PCM1)
  PQM1 => GET_HOST_DATA_RDONLY (YD_PQM1)
  PTENC => GET_HOST_DATA_RDONLY (YD_PTENC)
  PTENQ => GET_HOST_DATA_RDONLY (YD_PTENQ)
  PTENT => GET_HOST_DATA_RDONLY (YD_PTENT)
  PTENU => GET_HOST_DATA_RDONLY (YD_PTENU)
  PTENV => GET_HOST_DATA_RDONLY (YD_PTENV)
  PTM1 => GET_HOST_DATA_RDONLY (YD_PTM1)
  PUM1 => GET_HOST_DATA_RDONLY (YD_PUM1)
  PVM1 => GET_HOST_DATA_RDONLY (YD_PVM1)
  ZCP1 => GET_HOST_DATA_RDWR (YL_ZCP1)
  ZQP1 => GET_HOST_DATA_RDWR (YL_ZQP1)
  ZQSAT => GET_HOST_DATA_RDWR (YL_ZQSAT)
  ZTP1 => GET_HOST_DATA_RDWR (YL_ZTP1)
  ZUP1 => GET_HOST_DATA_RDWR (YL_ZUP1)
  ZVP1 => GET_HOST_DATA_RDWR (YL_ZVP1)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JK, JLON, JN) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JK=1, KLEV

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZUP1 (JLON, JK, JBLK)=PUM1 (JLON, JK, JBLK)+PTENU (JLON, JK, JBLK)*PTSPHY
        ZVP1 (JLON, JK, JBLK)=PVM1 (JLON, JK, JBLK)+PTENV (JLON, JK, JBLK)*PTSPHY
        ZTP1 (JLON, JK, JBLK)=PTM1 (JLON, JK, JBLK)+PTENT (JLON, JK, JBLK)*PTSPHY
        ZQP1 (JLON, JK, JBLK)=PQM1 (JLON, JK, JBLK)+PTENQ (JLON, JK, JBLK)*PTSPHY
        ZQSAT (JLON, JK, JBLK)=ZQP1 (JLON, JK, JBLK)

        IF (ZQSAT (JLON, JK, JBLK)<=0.0_JPRB)  THEN
          ZQSAT (JLON, JK, JBLK)=ZEPS
        ENDIF

      ENDDO

    ENDDO


    IF (LDSLPHY) THEN

      IF (KTRAC>0.AND.YDML_PHY_EC%YREPHY%LMFTRAC) THEN

        DO JN=1, KTRAC

          DO JK=1, KLEV

            DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZCP1 (JLON, JK, JN, JBLK)=PCM1 (JLON, JK, JN, JBLK)
            ENDDO

          ENDDO

        ENDDO

      ENDIF

    ELSE

      IF (KTRAC>0.AND.YDML_PHY_EC%YREPHY%LMFTRAC) THEN

        DO JN=1, KTRAC

          DO JK=1, KLEV

            DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              ZCP1 (JLON, JK, JN, JBLK)=PCM1 (JLON, JK, JN, JBLK)+PTENC (JLON, JK, JN, JBLK)*PTSPHY
            ENDDO

          ENDDO

        ENDDO

      ENDIF

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PCM1 => NULL ()
  PQM1 => NULL ()
  PTENC => NULL ()
  PTENQ => NULL ()
  PTENT => NULL ()
  PTENU => NULL ()
  PTENV => NULL ()
  PTM1 => NULL ()
  PUM1 => NULL ()
  PVM1 => NULL ()
  ZCP1 => NULL ()
  ZQP1 => NULL ()
  ZQSAT => NULL ()
  ZTP1 => NULL ()
  ZUP1 => NULL ()
  ZVP1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CUCALLN_MF_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PCM1 => GET_DEVICE_DATA_RDONLY (YD_PCM1)
  PQM1 => GET_DEVICE_DATA_RDONLY (YD_PQM1)
  PTENC => GET_DEVICE_DATA_RDONLY (YD_PTENC)
  PTENQ => GET_DEVICE_DATA_RDONLY (YD_PTENQ)
  PTENT => GET_DEVICE_DATA_RDONLY (YD_PTENT)
  PTENU => GET_DEVICE_DATA_RDONLY (YD_PTENU)
  PTENV => GET_DEVICE_DATA_RDONLY (YD_PTENV)
  PTM1 => GET_DEVICE_DATA_RDONLY (YD_PTM1)
  PUM1 => GET_DEVICE_DATA_RDONLY (YD_PUM1)
  PVM1 => GET_DEVICE_DATA_RDONLY (YD_PVM1)
  ZCP1 => GET_DEVICE_DATA_RDWR (YL_ZCP1)
  ZQP1 => GET_DEVICE_DATA_RDWR (YL_ZQP1)
  ZQSAT => GET_DEVICE_DATA_RDWR (YL_ZQSAT)
  ZTP1 => GET_DEVICE_DATA_RDWR (YL_ZTP1)
  ZUP1 => GET_DEVICE_DATA_RDWR (YL_ZUP1)
  ZVP1 => GET_DEVICE_DATA_RDWR (YL_ZVP1)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PCM1, PQM1, PTENC, PTENQ, PTENT, PTENU, PTENV, PTM1, PUM1, PVM1, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZCP1, ZQP1, ZQSAT, ZTP1, ZUP1, ZVP1) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JK, JLON, JN, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JK=1, KLEV
        
        ZUP1 (JLON, JK, JBLK)=PUM1 (JLON, JK, JBLK)+PTENU (JLON, JK, JBLK)*PTSPHY
        ZVP1 (JLON, JK, JBLK)=PVM1 (JLON, JK, JBLK)+PTENV (JLON, JK, JBLK)*PTSPHY
        ZTP1 (JLON, JK, JBLK)=PTM1 (JLON, JK, JBLK)+PTENT (JLON, JK, JBLK)*PTSPHY
        ZQP1 (JLON, JK, JBLK)=PQM1 (JLON, JK, JBLK)+PTENQ (JLON, JK, JBLK)*PTSPHY
        ZQSAT (JLON, JK, JBLK)=ZQP1 (JLON, JK, JBLK)

        IF (ZQSAT (JLON, JK, JBLK)<=0.0_JPRB)  THEN
          ZQSAT (JLON, JK, JBLK)=ZEPS
        ENDIF

      
      ENDDO


      IF (LDSLPHY) THEN

        IF (KTRAC>0.AND.YDML_PHY_EC%YREPHY%LMFTRAC) THEN

          DO JN=1, KTRAC

            DO JK=1, KLEV
              
              ZCP1 (JLON, JK, JN, JBLK)=PCM1 (JLON, JK, JN, JBLK)
            
            ENDDO

          ENDDO

        ENDIF

      ELSE

        IF (KTRAC>0.AND.YDML_PHY_EC%YREPHY%LMFTRAC) THEN

          DO JN=1, KTRAC

            DO JK=1, KLEV
              
              ZCP1 (JLON, JK, JN, JBLK)=PCM1 (JLON, JK, JN, JBLK)+PTENC (JLON, JK, JN, JBLK)*PTSPHY
            
            ENDDO

          ENDDO

        ENDIF

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PCM1 => NULL ()
  PQM1 => NULL ()
  PTENC => NULL ()
  PTENQ => NULL ()
  PTENT => NULL ()
  PTENU => NULL ()
  PTENV => NULL ()
  PTM1 => NULL ()
  PUM1 => NULL ()
  PVM1 => NULL ()
  ZCP1 => NULL ()
  ZQP1 => NULL ()
  ZQSAT => NULL ()
  ZTP1 => NULL ()
  ZUP1 => NULL ()
  ZVP1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CUCALLN_MF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
IFLAG=1
IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CUCALLN_MF_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAP => GET_HOST_DATA_RDONLY (YD_PAP)
  ZQSAT => GET_HOST_DATA_RDWR (YL_ZQSAT)
  ZRAIN => GET_HOST_DATA_RDWR (YL_ZRAIN)
  ZTP1 => GET_HOST_DATA_RDONLY (YL_ZTP1)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL SATUR (YDTHF, YDCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDML_PHY_EC%YRECUMF%NJKT2&
    &, KLEV, YDML_PHY_SLIN%YREPHLI%LPHYLIN, PAP(:,:, JBLK), ZTP1(:,:, JBLK), ZQSAT(:,:, JBLK), IFLAG)

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZRAIN (JLON, JBLK)=0.0_JPRB
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAP => NULL ()
  ZQSAT => NULL ()
  ZRAIN => NULL ()
  ZTP1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CUCALLN_MF_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAP => GET_DEVICE_DATA_RDONLY (YD_PAP)
  ZQSAT => GET_DEVICE_DATA_RDWR (YL_ZQSAT)
  ZRAIN => GET_DEVICE_DATA_RDWR (YL_ZRAIN)
  ZTP1 => GET_DEVICE_DATA_RDONLY (YL_ZTP1)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PAP, YFXTRAN_ACDC_STACK, ZQSAT, ZRAIN, ZTP1) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL SATUR_OPENACC (YDTHF, YDCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KLON, YDML_PHY_EC%YRECUMF%NJKT2, KLEV, YDML_PHY_SLIN%YREPHLI%LPHYLIN, PAP(&
      &:,:, JBLK), ZTP1(:,:, JBLK), ZQSAT(:,:, JBLK), IFLAG,YDSTACK=YLSTACK)
      
      ZRAIN (JLON, JBLK)=0.0_JPRB
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAP => NULL ()
  ZQSAT => NULL ()
  ZRAIN => NULL ()
  ZTP1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CUCALLN_MF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:2',1,ZHOOK_HANDLE_PARALLEL)
LLTDKMF=.TRUE.
CALL CUMASTRN_PARALLEL (PPLDARE, PPLRG, YDTHF, YDCST, YDML_PHY_SLIN, YDML_PHY_EC, YGFL, YDCHEM,&
& YDSPP_CONFIG, YDPERTPAR, YDCPG_OPTS, YDCPG_BNDS, YDCPG_OPTS%KLON, KLEV, YD_PDX, LLTDKMF, LDMCAPEA&
&, YD_LDLAND, PTSPHY, YL_ZTP1, YL_ZQP1, YL_ZUP1, YL_ZVP1, YD_PLITOT, YD_PVERVEL, YL_ZQSAT, YD_PQHFL&
&, YD_PAHFS, YD_PAP, YD_PAPH, YD_PGEO, YD_PGEOH, YD_PGAW, YD_PCUCONVCA, YD_PGP2DSPP, YD_PTENT, YD_PTENQ&
&, YD_PTENU, YD_PTENV, YD_PTENTA, YD_PTENQA, YD_LDCUM, YD_KTYPE, YD_KCBOT, YD_KCTOP, YD_LDCUM_LIG&
&, YD_KCBOT_LIG, YD_KCTOP_LIG, YD_KBOTSC, YD_LDSC, YD_LDSHCV, YD_PLCRIT_AER, YL_ZTU, YL_ZQU, YD_PLU&
&, YD_PLUDE, YD_PLUDELI, YD_PSNDE, YL_ZENTHD, YD_PFPLCL, YD_PFPLCN, YL_ZRAIN, YD_PLRAIN, YD_PRSUD&
&, YD_PMFU, YD_PMFD, YD_PLGLAC, YD_PMFUDE_RATE, YD_PMFDDE_RATE, YD_PCAPE, YD_PWU, YD_PWMEAN, YD_PVDISCU&
&, YD_PDISS, KTRAC, YL_ZCP1, YD_PTENC, PSCAV, PSCAV0)
IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CUCALLN_MF_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KBASEC => GET_HOST_DATA_RDWR (YD_KBASEC)
  KCBOT => GET_HOST_DATA_RDONLY (YD_KCBOT)
  KCTOP => GET_HOST_DATA_RDONLY (YD_KCTOP)
  KTOPC => GET_HOST_DATA_RDWR (YD_KTOPC)
  LDCUM => GET_HOST_DATA_RDONLY (YD_LDCUM)
  PARPRC => GET_HOST_DATA_RDWR (YD_PARPRC)
  PLU => GET_HOST_DATA_RDONLY (YD_PLU)
  PMFU => GET_HOST_DATA_RDONLY (YD_PMFU)
  ZQU => GET_HOST_DATA_RDONLY (YL_ZQU)
  ZRAIN => GET_HOST_DATA_RDONLY (YL_ZRAIN)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL CUCCDIA (YDERAD, YDML_PHY_SLIN%YREPHLI, YDML_PHY_EC%YREPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
    &, YDCPG_OPTS%KLON, KLEV, KSTEP, KCBOT(:, JBLK), KCTOP(:, JBLK), LDCUM(:, JBLK), ZQU(:,:, JBLK), PLU&
    &(:,:, JBLK), PMFU(:,:, JBLK), ZRAIN(:, JBLK), PARPRC(:, JBLK), KTOPC(:, JBLK), KBASEC(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KBASEC => NULL ()
  KCBOT => NULL ()
  KCTOP => NULL ()
  KTOPC => NULL ()
  LDCUM => NULL ()
  PARPRC => NULL ()
  PLU => NULL ()
  PMFU => NULL ()
  ZQU => NULL ()
  ZRAIN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CUCALLN_MF_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KBASEC => GET_DEVICE_DATA_RDWR (YD_KBASEC)
  KCBOT => GET_DEVICE_DATA_RDONLY (YD_KCBOT)
  KCTOP => GET_DEVICE_DATA_RDONLY (YD_KCTOP)
  KTOPC => GET_DEVICE_DATA_RDWR (YD_KTOPC)
  LDCUM => GET_DEVICE_DATA_RDONLY (YD_LDCUM)
  PARPRC => GET_DEVICE_DATA_RDWR (YD_PARPRC)
  PLU => GET_DEVICE_DATA_RDONLY (YD_PLU)
  PMFU => GET_DEVICE_DATA_RDONLY (YD_PMFU)
  ZQU => GET_DEVICE_DATA_RDONLY (YL_ZQU)
  ZRAIN => GET_DEVICE_DATA_RDONLY (YL_ZRAIN)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (KBASEC, KCBOT, KCTOP, KTOPC, LDCUM, PARPRC, PLU, PMFU, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZQU, ZRAIN) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL CUCCDIA_OPENACC (YDERAD, YDML_PHY_SLIN%YREPHLI, YDML_PHY_EC%YREPHY, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, KLEV, KSTEP, KCBOT(:, JBLK), KCTOP(:,&
      & JBLK), LDCUM(:, JBLK), ZQU(:,:, JBLK), PLU(:,:, JBLK), PMFU(:,:, JBLK), ZRAIN(:&
      &, JBLK), PARPRC(:, JBLK), KTOPC(:, JBLK), KBASEC(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KBASEC => NULL ()
  KCBOT => NULL ()
  KCTOP => NULL ()
  KTOPC => NULL ()
  LDCUM => NULL ()
  PARPRC => NULL ()
  PLU => NULL ()
  PMFU => NULL ()
  ZQU => NULL ()
  ZRAIN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CUCALLN_MF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:3',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CUCALLN_MF_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAPHM1 => GET_HOST_DATA_RDONLY (YD_PAPHM1)
  PDIFCQ => GET_HOST_DATA_RDWR (YD_PDIFCQ)
  PDIFCS => GET_HOST_DATA_RDWR (YD_PDIFCS)
  PFCQIF => GET_HOST_DATA_RDWR (YD_PFCQIF)
  PFCQLF => GET_HOST_DATA_RDWR (YD_PFCQLF)
  PFHPCL => GET_HOST_DATA_RDWR (YD_PFHPCL)
  PFHPCN => GET_HOST_DATA_RDWR (YD_PFHPCN)
  PFPLCL => GET_HOST_DATA_RDONLY (YD_PFPLCL)
  PFPLCN => GET_HOST_DATA_RDONLY (YD_PFPLCN)
  PLUDELI => GET_HOST_DATA_RDONLY (YD_PLUDELI)
  PSTRCU => GET_HOST_DATA_RDWR (YD_PSTRCU)
  PSTRCV => GET_HOST_DATA_RDWR (YD_PSTRCV)
  PTENQ => GET_HOST_DATA_RDONLY (YD_PTENQ)
  PTENT => GET_HOST_DATA_RDONLY (YD_PTENT)
  PTENU => GET_HOST_DATA_RDONLY (YD_PTENU)
  PTENV => GET_HOST_DATA_RDONLY (YD_PTENV)
  ZCONDFLL => GET_HOST_DATA_RDWR (YL_ZCONDFLL)
  ZCONDFLN => GET_HOST_DATA_RDWR (YL_ZCONDFLN)
  ZQEA => GET_HOST_DATA_RDONLY (YL_ZQEA)
  ZQP1 => GET_HOST_DATA_RDONLY (YL_ZQP1)
  ZTEA => GET_HOST_DATA_RDONLY (YL_ZTEA)
  ZUEA => GET_HOST_DATA_RDONLY (YL_ZUEA)
  ZVEA => GET_HOST_DATA_RDONLY (YL_ZVEA)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JK, JLON, ZCP, ZGDPH) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      PDIFCQ (JLON, 1, JBLK)=0.0_JPRB
      PDIFCS (JLON, 1, JBLK)=0.0_JPRB
      PSTRCU (JLON, 1, JBLK)=0.0_JPRB
      PSTRCV (JLON, 1, JBLK)=0.0_JPRB
      PFCQLF (JLON, 1, JBLK)=0.0_JPRB
      PFCQIF (JLON, 1, JBLK)=0.0_JPRB
      PFHPCL (JLON, 1, JBLK)=0.0_JPRB
      PFHPCN (JLON, 1, JBLK)=0.0_JPRB
      PDIFCS (JLON, 1, JBLK)=0.0_JPRB
      PDIFCQ (JLON, 1, JBLK)=0.0_JPRB
      ZCONDFLL (JLON, JBLK)=0.0_JPRB
      ZCONDFLN (JLON, JBLK)=0.0_JPRB
    ENDDO


    DO JK=1, KLEV

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZGDPH=-YDCST%RG/(PAPHM1 (JLON, JK+1, JBLK)-PAPHM1 (JLON, JK, JBLK))
        ZCP=YDCST%RCPD*(1+YDTHF%RVTMP2*ZQP1 (JLON, JK, JBLK))
        PDIFCS (JLON, JK+1, JBLK)=(PTENT (JLON, JK, JBLK)-ZTEA &
        &(JLON, JK, JBLK))/ZGDPH*ZCP+PDIFCS (JLON, JK, JBLK)
        PSTRCU (JLON, JK+1, JBLK)=(PTENU (JLON, JK, JBLK)-ZUEA&
        & (JLON, JK, JBLK))/ZGDPH+PSTRCU (JLON, JK, JBLK)
        PSTRCV (JLON, JK+1, JBLK)=(PTENV (JLON, JK, JBLK)-ZVEA&
        & (JLON, JK, JBLK))/ZGDPH+PSTRCV (JLON, JK, JBLK)
        PDIFCQ (JLON, JK+1, JBLK)=(PTENQ (JLON, JK, JBLK)-ZQEA&
        & (JLON, JK, JBLK))/ZGDPH+PDIFCQ (JLON, JK, JBLK)
      ENDDO

    ENDDO


    DO JK=1, KLEV

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PFHPCL (JLON, JK+1, JBLK)=-PFPLCL (JLON, JK+1, JBLK)*YDCST%RLVTT
        PFHPCN (JLON, JK+1, JBLK)=-PFPLCN (JLON, JK+1, JBLK)*YDCST%RLSTT
        ZCONDFLL (JLON, JBLK)=ZCONDFLL (JLON, JBLK)+PLUDELI (JLON, JK, 1, JBLK)
        ZCONDFLN (JLON, JBLK)=ZCONDFLN (JLON, JBLK)+PLUDELI (JLON, JK, 2, JBLK)
        PDIFCS (JLON, JK+1, JBLK)=PDIFCS (JLON, JK+1, JBLK)-PFHPCL (JLON, JK+1, JBLK)-PFHPCN (JLON&
        &, JK+1, JBLK)+YDCST%RLVTT*ZCONDFLL (JLON, JBLK)+YDCST%RLSTT*ZCONDFLN (JLON, JBLK)
        PDIFCQ (JLON, JK+1, JBLK)=PDIFCQ (JLON, JK+1, JBLK)-PFPLCL (JLON, JK+1, JBLK&
        &)-PFPLCN (JLON, JK+1, JBLK)-ZCONDFLL (JLON, JBLK)-ZCONDFLN (JLON, JBLK)
        PFCQLF (JLON, JK+1, JBLK)=ZCONDFLL (JLON, JBLK)
        PFCQIF (JLON, JK+1, JBLK)=ZCONDFLN (JLON, JBLK)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAPHM1 => NULL ()
  PDIFCQ => NULL ()
  PDIFCS => NULL ()
  PFCQIF => NULL ()
  PFCQLF => NULL ()
  PFHPCL => NULL ()
  PFHPCN => NULL ()
  PFPLCL => NULL ()
  PFPLCN => NULL ()
  PLUDELI => NULL ()
  PSTRCU => NULL ()
  PSTRCV => NULL ()
  PTENQ => NULL ()
  PTENT => NULL ()
  PTENU => NULL ()
  PTENV => NULL ()
  ZCONDFLL => NULL ()
  ZCONDFLN => NULL ()
  ZQEA => NULL ()
  ZQP1 => NULL ()
  ZTEA => NULL ()
  ZUEA => NULL ()
  ZVEA => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CUCALLN_MF_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAPHM1 => GET_DEVICE_DATA_RDONLY (YD_PAPHM1)
  PDIFCQ => GET_DEVICE_DATA_RDWR (YD_PDIFCQ)
  PDIFCS => GET_DEVICE_DATA_RDWR (YD_PDIFCS)
  PFCQIF => GET_DEVICE_DATA_RDWR (YD_PFCQIF)
  PFCQLF => GET_DEVICE_DATA_RDWR (YD_PFCQLF)
  PFHPCL => GET_DEVICE_DATA_RDWR (YD_PFHPCL)
  PFHPCN => GET_DEVICE_DATA_RDWR (YD_PFHPCN)
  PFPLCL => GET_DEVICE_DATA_RDONLY (YD_PFPLCL)
  PFPLCN => GET_DEVICE_DATA_RDONLY (YD_PFPLCN)
  PLUDELI => GET_DEVICE_DATA_RDONLY (YD_PLUDELI)
  PSTRCU => GET_DEVICE_DATA_RDWR (YD_PSTRCU)
  PSTRCV => GET_DEVICE_DATA_RDWR (YD_PSTRCV)
  PTENQ => GET_DEVICE_DATA_RDONLY (YD_PTENQ)
  PTENT => GET_DEVICE_DATA_RDONLY (YD_PTENT)
  PTENU => GET_DEVICE_DATA_RDONLY (YD_PTENU)
  PTENV => GET_DEVICE_DATA_RDONLY (YD_PTENV)
  ZCONDFLL => GET_DEVICE_DATA_RDWR (YL_ZCONDFLL)
  ZCONDFLN => GET_DEVICE_DATA_RDWR (YL_ZCONDFLN)
  ZQEA => GET_DEVICE_DATA_RDONLY (YL_ZQEA)
  ZQP1 => GET_DEVICE_DATA_RDONLY (YL_ZQP1)
  ZTEA => GET_DEVICE_DATA_RDONLY (YL_ZTEA)
  ZUEA => GET_DEVICE_DATA_RDONLY (YL_ZUEA)
  ZVEA => GET_DEVICE_DATA_RDONLY (YL_ZVEA)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PAPHM1, PDIFCQ, PDIFCS, PFCQIF, PFCQLF, PFHPCL, PFHPCN, PFPLCL, PFPLCN, &
    !$ACC&         PLUDELI, PSTRCU, PSTRCV, PTENQ, PTENT, PTENU, PTENV, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZCONDFLL, ZCONDFLN, ZQEA, ZQP1, ZTEA, ZUEA, ZVEA) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JK, JLON, YLCPG_BNDS, ZCP, ZGDPH) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      PDIFCQ (JLON, 1, JBLK)=0.0_JPRB
      PDIFCS (JLON, 1, JBLK)=0.0_JPRB
      PSTRCU (JLON, 1, JBLK)=0.0_JPRB
      PSTRCV (JLON, 1, JBLK)=0.0_JPRB
      PFCQLF (JLON, 1, JBLK)=0.0_JPRB
      PFCQIF (JLON, 1, JBLK)=0.0_JPRB
      PFHPCL (JLON, 1, JBLK)=0.0_JPRB
      PFHPCN (JLON, 1, JBLK)=0.0_JPRB
      PDIFCS (JLON, 1, JBLK)=0.0_JPRB
      PDIFCQ (JLON, 1, JBLK)=0.0_JPRB
      ZCONDFLL (JLON, JBLK)=0.0_JPRB
      ZCONDFLN (JLON, JBLK)=0.0_JPRB

      

      DO JK=1, KLEV
        
        ZGDPH=-YDCST%RG/(PAPHM1 (JLON, JK+1, JBLK)-PAPHM1 (JLON, JK, JBLK))
        ZCP=YDCST%RCPD*(1+YDTHF%RVTMP2*ZQP1 (JLON, JK, JBLK))
        PDIFCS (JLON, JK+1, JBLK)=(PTENT (JLON, JK, JBLK)-ZTEA &
        &(JLON, JK, JBLK))/ZGDPH*ZCP+PDIFCS (JLON, JK, JBLK)
        PSTRCU (JLON, JK+1, JBLK)=(PTENU (JLON, JK, JBLK)-ZUEA&
        & (JLON, JK, JBLK))/ZGDPH+PSTRCU (JLON, JK, JBLK)
        PSTRCV (JLON, JK+1, JBLK)=(PTENV (JLON, JK, JBLK)-ZVEA&
        & (JLON, JK, JBLK))/ZGDPH+PSTRCV (JLON, JK, JBLK)
        PDIFCQ (JLON, JK+1, JBLK)=(PTENQ (JLON, JK, JBLK)-ZQEA&
        & (JLON, JK, JBLK))/ZGDPH+PDIFCQ (JLON, JK, JBLK)
      
      ENDDO


      DO JK=1, KLEV
        
        PFHPCL (JLON, JK+1, JBLK)=-PFPLCL (JLON, JK+1, JBLK)*YDCST%RLVTT
        PFHPCN (JLON, JK+1, JBLK)=-PFPLCN (JLON, JK+1, JBLK)*YDCST%RLSTT
        ZCONDFLL (JLON, JBLK)=ZCONDFLL (JLON, JBLK)+PLUDELI (JLON, JK, 1, JBLK)
        ZCONDFLN (JLON, JBLK)=ZCONDFLN (JLON, JBLK)+PLUDELI (JLON, JK, 2, JBLK)
        PDIFCS (JLON, JK+1, JBLK)=PDIFCS (JLON, JK+1, JBLK)-PFHPCL (JLON, JK+1, JBLK)-PFHPCN (JLON&
        &, JK+1, JBLK)+YDCST%RLVTT*ZCONDFLL (JLON, JBLK)+YDCST%RLSTT*ZCONDFLN (JLON, JBLK)
        PDIFCQ (JLON, JK+1, JBLK)=PDIFCQ (JLON, JK+1, JBLK)-PFPLCL (JLON, JK+1, JBLK&
        &)-PFPLCN (JLON, JK+1, JBLK)-ZCONDFLL (JLON, JBLK)-ZCONDFLN (JLON, JBLK)
        PFCQLF (JLON, JK+1, JBLK)=ZCONDFLL (JLON, JBLK)
        PFCQIF (JLON, JK+1, JBLK)=ZCONDFLN (JLON, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAPHM1 => NULL ()
  PDIFCQ => NULL ()
  PDIFCS => NULL ()
  PFCQIF => NULL ()
  PFCQLF => NULL ()
  PFHPCL => NULL ()
  PFHPCN => NULL ()
  PFPLCL => NULL ()
  PFPLCN => NULL ()
  PLUDELI => NULL ()
  PSTRCU => NULL ()
  PSTRCV => NULL ()
  PTENQ => NULL ()
  PTENT => NULL ()
  PTENU => NULL ()
  PTENV => NULL ()
  ZCONDFLL => NULL ()
  ZCONDFLN => NULL ()
  ZQEA => NULL ()
  ZQP1 => NULL ()
  ZTEA => NULL ()
  ZUEA => NULL ()
  ZVEA => NULL ()
  IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('CUCALLN_MF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL:4',1,ZHOOK_HANDLE_PARALLEL)

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZCONDFLL)) CALL FIELD_DELETE (YL_ZCONDFLL)
IF (ASSOCIATED (YL_ZCONDFLN)) CALL FIELD_DELETE (YL_ZCONDFLN)
IF (ASSOCIATED (YL_ZCP1)) CALL FIELD_DELETE (YL_ZCP1)
IF (ASSOCIATED (YL_ZENTHD)) CALL FIELD_DELETE (YL_ZENTHD)
IF (ASSOCIATED (YL_ZENTHS)) CALL FIELD_DELETE (YL_ZENTHS)
IF (ASSOCIATED (YL_ZQEA)) CALL FIELD_DELETE (YL_ZQEA)
IF (ASSOCIATED (YL_ZQP1)) CALL FIELD_DELETE (YL_ZQP1)
IF (ASSOCIATED (YL_ZQSAT)) CALL FIELD_DELETE (YL_ZQSAT)
IF (ASSOCIATED (YL_ZQU)) CALL FIELD_DELETE (YL_ZQU)
IF (ASSOCIATED (YL_ZRAIN)) CALL FIELD_DELETE (YL_ZRAIN)
IF (ASSOCIATED (YL_ZTEA)) CALL FIELD_DELETE (YL_ZTEA)
IF (ASSOCIATED (YL_ZTP1)) CALL FIELD_DELETE (YL_ZTP1)
IF (ASSOCIATED (YL_ZTU)) CALL FIELD_DELETE (YL_ZTU)
IF (ASSOCIATED (YL_ZUEA)) CALL FIELD_DELETE (YL_ZUEA)
IF (ASSOCIATED (YL_ZUP1)) CALL FIELD_DELETE (YL_ZUP1)
IF (ASSOCIATED (YL_ZVEA)) CALL FIELD_DELETE (YL_ZVEA)
IF (ASSOCIATED (YL_ZVP1)) CALL FIELD_DELETE (YL_ZVP1)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('CUCALLN_MF_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE CUCALLN_MF_PARALLEL
