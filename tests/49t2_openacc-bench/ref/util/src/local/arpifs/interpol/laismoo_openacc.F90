SUBROUTINE LAISMOO_OPENACC (KSLB1, KPROMA, KST, KEND, KFLEV, KFLDN&
&, KFLDX, PDLAT, PDLO, KL0, PDVER, PXSL, PXF, YDSTACK)
!$ACC ROUTINE (LAISMOO_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB, JPIB

#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


INTEGER (KIND=JPIM), INTENT (IN)::KSLB1
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KFLDN
INTEGER (KIND=JPIM), INTENT (IN)::KFLDX
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PDLAT (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PDLO (KPROMA, KFLEV, 0:3)
INTEGER (KIND=JPIM), INTENT (IN)::KL0 (KPROMA, KFLEV, 0:3)
REAL (KIND=JPRB), INTENT (IN)::PDVER (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PXSL (KSLB1*(KFLDX-KFLDN+1))
REAL (KIND=JPRB), INTENT (OUT)::PXF (KPROMA, KFLEV)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIB)::IV2L3
INTEGER (KIND=JPIB)::IV2L2
INTEGER (KIND=JPIB)::IV2L1
INTEGER (KIND=JPIB)::IV2L0
INTEGER (KIND=JPIB)::IV1L3
INTEGER (KIND=JPIB)::IV1L2
INTEGER (KIND=JPIB)::IV1L1
INTEGER (KIND=JPIB)::IV1L0
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZPOI (0:3, 0:3, 2)
REAL (KIND=JPRB)::ZSILO3
REAL (KIND=JPRB)::ZSILO2
REAL (KIND=JPRB)::ZSILO1
REAL (KIND=JPRB)::ZSILO
REAL (KIND=JPRB)::ZSI
REAL (KIND=JPRB)::ZISLO3
REAL (KIND=JPRB)::ZISLO2
REAL (KIND=JPRB)::ZISLO1
REAL (KIND=JPRB)::ZISLO
REAL (KIND=JPRB)::ZIS
REAL (KIND=JPRB)::ZDVER
#include "laismoo.func.h"


JROF = KST


IV1L0=KSLB1
IV1L1=1+KSLB1
IV1L2=2+KSLB1
IV1L3=3+KSLB1
IV2L0=IV1L0+KSLB1
IV2L1=IV1L1+KSLB1
IV2L2=IV1L2+KSLB1
IV2L3=IV1L3+KSLB1

DO JLEV=1, KFLEV
  
  ZPOI (1, 1, 1)=PXSL (KL0 (JROF, JLEV, 1)+IV1L1)
  ZPOI (2, 1, 1)=PXSL (KL0 (JROF, JLEV, 1)+IV1L2)
  ZPOI (1, 2, 1)=PXSL (KL0 (JROF, JLEV, 2)+IV1L1)
  ZPOI (2, 2, 1)=PXSL (KL0 (JROF, JLEV, 2)+IV1L2)
  ZPOI (1, 1, 2)=PXSL (KL0 (JROF, JLEV, 1)+IV2L1)
  ZPOI (2, 1, 2)=PXSL (KL0 (JROF, JLEV, 1)+IV2L2)
  ZPOI (1, 2, 2)=PXSL (KL0 (JROF, JLEV, 2)+IV2L1)
  ZPOI (2, 2, 2)=PXSL (KL0 (JROF, JLEV, 2)+IV2L2)
  ZDVER=PDVER (JROF, JLEV)
  ZSILO=PXSL (KL0 (JROF, JLEV, 0)+IV1L0)*FSLO1 (PDLO (JROF, JLEV, 0))+PXSL (KL0 (JROF, JLEV&
  &, 0)+IV1L1)*FSLO2 (PDLO (JROF, JLEV, 0))+PXSL (KL0 (JROF, JLEV, 0)+IV1L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 0))+PXSL (KL0 (JROF, JLEV, 0)+IV1L3)*FSLO4 (PDLO (JROF, JLEV, 0))
  ZSILO1=PXSL (KL0 (JROF, JLEV, 1)+IV1L0)*FSLO1 (PDLO (JROF, JLEV, 1))+PXSL (KL0 (JROF, JLEV&
  &, 1)+IV1L1)*FSLO2 (PDLO (JROF, JLEV, 1))+PXSL (KL0 (JROF, JLEV, 1)+IV1L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 1))+PXSL (KL0 (JROF, JLEV, 1)+IV1L3)*FSLO4 (PDLO (JROF, JLEV, 1))
  ZSILO2=PXSL (KL0 (JROF, JLEV, 2)+IV1L0)*FSLO1 (PDLO (JROF, JLEV, 2))+PXSL (KL0 (JROF, JLEV&
  &, 2)+IV1L1)*FSLO2 (PDLO (JROF, JLEV, 2))+PXSL (KL0 (JROF, JLEV, 2)+IV1L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 2))+PXSL (KL0 (JROF, JLEV, 2)+IV1L3)*FSLO4 (PDLO (JROF, JLEV, 2))
  ZSILO3=PXSL (KL0 (JROF, JLEV, 3)+IV1L0)*FSLO1 (PDLO (JROF, JLEV, 3))+PXSL (KL0 (JROF, JLEV&
  &, 3)+IV1L1)*FSLO2 (PDLO (JROF, JLEV, 3))+PXSL (KL0 (JROF, JLEV, 3)+IV1L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 3))+PXSL (KL0 (JROF, JLEV, 3)+IV1L3)*FSLO4 (PDLO (JROF, JLEV, 3))
  ZISLO=PXSL (KL0 (JROF, JLEV, 0)+IV2L0)*FSLO1 (PDLO (JROF, JLEV, 0))+PXSL (KL0 (JROF, JLEV&
  &, 0)+IV2L1)*FSLO2 (PDLO (JROF, JLEV, 0))+PXSL (KL0 (JROF, JLEV, 0)+IV2L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 0))+PXSL (KL0 (JROF, JLEV, 0)+IV2L3)*FSLO4 (PDLO (JROF, JLEV, 0))
  ZISLO1=PXSL (KL0 (JROF, JLEV, 1)+IV2L0)*FSLO1 (PDLO (JROF, JLEV, 1))+PXSL (KL0 (JROF, JLEV&
  &, 1)+IV2L1)*FSLO2 (PDLO (JROF, JLEV, 1))+PXSL (KL0 (JROF, JLEV, 1)+IV2L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 1))+PXSL (KL0 (JROF, JLEV, 1)+IV2L3)*FSLO4 (PDLO (JROF, JLEV, 1))
  ZISLO2=PXSL (KL0 (JROF, JLEV, 2)+IV2L0)*FSLO1 (PDLO (JROF, JLEV, 2))+PXSL (KL0 (JROF, JLEV&
  &, 2)+IV2L1)*FSLO2 (PDLO (JROF, JLEV, 2))+PXSL (KL0 (JROF, JLEV, 2)+IV2L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 2))+PXSL (KL0 (JROF, JLEV, 2)+IV2L3)*FSLO4 (PDLO (JROF, JLEV, 2))
  ZISLO3=PXSL (KL0 (JROF, JLEV, 3)+IV2L0)*FSLO1 (PDLO (JROF, JLEV, 3))+PXSL (KL0 (JROF, JLEV&
  &, 3)+IV2L1)*FSLO2 (PDLO (JROF, JLEV, 3))+PXSL (KL0 (JROF, JLEV, 3)+IV2L2)*FSLO3 (PDLO&
  & (JROF, JLEV, 3))+PXSL (KL0 (JROF, JLEV, 3)+IV2L3)*FSLO4 (PDLO (JROF, JLEV, 3))
  ZSI=ZSILO*FSLO1 (PDLAT (JROF, JLEV))+ZSILO1*FSLO2 (PDLAT (JROF, JLEV))+ZSILO2&
  &*FSLO3 (PDLAT (JROF, JLEV))+ZSILO3*FSLO4 (PDLAT (JROF, JLEV))
  ZIS=ZISLO*FSLO1 (PDLAT (JROF, JLEV))+ZISLO1*FSLO2 (PDLAT (JROF, JLEV))+ZISLO2&
  &*FSLO3 (PDLAT (JROF, JLEV))+ZISLO3*FSLO4 (PDLAT (JROF, JLEV))
  PXF (JROF, JLEV)=ZSI+ZDVER*(ZIS-ZSI)
  
ENDDO


END SUBROUTINE LAISMOO_OPENACC
