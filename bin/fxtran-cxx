#!/usr/bin/env perl 

=head1 NAME

fxtran-cxx

=head1 DESCRIPTION

This script is a wrapper for the C and the C++ compilers. The ACDC library is included in the link,
and archive may be replaced by list of objects if the script is invoked to perform a link.

=head1 AUTHOR

philippe.marguinaud@meteo.fr

=head1 COPYRIGHT

Meteo-France 2025

=cut

use warnings;

use FindBin qw ($Bin);
use lib "$Bin/../lib";

use Fxtran::Common;

use Getopt::Long;

use strict;

use Fxtran::AR;

my @opts_f = qw ();
my @opts_s = qw (config prefix);

my %opts;

&GetOptions
(
  (map { ($_, \$opts{$_}) } @opts_f),
  (map { ("$_=s", \$opts{$_}) } @opts_s),
);

my @argv = @ARGV;

if ($opts{prefix})
  {
    push @argv, "-L$opts{prefix}/lib", '-lFxtranACDC';
  }

if (grep { $_ eq '-c' } @argv)
  {
    exec (@argv);
  }

&Fxtran::AR::expandObjects (\@argv);

exec (@argv);


