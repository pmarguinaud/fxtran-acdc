SUBROUTINE APL_ARPEGE_PARALLEL (YDMF_PHYS_BASE_STATE, YDMF_PHYS_NEXT_STATE, YDGEOMETRY&
&, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR, YDCPG_PHY0, YDMF_PHYS, YDCPG_DYN0&
&, YDMF_PHYS_SURF, YDCPG_SL2, YDVARS, YDCFU, YDMODEL, YDDDH, YDPHYSMWAVE)
USE GEOMETRY_MOD,ONLY:GEOMETRY
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE, CPG_DYN_TYPE, CPG_GPAR_TYPE, CPG_PHY_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE MF_PHYS_NEXT_STATE_TYPE_MOD,ONLY:MF_PHYS_NEXT_STATE_TYPE
USE TYPE_MODEL,ONLY:MODEL

USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE DDH_MIX,ONLY:TYP_DDH
USE YOE_PHYS_MWAVE,ONLY:TEPHYSMWAVE
USE YOMCFU,ONLY:TCFU
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (MF_PHYS_NEXT_STATE_TYPE), INTENT (INOUT)::YDMF_PHYS_NEXT_STATE
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (CPG_GPAR_TYPE), INTENT (INOUT)::YDCPG_GPAR
TYPE (CPG_PHY_TYPE), INTENT (IN)::YDCPG_PHY0
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (CPG_SL2_TYPE), INTENT (INOUT)::YDCPG_SL2
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (TCFU), INTENT (IN)::YDCFU
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (TYP_DDH), INTENT (INOUT)::YDDDH
TYPE (TEPHYSMWAVE), INTENT (INOUT)::YDPHYSMWAVE
#include "cpphinp.intfb.h"
#include "abor1.intfb.h"
#include "cpphinp_openacc.intfb.h"
#include "mf_phys_fpl_part1_parallel.intfb.h"
#include "mf_phys_save_phsurf_part1_parallel.intfb.h"
#include "aplpar_init.intfb.h"
#include "aplpar_init_openacc.intfb.h"
#include "checkmv.intfb.h"
#include "apl_arpege_init_parallel.intfb.h"
#include "actqsat.intfb.h"
#include "actqsat_openacc.intfb.h"
#include "acsol.intfb.h"
#include "acsol_openacc.intfb.h"
#include "apl_arpege_init_surfex_parallel.intfb.h"
#include "accldia.intfb.h"
#include "accldia_openacc.intfb.h"
#include "acclph.intfb.h"
#include "acclph_openacc.intfb.h"
#include "acdnshf.intfb.h"
#include "acdnshf_openacc.intfb.h"
#include "acdrag.intfb.h"
#include "acdrag_openacc.intfb.h"
#include "acdrme.intfb.h"
#include "acdrme_openacc.intfb.h"
#include "acevadcape.intfb.h"
#include "acevadcape_openacc.intfb.h"
#include "achmt.intfb.h"
#include "achmt_openacc.intfb.h"
#include "achmtls.intfb.h"
#include "achmtls_openacc.intfb.h"
#include "acpluis.intfb.h"
#include "acpluis_openacc.intfb.h"
#include "acvisih.intfb.h"
#include "acvisih_openacc.intfb.h"
#include "cpqsol.intfb.h"
#include "mf_phys_bayrad.intfb.h"
#include "mf_phys_bayrad_openacc.intfb.h"
#include "mf_phys_corwat.intfb.h"
#include "mf_phys_cvv.intfb.h"
#include "mf_phys_fpl_part2_parallel.intfb.h"
#include "mf_phys_mocon_parallel.intfb.h"
#include "mf_phys_precips.intfb.h"
#include "mf_phys_precips_openacc.intfb.h"
#include "mf_phys_save_phsurf_part2_parallel.intfb.h"
#include "mf_phys_transfer_parallel.intfb.h"
#include "ppwetpoint.intfb.h"
#include "ppwetpoint_openacc.intfb.h"
#include "qngcor.intfb.h"
#include "qngcor_openacc.intfb.h"
#include "apl_arpege_oceanic_fluxes_parallel.intfb.h"
#include "apl_wind_gust_parallel.intfb.h"
#include "apl_arpege_shallow_convection_and_turbulence_parallel.intfb.h"
#include "apl_arpege_albedo_computation_parallel.intfb.h"
#include "apl_arpege_aerosols_for_radiation_parallel.intfb.h"
#include "apl_arpege_cloudiness_parallel.intfb.h"
#include "apl_arpege_radiation_parallel.intfb.h"
#include "apl_arpege_soil_hydro_parallel.intfb.h"
#include "apl_arpege_surface_parallel.intfb.h"
#include "apl_arpege_deep_convection_parallel.intfb.h"
#include "apl_arpege_turbulence_part2.intfb.h"
#include "apl_arpege_turbulence_part2_openacc.intfb.h"
#include "apl_arpege_precipitation_parallel.intfb.h"
#include "apl_arpege_hydro_budget_parallel.intfb.h"
#include "apl_arpege_surface_update_parallel.intfb.h"
#include "apl_arpege_atmosphere_update_parallel.intfb.h"
#include "apl_arpege_dprecips_parallel.intfb.h"
#include "apl_arpege_mwave_parallel.intfb.h"
CLASS (FIELD_4RB), POINTER :: YL_ZDIFEXT
REAL (KIND=JPRB), POINTER::ZDIFEXT (:,:,:,:)
CLASS (FIELD_3IM), POINTER :: YL_INLAB_CVPP
INTEGER (KIND=JPIM), POINTER::INLAB_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZXUROV
REAL (KIND=JPRB), POINTER::ZXUROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZXTROV
REAL (KIND=JPRB), POINTER::ZXTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMRIPP
REAL (KIND=JPRB), POINTER::ZMRIPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNBVNO
REAL (KIND=JPRB), POINTER::ZNBVNO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZKTROV
REAL (KIND=JPRB), POINTER::ZKTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZKUROV2
REAL (KIND=JPRB), POINTER::ZKUROV2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZKUROV
REAL (KIND=JPRB), POINTER::ZKUROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZKQLROV
REAL (KIND=JPRB), POINTER::ZKQLROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZKQROV
REAL (KIND=JPRB), POINTER::ZKQROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNEBS
REAL (KIND=JPRB), POINTER::ZNEBS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQLIS
REAL (KIND=JPRB), POINTER::ZQLIS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNEBS0
REAL (KIND=JPRB), POINTER::ZNEBS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQLIS0
REAL (KIND=JPRB), POINTER::ZQLIS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNEBC0
REAL (KIND=JPRB), POINTER::ZNEBC0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNEBDIFF
REAL (KIND=JPRB), POINTER::ZNEBDIFF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNEBCH
REAL (KIND=JPRB), POINTER::ZNEBCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUNEBH
REAL (KIND=JPRB), POINTER::ZUNEBH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFPCOR
REAL (KIND=JPRB), POINTER::ZFPCOR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPOID
REAL (KIND=JPRB), POINTER::ZPOID (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQV
REAL (KIND=JPRB), POINTER::ZQV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQI
REAL (KIND=JPRB), POINTER::ZQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQL
REAL (KIND=JPRB), POINTER::ZQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQR
REAL (KIND=JPRB), POINTER::ZQR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQS
REAL (KIND=JPRB), POINTER::ZQS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENHA
REAL (KIND=JPRB), POINTER::ZTENHA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENQVA
REAL (KIND=JPRB), POINTER::ZTENQVA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCP
REAL (KIND=JPRB), POINTER::ZCP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFPLSL
REAL (KIND=JPRB), POINTER::ZFPLSL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFPLSN
REAL (KIND=JPRB), POINTER::ZFPLSN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSEDIQL
REAL (KIND=JPRB), POINTER::ZSEDIQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSEDIQI
REAL (KIND=JPRB), POINTER::ZSEDIQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDIFCVPPQ
REAL (KIND=JPRB), POINTER::ZDIFCVPPQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDIFCVPPS
REAL (KIND=JPRB), POINTER::ZDIFCVPPS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDIFCVPPU
REAL (KIND=JPRB), POINTER::ZDIFCVPPU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDIFCVPPV
REAL (KIND=JPRB), POINTER::ZDIFCVPPV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZEDMFQ
REAL (KIND=JPRB), POINTER::ZEDMFQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZEDMFS
REAL (KIND=JPRB), POINTER::ZEDMFS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZEDMFU
REAL (KIND=JPRB), POINTER::ZEDMFU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZEDMFV
REAL (KIND=JPRB), POINTER::ZEDMFV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMF_UP
REAL (KIND=JPRB), POINTER::ZMF_UP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCONDCVPPL
REAL (KIND=JPRB), POINTER::ZCONDCVPPL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCONDCVPPI
REAL (KIND=JPRB), POINTER::ZCONDCVPPI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPRODTH_CVPP
REAL (KIND=JPRB), POINTER::ZPRODTH_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPRODTH
REAL (KIND=JPRB), POINTER::ZPRODTH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDE2MR
REAL (KIND=JPRB), POINTER::ZDE2MR (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZXDROV
REAL (KIND=JPRB), POINTER::ZXDROV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZXHROV
REAL (KIND=JPRB), POINTER::ZXHROV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZUGST
REAL (KIND=JPRB), POINTER::ZUGST (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZVGST
REAL (KIND=JPRB), POINTER::ZVGST (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCDROV
REAL (KIND=JPRB), POINTER::ZCDROV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCHROV
REAL (KIND=JPRB), POINTER::ZCHROV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDQSTS
REAL (KIND=JPRB), POINTER::ZDQSTS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGWDCS
REAL (KIND=JPRB), POINTER::ZGWDCS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZHQ
REAL (KIND=JPRB), POINTER::ZHQ (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZHU
REAL (KIND=JPRB), POINTER::ZHU (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZHTR
REAL (KIND=JPRB), POINTER::ZHTR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRTI
REAL (KIND=JPRB), POINTER::ZRTI (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDPHI
REAL (KIND=JPRB), POINTER::ZDPHI (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPRS
REAL (KIND=JPRB), POINTER::ZPRS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSTAB
REAL (KIND=JPRB), POINTER::ZSTAB (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWFC
REAL (KIND=JPRB), POINTER::ZWFC (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWPMX
REAL (KIND=JPRB), POINTER::ZWPMX (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWLMX
REAL (KIND=JPRB), POINTER::ZWLMX (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWSEQ
REAL (KIND=JPRB), POINTER::ZWSEQ (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWSMX
REAL (KIND=JPRB), POINTER::ZWSMX (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZWWILT
REAL (KIND=JPRB), POINTER::ZWWILT (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZC3
REAL (KIND=JPRB), POINTER::ZC3 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCG
REAL (KIND=JPRB), POINTER::ZCG (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCN
REAL (KIND=JPRB), POINTER::ZCN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZNEIJG
REAL (KIND=JPRB), POINTER::ZNEIJG (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZNEIJV
REAL (KIND=JPRB), POINTER::ZNEIJV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZPCLS
REAL (KIND=JPRB), POINTER::ZPCLS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZBLH
REAL (KIND=JPRB), POINTER::ZBLH (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQO3
REAL (KIND=JPRB), POINTER::ZQO3 (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZAER
REAL (KIND=JPRB), POINTER::ZAER (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZAERINDS
REAL (KIND=JPRB), POINTER::ZAERINDS (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDPHIT
REAL (KIND=JPRB), POINTER::ZDPHIT (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDPHIV
REAL (KIND=JPRB), POINTER::ZDPHIV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZTRSOD
REAL (KIND=JPRB), POINTER::ZTRSOD (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCTRSO
REAL (KIND=JPRB), POINTER::ZCTRSO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCEMTR
REAL (KIND=JPRB), POINTER::ZCEMTR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZALBP
REAL (KIND=JPRB), POINTER::ZALBP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZALBD
REAL (KIND=JPRB), POINTER::ZALBD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSFSWDIF
REAL (KIND=JPRB), POINTER::ZSFSWDIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSFSWDIR
REAL (KIND=JPRB), POINTER::ZSFSWDIR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTRSODIF
REAL (KIND=JPRB), POINTER::ZTRSODIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTRSODIR
REAL (KIND=JPRB), POINTER::ZTRSODIR (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSUDU
REAL (KIND=JPRB), POINTER::ZSUDU (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZTHETAVS
REAL (KIND=JPRB), POINTER::ZTHETAVS (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGEOSLC
REAL (KIND=JPRB), POINTER::ZGEOSLC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTENT
REAL (KIND=JPRB), POINTER::ZTENT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTHETAV
REAL (KIND=JPRB), POINTER::ZTHETAV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCOEFN
REAL (KIND=JPRB), POINTER::ZCOEFN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQCO2
REAL (KIND=JPRB), POINTER::ZQCO2 (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZALBDIR
REAL (KIND=JPRB), POINTER::ZALBDIR (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCLCT_RAD
REAL (KIND=JPRB), POINTER::ZCLCT_RAD (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQLI_CVPP
REAL (KIND=JPRB), POINTER::ZQLI_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNEB_CVPP
REAL (KIND=JPRB), POINTER::ZNEB_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBTH
REAL (KIND=JPRB), POINTER::ZCFBTH (:,:,:)
REAL (KIND=JPRB)::ZSTATI
REAL (KIND=JPRB)::ZRHGMT
REAL (KIND=JPRB)::ZDTMSE
CLASS (FIELD_3RB), POINTER :: YL_ZCFATH
REAL (KIND=JPRB), POINTER::ZCFATH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFAU
REAL (KIND=JPRB), POINTER::ZCFAU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBU
REAL (KIND=JPRB), POINTER::ZCFBU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCFBV
REAL (KIND=JPRB), POINTER::ZCFBV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSRAIN
REAL (KIND=JPRB), POINTER::ZSRAIN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSSNOW
REAL (KIND=JPRB), POINTER::ZSSNOW (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSGROUPEL
REAL (KIND=JPRB), POINTER::ZSGROUPEL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZTSN
REAL (KIND=JPRB), POINTER::ZTSN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCE
REAL (KIND=JPRB), POINTER::ZCE (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCEROV
REAL (KIND=JPRB), POINTER::ZCEROV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCRTI
REAL (KIND=JPRB), POINTER::ZCRTI (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZXURO
REAL (KIND=JPRB), POINTER::ZXURO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZXQRO
REAL (KIND=JPRB), POINTER::ZXQRO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZXTRO
REAL (KIND=JPRB), POINTER::ZXTRO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFLX_LOTT_GWU
REAL (KIND=JPRB), POINTER::ZFLX_LOTT_GWU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFLX_LOTT_GWV
REAL (KIND=JPRB), POINTER::ZFLX_LOTT_GWV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTKE1
REAL (KIND=JPRB), POINTER::ZTKE1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQGM
REAL (KIND=JPRB), POINTER::ZQGM (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZALPHA1
REAL (KIND=JPRB), POINTER::ZALPHA1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZCOEFA
REAL (KIND=JPRB), POINTER::ZCOEFA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLVT
REAL (KIND=JPRB), POINTER::ZLVT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQICE
REAL (KIND=JPRB), POINTER::ZQICE (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDIFWQ
REAL (KIND=JPRB), POINTER::ZDIFWQ (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDIFWS
REAL (KIND=JPRB), POINTER::ZDIFWS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSC_FEVI
REAL (KIND=JPRB), POINTER::ZSC_FEVI (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSC_FEVN
REAL (KIND=JPRB), POINTER::ZSC_FEVN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSC_FCLL
REAL (KIND=JPRB), POINTER::ZSC_FCLL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSC_FCLN
REAL (KIND=JPRB), POINTER::ZSC_FCLN (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTRAJGWD
REAL (KIND=JPRB), POINTER::ZTRAJGWD (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZAIPCMT
REAL (KIND=JPRB), POINTER::ZAIPCMT (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQLC
REAL (KIND=JPRB), POINTER::ZQLC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQIC
REAL (KIND=JPRB), POINTER::ZQIC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQLI_CVP
REAL (KIND=JPRB), POINTER::ZQLI_CVP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQC_DET_PCMT
REAL (KIND=JPRB), POINTER::ZQC_DET_PCMT (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDCAPE
REAL (KIND=JPRB), POINTER::ZDCAPE (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDECRD
REAL (KIND=JPRB), POINTER::ZDECRD (:,:)
CLASS (FIELD_2IM), POINTER :: YL_IMOC_CLPH
INTEGER (KIND=JPIM), POINTER::IMOC_CLPH (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZBAY_QRCONV
REAL (KIND=JPRB), POINTER::ZBAY_QRCONV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZBAY_QSCONV
REAL (KIND=JPRB), POINTER::ZBAY_QSCONV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDSA_C1
REAL (KIND=JPRB), POINTER::ZDSA_C1 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDSA_C2
REAL (KIND=JPRB), POINTER::ZDSA_C2 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDSA_CPS
REAL (KIND=JPRB), POINTER::ZDSA_CPS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDSA_LHS
REAL (KIND=JPRB), POINTER::ZDSA_LHS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZDSA_RS
REAL (KIND=JPRB), POINTER::ZDSA_RS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_CDN
REAL (KIND=JPRB), POINTER::ZFLU_CDN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_CD
REAL (KIND=JPRB), POINTER::ZFLU_CD (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_CHN
REAL (KIND=JPRB), POINTER::ZFLU_CHN (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_CH
REAL (KIND=JPRB), POINTER::ZFLU_CH (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_EMIS
REAL (KIND=JPRB), POINTER::ZFLU_EMIS (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFLU_FEVI
REAL (KIND=JPRB), POINTER::ZFLU_FEVI (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_NEIJ
REAL (KIND=JPRB), POINTER::ZFLU_NEIJ (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_QSATS
REAL (KIND=JPRB), POINTER::ZFLU_QSATS (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFLU_QSAT
REAL (KIND=JPRB), POINTER::ZFLU_QSAT (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZFLU_VEG
REAL (KIND=JPRB), POINTER::ZFLU_VEG (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMSC_FRMQ
REAL (KIND=JPRB), POINTER::ZMSC_FRMQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZFCHQ
REAL (KIND=JPRB), POINTER::ZFCHQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMSC_LH
REAL (KIND=JPRB), POINTER::ZMSC_LH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMSC_LSCPE
REAL (KIND=JPRB), POINTER::ZMSC_LSCPE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMSC_QW
REAL (KIND=JPRB), POINTER::ZMSC_QW (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZMSC_TW
REAL (KIND=JPRB), POINTER::ZMSC_TW (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FEFB1
REAL (KIND=JPRB), POINTER::ZPFL_FEFB1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FEFB2
REAL (KIND=JPRB), POINTER::ZPFL_FEFB2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FEFB3
REAL (KIND=JPRB), POINTER::ZPFL_FEFB3 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FPLCH
REAL (KIND=JPRB), POINTER::ZPFL_FPLCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FPLSH
REAL (KIND=JPRB), POINTER::ZPFL_FPLSH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FTKEI
REAL (KIND=JPRB), POINTER::ZPFL_FTKEI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPFL_FTKE
REAL (KIND=JPRB), POINTER::ZPFL_FTKE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPRC_DPRECIPS2
REAL (KIND=JPRB), POINTER::ZPRC_DPRECIPS2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPRC_DPRECIPS
REAL (KIND=JPRB), POINTER::ZPRC_DPRECIPS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRDG_CVGQ
REAL (KIND=JPRB), POINTER::ZRDG_CVGQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRDG_CVGT
REAL (KIND=JPRB), POINTER::ZRDG_CVGT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRDG_LCVQ
REAL (KIND=JPRB), POINTER::ZRDG_LCVQ (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRDG_MU0LU
REAL (KIND=JPRB), POINTER::ZRDG_MU0LU (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRDG_MU0M
REAL (KIND=JPRB), POINTER::ZRDG_MU0M (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRDG_MU0N
REAL (KIND=JPRB), POINTER::ZRDG_MU0N (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRDG_MU0
REAL (KIND=JPRB), POINTER::ZRDG_MU0 (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZRDG_SOLO
REAL (KIND=JPRB), POINTER::ZRDG_SOLO (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSAV_DDAL
REAL (KIND=JPRB), POINTER::ZSAV_DDAL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSAV_DDOM
REAL (KIND=JPRB), POINTER::ZSAV_DDOM (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSAV_ENTCH
REAL (KIND=JPRB), POINTER::ZSAV_ENTCH (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSAV_FHPS
REAL (KIND=JPRB), POINTER::ZSAV_FHPS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSAV_GZ0F
REAL (KIND=JPRB), POINTER::ZSAV_GZ0F (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSAV_GZ0HF
REAL (KIND=JPRB), POINTER::ZSAV_GZ0HF (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSAV_HV
REAL (KIND=JPRB), POINTER::ZSAV_HV (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSAV_PBLH
REAL (KIND=JPRB), POINTER::ZSAV_PBLH (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSAV_QSH
REAL (KIND=JPRB), POINTER::ZSAV_QSH (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSAV_UDAL
REAL (KIND=JPRB), POINTER::ZSAV_UDAL (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSAV_UDGRO
REAL (KIND=JPRB), POINTER::ZSAV_UDGRO (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSAV_UDOM
REAL (KIND=JPRB), POINTER::ZSAV_UDOM (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSAV_UNEBH
REAL (KIND=JPRB), POINTER::ZSAV_UNEBH (:,:,:)
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JLEV
LOGICAL::LLREDPR
LOGICAL::LLHMT
LOGICAL::LLCLS
REAL (KIND=JPRB)::ZEPSNEB
REAL (KIND=JPRB)::ZEPS0
REAL (KIND=JPRB)::ZRVMD
CLASS (FIELD_3RB), POINTER :: YL_ZUSLE
REAL (KIND=JPRB), POINTER::ZUSLE (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZKCLS
REAL (KIND=JPRB), POINTER::ZKCLS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZECTCLS
REAL (KIND=JPRB), POINTER::ZECTCLS (:,:)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DYN0_CTY_EVEL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_NEB(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QICE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QLI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QSOL(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_RH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_PHY0_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_I(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_L(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_TKE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CAPE(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLPH(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CT(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFCS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQ(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DIFTS(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_DRNSHF(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_EDR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCCQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCSQN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FEVN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPEVPSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPFPSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLCN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSL(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FPLSN(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRMH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRSOPT(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTH(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FRTHDS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0H(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_MXCLWC(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NUCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NVCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_QCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_RHCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRMV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_TPWCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UGST(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VEIN(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VGST(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VISICLD(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VISIHYD(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_DI_PXEDR(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PGETRL(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPCL(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VH_PPSN(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PARG(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PD2(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PHV(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_A_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVGQ_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVV_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_CVV_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GELAM_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_OROG_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_RCORI_T0(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_IRAD_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_LRAD_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_Q_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_RCONV_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SCONV_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:,:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZXUROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZXURO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZXTROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZXTRO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZXQRO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZXHROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZXDROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWWILT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWSMX, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWSEQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWPMX, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWLMX, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZWFC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVGST, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUSLE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUNEBH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUGST, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTSN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTRSODIR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTRSODIF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTRSOD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTRAJGWD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTKE1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTHETAVS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTHETAV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENQVA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTENHA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSUDU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTAB, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSSNOW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSRAIN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSGROUPEL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSFSWDIR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSFSWDIF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSEDIQL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSEDIQI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSC_FEVN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSC_FEVI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSC_FCLN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSC_FCLL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_UNEBH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_UDOM, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_UDGRO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_UDAL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_QSH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_PBLH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_HV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_GZ0HF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_GZ0F, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_FHPS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_ENTCH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_DDOM, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSAV_DDAL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRTI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_SOLO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_MU0N, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_MU0M, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_MU0LU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_MU0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_LCVQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_CVGT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRDG_CVGQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQO3, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQLI_CVPP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQLI_CVP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQLIS0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQLIS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQLC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQICE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQIC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQGM, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQC_DET_PCMT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQCO2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPRS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPRODTH_CVPP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPRODTH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPRC_DPRECIPS2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%NDTPREC2&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPRC_DPRECIPS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%NDTPREC,&
& YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPOID, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FTKEI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FTKE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FPLSH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FPLCH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FEFB3, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FEFB2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPFL_FEFB1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPCLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEIJV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEIJG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEB_CVPP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEBS0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEBS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEBDIFF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEBCH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNEBC0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNBVNO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMSC_TW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMSC_QW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMSC_LSCPE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMSC_LH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMSC_FRMQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMRIPP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZMF_UP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLVT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKUROV2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKUROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKTROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKQROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKQLROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKCLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZHU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZHTR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZHQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGWDCS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGEOSLC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFPLSN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFPLSL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFPCOR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLX_LOTT_GWV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLX_LOTT_GWU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_VEG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_QSATS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_QSAT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_NEIJ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_FEVI, UBOUNDS=[YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG&
&+1, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_EMIS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_CHN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_CH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_CDN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFLU_CD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZFCHQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZEDMFV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZEDMFU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZEDMFS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZEDMFQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZECTCLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDSA_RS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDSA_LHS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDSA_CPS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDSA_C2, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDSA_C1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDQSTS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDPHIV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDPHIT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDPHI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFWS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFWQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFEXT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDMODEL%YRML_GCONF%YGFL&
&%NGFL_EXT, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 0, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFCVPPV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFCVPPU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFCVPPS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDIFCVPPQ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDECRD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDE2MR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDCAPE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCTRSO, UBOUNDS=[YDCPG_OPTS%KLON, 1, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCRTI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCONDCVPPL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCONDCVPPI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCOEFN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCOEFA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCLCT_RAD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCHROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFBTH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFAU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCFATH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCEROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCEMTR, UBOUNDS=[YDCPG_OPTS%KLON, 1, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCDROV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZC3, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZBLH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZBAY_QSCONV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZBAY_QRCONV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZALPHA1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZALBP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZALBDIR, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZALBD, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KSW, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZAIPCMT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZAERINDS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZAER, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, 6, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_INLAB_CVPP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_IMOC_CLPH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)




LLREDPR=.FALSE.
ZRVMD=YDMODEL%YRCST%RV-YDMODEL%YRCST%RD

IF (YDCPG_OPTS%LCONFX) THEN
  ZDTMSE=0.01_JPRB
  ZSTATI=YDMODEL%YRML_GCONF%YRRIP%RSTATI+(ZDTMSE-YDMODEL%YRML_GCONF%YRRIP%TSTEP)*0.5_JPRB
ELSE
  ZDTMSE=YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY
  ZSTATI=YDMODEL%YRML_GCONF%YRRIP%RSTATI
ENDIF

ZRHGMT=REAL (YDMODEL%YRML_GCONF%YRRIP%RHGMT, JPRB)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:CPPHINP')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
  ZRDG_CVGT => GET_HOST_DATA_RDWR (YL_ZRDG_CVGT)
  ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
  ZRDG_MU0LU => GET_HOST_DATA_RDWR (YL_ZRDG_MU0LU)
  ZRDG_MU0M => GET_HOST_DATA_RDWR (YL_ZRDG_MU0M)
  ZRDG_MU0N => GET_HOST_DATA_RDWR (YL_ZRDG_MU0N)
  ZRDG_SOLO => GET_HOST_DATA_RDWR (YL_ZRDG_SOLO)
  Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_PHY0%XYB%F_RDELP)
  Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDONLY (YDVARS%CVGQ%FDL)
  Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDONLY (YDVARS%CVGQ%FDM)
  Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDONLY (YDVARS%CVGQ%FT0)
  Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_Q_DL => GET_HOST_DATA_RDONLY (YDVARS%Q%FDL)
  Z_YDVARS_Q_DM => GET_HOST_DATA_RDONLY (YDVARS%Q%FDM)
  Z_YDVARS_Q_T0 => GET_HOST_DATA_RDONLY (YDVARS%Q%FT0)
  Z_YDVARS_T_DL => GET_HOST_DATA_RDONLY (YDVARS%T%FDL)
  Z_YDVARS_T_DM => GET_HOST_DATA_RDONLY (YDVARS%T%FDM)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL CPPHINP (YDGEOMETRY, YDMODEL, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
    &%KFDIA, Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_U_T0(&
    &:,:, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK), Z_YDVARS_Q_T0&
    &(:,:, JBLK), Z_YDVARS_Q_DL(:,:, JBLK), Z_YDVARS_Q_DM(:,:, JBLK), Z_YDVARS_CVGQ_DL(:,:, JBLK), Z_YDVARS_CVGQ_DM&
    &(:,:, JBLK), Z_YDCPG_PHY0_XYB_RDELP(:,:, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), Z_YDVARS_CVGQ_T0&
    &(:,:, JBLK), ZRDG_MU0(:, JBLK), ZRDG_SOLO(:, JBLK), ZRDG_MU0LU(:, JBLK), ZRDG_MU0M(:, JBLK), ZRDG_MU0N&
    &(:, JBLK), ZRDG_CVGQ(:,:, JBLK), ZRDG_CVGT(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:CPPHINP')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
    ZRDG_CVGT => GET_HOST_DATA_RDWR (YL_ZRDG_CVGT)
    ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
    ZRDG_MU0LU => GET_HOST_DATA_RDWR (YL_ZRDG_MU0LU)
    ZRDG_MU0M => GET_HOST_DATA_RDWR (YL_ZRDG_MU0M)
    ZRDG_MU0N => GET_HOST_DATA_RDWR (YL_ZRDG_MU0N)
    ZRDG_SOLO => GET_HOST_DATA_RDWR (YL_ZRDG_SOLO)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
    Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FDL)
    Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FDM)
    Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT0)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR (YDVARS%Q%FDL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR (YDVARS%Q%FDM)
    Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR (YDVARS%Q%FT0)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZRDG_CVGQ => NULL ()
  ZRDG_CVGT => NULL ()
  ZRDG_MU0 => NULL ()
  ZRDG_MU0LU => NULL ()
  ZRDG_MU0M => NULL ()
  ZRDG_MU0N => NULL ()
  ZRDG_SOLO => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_PHY0_XYB_RDELP => NULL ()
  Z_YDVARS_CVGQ_DL => NULL ()
  Z_YDVARS_CVGQ_DM => NULL ()
  Z_YDVARS_CVGQ_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  Z_YDVARS_Q_DL => NULL ()
  Z_YDVARS_Q_DM => NULL ()
  Z_YDVARS_Q_T0 => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:CPPHINP')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
  ZRDG_CVGT => GET_HOST_DATA_RDWR (YL_ZRDG_CVGT)
  ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
  ZRDG_MU0LU => GET_HOST_DATA_RDWR (YL_ZRDG_MU0LU)
  ZRDG_MU0M => GET_HOST_DATA_RDWR (YL_ZRDG_MU0M)
  ZRDG_MU0N => GET_HOST_DATA_RDWR (YL_ZRDG_MU0N)
  ZRDG_SOLO => GET_HOST_DATA_RDWR (YL_ZRDG_SOLO)
  Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDONLY (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDONLY (YDCPG_PHY0%XYB%F_RDELP)
  Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDONLY (YDVARS%CVGQ%FDL)
  Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDONLY (YDVARS%CVGQ%FDM)
  Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDONLY (YDVARS%CVGQ%FT0)
  Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_Q_DL => GET_HOST_DATA_RDONLY (YDVARS%Q%FDL)
  Z_YDVARS_Q_DM => GET_HOST_DATA_RDONLY (YDVARS%Q%FDM)
  Z_YDVARS_Q_T0 => GET_HOST_DATA_RDONLY (YDVARS%Q%FT0)
  Z_YDVARS_T_DL => GET_HOST_DATA_RDONLY (YDVARS%T%FDL)
  Z_YDVARS_T_DM => GET_HOST_DATA_RDONLY (YDVARS%T%FDM)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL CPPHINP_OPENACC (YDGEOMETRY, YDMODEL, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_U_T0(:,:&
      &, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK), Z_YDVARS_Q_T0&
      &(:,:, JBLK), Z_YDVARS_Q_DL(:,:, JBLK), Z_YDVARS_Q_DM(:,:, JBLK), Z_YDVARS_CVGQ_DL(:,:, JBLK), Z_YDVARS_CVGQ_DM&
      &(:,:, JBLK), Z_YDCPG_PHY0_XYB_RDELP(:,:, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), Z_YDVARS_CVGQ_T0&
      &(:,:, JBLK), ZRDG_MU0(:, JBLK), ZRDG_SOLO(:, JBLK), ZRDG_MU0LU(:, JBLK), ZRDG_MU0M(:, JBLK), ZRDG_MU0N&
      &(:, JBLK), ZRDG_CVGQ(:,:, JBLK), ZRDG_CVGT(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:CPPHINP')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
    ZRDG_CVGT => GET_HOST_DATA_RDWR (YL_ZRDG_CVGT)
    ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
    ZRDG_MU0LU => GET_HOST_DATA_RDWR (YL_ZRDG_MU0LU)
    ZRDG_MU0M => GET_HOST_DATA_RDWR (YL_ZRDG_MU0M)
    ZRDG_MU0N => GET_HOST_DATA_RDWR (YL_ZRDG_MU0N)
    ZRDG_SOLO => GET_HOST_DATA_RDWR (YL_ZRDG_SOLO)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
    Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FDL)
    Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FDM)
    Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT0)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR (YDVARS%Q%FDL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR (YDVARS%Q%FDM)
    Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR (YDVARS%Q%FT0)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZRDG_CVGQ => NULL ()
  ZRDG_CVGT => NULL ()
  ZRDG_MU0 => NULL ()
  ZRDG_MU0LU => NULL ()
  ZRDG_MU0M => NULL ()
  ZRDG_MU0N => NULL ()
  ZRDG_SOLO => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_PHY0_XYB_RDELP => NULL ()
  Z_YDVARS_CVGQ_DL => NULL ()
  Z_YDVARS_CVGQ_DM => NULL ()
  Z_YDVARS_CVGQ_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  Z_YDVARS_Q_DL => NULL ()
  Z_YDVARS_Q_DM => NULL ()
  Z_YDVARS_Q_T0 => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:CPPHINP')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZRDG_CVGQ => GET_DEVICE_DATA_RDWR (YL_ZRDG_CVGQ)
  ZRDG_CVGT => GET_DEVICE_DATA_RDWR (YL_ZRDG_CVGT)
  ZRDG_MU0 => GET_DEVICE_DATA_RDWR (YL_ZRDG_MU0)
  ZRDG_MU0LU => GET_DEVICE_DATA_RDWR (YL_ZRDG_MU0LU)
  ZRDG_MU0M => GET_DEVICE_DATA_RDWR (YL_ZRDG_MU0M)
  ZRDG_MU0N => GET_DEVICE_DATA_RDWR (YL_ZRDG_MU0N)
  ZRDG_SOLO => GET_DEVICE_DATA_RDWR (YL_ZRDG_SOLO)
  Z_YDCPG_DYN0_CTY_EVEL => GET_DEVICE_DATA_RDONLY (YDCPG_DYN0%CTY%F_EVEL)
  Z_YDCPG_PHY0_XYB_RDELP => GET_DEVICE_DATA_RDONLY (YDCPG_PHY0%XYB%F_RDELP)
  Z_YDVARS_CVGQ_DL => GET_DEVICE_DATA_RDONLY (YDVARS%CVGQ%FDL)
  Z_YDVARS_CVGQ_DM => GET_DEVICE_DATA_RDONLY (YDVARS%CVGQ%FDM)
  Z_YDVARS_CVGQ_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%CVGQ%FT0)
  Z_YDVARS_GEOMETRY_GELAM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_Q_DL => GET_DEVICE_DATA_RDONLY (YDVARS%Q%FDL)
  Z_YDVARS_Q_DM => GET_DEVICE_DATA_RDONLY (YDVARS%Q%FDM)
  Z_YDVARS_Q_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%Q%FT0)
  Z_YDVARS_T_DL => GET_DEVICE_DATA_RDONLY (YDVARS%T%FDL)
  Z_YDVARS_T_DM => GET_DEVICE_DATA_RDONLY (YDVARS%T%FDM)
  Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%U%FT0)
  Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%V%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZRDG_CVGQ, &
    !$ACC&         ZRDG_CVGT, ZRDG_MU0, ZRDG_MU0LU, ZRDG_MU0M, ZRDG_MU0N, ZRDG_SOLO, &
    !$ACC&         Z_YDCPG_DYN0_CTY_EVEL, Z_YDCPG_PHY0_XYB_RDELP, Z_YDVARS_CVGQ_DL, &
    !$ACC&         Z_YDVARS_CVGQ_DM, Z_YDVARS_CVGQ_T0, Z_YDVARS_GEOMETRY_GELAM_T0, &
    !$ACC&         Z_YDVARS_GEOMETRY_GEMU_T0, Z_YDVARS_Q_DL, Z_YDVARS_Q_DM, &
    !$ACC&         Z_YDVARS_Q_T0, Z_YDVARS_T_DL, Z_YDVARS_T_DM, Z_YDVARS_U_T0, &
    !$ACC&         Z_YDVARS_V_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL CPPHINP_OPENACC (YDGEOMETRY, YDMODEL, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_U_T0(:,:&
      &, JBLK), Z_YDVARS_V_T0(:,:, JBLK), Z_YDVARS_T_DL(:,:, JBLK), Z_YDVARS_T_DM(:,:, JBLK), Z_YDVARS_Q_T0&
      &(:,:, JBLK), Z_YDVARS_Q_DL(:,:, JBLK), Z_YDVARS_Q_DM(:,:, JBLK), Z_YDVARS_CVGQ_DL(:,:, JBLK), Z_YDVARS_CVGQ_DM&
      &(:,:, JBLK), Z_YDCPG_PHY0_XYB_RDELP(:,:, JBLK), Z_YDCPG_DYN0_CTY_EVEL(:,:, JBLK), Z_YDVARS_CVGQ_T0&
      &(:,:, JBLK), ZRDG_MU0(:, JBLK), ZRDG_SOLO(:, JBLK), ZRDG_MU0LU(:, JBLK), ZRDG_MU0M(:, JBLK), ZRDG_MU0N&
      &(:, JBLK), ZRDG_CVGQ(:,:, JBLK), ZRDG_CVGT(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:CPPHINP')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
    ZRDG_CVGT => GET_HOST_DATA_RDWR (YL_ZRDG_CVGT)
    ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
    ZRDG_MU0LU => GET_HOST_DATA_RDWR (YL_ZRDG_MU0LU)
    ZRDG_MU0M => GET_HOST_DATA_RDWR (YL_ZRDG_MU0M)
    ZRDG_MU0N => GET_HOST_DATA_RDWR (YL_ZRDG_MU0N)
    ZRDG_SOLO => GET_HOST_DATA_RDWR (YL_ZRDG_SOLO)
    Z_YDCPG_DYN0_CTY_EVEL => GET_HOST_DATA_RDWR (YDCPG_DYN0%CTY%F_EVEL)
    Z_YDCPG_PHY0_XYB_RDELP => GET_HOST_DATA_RDWR (YDCPG_PHY0%XYB%F_RDELP)
    Z_YDVARS_CVGQ_DL => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FDL)
    Z_YDVARS_CVGQ_DM => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FDM)
    Z_YDVARS_CVGQ_T0 => GET_HOST_DATA_RDWR (YDVARS%CVGQ%FT0)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_Q_DL => GET_HOST_DATA_RDWR (YDVARS%Q%FDL)
    Z_YDVARS_Q_DM => GET_HOST_DATA_RDWR (YDVARS%Q%FDM)
    Z_YDVARS_Q_T0 => GET_HOST_DATA_RDWR (YDVARS%Q%FT0)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZRDG_CVGQ => NULL ()
  ZRDG_CVGT => NULL ()
  ZRDG_MU0 => NULL ()
  ZRDG_MU0LU => NULL ()
  ZRDG_MU0M => NULL ()
  ZRDG_MU0N => NULL ()
  ZRDG_SOLO => NULL ()
  Z_YDCPG_DYN0_CTY_EVEL => NULL ()
  Z_YDCPG_PHY0_XYB_RDELP => NULL ()
  Z_YDVARS_CVGQ_DL => NULL ()
  Z_YDVARS_CVGQ_DM => NULL ()
  Z_YDVARS_CVGQ_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  Z_YDVARS_Q_DL => NULL ()
  Z_YDVARS_Q_DM => NULL ()
  Z_YDVARS_Q_T0 => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CPPHINP',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ZRDG_LCVQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
  ZQCO2 => GET_HOST_DATA_RDWR (YL_ZQCO2)
  ZRDG_CVGQ => GET_HOST_DATA_RDONLY (YL_ZRDG_CVGQ)
  ZRDG_LCVQ => GET_HOST_DATA_RDWR (YL_ZRDG_LCVQ)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZRDG_LCVQ (JLON, JLEV, JBLK)=ZRDG_CVGQ (JLON, JLEV, JBLK)
      ENDDO

    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZFLU_QSATS (JLON, JBLK)=0.0_JPRB
    ENDDO


    DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZQCO2 (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY3%QCO2
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZQCO2 => GET_HOST_DATA_RDWR (YL_ZQCO2)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
    ZRDG_LCVQ => GET_HOST_DATA_RDWR (YL_ZRDG_LCVQ)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSATS => NULL ()
  ZQCO2 => NULL ()
  ZRDG_CVGQ => NULL ()
  ZRDG_LCVQ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZRDG_LCVQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
  ZQCO2 => GET_HOST_DATA_RDWR (YL_ZQCO2)
  ZRDG_CVGQ => GET_HOST_DATA_RDONLY (YL_ZRDG_CVGQ)
  ZRDG_LCVQ => GET_HOST_DATA_RDWR (YL_ZRDG_LCVQ)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZRDG_LCVQ (JLON, JLEV, JBLK)=ZRDG_CVGQ (JLON, JLEV, JBLK)
      
      ENDDO

      
      ZFLU_QSATS (JLON, JBLK)=0.0_JPRB

      

      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        ZQCO2 (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY3%QCO2
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZQCO2 => GET_HOST_DATA_RDWR (YL_ZQCO2)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
    ZRDG_LCVQ => GET_HOST_DATA_RDWR (YL_ZRDG_LCVQ)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSATS => NULL ()
  ZQCO2 => NULL ()
  ZRDG_CVGQ => NULL ()
  ZRDG_LCVQ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZRDG_LCVQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSATS => GET_DEVICE_DATA_RDWR (YL_ZFLU_QSATS)
  ZQCO2 => GET_DEVICE_DATA_RDWR (YL_ZQCO2)
  ZRDG_CVGQ => GET_DEVICE_DATA_RDONLY (YL_ZRDG_CVGQ)
  ZRDG_LCVQ => GET_DEVICE_DATA_RDWR (YL_ZRDG_LCVQ)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZFLU_QSATS, ZQCO2, ZRDG_CVGQ, &
    !$ACC&         ZRDG_LCVQ) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZRDG_LCVQ (JLON, JLEV, JBLK)=ZRDG_CVGQ (JLON, JLEV, JBLK)
      
      ENDDO

      
      ZFLU_QSATS (JLON, JBLK)=0.0_JPRB

      

      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        ZQCO2 (JLON, JLEV, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY3%QCO2
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZQCO2 => GET_HOST_DATA_RDWR (YL_ZQCO2)
    ZRDG_CVGQ => GET_HOST_DATA_RDWR (YL_ZRDG_CVGQ)
    ZRDG_LCVQ => GET_HOST_DATA_RDWR (YL_ZRDG_LCVQ)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSATS => NULL ()
  ZQCO2 => NULL ()
  ZRDG_CVGQ => NULL ()
  ZRDG_LCVQ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZRDG_LCVQ',1,ZHOOK_HANDLE_PARALLEL)
CALL MF_PHYS_FPL_PART1_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YL_ZPFL_FPLCH&
&, YL_ZPFL_FPLSH, YDVARS%CPF%FT0, YDVARS%SPF%FT0, YDMODEL)

IF (YDCPG_OPTS%LCONFX) THEN
  CALL MF_PHYS_SAVE_PHSURF_PART1_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YL_ZSAV_DDAL, YL_ZSAV_DDOM, YL_ZSAV_ENTCH&
  &, YL_ZSAV_FHPS, YL_ZSAV_GZ0F, YL_ZSAV_GZ0HF, YL_ZSAV_HV, YL_ZSAV_PBLH, YL_ZSAV_QSH, YL_ZSAV_UDAL&
  &, YL_ZSAV_UDGRO, YL_ZSAV_UDOM, YL_ZSAV_UNEBH, YDMF_PHYS_SURF%GSD_VF%F_Z0F, YDMF_PHYS_SURF%GSD_VH&
  &%F_PBLH, YDMF_PHYS_SURF%GSD_VH%F_QSH, YDMF_PHYS_SURF%GSD_VH%F_SPSH, YDMF_PHYS_SURF%GSD_VK%F_UDGRO&
  &, YDMF_PHYS_SURF%GSD_VV%F_HV, YDMF_PHYS_SURF%GSD_VV%F_Z0H, YDVARS%DAL%FT0, YDVARS%DOM%FT0, YDVARS&
  &%UAL%FT0, YDVARS%UEN%FT0, YDVARS%UNEBH%FT0, YDVARS%UOM%FT0, YDMODEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:APLPAR_INIT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
  ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
  ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
  ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
  ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
  ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
  ZFCHQ => GET_HOST_DATA_RDWR (YL_ZFCHQ)
  ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
  ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
  ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
  ZFLU_CHN => GET_HOST_DATA_RDWR (YL_ZFLU_CHN)
  ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
  ZFLU_FEVI => GET_HOST_DATA_RDWR (YL_ZFLU_FEVI)
  ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
  ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
  ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
  ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
  ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
  ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
  ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
  ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
  ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
  ZPFL_FEFB1 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB1)
  ZPFL_FEFB2 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB2)
  ZPFL_FEFB3 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB3)
  ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
  ZPFL_FTKEI => GET_HOST_DATA_RDWR (YL_ZPFL_FTKEI)
  Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL APLPAR_INIT (YDCPG_OPTS%LAROME, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS&
    &%KFLEVG, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, Z_YDMF_PHYS_SURF_GSD_VF_PVEG&
    &(:, JBLK), ZMSC_FRMQ(:,:, JBLK), ZFCHQ(:,:, JBLK), ZDSA_CPS(:, JBLK), ZDSA_LHS(:, JBLK), ZDSA_RS&
    &(:, JBLK), ZMSC_LH(:,:, JBLK), ZMSC_LSCPE(:,:, JBLK), ZFLU_QSAT(:,:, JBLK), ZMSC_QW(:,:, JBLK), ZMSC_TW&
    &(:,:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), ZFLU_CH(:, JBLK), ZFLU_CHN(:, JBLK), ZDSA_C1(:&
    &, JBLK), ZDSA_C2(:, JBLK), ZFLU_EMIS(:, JBLK), ZFLU_FEVI(:,:, JBLK), ZPFL_FTKE(:,:, JBLK), ZPFL_FTKEI&
    &(:,:, JBLK), ZPFL_FEFB1(:,:, JBLK), ZPFL_FEFB2(:,:, JBLK), ZPFL_FEFB3(:,:, JBLK), ZFLU_NEIJ(:, JBLK&
    &), ZFLU_VEG(:, JBLK), ZFLU_QSATS(:, JBLK), IMOC_CLPH(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:APLPAR_INIT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
    ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
    ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
    ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
    ZFCHQ => GET_HOST_DATA_RDWR (YL_ZFCHQ)
    ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
    ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
    ZFLU_CHN => GET_HOST_DATA_RDWR (YL_ZFLU_CHN)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZFLU_FEVI => GET_HOST_DATA_RDWR (YL_ZFLU_FEVI)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
    ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
    ZPFL_FEFB1 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB1)
    ZPFL_FEFB2 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB2)
    ZPFL_FEFB3 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB3)
    ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
    ZPFL_FTKEI => GET_HOST_DATA_RDWR (YL_ZPFL_FTKEI)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => NULL ()
  ZDSA_C1 => NULL ()
  ZDSA_C2 => NULL ()
  ZDSA_CPS => NULL ()
  ZDSA_LHS => NULL ()
  ZDSA_RS => NULL ()
  ZFCHQ => NULL ()
  ZFLU_CD => NULL ()
  ZFLU_CDN => NULL ()
  ZFLU_CH => NULL ()
  ZFLU_CHN => NULL ()
  ZFLU_EMIS => NULL ()
  ZFLU_FEVI => NULL ()
  ZFLU_NEIJ => NULL ()
  ZFLU_QSAT => NULL ()
  ZFLU_QSATS => NULL ()
  ZFLU_VEG => NULL ()
  ZMSC_FRMQ => NULL ()
  ZMSC_LH => NULL ()
  ZMSC_LSCPE => NULL ()
  ZMSC_QW => NULL ()
  ZMSC_TW => NULL ()
  ZPFL_FEFB1 => NULL ()
  ZPFL_FEFB2 => NULL ()
  ZPFL_FEFB3 => NULL ()
  ZPFL_FTKE => NULL ()
  ZPFL_FTKEI => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:APLPAR_INIT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
  ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
  ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
  ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
  ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
  ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
  ZFCHQ => GET_HOST_DATA_RDWR (YL_ZFCHQ)
  ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
  ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
  ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
  ZFLU_CHN => GET_HOST_DATA_RDWR (YL_ZFLU_CHN)
  ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
  ZFLU_FEVI => GET_HOST_DATA_RDWR (YL_ZFLU_FEVI)
  ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
  ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
  ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
  ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
  ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
  ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
  ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
  ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
  ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
  ZPFL_FEFB1 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB1)
  ZPFL_FEFB2 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB2)
  ZPFL_FEFB3 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB3)
  ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
  ZPFL_FTKEI => GET_HOST_DATA_RDWR (YL_ZPFL_FTKEI)
  Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL APLPAR_INIT_OPENACC (YDCPG_OPTS%LAROME, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS&
      &%KFLEVG, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, Z_YDMF_PHYS_SURF_GSD_VF_PVEG&
      &(:, JBLK), ZMSC_FRMQ(:,:, JBLK), ZFCHQ(:,:, JBLK), ZDSA_CPS(:, JBLK), ZDSA_LHS(:, JBLK), ZDSA_RS(:,&
      & JBLK), ZMSC_LH(:,:, JBLK), ZMSC_LSCPE(:,:, JBLK), ZFLU_QSAT(:,:, JBLK), ZMSC_QW(:,:, JBLK), ZMSC_TW&
      &(:,:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), ZFLU_CH(:, JBLK), ZFLU_CHN(:, JBLK), ZDSA_C1(:, JBLK&
      &), ZDSA_C2(:, JBLK), ZFLU_EMIS(:, JBLK), ZFLU_FEVI(:,:, JBLK), ZPFL_FTKE(:,:, JBLK), ZPFL_FTKEI(:,:&
      &, JBLK), ZPFL_FEFB1(:,:, JBLK), ZPFL_FEFB2(:,:, JBLK), ZPFL_FEFB3(:,:, JBLK), ZFLU_NEIJ(:, JBLK), ZFLU_VEG&
      &(:, JBLK), ZFLU_QSATS(:, JBLK), IMOC_CLPH(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:APLPAR_INIT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
    ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
    ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
    ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
    ZFCHQ => GET_HOST_DATA_RDWR (YL_ZFCHQ)
    ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
    ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
    ZFLU_CHN => GET_HOST_DATA_RDWR (YL_ZFLU_CHN)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZFLU_FEVI => GET_HOST_DATA_RDWR (YL_ZFLU_FEVI)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
    ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
    ZPFL_FEFB1 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB1)
    ZPFL_FEFB2 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB2)
    ZPFL_FEFB3 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB3)
    ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
    ZPFL_FTKEI => GET_HOST_DATA_RDWR (YL_ZPFL_FTKEI)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => NULL ()
  ZDSA_C1 => NULL ()
  ZDSA_C2 => NULL ()
  ZDSA_CPS => NULL ()
  ZDSA_LHS => NULL ()
  ZDSA_RS => NULL ()
  ZFCHQ => NULL ()
  ZFLU_CD => NULL ()
  ZFLU_CDN => NULL ()
  ZFLU_CH => NULL ()
  ZFLU_CHN => NULL ()
  ZFLU_EMIS => NULL ()
  ZFLU_FEVI => NULL ()
  ZFLU_NEIJ => NULL ()
  ZFLU_QSAT => NULL ()
  ZFLU_QSATS => NULL ()
  ZFLU_VEG => NULL ()
  ZMSC_FRMQ => NULL ()
  ZMSC_LH => NULL ()
  ZMSC_LSCPE => NULL ()
  ZMSC_QW => NULL ()
  ZMSC_TW => NULL ()
  ZPFL_FEFB1 => NULL ()
  ZPFL_FEFB2 => NULL ()
  ZPFL_FEFB3 => NULL ()
  ZPFL_FTKE => NULL ()
  ZPFL_FTKEI => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:APLPAR_INIT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => GET_DEVICE_DATA_RDWR (YL_IMOC_CLPH)
  ZDSA_C1 => GET_DEVICE_DATA_RDWR (YL_ZDSA_C1)
  ZDSA_C2 => GET_DEVICE_DATA_RDWR (YL_ZDSA_C2)
  ZDSA_CPS => GET_DEVICE_DATA_RDWR (YL_ZDSA_CPS)
  ZDSA_LHS => GET_DEVICE_DATA_RDWR (YL_ZDSA_LHS)
  ZDSA_RS => GET_DEVICE_DATA_RDWR (YL_ZDSA_RS)
  ZFCHQ => GET_DEVICE_DATA_RDWR (YL_ZFCHQ)
  ZFLU_CD => GET_DEVICE_DATA_RDWR (YL_ZFLU_CD)
  ZFLU_CDN => GET_DEVICE_DATA_RDWR (YL_ZFLU_CDN)
  ZFLU_CH => GET_DEVICE_DATA_RDWR (YL_ZFLU_CH)
  ZFLU_CHN => GET_DEVICE_DATA_RDWR (YL_ZFLU_CHN)
  ZFLU_EMIS => GET_DEVICE_DATA_RDWR (YL_ZFLU_EMIS)
  ZFLU_FEVI => GET_DEVICE_DATA_RDWR (YL_ZFLU_FEVI)
  ZFLU_NEIJ => GET_DEVICE_DATA_RDWR (YL_ZFLU_NEIJ)
  ZFLU_QSAT => GET_DEVICE_DATA_RDWR (YL_ZFLU_QSAT)
  ZFLU_QSATS => GET_DEVICE_DATA_RDWR (YL_ZFLU_QSATS)
  ZFLU_VEG => GET_DEVICE_DATA_RDWR (YL_ZFLU_VEG)
  ZMSC_FRMQ => GET_DEVICE_DATA_RDWR (YL_ZMSC_FRMQ)
  ZMSC_LH => GET_DEVICE_DATA_RDWR (YL_ZMSC_LH)
  ZMSC_LSCPE => GET_DEVICE_DATA_RDWR (YL_ZMSC_LSCPE)
  ZMSC_QW => GET_DEVICE_DATA_RDWR (YL_ZMSC_QW)
  ZMSC_TW => GET_DEVICE_DATA_RDWR (YL_ZMSC_TW)
  ZPFL_FEFB1 => GET_DEVICE_DATA_RDWR (YL_ZPFL_FEFB1)
  ZPFL_FEFB2 => GET_DEVICE_DATA_RDWR (YL_ZPFL_FEFB2)
  ZPFL_FEFB3 => GET_DEVICE_DATA_RDWR (YL_ZPFL_FEFB3)
  ZPFL_FTKE => GET_DEVICE_DATA_RDWR (YL_ZPFL_FTKE)
  ZPFL_FTKEI => GET_DEVICE_DATA_RDWR (YL_ZPFL_FTKEI)
  Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (IMOC_CLPH, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZDSA_C1, &
    !$ACC&         ZDSA_C2, ZDSA_CPS, ZDSA_LHS, ZDSA_RS, ZFCHQ, ZFLU_CD, ZFLU_CDN, ZFLU_CH, &
    !$ACC&         ZFLU_CHN, ZFLU_EMIS, ZFLU_FEVI, ZFLU_NEIJ, ZFLU_QSAT, ZFLU_QSATS, &
    !$ACC&         ZFLU_VEG, ZMSC_FRMQ, ZMSC_LH, ZMSC_LSCPE, ZMSC_QW, ZMSC_TW, ZPFL_FEFB1, &
    !$ACC&         ZPFL_FEFB2, ZPFL_FEFB3, ZPFL_FTKE, ZPFL_FTKEI, Z_YDMF_PHYS_SURF_GSD_VF_PVEG) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL APLPAR_INIT_OPENACC (YDCPG_OPTS%LAROME, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS&
      &%KFLEVG, YDMODEL%YRML_PHY_G%YRDPHY%NTSSG, YDCPG_OPTS%YRSURF_DIMS%YSP_SBD%NLEVS, Z_YDMF_PHYS_SURF_GSD_VF_PVEG&
      &(:, JBLK), ZMSC_FRMQ(:,:, JBLK), ZFCHQ(:,:, JBLK), ZDSA_CPS(:, JBLK), ZDSA_LHS(:, JBLK), ZDSA_RS(:,&
      & JBLK), ZMSC_LH(:,:, JBLK), ZMSC_LSCPE(:,:, JBLK), ZFLU_QSAT(:,:, JBLK), ZMSC_QW(:,:, JBLK), ZMSC_TW&
      &(:,:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), ZFLU_CH(:, JBLK), ZFLU_CHN(:, JBLK), ZDSA_C1(:, JBLK&
      &), ZDSA_C2(:, JBLK), ZFLU_EMIS(:, JBLK), ZFLU_FEVI(:,:, JBLK), ZPFL_FTKE(:,:, JBLK), ZPFL_FTKEI(:,:&
      &, JBLK), ZPFL_FEFB1(:,:, JBLK), ZPFL_FEFB2(:,:, JBLK), ZPFL_FEFB3(:,:, JBLK), ZFLU_NEIJ(:, JBLK), ZFLU_VEG&
      &(:, JBLK), ZFLU_QSATS(:, JBLK), IMOC_CLPH(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:APLPAR_INIT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
    ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
    ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
    ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
    ZFCHQ => GET_HOST_DATA_RDWR (YL_ZFCHQ)
    ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
    ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
    ZFLU_CHN => GET_HOST_DATA_RDWR (YL_ZFLU_CHN)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZFLU_FEVI => GET_HOST_DATA_RDWR (YL_ZFLU_FEVI)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
    ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
    ZPFL_FEFB1 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB1)
    ZPFL_FEFB2 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB2)
    ZPFL_FEFB3 => GET_HOST_DATA_RDWR (YL_ZPFL_FEFB3)
    ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
    ZPFL_FTKEI => GET_HOST_DATA_RDWR (YL_ZPFL_FTKEI)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => NULL ()
  ZDSA_C1 => NULL ()
  ZDSA_C2 => NULL ()
  ZDSA_CPS => NULL ()
  ZDSA_LHS => NULL ()
  ZDSA_RS => NULL ()
  ZFCHQ => NULL ()
  ZFLU_CD => NULL ()
  ZFLU_CDN => NULL ()
  ZFLU_CH => NULL ()
  ZFLU_CHN => NULL ()
  ZFLU_EMIS => NULL ()
  ZFLU_FEVI => NULL ()
  ZFLU_NEIJ => NULL ()
  ZFLU_QSAT => NULL ()
  ZFLU_QSATS => NULL ()
  ZFLU_VEG => NULL ()
  ZMSC_FRMQ => NULL ()
  ZMSC_LH => NULL ()
  ZMSC_LSCPE => NULL ()
  ZMSC_QW => NULL ()
  ZMSC_TW => NULL ()
  ZPFL_FEFB1 => NULL ()
  ZPFL_FEFB2 => NULL ()
  ZPFL_FEFB3 => NULL ()
  ZPFL_FTKE => NULL ()
  ZPFL_FTKEI => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:APLPAR_INIT',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:PLSM')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)=REAL (NINT &
      &(Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)), JPRB)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PLSM')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:PLSM')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)=REAL (NINT &
      &(Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)), JPRB)
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PLSM')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:PLSM')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_SURF_GSD_VF_PLSM) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)=REAL (NINT &
      &(Z_YDMF_PHYS_SURF_GSD_VF_PLSM (JLON, JBLK)), JPRB)
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PLSM')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PLSM',1,ZHOOK_HANDLE_PARALLEL)

IF (YDMODEL%YRML_PHY_MF%YRPHY%LGCHECKMV) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OpenMP','APL_ARPEGE_PARALLEL:CHECKMV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => GET_HOST_DATA_RDONLY (YL_ZRDG_MU0)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GELAM%FT0)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL CHECKMV (YDCPG_OPTS%NINDAT, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF%YRPHY0&
      &, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG&
      &, YDCPG_OPTS%NSTEP, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDVARS_GEOMETRY_GELAM_T0(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), ZRDG_MU0(:&
      &, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:CHECKMV')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDVARS_GEOMETRY_GELAM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GELAM%FT0)
      Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZRDG_MU0 => NULL ()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDVARS_GEOMETRY_GELAM_T0 => NULL ()
    Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:CHECKMV',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

CALL APL_ARPEGE_INIT_PARALLEL (YDMODEL%YRCST, YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC&
&, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_IMOC_CLPH, YL_INLAB_CVPP, YL_ZAER, YL_ZAERINDS&
&, YL_ZAIPCMT, YL_ZALBD, YL_ZALBP, YL_ZALPHA1, YL_ZCEMTR, YL_ZCFATH, YL_ZCFAU, YL_ZCFBTH, YL_ZCFBU&
&, YL_ZCFBV, YL_ZCOEFA, YL_ZCONDCVPPI, YL_ZCONDCVPPL, YL_ZCTRSO, YL_ZDECRD, YL_ZDIFCVPPQ, YL_ZDIFCVPPS&
&, YL_ZDIFCVPPU, YL_ZDIFCVPPV, YL_ZDIFWQ, YL_ZDIFWS, YL_ZEDMFQ, YL_ZEDMFS, YL_ZEDMFU, YL_ZEDMFV,&
& ZEPS0, ZEPSNEB, YL_ZFPCOR, YL_ZKQLROV, YL_ZKQROV, YL_ZKTROV, YL_ZKUROV, YL_ZLVT, YL_ZMF_UP, YL_ZMRIPP&
&, YL_ZNEBC0, YL_ZNEBCH, YL_ZNEBDIFF, YL_ZNEBS, YL_ZNEBS0, YL_ZNEB_CVPP, YL_ZPFL_FPLCH, YL_ZPFL_FPLSH&
&, YL_ZPOID, YL_ZPRODTH_CVPP, YL_ZQC_DET_PCMT, YL_ZQI, YL_ZQIC, YL_ZQICE, YL_ZQL, YL_ZQLC, YL_ZQLIS&
&, YL_ZQLIS0, YL_ZQLI_CVP, YL_ZQLI_CVPP, YL_ZQO3, YL_ZQR, YL_ZQS, YL_ZQV, YL_ZSC_FCLL, YL_ZSC_FCLN&
&, YL_ZSC_FEVI, YL_ZSC_FEVN, YL_ZSEDIQI, YL_ZSEDIQL, YL_ZSFSWDIF, YL_ZSFSWDIR, YL_ZSUDU, YL_ZTENHA&
&, YL_ZTENQVA, YL_ZTENT, YL_ZTRSOD, YL_ZTRSODIF, YL_ZTRSODIR, YL_ZUNEBH, YL_ZXDROV, YL_ZXHROV, YL_ZXQRO&
&, YL_ZXTRO, YL_ZXTROV, YL_ZXURO, YL_ZXUROV)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACTQSAT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
  ZGEOSLC => GET_HOST_DATA_RDWR (YL_ZGEOSLC)
  ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
  ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
  ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
  ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR (YDCPG_MISC%F_RH)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL ACTQSAT (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
    &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTQSAT, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
    &(:,:, JBLK), ZGEOSLC(:,:, JBLK), ZMSC_LH(:,:, JBLK), ZMSC_LSCPE(:,:, JBLK), ZFLU_QSAT(:,:, JBLK&
    &), ZMSC_QW(:,:, JBLK), Z_YDCPG_MISC_RH(:,:, JBLK), ZMSC_TW(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACTQSAT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
    ZGEOSLC => GET_HOST_DATA_RDWR (YL_ZGEOSLC)
    ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR (YDCPG_MISC%F_RH)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSAT => NULL ()
  ZGEOSLC => NULL ()
  ZMSC_LH => NULL ()
  ZMSC_LSCPE => NULL ()
  ZMSC_QW => NULL ()
  ZMSC_TW => NULL ()
  ZQV => NULL ()
  Z_YDCPG_MISC_RH => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACTQSAT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
  ZGEOSLC => GET_HOST_DATA_RDWR (YL_ZGEOSLC)
  ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
  ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
  ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
  ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR (YDCPG_MISC%F_RH)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACTQSAT_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTQSAT, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), ZGEOSLC(:,:, JBLK), ZMSC_LH(:,:, JBLK), ZMSC_LSCPE(:,:, JBLK), ZFLU_QSAT(:,:, JBLK), ZMSC_QW&
      &(:,:, JBLK), Z_YDCPG_MISC_RH(:,:, JBLK), ZMSC_TW(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACTQSAT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
    ZGEOSLC => GET_HOST_DATA_RDWR (YL_ZGEOSLC)
    ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR (YDCPG_MISC%F_RH)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSAT => NULL ()
  ZGEOSLC => NULL ()
  ZMSC_LH => NULL ()
  ZMSC_LSCPE => NULL ()
  ZMSC_QW => NULL ()
  ZMSC_TW => NULL ()
  ZQV => NULL ()
  Z_YDCPG_MISC_RH => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACTQSAT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSAT => GET_DEVICE_DATA_RDWR (YL_ZFLU_QSAT)
  ZGEOSLC => GET_DEVICE_DATA_RDWR (YL_ZGEOSLC)
  ZMSC_LH => GET_DEVICE_DATA_RDWR (YL_ZMSC_LH)
  ZMSC_LSCPE => GET_DEVICE_DATA_RDWR (YL_ZMSC_LSCPE)
  ZMSC_QW => GET_DEVICE_DATA_RDWR (YL_ZMSC_QW)
  ZMSC_TW => GET_DEVICE_DATA_RDWR (YL_ZMSC_TW)
  ZQV => GET_DEVICE_DATA_RDONLY (YL_ZQV)
  Z_YDCPG_MISC_RH => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_RH)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZFLU_QSAT, ZGEOSLC, &
    !$ACC&         ZMSC_LH, ZMSC_LSCPE, ZMSC_QW, ZMSC_TW, ZQV, Z_YDCPG_MISC_RH, Z_YDMF_PHYS_BASE_STATE_T, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACTQSAT_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTQSAT, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), ZGEOSLC(:,:, JBLK), ZMSC_LH(:,:, JBLK), ZMSC_LSCPE(:,:, JBLK), ZFLU_QSAT(:,:, JBLK), ZMSC_QW&
      &(:,:, JBLK), Z_YDCPG_MISC_RH(:,:, JBLK), ZMSC_TW(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACTQSAT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSAT => GET_HOST_DATA_RDWR (YL_ZFLU_QSAT)
    ZGEOSLC => GET_HOST_DATA_RDWR (YL_ZGEOSLC)
    ZMSC_LH => GET_HOST_DATA_RDWR (YL_ZMSC_LH)
    ZMSC_LSCPE => GET_HOST_DATA_RDWR (YL_ZMSC_LSCPE)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZMSC_TW => GET_HOST_DATA_RDWR (YL_ZMSC_TW)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    Z_YDCPG_MISC_RH => GET_HOST_DATA_RDWR (YDCPG_MISC%F_RH)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_QSAT => NULL ()
  ZGEOSLC => NULL ()
  ZMSC_LH => NULL ()
  ZMSC_LSCPE => NULL ()
  ZMSC_QW => NULL ()
  ZMSC_TW => NULL ()
  ZQV => NULL ()
  Z_YDCPG_MISC_RH => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACTQSAT',1,ZHOOK_HANDLE_PARALLEL)

IF (.NOT.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACSOL')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZC3 => GET_HOST_DATA_RDWR (YL_ZC3)
    ZCG => GET_HOST_DATA_RDWR (YL_ZCG)
    ZCN => GET_HOST_DATA_RDWR (YL_ZCN)
    ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
    ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
    ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
    ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
    ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
    ZWPMX => GET_HOST_DATA_RDWR (YL_ZWPMX)
    ZWSEQ => GET_HOST_DATA_RDWR (YL_ZWSEQ)
    ZWSMX => GET_HOST_DATA_RDWR (YL_ZWSMX)
    ZWWILT => GET_HOST_DATA_RDWR (YL_ZWWILT)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
    Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_ARG)
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_D2)
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
    Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_LAI)
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_SAB)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, LLHMT) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LSOLV) THEN
        LLHMT=.FALSE.
        CALL ACSOL (YDCPG_OPTS%YRCLI, YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PD2&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PLAI&
        &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R (:, 1&
        &, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q (:, 1, JBLK)&
        &, Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC&
        &(:, JBLK), LLHMT, ZDSA_C1(:, JBLK), ZDSA_C2(:, JBLK), ZC3(:, JBLK), ZCG(:, JBLK), ZCN(:, JBLK),&
        & Z_YDMF_PHYS_OUT_CT(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK), ZWFC(:, JBLK), ZWPMX(:, JBLK), ZWSEQ&
        &(:, JBLK), ZWSMX(:, JBLK), ZWWILT(:, JBLK))
      ELSE

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDMF_PHYS_OUT_CT (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY1%HSOL/(1.0_JPRB+YDMODEL%YRML_PHY_MF%YRPHY1&
          &%HSOLIWR*(Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W (JLON, JBLK)+Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q (JLON, 1, JBLK&
          &))/(YDMODEL%YRML_PHY_MF%YRPHY1%WSMX+YDMODEL%YRML_PHY_MF%YRPHY1%WPMX)*EXP (-0.5_JPRB*(YDMODEL%YRML_PHY_MF&
          &%YRPHY1%HSOLIT0*(Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)-YDMODEL%YRCST%RTT))**2))
        ENDDO

      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACSOL')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZC3 => GET_HOST_DATA_RDWR (YL_ZC3)
      ZCG => GET_HOST_DATA_RDWR (YL_ZCG)
      ZCN => GET_HOST_DATA_RDWR (YL_ZCN)
      ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
      ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
      ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
      ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
      ZWPMX => GET_HOST_DATA_RDWR (YL_ZWPMX)
      ZWSEQ => GET_HOST_DATA_RDWR (YL_ZWSEQ)
      ZWSMX => GET_HOST_DATA_RDWR (YL_ZWSMX)
      ZWWILT => GET_HOST_DATA_RDWR (YL_ZWWILT)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_D2)
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_LAI)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZC3 => NULL ()
    ZCG => NULL ()
    ZCN => NULL ()
    ZDSA_C1 => NULL ()
    ZDSA_C2 => NULL ()
    ZNEIJG => NULL ()
    ZNEIJV => NULL ()
    ZWFC => NULL ()
    ZWPMX => NULL ()
    ZWSEQ => NULL ()
    ZWSMX => NULL ()
    ZWWILT => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => NULL ()
    Z_YDMF_PHYS_OUT_CT => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PLAI => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACSOL')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZC3 => GET_HOST_DATA_RDWR (YL_ZC3)
    ZCG => GET_HOST_DATA_RDWR (YL_ZCG)
    ZCN => GET_HOST_DATA_RDWR (YL_ZCN)
    ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
    ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
    ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
    ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
    ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
    ZWPMX => GET_HOST_DATA_RDWR (YL_ZWPMX)
    ZWSEQ => GET_HOST_DATA_RDWR (YL_ZWSEQ)
    ZWSMX => GET_HOST_DATA_RDWR (YL_ZWSMX)
    ZWWILT => GET_HOST_DATA_RDWR (YL_ZWWILT)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
    Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_ARG)
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_D2)
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
    Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_LAI)
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_SAB)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, LLHMT, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LSOLV) THEN
          LLHMT=.FALSE.
          CALL ACSOL_OPENACC (YDCPG_OPTS%YRCLI, YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF&
          &%YRPHY1, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, JBLK&
          &), Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H&
          &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG&
          &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R&
          & (:, 1, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F (:, 1, JBLK&
          &), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q&
          & (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:&
          &, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLHMT, ZDSA_C1(:, JBLK), ZDSA_C2(:, JBLK), ZC3&
          &(:, JBLK), ZCG(:, JBLK), ZCN(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK&
          &), ZWFC(:, JBLK), ZWPMX(:, JBLK), ZWSEQ(:, JBLK), ZWSMX(:, JBLK), ZWWILT(:, JBLK),YDSTACK=YLSTACK&
          &)
        ELSE
          
          Z_YDMF_PHYS_OUT_CT (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY1%HSOL/(1.0_JPRB+YDMODEL%YRML_PHY_MF%YRPHY1&
          &%HSOLIWR*(Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W (JLON, JBLK)+Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q (JLON, 1, JBLK&
          &))/(YDMODEL%YRML_PHY_MF%YRPHY1%WSMX+YDMODEL%YRML_PHY_MF%YRPHY1%WPMX)*EXP (-0.5_JPRB*(YDMODEL%YRML_PHY_MF&
          &%YRPHY1%HSOLIT0*(Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)-YDMODEL%YRCST%RTT))**2))
        
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACSOL')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZC3 => GET_HOST_DATA_RDWR (YL_ZC3)
      ZCG => GET_HOST_DATA_RDWR (YL_ZCG)
      ZCN => GET_HOST_DATA_RDWR (YL_ZCN)
      ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
      ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
      ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
      ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
      ZWPMX => GET_HOST_DATA_RDWR (YL_ZWPMX)
      ZWSEQ => GET_HOST_DATA_RDWR (YL_ZWSEQ)
      ZWSMX => GET_HOST_DATA_RDWR (YL_ZWSMX)
      ZWWILT => GET_HOST_DATA_RDWR (YL_ZWWILT)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_D2)
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_LAI)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZC3 => NULL ()
    ZCG => NULL ()
    ZCN => NULL ()
    ZDSA_C1 => NULL ()
    ZDSA_C2 => NULL ()
    ZNEIJG => NULL ()
    ZNEIJV => NULL ()
    ZWFC => NULL ()
    ZWPMX => NULL ()
    ZWSEQ => NULL ()
    ZWSMX => NULL ()
    ZWWILT => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => NULL ()
    Z_YDMF_PHYS_OUT_CT => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PLAI => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACSOL')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZC3 => GET_DEVICE_DATA_RDWR (YL_ZC3)
    ZCG => GET_DEVICE_DATA_RDWR (YL_ZCG)
    ZCN => GET_DEVICE_DATA_RDWR (YL_ZCN)
    ZDSA_C1 => GET_DEVICE_DATA_RDWR (YL_ZDSA_C1)
    ZDSA_C2 => GET_DEVICE_DATA_RDWR (YL_ZDSA_C2)
    ZNEIJG => GET_DEVICE_DATA_RDWR (YL_ZNEIJG)
    ZNEIJV => GET_DEVICE_DATA_RDWR (YL_ZNEIJV)
    ZWFC => GET_DEVICE_DATA_RDWR (YL_ZWFC)
    ZWPMX => GET_DEVICE_DATA_RDWR (YL_ZWPMX)
    ZWSEQ => GET_DEVICE_DATA_RDWR (YL_ZWSEQ)
    ZWSMX => GET_DEVICE_DATA_RDWR (YL_ZWSMX)
    ZWWILT => GET_DEVICE_DATA_RDWR (YL_ZWWILT)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_DEVICE_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
    Z_YDMF_PHYS_OUT_CT => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_ARG)
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_D2)
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
    Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_LAI)
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_SAB)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZC3, ZCG, ZCN, ZDSA_C1, &
      !$ACC&         ZDSA_C2, ZNEIJG, ZNEIJV, ZWFC, ZWPMX, ZWSEQ, ZWSMX, ZWWILT, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q, Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A, Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R, Z_YDMF_PHYS_OUT_CT, Z_YDMF_PHYS_SURF_GSD_VF_PLSM, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VF_PVEG, Z_YDMF_PHYS_SURF_GSD_VF_PZ0F, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF, Z_YDMF_PHYS_SURF_GSD_VV_PARG, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VV_PD2, Z_YDMF_PHYS_SURF_GSD_VV_PIVEG, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VV_PLAI, Z_YDMF_PHYS_SURF_GSD_VV_PSAB, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VV_PZ0H) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, LLHMT, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LSOLV) THEN
          LLHMT=.FALSE.
          CALL ACSOL_OPENACC (YDCPG_OPTS%YRCLI, YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF&
          &%YRPHY1, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, Z_YDMF_PHYS_SURF_GSD_VV_PARG(:, JBLK&
          &), Z_YDMF_PHYS_SURF_GSD_VV_PD2(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H&
          &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PIVEG&
          &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PLAI(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R&
          & (:, 1, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PSAB(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F (:, 1, JBLK&
          &), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q&
          & (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:&
          &, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLHMT, ZDSA_C1(:, JBLK), ZDSA_C2(:, JBLK), ZC3&
          &(:, JBLK), ZCG(:, JBLK), ZCN(:, JBLK), Z_YDMF_PHYS_OUT_CT(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK&
          &), ZWFC(:, JBLK), ZWPMX(:, JBLK), ZWSEQ(:, JBLK), ZWSMX(:, JBLK), ZWWILT(:, JBLK),YDSTACK=YLSTACK&
          &)
        ELSE
          
          Z_YDMF_PHYS_OUT_CT (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY1%HSOL/(1.0_JPRB+YDMODEL%YRML_PHY_MF%YRPHY1&
          &%HSOLIWR*(Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W (JLON, JBLK)+Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q (JLON, 1, JBLK&
          &))/(YDMODEL%YRML_PHY_MF%YRPHY1%WSMX+YDMODEL%YRML_PHY_MF%YRPHY1%WPMX)*EXP (-0.5_JPRB*(YDMODEL%YRML_PHY_MF&
          &%YRPHY1%HSOLIT0*(Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)-YDMODEL%YRCST%RTT))**2))
        
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACSOL')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZC3 => GET_HOST_DATA_RDWR (YL_ZC3)
      ZCG => GET_HOST_DATA_RDWR (YL_ZCG)
      ZCN => GET_HOST_DATA_RDWR (YL_ZCN)
      ZDSA_C1 => GET_HOST_DATA_RDWR (YL_ZDSA_C1)
      ZDSA_C2 => GET_HOST_DATA_RDWR (YL_ZDSA_C2)
      ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
      ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
      ZWPMX => GET_HOST_DATA_RDWR (YL_ZWPMX)
      ZWSEQ => GET_HOST_DATA_RDWR (YL_ZWSEQ)
      ZWSMX => GET_HOST_DATA_RDWR (YL_ZWSMX)
      ZWWILT => GET_HOST_DATA_RDWR (YL_ZWWILT)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_Q)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SB%F_TL)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_A)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_R)
      Z_YDMF_PHYS_OUT_CT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CT)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PARG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_ARG)
      Z_YDMF_PHYS_SURF_GSD_VV_PD2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_D2)
      Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_IVEG)
      Z_YDMF_PHYS_SURF_GSD_VV_PLAI => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_LAI)
      Z_YDMF_PHYS_SURF_GSD_VV_PSAB => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_SAB)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZC3 => NULL ()
    ZCG => NULL ()
    ZCN => NULL ()
    ZDSA_C1 => NULL ()
    ZDSA_C2 => NULL ()
    ZNEIJG => NULL ()
    ZNEIJV => NULL ()
    ZWFC => NULL ()
    ZWPMX => NULL ()
    ZWSEQ => NULL ()
    ZWSMX => NULL ()
    ZWWILT => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SB_TL => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_A => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_R => NULL ()
    Z_YDMF_PHYS_OUT_CT => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PARG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PD2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PIVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PLAI => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PSAB => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACSOL',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

CALL APL_ARPEGE_INIT_SURFEX_PARALLEL (YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS&
&, YDCPG_OPTS, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS, YDVARS, YDMODEL, YL_ZALBD, YL_ZALBP&
&, YL_ZFLU_EMIS, YL_ZSGROUPEL, YL_ZSRAIN, YL_ZSSNOW, YL_ZTSN)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ZDPHIV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
  ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZDPHIV (JLON, JBLK)=YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HVCLS
      ZDPHIT (JLON, JBLK)=YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HTCLS
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZDPHIV')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
    ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZDPHIT => NULL ()
  ZDPHIV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZDPHIV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
  ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      ZDPHIV (JLON, JBLK)=YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HVCLS
      ZDPHIT (JLON, JBLK)=YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HTCLS
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZDPHIV')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
    ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZDPHIT => NULL ()
  ZDPHIV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZDPHIV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZDPHIT => GET_DEVICE_DATA_RDWR (YL_ZDPHIT)
  ZDPHIV => GET_DEVICE_DATA_RDWR (YL_ZDPHIV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZDPHIT, ZDPHIV) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      ZDPHIV (JLON, JBLK)=YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HVCLS
      ZDPHIT (JLON, JBLK)=YDMODEL%YRCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%HTCLS
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZDPHIV')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
    ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZDPHIT => NULL ()
  ZDPHIV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDPHIV',1,ZHOOK_HANDLE_PARALLEL)
LLCLS=.TRUE.
LLHMT=.TRUE.

IF (YDMODEL%YRML_PHY_MF%YRARPHY%LMSE) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACHMTLS')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHI => GET_HOST_DATA_RDWR (YL_ZDPHI)
    ZDPHIT => GET_HOST_DATA_RDONLY (YL_ZDPHIT)
    ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
    ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
    ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
    ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
    ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
    ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
    ZPRS => GET_HOST_DATA_RDWR (YL_ZPRS)
    ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0)
    Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL ACHMTLS (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
      &, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK)&
      &, Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
      &(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZDPHIT(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H&
      &(:, JBLK), LLCLS, ZNBVNO(:,:, JBLK), ZMRIPP(:,:, JBLK), ZDSA_CPS(:, JBLK), ZGWDCS(:, JBLK), ZDSA_LHS&
      &(:, JBLK), ZPCLS(:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK))

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZDPHI (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(JLON, YDCPG_OPTS%KFLEVG&
        &, JBLK)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZPRS (JLON, JBLK)=YDMODEL%YRCST%RD+ZRVMD*Z_YDCPG_MISC_QS (JLON, JBLK)
        ZRTI (JLON, JBLK)=2.0_JPRB/(Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(JLON, YDCPG_OPTS%KFLEVG&
        &, JBLK)*Z_YDMF_PHYS_BASE_STATE_T(JLON, YDCPG_OPTS%KFLEVG, JBLK)+YDMODEL%YRCST%RKAPPA*ZDPHI&
        & (JLON, JBLK)+ZPRS (JLON, JBLK)*Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK))
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACHMTLS')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDPHI => GET_HOST_DATA_RDWR (YL_ZDPHI)
      ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
      ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
      ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
      ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
      ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
      ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
      ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
      ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
      ZPRS => GET_HOST_DATA_RDWR (YL_ZPRS)
      ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHI => NULL ()
    ZDPHIT => NULL ()
    ZDSA_CPS => NULL ()
    ZDSA_LHS => NULL ()
    ZFLU_CD => NULL ()
    ZFLU_CDN => NULL ()
    ZGWDCS => NULL ()
    ZMRIPP => NULL ()
    ZNBVNO => NULL ()
    ZPCLS => NULL ()
    ZPRS => NULL ()
    ZRTI => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OUT_GZ0 => NULL ()
    Z_YDMF_PHYS_OUT_GZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACHMTLS')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHI => GET_HOST_DATA_RDWR (YL_ZDPHI)
    ZDPHIT => GET_HOST_DATA_RDONLY (YL_ZDPHIT)
    ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
    ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
    ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
    ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
    ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
    ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
    ZPRS => GET_HOST_DATA_RDWR (YL_ZPRS)
    ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0)
    Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACHMTLS_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,&
        &:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
        &(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZDPHIT(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H&
        &(:, JBLK), LLCLS, ZNBVNO(:,:, JBLK), ZMRIPP(:,:, JBLK), ZDSA_CPS(:, JBLK), ZGWDCS(:, JBLK)&
        &, ZDSA_LHS(:, JBLK), ZPCLS(:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK),YDSTACK=YLSTACK)
        
        ZDPHI (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(JLON, YDCPG_OPTS%KFLEVG&
        &, JBLK)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZPRS (JLON, JBLK)=YDMODEL%YRCST%RD+ZRVMD*Z_YDCPG_MISC_QS (JLON, JBLK)
        ZRTI (JLON, JBLK)=2.0_JPRB/(Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(JLON, YDCPG_OPTS%KFLEVG&
        &, JBLK)*Z_YDMF_PHYS_BASE_STATE_T(JLON, YDCPG_OPTS%KFLEVG, JBLK)+YDMODEL%YRCST%RKAPPA*ZDPHI&
        & (JLON, JBLK)+ZPRS (JLON, JBLK)*Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK))
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACHMTLS')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDPHI => GET_HOST_DATA_RDWR (YL_ZDPHI)
      ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
      ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
      ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
      ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
      ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
      ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
      ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
      ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
      ZPRS => GET_HOST_DATA_RDWR (YL_ZPRS)
      ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHI => NULL ()
    ZDPHIT => NULL ()
    ZDSA_CPS => NULL ()
    ZDSA_LHS => NULL ()
    ZFLU_CD => NULL ()
    ZFLU_CDN => NULL ()
    ZGWDCS => NULL ()
    ZMRIPP => NULL ()
    ZNBVNO => NULL ()
    ZPCLS => NULL ()
    ZPRS => NULL ()
    ZRTI => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OUT_GZ0 => NULL ()
    Z_YDMF_PHYS_OUT_GZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACHMTLS')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHI => GET_DEVICE_DATA_RDWR (YL_ZDPHI)
    ZDPHIT => GET_DEVICE_DATA_RDONLY (YL_ZDPHIT)
    ZDSA_CPS => GET_DEVICE_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_LHS => GET_DEVICE_DATA_RDWR (YL_ZDSA_LHS)
    ZFLU_CD => GET_DEVICE_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_DEVICE_DATA_RDWR (YL_ZFLU_CDN)
    ZGWDCS => GET_DEVICE_DATA_RDWR (YL_ZGWDCS)
    ZMRIPP => GET_DEVICE_DATA_RDWR (YL_ZMRIPP)
    ZNBVNO => GET_DEVICE_DATA_RDWR (YL_ZNBVNO)
    ZPCLS => GET_DEVICE_DATA_RDWR (YL_ZPCLS)
    ZPRS => GET_DEVICE_DATA_RDWR (YL_ZPRS)
    ZRTI => GET_DEVICE_DATA_RDWR (YL_ZRTI)
    Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_GZ0 => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0)
    Z_YDMF_PHYS_OUT_GZ0H => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZDPHI, ZDPHIT, ZDSA_CPS, &
      !$ACC&         ZDSA_LHS, ZFLU_CD, ZFLU_CDN, ZGWDCS, ZMRIPP, ZNBVNO, ZPCLS, ZPRS, ZRTI, &
      !$ACC&         Z_YDCPG_MISC_QS, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_GZ0, &
      !$ACC&         Z_YDMF_PHYS_OUT_GZ0H) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACHMTLS_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,&
        &:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
        &(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZDPHIT(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H&
        &(:, JBLK), LLCLS, ZNBVNO(:,:, JBLK), ZMRIPP(:,:, JBLK), ZDSA_CPS(:, JBLK), ZGWDCS(:, JBLK)&
        &, ZDSA_LHS(:, JBLK), ZPCLS(:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK),YDSTACK=YLSTACK)
        
        ZDPHI (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(JLON, YDCPG_OPTS%KFLEVG&
        &, JBLK)-Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZPRS (JLON, JBLK)=YDMODEL%YRCST%RD+ZRVMD*Z_YDCPG_MISC_QS (JLON, JBLK)
        ZRTI (JLON, JBLK)=2.0_JPRB/(Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(JLON, YDCPG_OPTS%KFLEVG&
        &, JBLK)*Z_YDMF_PHYS_BASE_STATE_T(JLON, YDCPG_OPTS%KFLEVG, JBLK)+YDMODEL%YRCST%RKAPPA*ZDPHI&
        & (JLON, JBLK)+ZPRS (JLON, JBLK)*Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK))
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACHMTLS')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDPHI => GET_HOST_DATA_RDWR (YL_ZDPHI)
      ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
      ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
      ZDSA_LHS => GET_HOST_DATA_RDWR (YL_ZDSA_LHS)
      ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
      ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
      ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
      ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
      ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
      ZPRS => GET_HOST_DATA_RDWR (YL_ZPRS)
      ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDPHI => NULL ()
    ZDPHIT => NULL ()
    ZDSA_CPS => NULL ()
    ZDSA_LHS => NULL ()
    ZFLU_CD => NULL ()
    ZFLU_CDN => NULL ()
    ZGWDCS => NULL ()
    ZMRIPP => NULL ()
    ZNBVNO => NULL ()
    ZPCLS => NULL ()
    ZPRS => NULL ()
    ZRTI => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_OUT_GZ0 => NULL ()
    Z_YDMF_PHYS_OUT_GZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMTLS',1,ZHOOK_HANDLE_PARALLEL)
ELSE
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACHMT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZCDROV => GET_HOST_DATA_RDWR (YL_ZCDROV)
    ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
    ZDPHIT => GET_HOST_DATA_RDONLY (YL_ZDPHIT)
    ZDPHIV => GET_HOST_DATA_RDONLY (YL_ZDPHIV)
    ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
    ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
    ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
    ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
    ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
    ZHQ => GET_HOST_DATA_RDWR (YL_ZHQ)
    ZHU => GET_HOST_DATA_RDWR (YL_ZHU)
    ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
    ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
    ZNEIJG => GET_HOST_DATA_RDONLY (YL_ZNEIJG)
    ZNEIJV => GET_HOST_DATA_RDONLY (YL_ZNEIJV)
    ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
    ZPFL_FPLCH => GET_HOST_DATA_RDONLY (YL_ZPFL_FPLCH)
    ZPFL_FPLSH => GET_HOST_DATA_RDONLY (YL_ZPFL_FPLSH)
    ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
    ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
    ZSTAB => GET_HOST_DATA_RDWR (YL_ZSTAB)
    ZWFC => GET_HOST_DATA_RDONLY (YL_ZWFC)
    ZXDROV => GET_HOST_DATA_RDWR (YL_ZXDROV)
    ZXHROV => GET_HOST_DATA_RDWR (YL_ZXHROV)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
    Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
    Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
    Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
    Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
    Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_HV)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL ACHMT (YDCPG_OPTS%YRCLI, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF&
      &%YRPHY1, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%YRSURF_DIMS%YSD_VVD%NUMFLDS>=8.AND.YDMODEL%YRML_PHY_MF%YRPHY&
      &%LSOLV, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,&
      & JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
      &(:,:, JBLK), ZPFL_FPLSH(:,:, JBLK), ZPFL_FPLCH(:,:, JBLK), ZDPHIT(:, JBLK), ZDPHIV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F&
      &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PHV&
      &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F&
      & (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), ZWFC&
      &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK),&
      & LLCLS, LLHMT, ZNBVNO(:,:, JBLK), ZMRIPP(:,:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), ZCDROV(&
      &:, JBLK), ZFLU_CH(:, JBLK), ZCHROV(:, JBLK), ZDSA_CPS(:, JBLK), ZDQSTS(:, JBLK), ZGWDCS(:, JBLK),&
      & Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), ZHQ(:, JBLK), ZHU(:, JBLK), ZFLU_NEIJ&
      &(:, JBLK), Z_YDMF_PHYS_OUT_QCLS(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZFLU_QSATS(:, JBLK), Z_YDMF_PHYS_OUT_RHCLS&
      &(:, JBLK), ZDSA_RS(:, JBLK), ZRTI(:, JBLK), ZSTAB(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_OUT_UCLS&
      &(:, JBLK), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_NUCLS(:, JBLK), Z_YDMF_PHYS_OUT_NVCLS(:&
      &, JBLK), ZPCLS(:, JBLK), ZFLU_VEG(:, JBLK), ZXDROV(:, JBLK), ZXHROV(:, JBLK), Z_YDMF_PHYS_OUT_UGST&
      &(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACHMT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZCDROV => GET_HOST_DATA_RDWR (YL_ZCDROV)
      ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
      ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
      ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
      ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
      ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
      ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
      ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
      ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
      ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
      ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
      ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
      ZHQ => GET_HOST_DATA_RDWR (YL_ZHQ)
      ZHU => GET_HOST_DATA_RDWR (YL_ZHU)
      ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
      ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
      ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
      ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
      ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
      ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
      ZSTAB => GET_HOST_DATA_RDWR (YL_ZSTAB)
      ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
      ZXDROV => GET_HOST_DATA_RDWR (YL_ZXDROV)
      ZXHROV => GET_HOST_DATA_RDWR (YL_ZXHROV)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZCDROV => NULL ()
    ZCHROV => NULL ()
    ZDPHIT => NULL ()
    ZDPHIV => NULL ()
    ZDQSTS => NULL ()
    ZDSA_CPS => NULL ()
    ZDSA_RS => NULL ()
    ZFLU_CD => NULL ()
    ZFLU_CDN => NULL ()
    ZFLU_CH => NULL ()
    ZFLU_NEIJ => NULL ()
    ZFLU_QSATS => NULL ()
    ZFLU_VEG => NULL ()
    ZGWDCS => NULL ()
    ZHQ => NULL ()
    ZHU => NULL ()
    ZMRIPP => NULL ()
    ZNBVNO => NULL ()
    ZNEIJG => NULL ()
    ZNEIJV => NULL ()
    ZPCLS => NULL ()
    ZPFL_FPLCH => NULL ()
    ZPFL_FPLSH => NULL ()
    ZQV => NULL ()
    ZRTI => NULL ()
    ZSTAB => NULL ()
    ZWFC => NULL ()
    ZXDROV => NULL ()
    ZXHROV => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL ()
    Z_YDMF_PHYS_OUT_GZ0 => NULL ()
    Z_YDMF_PHYS_OUT_GZ0H => NULL ()
    Z_YDMF_PHYS_OUT_NUCLS => NULL ()
    Z_YDMF_PHYS_OUT_NVCLS => NULL ()
    Z_YDMF_PHYS_OUT_QCLS => NULL ()
    Z_YDMF_PHYS_OUT_RHCLS => NULL ()
    Z_YDMF_PHYS_OUT_TCLS => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACHMT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZCDROV => GET_HOST_DATA_RDWR (YL_ZCDROV)
    ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
    ZDPHIT => GET_HOST_DATA_RDONLY (YL_ZDPHIT)
    ZDPHIV => GET_HOST_DATA_RDONLY (YL_ZDPHIV)
    ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
    ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
    ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
    ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
    ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
    ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
    ZHQ => GET_HOST_DATA_RDWR (YL_ZHQ)
    ZHU => GET_HOST_DATA_RDWR (YL_ZHU)
    ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
    ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
    ZNEIJG => GET_HOST_DATA_RDONLY (YL_ZNEIJG)
    ZNEIJV => GET_HOST_DATA_RDONLY (YL_ZNEIJV)
    ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
    ZPFL_FPLCH => GET_HOST_DATA_RDONLY (YL_ZPFL_FPLCH)
    ZPFL_FPLSH => GET_HOST_DATA_RDONLY (YL_ZPFL_FPLSH)
    ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
    ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
    ZSTAB => GET_HOST_DATA_RDWR (YL_ZSTAB)
    ZWFC => GET_HOST_DATA_RDONLY (YL_ZWFC)
    ZXDROV => GET_HOST_DATA_RDWR (YL_ZXDROV)
    ZXHROV => GET_HOST_DATA_RDWR (YL_ZXHROV)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
    Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
    Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
    Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
    Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
    Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_HV)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACHMT_OPENACC (YDCPG_OPTS%YRCLI, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL&
        &%YRML_PHY_MF%YRPHY1, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%YRSURF_DIMS%YSD_VVD%NUMFLDS>=8.AND.YDMODEL%YRML_PHY_MF&
        &%YRPHY%LSOLV, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
        &(:,:, JBLK), ZPFL_FPLSH(:,:, JBLK), ZPFL_FPLCH(:,:, JBLK), ZDPHIT(:, JBLK), ZDPHIV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PHV&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F&
        & (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), ZWFC&
        &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLCLS&
        &, LLHMT, ZNBVNO(:,:, JBLK), ZMRIPP(:,:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), ZCDROV(:, JBLK&
        &), ZFLU_CH(:, JBLK), ZCHROV(:, JBLK), ZDSA_CPS(:, JBLK), ZDQSTS(:, JBLK), ZGWDCS(:, JBLK), Z_YDMF_PHYS_OUT_GZ0&
        &(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), ZHQ(:, JBLK), ZHU(:, JBLK), ZFLU_NEIJ(:, JBLK), Z_YDMF_PHYS_OUT_QCLS&
        &(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZFLU_QSATS(:, JBLK), Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), ZDSA_RS(&
        &:, JBLK), ZRTI(:, JBLK), ZSTAB(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_OUT_UCLS(:, JBLK&
        &), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_NUCLS(:, JBLK), Z_YDMF_PHYS_OUT_NVCLS(:, JBLK), ZPCLS&
        &(:, JBLK), ZFLU_VEG(:, JBLK), ZXDROV(:, JBLK), ZXHROV(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST&
        &(:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACHMT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZCDROV => GET_HOST_DATA_RDWR (YL_ZCDROV)
      ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
      ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
      ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
      ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
      ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
      ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
      ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
      ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
      ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
      ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
      ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
      ZHQ => GET_HOST_DATA_RDWR (YL_ZHQ)
      ZHU => GET_HOST_DATA_RDWR (YL_ZHU)
      ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
      ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
      ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
      ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
      ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
      ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
      ZSTAB => GET_HOST_DATA_RDWR (YL_ZSTAB)
      ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
      ZXDROV => GET_HOST_DATA_RDWR (YL_ZXDROV)
      ZXHROV => GET_HOST_DATA_RDWR (YL_ZXHROV)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZCDROV => NULL ()
    ZCHROV => NULL ()
    ZDPHIT => NULL ()
    ZDPHIV => NULL ()
    ZDQSTS => NULL ()
    ZDSA_CPS => NULL ()
    ZDSA_RS => NULL ()
    ZFLU_CD => NULL ()
    ZFLU_CDN => NULL ()
    ZFLU_CH => NULL ()
    ZFLU_NEIJ => NULL ()
    ZFLU_QSATS => NULL ()
    ZFLU_VEG => NULL ()
    ZGWDCS => NULL ()
    ZHQ => NULL ()
    ZHU => NULL ()
    ZMRIPP => NULL ()
    ZNBVNO => NULL ()
    ZNEIJG => NULL ()
    ZNEIJV => NULL ()
    ZPCLS => NULL ()
    ZPFL_FPLCH => NULL ()
    ZPFL_FPLSH => NULL ()
    ZQV => NULL ()
    ZRTI => NULL ()
    ZSTAB => NULL ()
    ZWFC => NULL ()
    ZXDROV => NULL ()
    ZXHROV => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL ()
    Z_YDMF_PHYS_OUT_GZ0 => NULL ()
    Z_YDMF_PHYS_OUT_GZ0H => NULL ()
    Z_YDMF_PHYS_OUT_NUCLS => NULL ()
    Z_YDMF_PHYS_OUT_NVCLS => NULL ()
    Z_YDMF_PHYS_OUT_QCLS => NULL ()
    Z_YDMF_PHYS_OUT_RHCLS => NULL ()
    Z_YDMF_PHYS_OUT_TCLS => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACHMT')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZCDROV => GET_DEVICE_DATA_RDWR (YL_ZCDROV)
    ZCHROV => GET_DEVICE_DATA_RDWR (YL_ZCHROV)
    ZDPHIT => GET_DEVICE_DATA_RDONLY (YL_ZDPHIT)
    ZDPHIV => GET_DEVICE_DATA_RDONLY (YL_ZDPHIV)
    ZDQSTS => GET_DEVICE_DATA_RDWR (YL_ZDQSTS)
    ZDSA_CPS => GET_DEVICE_DATA_RDWR (YL_ZDSA_CPS)
    ZDSA_RS => GET_DEVICE_DATA_RDWR (YL_ZDSA_RS)
    ZFLU_CD => GET_DEVICE_DATA_RDWR (YL_ZFLU_CD)
    ZFLU_CDN => GET_DEVICE_DATA_RDWR (YL_ZFLU_CDN)
    ZFLU_CH => GET_DEVICE_DATA_RDWR (YL_ZFLU_CH)
    ZFLU_NEIJ => GET_DEVICE_DATA_RDWR (YL_ZFLU_NEIJ)
    ZFLU_QSATS => GET_DEVICE_DATA_RDWR (YL_ZFLU_QSATS)
    ZFLU_VEG => GET_DEVICE_DATA_RDWR (YL_ZFLU_VEG)
    ZGWDCS => GET_DEVICE_DATA_RDWR (YL_ZGWDCS)
    ZHQ => GET_DEVICE_DATA_RDWR (YL_ZHQ)
    ZHU => GET_DEVICE_DATA_RDWR (YL_ZHU)
    ZMRIPP => GET_DEVICE_DATA_RDWR (YL_ZMRIPP)
    ZNBVNO => GET_DEVICE_DATA_RDWR (YL_ZNBVNO)
    ZNEIJG => GET_DEVICE_DATA_RDONLY (YL_ZNEIJG)
    ZNEIJV => GET_DEVICE_DATA_RDONLY (YL_ZNEIJV)
    ZPCLS => GET_DEVICE_DATA_RDWR (YL_ZPCLS)
    ZPFL_FPLCH => GET_DEVICE_DATA_RDONLY (YL_ZPFL_FPLCH)
    ZPFL_FPLSH => GET_DEVICE_DATA_RDONLY (YL_ZPFL_FPLSH)
    ZQV => GET_DEVICE_DATA_RDONLY (YL_ZQV)
    ZRTI => GET_DEVICE_DATA_RDWR (YL_ZRTI)
    ZSTAB => GET_DEVICE_DATA_RDWR (YL_ZSTAB)
    ZWFC => GET_DEVICE_DATA_RDONLY (YL_ZWFC)
    ZXDROV => GET_DEVICE_DATA_RDWR (YL_ZXDROV)
    ZXHROV => GET_DEVICE_DATA_RDWR (YL_ZXHROV)
    Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
    Z_YDMF_PHYS_OUT_GZ0 => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
    Z_YDMF_PHYS_OUT_GZ0H => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
    Z_YDMF_PHYS_OUT_NUCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
    Z_YDMF_PHYS_OUT_NVCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
    Z_YDMF_PHYS_OUT_QCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
    Z_YDMF_PHYS_OUT_RHCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
    Z_YDMF_PHYS_OUT_TCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_UCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VEG)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_HV)
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZCDROV, ZCHROV, ZDPHIT, &
      !$ACC&         ZDPHIV, ZDQSTS, ZDSA_CPS, ZDSA_RS, ZFLU_CD, ZFLU_CDN, ZFLU_CH, ZFLU_NEIJ, &
      !$ACC&         ZFLU_QSATS, ZFLU_VEG, ZGWDCS, ZHQ, ZHU, ZMRIPP, ZNBVNO, ZNEIJG, ZNEIJV, &
      !$ACC&         ZPCLS, ZPFL_FPLCH, ZPFL_FPLSH, ZQV, ZRTI, ZSTAB, ZWFC, ZXDROV, ZXHROV, &
      !$ACC&         Z_YDCPG_MISC_QS, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F, Z_YDMF_PHYS_OUT_GZ0, &
      !$ACC&         Z_YDMF_PHYS_OUT_GZ0H, Z_YDMF_PHYS_OUT_NUCLS, Z_YDMF_PHYS_OUT_NVCLS, &
      !$ACC&         Z_YDMF_PHYS_OUT_QCLS, Z_YDMF_PHYS_OUT_RHCLS, Z_YDMF_PHYS_OUT_TCLS, &
      !$ACC&         Z_YDMF_PHYS_OUT_UCLS, Z_YDMF_PHYS_OUT_UGST, Z_YDMF_PHYS_OUT_VCLS, &
      !$ACC&         Z_YDMF_PHYS_OUT_VGST, Z_YDMF_PHYS_SURF_GSD_VF_PLSM, Z_YDMF_PHYS_SURF_GSD_VF_PVEG, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VF_PZ0F, Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_VV_PHV, Z_YDMF_PHYS_SURF_GSD_VV_PZ0H) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACHMT_OPENACC (YDCPG_OPTS%YRCLI, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL&
        &%YRML_PHY_MF%YRPHY1, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS%YRSURF_DIMS%YSD_VVD%NUMFLDS>=8.AND.YDMODEL%YRML_PHY_MF&
        &%YRPHY%LSOLV, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
        &(:,:, JBLK), ZPFL_FPLSH(:,:, JBLK), ZPFL_FPLCH(:,:, JBLK), ZDPHIT(:, JBLK), ZDPHIV(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0F&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PZ0H(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VV_PHV&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZNEIJG(:, JBLK), ZNEIJV(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F&
        & (:, 1, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVEG(:, JBLK), ZWFC&
        &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC(:, JBLK), LLCLS&
        &, LLHMT, ZNBVNO(:,:, JBLK), ZMRIPP(:,:, JBLK), ZFLU_CD(:, JBLK), ZFLU_CDN(:, JBLK), ZCDROV(:, JBLK&
        &), ZFLU_CH(:, JBLK), ZCHROV(:, JBLK), ZDSA_CPS(:, JBLK), ZDQSTS(:, JBLK), ZGWDCS(:, JBLK), Z_YDMF_PHYS_OUT_GZ0&
        &(:, JBLK), Z_YDMF_PHYS_OUT_GZ0H(:, JBLK), ZHQ(:, JBLK), ZHU(:, JBLK), ZFLU_NEIJ(:, JBLK), Z_YDMF_PHYS_OUT_QCLS&
        &(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), ZFLU_QSATS(:, JBLK), Z_YDMF_PHYS_OUT_RHCLS(:, JBLK), ZDSA_RS(&
        &:, JBLK), ZRTI(:, JBLK), ZSTAB(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_OUT_UCLS(:, JBLK&
        &), Z_YDMF_PHYS_OUT_VCLS(:, JBLK), Z_YDMF_PHYS_OUT_NUCLS(:, JBLK), Z_YDMF_PHYS_OUT_NVCLS(:, JBLK), ZPCLS&
        &(:, JBLK), ZFLU_VEG(:, JBLK), ZXDROV(:, JBLK), ZXHROV(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST&
        &(:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACHMT')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZCDROV => GET_HOST_DATA_RDWR (YL_ZCDROV)
      ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
      ZDPHIT => GET_HOST_DATA_RDWR (YL_ZDPHIT)
      ZDPHIV => GET_HOST_DATA_RDWR (YL_ZDPHIV)
      ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
      ZDSA_CPS => GET_HOST_DATA_RDWR (YL_ZDSA_CPS)
      ZDSA_RS => GET_HOST_DATA_RDWR (YL_ZDSA_RS)
      ZFLU_CD => GET_HOST_DATA_RDWR (YL_ZFLU_CD)
      ZFLU_CDN => GET_HOST_DATA_RDWR (YL_ZFLU_CDN)
      ZFLU_CH => GET_HOST_DATA_RDWR (YL_ZFLU_CH)
      ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
      ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
      ZFLU_VEG => GET_HOST_DATA_RDWR (YL_ZFLU_VEG)
      ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
      ZHQ => GET_HOST_DATA_RDWR (YL_ZHQ)
      ZHU => GET_HOST_DATA_RDWR (YL_ZHU)
      ZMRIPP => GET_HOST_DATA_RDWR (YL_ZMRIPP)
      ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
      ZNEIJG => GET_HOST_DATA_RDWR (YL_ZNEIJG)
      ZNEIJV => GET_HOST_DATA_RDWR (YL_ZNEIJV)
      ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
      ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
      ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
      ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
      ZRTI => GET_HOST_DATA_RDWR (YL_ZRTI)
      ZSTAB => GET_HOST_DATA_RDWR (YL_ZSTAB)
      ZWFC => GET_HOST_DATA_RDWR (YL_ZWFC)
      ZXDROV => GET_HOST_DATA_RDWR (YL_ZXDROV)
      ZXHROV => GET_HOST_DATA_RDWR (YL_ZXHROV)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_IC)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
      Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_W)
      Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_SG%F_F)
      Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
      Z_YDMF_PHYS_OUT_GZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0H)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_NVCLS)
      Z_YDMF_PHYS_OUT_QCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_QCLS)
      Z_YDMF_PHYS_OUT_RHCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_RHCLS)
      Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
      Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
      Z_YDMF_PHYS_SURF_GSD_VF_PVEG => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VEG)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0F)
      Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_Z0RLF)
      Z_YDMF_PHYS_SURF_GSD_VV_PHV => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_HV)
      Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VV%F_Z0H)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZCDROV => NULL ()
    ZCHROV => NULL ()
    ZDPHIT => NULL ()
    ZDPHIV => NULL ()
    ZDQSTS => NULL ()
    ZDSA_CPS => NULL ()
    ZDSA_RS => NULL ()
    ZFLU_CD => NULL ()
    ZFLU_CDN => NULL ()
    ZFLU_CH => NULL ()
    ZFLU_NEIJ => NULL ()
    ZFLU_QSATS => NULL ()
    ZFLU_VEG => NULL ()
    ZGWDCS => NULL ()
    ZHQ => NULL ()
    ZHU => NULL ()
    ZMRIPP => NULL ()
    ZNBVNO => NULL ()
    ZNEIJG => NULL ()
    ZNEIJV => NULL ()
    ZPCLS => NULL ()
    ZPFL_FPLCH => NULL ()
    ZPFL_FPLSH => NULL ()
    ZQV => NULL ()
    ZRTI => NULL ()
    ZSTAB => NULL ()
    ZWFC => NULL ()
    ZXDROV => NULL ()
    ZXHROV => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_IC => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_W => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YGSP_SG_F => NULL ()
    Z_YDMF_PHYS_OUT_GZ0 => NULL ()
    Z_YDMF_PHYS_OUT_GZ0H => NULL ()
    Z_YDMF_PHYS_OUT_NUCLS => NULL ()
    Z_YDMF_PHYS_OUT_NVCLS => NULL ()
    Z_YDMF_PHYS_OUT_QCLS => NULL ()
    Z_YDMF_PHYS_OUT_RHCLS => NULL ()
    Z_YDMF_PHYS_OUT_TCLS => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PVEG => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0F => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VF_PZ0RLF => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PHV => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VV_PZ0H => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACHMT',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACCLPH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
  ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
  ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  ZTHETAV => GET_HOST_DATA_RDWR (YL_ZTHETAV)
  ZTHETAVS => GET_HOST_DATA_RDWR (YL_ZTHETAVS)
  ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
  ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
  Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
  Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VEIN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZCP (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(JLON, JLEV, JBLK)
      ENDDO

    ENDDO


    DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZTHETAV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_T(JLON, JLEV, JBLK)*(1.0_JPRB&
        &+YDMODEL%YRCST%RETV*ZQV (JLON, JLEV, JBLK))*(YDMODEL%YRCST%RATM/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(JLON, JLEV, JBLK))**YDMODEL%YRCST%RKAPPA
      ENDDO

    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZTHETAVS (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)*(1.0_JPRB+YDMODEL&
      &%YRCST%RETV*Z_YDCPG_MISC_QS (JLON, JBLK))*(YDMODEL%YRCST%RATM/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(JLON, YDCPG_OPTS%KFLEVG, JBLK))**YDMODEL%YRCST%RKAPPA
    ENDDO

    CALL ACCLPH (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA,&
    & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, ZTHETAV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
    &(:,:, JBLK), ZTHETAVS(:, JBLK), IMOC_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_VEIN&
    &(:, JBLK), ZUGST(:, JBLK), ZVGST(:, JBLK))

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ZBLH (JLON, JBLK)=Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACCLPH')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZTHETAV => GET_HOST_DATA_RDWR (YL_ZTHETAV)
    ZTHETAVS => GET_HOST_DATA_RDWR (YL_ZTHETAVS)
    ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
    ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VEIN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => NULL ()
  ZBLH => NULL ()
  ZCP => NULL ()
  ZQV => NULL ()
  ZTHETAV => NULL ()
  ZTHETAVS => NULL ()
  ZUGST => NULL ()
  ZVGST => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLPH => NULL ()
  Z_YDMF_PHYS_OUT_VEIN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACCLPH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
  ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
  ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  ZTHETAV => GET_HOST_DATA_RDWR (YL_ZTHETAV)
  ZTHETAVS => GET_HOST_DATA_RDWR (YL_ZTHETAVS)
  ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
  ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
  Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
  Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VEIN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZCP (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(JLON, JLEV, JBLK)
      
      ENDDO


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        ZTHETAV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_T(JLON, JLEV, JBLK)*(1.0_JPRB&
        &+YDMODEL%YRCST%RETV*ZQV (JLON, JLEV, JBLK))*(YDMODEL%YRCST%RATM/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(JLON, JLEV, JBLK))**YDMODEL%YRCST%RKAPPA
      
      ENDDO

      
      ZTHETAVS (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)*(1.0_JPRB+YDMODEL&
      &%YRCST%RETV*Z_YDCPG_MISC_QS (JLON, JBLK))*(YDMODEL%YRCST%RATM/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(JLON, YDCPG_OPTS%KFLEVG, JBLK))**YDMODEL%YRCST%RKAPPA
      
      CALL ACCLPH_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY2&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG&
      &, ZTHETAV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), ZTHETAVS&
      &(:, JBLK), IMOC_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_VEIN(:, JBLK&
      &), ZUGST(:, JBLK), ZVGST(:, JBLK),YDSTACK=YLSTACK)
      
      ZBLH (JLON, JBLK)=Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACCLPH')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZTHETAV => GET_HOST_DATA_RDWR (YL_ZTHETAV)
    ZTHETAVS => GET_HOST_DATA_RDWR (YL_ZTHETAVS)
    ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
    ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VEIN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => NULL ()
  ZBLH => NULL ()
  ZCP => NULL ()
  ZQV => NULL ()
  ZTHETAV => NULL ()
  ZTHETAVS => NULL ()
  ZUGST => NULL ()
  ZVGST => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLPH => NULL ()
  Z_YDMF_PHYS_OUT_VEIN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACCLPH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => GET_DEVICE_DATA_RDWR (YL_IMOC_CLPH)
  ZBLH => GET_DEVICE_DATA_RDWR (YL_ZBLH)
  ZCP => GET_DEVICE_DATA_RDWR (YL_ZCP)
  ZQV => GET_DEVICE_DATA_RDONLY (YL_ZQV)
  ZTHETAV => GET_DEVICE_DATA_RDWR (YL_ZTHETAV)
  ZTHETAVS => GET_DEVICE_DATA_RDWR (YL_ZTHETAVS)
  ZUGST => GET_DEVICE_DATA_RDWR (YL_ZUGST)
  ZVGST => GET_DEVICE_DATA_RDWR (YL_ZVGST)
  Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLPH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
  Z_YDMF_PHYS_OUT_VEIN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_VEIN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (IMOC_CLPH, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZBLH, ZCP, &
    !$ACC&         ZQV, ZTHETAV, ZTHETAVS, ZUGST, ZVGST, Z_YDCPG_MISC_QS, Z_YDMF_PHYS_BASE_STATE_T, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_CLPH, &
    !$ACC&         Z_YDMF_PHYS_OUT_VEIN) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZCP (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(JLON, JLEV, JBLK)
      
      ENDDO


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        ZTHETAV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_T(JLON, JLEV, JBLK)*(1.0_JPRB&
        &+YDMODEL%YRCST%RETV*ZQV (JLON, JLEV, JBLK))*(YDMODEL%YRCST%RATM/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(JLON, JLEV, JBLK))**YDMODEL%YRCST%RKAPPA
      
      ENDDO

      
      ZTHETAVS (JLON, JBLK)=Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)*(1.0_JPRB+YDMODEL&
      &%YRCST%RETV*Z_YDCPG_MISC_QS (JLON, JBLK))*(YDMODEL%YRCST%RATM/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(JLON, YDCPG_OPTS%KFLEVG, JBLK))**YDMODEL%YRCST%RKAPPA
      
      CALL ACCLPH_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY0, YDMODEL%YRML_PHY_MF%YRPHY2&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG&
      &, ZTHETAV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), ZTHETAVS&
      &(:, JBLK), IMOC_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_CLPH(:, JBLK), Z_YDMF_PHYS_OUT_VEIN(:, JBLK&
      &), ZUGST(:, JBLK), ZVGST(:, JBLK),YDSTACK=YLSTACK)
      
      ZBLH (JLON, JBLK)=Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)
    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACCLPH')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
    ZCP => GET_HOST_DATA_RDWR (YL_ZCP)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZTHETAV => GET_HOST_DATA_RDWR (YL_ZTHETAV)
    ZTHETAVS => GET_HOST_DATA_RDWR (YL_ZTHETAVS)
    ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
    ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_VEIN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VEIN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IMOC_CLPH => NULL ()
  ZBLH => NULL ()
  ZCP => NULL ()
  ZQV => NULL ()
  ZTHETAV => NULL ()
  ZTHETAVS => NULL ()
  ZUGST => NULL ()
  ZVGST => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLPH => NULL ()
  Z_YDMF_PHYS_OUT_VEIN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACCLPH',1,ZHOOK_HANDLE_PARALLEL)
CALL APL_ARPEGE_OCEANIC_FLUXES_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS&
&, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, LLHMT, YL_ZCDROV, YL_ZCEROV, YL_ZCHROV, YL_ZDPHIT&
&, YL_ZDPHIV, YL_ZDSA_RS, YL_ZFLU_CD, YL_ZFLU_CDN, YL_ZFLU_CH, YL_ZFLU_QSATS)
CALL APL_WIND_GUST_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS&
&, YDMF_PHYS, YDVARS, YDMODEL, YL_IMOC_CLPH, YL_ZBLH, YL_ZDCAPE)
CALL APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS&
&, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, YDDDH, YL_INLAB_CVPP, YL_ZCDROV&
&, YL_ZCHROV, YL_ZCOEFN, YL_ZCONDCVPPI, YL_ZCONDCVPPL, YL_ZDIFCVPPQ, YL_ZDIFCVPPS, YDMODEL%YRML_PHY_MF&
&%YRPHY0%REPS, YL_ZFLU_CD, YL_ZFLU_CH, YL_ZKQLROV, YL_ZKQROV, YL_ZKTROV, YL_ZKUROV, YL_ZKUROV2&
&, YL_ZMSC_LSCPE, YL_ZNBVNO, YL_ZNEBS, YL_ZNEBS0, YL_ZNEB_CVPP, YL_ZPFL_FPLCH, YL_ZPFL_FTKE,&
& YL_ZPFL_FTKEI, YL_ZPRODTH_CVPP, YL_ZQI, YL_ZQIC, YL_ZQL, YL_ZQLC, YL_ZQLIS, YL_ZQLIS0, YL_ZQLI_CVPP&
&, YL_ZQV, YL_ZQR, YL_ZQS, YL_ZTKE1, YL_ZXTROV, YL_ZXUROV, YL_ZUSLE, YL_ZKCLS, YL_ZECTCLS, YL_ZPRODTH&
&, YL_ZEDMFQ, YL_ZEDMFS, YL_ZEDMFU, YL_ZEDMFV, YL_ZMF_UP)
CALL APL_ARPEGE_ALBEDO_COMPUTATION_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS&
&, YDCPG_OPTS, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, YL_ZALBD, YL_ZALBP,&
& ZEPS0, YL_ZFLU_EMIS, YL_ZFLU_NEIJ, YL_ZRDG_MU0, YL_ZALBDIR)
CALL APL_ARPEGE_AEROSOLS_FOR_RADIATION_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS&
&, YDCPG_OPTS, YDMF_PHYS_SURF, YDMODEL, YL_ZAER, YL_ZAERINDS)
CALL APL_ARPEGE_CLOUDINESS_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS&
&, YDVARS, YDMODEL, LLREDPR, YL_ZAIPCMT, YL_ZBLH, YL_ZDECRD, YL_ZFLU_QSAT, YL_ZMSC_QW, YL_ZNEBC0&
&, YL_ZNEBCH, YL_ZNEBS, YL_ZNEBS0, YL_ZNEB_CVPP, YL_ZPFL_FPLCH, YL_ZQI, YL_ZQL, YL_ZQLIS, YL_ZQLIS0&
&, YL_ZQLI_CVP, YL_ZQLI_CVPP, YL_ZQV, YL_ZUNEBH, YL_ZCLCT_RAD, YDGEOMETRY%YRSTA)
CALL APL_ARPEGE_RADIATION_PARALLEL (YDMF_PHYS_BASE_STATE, YDCFU, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS&
&, YDCPG_MISC, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_ZCLCT_RAD, YL_ZALBDIR, YL_ZDECRD&
&, YL_ZAER, YL_ZAERINDS, YL_ZALBD, YL_ZALBP, YL_ZQCO2, YL_ZCEMTR, YL_ZCTRSO, YL_ZFLU_EMIS, YL_ZFLU_QSAT&
&, YL_ZQO3, YL_ZQR, YL_ZQS, YL_ZQV, YL_ZRDG_MU0, YL_ZRDG_SOLO, YL_ZRDG_MU0LU, YL_ZRDG_MU0M, YL_ZSFSWDIF&
&, YL_ZSFSWDIR, YL_ZSUDU, YL_ZTENT, YL_ZTRSOD, YL_ZTRSODIF, YL_ZTRSODIR)
CALL APL_ARPEGE_SOIL_HYDRO_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDMF_PHYS&
&, YDMF_PHYS_SURF, YDMODEL, YL_ZCHROV, YL_ZFLU_NEIJ, YL_ZFLU_QSAT, YL_ZFLU_QSATS, YL_ZFLU_VEG&
&, YL_ZGWDCS, YL_ZHQ, YL_ZHTR, YL_ZHU, YL_ZQV, YL_ZWFC, YL_ZWLMX, YL_ZWWILT)
CALL APL_ARPEGE_SURFACE_PARALLEL (YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC&
&, YDCPG_GPAR, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_ZALBD, YL_ZALBP, YL_ZALPHA1, YL_ZCDROV&
&, YL_ZCEROV, YL_ZCFATH, YL_ZCFAU, YL_ZCFBTH, YL_ZCFBU, YL_ZCFBV, YL_ZCHROV, YL_ZCOEFA, YL_ZCOEFN&
&, YL_ZCP, YL_ZDIFEXT, YL_ZDIFWQ, YL_ZDIFWS, YL_ZDQSTS, YL_ZDSA_CPS, YL_ZDSA_LHS, ZDTMSE, YL_ZEDMFQ&
&, YL_ZEDMFS, YL_ZEDMFU, YL_ZEDMFV, YL_ZFLU_CD, YL_ZFLU_CDN, YL_ZFLU_EMIS, YL_ZFLU_FEVI, YL_ZFLU_NEIJ&
&, YL_ZFLU_QSATS, YL_ZFLU_VEG, YL_ZHQ, YL_ZHTR, YL_ZHU, YL_ZKQLROV, YL_ZKQROV, YL_ZKTROV, YL_ZKUROV&
&, YL_ZLVT, YL_ZMF_UP, YL_ZNEBCH, YL_ZNEBDIFF, YL_ZNEBS, YL_ZPOID, YL_ZQI, YL_ZQICE, YL_ZQL, YL_ZQV&
&, YL_ZRDG_MU0, YL_ZRDG_MU0N, ZRHGMT, YL_ZSC_FCLL, YL_ZSC_FCLN, YL_ZSC_FEVI, YL_ZSC_FEVN, YL_ZSFSWDIF&
&, YL_ZSFSWDIR, YL_ZSGROUPEL, YL_ZSRAIN, YL_ZSSNOW, ZSTATI, YL_ZTSN, YL_ZXDROV, YL_ZXHROV, YL_ZXQRO&
&, YL_ZXTRO, YL_ZXTROV, YL_ZXURO, YL_ZXUROV)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:DIFTQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZDIFCVPPQ => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPQ)
  ZDIFCVPPS => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPS)
  ZDIFCVPPU => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPU)
  ZDIFCVPPV => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPV)
  ZEDMFQ => GET_HOST_DATA_RDONLY (YL_ZEDMFQ)
  ZEDMFS => GET_HOST_DATA_RDONLY (YL_ZEDMFS)
  ZEDMFU => GET_HOST_DATA_RDONLY (YL_ZEDMFU)
  ZEDMFV => GET_HOST_DATA_RDONLY (YL_ZEDMFV)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF.OR.(YDMODEL%YRML_PHY_MF%YRPHY&
      &%LEDKF.AND..NOT.YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI)) THEN

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF) THEN

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDMF_PHYS_OUT_DIFTQ (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
            & (JLON, JLEV, JBLK)+ZDIFCVPPQ (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_DIFTS (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
            & (JLON, JLEV, JBLK)+ZDIFCVPPS (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU&
            & (JLON, JLEV, JBLK)+ZDIFCVPPU (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV&
            & (JLON, JLEV, JBLK)+ZDIFCVPPV (JLON, JLEV, JBLK)
          ENDDO

        ENDDO

      ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LEDKF) THEN

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDMF_PHYS_OUT_DIFTQ (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
            & (JLON, JLEV, JBLK)+ZEDMFQ (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_DIFTS (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
            & (JLON, JLEV, JBLK)+ZEDMFS (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU&
            & (JLON, JLEV, JBLK)+ZEDMFU (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV&
            & (JLON, JLEV, JBLK)+ZEDMFV (JLON, JLEV, JBLK)
          ENDDO

        ENDDO

      ENDIF

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:DIFTQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPQ => GET_HOST_DATA_RDWR (YL_ZDIFCVPPQ)
    ZDIFCVPPS => GET_HOST_DATA_RDWR (YL_ZDIFCVPPS)
    ZDIFCVPPU => GET_HOST_DATA_RDWR (YL_ZDIFCVPPU)
    ZDIFCVPPV => GET_HOST_DATA_RDWR (YL_ZDIFCVPPV)
    ZEDMFQ => GET_HOST_DATA_RDWR (YL_ZEDMFQ)
    ZEDMFS => GET_HOST_DATA_RDWR (YL_ZEDMFS)
    ZEDMFU => GET_HOST_DATA_RDWR (YL_ZEDMFU)
    ZEDMFV => GET_HOST_DATA_RDWR (YL_ZEDMFV)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZDIFCVPPQ => NULL ()
  ZDIFCVPPS => NULL ()
  ZDIFCVPPU => NULL ()
  ZDIFCVPPV => NULL ()
  ZEDMFQ => NULL ()
  ZEDMFS => NULL ()
  ZEDMFU => NULL ()
  ZEDMFV => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:DIFTQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZDIFCVPPQ => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPQ)
  ZDIFCVPPS => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPS)
  ZDIFCVPPU => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPU)
  ZDIFCVPPV => GET_HOST_DATA_RDONLY (YL_ZDIFCVPPV)
  ZEDMFQ => GET_HOST_DATA_RDONLY (YL_ZEDMFQ)
  ZEDMFS => GET_HOST_DATA_RDONLY (YL_ZEDMFS)
  ZEDMFU => GET_HOST_DATA_RDONLY (YL_ZEDMFU)
  ZEDMFV => GET_HOST_DATA_RDONLY (YL_ZEDMFV)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF.OR.(YDMODEL%YRML_PHY_MF%YRPHY&
        &%LEDKF.AND..NOT.YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI)) THEN

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF) THEN

          DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
            
            Z_YDMF_PHYS_OUT_DIFTQ (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
            & (JLON, JLEV, JBLK)+ZDIFCVPPQ (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_DIFTS (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
            & (JLON, JLEV, JBLK)+ZDIFCVPPS (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU&
            & (JLON, JLEV, JBLK)+ZDIFCVPPU (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV&
            & (JLON, JLEV, JBLK)+ZDIFCVPPV (JLON, JLEV, JBLK)
          
          ENDDO

        ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LEDKF) THEN

          DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
            
            Z_YDMF_PHYS_OUT_DIFTQ (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
            & (JLON, JLEV, JBLK)+ZEDMFQ (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_DIFTS (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
            & (JLON, JLEV, JBLK)+ZEDMFS (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU&
            & (JLON, JLEV, JBLK)+ZEDMFU (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV&
            & (JLON, JLEV, JBLK)+ZEDMFV (JLON, JLEV, JBLK)
          
          ENDDO

        ENDIF

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:DIFTQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPQ => GET_HOST_DATA_RDWR (YL_ZDIFCVPPQ)
    ZDIFCVPPS => GET_HOST_DATA_RDWR (YL_ZDIFCVPPS)
    ZDIFCVPPU => GET_HOST_DATA_RDWR (YL_ZDIFCVPPU)
    ZDIFCVPPV => GET_HOST_DATA_RDWR (YL_ZDIFCVPPV)
    ZEDMFQ => GET_HOST_DATA_RDWR (YL_ZEDMFQ)
    ZEDMFS => GET_HOST_DATA_RDWR (YL_ZEDMFS)
    ZEDMFU => GET_HOST_DATA_RDWR (YL_ZEDMFU)
    ZEDMFV => GET_HOST_DATA_RDWR (YL_ZEDMFV)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZDIFCVPPQ => NULL ()
  ZDIFCVPPS => NULL ()
  ZDIFCVPPU => NULL ()
  ZDIFCVPPV => NULL ()
  ZEDMFQ => NULL ()
  ZEDMFS => NULL ()
  ZEDMFU => NULL ()
  ZEDMFV => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:DIFTQ')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZDIFCVPPQ => GET_DEVICE_DATA_RDONLY (YL_ZDIFCVPPQ)
  ZDIFCVPPS => GET_DEVICE_DATA_RDONLY (YL_ZDIFCVPPS)
  ZDIFCVPPU => GET_DEVICE_DATA_RDONLY (YL_ZDIFCVPPU)
  ZDIFCVPPV => GET_DEVICE_DATA_RDONLY (YL_ZDIFCVPPV)
  ZEDMFQ => GET_DEVICE_DATA_RDONLY (YL_ZEDMFQ)
  ZEDMFS => GET_DEVICE_DATA_RDONLY (YL_ZEDMFS)
  ZEDMFU => GET_DEVICE_DATA_RDONLY (YL_ZEDMFU)
  ZEDMFV => GET_DEVICE_DATA_RDONLY (YL_ZEDMFV)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
  Z_YDMF_PHYS_OUT_STRTU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
  Z_YDMF_PHYS_OUT_STRTV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZDIFCVPPQ, ZDIFCVPPS, &
    !$ACC&         ZDIFCVPPU, ZDIFCVPPV, ZEDMFQ, ZEDMFS, ZEDMFU, ZEDMFV, Z_YDMF_PHYS_OUT_DIFTQ, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFTS, Z_YDMF_PHYS_OUT_STRTU, Z_YDMF_PHYS_OUT_STRTV) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF.OR.(YDMODEL%YRML_PHY_MF%YRPHY&
        &%LEDKF.AND..NOT.YDMODEL%YRML_PHY_MF%YRPHY%LEDMFI)) THEN

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF) THEN

          DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
            
            Z_YDMF_PHYS_OUT_DIFTQ (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
            & (JLON, JLEV, JBLK)+ZDIFCVPPQ (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_DIFTS (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
            & (JLON, JLEV, JBLK)+ZDIFCVPPS (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU&
            & (JLON, JLEV, JBLK)+ZDIFCVPPU (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV&
            & (JLON, JLEV, JBLK)+ZDIFCVPPV (JLON, JLEV, JBLK)
          
          ENDDO

        ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LEDKF) THEN

          DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
            
            Z_YDMF_PHYS_OUT_DIFTQ (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQ&
            & (JLON, JLEV, JBLK)+ZEDMFQ (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_DIFTS (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTS&
            & (JLON, JLEV, JBLK)+ZEDMFS (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU&
            & (JLON, JLEV, JBLK)+ZEDMFU (JLON, JLEV, JBLK)
            Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV&
            & (JLON, JLEV, JBLK)+ZEDMFV (JLON, JLEV, JBLK)
          
          ENDDO

        ENDIF

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:DIFTQ')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZDIFCVPPQ => GET_HOST_DATA_RDWR (YL_ZDIFCVPPQ)
    ZDIFCVPPS => GET_HOST_DATA_RDWR (YL_ZDIFCVPPS)
    ZDIFCVPPU => GET_HOST_DATA_RDWR (YL_ZDIFCVPPU)
    ZDIFCVPPV => GET_HOST_DATA_RDWR (YL_ZDIFCVPPV)
    ZEDMFQ => GET_HOST_DATA_RDWR (YL_ZEDMFQ)
    ZEDMFS => GET_HOST_DATA_RDWR (YL_ZEDMFS)
    ZEDMFU => GET_HOST_DATA_RDWR (YL_ZEDMFU)
    ZEDMFV => GET_HOST_DATA_RDWR (YL_ZEDMFV)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTS)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRTV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZDIFCVPPQ => NULL ()
  ZDIFCVPPS => NULL ()
  ZDIFCVPPU => NULL ()
  ZDIFCVPPV => NULL ()
  ZEDMFQ => NULL ()
  ZEDMFS => NULL ()
  ZEDMFU => NULL ()
  ZEDMFV => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTS => NULL ()
  Z_YDMF_PHYS_OUT_STRTU => NULL ()
  Z_YDMF_PHYS_OUT_STRTV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:DIFTQ',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:FRSOPT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_EMIS => GET_HOST_DATA_RDONLY (YL_ZFLU_EMIS)
  ZRDG_MU0 => GET_HOST_DATA_RDONLY (YL_ZRDG_MU0)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
  Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

      IF (.NOT.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE)  THEN
        Z_YDMF_PHYS_OUT_FRTHDS (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRTH (JLON, YDCPG_OPTS%KFLEVG, 1, JBLK)/ZFLU_EMIS&
        & (JLON, JBLK)+YDMODEL%YRCST%RSIGMA*Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)**4
      ENDIF


      IF (ZRDG_MU0 (JLON, JBLK)<=0.0_JPRB) THEN
        Z_YDMF_PHYS_OUT_FRSOPT (JLON, JBLK)=0.0_JPRB
      ELSE
        Z_YDMF_PHYS_OUT_FRSOPT (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRDG_MU0 (JLON, JBLK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:FRSOPT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_EMIS => NULL ()
  ZRDG_MU0 => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_FRSOPT => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:FRSOPT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_EMIS => GET_HOST_DATA_RDONLY (YL_ZFLU_EMIS)
  ZRDG_MU0 => GET_HOST_DATA_RDONLY (YL_ZRDG_MU0)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
  Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      

      IF (.NOT.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE)  THEN
        Z_YDMF_PHYS_OUT_FRTHDS (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRTH (JLON, YDCPG_OPTS%KFLEVG, 1, JBLK)/ZFLU_EMIS&
        & (JLON, JBLK)+YDMODEL%YRCST%RSIGMA*Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)**4
      ENDIF


      IF (ZRDG_MU0 (JLON, JBLK)<=0.0_JPRB) THEN
        Z_YDMF_PHYS_OUT_FRSOPT (JLON, JBLK)=0.0_JPRB
      ELSE
        Z_YDMF_PHYS_OUT_FRSOPT (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRDG_MU0 (JLON, JBLK)
      ENDIF

    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:FRSOPT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_EMIS => NULL ()
  ZRDG_MU0 => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_FRSOPT => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:FRSOPT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_EMIS => GET_DEVICE_DATA_RDONLY (YL_ZFLU_EMIS)
  ZRDG_MU0 => GET_DEVICE_DATA_RDONLY (YL_ZRDG_MU0)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_FRSOPT => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
  Z_YDMF_PHYS_OUT_FRTH => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FRTH)
  Z_YDMF_PHYS_OUT_FRTHDS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZFLU_EMIS, ZRDG_MU0, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_FRSOPT, &
    !$ACC&         Z_YDMF_PHYS_OUT_FRTH, Z_YDMF_PHYS_OUT_FRTHDS) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      

      IF (.NOT.YDMODEL%YRML_PHY_MF%YRARPHY%LMSE)  THEN
        Z_YDMF_PHYS_OUT_FRTHDS (JLON, JBLK)=Z_YDMF_PHYS_OUT_FRTH (JLON, YDCPG_OPTS%KFLEVG, 1, JBLK)/ZFLU_EMIS&
        & (JLON, JBLK)+YDMODEL%YRCST%RSIGMA*Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T (JLON, JBLK)**4
      ENDIF


      IF (ZRDG_MU0 (JLON, JBLK)<=0.0_JPRB) THEN
        Z_YDMF_PHYS_OUT_FRSOPT (JLON, JBLK)=0.0_JPRB
      ELSE
        Z_YDMF_PHYS_OUT_FRSOPT (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY3%RII0*ZRDG_MU0 (JLON, JBLK)
      ENDIF

    
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:FRSOPT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZRDG_MU0 => GET_HOST_DATA_RDWR (YL_ZRDG_MU0)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_FRSOPT => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRSOPT)
    Z_YDMF_PHYS_OUT_FRTH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTH)
    Z_YDMF_PHYS_OUT_FRTHDS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRTHDS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLU_EMIS => NULL ()
  ZRDG_MU0 => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_FRSOPT => NULL ()
  Z_YDMF_PHYS_OUT_FRTH => NULL ()
  Z_YDMF_PHYS_OUT_FRTHDS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:FRSOPT',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACDRAG')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCHROV => GET_HOST_DATA_RDONLY (YL_ZCHROV)
  ZDQSTS => GET_HOST_DATA_RDONLY (YL_ZDQSTS)
  ZFLU_EMIS => GET_HOST_DATA_RDONLY (YL_ZFLU_EMIS)
  ZFLU_NEIJ => GET_HOST_DATA_RDONLY (YL_ZFLU_NEIJ)
  ZGWDCS => GET_HOST_DATA_RDONLY (YL_ZGWDCS)
  ZMSC_QW => GET_HOST_DATA_RDONLY (YL_ZMSC_QW)
  ZNBVNO => GET_HOST_DATA_RDONLY (YL_ZNBVNO)
  ZNEBS => GET_HOST_DATA_RDONLY (YL_ZNEBS)
  ZQLIS => GET_HOST_DATA_RDONLY (YL_ZQLIS)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  ZTRAJGWD => GET_HOST_DATA_RDWR (YL_ZTRAJGWD)
  Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DRNSHF)
  Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
  Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
  Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
  Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_GETRL)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF (YDMODEL%YRML_AOC%YRMCC%LMCC03) THEN
      CALL ACDNSHF (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS&
      &%KFLEVG, ZFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZFLU_NEIJ(:, JBLK&
      &), ZQV(:,:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK&
      &), ZCHROV(:, JBLK), ZDQSTS(:, JBLK), Z_YDMF_PHYS_OUT_DRNSHF(:, JBLK))
    ENDIF

    CALL ACDRAG (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
    &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRAG, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
    &(:,:, JBLK), ZNBVNO(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDVARS_GEOMETRY_RCORI_T0(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PGETRL&
    &(:, JBLK), ZGWDCS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI&
    &(:, JBLK), Z_YDMF_PHYS_OUT_STRDU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDV(:,:, JBLK), ZTRAJGWD(:,:&
    &, JBLK))

    IF (YDMODEL%YRML_PHY_MF%YRPHY%LSTRAS) THEN
      CALL ACPLUIS (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
      &, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:,&
      & JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), ZNEBS(:,:, JBLK), ZQV(:,:, JBLK), ZQLIS&
      &(:,:, JBLK), ZMSC_QW(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:,:, JBLK))
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACDRAG')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
    ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
    ZNEBS => GET_HOST_DATA_RDWR (YL_ZNEBS)
    ZQLIS => GET_HOST_DATA_RDWR (YL_ZQLIS)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZTRAJGWD => GET_HOST_DATA_RDWR (YL_ZTRAJGWD)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DRNSHF)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_GETRL)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCHROV => NULL ()
  ZDQSTS => NULL ()
  ZFLU_EMIS => NULL ()
  ZFLU_NEIJ => NULL ()
  ZGWDCS => NULL ()
  ZMSC_QW => NULL ()
  ZNBVNO => NULL ()
  ZNEBS => NULL ()
  ZQLIS => NULL ()
  ZQV => NULL ()
  ZTRAJGWD => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_DRNSHF => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  Z_YDMF_PHYS_OUT_STRDU => NULL ()
  Z_YDMF_PHYS_OUT_STRDV => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACDRAG')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCHROV => GET_HOST_DATA_RDONLY (YL_ZCHROV)
  ZDQSTS => GET_HOST_DATA_RDONLY (YL_ZDQSTS)
  ZFLU_EMIS => GET_HOST_DATA_RDONLY (YL_ZFLU_EMIS)
  ZFLU_NEIJ => GET_HOST_DATA_RDONLY (YL_ZFLU_NEIJ)
  ZGWDCS => GET_HOST_DATA_RDONLY (YL_ZGWDCS)
  ZMSC_QW => GET_HOST_DATA_RDONLY (YL_ZMSC_QW)
  ZNBVNO => GET_HOST_DATA_RDONLY (YL_ZNBVNO)
  ZNEBS => GET_HOST_DATA_RDONLY (YL_ZNEBS)
  ZQLIS => GET_HOST_DATA_RDONLY (YL_ZQLIS)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  ZTRAJGWD => GET_HOST_DATA_RDWR (YL_ZTRAJGWD)
  Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DRNSHF)
  Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
  Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
  Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
  Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_GETRL)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (YDMODEL%YRML_AOC%YRMCC%LMCC03) THEN
        CALL ACDNSHF_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG&
        &, ZFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZFLU_NEIJ(:, JBLK), ZQV(:&
        &,:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), ZCHROV&
        &(:, JBLK), ZDQSTS(:, JBLK), Z_YDMF_PHYS_OUT_DRNSHF(:, JBLK),YDSTACK=YLSTACK)
      ENDIF

      CALL ACDRAG_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRAG, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), ZNBVNO(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDVARS_GEOMETRY_RCORI_T0(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PGETRL&
      &(:, JBLK), ZGWDCS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI&
      &(:, JBLK), Z_YDMF_PHYS_OUT_STRDU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDV(:,:, JBLK), ZTRAJGWD(:,:, JBLK&
      &),YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LSTRAS) THEN
        CALL ACPLUIS_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), ZNEBS(:,:, JBLK), ZQV(:,:&
        &, JBLK), ZQLIS(:,:, JBLK), ZMSC_QW(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK&
        &), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN&
        &(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACDRAG')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
    ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
    ZNEBS => GET_HOST_DATA_RDWR (YL_ZNEBS)
    ZQLIS => GET_HOST_DATA_RDWR (YL_ZQLIS)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZTRAJGWD => GET_HOST_DATA_RDWR (YL_ZTRAJGWD)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DRNSHF)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_GETRL)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCHROV => NULL ()
  ZDQSTS => NULL ()
  ZFLU_EMIS => NULL ()
  ZFLU_NEIJ => NULL ()
  ZGWDCS => NULL ()
  ZMSC_QW => NULL ()
  ZNBVNO => NULL ()
  ZNEBS => NULL ()
  ZQLIS => NULL ()
  ZQV => NULL ()
  ZTRAJGWD => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_DRNSHF => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  Z_YDMF_PHYS_OUT_STRDU => NULL ()
  Z_YDMF_PHYS_OUT_STRDV => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACDRAG')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZCHROV => GET_DEVICE_DATA_RDONLY (YL_ZCHROV)
  ZDQSTS => GET_DEVICE_DATA_RDONLY (YL_ZDQSTS)
  ZFLU_EMIS => GET_DEVICE_DATA_RDONLY (YL_ZFLU_EMIS)
  ZFLU_NEIJ => GET_DEVICE_DATA_RDONLY (YL_ZFLU_NEIJ)
  ZGWDCS => GET_DEVICE_DATA_RDONLY (YL_ZGWDCS)
  ZMSC_QW => GET_DEVICE_DATA_RDONLY (YL_ZMSC_QW)
  ZNBVNO => GET_DEVICE_DATA_RDONLY (YL_ZNBVNO)
  ZNEBS => GET_DEVICE_DATA_RDONLY (YL_ZNEBS)
  ZQLIS => GET_DEVICE_DATA_RDONLY (YL_ZQLIS)
  ZQV => GET_DEVICE_DATA_RDONLY (YL_ZQV)
  ZTRAJGWD => GET_DEVICE_DATA_RDWR (YL_ZTRAJGWD)
  Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_DRNSHF => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DRNSHF)
  Z_YDMF_PHYS_OUT_FCSQL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
  Z_YDMF_PHYS_OUT_STRDU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
  Z_YDMF_PHYS_OUT_STRDV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
  Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_GETRL)
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_LSM)
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
  Z_YDVARS_GEOMETRY_RCORI_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RCORI%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZCHROV, ZDQSTS, ZFLU_EMIS, &
    !$ACC&         ZFLU_NEIJ, ZGWDCS, ZMSC_QW, ZNBVNO, ZNEBS, ZQLIS, ZQV, ZTRAJGWD, Z_YDCPG_MISC_QS, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, &
    !$ACC&         Z_YDMF_PHYS_OUT_DRNSHF, Z_YDMF_PHYS_OUT_FCSQL, Z_YDMF_PHYS_OUT_FCSQN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPEVPSL, Z_YDMF_PHYS_OUT_FPEVPSN, Z_YDMF_PHYS_OUT_FPFPSL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPFPSN, Z_YDMF_PHYS_OUT_FPLSL, Z_YDMF_PHYS_OUT_FPLSN, &
    !$ACC&         Z_YDMF_PHYS_OUT_STRDU, Z_YDMF_PHYS_OUT_STRDV, Z_YDMF_PHYS_SURF_GSD_VF_PGETRL, &
    !$ACC&         Z_YDMF_PHYS_SURF_GSD_VF_PLSM, Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN, &
    !$ACC&         Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI, Z_YDVARS_GEOMETRY_RCORI_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (YDMODEL%YRML_AOC%YRMCC%LMCC03) THEN
        CALL ACDNSHF_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY1&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG&
        &, ZFLU_EMIS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PLSM(:, JBLK), ZFLU_NEIJ(:, JBLK), ZQV(:&
        &,:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), ZCHROV&
        &(:, JBLK), ZDQSTS(:, JBLK), Z_YDMF_PHYS_OUT_DRNSHF(:, JBLK),YDSTACK=YLSTACK)
      ENDIF

      CALL ACDRAG_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRAG, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), ZNBVNO(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDVARS_GEOMETRY_RCORI_T0(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PGETRL&
      &(:, JBLK), ZGWDCS(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI&
      &(:, JBLK), Z_YDMF_PHYS_OUT_STRDU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRDV(:,:, JBLK), ZTRAJGWD(:,:, JBLK&
      &),YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LSTRAS) THEN
        CALL ACPLUIS_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), ZNEBS(:,:, JBLK), ZQV(:,:&
        &, JBLK), ZQLIS(:,:, JBLK), ZMSC_QW(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK&
        &), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN&
        &(:,:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACDRAG')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZCHROV => GET_HOST_DATA_RDWR (YL_ZCHROV)
    ZDQSTS => GET_HOST_DATA_RDWR (YL_ZDQSTS)
    ZFLU_EMIS => GET_HOST_DATA_RDWR (YL_ZFLU_EMIS)
    ZFLU_NEIJ => GET_HOST_DATA_RDWR (YL_ZFLU_NEIJ)
    ZGWDCS => GET_HOST_DATA_RDWR (YL_ZGWDCS)
    ZMSC_QW => GET_HOST_DATA_RDWR (YL_ZMSC_QW)
    ZNBVNO => GET_HOST_DATA_RDWR (YL_ZNBVNO)
    ZNEBS => GET_HOST_DATA_RDWR (YL_ZNEBS)
    ZQLIS => GET_HOST_DATA_RDWR (YL_ZQLIS)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZTRAJGWD => GET_HOST_DATA_RDWR (YL_ZTRAJGWD)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_DRNSHF => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DRNSHF)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRDV)
    Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_GETRL)
    Z_YDMF_PHYS_SURF_GSD_VF_PLSM => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_LSM)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VRLAN)
    Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VF%F_VRLDI)
    Z_YDVARS_GEOMETRY_RCORI_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCORI%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZCHROV => NULL ()
  ZDQSTS => NULL ()
  ZFLU_EMIS => NULL ()
  ZFLU_NEIJ => NULL ()
  ZGWDCS => NULL ()
  ZMSC_QW => NULL ()
  ZNBVNO => NULL ()
  ZNEBS => NULL ()
  ZQLIS => NULL ()
  ZQV => NULL ()
  ZTRAJGWD => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_DRNSHF => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  Z_YDMF_PHYS_OUT_STRDU => NULL ()
  Z_YDMF_PHYS_OUT_STRDV => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PGETRL => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PLSM => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLAN => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VF_PVRLDI => NULL ()
  Z_YDVARS_GEOMETRY_RCORI_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRAG',1,ZHOOK_HANDLE_PARALLEL)

IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVTDK) THEN
  CALL APL_ARPEGE_DEEP_CONVECTION_PARALLEL (YDMF_PHYS_BASE_STATE, YDGEOMETRY, YDCPG_BNDS&
  &, YDCPG_OPTS, YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_ZFPCOR&
  &, YL_ZQV, YL_ZTENHA, YL_ZTENQVA, YL_ZTENT, YL_ZRDG_CVGQ, YL_ZRDG_CVGT)
ENDIF


IF (YDMODEL%YRML_PHY_MF%YRPHY%LECTPRODCVP) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:TURBULENCE_PART2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZECTCLS => GET_HOST_DATA_RDONLY (YL_ZECTCLS)
    ZKCLS => GET_HOST_DATA_RDONLY (YL_ZKCLS)
    ZKUROV2 => GET_HOST_DATA_RDWR (YL_ZKUROV2)
    ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
    ZPRODTH => GET_HOST_DATA_RDWR (YL_ZPRODTH)
    ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
    ZUSLE => GET_HOST_DATA_RDONLY (YL_ZUSLE)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL APL_ARPEGE_TURBULENCE_PART2 (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOET, YDCPG_OPTS&
      &%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,&
      &:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK&
      &), Z_YDMF_PHYS_BASE_STATE_Q(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_TKE(:,:, JBLK), ZPRODTH(:,:, JBLK), ZKUROV2(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV&
      &(:,:, JBLK), ZUSLE(:,:, JBLK), ZKCLS(:, JBLK), ZECTCLS(:, JBLK), ZPFL_FTKE(:,:, JBLK), ZTKE1(:,:&
      &, JBLK), Z_YDMF_PHYS_OUT_EDR(:,:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZECTCLS => GET_HOST_DATA_RDWR (YL_ZECTCLS)
      ZKCLS => GET_HOST_DATA_RDWR (YL_ZKCLS)
      ZKUROV2 => GET_HOST_DATA_RDWR (YL_ZKUROV2)
      ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
      ZPRODTH => GET_HOST_DATA_RDWR (YL_ZPRODTH)
      ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
      ZUSLE => GET_HOST_DATA_RDWR (YL_ZUSLE)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
      Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
      Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
      Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
      Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZECTCLS => NULL ()
    ZKCLS => NULL ()
    ZKUROV2 => NULL ()
    ZPFL_FTKE => NULL ()
    ZPRODTH => NULL ()
    ZTKE1 => NULL ()
    ZUSLE => NULL ()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_TKE => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
    Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFCS => NULL ()
    Z_YDMF_PHYS_OUT_EDR => NULL ()
    Z_YDMF_PHYS_OUT_STRCU => NULL ()
    Z_YDMF_PHYS_OUT_STRCV => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
    &','APL_ARPEGE_PARALLEL:TURBULENCE_PART2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZECTCLS => GET_HOST_DATA_RDONLY (YL_ZECTCLS)
    ZKCLS => GET_HOST_DATA_RDONLY (YL_ZKCLS)
    ZKUROV2 => GET_HOST_DATA_RDWR (YL_ZKUROV2)
    ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
    ZPRODTH => GET_HOST_DATA_RDWR (YL_ZPRODTH)
    ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
    ZUSLE => GET_HOST_DATA_RDONLY (YL_ZUSLE)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL APL_ARPEGE_TURBULENCE_PART2_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOET, YDCPG_OPTS&
        &%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,&
        & JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK&
        &), Z_YDMF_PHYS_BASE_STATE_Q(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_TKE(:,:, JBLK), ZPRODTH(:,:, JBLK), ZKUROV2(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV&
        &(:,:, JBLK), ZUSLE(:,:, JBLK), ZKCLS(:, JBLK), ZECTCLS(:, JBLK), ZPFL_FTKE(:,:, JBLK), ZTKE1(:,:, JBLK&
        &), Z_YDMF_PHYS_OUT_EDR(:,:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZECTCLS => GET_HOST_DATA_RDWR (YL_ZECTCLS)
      ZKCLS => GET_HOST_DATA_RDWR (YL_ZKCLS)
      ZKUROV2 => GET_HOST_DATA_RDWR (YL_ZKUROV2)
      ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
      ZPRODTH => GET_HOST_DATA_RDWR (YL_ZPRODTH)
      ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
      ZUSLE => GET_HOST_DATA_RDWR (YL_ZUSLE)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
      Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
      Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
      Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
      Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZECTCLS => NULL ()
    ZKCLS => NULL ()
    ZKUROV2 => NULL ()
    ZPFL_FTKE => NULL ()
    ZPRODTH => NULL ()
    ZTKE1 => NULL ()
    ZUSLE => NULL ()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_TKE => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
    Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFCS => NULL ()
    Z_YDMF_PHYS_OUT_EDR => NULL ()
    Z_YDMF_PHYS_OUT_STRCU => NULL ()
    Z_YDMF_PHYS_OUT_STRCV => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
    &','APL_ARPEGE_PARALLEL:TURBULENCE_PART2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZECTCLS => GET_DEVICE_DATA_RDONLY (YL_ZECTCLS)
    ZKCLS => GET_DEVICE_DATA_RDONLY (YL_ZKCLS)
    ZKUROV2 => GET_DEVICE_DATA_RDWR (YL_ZKUROV2)
    ZPFL_FTKE => GET_DEVICE_DATA_RDWR (YL_ZPFL_FTKE)
    ZPRODTH => GET_DEVICE_DATA_RDWR (YL_ZPRODTH)
    ZTKE1 => GET_DEVICE_DATA_RDWR (YL_ZTKE1)
    ZUSLE => GET_DEVICE_DATA_RDONLY (YL_ZUSLE)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_TKE => GET_DEVICE_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCS)
    Z_YDMF_PHYS_OUT_EDR => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_OUT_STRCU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_STRCV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZECTCLS, ZKCLS, ZKUROV2, &
      !$ACC&         ZPFL_FTKE, ZPRODTH, ZTKE1, ZUSLE, Z_YDMF_PHYS_BASE_STATE_Q, Z_YDMF_PHYS_BASE_STATE_T, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_TKE, Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_OUT_DIFCQ, &
      !$ACC&         Z_YDMF_PHYS_OUT_DIFCS, Z_YDMF_PHYS_OUT_EDR, Z_YDMF_PHYS_OUT_STRCU, &
      !$ACC&         Z_YDMF_PHYS_OUT_STRCV) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL APL_ARPEGE_TURBULENCE_PART2_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOET, YDCPG_OPTS&
        &%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,&
        & JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK&
        &), Z_YDMF_PHYS_BASE_STATE_Q(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_TKE(:,:, JBLK), ZPRODTH(:,:, JBLK), ZKUROV2(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
        &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCS(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRCV&
        &(:,:, JBLK), ZUSLE(:,:, JBLK), ZKCLS(:, JBLK), ZECTCLS(:, JBLK), ZPFL_FTKE(:,:, JBLK), ZTKE1(:,:, JBLK&
        &), Z_YDMF_PHYS_OUT_EDR(:,:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZECTCLS => GET_HOST_DATA_RDWR (YL_ZECTCLS)
      ZKCLS => GET_HOST_DATA_RDWR (YL_ZKCLS)
      ZKUROV2 => GET_HOST_DATA_RDWR (YL_ZKUROV2)
      ZPFL_FTKE => GET_HOST_DATA_RDWR (YL_ZPFL_FTKE)
      ZPRODTH => GET_HOST_DATA_RDWR (YL_ZPRODTH)
      ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
      ZUSLE => GET_HOST_DATA_RDWR (YL_ZUSLE)
      Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
      Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
      Z_YDMF_PHYS_OUT_DIFCS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCS)
      Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
      Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCU)
      Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRCV)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZECTCLS => NULL ()
    ZKCLS => NULL ()
    ZKUROV2 => NULL ()
    ZPFL_FTKE => NULL ()
    ZPRODTH => NULL ()
    ZTKE1 => NULL ()
    ZUSLE => NULL ()
    Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_TKE => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
    Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
    Z_YDMF_PHYS_OUT_DIFCS => NULL ()
    Z_YDMF_PHYS_OUT_EDR => NULL ()
    Z_YDMF_PHYS_OUT_STRCU => NULL ()
    Z_YDMF_PHYS_OUT_STRCV => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:TURBULENCE_PART2',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

CALL APL_ARPEGE_PRECIPITATION_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS&
&, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YL_ZFLU_NEIJ, YL_ZNEBS, YL_ZNEB_CVPP&
&, YL_ZQC_DET_PCMT, YL_ZQI, YL_ZQL, YL_ZQLIS, YL_ZQLI_CVPP, YL_ZQR, YL_ZQS, YL_ZQV&
&, YL_ZSEDIQI, YL_ZSEDIQL, YL_ZTENHA, YL_ZTENQVA, YDGEOMETRY%YRSTA)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:QNGCOR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWU)
  ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWV)
  ZFPCOR => GET_HOST_DATA_RDONLY (YL_ZFPCOR)
  ZFPLSL => GET_HOST_DATA_RDWR (YL_ZFPLSL)
  ZFPLSN => GET_HOST_DATA_RDWR (YL_ZFPLSN)
  ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
  ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
  ZQI => GET_HOST_DATA_RDONLY (YL_ZQI)
  ZQL => GET_HOST_DATA_RDONLY (YL_ZQL)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  ZSEDIQI => GET_HOST_DATA_RDONLY (YL_ZSEDIQI)
  ZSEDIQL => GET_HOST_DATA_RDONLY (YL_ZSEDIQL)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQL)
  Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQN)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSG)
  Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=0, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZFLX_LOTT_GWU (JLON, JLEV, JBLK)=0.0_JPRB
        ZFLX_LOTT_GWV (JLON, JLEV, JBLK)=0.0_JPRB
      ENDDO

    ENDDO


    IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

      DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZPFL_FPLCH (JLON, JLEV, JBLK)=ZFPCOR (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF


    IF (YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

      DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZPFL_FPLSH (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLSL (JLON, JLEV, JBLK)+Z_YDMF_PHYS_OUT_FPLSN&
          & (JLON, JLEV, JBLK)+Z_YDMF_PHYS_OUT_FPLSG (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF


    DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_OUT_DIFTQL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQL&
        & (JLON, JLEV, JBLK)+ZSEDIQL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_DIFTQN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQN&
        & (JLON, JLEV, JBLK)+ZSEDIQI (JLON, JLEV, JBLK)
        ZFPLSL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQL (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLSL (JLON, JLEV, JBLK)
        ZFPLSN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQN (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLSN (JLON, JLEV, JBLK)
      ENDDO

    ENDDO

    CALL QNGCOR (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
    &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, ZQV(:,:, JBLK), ZQL(:,:, JBLK), ZQI&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ(:,:,&
    & JBLK), Z_YDMF_PHYS_OUT_DIFCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQN&
    &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNG&
    &(:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:QNGCOR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWU)
    ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWV)
    ZFPCOR => GET_HOST_DATA_RDWR (YL_ZFPCOR)
    ZFPLSL => GET_HOST_DATA_RDWR (YL_ZFPLSL)
    ZFPLSN => GET_HOST_DATA_RDWR (YL_ZFPLSN)
    ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
    ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
    ZQI => GET_HOST_DATA_RDWR (YL_ZQI)
    ZQL => GET_HOST_DATA_RDWR (YL_ZQL)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZSEDIQI => GET_HOST_DATA_RDWR (YL_ZSEDIQI)
    ZSEDIQL => GET_HOST_DATA_RDWR (YL_ZSEDIQL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSG)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLX_LOTT_GWU => NULL ()
  ZFLX_LOTT_GWV => NULL ()
  ZFPCOR => NULL ()
  ZFPLSL => NULL ()
  ZFPLSN => NULL ()
  ZPFL_FPLCH => NULL ()
  ZPFL_FPLSH => NULL ()
  ZQI => NULL ()
  ZQL => NULL ()
  ZQV => NULL ()
  ZSEDIQI => NULL ()
  ZSEDIQL => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSG => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:QNGCOR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWU)
  ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWV)
  ZFPCOR => GET_HOST_DATA_RDONLY (YL_ZFPCOR)
  ZFPLSL => GET_HOST_DATA_RDWR (YL_ZFPLSL)
  ZFPLSN => GET_HOST_DATA_RDWR (YL_ZFPLSN)
  ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
  ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
  ZQI => GET_HOST_DATA_RDONLY (YL_ZQI)
  ZQL => GET_HOST_DATA_RDONLY (YL_ZQL)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  ZSEDIQI => GET_HOST_DATA_RDONLY (YL_ZSEDIQI)
  ZSEDIQL => GET_HOST_DATA_RDONLY (YL_ZSEDIQL)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQL)
  Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQN)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSG)
  Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        ZFLX_LOTT_GWU (JLON, JLEV, JBLK)=0.0_JPRB
        ZFLX_LOTT_GWV (JLON, JLEV, JBLK)=0.0_JPRB
      
      ENDDO


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          ZPFL_FPLCH (JLON, JLEV, JBLK)=ZFPCOR (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          ZPFL_FPLSH (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLSL (JLON, JLEV, JBLK)+Z_YDMF_PHYS_OUT_FPLSN&
          & (JLON, JLEV, JBLK)+Z_YDMF_PHYS_OUT_FPLSG (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        Z_YDMF_PHYS_OUT_DIFTQL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQL&
        & (JLON, JLEV, JBLK)+ZSEDIQL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_DIFTQN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQN&
        & (JLON, JLEV, JBLK)+ZSEDIQI (JLON, JLEV, JBLK)
        ZFPLSL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQL (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLSL (JLON, JLEV, JBLK)
        ZFPLSN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQN (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLSN (JLON, JLEV, JBLK)
      
      ENDDO

      CALL QNGCOR_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, ZQV(:,:, JBLK), ZQL(:,:&
      &, JBLK), ZQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNG&
      &(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:QNGCOR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWU)
    ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWV)
    ZFPCOR => GET_HOST_DATA_RDWR (YL_ZFPCOR)
    ZFPLSL => GET_HOST_DATA_RDWR (YL_ZFPLSL)
    ZFPLSN => GET_HOST_DATA_RDWR (YL_ZFPLSN)
    ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
    ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
    ZQI => GET_HOST_DATA_RDWR (YL_ZQI)
    ZQL => GET_HOST_DATA_RDWR (YL_ZQL)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZSEDIQI => GET_HOST_DATA_RDWR (YL_ZSEDIQI)
    ZSEDIQL => GET_HOST_DATA_RDWR (YL_ZSEDIQL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSG)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLX_LOTT_GWU => NULL ()
  ZFLX_LOTT_GWV => NULL ()
  ZFPCOR => NULL ()
  ZFPLSL => NULL ()
  ZFPLSN => NULL ()
  ZPFL_FPLCH => NULL ()
  ZPFL_FPLSH => NULL ()
  ZQI => NULL ()
  ZQL => NULL ()
  ZQV => NULL ()
  ZSEDIQI => NULL ()
  ZSEDIQL => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSG => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:QNGCOR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZFLX_LOTT_GWU => GET_DEVICE_DATA_RDWR (YL_ZFLX_LOTT_GWU)
  ZFLX_LOTT_GWV => GET_DEVICE_DATA_RDWR (YL_ZFLX_LOTT_GWV)
  ZFPCOR => GET_DEVICE_DATA_RDONLY (YL_ZFPCOR)
  ZFPLSL => GET_DEVICE_DATA_RDWR (YL_ZFPLSL)
  ZFPLSN => GET_DEVICE_DATA_RDWR (YL_ZFPLSN)
  ZPFL_FPLCH => GET_DEVICE_DATA_RDWR (YL_ZPFL_FPLCH)
  ZPFL_FPLSH => GET_DEVICE_DATA_RDWR (YL_ZPFL_FPLSH)
  ZQI => GET_DEVICE_DATA_RDONLY (YL_ZQI)
  ZQL => GET_DEVICE_DATA_RDONLY (YL_ZQL)
  ZQV => GET_DEVICE_DATA_RDONLY (YL_ZQV)
  ZSEDIQI => GET_DEVICE_DATA_RDONLY (YL_ZSEDIQI)
  ZSEDIQL => GET_DEVICE_DATA_RDONLY (YL_ZSEDIQL)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_OUT_DIFCQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQ)
  Z_YDMF_PHYS_OUT_DIFCQL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQL)
  Z_YDMF_PHYS_OUT_DIFCQN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFCQN)
  Z_YDMF_PHYS_OUT_DIFTQ => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_DIFTQ)
  Z_YDMF_PHYS_OUT_DIFTQL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
  Z_YDMF_PHYS_OUT_DIFTQN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
  Z_YDMF_PHYS_OUT_FCCQL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQL)
  Z_YDMF_PHYS_OUT_FCCQN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FCCQN)
  Z_YDMF_PHYS_OUT_FCQNG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCSQL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
  Z_YDMF_PHYS_OUT_FCSQN => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
  Z_YDMF_PHYS_OUT_FPEVPCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCL)
  Z_YDMF_PHYS_OUT_FPEVPCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPCN)
  Z_YDMF_PHYS_OUT_FPEVPSL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSL)
  Z_YDMF_PHYS_OUT_FPEVPSN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPEVPSN)
  Z_YDMF_PHYS_OUT_FPFPCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCL)
  Z_YDMF_PHYS_OUT_FPFPCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPCN)
  Z_YDMF_PHYS_OUT_FPFPSL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSL)
  Z_YDMF_PHYS_OUT_FPFPSN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPFPSN)
  Z_YDMF_PHYS_OUT_FPLSG => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSG)
  Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
  Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZFLX_LOTT_GWU, ZFLX_LOTT_GWV, &
    !$ACC&         ZFPCOR, ZFPLSL, ZFPLSN, ZPFL_FPLCH, ZPFL_FPLSH, ZQI, ZQL, ZQV, ZSEDIQI, &
    !$ACC&         ZSEDIQL, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, Z_YDMF_PHYS_OUT_DIFCQ, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFCQL, Z_YDMF_PHYS_OUT_DIFCQN, Z_YDMF_PHYS_OUT_DIFTQ, &
    !$ACC&         Z_YDMF_PHYS_OUT_DIFTQL, Z_YDMF_PHYS_OUT_DIFTQN, Z_YDMF_PHYS_OUT_FCCQL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCCQN, Z_YDMF_PHYS_OUT_FCQNG, Z_YDMF_PHYS_OUT_FCSQL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCSQN, Z_YDMF_PHYS_OUT_FPEVPCL, Z_YDMF_PHYS_OUT_FPEVPCN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPEVPSL, Z_YDMF_PHYS_OUT_FPEVPSN, Z_YDMF_PHYS_OUT_FPFPCL, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPFPCN, Z_YDMF_PHYS_OUT_FPFPSL, Z_YDMF_PHYS_OUT_FPFPSN, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPLSG, Z_YDMF_PHYS_OUT_FPLSL, Z_YDMF_PHYS_OUT_FPLSN) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      DO JLEV=0, YDCPG_OPTS%KFLEVG
        
        ZFLX_LOTT_GWU (JLON, JLEV, JBLK)=0.0_JPRB
        ZFLX_LOTT_GWV (JLON, JLEV, JBLK)=0.0_JPRB
      
      ENDDO


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          ZPFL_FPLCH (JLON, JLEV, JBLK)=ZFPCOR (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          ZPFL_FPLSH (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FPLSL (JLON, JLEV, JBLK)+Z_YDMF_PHYS_OUT_FPLSN&
          & (JLON, JLEV, JBLK)+Z_YDMF_PHYS_OUT_FPLSG (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        Z_YDMF_PHYS_OUT_DIFTQL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQL&
        & (JLON, JLEV, JBLK)+ZSEDIQL (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_DIFTQN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQN&
        & (JLON, JLEV, JBLK)+ZSEDIQI (JLON, JLEV, JBLK)
        ZFPLSL (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQL (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLSL (JLON, JLEV, JBLK)
        ZFPLSN (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_DIFTQN (JLON, JLEV&
        &, JBLK)+Z_YDMF_PHYS_OUT_FPLSN (JLON, JLEV, JBLK)
      
      ENDDO

      CALL QNGCOR_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY2, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, ZQV(:,:, JBLK), ZQL(:,:&
      &, JBLK), ZQI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQ&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQN(:,:, JBLK), Z_YDMF_PHYS_OUT_DIFTQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPEVPCN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPFPCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCCQN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQL(:,:, JBLK), Z_YDMF_PHYS_OUT_FCSQN(:,:, JBLK), Z_YDMF_PHYS_OUT_FCQNG&
      &(:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:QNGCOR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZFLX_LOTT_GWU => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWU)
    ZFLX_LOTT_GWV => GET_HOST_DATA_RDWR (YL_ZFLX_LOTT_GWV)
    ZFPCOR => GET_HOST_DATA_RDWR (YL_ZFPCOR)
    ZFPLSL => GET_HOST_DATA_RDWR (YL_ZFPLSL)
    ZFPLSN => GET_HOST_DATA_RDWR (YL_ZFPLSN)
    ZPFL_FPLCH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLCH)
    ZPFL_FPLSH => GET_HOST_DATA_RDWR (YL_ZPFL_FPLSH)
    ZQI => GET_HOST_DATA_RDWR (YL_ZQI)
    ZQL => GET_HOST_DATA_RDWR (YL_ZQL)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    ZSEDIQI => GET_HOST_DATA_RDWR (YL_ZSEDIQI)
    ZSEDIQL => GET_HOST_DATA_RDWR (YL_ZSEDIQL)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_OUT_DIFCQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQ)
    Z_YDMF_PHYS_OUT_DIFCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQL)
    Z_YDMF_PHYS_OUT_DIFCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFCQN)
    Z_YDMF_PHYS_OUT_DIFTQ => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQ)
    Z_YDMF_PHYS_OUT_DIFTQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQL)
    Z_YDMF_PHYS_OUT_DIFTQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_DIFTQN)
    Z_YDMF_PHYS_OUT_FCCQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQL)
    Z_YDMF_PHYS_OUT_FCCQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCCQN)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCSQL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQL)
    Z_YDMF_PHYS_OUT_FCSQN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCSQN)
    Z_YDMF_PHYS_OUT_FPEVPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCL)
    Z_YDMF_PHYS_OUT_FPEVPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPCN)
    Z_YDMF_PHYS_OUT_FPEVPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSL)
    Z_YDMF_PHYS_OUT_FPEVPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPEVPSN)
    Z_YDMF_PHYS_OUT_FPFPCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCL)
    Z_YDMF_PHYS_OUT_FPFPCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPCN)
    Z_YDMF_PHYS_OUT_FPFPSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSL)
    Z_YDMF_PHYS_OUT_FPFPSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPFPSN)
    Z_YDMF_PHYS_OUT_FPLSG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSG)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZFLX_LOTT_GWU => NULL ()
  ZFLX_LOTT_GWV => NULL ()
  ZFPCOR => NULL ()
  ZFPLSL => NULL ()
  ZFPLSN => NULL ()
  ZPFL_FPLCH => NULL ()
  ZPFL_FPLSH => NULL ()
  ZQI => NULL ()
  ZQL => NULL ()
  ZQV => NULL ()
  ZSEDIQI => NULL ()
  ZSEDIQL => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFCQN => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQ => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQL => NULL ()
  Z_YDMF_PHYS_OUT_DIFTQN => NULL ()
  Z_YDMF_PHYS_OUT_FCCQL => NULL ()
  Z_YDMF_PHYS_OUT_FCCQN => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCSQL => NULL ()
  Z_YDMF_PHYS_OUT_FCSQN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPEVPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPCN => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSL => NULL ()
  Z_YDMF_PHYS_OUT_FPFPSN => NULL ()
  Z_YDMF_PHYS_OUT_FPLSG => NULL ()
  Z_YDMF_PHYS_OUT_FPLSL => NULL ()
  Z_YDMF_PHYS_OUT_FPLSN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:QNGCOR',1,ZHOOK_HANDLE_PARALLEL)
CALL APL_ARPEGE_HYDRO_BUDGET_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_GPAR,&
& YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, YL_ZC3, YL_ZCN, YL_ZDSA_C1, YL_ZDSA_C2, YL_ZFLU_FEVI, YL_ZFLU_NEIJ&
&, YL_ZFLU_VEG, YL_ZFPLSL, YL_ZFPLSN, YL_ZWFC, YL_ZWLMX, YL_ZWPMX, YL_ZWSEQ, YL_ZWSMX)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACDRME')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_NEB)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
  Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
  Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
  Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR (YDVARS%A%FT1)
  Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%IRAD%FT1)
  Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%LRAD%FT1)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL ACDRME (YDMODEL%YRCST, YDGEOMETRY%YRSTA, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH&
    &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRME, YDCPG_OPTS&
    &%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:&
    &, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_OUT_FRMH(:,:, JBLK), ZMSC_FRMQ(:,:, JBLK&
    &), Z_YDMF_PHYS_OUT_STRMU(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMV(:,:, JBLK))

    IF (YDMODEL%YRML_GCONF%YGFL%YIRAD%LGP) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDVARS_IRAD_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_QICE (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF


    IF (YDMODEL%YRML_GCONF%YGFL%YLRAD%LGP) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDVARS_LRAD_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_QLI (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF


    IF (YDMODEL%YRML_GCONF%YGFL%YA%LGP) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDVARS_A_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACDRME')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
    Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR (YDVARS%A%FT1)
    Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%IRAD%FT1)
    Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%LRAD%FT1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZMSC_FRMQ => NULL ()
  ZQV => NULL ()
  Z_YDCPG_MISC_NEB => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_OUT_FRMH => NULL ()
  Z_YDMF_PHYS_OUT_STRMU => NULL ()
  Z_YDMF_PHYS_OUT_STRMV => NULL ()
  Z_YDVARS_A_T1 => NULL ()
  Z_YDVARS_IRAD_T1 => NULL ()
  Z_YDVARS_LRAD_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACDRME')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
  ZQV => GET_HOST_DATA_RDONLY (YL_ZQV)
  Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_NEB)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
  Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
  Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
  Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR (YDVARS%A%FT1)
  Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%IRAD%FT1)
  Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%LRAD%FT1)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACDRME_OPENACC (YDMODEL%YRCST, YDGEOMETRY%YRSTA, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF&
      &%YRTOPH, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRME, YDCPG_OPTS&
      &%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK&
      &), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_OUT_FRMH(:,:, JBLK), ZMSC_FRMQ(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMV(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_GCONF%YGFL%YIRAD%LGP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          Z_YDVARS_IRAD_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_QICE (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_GCONF%YGFL%YLRAD%LGP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          Z_YDVARS_LRAD_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_QLI (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_GCONF%YGFL%YA%LGP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          Z_YDVARS_A_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACDRME')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
    Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR (YDVARS%A%FT1)
    Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%IRAD%FT1)
    Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%LRAD%FT1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZMSC_FRMQ => NULL ()
  ZQV => NULL ()
  Z_YDCPG_MISC_NEB => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_OUT_FRMH => NULL ()
  Z_YDMF_PHYS_OUT_STRMU => NULL ()
  Z_YDMF_PHYS_OUT_STRMV => NULL ()
  Z_YDVARS_A_T1 => NULL ()
  Z_YDVARS_IRAD_T1 => NULL ()
  Z_YDVARS_LRAD_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACDRME')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZMSC_FRMQ => GET_DEVICE_DATA_RDWR (YL_ZMSC_FRMQ)
  ZQV => GET_DEVICE_DATA_RDONLY (YL_ZQV)
  Z_YDCPG_MISC_NEB => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_NEB)
  Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_OUT_FRMH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
  Z_YDMF_PHYS_OUT_STRMU => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
  Z_YDMF_PHYS_OUT_STRMV => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
  Z_YDVARS_A_T1 => GET_DEVICE_DATA_RDWR (YDVARS%A%FT1)
  Z_YDVARS_IRAD_T1 => GET_DEVICE_DATA_RDWR (YDVARS%IRAD%FT1)
  Z_YDVARS_LRAD_T1 => GET_DEVICE_DATA_RDWR (YDVARS%LRAD%FT1)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDMODEL, YFXTRAN_ACDC_STACK, ZMSC_FRMQ, &
    !$ACC&         ZQV, Z_YDCPG_MISC_NEB, Z_YDCPG_MISC_QICE, Z_YDCPG_MISC_QLI, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, &
    !$ACC&         Z_YDMF_PHYS_OUT_FRMH, Z_YDMF_PHYS_OUT_STRMU, Z_YDMF_PHYS_OUT_STRMV, &
    !$ACC&         Z_YDVARS_A_T1, Z_YDVARS_IRAD_T1, Z_YDVARS_LRAD_T1) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACDRME_OPENACC (YDMODEL%YRCST, YDGEOMETRY%YRSTA, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF&
      &%YRTOPH, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTDRME, YDCPG_OPTS&
      &%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), ZQV(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK&
      &), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_OUT_FRMH(:,:, JBLK), ZMSC_FRMQ(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMU&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_STRMV(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_GCONF%YGFL%YIRAD%LGP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          Z_YDVARS_IRAD_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_QICE (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_GCONF%YGFL%YLRAD%LGP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          Z_YDVARS_LRAD_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_QLI (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_GCONF%YGFL%YA%LGP) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          Z_YDVARS_A_T1 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACDRME')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZMSC_FRMQ => GET_HOST_DATA_RDWR (YL_ZMSC_FRMQ)
    ZQV => GET_HOST_DATA_RDWR (YL_ZQV)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_OUT_FRMH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FRMH)
    Z_YDMF_PHYS_OUT_STRMU => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMU)
    Z_YDMF_PHYS_OUT_STRMV => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_STRMV)
    Z_YDVARS_A_T1 => GET_HOST_DATA_RDWR (YDVARS%A%FT1)
    Z_YDVARS_IRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%IRAD%FT1)
    Z_YDVARS_LRAD_T1 => GET_HOST_DATA_RDWR (YDVARS%LRAD%FT1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZMSC_FRMQ => NULL ()
  ZQV => NULL ()
  Z_YDCPG_MISC_NEB => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_OUT_FRMH => NULL ()
  Z_YDMF_PHYS_OUT_STRMU => NULL ()
  Z_YDMF_PHYS_OUT_STRMV => NULL ()
  Z_YDVARS_A_T1 => NULL ()
  Z_YDVARS_IRAD_T1 => NULL ()
  Z_YDVARS_LRAD_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACDRME',1,ZHOOK_HANDLE_PARALLEL)


IF (YDMODEL%YRML_PHY_MF%YRPHY2%LRAFTKE) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACEVADCAPE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
    ZDCAPE => GET_HOST_DATA_RDWR (YL_ZDCAPE)
    ZTKE1 => GET_HOST_DATA_RDONLY (YL_ZTKE1)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL ACEVADCAPE (YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
      &%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK)&
      &, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
      &(:,:, JBLK), ZDCAPE(:, JBLK))
      CALL ACCLDIA (YDMODEL%YRCST, YDCPG_OPTS%LXCLP, YDCPG_OPTS%LXTGST, YDCPG_OPTS%LXXGST, YDMODEL&
      &%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS&
      &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE&
      &(:, JBLK), ZDCAPE(:, JBLK), ZTKE1(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK&
      &), Z_YDVARS_GEOMETRY_OROG_T0(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST&
      &(:, JBLK), ZBLH(:, JBLK), IMOC_CLPH(:, JBLK))

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)=MIN (YDMODEL%YRML_PHY_MF%YRPHY0%XMAXLM&
        &, MAX (YDMODEL%YRML_PHY_MF%YRPHY0%XMINLM, ZBLH (JLON, JBLK)))
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACEVADCAPE')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
      ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
      ZDCAPE => GET_HOST_DATA_RDWR (YL_ZDCAPE)
      ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
      Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => NULL ()
    ZBLH => NULL ()
    ZDCAPE => NULL ()
    ZTKE1 => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_OUT_CAPE => NULL ()
    Z_YDMF_PHYS_OUT_CLPH => NULL ()
    Z_YDMF_PHYS_OUT_FPLCL => NULL ()
    Z_YDMF_PHYS_OUT_FPLCN => NULL ()
    Z_YDMF_PHYS_OUT_FPLSL => NULL ()
    Z_YDMF_PHYS_OUT_FPLSN => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACEVADCAPE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
    ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
    ZDCAPE => GET_HOST_DATA_RDWR (YL_ZDCAPE)
    ZTKE1 => GET_HOST_DATA_RDONLY (YL_ZTKE1)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACEVADCAPE_OPENACC (YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK&
        &), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK)&
        &, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK)&
        &, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), ZDCAPE(:, JBLK),YDSTACK=YLSTACK)
        CALL ACCLDIA_OPENACC (YDMODEL%YRCST, YDCPG_OPTS%LXCLP, YDCPG_OPTS%LXTGST, YDCPG_OPTS%LXXGST, YDMODEL&
        &%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YLCPG_BNDS%KIDIA,&
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS&
        &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE&
        &(:, JBLK), ZDCAPE(:, JBLK), ZTKE1(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK)&
        &, Z_YDVARS_GEOMETRY_OROG_T0(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK&
        &), ZBLH(:, JBLK), IMOC_CLPH(:, JBLK),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)=MIN (YDMODEL%YRML_PHY_MF%YRPHY0%XMAXLM&
        &, MAX (YDMODEL%YRML_PHY_MF%YRPHY0%XMINLM, ZBLH (JLON, JBLK)))
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACEVADCAPE')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
      ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
      ZDCAPE => GET_HOST_DATA_RDWR (YL_ZDCAPE)
      ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
      Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => NULL ()
    ZBLH => NULL ()
    ZDCAPE => NULL ()
    ZTKE1 => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_OUT_CAPE => NULL ()
    Z_YDMF_PHYS_OUT_CLPH => NULL ()
    Z_YDMF_PHYS_OUT_FPLCL => NULL ()
    Z_YDMF_PHYS_OUT_FPLCN => NULL ()
    Z_YDMF_PHYS_OUT_FPLSL => NULL ()
    Z_YDMF_PHYS_OUT_FPLSN => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACEVADCAPE')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => GET_DEVICE_DATA_RDWR (YL_IMOC_CLPH)
    ZBLH => GET_DEVICE_DATA_RDWR (YL_ZBLH)
    ZDCAPE => GET_DEVICE_DATA_RDWR (YL_ZDCAPE)
    ZTKE1 => GET_DEVICE_DATA_RDONLY (YL_ZTKE1)
    Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_CAPE => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_CAPE)
    Z_YDMF_PHYS_OUT_CLPH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_OUT_UCLS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
    Z_YDVARS_GEOMETRY_OROG_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%OROG%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (IMOC_CLPH, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZBLH, ZDCAPE, &
      !$ACC&         ZTKE1, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_U, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, &
      !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
      !$ACC&         Z_YDMF_PHYS_OUT_CAPE, Z_YDMF_PHYS_OUT_CLPH, Z_YDMF_PHYS_OUT_FPLCL, &
      !$ACC&         Z_YDMF_PHYS_OUT_FPLCN, Z_YDMF_PHYS_OUT_FPLSL, Z_YDMF_PHYS_OUT_FPLSN, &
      !$ACC&         Z_YDMF_PHYS_OUT_UCLS, Z_YDMF_PHYS_OUT_UGST, Z_YDMF_PHYS_OUT_VCLS, &
      !$ACC&         Z_YDMF_PHYS_OUT_VGST, Z_YDVARS_GEOMETRY_OROG_T0) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL ACEVADCAPE_OPENACC (YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRCST, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_FPLSL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK&
        &), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK)&
        &, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK)&
        &, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), ZDCAPE(:, JBLK),YDSTACK=YLSTACK)
        CALL ACCLDIA_OPENACC (YDMODEL%YRCST, YDCPG_OPTS%LXCLP, YDCPG_OPTS%LXTGST, YDCPG_OPTS%LXXGST, YDMODEL&
        &%YRML_PHY_MF%YRPHY, YDMODEL%YRML_PHY_MF%YRPHY2, YDMODEL%YRML_PHY_MF%YRTOPH, YLCPG_BNDS%KIDIA,&
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_OUT_UCLS(:, JBLK), Z_YDMF_PHYS_OUT_VCLS&
        &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), Z_YDMF_PHYS_OUT_CAPE&
        &(:, JBLK), ZDCAPE(:, JBLK), ZTKE1(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK)&
        &, Z_YDVARS_GEOMETRY_OROG_T0(:, JBLK), Z_YDMF_PHYS_OUT_UGST(:, JBLK), Z_YDMF_PHYS_OUT_VGST(:, JBLK&
        &), ZBLH(:, JBLK), IMOC_CLPH(:, JBLK),YDSTACK=YLSTACK)
        
        Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)=MIN (YDMODEL%YRML_PHY_MF%YRPHY0%XMAXLM&
        &, MAX (YDMODEL%YRML_PHY_MF%YRPHY0%XMINLM, ZBLH (JLON, JBLK)))
      
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACEVADCAPE')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      IMOC_CLPH => GET_HOST_DATA_RDWR (YL_IMOC_CLPH)
      ZBLH => GET_HOST_DATA_RDWR (YL_ZBLH)
      ZDCAPE => GET_HOST_DATA_RDWR (YL_ZDCAPE)
      ZTKE1 => GET_HOST_DATA_RDWR (YL_ZTKE1)
      Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
      Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
      Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
      Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
      Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
      & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
      Z_YDMF_PHYS_OUT_CAPE => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CAPE)
      Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VGST)
      Z_YDVARS_GEOMETRY_OROG_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%OROG%FT0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    IMOC_CLPH => NULL ()
    ZBLH => NULL ()
    ZDCAPE => NULL ()
    ZTKE1 => NULL ()
    Z_YDMF_PHYS_BASE_STATE_T => NULL ()
    Z_YDMF_PHYS_BASE_STATE_U => NULL ()
    Z_YDMF_PHYS_BASE_STATE_V => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
    Z_YDMF_PHYS_OUT_CAPE => NULL ()
    Z_YDMF_PHYS_OUT_CLPH => NULL ()
    Z_YDMF_PHYS_OUT_FPLCL => NULL ()
    Z_YDMF_PHYS_OUT_FPLCN => NULL ()
    Z_YDMF_PHYS_OUT_FPLSL => NULL ()
    Z_YDMF_PHYS_OUT_FPLSN => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    Z_YDVARS_GEOMETRY_OROG_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACEVADCAPE',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ACVISIH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZQGM => GET_HOST_DATA_RDWR (YL_ZQGM)
  ZQR => GET_HOST_DATA_RDONLY (YL_ZQR)
  ZQS => GET_HOST_DATA_RDONLY (YL_ZQS)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_MXCLWC)
  Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISICLD)
  Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISIHYD)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    ZQGM (:, 1:YDCPG_OPTS%KFLEVG, JBLK)=ZEPSNEB
    CALL ACVISIH (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY%YRDVISI, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
    &%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK)&
    &, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDCPG_MISC_QICE(:&
    &,:, JBLK), ZQR(:,:, JBLK), ZQS(:,:, JBLK), ZQGM(:,:, JBLK), Z_YDMF_PHYS_OUT_VISICLD(:, JBLK), Z_YDMF_PHYS_OUT_VISIHYD&
    &(:, JBLK), Z_YDMF_PHYS_OUT_MXCLWC(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACVISIH')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZQGM => GET_HOST_DATA_RDWR (YL_ZQGM)
    ZQR => GET_HOST_DATA_RDWR (YL_ZQR)
    ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_MXCLWC)
    Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISICLD)
    Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISIHYD)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZQGM => NULL ()
  ZQR => NULL ()
  ZQS => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_OUT_MXCLWC => NULL ()
  Z_YDMF_PHYS_OUT_VISICLD => NULL ()
  Z_YDMF_PHYS_OUT_VISIHYD => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACVISIH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZQGM => GET_HOST_DATA_RDWR (YL_ZQGM)
  ZQR => GET_HOST_DATA_RDONLY (YL_ZQR)
  ZQS => GET_HOST_DATA_RDONLY (YL_ZQS)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_MXCLWC)
  Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISICLD)
  Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISIHYD)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      ZQGM (JLON, 1:YDCPG_OPTS%KFLEVG, JBLK)=ZEPSNEB
      CALL ACVISIH_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY%YRDVISI, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:&
      &,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), ZQR(:,:, JBLK), ZQS&
      &(:,:, JBLK), ZQGM(:,:, JBLK), Z_YDMF_PHYS_OUT_VISICLD(:, JBLK), Z_YDMF_PHYS_OUT_VISIHYD(:&
      &, JBLK), Z_YDMF_PHYS_OUT_MXCLWC(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACVISIH')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZQGM => GET_HOST_DATA_RDWR (YL_ZQGM)
    ZQR => GET_HOST_DATA_RDWR (YL_ZQR)
    ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_MXCLWC)
    Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISICLD)
    Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISIHYD)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZQGM => NULL ()
  ZQR => NULL ()
  ZQS => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_OUT_MXCLWC => NULL ()
  Z_YDMF_PHYS_OUT_VISICLD => NULL ()
  Z_YDMF_PHYS_OUT_VISIHYD => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ACVISIH')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZQGM => GET_DEVICE_DATA_RDWR (YL_ZQGM)
  ZQR => GET_DEVICE_DATA_RDONLY (YL_ZQR)
  ZQS => GET_DEVICE_DATA_RDONLY (YL_ZQS)
  Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_OUT_MXCLWC => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_MXCLWC)
  Z_YDMF_PHYS_OUT_VISICLD => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_VISICLD)
  Z_YDMF_PHYS_OUT_VISIHYD => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_VISIHYD)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZQGM, ZQR, ZQS, Z_YDCPG_MISC_QICE, &
    !$ACC&         Z_YDCPG_MISC_QLI, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, Z_YDMF_PHYS_OUT_MXCLWC, &
    !$ACC&         Z_YDMF_PHYS_OUT_VISICLD, Z_YDMF_PHYS_OUT_VISIHYD) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      ZQGM (JLON, 1:YDCPG_OPTS%KFLEVG, JBLK)=ZEPSNEB
      CALL ACVISIH_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY%YRDVISI, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
      &%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:&
      &,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), ZQR(:,:, JBLK), ZQS&
      &(:,:, JBLK), ZQGM(:,:, JBLK), Z_YDMF_PHYS_OUT_VISICLD(:, JBLK), Z_YDMF_PHYS_OUT_VISIHYD(:&
      &, JBLK), Z_YDMF_PHYS_OUT_MXCLWC(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ACVISIH')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZQGM => GET_HOST_DATA_RDWR (YL_ZQGM)
    ZQR => GET_HOST_DATA_RDWR (YL_ZQR)
    ZQS => GET_HOST_DATA_RDWR (YL_ZQS)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_OUT_MXCLWC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_MXCLWC)
    Z_YDMF_PHYS_OUT_VISICLD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISICLD)
    Z_YDMF_PHYS_OUT_VISIHYD => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_VISIHYD)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZQGM => NULL ()
  ZQR => NULL ()
  ZQS => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_OUT_MXCLWC => NULL ()
  Z_YDMF_PHYS_OUT_VISICLD => NULL ()
  Z_YDMF_PHYS_OUT_VISIHYD => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ACVISIH',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ZBAY_QRCONV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZBAY_QRCONV (JLON, JLEV, JBLK)=0.001_JPRB*((ABS (Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)&
        &)*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN (1))**YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN (2))
        ZBAY_QSCONV (JLON, JLEV, JBLK)=0.001_JPRB*((ABS (Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)&
        &)*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW (1))**YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW (2))
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZBAY_QRCONV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
  Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZBAY_QRCONV (JLON, JLEV, JBLK)=0.001_JPRB*((ABS (Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)&
        &)*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN (1))**YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN (2))
        ZBAY_QSCONV (JLON, JLEV, JBLK)=0.001_JPRB*((ABS (Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)&
        &)*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW (1))**YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW (2))
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZBAY_QRCONV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_DEVICE_DATA_RDWR (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_DEVICE_DATA_RDWR (YL_ZBAY_QSCONV)
  Z_YDMF_PHYS_OUT_FPLCL => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
  Z_YDMF_PHYS_OUT_FPLCN => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZBAY_QRCONV, ZBAY_QSCONV, &
    !$ACC&         Z_YDMF_PHYS_OUT_FPLCL, Z_YDMF_PHYS_OUT_FPLCN) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZBAY_QRCONV (JLON, JLEV, JBLK)=0.001_JPRB*((ABS (Z_YDMF_PHYS_OUT_FPLCL (JLON, JLEV, JBLK)&
        &)*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN (1))**YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFRAIN (2))
        ZBAY_QSCONV (JLON, JLEV, JBLK)=0.001_JPRB*((ABS (Z_YDMF_PHYS_OUT_FPLCN (JLON, JLEV, JBLK)&
        &)*YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW (1))**YDMODEL%YRML_PHY_MF%YRPHY0%RCOEFSNOW (2))
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  Z_YDMF_PHYS_OUT_FPLCL => NULL ()
  Z_YDMF_PHYS_OUT_FPLCN => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZBAY_QRCONV',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:ZDE2MR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
  ZDE2MR => GET_HOST_DATA_RDWR (YL_ZDE2MR)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZDE2MR (JLON, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDMF_PHYS_BASE_STATE_T(JLON,&
        & JLEV, JBLK)/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(JLON, JLEV, JBLK)
        ZBAY_QRCONV (JLON, JLEV, JBLK)=ZBAY_QRCONV (JLON, JLEV, JBLK)*ZDE2MR (JLON, JLEV, JBLK)
        ZBAY_QSCONV (JLON, JLEV, JBLK)=ZBAY_QSCONV (JLON, JLEV, JBLK)*ZDE2MR (JLON, JLEV, JBLK)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZDE2MR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    ZDE2MR => GET_HOST_DATA_RDWR (YL_ZDE2MR)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  ZDE2MR => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZDE2MR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
  ZDE2MR => GET_HOST_DATA_RDWR (YL_ZDE2MR)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZDE2MR (JLON, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDMF_PHYS_BASE_STATE_T(JLON,&
        & JLEV, JBLK)/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(JLON, JLEV, JBLK)
        ZBAY_QRCONV (JLON, JLEV, JBLK)=ZBAY_QRCONV (JLON, JLEV, JBLK)*ZDE2MR (JLON, JLEV, JBLK)
        ZBAY_QSCONV (JLON, JLEV, JBLK)=ZBAY_QSCONV (JLON, JLEV, JBLK)*ZDE2MR (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZDE2MR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    ZDE2MR => GET_HOST_DATA_RDWR (YL_ZDE2MR)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  ZDE2MR => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:ZDE2MR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_DEVICE_DATA_RDWR (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_DEVICE_DATA_RDWR (YL_ZBAY_QSCONV)
  ZDE2MR => GET_DEVICE_DATA_RDWR (YL_ZDE2MR)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZBAY_QRCONV, ZBAY_QSCONV, &
    !$ACC&         ZDE2MR, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZDE2MR (JLON, JLEV, JBLK)=YDMODEL%YRCST%RD*Z_YDMF_PHYS_BASE_STATE_T(JLON,&
        & JLEV, JBLK)/Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(JLON, JLEV, JBLK)
        ZBAY_QRCONV (JLON, JLEV, JBLK)=ZBAY_QRCONV (JLON, JLEV, JBLK)*ZDE2MR (JLON, JLEV, JBLK)
        ZBAY_QSCONV (JLON, JLEV, JBLK)=ZBAY_QSCONV (JLON, JLEV, JBLK)*ZDE2MR (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:ZDE2MR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    ZDE2MR => GET_HOST_DATA_RDWR (YL_ZDE2MR)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  ZDE2MR => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:ZDE2MR',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:PPWETPOINT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZPCLS => GET_HOST_DATA_RDONLY (YL_ZPCLS)
  Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_TCLS)
  Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TPWCLS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL PPWETPOINT (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
    &, YDCPG_OPTS%KLON, 1, ZPCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q&
    & (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_L (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_I&
    & (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_TPWCLS(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PPWETPOINT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TPWCLS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZPCLS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_OUT_TCLS => NULL ()
  Z_YDMF_PHYS_OUT_TPWCLS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:PPWETPOINT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZPCLS => GET_HOST_DATA_RDONLY (YL_ZPCLS)
  Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_TCLS)
  Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TPWCLS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL PPWETPOINT_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDCPG_OPTS%KLON, 1, ZPCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q (:&
      &, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_L (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_I&
      & (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_TPWCLS(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PPWETPOINT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TPWCLS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZPCLS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_OUT_TCLS => NULL ()
  Z_YDMF_PHYS_OUT_TPWCLS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:PPWETPOINT')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZPCLS => GET_DEVICE_DATA_RDONLY (YL_ZPCLS)
  Z_YDMF_PHYS_BASE_STATE_I => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_OUT_TCLS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_TCLS)
  Z_YDMF_PHYS_OUT_TPWCLS => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_TPWCLS)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZPCLS, Z_YDMF_PHYS_BASE_STATE_I, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_L, Z_YDMF_PHYS_BASE_STATE_Q, Z_YDMF_PHYS_OUT_TCLS, &
    !$ACC&         Z_YDMF_PHYS_OUT_TPWCLS) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL PPWETPOINT_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPHY, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDCPG_OPTS%KLON, 1, ZPCLS(:, JBLK), Z_YDMF_PHYS_OUT_TCLS(:, JBLK), Z_YDMF_PHYS_BASE_STATE_Q (:&
      &, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_L (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_BASE_STATE_I&
      & (:, YDCPG_OPTS%KFLEVG, JBLK), Z_YDMF_PHYS_OUT_TPWCLS(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PPWETPOINT')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZPCLS => GET_HOST_DATA_RDWR (YL_ZPCLS)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_OUT_TCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TCLS)
    Z_YDMF_PHYS_OUT_TPWCLS => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_TPWCLS)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZPCLS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_OUT_TCLS => NULL ()
  Z_YDMF_PHYS_OUT_TPWCLS => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PPWETPOINT',1,ZHOOK_HANDLE_PARALLEL)
CALL APL_ARPEGE_DPRECIPS_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS&
&, YDMF_PHYS, YDVARS, YDMODEL, YL_ZPRC_DPRECIPS, YL_ZPRC_DPRECIPS2)
CALL MF_PHYS_MOCON_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YL_ZRDG_LCVQ&
&, YL_IMOC_CLPH, YDMF_PHYS, YDMF_PHYS_BASE_STATE)

IF (YDCPG_OPTS%LCORWAT) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OpenMP','APL_ARPEGE_PARALLEL:22')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVL)
    Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FEVN)
    Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCL)
    Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLCN)
    Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSL)
    Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_FPLSN)
    Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_EVA)
    Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PCL)
    Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PCN)
    Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PSL)
    Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PSN)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL MF_PHYS_CORWAT (YLCPG_BNDS, YDCPG_OPTS, Z_YDMF_PHYS_OUT_FEVL(:,:, JBLK), Z_YDMF_PHYS_OUT_FEVN&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCL(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLCN(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSL&
      &(:,:, JBLK), Z_YDMF_PHYS_OUT_FPLSN(:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PEVA(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPCL&
      &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPCN(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPSL(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VH_PPSN&
      &(:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:22')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDMF_PHYS_OUT_FEVL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVL)
      Z_YDMF_PHYS_OUT_FEVN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FEVN)
      Z_YDMF_PHYS_OUT_FPLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCL)
      Z_YDMF_PHYS_OUT_FPLCN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLCN)
      Z_YDMF_PHYS_OUT_FPLSL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSL)
      Z_YDMF_PHYS_OUT_FPLSN => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FPLSN)
      Z_YDMF_PHYS_SURF_GSD_VH_PEVA => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_EVA)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCL => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PCL)
      Z_YDMF_PHYS_SURF_GSD_VH_PPCN => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PCN)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSL => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PSL)
      Z_YDMF_PHYS_SURF_GSD_VH_PPSN => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VH%F_PSN)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_FEVL => NULL ()
    Z_YDMF_PHYS_OUT_FEVN => NULL ()
    Z_YDMF_PHYS_OUT_FPLCL => NULL ()
    Z_YDMF_PHYS_OUT_FPLCN => NULL ()
    Z_YDMF_PHYS_OUT_FPLSL => NULL ()
    Z_YDMF_PHYS_OUT_FPLSN => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PEVA => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PPCL => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PPCN => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PPSL => NULL ()
    Z_YDMF_PHYS_SURF_GSD_VH_PPSN => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:22',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDMODEL%YRML_PHY_MF%YRPHY%NDPSFI==1) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OpenMP','APL_ARPEGE_PARALLEL:23')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSATS => GET_HOST_DATA_RDONLY (YL_ZFLU_QSATS)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
    Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QSOL)
    Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDONLY (YDCPG_PHY0%F_PREHYD)
    Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSP_RR%F_T_T0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL CPQSOL (YDMODEL%YRCST, YDGEOMETRY%YRDIMV, YDMODEL%YRML_PHY_MF%YRPHY, YDCPG_OPTS%KLON, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, Z_YDCPG_PHY0_PREHYD(:,:, JBLK), Z_YDMF_PHYS_SURF_GSP_RR_PT_T0(:, JBLK&
      &), Z_YDCPG_MISC_QS(:, JBLK), ZFLU_QSATS(:, JBLK), Z_YDCPG_MISC_QSOL(:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:23')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZFLU_QSATS => GET_HOST_DATA_RDWR (YL_ZFLU_QSATS)
      Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
      Z_YDCPG_MISC_QSOL => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QSOL)
      Z_YDCPG_PHY0_PREHYD => GET_HOST_DATA_RDWR (YDCPG_PHY0%F_PREHYD)
      Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSP_RR%F_T_T0)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZFLU_QSATS => NULL ()
    Z_YDCPG_MISC_QS => NULL ()
    Z_YDCPG_MISC_QSOL => NULL ()
    Z_YDCPG_PHY0_PREHYD => NULL ()
    Z_YDMF_PHYS_SURF_GSP_RR_PT_T0 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:23',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

CALL APL_ARPEGE_ATMOSPHERE_UPDATE_PARALLEL (YDMF_PHYS_BASE_STATE, YDMF_PHYS_NEXT_STATE&
&, YDGEOMETRY, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDCPG_DYN0, YDMF_PHYS_SURF&
&, YDVARS, YDMODEL, YDDDH, YL_ZDIFEXT, YL_ZDSA_CPS, YL_ZMSC_FRMQ, YL_ZPFL_FEFB1, YL_ZPFL_FEFB2&
&, YL_ZPFL_FEFB3, YL_ZPFL_FTKE, YL_ZPFL_FTKEI, YL_ZFCHQ)
CALL MF_PHYS_FPL_PART2_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YL_ZPFL_FPLCH&
&, YL_ZPFL_FPLSH, YDVARS%CPF%FT1, YDVARS%SPF%FT1, YDMODEL)
CALL MF_PHYS_TRANSFER_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YDVARS&
&, YDMODEL%YRML_PHY_MF%YRPHY, YDMODEL%YRML_GCONF%YGFL)
CALL APL_ARPEGE_SURFACE_UPDATE_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YDCPG_GPAR&
&, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, YDCPG_OPTS%LCONFX, YDCPG_OPTS%ZDTPHY&
&, YL_ZDSA_C1, YL_ZDSA_C2, YL_ZFLU_FEVI, YL_ZFLU_VEG)

IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPGY) THEN
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OpenMP','APL_ARPEGE_PARALLEL:24')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDONLY (YDVARS%CVV%FT0)
    Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR (YDVARS%CVV%FT1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL MF_PHYS_CVV (YLCPG_BNDS, YDCPG_OPTS, Z_YDVARS_CVV_T0(:,:, JBLK), Z_YDVARS_CVV_T1(:,:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:24')) THEN
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDVARS_CVV_T0 => GET_HOST_DATA_RDWR (YDVARS%CVV%FT0)
      Z_YDVARS_CVV_T1 => GET_HOST_DATA_RDWR (YDVARS%CVV%FT1)
      IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDVARS_CVV_T0 => NULL ()
    Z_YDVARS_CVV_T1 => NULL ()
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:24',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDCPG_OPTS%LCONFX) THEN
  CALL MF_PHYS_SAVE_PHSURF_PART2_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YL_ZSAV_DDAL, YL_ZSAV_DDOM, YL_ZSAV_ENTCH&
  &, YL_ZSAV_FHPS, YL_ZSAV_GZ0F, YL_ZSAV_GZ0HF, YL_ZSAV_HV, YL_ZSAV_PBLH, YL_ZSAV_QSH, YL_ZSAV_UDAL&
  &, YL_ZSAV_UDGRO, YL_ZSAV_UDOM, YL_ZSAV_UNEBH, YDMF_PHYS_SURF%GSD_VF%F_Z0F, YDMF_PHYS_SURF%GSD_VH&
  &%F_PBLH, YDMF_PHYS_SURF%GSD_VH%F_QSH, YDMF_PHYS_SURF%GSD_VH%F_SPSH, YDMF_PHYS_SURF%GSD_VK%F_UDGRO&
  &, YDMF_PHYS_SURF%GSD_VV%F_HV, YDMF_PHYS_SURF%GSD_VV%F_Z0H, YDVARS%DAL%FT0, YDVARS%DOM%FT0, YDVARS&
  &%UAL%FT0, YDVARS%UEN%FT0, YDVARS%UNEBH%FT0, YDVARS%UOM%FT0, YDMODEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:BAYRAD')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_HOST_DATA_RDONLY (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_HOST_DATA_RDONLY (YL_ZBAY_QSCONV)
  Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT1)
  Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT1)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL MF_PHYS_BAYRAD (YLCPG_BNDS, YDCPG_OPTS, ZBAY_QRCONV(:,:, JBLK), ZBAY_QSCONV(:&
    &,:, JBLK), Z_YDVARS_RCONV_T1(:,:, JBLK), Z_YDVARS_SCONV_T1(:,:, JBLK), YDMODEL)
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:BAYRAD')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT1)
    Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  Z_YDVARS_RCONV_T1 => NULL ()
  Z_YDVARS_SCONV_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:BAYRAD')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_HOST_DATA_RDONLY (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_HOST_DATA_RDONLY (YL_ZBAY_QSCONV)
  Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT1)
  Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT1)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL MF_PHYS_BAYRAD_OPENACC (YLCPG_BNDS, YDCPG_OPTS, ZBAY_QRCONV(:,:, JBLK), ZBAY_QSCONV(:,:, JBLK&
      &), Z_YDVARS_RCONV_T1(:,:, JBLK), Z_YDVARS_SCONV_T1(:,:, JBLK), YDMODEL,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:BAYRAD')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT1)
    Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  Z_YDVARS_RCONV_T1 => NULL ()
  Z_YDVARS_SCONV_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:BAYRAD')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => GET_DEVICE_DATA_RDONLY (YL_ZBAY_QRCONV)
  ZBAY_QSCONV => GET_DEVICE_DATA_RDONLY (YL_ZBAY_QSCONV)
  Z_YDVARS_RCONV_T1 => GET_DEVICE_DATA_RDWR (YDVARS%RCONV%FT1)
  Z_YDVARS_SCONV_T1 => GET_DEVICE_DATA_RDWR (YDVARS%SCONV%FT1)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZBAY_QRCONV, ZBAY_QSCONV, &
    !$ACC&         Z_YDVARS_RCONV_T1, Z_YDVARS_SCONV_T1) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL MF_PHYS_BAYRAD_OPENACC (YLCPG_BNDS, YDCPG_OPTS, ZBAY_QRCONV(:,:, JBLK), ZBAY_QSCONV(:,:, JBLK&
      &), Z_YDVARS_RCONV_T1(:,:, JBLK), Z_YDVARS_SCONV_T1(:,:, JBLK), YDMODEL,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:BAYRAD')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZBAY_QRCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QRCONV)
    ZBAY_QSCONV => GET_HOST_DATA_RDWR (YL_ZBAY_QSCONV)
    Z_YDVARS_RCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%RCONV%FT1)
    Z_YDVARS_SCONV_T1 => GET_HOST_DATA_RDWR (YDVARS%SCONV%FT1)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZBAY_QRCONV => NULL ()
  ZBAY_QSCONV => NULL ()
  Z_YDVARS_RCONV_T1 => NULL ()
  Z_YDVARS_SCONV_T1 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:BAYRAD',1,ZHOOK_HANDLE_PARALLEL)

IF (YDMODEL%YRML_PHY_EC%YREPHY%LEMWAVE) THEN
  CALL APL_ARPEGE_MWAVE_PARALLEL (YDCPG_MISC, YDMF_PHYS, YDCPG_BNDS, YDCPG_OPTS, YDPHYSMWAVE)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:EDR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_EDR)
  Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_DI%F_XEDR)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDR) THEN

      DO JLEV=1, YDCPG_OPTS%YRSURF_DIMS%YSD_DID%NLEVS
        Z_YDMF_PHYS_SURF_GSD_DI_PXEDR (:, JLEV, JBLK)=Z_YDMF_PHYS_OUT_EDR (:, JLEV, JBLK)
      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:EDR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_DI%F_XEDR)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_OUT_EDR => NULL ()
  Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:EDR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_EDR)
  Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_DI%F_XEDR)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDR) THEN

        DO JLEV=1, YDCPG_OPTS%YRSURF_DIMS%YSD_DID%NLEVS
          Z_YDMF_PHYS_SURF_GSD_DI_PXEDR (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_EDR (JLON, JLEV, JBLK)
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:EDR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_DI%F_XEDR)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_OUT_EDR => NULL ()
  Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:EDR')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_OUT_EDR => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_EDR)
  Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_DI%F_XEDR)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDMF_PHYS_OUT_EDR, &
    !$ACC&         Z_YDMF_PHYS_SURF_GSD_DI_PXEDR) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDR) THEN

        DO JLEV=1, YDCPG_OPTS%YRSURF_DIMS%YSD_DID%NLEVS
          Z_YDMF_PHYS_SURF_GSD_DI_PXEDR (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_EDR (JLON, JLEV, JBLK)
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:EDR')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_DI%F_XEDR)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  Z_YDMF_PHYS_OUT_EDR => NULL ()
  Z_YDMF_PHYS_SURF_GSD_DI_PXEDR => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:EDR',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_PARALLEL:PRECIPS')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZPRC_DPRECIPS => GET_HOST_DATA_RDONLY (YL_ZPRC_DPRECIPS)
  ZPRC_DPRECIPS2 => GET_HOST_DATA_RDONLY (YL_ZPRC_DPRECIPS2)
  Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
  Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL MF_PHYS_PRECIPS (YLCPG_BNDS, YDCPG_OPTS, ZPRC_DPRECIPS(:,:, JBLK), ZPRC_DPRECIPS2(:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP&
    &(:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:,:, JBLK), YDMODEL)
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PRECIPS')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => GET_HOST_DATA_RDWR (YL_ZPRC_DPRECIPS)
    ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZPRC_DPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZPRC_DPRECIPS => NULL ()
  ZPRC_DPRECIPS2 => NULL ()
  Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL ()
  Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_PARALLEL:PRECIPS')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZPRC_DPRECIPS => GET_HOST_DATA_RDONLY (YL_ZPRC_DPRECIPS)
  ZPRC_DPRECIPS2 => GET_HOST_DATA_RDONLY (YL_ZPRC_DPRECIPS2)
  Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
  Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL MF_PHYS_PRECIPS_OPENACC (YLCPG_BNDS, YDCPG_OPTS, ZPRC_DPRECIPS(:,:, JBLK&
      &), ZPRC_DPRECIPS2(:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2&
      &(:,:, JBLK), YDMODEL,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PRECIPS')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => GET_HOST_DATA_RDWR (YL_ZPRC_DPRECIPS)
    ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZPRC_DPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZPRC_DPRECIPS => NULL ()
  ZPRC_DPRECIPS2 => NULL ()
  Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL ()
  Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_PARALLEL:PRECIPS')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZPRC_DPRECIPS => GET_DEVICE_DATA_RDONLY (YL_ZPRC_DPRECIPS)
  ZPRC_DPRECIPS2 => GET_DEVICE_DATA_RDONLY (YL_ZPRC_DPRECIPS2)
  Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
  Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_DEVICE_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZPRC_DPRECIPS, ZPRC_DPRECIPS2, &
    !$ACC&         Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2, Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL MF_PHYS_PRECIPS_OPENACC (YLCPG_BNDS, YDCPG_OPTS, ZPRC_DPRECIPS(:,:, JBLK&
      &), ZPRC_DPRECIPS2(:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:,:, JBLK), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2&
      &(:,:, JBLK), YDMODEL,YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_PARALLEL:PRECIPS')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZPRC_DPRECIPS => GET_HOST_DATA_RDWR (YL_ZPRC_DPRECIPS)
    ZPRC_DPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZPRC_DPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZPRC_DPRECIPS => NULL ()
  ZPRC_DPRECIPS2 => NULL ()
  Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL ()
  Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL:PRECIPS',1,ZHOOK_HANDLE_PARALLEL)





CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_IMOC_CLPH)) CALL FIELD_DELETE (YL_IMOC_CLPH)
IF (ASSOCIATED (YL_INLAB_CVPP)) CALL FIELD_DELETE (YL_INLAB_CVPP)
IF (ASSOCIATED (YL_ZAER)) CALL FIELD_DELETE (YL_ZAER)
IF (ASSOCIATED (YL_ZAERINDS)) CALL FIELD_DELETE (YL_ZAERINDS)
IF (ASSOCIATED (YL_ZAIPCMT)) CALL FIELD_DELETE (YL_ZAIPCMT)
IF (ASSOCIATED (YL_ZALBD)) CALL FIELD_DELETE (YL_ZALBD)
IF (ASSOCIATED (YL_ZALBDIR)) CALL FIELD_DELETE (YL_ZALBDIR)
IF (ASSOCIATED (YL_ZALBP)) CALL FIELD_DELETE (YL_ZALBP)
IF (ASSOCIATED (YL_ZALPHA1)) CALL FIELD_DELETE (YL_ZALPHA1)
IF (ASSOCIATED (YL_ZBAY_QRCONV)) CALL FIELD_DELETE (YL_ZBAY_QRCONV)
IF (ASSOCIATED (YL_ZBAY_QSCONV)) CALL FIELD_DELETE (YL_ZBAY_QSCONV)
IF (ASSOCIATED (YL_ZBLH)) CALL FIELD_DELETE (YL_ZBLH)
IF (ASSOCIATED (YL_ZC3)) CALL FIELD_DELETE (YL_ZC3)
IF (ASSOCIATED (YL_ZCDROV)) CALL FIELD_DELETE (YL_ZCDROV)
IF (ASSOCIATED (YL_ZCE)) CALL FIELD_DELETE (YL_ZCE)
IF (ASSOCIATED (YL_ZCEMTR)) CALL FIELD_DELETE (YL_ZCEMTR)
IF (ASSOCIATED (YL_ZCEROV)) CALL FIELD_DELETE (YL_ZCEROV)
IF (ASSOCIATED (YL_ZCFATH)) CALL FIELD_DELETE (YL_ZCFATH)
IF (ASSOCIATED (YL_ZCFAU)) CALL FIELD_DELETE (YL_ZCFAU)
IF (ASSOCIATED (YL_ZCFBTH)) CALL FIELD_DELETE (YL_ZCFBTH)
IF (ASSOCIATED (YL_ZCFBU)) CALL FIELD_DELETE (YL_ZCFBU)
IF (ASSOCIATED (YL_ZCFBV)) CALL FIELD_DELETE (YL_ZCFBV)
IF (ASSOCIATED (YL_ZCG)) CALL FIELD_DELETE (YL_ZCG)
IF (ASSOCIATED (YL_ZCHROV)) CALL FIELD_DELETE (YL_ZCHROV)
IF (ASSOCIATED (YL_ZCLCT_RAD)) CALL FIELD_DELETE (YL_ZCLCT_RAD)
IF (ASSOCIATED (YL_ZCN)) CALL FIELD_DELETE (YL_ZCN)
IF (ASSOCIATED (YL_ZCOEFA)) CALL FIELD_DELETE (YL_ZCOEFA)
IF (ASSOCIATED (YL_ZCOEFN)) CALL FIELD_DELETE (YL_ZCOEFN)
IF (ASSOCIATED (YL_ZCONDCVPPI)) CALL FIELD_DELETE (YL_ZCONDCVPPI)
IF (ASSOCIATED (YL_ZCONDCVPPL)) CALL FIELD_DELETE (YL_ZCONDCVPPL)
IF (ASSOCIATED (YL_ZCP)) CALL FIELD_DELETE (YL_ZCP)
IF (ASSOCIATED (YL_ZCRTI)) CALL FIELD_DELETE (YL_ZCRTI)
IF (ASSOCIATED (YL_ZCTRSO)) CALL FIELD_DELETE (YL_ZCTRSO)
IF (ASSOCIATED (YL_ZDCAPE)) CALL FIELD_DELETE (YL_ZDCAPE)
IF (ASSOCIATED (YL_ZDE2MR)) CALL FIELD_DELETE (YL_ZDE2MR)
IF (ASSOCIATED (YL_ZDECRD)) CALL FIELD_DELETE (YL_ZDECRD)
IF (ASSOCIATED (YL_ZDIFCVPPQ)) CALL FIELD_DELETE (YL_ZDIFCVPPQ)
IF (ASSOCIATED (YL_ZDIFCVPPS)) CALL FIELD_DELETE (YL_ZDIFCVPPS)
IF (ASSOCIATED (YL_ZDIFCVPPU)) CALL FIELD_DELETE (YL_ZDIFCVPPU)
IF (ASSOCIATED (YL_ZDIFCVPPV)) CALL FIELD_DELETE (YL_ZDIFCVPPV)
IF (ASSOCIATED (YL_ZDIFEXT)) CALL FIELD_DELETE (YL_ZDIFEXT)
IF (ASSOCIATED (YL_ZDIFWQ)) CALL FIELD_DELETE (YL_ZDIFWQ)
IF (ASSOCIATED (YL_ZDIFWS)) CALL FIELD_DELETE (YL_ZDIFWS)
IF (ASSOCIATED (YL_ZDPHI)) CALL FIELD_DELETE (YL_ZDPHI)
IF (ASSOCIATED (YL_ZDPHIT)) CALL FIELD_DELETE (YL_ZDPHIT)
IF (ASSOCIATED (YL_ZDPHIV)) CALL FIELD_DELETE (YL_ZDPHIV)
IF (ASSOCIATED (YL_ZDQSTS)) CALL FIELD_DELETE (YL_ZDQSTS)
IF (ASSOCIATED (YL_ZDSA_C1)) CALL FIELD_DELETE (YL_ZDSA_C1)
IF (ASSOCIATED (YL_ZDSA_C2)) CALL FIELD_DELETE (YL_ZDSA_C2)
IF (ASSOCIATED (YL_ZDSA_CPS)) CALL FIELD_DELETE (YL_ZDSA_CPS)
IF (ASSOCIATED (YL_ZDSA_LHS)) CALL FIELD_DELETE (YL_ZDSA_LHS)
IF (ASSOCIATED (YL_ZDSA_RS)) CALL FIELD_DELETE (YL_ZDSA_RS)
IF (ASSOCIATED (YL_ZECTCLS)) CALL FIELD_DELETE (YL_ZECTCLS)
IF (ASSOCIATED (YL_ZEDMFQ)) CALL FIELD_DELETE (YL_ZEDMFQ)
IF (ASSOCIATED (YL_ZEDMFS)) CALL FIELD_DELETE (YL_ZEDMFS)
IF (ASSOCIATED (YL_ZEDMFU)) CALL FIELD_DELETE (YL_ZEDMFU)
IF (ASSOCIATED (YL_ZEDMFV)) CALL FIELD_DELETE (YL_ZEDMFV)
IF (ASSOCIATED (YL_ZFCHQ)) CALL FIELD_DELETE (YL_ZFCHQ)
IF (ASSOCIATED (YL_ZFLU_CD)) CALL FIELD_DELETE (YL_ZFLU_CD)
IF (ASSOCIATED (YL_ZFLU_CDN)) CALL FIELD_DELETE (YL_ZFLU_CDN)
IF (ASSOCIATED (YL_ZFLU_CH)) CALL FIELD_DELETE (YL_ZFLU_CH)
IF (ASSOCIATED (YL_ZFLU_CHN)) CALL FIELD_DELETE (YL_ZFLU_CHN)
IF (ASSOCIATED (YL_ZFLU_EMIS)) CALL FIELD_DELETE (YL_ZFLU_EMIS)
IF (ASSOCIATED (YL_ZFLU_FEVI)) CALL FIELD_DELETE (YL_ZFLU_FEVI)
IF (ASSOCIATED (YL_ZFLU_NEIJ)) CALL FIELD_DELETE (YL_ZFLU_NEIJ)
IF (ASSOCIATED (YL_ZFLU_QSAT)) CALL FIELD_DELETE (YL_ZFLU_QSAT)
IF (ASSOCIATED (YL_ZFLU_QSATS)) CALL FIELD_DELETE (YL_ZFLU_QSATS)
IF (ASSOCIATED (YL_ZFLU_VEG)) CALL FIELD_DELETE (YL_ZFLU_VEG)
IF (ASSOCIATED (YL_ZFLX_LOTT_GWU)) CALL FIELD_DELETE (YL_ZFLX_LOTT_GWU)
IF (ASSOCIATED (YL_ZFLX_LOTT_GWV)) CALL FIELD_DELETE (YL_ZFLX_LOTT_GWV)
IF (ASSOCIATED (YL_ZFPCOR)) CALL FIELD_DELETE (YL_ZFPCOR)
IF (ASSOCIATED (YL_ZFPLSL)) CALL FIELD_DELETE (YL_ZFPLSL)
IF (ASSOCIATED (YL_ZFPLSN)) CALL FIELD_DELETE (YL_ZFPLSN)
IF (ASSOCIATED (YL_ZGEOSLC)) CALL FIELD_DELETE (YL_ZGEOSLC)
IF (ASSOCIATED (YL_ZGWDCS)) CALL FIELD_DELETE (YL_ZGWDCS)
IF (ASSOCIATED (YL_ZHQ)) CALL FIELD_DELETE (YL_ZHQ)
IF (ASSOCIATED (YL_ZHTR)) CALL FIELD_DELETE (YL_ZHTR)
IF (ASSOCIATED (YL_ZHU)) CALL FIELD_DELETE (YL_ZHU)
IF (ASSOCIATED (YL_ZKCLS)) CALL FIELD_DELETE (YL_ZKCLS)
IF (ASSOCIATED (YL_ZKQLROV)) CALL FIELD_DELETE (YL_ZKQLROV)
IF (ASSOCIATED (YL_ZKQROV)) CALL FIELD_DELETE (YL_ZKQROV)
IF (ASSOCIATED (YL_ZKTROV)) CALL FIELD_DELETE (YL_ZKTROV)
IF (ASSOCIATED (YL_ZKUROV)) CALL FIELD_DELETE (YL_ZKUROV)
IF (ASSOCIATED (YL_ZKUROV2)) CALL FIELD_DELETE (YL_ZKUROV2)
IF (ASSOCIATED (YL_ZLVT)) CALL FIELD_DELETE (YL_ZLVT)
IF (ASSOCIATED (YL_ZMF_UP)) CALL FIELD_DELETE (YL_ZMF_UP)
IF (ASSOCIATED (YL_ZMRIPP)) CALL FIELD_DELETE (YL_ZMRIPP)
IF (ASSOCIATED (YL_ZMSC_FRMQ)) CALL FIELD_DELETE (YL_ZMSC_FRMQ)
IF (ASSOCIATED (YL_ZMSC_LH)) CALL FIELD_DELETE (YL_ZMSC_LH)
IF (ASSOCIATED (YL_ZMSC_LSCPE)) CALL FIELD_DELETE (YL_ZMSC_LSCPE)
IF (ASSOCIATED (YL_ZMSC_QW)) CALL FIELD_DELETE (YL_ZMSC_QW)
IF (ASSOCIATED (YL_ZMSC_TW)) CALL FIELD_DELETE (YL_ZMSC_TW)
IF (ASSOCIATED (YL_ZNBVNO)) CALL FIELD_DELETE (YL_ZNBVNO)
IF (ASSOCIATED (YL_ZNEBC0)) CALL FIELD_DELETE (YL_ZNEBC0)
IF (ASSOCIATED (YL_ZNEBCH)) CALL FIELD_DELETE (YL_ZNEBCH)
IF (ASSOCIATED (YL_ZNEBDIFF)) CALL FIELD_DELETE (YL_ZNEBDIFF)
IF (ASSOCIATED (YL_ZNEBS)) CALL FIELD_DELETE (YL_ZNEBS)
IF (ASSOCIATED (YL_ZNEBS0)) CALL FIELD_DELETE (YL_ZNEBS0)
IF (ASSOCIATED (YL_ZNEB_CVPP)) CALL FIELD_DELETE (YL_ZNEB_CVPP)
IF (ASSOCIATED (YL_ZNEIJG)) CALL FIELD_DELETE (YL_ZNEIJG)
IF (ASSOCIATED (YL_ZNEIJV)) CALL FIELD_DELETE (YL_ZNEIJV)
IF (ASSOCIATED (YL_ZPCLS)) CALL FIELD_DELETE (YL_ZPCLS)
IF (ASSOCIATED (YL_ZPFL_FEFB1)) CALL FIELD_DELETE (YL_ZPFL_FEFB1)
IF (ASSOCIATED (YL_ZPFL_FEFB2)) CALL FIELD_DELETE (YL_ZPFL_FEFB2)
IF (ASSOCIATED (YL_ZPFL_FEFB3)) CALL FIELD_DELETE (YL_ZPFL_FEFB3)
IF (ASSOCIATED (YL_ZPFL_FPLCH)) CALL FIELD_DELETE (YL_ZPFL_FPLCH)
IF (ASSOCIATED (YL_ZPFL_FPLSH)) CALL FIELD_DELETE (YL_ZPFL_FPLSH)
IF (ASSOCIATED (YL_ZPFL_FTKE)) CALL FIELD_DELETE (YL_ZPFL_FTKE)
IF (ASSOCIATED (YL_ZPFL_FTKEI)) CALL FIELD_DELETE (YL_ZPFL_FTKEI)
IF (ASSOCIATED (YL_ZPOID)) CALL FIELD_DELETE (YL_ZPOID)
IF (ASSOCIATED (YL_ZPRC_DPRECIPS)) CALL FIELD_DELETE (YL_ZPRC_DPRECIPS)
IF (ASSOCIATED (YL_ZPRC_DPRECIPS2)) CALL FIELD_DELETE (YL_ZPRC_DPRECIPS2)
IF (ASSOCIATED (YL_ZPRODTH)) CALL FIELD_DELETE (YL_ZPRODTH)
IF (ASSOCIATED (YL_ZPRODTH_CVPP)) CALL FIELD_DELETE (YL_ZPRODTH_CVPP)
IF (ASSOCIATED (YL_ZPRS)) CALL FIELD_DELETE (YL_ZPRS)
IF (ASSOCIATED (YL_ZQCO2)) CALL FIELD_DELETE (YL_ZQCO2)
IF (ASSOCIATED (YL_ZQC_DET_PCMT)) CALL FIELD_DELETE (YL_ZQC_DET_PCMT)
IF (ASSOCIATED (YL_ZQGM)) CALL FIELD_DELETE (YL_ZQGM)
IF (ASSOCIATED (YL_ZQI)) CALL FIELD_DELETE (YL_ZQI)
IF (ASSOCIATED (YL_ZQIC)) CALL FIELD_DELETE (YL_ZQIC)
IF (ASSOCIATED (YL_ZQICE)) CALL FIELD_DELETE (YL_ZQICE)
IF (ASSOCIATED (YL_ZQL)) CALL FIELD_DELETE (YL_ZQL)
IF (ASSOCIATED (YL_ZQLC)) CALL FIELD_DELETE (YL_ZQLC)
IF (ASSOCIATED (YL_ZQLIS)) CALL FIELD_DELETE (YL_ZQLIS)
IF (ASSOCIATED (YL_ZQLIS0)) CALL FIELD_DELETE (YL_ZQLIS0)
IF (ASSOCIATED (YL_ZQLI_CVP)) CALL FIELD_DELETE (YL_ZQLI_CVP)
IF (ASSOCIATED (YL_ZQLI_CVPP)) CALL FIELD_DELETE (YL_ZQLI_CVPP)
IF (ASSOCIATED (YL_ZQO3)) CALL FIELD_DELETE (YL_ZQO3)
IF (ASSOCIATED (YL_ZQR)) CALL FIELD_DELETE (YL_ZQR)
IF (ASSOCIATED (YL_ZQS)) CALL FIELD_DELETE (YL_ZQS)
IF (ASSOCIATED (YL_ZQV)) CALL FIELD_DELETE (YL_ZQV)
IF (ASSOCIATED (YL_ZRDG_CVGQ)) CALL FIELD_DELETE (YL_ZRDG_CVGQ)
IF (ASSOCIATED (YL_ZRDG_CVGT)) CALL FIELD_DELETE (YL_ZRDG_CVGT)
IF (ASSOCIATED (YL_ZRDG_LCVQ)) CALL FIELD_DELETE (YL_ZRDG_LCVQ)
IF (ASSOCIATED (YL_ZRDG_MU0)) CALL FIELD_DELETE (YL_ZRDG_MU0)
IF (ASSOCIATED (YL_ZRDG_MU0LU)) CALL FIELD_DELETE (YL_ZRDG_MU0LU)
IF (ASSOCIATED (YL_ZRDG_MU0M)) CALL FIELD_DELETE (YL_ZRDG_MU0M)
IF (ASSOCIATED (YL_ZRDG_MU0N)) CALL FIELD_DELETE (YL_ZRDG_MU0N)
IF (ASSOCIATED (YL_ZRDG_SOLO)) CALL FIELD_DELETE (YL_ZRDG_SOLO)
IF (ASSOCIATED (YL_ZRTI)) CALL FIELD_DELETE (YL_ZRTI)
IF (ASSOCIATED (YL_ZSAV_DDAL)) CALL FIELD_DELETE (YL_ZSAV_DDAL)
IF (ASSOCIATED (YL_ZSAV_DDOM)) CALL FIELD_DELETE (YL_ZSAV_DDOM)
IF (ASSOCIATED (YL_ZSAV_ENTCH)) CALL FIELD_DELETE (YL_ZSAV_ENTCH)
IF (ASSOCIATED (YL_ZSAV_FHPS)) CALL FIELD_DELETE (YL_ZSAV_FHPS)
IF (ASSOCIATED (YL_ZSAV_GZ0F)) CALL FIELD_DELETE (YL_ZSAV_GZ0F)
IF (ASSOCIATED (YL_ZSAV_GZ0HF)) CALL FIELD_DELETE (YL_ZSAV_GZ0HF)
IF (ASSOCIATED (YL_ZSAV_HV)) CALL FIELD_DELETE (YL_ZSAV_HV)
IF (ASSOCIATED (YL_ZSAV_PBLH)) CALL FIELD_DELETE (YL_ZSAV_PBLH)
IF (ASSOCIATED (YL_ZSAV_QSH)) CALL FIELD_DELETE (YL_ZSAV_QSH)
IF (ASSOCIATED (YL_ZSAV_UDAL)) CALL FIELD_DELETE (YL_ZSAV_UDAL)
IF (ASSOCIATED (YL_ZSAV_UDGRO)) CALL FIELD_DELETE (YL_ZSAV_UDGRO)
IF (ASSOCIATED (YL_ZSAV_UDOM)) CALL FIELD_DELETE (YL_ZSAV_UDOM)
IF (ASSOCIATED (YL_ZSAV_UNEBH)) CALL FIELD_DELETE (YL_ZSAV_UNEBH)
IF (ASSOCIATED (YL_ZSC_FCLL)) CALL FIELD_DELETE (YL_ZSC_FCLL)
IF (ASSOCIATED (YL_ZSC_FCLN)) CALL FIELD_DELETE (YL_ZSC_FCLN)
IF (ASSOCIATED (YL_ZSC_FEVI)) CALL FIELD_DELETE (YL_ZSC_FEVI)
IF (ASSOCIATED (YL_ZSC_FEVN)) CALL FIELD_DELETE (YL_ZSC_FEVN)
IF (ASSOCIATED (YL_ZSEDIQI)) CALL FIELD_DELETE (YL_ZSEDIQI)
IF (ASSOCIATED (YL_ZSEDIQL)) CALL FIELD_DELETE (YL_ZSEDIQL)
IF (ASSOCIATED (YL_ZSFSWDIF)) CALL FIELD_DELETE (YL_ZSFSWDIF)
IF (ASSOCIATED (YL_ZSFSWDIR)) CALL FIELD_DELETE (YL_ZSFSWDIR)
IF (ASSOCIATED (YL_ZSGROUPEL)) CALL FIELD_DELETE (YL_ZSGROUPEL)
IF (ASSOCIATED (YL_ZSRAIN)) CALL FIELD_DELETE (YL_ZSRAIN)
IF (ASSOCIATED (YL_ZSSNOW)) CALL FIELD_DELETE (YL_ZSSNOW)
IF (ASSOCIATED (YL_ZSTAB)) CALL FIELD_DELETE (YL_ZSTAB)
IF (ASSOCIATED (YL_ZSUDU)) CALL FIELD_DELETE (YL_ZSUDU)
IF (ASSOCIATED (YL_ZTENHA)) CALL FIELD_DELETE (YL_ZTENHA)
IF (ASSOCIATED (YL_ZTENQVA)) CALL FIELD_DELETE (YL_ZTENQVA)
IF (ASSOCIATED (YL_ZTENT)) CALL FIELD_DELETE (YL_ZTENT)
IF (ASSOCIATED (YL_ZTHETAV)) CALL FIELD_DELETE (YL_ZTHETAV)
IF (ASSOCIATED (YL_ZTHETAVS)) CALL FIELD_DELETE (YL_ZTHETAVS)
IF (ASSOCIATED (YL_ZTKE1)) CALL FIELD_DELETE (YL_ZTKE1)
IF (ASSOCIATED (YL_ZTRAJGWD)) CALL FIELD_DELETE (YL_ZTRAJGWD)
IF (ASSOCIATED (YL_ZTRSOD)) CALL FIELD_DELETE (YL_ZTRSOD)
IF (ASSOCIATED (YL_ZTRSODIF)) CALL FIELD_DELETE (YL_ZTRSODIF)
IF (ASSOCIATED (YL_ZTRSODIR)) CALL FIELD_DELETE (YL_ZTRSODIR)
IF (ASSOCIATED (YL_ZTSN)) CALL FIELD_DELETE (YL_ZTSN)
IF (ASSOCIATED (YL_ZUGST)) CALL FIELD_DELETE (YL_ZUGST)
IF (ASSOCIATED (YL_ZUNEBH)) CALL FIELD_DELETE (YL_ZUNEBH)
IF (ASSOCIATED (YL_ZUSLE)) CALL FIELD_DELETE (YL_ZUSLE)
IF (ASSOCIATED (YL_ZVGST)) CALL FIELD_DELETE (YL_ZVGST)
IF (ASSOCIATED (YL_ZWFC)) CALL FIELD_DELETE (YL_ZWFC)
IF (ASSOCIATED (YL_ZWLMX)) CALL FIELD_DELETE (YL_ZWLMX)
IF (ASSOCIATED (YL_ZWPMX)) CALL FIELD_DELETE (YL_ZWPMX)
IF (ASSOCIATED (YL_ZWSEQ)) CALL FIELD_DELETE (YL_ZWSEQ)
IF (ASSOCIATED (YL_ZWSMX)) CALL FIELD_DELETE (YL_ZWSMX)
IF (ASSOCIATED (YL_ZWWILT)) CALL FIELD_DELETE (YL_ZWWILT)
IF (ASSOCIATED (YL_ZXDROV)) CALL FIELD_DELETE (YL_ZXDROV)
IF (ASSOCIATED (YL_ZXHROV)) CALL FIELD_DELETE (YL_ZXHROV)
IF (ASSOCIATED (YL_ZXQRO)) CALL FIELD_DELETE (YL_ZXQRO)
IF (ASSOCIATED (YL_ZXTRO)) CALL FIELD_DELETE (YL_ZXTRO)
IF (ASSOCIATED (YL_ZXTROV)) CALL FIELD_DELETE (YL_ZXTROV)
IF (ASSOCIATED (YL_ZXURO)) CALL FIELD_DELETE (YL_ZXURO)
IF (ASSOCIATED (YL_ZXUROV)) CALL FIELD_DELETE (YL_ZXUROV)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_PARALLEL
