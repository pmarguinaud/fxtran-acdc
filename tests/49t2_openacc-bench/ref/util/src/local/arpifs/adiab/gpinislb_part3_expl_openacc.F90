SUBROUTINE GPINISLB_PART3_EXPL_OPENACC (YDGEOMETRY, YDDYNA, KST, KEND, PVVEL0&
&, PZPRE0F, PB2VVEL, PB2GWF, PB2GDW, PB2GWS, PGWFT0, PGDW0, PGWS0, YDSTACK)
!$ACC ROUTINE (GPINISLB_PART3_EXPL_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB

USE GEOMETRY_MOD,ONLY:GEOMETRY
USE YOMDYNA,ONLY:TDYNA
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TDYNA), INTENT (IN)::YDDYNA
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PVVEL0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PZPRE0F (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2VVEL (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2GWF (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2GDW (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (INOUT)::PB2GWS (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PGWFT0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PGDW0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PGWS0 (YDGEOMETRY%YRDIM%NPROMA)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK

INTEGER (KIND=JPIM)::JLEV

INTEGER (KIND=JPIM) :: JROF

JROF = KST



DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
  PB2VVEL (JROF, JLEV)=PVVEL0 (JROF, JLEV)*PZPRE0F (JROF, JLEV)
ENDDO


IF (YDDYNA%LNHDYN.AND.YDDYNA%LGWADV.AND.YDGEOMETRY%YRVERT_GEOM%YRCVER&
  &%LVERTFE.AND.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVFE_GW) THEN

  IF (.NOT.(PRESENT (PGWFT0).AND.PRESENT (PGDW0).AND.PRESENT (PGWS0)))  THEN
    CALL FXTRAN_ACDC_ABORT (' GPINISLB 2a: missing optional input arguments!')
  ENDIF


  DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
    PB2GWF (JROF, JLEV)=PGWFT0 (JROF, JLEV)
    PB2GDW (JROF, JLEV)=PGDW0 (JROF, JLEV)
  ENDDO

  PB2GWS (JROF)=PGWS0 (JROF)
ENDIF



END SUBROUTINE GPINISLB_PART3_EXPL_OPENACC
