SUBROUTINE LAITLIF(YDTLSCAW,KASLB1,KPROMA,KFLEV,KST,KPROF,KL0,LDCOMAD,PLSCAW,PXSL,POUT,&
  LDADD,LD2D)

!$ACDC singlecolumn  --process-pointers

USE PARKIND1               , ONLY : JPIM, JPRB
USE YOMHOOK                , ONLY : LHOOK, DR_HOOK, JPHOOK
USE INTDYNSL_MOD           , ONLY : TLSCAW

IMPLICIT NONE

TYPE(TLSCAW),INTENT(IN) :: YDTLSCAW
INTEGER(KIND=JPIM),INTENT(IN) :: KASLB1,KPROMA,KFLEV,KST,KPROF
INTEGER(KIND=JPIM),INTENT(IN) :: KL0(KPROMA,KFLEV,0:3)
LOGICAL,INTENT(IN) :: LDCOMAD
LOGICAL,OPTIONAL,INTENT(IN) :: LDADD,LD2D
REAL(KIND=JPRB),INTENT(IN) :: PLSCAW(KPROMA,KFLEV,YDTLSCAW%NDIM)
! note: 2nd dim is 1 if LD2D=T but KFLEV is OK for PXSL and POUT
REAL(KIND=JPRB),INTENT(IN) :: PXSL(KASLB1,KFLEV+2)
REAL(KIND=JPRB),INTENT(OUT) :: POUT(KPROMA,KFLEV)

INTEGER(KIND=JPIM) :: IFLDN,IFLDX
INTEGER(KIND=JPIM) :: ILO(KPROMA,2)
LOGICAL :: LL2D
REAL(KIND=JPRB) :: ZDLO(KPROMA,2)
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE

#include "laitli.intfb.h"

IF (LHOOK) CALL DR_HOOK('LAITLIF',0,ZHOOK_HANDLE)

LL2D = .FALSE.
IF (PRESENT(LD2D)) LL2D = LD2D

IFLDN = 1
IFLDX = KFLEV+2

IF (LL2D) THEN
  ILO(:,:) = KL0(:,KFLEV,1:2)

  IF (LDCOMAD) THEN
    ZDLO(:,:) = PLSCAW(:,KFLEV,YDTLSCAW%M_WDLOMAD+1:YDTLSCAW%M_WDLOMAD+2)
    CALL LAITLI(KASLB1,KPROMA,KST,KPROF,1,IFLDN,IFLDX,&
     & PLSCAW(:,KFLEV,YDTLSCAW%M_WDLAMAD),ZDLO,ILO,&
     & PLSCAW(:,KFLEV,YDTLSCAW%M_WDVERMAD),PXSL,POUT,LDADD)
  ELSE
    ZDLO(:,:) = PLSCAW(:,KFLEV,YDTLSCAW%M_WDLO+1:YDTLSCAW%M_WDLO+2)
    CALL LAITLI(KASLB1,KPROMA,KST,KPROF,1,IFLDN,IFLDX,&
     & PLSCAW(:,KFLEV,YDTLSCAW%M_WDLAT),ZDLO,ILO,&
     & PLSCAW(:,KFLEV,YDTLSCAW%M_WDVER),PXSL,POUT,LDADD)
  ENDIF
ELSE
  IF (LDCOMAD) THEN
    CALL LAITLI(KASLB1,KPROMA,KST,KPROF,KFLEV,IFLDN,IFLDX,&
     & PLSCAW(:,:,YDTLSCAW%M_WDLAMAD),PLSCAW(:,:,YDTLSCAW%M_WDLOMAD+1),&
     & KL0(:,:,1:2),PLSCAW(:,:,YDTLSCAW%M_WDVERMAD),PXSL,POUT,LDADD)
  ELSE
    CALL LAITLI(KASLB1,KPROMA,KST,KPROF,KFLEV,IFLDN,IFLDX,&
     & PLSCAW(:,:,YDTLSCAW%M_WDLAT),PLSCAW(:,:,YDTLSCAW%M_WDLO+1),&
     & KL0(:,:,1:2),PLSCAW(:,:,YDTLSCAW%M_WDVER),PXSL,POUT,LDADD)
  ENDIF
ENDIF

IF (LHOOK) CALL DR_HOOK('LAITLIF',1,ZHOOK_HANDLE)
END SUBROUTINE LAITLIF
