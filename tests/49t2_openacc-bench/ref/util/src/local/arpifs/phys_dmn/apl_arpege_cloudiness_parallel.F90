SUBROUTINE APL_ARPEGE_CLOUDINESS_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC&
&, YDMF_PHYS, YDVARS, YDMODEL, LDREDPR, YD_PAIPCMT, YD_PBLH, YD_PDECRD, YD_PFLU_QSAT, YD_PMSC_QW&
&, YD_PNEBC0, YD_PNEBCH, YD_PNEBS, YD_PNEBS0, YD_PNEB_CVPP, YD_PPFL_FPLCH, YD_PQI, YD_PQL, YD_PQLIS&
&, YD_PQLIS0, YD_PQLI_CVP, YD_PQLI_CVPP, YD_PQV, YD_PUNEBH, YD_PCLCT_RAD, YDSTA)
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK

USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE TYPE_MODEL,ONLY:MODEL
USE YOMSTA,ONLY:TSTA
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL), INTENT (IN)::YDMODEL
LOGICAL, INTENT (IN)::LDREDPR
CLASS (FIELD_2RB), POINTER :: YD_PAIPCMT
REAL (KIND=JPRB), POINTER::PAIPCMT (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PBLH
REAL (KIND=JPRB), POINTER::PBLH (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDECRD
REAL (KIND=JPRB), POINTER::PDECRD (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFLU_QSAT
REAL (KIND=JPRB), POINTER::PFLU_QSAT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMSC_QW
REAL (KIND=JPRB), POINTER::PMSC_QW (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBC0
REAL (KIND=JPRB), POINTER::PNEBC0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBCH
REAL (KIND=JPRB), POINTER::PNEBCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBS
REAL (KIND=JPRB), POINTER::PNEBS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBS0
REAL (KIND=JPRB), POINTER::PNEBS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEB_CVPP
REAL (KIND=JPRB), POINTER::PNEB_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FPLCH
REAL (KIND=JPRB), POINTER::PPFL_FPLCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQI
REAL (KIND=JPRB), POINTER::PQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQL
REAL (KIND=JPRB), POINTER::PQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLIS
REAL (KIND=JPRB), POINTER::PQLIS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLIS0
REAL (KIND=JPRB), POINTER::PQLIS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLI_CVP
REAL (KIND=JPRB), POINTER::PQLI_CVP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLI_CVPP
REAL (KIND=JPRB), POINTER::PQLI_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQV
REAL (KIND=JPRB), POINTER::PQV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PUNEBH
REAL (KIND=JPRB), POINTER::PUNEBH (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCLCT_RAD
REAL (KIND=JPRB), POINTER::PCLCT_RAD (:,:)
TYPE (TSTA), INTENT (IN)::YDSTA
#include "acnebcond.intfb.h"
#include "abor1.intfb.h"
#include "acnebcond_openacc.intfb.h"
#include "acnebn.intfb.h"
#include "acnebn_openacc.intfb.h"
#include "acnpart.intfb.h"
#include "acnpart_openacc.intfb.h"
CLASS (FIELD_3RB), POINTER :: YL_ZICEFR1
REAL (KIND=JPRB), POINTER::ZICEFR1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRHCRI
REAL (KIND=JPRB), POINTER::ZRHCRI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQSATS
REAL (KIND=JPRB), POINTER::ZQSATS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRH
REAL (KIND=JPRB), POINTER::ZRH (:,:,:)
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_CLCT(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_NEB(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QICE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QLI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLCC(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLCH(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLCL(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLCM(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CTOP(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GM_T0(:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZRHCRI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRH, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQSATS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZICEFR1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => GET_HOST_DATA_RDONLY (YD_PAIPCMT)
  PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
  PDECRD => GET_HOST_DATA_RDONLY (YD_PDECRD)
  PFLU_QSAT => GET_HOST_DATA_RDONLY (YD_PFLU_QSAT)
  PMSC_QW => GET_HOST_DATA_RDONLY (YD_PMSC_QW)
  PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
  PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
  PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
  PNEB_CVPP => GET_HOST_DATA_RDONLY (YD_PNEB_CVPP)
  PPFL_FPLCH => GET_HOST_DATA_RDONLY (YD_PPFL_FPLCH)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
  PQLI_CVP => GET_HOST_DATA_RDONLY (YD_PQLI_CVP)
  PQLI_CVPP => GET_HOST_DATA_RDONLY (YD_PQLI_CVPP)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  PUNEBH => GET_HOST_DATA_RDONLY (YD_PUNEBH)
  ZICEFR1 => GET_HOST_DATA_RDWR (YL_ZICEFR1)
  ZQSATS => GET_HOST_DATA_RDWR (YL_ZQSATS)
  ZRH => GET_HOST_DATA_RDWR (YL_ZRH)
  ZRHCRI => GET_HOST_DATA_RDWR (YL_ZRHCRI)
  Z_YDCPG_MISC_CLCT => GET_HOST_DATA_RDWR (YDCPG_MISC%F_CLCT)
  Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCC)
  Z_YDMF_PHYS_OUT_CLCH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCH)
  Z_YDMF_PHYS_OUT_CLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCL)
  Z_YDMF_PHYS_OUT_CLCM => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCM)
  Z_YDMF_PHYS_OUT_CTOP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CTOP)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL ACNEBCOND (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
    &%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, LDREDPR, YDSTA, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
    &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), PQV(:,:, JBLK), PQI(:,:, JBLK&
    &), PQL(:,:, JBLK), PMSC_QW(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), PNEBCH(:,:, JBLK), Z_YDVARS_GEOMETRY_GM_T0&
    &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), PQLIS(:,:, JBLK), PNEBS(:,:, JBLK), ZRHCRI&
    &(:,:, JBLK), ZRH(:,:, JBLK), ZQSATS(:,:, JBLK), ZICEFR1(:,:, JBLK), PQLIS0(:,:, JBLK), PNEBS0(:&
    &,:, JBLK))

    IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN) THEN
      CALL ACNEBN (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON,&
      & YDMODEL%YRML_PHY_MF%YRTOPH%NTNEBU, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK&
      &), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), PQV(:,:, JBLK), PQL(:,:, JBLK), PQI(:,:, JBLK)&
      &, PFLU_QSAT(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), PPFL_FPLCH(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), PUNEBH(:,:, JBLK), PNEBS0(:,:, JBLK), PQLIS0(:,:, JBLK), PQLI_CVP(:,:, JBLK), PNEB_CVPP&
      &(:,:, JBLK), PQLI_CVPP(:,:, JBLK), PAIPCMT(:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), PNEBC0(:,:, JBLK),&
      & Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), YDSTA)

      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON&
          &, JLEV, JBLK)*YDMODEL%YRML_PHY_MF%YRPHY0%GAEPS
        ENDDO

      ENDDO

    ENDIF

    CALL ACNPART (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON&
    &, YDMODEL%YRML_PHY_MF%YRTOPH%NTNEBU, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK&
    &), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK&
    &), PDECRD(:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), Z_YDMF_PHYS_OUT_CLCH(:, JBLK), Z_YDMF_PHYS_OUT_CLCM&
    &(:, JBLK), Z_YDMF_PHYS_OUT_CLCL(:, JBLK), Z_YDCPG_MISC_CLCT(:, JBLK), PCLCT_RAD(:, JBLK), PCLCC=Z_YDMF_PHYS_OUT_CLCC&
    &(:, JBLK), PNEBC=PNEBC0(:,:, JBLK), PTOPC=Z_YDMF_PHYS_OUT_CTOP(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
    &:ACNEBCOND:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
    PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
    PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
    PFLU_QSAT => GET_HOST_DATA_RDWR (YD_PFLU_QSAT)
    PMSC_QW => GET_HOST_DATA_RDWR (YD_PMSC_QW)
    PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
    PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
    PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
    ZICEFR1 => GET_HOST_DATA_RDWR (YL_ZICEFR1)
    ZQSATS => GET_HOST_DATA_RDWR (YL_ZQSATS)
    ZRH => GET_HOST_DATA_RDWR (YL_ZRH)
    ZRHCRI => GET_HOST_DATA_RDWR (YL_ZRHCRI)
    Z_YDCPG_MISC_CLCT => GET_HOST_DATA_RDWR (YDCPG_MISC%F_CLCT)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCC)
    Z_YDMF_PHYS_OUT_CLCH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCH)
    Z_YDMF_PHYS_OUT_CLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCL)
    Z_YDMF_PHYS_OUT_CLCM => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCM)
    Z_YDMF_PHYS_OUT_CTOP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CTOP)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
    &:ACNEBCOND:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => NULL ()
  PCLCT_RAD => NULL ()
  PDECRD => NULL ()
  PFLU_QSAT => NULL ()
  PMSC_QW => NULL ()
  PNEBC0 => NULL ()
  PNEBCH => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PNEB_CVPP => NULL ()
  PPFL_FPLCH => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQLI_CVP => NULL ()
  PQLI_CVPP => NULL ()
  PQV => NULL ()
  PUNEBH => NULL ()
  ZICEFR1 => NULL ()
  ZQSATS => NULL ()
  ZRH => NULL ()
  ZRHCRI => NULL ()
  Z_YDCPG_MISC_CLCT => NULL ()
  Z_YDCPG_MISC_NEB => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLCC => NULL ()
  Z_YDMF_PHYS_OUT_CLCH => NULL ()
  Z_YDMF_PHYS_OUT_CLCL => NULL ()
  Z_YDMF_PHYS_OUT_CLCM => NULL ()
  Z_YDMF_PHYS_OUT_CTOP => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN&
  &','APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => GET_HOST_DATA_RDONLY (YD_PAIPCMT)
  PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
  PDECRD => GET_HOST_DATA_RDONLY (YD_PDECRD)
  PFLU_QSAT => GET_HOST_DATA_RDONLY (YD_PFLU_QSAT)
  PMSC_QW => GET_HOST_DATA_RDONLY (YD_PMSC_QW)
  PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
  PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
  PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
  PNEB_CVPP => GET_HOST_DATA_RDONLY (YD_PNEB_CVPP)
  PPFL_FPLCH => GET_HOST_DATA_RDONLY (YD_PPFL_FPLCH)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
  PQLI_CVP => GET_HOST_DATA_RDONLY (YD_PQLI_CVP)
  PQLI_CVPP => GET_HOST_DATA_RDONLY (YD_PQLI_CVPP)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  PUNEBH => GET_HOST_DATA_RDONLY (YD_PUNEBH)
  ZICEFR1 => GET_HOST_DATA_RDWR (YL_ZICEFR1)
  ZQSATS => GET_HOST_DATA_RDWR (YL_ZQSATS)
  ZRH => GET_HOST_DATA_RDWR (YL_ZRH)
  ZRHCRI => GET_HOST_DATA_RDWR (YL_ZRHCRI)
  Z_YDCPG_MISC_CLCT => GET_HOST_DATA_RDWR (YDCPG_MISC%F_CLCT)
  Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCC)
  Z_YDMF_PHYS_OUT_CLCH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCH)
  Z_YDMF_PHYS_OUT_CLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCL)
  Z_YDMF_PHYS_OUT_CLCM => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCM)
  Z_YDMF_PHYS_OUT_CTOP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CTOP)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACNEBCOND_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, LDREDPR&
      &, YDSTA, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,&
      & JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), PQV(:,:, JBLK), PQI(:,:, JBLK), PQL(:,:, JBLK), PMSC_QW(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), PNEBCH(:,:, JBLK), Z_YDVARS_GEOMETRY_GM_T0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
      &(:, JBLK), PQLIS(:,:, JBLK), PNEBS(:,:, JBLK), ZRHCRI(:,:, JBLK), ZRH(:,:, JBLK), ZQSATS(:,:, JBLK&
      &), ZICEFR1(:,:, JBLK), PQLIS0(:,:, JBLK), PNEBS0(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN) THEN
        CALL ACNEBN_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
        &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTNEBU, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), PQV(:,:, JBLK), PQL(:,:, JBLK&
        &), PQI(:,:, JBLK), PFLU_QSAT(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), PPFL_FPLCH(:,:&
        &, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), PUNEBH(:,:, JBLK), PNEBS0(:&
        &,:, JBLK), PQLIS0(:,:, JBLK), PQLI_CVP(:,:, JBLK), PNEB_CVPP(:,:, JBLK), PQLI_CVPP(:,:, JBLK&
        &), PAIPCMT(:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), PNEBC0(:,:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK&
        &), Z_YDCPG_MISC_QLI(:,:, JBLK), YDSTA,YDSTACK=YLSTACK)

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON&
          &, JLEV, JBLK)*YDMODEL%YRML_PHY_MF%YRPHY0%GAEPS
        
        ENDDO

      ENDIF

      CALL ACNPART_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTNEBU, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), PDECRD(:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), Z_YDMF_PHYS_OUT_CLCH(:, JBLK)&
      &, Z_YDMF_PHYS_OUT_CLCM(:, JBLK), Z_YDMF_PHYS_OUT_CLCL(:, JBLK), Z_YDCPG_MISC_CLCT(:, JBLK&
      &), PCLCT_RAD(:, JBLK), PCLCC=Z_YDMF_PHYS_OUT_CLCC(:, JBLK), PNEBC=PNEBC0(:,:, JBLK), PTOPC&
      &=Z_YDMF_PHYS_OUT_CTOP(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
    &:ACNEBCOND:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
    PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
    PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
    PFLU_QSAT => GET_HOST_DATA_RDWR (YD_PFLU_QSAT)
    PMSC_QW => GET_HOST_DATA_RDWR (YD_PMSC_QW)
    PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
    PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
    PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
    ZICEFR1 => GET_HOST_DATA_RDWR (YL_ZICEFR1)
    ZQSATS => GET_HOST_DATA_RDWR (YL_ZQSATS)
    ZRH => GET_HOST_DATA_RDWR (YL_ZRH)
    ZRHCRI => GET_HOST_DATA_RDWR (YL_ZRHCRI)
    Z_YDCPG_MISC_CLCT => GET_HOST_DATA_RDWR (YDCPG_MISC%F_CLCT)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCC)
    Z_YDMF_PHYS_OUT_CLCH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCH)
    Z_YDMF_PHYS_OUT_CLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCL)
    Z_YDMF_PHYS_OUT_CLCM => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCM)
    Z_YDMF_PHYS_OUT_CTOP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CTOP)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
    &:ACNEBCOND:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => NULL ()
  PCLCT_RAD => NULL ()
  PDECRD => NULL ()
  PFLU_QSAT => NULL ()
  PMSC_QW => NULL ()
  PNEBC0 => NULL ()
  PNEBCH => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PNEB_CVPP => NULL ()
  PPFL_FPLCH => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQLI_CVP => NULL ()
  PQLI_CVPP => NULL ()
  PQV => NULL ()
  PUNEBH => NULL ()
  ZICEFR1 => NULL ()
  ZQSATS => NULL ()
  ZRH => NULL ()
  ZRHCRI => NULL ()
  Z_YDCPG_MISC_CLCT => NULL ()
  Z_YDCPG_MISC_NEB => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLCC => NULL ()
  Z_YDMF_PHYS_OUT_CLCH => NULL ()
  Z_YDMF_PHYS_OUT_CLCL => NULL ()
  Z_YDMF_PHYS_OUT_CLCM => NULL ()
  Z_YDMF_PHYS_OUT_CTOP => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN&
  &','APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => GET_DEVICE_DATA_RDONLY (YD_PAIPCMT)
  PCLCT_RAD => GET_DEVICE_DATA_RDWR (YD_PCLCT_RAD)
  PDECRD => GET_DEVICE_DATA_RDONLY (YD_PDECRD)
  PFLU_QSAT => GET_DEVICE_DATA_RDONLY (YD_PFLU_QSAT)
  PMSC_QW => GET_DEVICE_DATA_RDONLY (YD_PMSC_QW)
  PNEBC0 => GET_DEVICE_DATA_RDWR (YD_PNEBC0)
  PNEBCH => GET_DEVICE_DATA_RDWR (YD_PNEBCH)
  PNEBS => GET_DEVICE_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_DEVICE_DATA_RDWR (YD_PNEBS0)
  PNEB_CVPP => GET_DEVICE_DATA_RDONLY (YD_PNEB_CVPP)
  PPFL_FPLCH => GET_DEVICE_DATA_RDONLY (YD_PPFL_FPLCH)
  PQI => GET_DEVICE_DATA_RDONLY (YD_PQI)
  PQL => GET_DEVICE_DATA_RDONLY (YD_PQL)
  PQLIS => GET_DEVICE_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_DEVICE_DATA_RDWR (YD_PQLIS0)
  PQLI_CVP => GET_DEVICE_DATA_RDONLY (YD_PQLI_CVP)
  PQLI_CVPP => GET_DEVICE_DATA_RDONLY (YD_PQLI_CVPP)
  PQV => GET_DEVICE_DATA_RDONLY (YD_PQV)
  PUNEBH => GET_DEVICE_DATA_RDONLY (YD_PUNEBH)
  ZICEFR1 => GET_DEVICE_DATA_RDWR (YL_ZICEFR1)
  ZQSATS => GET_DEVICE_DATA_RDWR (YL_ZQSATS)
  ZRH => GET_DEVICE_DATA_RDWR (YL_ZRH)
  ZRHCRI => GET_DEVICE_DATA_RDWR (YL_ZRHCRI)
  Z_YDCPG_MISC_CLCT => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_CLCT)
  Z_YDCPG_MISC_NEB => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_NEB)
  Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLCC => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CLCC)
  Z_YDMF_PHYS_OUT_CLCH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CLCH)
  Z_YDMF_PHYS_OUT_CLCL => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CLCL)
  Z_YDMF_PHYS_OUT_CLCM => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CLCM)
  Z_YDMF_PHYS_OUT_CTOP => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CTOP)
  Z_YDVARS_GEOMETRY_GM_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PAIPCMT, PCLCT_RAD, PDECRD, PFLU_QSAT, PMSC_QW, PNEBC0, PNEBCH, PNEBS, &
    !$ACC&         PNEBS0, PNEB_CVPP, PPFL_FPLCH, PQI, PQL, PQLIS, PQLIS0, PQLI_CVP, PQLI_CVPP, &
    !$ACC&         PQV, PUNEBH, YDCPG_OPTS, YDMODEL, YDSTA, YFXTRAN_ACDC_STACK, ZICEFR1, &
    !$ACC&         ZQSATS, ZRH, ZRHCRI, Z_YDCPG_MISC_CLCT, Z_YDCPG_MISC_NEB, Z_YDCPG_MISC_QICE, &
    !$ACC&         Z_YDCPG_MISC_QLI, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, Z_YDMF_PHYS_OUT_CLCC, &
    !$ACC&         Z_YDMF_PHYS_OUT_CLCH, Z_YDMF_PHYS_OUT_CLCL, Z_YDMF_PHYS_OUT_CLCM, &
    !$ACC&         Z_YDMF_PHYS_OUT_CTOP, Z_YDVARS_GEOMETRY_GM_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL ACNEBCOND_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA&
      &, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTPLUI, YDCPG_OPTS%KFLEVG, LDREDPR&
      &, YDSTA, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,&
      & JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
      &(:,:, JBLK), PQV(:,:, JBLK), PQI(:,:, JBLK), PQL(:,:, JBLK), PMSC_QW(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T&
      &(:,:, JBLK), PNEBCH(:,:, JBLK), Z_YDVARS_GEOMETRY_GM_T0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
      &(:, JBLK), PQLIS(:,:, JBLK), PNEBS(:,:, JBLK), ZRHCRI(:,:, JBLK), ZRH(:,:, JBLK), ZQSATS(:,:, JBLK&
      &), ZICEFR1(:,:, JBLK), PQLIS0(:,:, JBLK), PNEBS0(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN) THEN
        CALL ACNEBN_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS&
        &%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTNEBU, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP(:,:, JBLK), PQV(:,:, JBLK), PQL(:,:, JBLK&
        &), PQI(:,:, JBLK), PFLU_QSAT(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), PPFL_FPLCH(:,:&
        &, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), PUNEBH(:,:, JBLK), PNEBS0(:&
        &,:, JBLK), PQLIS0(:,:, JBLK), PQLI_CVP(:,:, JBLK), PNEB_CVPP(:,:, JBLK), PQLI_CVPP(:,:, JBLK&
        &), PAIPCMT(:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), PNEBC0(:,:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK&
        &), Z_YDCPG_MISC_QLI(:,:, JBLK), YDSTA,YDSTACK=YLSTACK)

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          Z_YDCPG_MISC_NEB (JLON, JLEV, JBLK)=Z_YDCPG_MISC_NEB (JLON&
          &, JLEV, JBLK)*YDMODEL%YRML_PHY_MF%YRPHY0%GAEPS
        
        ENDDO

      ENDIF

      CALL ACNPART_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTNEBU, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), PDECRD(:, JBLK), Z_YDCPG_MISC_NEB(:,:, JBLK), Z_YDMF_PHYS_OUT_CLCH(:, JBLK)&
      &, Z_YDMF_PHYS_OUT_CLCM(:, JBLK), Z_YDMF_PHYS_OUT_CLCL(:, JBLK), Z_YDCPG_MISC_CLCT(:, JBLK&
      &), PCLCT_RAD(:, JBLK), PCLCC=Z_YDMF_PHYS_OUT_CLCC(:, JBLK), PNEBC=PNEBC0(:,:, JBLK), PTOPC&
      &=Z_YDMF_PHYS_OUT_CTOP(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
    &:ACNEBCOND:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
    PCLCT_RAD => GET_HOST_DATA_RDWR (YD_PCLCT_RAD)
    PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
    PFLU_QSAT => GET_HOST_DATA_RDWR (YD_PFLU_QSAT)
    PMSC_QW => GET_HOST_DATA_RDWR (YD_PMSC_QW)
    PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
    PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
    PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
    ZICEFR1 => GET_HOST_DATA_RDWR (YL_ZICEFR1)
    ZQSATS => GET_HOST_DATA_RDWR (YL_ZQSATS)
    ZRH => GET_HOST_DATA_RDWR (YL_ZRH)
    ZRHCRI => GET_HOST_DATA_RDWR (YL_ZRHCRI)
    Z_YDCPG_MISC_CLCT => GET_HOST_DATA_RDWR (YDCPG_MISC%F_CLCT)
    Z_YDCPG_MISC_NEB => GET_HOST_DATA_RDWR (YDCPG_MISC%F_NEB)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLCC => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCC)
    Z_YDMF_PHYS_OUT_CLCH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCH)
    Z_YDMF_PHYS_OUT_CLCL => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCL)
    Z_YDMF_PHYS_OUT_CLCM => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLCM)
    Z_YDMF_PHYS_OUT_CTOP => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CTOP)
    Z_YDVARS_GEOMETRY_GM_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
    &:ACNEBCOND:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => NULL ()
  PCLCT_RAD => NULL ()
  PDECRD => NULL ()
  PFLU_QSAT => NULL ()
  PMSC_QW => NULL ()
  PNEBC0 => NULL ()
  PNEBCH => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PNEB_CVPP => NULL ()
  PPFL_FPLCH => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQLI_CVP => NULL ()
  PQLI_CVPP => NULL ()
  PQV => NULL ()
  PUNEBH => NULL ()
  ZICEFR1 => NULL ()
  ZQSATS => NULL ()
  ZRH => NULL ()
  ZRHCRI => NULL ()
  Z_YDCPG_MISC_CLCT => NULL ()
  Z_YDCPG_MISC_NEB => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_CP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLCC => NULL ()
  Z_YDMF_PHYS_OUT_CLCH => NULL ()
  Z_YDMF_PHYS_OUT_CLCL => NULL ()
  Z_YDMF_PHYS_OUT_CLCM => NULL ()
  Z_YDMF_PHYS_OUT_CTOP => NULL ()
  Z_YDVARS_GEOMETRY_GM_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL&
  &:ACNEBCOND:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_CLOUDINESS_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL:ACNEBCOND',1,ZHOOK_HANDLE_PARALLEL)


CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZICEFR1)) CALL FIELD_DELETE (YL_ZICEFR1)
IF (ASSOCIATED (YL_ZQSATS)) CALL FIELD_DELETE (YL_ZQSATS)
IF (ASSOCIATED (YL_ZRH)) CALL FIELD_DELETE (YL_ZRH)
IF (ASSOCIATED (YL_ZRHCRI)) CALL FIELD_DELETE (YL_ZRHCRI)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_CLOUDINESS_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_CLOUDINESS_PARALLEL
