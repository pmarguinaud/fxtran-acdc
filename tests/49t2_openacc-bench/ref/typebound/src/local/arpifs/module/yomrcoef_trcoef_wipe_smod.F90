SUBMODULE (YOMRCOEF) YOMRCOEF_TRCOEF_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TRCOEF (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TRCOEF), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LSOLRAD, LTHERRAD, LTRMATSUM, LTRWEIGHT
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LSOLRAD = ALLOCATED (SELF%SOLRAD)
IF (LSOLRAD) THEN
  !$ACC EXIT DATA DETACH (SELF%SOLRAD)
  !$ACC EXIT DATA DELETE (SELF%SOLRAD)
ENDIF

LTHERRAD = ALLOCATED (SELF%THERRAD)
IF (LTHERRAD) THEN
  !$ACC EXIT DATA DETACH (SELF%THERRAD)
  !$ACC EXIT DATA DELETE (SELF%THERRAD)
ENDIF

LTRWEIGHT = ALLOCATED (SELF%TRWEIGHT)
IF (LTRWEIGHT) THEN
  !$ACC EXIT DATA DETACH (SELF%TRWEIGHT)
  !$ACC EXIT DATA DELETE (SELF%TRWEIGHT)
ENDIF

LTRMATSUM = ALLOCATED (SELF%TRMATSUM)
IF (LTRMATSUM) THEN
  !$ACC EXIT DATA DETACH (SELF%TRMATSUM)
  !$ACC EXIT DATA DELETE (SELF%TRMATSUM)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
