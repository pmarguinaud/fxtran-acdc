SUBMODULE (STOPH_MIX) STOPH_MIX_TSTOPH_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TSTOPH (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TSTOPH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LALPHA_STO, LALPHA_STO_T, LGPSTREAM, LGPTEMP, LGPTOTDISS, LGPTOTDISS_SMOOTH, LGPVELPOT, LGPVORTGRAD, LMCELL, LNIMRAN
LOGICAL :: LONEMINALPHA_NFRSPBS, LONEMINALPHA_NFRSPBS_T, LRSMOOTH, LRSTOPHCA, LRVP_MUL, LRVP_MULFACT, LRVP_MULFACT_T, LRVP_MUL_T, LRWGHT, LSPDP
LOGICAL :: LSPG_AMP, LSPG_AMP_T, LSPSTREAM, LSPSTREAM_FORC, LSPTEMP, LSPTEMP_FORC, LSPVELPOT, LSPVELPOT_FORC, LSQRTCORR, LTAPER_FACT
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LRSTOPHCA = ALLOCATED (SELF%RSTOPHCA)
IF (LRSTOPHCA) THEN
  !$ACC EXIT DATA DETACH (SELF%RSTOPHCA)
  !$ACC EXIT DATA DELETE (SELF%RSTOPHCA)
ENDIF

LSQRTCORR = ALLOCATED (SELF%SQRTCORR)
IF (LSQRTCORR) THEN
  !$ACC EXIT DATA DETACH (SELF%SQRTCORR)
  !$ACC EXIT DATA DELETE (SELF%SQRTCORR)
ENDIF

LSPSTREAM = ALLOCATED (SELF%SPSTREAM)
IF (LSPSTREAM) THEN
  !$ACC EXIT DATA DETACH (SELF%SPSTREAM)
  !$ACC EXIT DATA DELETE (SELF%SPSTREAM)
ENDIF

LSPVELPOT = ALLOCATED (SELF%SPVELPOT)
IF (LSPVELPOT) THEN
  !$ACC EXIT DATA DETACH (SELF%SPVELPOT)
  !$ACC EXIT DATA DELETE (SELF%SPVELPOT)
ENDIF

LSPSTREAM_FORC = ALLOCATED (SELF%SPSTREAM_FORC)
IF (LSPSTREAM_FORC) THEN
  !$ACC EXIT DATA DETACH (SELF%SPSTREAM_FORC)
  !$ACC EXIT DATA DELETE (SELF%SPSTREAM_FORC)
ENDIF

LSPVELPOT_FORC = ALLOCATED (SELF%SPVELPOT_FORC)
IF (LSPVELPOT_FORC) THEN
  !$ACC EXIT DATA DETACH (SELF%SPVELPOT_FORC)
  !$ACC EXIT DATA DELETE (SELF%SPVELPOT_FORC)
ENDIF

LSPG_AMP = ALLOCATED (SELF%SPG_AMP)
IF (LSPG_AMP) THEN
  !$ACC EXIT DATA DETACH (SELF%SPG_AMP)
  !$ACC EXIT DATA DELETE (SELF%SPG_AMP)
ENDIF

LALPHA_STO = ALLOCATED (SELF%ALPHA_STO)
IF (LALPHA_STO) THEN
  !$ACC EXIT DATA DETACH (SELF%ALPHA_STO)
  !$ACC EXIT DATA DELETE (SELF%ALPHA_STO)
ENDIF

LONEMINALPHA_NFRSPBS = ALLOCATED (SELF%ONEMINALPHA_NFRSPBS)
IF (LONEMINALPHA_NFRSPBS) THEN
  !$ACC EXIT DATA DETACH (SELF%ONEMINALPHA_NFRSPBS)
  !$ACC EXIT DATA DELETE (SELF%ONEMINALPHA_NFRSPBS)
ENDIF

LRSMOOTH = ALLOCATED (SELF%RSMOOTH)
IF (LRSMOOTH) THEN
  !$ACC EXIT DATA DETACH (SELF%RSMOOTH)
  !$ACC EXIT DATA DELETE (SELF%RSMOOTH)
ENDIF

LGPSTREAM = ALLOCATED (SELF%GPSTREAM)
IF (LGPSTREAM) THEN
  !$ACC EXIT DATA DETACH (SELF%GPSTREAM)
  !$ACC EXIT DATA DELETE (SELF%GPSTREAM)
ENDIF

LGPVELPOT = ALLOCATED (SELF%GPVELPOT)
IF (LGPVELPOT) THEN
  !$ACC EXIT DATA DETACH (SELF%GPVELPOT)
  !$ACC EXIT DATA DELETE (SELF%GPVELPOT)
ENDIF

LGPTOTDISS = ALLOCATED (SELF%GPTOTDISS)
IF (LGPTOTDISS) THEN
  !$ACC EXIT DATA DETACH (SELF%GPTOTDISS)
  !$ACC EXIT DATA DELETE (SELF%GPTOTDISS)
ENDIF

LGPTOTDISS_SMOOTH = ALLOCATED (SELF%GPTOTDISS_SMOOTH)
IF (LGPTOTDISS_SMOOTH) THEN
  !$ACC EXIT DATA DETACH (SELF%GPTOTDISS_SMOOTH)
  !$ACC EXIT DATA DELETE (SELF%GPTOTDISS_SMOOTH)
ENDIF

LGPVORTGRAD = ALLOCATED (SELF%GPVORTGRAD)
IF (LGPVORTGRAD) THEN
  !$ACC EXIT DATA DETACH (SELF%GPVORTGRAD)
  !$ACC EXIT DATA DELETE (SELF%GPVORTGRAD)
ENDIF

LMCELL = ALLOCATED (SELF%MCELL)
IF (LMCELL) THEN
  !$ACC EXIT DATA DETACH (SELF%MCELL)
  !$ACC EXIT DATA DELETE (SELF%MCELL)
ENDIF

LRWGHT = ALLOCATED (SELF%RWGHT)
IF (LRWGHT) THEN
  !$ACC EXIT DATA DETACH (SELF%RWGHT)
  !$ACC EXIT DATA DELETE (SELF%RWGHT)
ENDIF

LSPDP = ALLOCATED (SELF%SPDP)
IF (LSPDP) THEN
  !$ACC EXIT DATA DETACH (SELF%SPDP)
  !$ACC EXIT DATA DELETE (SELF%SPDP)
ENDIF

LNIMRAN = ALLOCATED (SELF%NIMRAN)
IF (LNIMRAN) THEN
  !$ACC EXIT DATA DETACH (SELF%NIMRAN)
  !$ACC EXIT DATA DELETE (SELF%NIMRAN)
ENDIF

LRVP_MULFACT = ALLOCATED (SELF%RVP_MULFACT)
IF (LRVP_MULFACT) THEN
  !$ACC EXIT DATA DETACH (SELF%RVP_MULFACT)
  !$ACC EXIT DATA DELETE (SELF%RVP_MULFACT)
ENDIF

LRVP_MUL = ALLOCATED (SELF%RVP_MUL)
IF (LRVP_MUL) THEN
  !$ACC EXIT DATA DETACH (SELF%RVP_MUL)
  !$ACC EXIT DATA DELETE (SELF%RVP_MUL)
ENDIF

LTAPER_FACT = ALLOCATED (SELF%TAPER_FACT)
IF (LTAPER_FACT) THEN
  !$ACC EXIT DATA DETACH (SELF%TAPER_FACT)
  !$ACC EXIT DATA DELETE (SELF%TAPER_FACT)
ENDIF

LSPTEMP = ALLOCATED (SELF%SPTEMP)
IF (LSPTEMP) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTEMP)
  !$ACC EXIT DATA DELETE (SELF%SPTEMP)
ENDIF

LSPTEMP_FORC = ALLOCATED (SELF%SPTEMP_FORC)
IF (LSPTEMP_FORC) THEN
  !$ACC EXIT DATA DETACH (SELF%SPTEMP_FORC)
  !$ACC EXIT DATA DELETE (SELF%SPTEMP_FORC)
ENDIF

LSPG_AMP_T = ALLOCATED (SELF%SPG_AMP_T)
IF (LSPG_AMP_T) THEN
  !$ACC EXIT DATA DETACH (SELF%SPG_AMP_T)
  !$ACC EXIT DATA DELETE (SELF%SPG_AMP_T)
ENDIF

LALPHA_STO_T = ALLOCATED (SELF%ALPHA_STO_T)
IF (LALPHA_STO_T) THEN
  !$ACC EXIT DATA DETACH (SELF%ALPHA_STO_T)
  !$ACC EXIT DATA DELETE (SELF%ALPHA_STO_T)
ENDIF

LONEMINALPHA_NFRSPBS_T = ALLOCATED (SELF%ONEMINALPHA_NFRSPBS_T)
IF (LONEMINALPHA_NFRSPBS_T) THEN
  !$ACC EXIT DATA DETACH (SELF%ONEMINALPHA_NFRSPBS_T)
  !$ACC EXIT DATA DELETE (SELF%ONEMINALPHA_NFRSPBS_T)
ENDIF

LGPTEMP = ALLOCATED (SELF%GPTEMP)
IF (LGPTEMP) THEN
  !$ACC EXIT DATA DETACH (SELF%GPTEMP)
  !$ACC EXIT DATA DELETE (SELF%GPTEMP)
ENDIF

LRVP_MULFACT_T = ALLOCATED (SELF%RVP_MULFACT_T)
IF (LRVP_MULFACT_T) THEN
  !$ACC EXIT DATA DETACH (SELF%RVP_MULFACT_T)
  !$ACC EXIT DATA DELETE (SELF%RVP_MULFACT_T)
ENDIF

LRVP_MUL_T = ALLOCATED (SELF%RVP_MUL_T)
IF (LRVP_MUL_T) THEN
  !$ACC EXIT DATA DETACH (SELF%RVP_MUL_T)
  !$ACC EXIT DATA DELETE (SELF%RVP_MUL_T)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
