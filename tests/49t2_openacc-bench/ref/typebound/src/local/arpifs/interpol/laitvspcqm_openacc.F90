SUBROUTINE LAITVSPCQM_OPENACC (YDVSLETA, KSLB1, KPROMA, KST, KEND, KFLEV, KFLDN&
&, KFLDX, PDLAT, PCLA, PDLO, PCLO, KL0, PVINTWS, PXSPSL, PXF, PXSL, YDSTACK)
!$ACC ROUTINE (LAITVSPCQM_OPENACC) SEQ
USE YOMVSLETA,ONLY:TVSLETA
USE PARKIND1,ONLY:JPIM, JPRB, JPIB

#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (TVSLETA), INTENT (IN)::YDVSLETA
INTEGER (KIND=JPIM), INTENT (IN)::KSLB1
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KFLDN
INTEGER (KIND=JPIM), INTENT (IN)::KFLDX
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PDLAT (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PCLA (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (IN)::PDLO (KPROMA, KFLEV, 0:3)
REAL (KIND=JPRB), INTENT (IN)::PCLO (KPROMA, KFLEV, 3, 2)
INTEGER (KIND=JPIM), INTENT (IN)::KL0 (KPROMA, KFLEV, 0:3)
REAL (KIND=JPRB), INTENT (IN)::PVINTWS (KPROMA, KFLEV, 1:4)
REAL (KIND=JPRB), INTENT (IN)::PXSPSL (KSLB1*(KFLDX-KFLDN+1))
REAL (KIND=JPRB), INTENT (OUT)::PXF (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PXSL (KSLB1*(KFLDX-KFLDN+1))
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIB)::IV3L3
INTEGER (KIND=JPIB)::IV3L2
INTEGER (KIND=JPIB)::IV3L1
INTEGER (KIND=JPIB)::IV3L0
INTEGER (KIND=JPIB)::IV2L3
INTEGER (KIND=JPIB)::IV2L2
INTEGER (KIND=JPIB)::IV2L1
INTEGER (KIND=JPIB)::IV2L0
INTEGER (KIND=JPIB)::IV1L3
INTEGER (KIND=JPIB)::IV1L2
INTEGER (KIND=JPIB)::IV1L1
INTEGER (KIND=JPIB)::IV1L0
INTEGER (KIND=JPIB)::IV0L3
INTEGER (KIND=JPIB)::IV0L2
INTEGER (KIND=JPIB)::IV0L1
INTEGER (KIND=JPIB)::IV0L0
INTEGER (KIND=JPIM)::ILEVQMV
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZSURPL 
REAL (KIND=JPRB)::ZF2
REAL (KIND=JPRB)::ZF1
REAL (KIND=JPRB)::ZMAX
REAL (KIND=JPRB)::ZMIN
REAL (KIND=JPRB)::ZXF
REAL (KIND=JPRB)::ZDMAX
REAL (KIND=JPRB)::ZDMIN
REAL (KIND=JPRB)::ZF222
REAL (KIND=JPRB)::ZF221
REAL (KIND=JPRB)::ZF212
REAL (KIND=JPRB)::ZF211
REAL (KIND=JPRB)::ZF122
REAL (KIND=JPRB)::ZF121
REAL (KIND=JPRB)::ZF112
REAL (KIND=JPRB)::ZF111
REAL (KIND=JPRB)::ZCLO32
REAL (KIND=JPRB)::ZCLO22
REAL (KIND=JPRB)::ZCLO12
REAL (KIND=JPRB)::ZCLO31
REAL (KIND=JPRB)::ZCLO21
REAL (KIND=JPRB)::ZCLO11
REAL (KIND=JPRB)::ZLA3
REAL (KIND=JPRB)::ZLA2
REAL (KIND=JPRB)::ZLA1
REAL (KIND=JPRB)::ZLA0
REAL (KIND=JPRB)::ZLA3LO2
REAL (KIND=JPRB)::ZLA3LO1
REAL (KIND=JPRB)::ZLA2LO3
REAL (KIND=JPRB)::ZLA2LO2
REAL (KIND=JPRB)::ZLA2LO1
REAL (KIND=JPRB)::ZLA2LO
REAL (KIND=JPRB)::ZLA1LO3
REAL (KIND=JPRB)::ZLA1LO2
REAL (KIND=JPRB)::ZLA1LO1
REAL (KIND=JPRB)::ZLA1LO
REAL (KIND=JPRB)::ZLA0LO2
REAL (KIND=JPRB)::ZLA0LO1
REAL (KIND=JPRB)::ZDLO3
REAL (KIND=JPRB)::ZDLO0
REAL (KIND=JPRB)::ZCLA3
REAL (KIND=JPRB)::ZCLA2
REAL (KIND=JPRB)::ZCLA1


JROF = KST


IV0L0=0
IV0L1=1
IV0L2=2
IV0L3=3
IV1L0=KSLB1
IV1L1=1+KSLB1
IV1L2=2+KSLB1
IV1L3=3+KSLB1
IV2L0=IV1L0+KSLB1
IV2L1=IV1L1+KSLB1
IV2L2=IV1L2+KSLB1
IV2L3=IV1L3+KSLB1
IV3L0=IV2L0+KSLB1
IV3L1=IV2L1+KSLB1
IV3L2=IV2L2+KSLB1
IV3L3=IV2L3+KSLB1
ILEVQMV=10

DO JLEV=1, KFLEV-ILEVQMV
  
  ZDLO0=PDLO (JROF, JLEV, 0)
  ZDLO3=PDLO (JROF, JLEV, 3)
  ZCLO11=PCLO (JROF, JLEV, 1, 1)
  ZCLO21=PCLO (JROF, JLEV, 2, 1)
  ZCLO31=PCLO (JROF, JLEV, 3, 1)
  ZCLO12=PCLO (JROF, JLEV, 1, 2)
  ZCLO22=PCLO (JROF, JLEV, 2, 2)
  ZCLO32=PCLO (JROF, JLEV, 3, 2)
  ZCLA1=PCLA (JROF, JLEV, 1)
  ZCLA2=PCLA (JROF, JLEV, 2)
  ZCLA3=PCLA (JROF, JLEV, 3)
  ZLA0LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 0)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 0)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 0)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 0)+IV3L1)
  ZLA0LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 0)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 0)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 0)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 0)+IV3L2)
  ZLA1LO=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L0)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L0)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF&
  &, JLEV, 1)+IV2L0)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L0)
  ZLA1LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 1)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L1)
  ZLA1LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 1)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L2)
  ZLA1LO3=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L3)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L3)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 1)+IV2L3)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L3)
  ZLA2LO=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L0)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L0)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF&
  &, JLEV, 2)+IV2L0)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L0)
  ZLA2LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 2)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L1)
  ZLA2LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 2)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L2)
  ZLA2LO3=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L3)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L3)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 2)+IV2L3)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L3)
  ZLA3LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 3)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 3)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 3)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 3)+IV3L1)
  ZLA3LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 3)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 3)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 3)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 3)+IV3L2)
  ZLA0=ZLA0LO1+ZDLO0*(ZLA0LO2-ZLA0LO1)
  ZLA1=ZLA1LO+ZCLO11*(ZLA1LO1-ZLA1LO)+ZCLO21*(ZLA1LO2-ZLA1LO)+ZCLO31*(ZLA1LO3-ZLA1LO)
  ZLA2=ZLA2LO+ZCLO12*(ZLA2LO1-ZLA2LO)+ZCLO22*(ZLA2LO2-ZLA2LO)+ZCLO32*(ZLA2LO3-ZLA2LO)
  ZLA3=ZLA3LO1+ZDLO3*(ZLA3LO2-ZLA3LO1)
  PXF (JROF, JLEV)=ZLA0+ZCLA1*(ZLA1-ZLA0)+ZCLA2*(ZLA2-ZLA0)+ZCLA3*(ZLA3-ZLA0)
  
ENDDO


DO JLEV=KFLEV-ILEVQMV+1, KFLEV
  
  ZDLO0=PDLO (JROF, JLEV, 0)
  ZDLO3=PDLO (JROF, JLEV, 3)
  ZCLO11=PCLO (JROF, JLEV, 1, 1)
  ZCLO21=PCLO (JROF, JLEV, 2, 1)
  ZCLO31=PCLO (JROF, JLEV, 3, 1)
  ZCLO12=PCLO (JROF, JLEV, 1, 2)
  ZCLO22=PCLO (JROF, JLEV, 2, 2)
  ZCLO32=PCLO (JROF, JLEV, 3, 2)
  ZCLA1=PCLA (JROF, JLEV, 1)
  ZCLA2=PCLA (JROF, JLEV, 2)
  ZCLA3=PCLA (JROF, JLEV, 3)
  ZLA0LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 0)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 0)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 0)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 0)+IV3L1)
  ZF1=PXSL (KL0 (JROF, JLEV, 0)+IV1L1)
  ZF2=PXSL (KL0 (JROF, JLEV, 0)+IV2L1)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA0LO1=MAX (ZMIN, MIN (ZMAX, ZLA0LO1))
  ZLA0LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 0)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 0)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 0)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 0)+IV3L2)
  ZF1=PXSL (KL0 (JROF, JLEV, 0)+IV1L2)
  ZF2=PXSL (KL0 (JROF, JLEV, 0)+IV2L2)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA0LO2=MAX (ZMIN, MIN (ZMAX, ZLA0LO2))
  ZLA1LO=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L0)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L0)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF&
  &, JLEV, 1)+IV2L0)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L0)
  ZF1=PXSL (KL0 (JROF, JLEV, 1)+IV1L0)
  ZF2=PXSL (KL0 (JROF, JLEV, 1)+IV2L0)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA1LO=MAX (ZMIN, MIN (ZMAX, ZLA1LO))
  ZLA1LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 1)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L1)
  ZF1=PXSL (KL0 (JROF, JLEV, 1)+IV1L1)
  ZF2=PXSL (KL0 (JROF, JLEV, 1)+IV2L1)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA1LO1=MAX (ZMIN, MIN (ZMAX, ZLA1LO1))
  ZLA1LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 1)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L2)
  ZF1=PXSL (KL0 (JROF, JLEV, 1)+IV1L2)
  ZF2=PXSL (KL0 (JROF, JLEV, 1)+IV2L2)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA1LO2=MAX (ZMIN, MIN (ZMAX, ZLA1LO2))
  ZLA1LO3=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 1)+IV0L3)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 1)+IV1L3)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 1)+IV2L3)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 1)+IV3L3)
  ZF1=PXSL (KL0 (JROF, JLEV, 1)+IV1L3)
  ZF2=PXSL (KL0 (JROF, JLEV, 1)+IV2L3)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA1LO3=MAX (ZMIN, MIN (ZMAX, ZLA1LO3))
  ZLA2LO=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L0)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L0)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF&
  &, JLEV, 2)+IV2L0)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L0)
  ZF1=PXSL (KL0 (JROF, JLEV, 2)+IV1L0)
  ZF2=PXSL (KL0 (JROF, JLEV, 2)+IV2L0)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA2LO=MAX (ZMIN, MIN (ZMAX, ZLA2LO))
  ZLA2LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 2)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L1)
  ZF1=PXSL (KL0 (JROF, JLEV, 2)+IV1L1)
  ZF2=PXSL (KL0 (JROF, JLEV, 2)+IV2L1)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA2LO1=MAX (ZMIN, MIN (ZMAX, ZLA2LO1))
  ZLA2LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 2)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L2)
  ZF1=PXSL (KL0 (JROF, JLEV, 2)+IV1L2)
  ZF2=PXSL (KL0 (JROF, JLEV, 2)+IV2L2)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA2LO2=MAX (ZMIN, MIN (ZMAX, ZLA2LO2))
  ZLA2LO3=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 2)+IV0L3)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 2)+IV1L3)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 2)+IV2L3)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 2)+IV3L3)
  ZF1=PXSL (KL0 (JROF, JLEV, 2)+IV1L3)
  ZF2=PXSL (KL0 (JROF, JLEV, 2)+IV2L3)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA2LO3=MAX (ZMIN, MIN (ZMAX, ZLA2LO3))
  ZLA3LO1=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 3)+IV0L1)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 3)+IV1L1)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 3)+IV2L1)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 3)+IV3L1)
  ZF1=PXSL (KL0 (JROF, JLEV, 3)+IV1L1)
  ZF2=PXSL (KL0 (JROF, JLEV, 3)+IV2L1)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA3LO1=MAX (ZMIN, MIN (ZMAX, ZLA3LO1))
  ZLA3LO2=PVINTWS (JROF, JLEV, 1)*PXSPSL (KL0 (JROF, JLEV, 3)+IV0L2)+PVINTWS (JROF, JLEV&
  &, 2)*PXSPSL (KL0 (JROF, JLEV, 3)+IV1L2)+PVINTWS (JROF, JLEV, 3)*PXSPSL (KL0 (JROF,&
  & JLEV, 3)+IV2L2)+PVINTWS (JROF, JLEV, 4)*PXSPSL (KL0 (JROF, JLEV, 3)+IV3L2)
  ZF1=PXSL (KL0 (JROF, JLEV, 3)+IV1L2)
  ZF2=PXSL (KL0 (JROF, JLEV, 3)+IV2L2)
  ZMAX=MAX (ZF1, ZF2)
  ZMIN=MIN (ZF1, ZF2)
  ZLA3LO2=MAX (ZMIN, MIN (ZMAX, ZLA3LO2))
  ZLA0=ZLA0LO1+ZDLO0*(ZLA0LO2-ZLA0LO1)
  ZLA1=ZLA1LO+ZCLO11*(ZLA1LO1-ZLA1LO)+ZCLO21*(ZLA1LO2-ZLA1LO)+ZCLO31*(ZLA1LO3-ZLA1LO)
  ZLA2=ZLA2LO+ZCLO12*(ZLA2LO1-ZLA2LO)+ZCLO22*(ZLA2LO2-ZLA2LO)+ZCLO32*(ZLA2LO3-ZLA2LO)
  ZLA3=ZLA3LO1+ZDLO3*(ZLA3LO2-ZLA3LO1)
  PXF (JROF, JLEV)=ZLA0+ZCLA1*(ZLA1-ZLA0)+ZCLA2*(ZLA2-ZLA0)+ZCLA3*(ZLA3-ZLA0)
  
ENDDO

ZSURPL =0.0_JPRB

DO JLEV=KFLEV, 1,-1
  
  ZF111=PXSL (KL0 (JROF, JLEV, 1)+IV1L1)
  ZF211=PXSL (KL0 (JROF, JLEV, 1)+IV1L2)
  ZF121=PXSL (KL0 (JROF, JLEV, 2)+IV1L1)
  ZF221=PXSL (KL0 (JROF, JLEV, 2)+IV1L2)
  ZF112=PXSL (KL0 (JROF, JLEV, 1)+IV2L1)
  ZF212=PXSL (KL0 (JROF, JLEV, 1)+IV2L2)
  ZF122=PXSL (KL0 (JROF, JLEV, 2)+IV2L1)
  ZF222=PXSL (KL0 (JROF, JLEV, 2)+IV2L2)
  ZMAX=MAX (ZF111, ZF211, ZF121, ZF221, ZF112, ZF212, ZF122, ZF222)
  ZMIN=MIN (ZF111, ZF211, ZF121, ZF221, ZF112, ZF212, ZF122, ZF222)
  ZXF=PXF (JROF, JLEV)+ZSURPL 
  PXF (JROF, JLEV)=MAX (ZMIN, MIN (ZMAX, ZXF))
  ZDMAX=MAX (ZXF, ZMAX)-ZMAX
  ZDMIN=MIN (ZXF, ZMIN)-ZMIN

  IF (ABS (ZDMAX)>=ABS (ZDMIN)) THEN
    ZSURPL =ZDMAX*YDVSLETA%VRDETAR (JLEV)
  ELSE
    ZSURPL =ZDMIN*YDVSLETA%VRDETAR (JLEV)
  ENDIF

  
ENDDO


END SUBROUTINE LAITVSPCQM_OPENACC
