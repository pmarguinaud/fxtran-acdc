SUBMODULE (YOMTOPH) YOMTOPH_TTOPH_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TTOPH (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TTOPH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRMESOQ, LRMESOT, LRMESOU, LRQREL, LRTREL, LRUREL, LRVREL
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LRMESOU = ALLOCATED (SELF%RMESOU)
IF (LRMESOU) THEN
  !$ACC EXIT DATA DETACH (SELF%RMESOU)
  !$ACC EXIT DATA DELETE (SELF%RMESOU)
ENDIF

LRMESOT = ALLOCATED (SELF%RMESOT)
IF (LRMESOT) THEN
  !$ACC EXIT DATA DETACH (SELF%RMESOT)
  !$ACC EXIT DATA DELETE (SELF%RMESOT)
ENDIF

LRMESOQ = ALLOCATED (SELF%RMESOQ)
IF (LRMESOQ) THEN
  !$ACC EXIT DATA DETACH (SELF%RMESOQ)
  !$ACC EXIT DATA DELETE (SELF%RMESOQ)
ENDIF

LRUREL = ALLOCATED (SELF%RUREL)
IF (LRUREL) THEN
  !$ACC EXIT DATA DETACH (SELF%RUREL)
  !$ACC EXIT DATA DELETE (SELF%RUREL)
ENDIF

LRVREL = ALLOCATED (SELF%RVREL)
IF (LRVREL) THEN
  !$ACC EXIT DATA DETACH (SELF%RVREL)
  !$ACC EXIT DATA DELETE (SELF%RVREL)
ENDIF

LRTREL = ALLOCATED (SELF%RTREL)
IF (LRTREL) THEN
  !$ACC EXIT DATA DETACH (SELF%RTREL)
  !$ACC EXIT DATA DELETE (SELF%RTREL)
ENDIF

LRQREL = ALLOCATED (SELF%RQREL)
IF (LRQREL) THEN
  !$ACC EXIT DATA DETACH (SELF%RQREL)
  !$ACC EXIT DATA DELETE (SELF%RQREL)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
