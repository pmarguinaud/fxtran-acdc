SUBROUTINE APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL (YDMF_PHYS_BASE_STATE, YDCPG_BNDS&
&, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS, YDMF_PHYS_SURF, YDMODEL, YDDDH, YD_KNLAB_CVPP, YD_PCDROV&
&, YD_PCHROV, YD_PCOEFN, YD_PCONDCVPPI, YD_PCONDCVPPL, YD_PDIFCVPPQ, YD_PDIFCVPPS, PEPS, YD_PFLU_CD&
&, YD_PFLU_CH, YD_PKQLROV, YD_PKQROV, YD_PKTROV, YD_PKUROV, YD_PKUROV2, YD_PMSC_LSCPE, YD_PNBVNO&
&, YD_PNEBS, YD_PNEBS0, YD_PNEB_CVPP, YD_PPFL_FPLCH, YD_PPFL_FTKE, YD_PPFL_FTKEI, YD_PPRODTH_CVPP&
&, YD_PQI, YD_PQIC, YD_PQL, YD_PQLC, YD_PQLIS, YD_PQLIS0, YD_PQLI_CVPP, YD_PQV, YD_PQR, YD_PQS&
&, YD_PTKE1, YD_PXTROV, YD_PXUROV, YD_PUSLE, YD_PKCLS, YD_PECTCLS, YD_PPRODTH, YD_PEDMFQ, YD_PEDMFS&
&, YD_PEDMFU, YD_PEDMFV, YD_PMF_UP)
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK

USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE TYPE_MODEL,ONLY:MODEL
USE DDH_MIX,ONLY:TYP_DDH
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_SURF_TYPE), INTENT (IN)::YDMF_PHYS_SURF
TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (TYP_DDH), INTENT (INOUT)::YDDDH
CLASS (FIELD_3IM), POINTER :: YD_KNLAB_CVPP
INTEGER (KIND=JPIM), POINTER::KNLAB_CVPP (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCDROV
REAL (KIND=JPRB), POINTER::PCDROV (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PCHROV
REAL (KIND=JPRB), POINTER::PCHROV (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCOEFN
REAL (KIND=JPRB), POINTER::PCOEFN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCONDCVPPI
REAL (KIND=JPRB), POINTER::PCONDCVPPI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCONDCVPPL
REAL (KIND=JPRB), POINTER::PCONDCVPPL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCVPPQ
REAL (KIND=JPRB), POINTER::PDIFCVPPQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCVPPS
REAL (KIND=JPRB), POINTER::PDIFCVPPS (:,:,:)
REAL (KIND=JPRB), INTENT (IN)::PEPS
CLASS (FIELD_2RB), POINTER :: YD_PFLU_CD
REAL (KIND=JPRB), POINTER::PFLU_CD (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PFLU_CH
REAL (KIND=JPRB), POINTER::PFLU_CH (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKQLROV
REAL (KIND=JPRB), POINTER::PKQLROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKQROV
REAL (KIND=JPRB), POINTER::PKQROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKTROV
REAL (KIND=JPRB), POINTER::PKTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKUROV
REAL (KIND=JPRB), POINTER::PKUROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKUROV2
REAL (KIND=JPRB), POINTER::PKUROV2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMSC_LSCPE
REAL (KIND=JPRB), POINTER::PMSC_LSCPE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNBVNO
REAL (KIND=JPRB), POINTER::PNBVNO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBS
REAL (KIND=JPRB), POINTER::PNEBS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBS0
REAL (KIND=JPRB), POINTER::PNEBS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEB_CVPP
REAL (KIND=JPRB), POINTER::PNEB_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FPLCH
REAL (KIND=JPRB), POINTER::PPFL_FPLCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FTKE
REAL (KIND=JPRB), POINTER::PPFL_FTKE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FTKEI
REAL (KIND=JPRB), POINTER::PPFL_FTKEI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPRODTH_CVPP
REAL (KIND=JPRB), POINTER::PPRODTH_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQI
REAL (KIND=JPRB), POINTER::PQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQIC
REAL (KIND=JPRB), POINTER::PQIC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQL
REAL (KIND=JPRB), POINTER::PQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLC
REAL (KIND=JPRB), POINTER::PQLC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLIS
REAL (KIND=JPRB), POINTER::PQLIS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLIS0
REAL (KIND=JPRB), POINTER::PQLIS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLI_CVPP
REAL (KIND=JPRB), POINTER::PQLI_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQV
REAL (KIND=JPRB), POINTER::PQV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQR
REAL (KIND=JPRB), POINTER::PQR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQS
REAL (KIND=JPRB), POINTER::PQS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTKE1
REAL (KIND=JPRB), POINTER::PTKE1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXTROV
REAL (KIND=JPRB), POINTER::PXTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXUROV
REAL (KIND=JPRB), POINTER::PXUROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PUSLE
REAL (KIND=JPRB), POINTER::PUSLE (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PKCLS
REAL (KIND=JPRB), POINTER::PKCLS (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PECTCLS
REAL (KIND=JPRB), POINTER::PECTCLS (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPRODTH
REAL (KIND=JPRB), POINTER::PPRODTH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFQ
REAL (KIND=JPRB), POINTER::PEDMFQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFS
REAL (KIND=JPRB), POINTER::PEDMFS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFU
REAL (KIND=JPRB), POINTER::PEDMFU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFV
REAL (KIND=JPRB), POINTER::PEDMFV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMF_UP
REAL (KIND=JPRB), POINTER::PMF_UP (:,:,:)
#include "actke.intfb.h"
#include "abor1.intfb.h"
#include "actke_openacc.intfb.h"
#include "actke1.intfb.h"
#include "actke1_openacc.intfb.h"
#include "acvppkf_parallel.intfb.h"
#include "arp_shallow_mf_parallel.intfb.h"
CLASS (FIELD_3RB), POINTER :: YL_ZNLAB
REAL (KIND=JPRB), POINTER::ZNLAB (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZNLABCVP
REAL (KIND=JPRB), POINTER::ZNLABCVP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTPRDY
REAL (KIND=JPRB), POINTER::ZTPRDY (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCDROV_SAVE
REAL (KIND=JPRB), POINTER::ZCDROV_SAVE (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCHROV_SAVE
REAL (KIND=JPRB), POINTER::ZCHROV_SAVE (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZKTROV_SAVE
REAL (KIND=JPRB), POINTER::ZKTROV_SAVE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZKUROV_SAVE
REAL (KIND=JPRB), POINTER::ZKUROV_SAVE (:,:,:)
CLASS (FIELD_2IM), POINTER :: YL_INND
INTEGER (KIND=JPIM), POINTER::INND (:,:)
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QICE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QLI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_QS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_T(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_TKE(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_U(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_V(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_CLPH(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_EDR(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_GZ0(:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZTPRDY, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNLABCVP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNLAB, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKUROV_SAVE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZKTROV_SAVE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCHROV_SAVE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCDROV_SAVE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_INND, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)



IF (YDMODEL%YRML_PHY_MF%YRPHY%LCVPPKF) THEN
  CALL ACVPPKF_PARALLEL (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF, YDCPG_BNDS, YDCPG_OPTS, YDMODEL%YRML_PHY_MF&
  &%YRTOPH%NTCVIM, YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF, YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF, YDMF_PHYS_BASE_STATE&
  &%YCPG_PHY%XYB%F_DELP, YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R, YDMF_PHYS_BASE_STATE%F_T, YD_PQV, YD_PQL&
  &, YD_PQI, YDMF_PHYS_BASE_STATE%F_U, YDMF_PHYS_BASE_STATE%F_V, YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP&
  &, YDMF_PHYS_BASE_STATE%F_TKE, YD_PDIFCVPPQ, YD_PDIFCVPPS, YD_PCONDCVPPL, YD_PCONDCVPPI, YD_PPRODTH_CVPP&
  &, YD_KNLAB_CVPP, YD_PQLI_CVPP, YD_PNEB_CVPP, YL_INND)
ENDIF


IF (YDMODEL%YRML_PHY_MF%YRPHY%LEDKF) THEN
  CALL ARP_SHALLOW_MF_PARALLEL (YDMODEL%YRCST, YDMODEL%YRML_PHY_MF%YRPARAR%PHYEX, YDCPG_OPTS, YDCPG_BNDS&
  &, YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY, YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI, YDMF_PHYS_BASE_STATE%YCPG_DYN&
  &%F_PHIF, YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R, YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_CP, YDMF_PHYS_BASE_STATE&
  &%F_U, YDMF_PHYS_BASE_STATE%F_V, YDMF_PHYS_BASE_STATE%F_T, YD_PQV, YD_PQL, YD_PQI, YD_PQR, YD_PQS&
  &, YDMF_PHYS_BASE_STATE%F_TKE, YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF, YDMF_PHYS_BASE_STATE%YCPG_PHY&
  &%XYB%F_DELP, YD_PEDMFQ, YD_PEDMFS, YD_PEDMFU, YD_PEDMFV, YDMF_PHYS_SURF, YD_PPRODTH_CVPP, YD_PQLI_CVPP&
  &, YD_PNEB_CVPP, YD_KNLAB_CVPP, YD_PMF_UP)
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
&:ACTKE',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => GET_HOST_DATA_RDONLY (YD_KNLAB_CVPP)
  PCDROV => GET_HOST_DATA_RDONLY (YD_PCDROV)
  PCHROV => GET_HOST_DATA_RDONLY (YD_PCHROV)
  PCOEFN => GET_HOST_DATA_RDWR (YD_PCOEFN)
  PECTCLS => GET_HOST_DATA_RDWR (YD_PECTCLS)
  PFLU_CD => GET_HOST_DATA_RDONLY (YD_PFLU_CD)
  PFLU_CH => GET_HOST_DATA_RDONLY (YD_PFLU_CH)
  PKCLS => GET_HOST_DATA_RDWR (YD_PKCLS)
  PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
  PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
  PKUROV2 => GET_HOST_DATA_RDWR (YD_PKUROV2)
  PMSC_LSCPE => GET_HOST_DATA_RDONLY (YD_PMSC_LSCPE)
  PNBVNO => GET_HOST_DATA_RDWR (YD_PNBVNO)
  PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
  PPFL_FPLCH => GET_HOST_DATA_RDONLY (YD_PPFL_FPLCH)
  PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
  PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
  PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
  PPRODTH_CVPP => GET_HOST_DATA_RDONLY (YD_PPRODTH_CVPP)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQIC => GET_HOST_DATA_RDONLY (YD_PQIC)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PQLC => GET_HOST_DATA_RDONLY (YD_PQLC)
  PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  PTKE1 => GET_HOST_DATA_RDWR (YD_PTKE1)
  PUSLE => GET_HOST_DATA_RDWR (YD_PUSLE)
  PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
  PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
  ZCDROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCDROV_SAVE)
  ZCHROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCHROV_SAVE)
  ZKTROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKTROV_SAVE)
  ZKUROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKUROV_SAVE)
  ZNLAB => GET_HOST_DATA_RDWR (YL_ZNLAB)
  ZNLABCVP => GET_HOST_DATA_RDWR (YL_ZNLABCVP)
  ZTPRDY => GET_HOST_DATA_RDWR (YL_ZTPRDY)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
  Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
  Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    Z_YDCPG_MISC_QICE (:,:, JBLK)=PQI (:,:, JBLK)
    Z_YDCPG_MISC_QLI (:,:, JBLK)=PQL (:,:, JBLK)
    ZNLABCVP (:,:, JBLK)=1.0_JPRB

    IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZNLABCVP (JLON, JLEV, JBLK)=ZNLABCVP (JLON, JLEV, JBLK)*MAX (0.0_JPRB, SIGN (1.0_JPRB&
          &, PPFL_FPLCH (JLON, JLEV, JBLK)-PPFL_FPLCH (JLON, JLEV-1, JBLK)-PEPS))
          ZNLAB (JLON, JLEV, JBLK)=REAL (KNLAB_CVPP (JLON, JLEV, JBLK), JPRB)
        ENDDO

      ENDDO

    ENDIF


    DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZNLAB (JLON, JLEV, JBLK)=REAL (KNLAB_CVPP (JLON, JLEV, JBLK), JPRB)
      ENDDO

    ENDDO


    IF (YDMODEL%YRML_PHY_MF%YRPHY%LECTPRODCVP) THEN
      CALL ACTKE1 (YDMODEL%YRCST, YDMODEL%YRML_DIAG%YRLDDH, YDMODEL%YRML_DIAG%YRMDDH, YDMODEL%YRML_PHY_MF, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF, YDMODEL%YRML_PHY_MF%YRTOPH&
      &%NTCOET, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
      &(:,:, JBLK), PQV(:,:, JBLK), PMSC_LSCPE(:,:, JBLK), PFLU_CD(:, JBLK), PFLU_CH(:, JBLK), Z_YDMF_PHYS_OUT_GZ0&
      &(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDCPG_MISC_QICE(:,&
      &:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_TKE(:,:, JBLK), PPRODTH_CVPP(:,:, JBLK&
      &), ZNLAB(:,:, JBLK), ZNLABCVP(:,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:,:, JBLK), PKQLROV(:,:, JBLK), PKUROV&
      &(:,:, JBLK), PXTROV(:,:, JBLK), PXUROV(:,:, JBLK), PNBVNO(:,:, JBLK), PNEBS(:,:, JBLK), PQLIS(:,:, JBLK&
      &), PNEBS0(:,:, JBLK), PQLIS0(:,:, JBLK), PCOEFN(:,:, JBLK), PUSLE(:,:, JBLK), PKCLS(:, JBLK), PECTCLS&
      &(:, JBLK), PPRODTH(:,:, JBLK))
      PKUROV2 (:,:, JBLK)=PKUROV (:,:, JBLK)
    ELSE
      CALL ACTKE (YDMODEL%YRCST, YDMODEL%YRML_DIAG%YRLDDH, YDMODEL%YRML_DIAG%YRMDDH, YDMODEL%YRML_PHY_MF, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF, YDMODEL%YRML_PHY_MF%YRTOPH&
      &%NTCOET, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
      &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
      &(:,:, JBLK), PQV(:,:, JBLK), PQIC(:,:, JBLK), PQLC(:,:, JBLK), PMSC_LSCPE(:,:, JBLK), PFLU_CD(:, JBLK&
      &), PFLU_CH(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDCPG_MISC_QS&
      &(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_TKE(:,&
      &:, JBLK), PPRODTH_CVPP(:,:, JBLK), ZNLAB(:,:, JBLK), ZNLABCVP(:,:, JBLK), PKTROV(:,:, JBLK), PKQROV&
      &(:,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), PXTROV(:,:, JBLK), PXUROV(:,:, JBLK), PNBVNO(:,&
      &:, JBLK), PNEBS(:,:, JBLK), PQLIS(:,:, JBLK), PNEBS0(:,:, JBLK), PQLIS0(:,:, JBLK), PCOEFN(:,:, JBLK&
      &), PPFL_FTKE(:,:, JBLK), PPFL_FTKEI(:,:, JBLK), PTKE1(:,:, JBLK), ZTPRDY(:,:, JBLK), Z_YDMF_PHYS_OUT_EDR&
      &(:,:, JBLK), YDDDH)
    ENDIF


    DO JLON=1, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)=MIN (YDMODEL%YRML_PHY_MF%YRPHY0%XMAXLM, MAX&
      & (YDMODEL%YRML_PHY_MF%YRPHY0%XMINLM, Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)))
    ENDDO

    ZKTROV_SAVE (:,:, JBLK)=PKTROV (:,:, JBLK)
    ZKUROV_SAVE (:,:, JBLK)=PKUROV (:,:, JBLK)
    ZCDROV_SAVE (:, JBLK)=PCDROV (:, JBLK)
    ZCHROV_SAVE (:, JBLK)=PCHROV (:, JBLK)
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL:ACTKE')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
    &:ACTKE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
    PCDROV => GET_HOST_DATA_RDWR (YD_PCDROV)
    PCHROV => GET_HOST_DATA_RDWR (YD_PCHROV)
    PCOEFN => GET_HOST_DATA_RDWR (YD_PCOEFN)
    PECTCLS => GET_HOST_DATA_RDWR (YD_PECTCLS)
    PFLU_CD => GET_HOST_DATA_RDWR (YD_PFLU_CD)
    PFLU_CH => GET_HOST_DATA_RDWR (YD_PFLU_CH)
    PKCLS => GET_HOST_DATA_RDWR (YD_PKCLS)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PKUROV2 => GET_HOST_DATA_RDWR (YD_PKUROV2)
    PMSC_LSCPE => GET_HOST_DATA_RDWR (YD_PMSC_LSCPE)
    PNBVNO => GET_HOST_DATA_RDWR (YD_PNBVNO)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
    PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
    PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
    PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PTKE1 => GET_HOST_DATA_RDWR (YD_PTKE1)
    PUSLE => GET_HOST_DATA_RDWR (YD_PUSLE)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    ZCDROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCDROV_SAVE)
    ZCHROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCHROV_SAVE)
    ZKTROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKTROV_SAVE)
    ZKUROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKUROV_SAVE)
    ZNLAB => GET_HOST_DATA_RDWR (YL_ZNLAB)
    ZNLABCVP => GET_HOST_DATA_RDWR (YL_ZNLABCVP)
    ZTPRDY => GET_HOST_DATA_RDWR (YL_ZTPRDY)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
    &:ACTKE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => NULL ()
  PCDROV => NULL ()
  PCHROV => NULL ()
  PCOEFN => NULL ()
  PECTCLS => NULL ()
  PFLU_CD => NULL ()
  PFLU_CH => NULL ()
  PKCLS => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PKUROV2 => NULL ()
  PMSC_LSCPE => NULL ()
  PNBVNO => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PPFL_FPLCH => NULL ()
  PPFL_FTKE => NULL ()
  PPFL_FTKEI => NULL ()
  PPRODTH => NULL ()
  PPRODTH_CVPP => NULL ()
  PQI => NULL ()
  PQIC => NULL ()
  PQL => NULL ()
  PQLC => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQV => NULL ()
  PTKE1 => NULL ()
  PUSLE => NULL ()
  PXTROV => NULL ()
  PXUROV => NULL ()
  ZCDROV_SAVE => NULL ()
  ZCHROV_SAVE => NULL ()
  ZKTROV_SAVE => NULL ()
  ZKUROV_SAVE => NULL ()
  ZNLAB => NULL ()
  ZNLABCVP => NULL ()
  ZTPRDY => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_TKE => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLPH => NULL ()
  Z_YDMF_PHYS_OUT_EDR => NULL ()
  Z_YDMF_PHYS_OUT_GZ0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => GET_HOST_DATA_RDONLY (YD_KNLAB_CVPP)
  PCDROV => GET_HOST_DATA_RDONLY (YD_PCDROV)
  PCHROV => GET_HOST_DATA_RDONLY (YD_PCHROV)
  PCOEFN => GET_HOST_DATA_RDWR (YD_PCOEFN)
  PECTCLS => GET_HOST_DATA_RDWR (YD_PECTCLS)
  PFLU_CD => GET_HOST_DATA_RDONLY (YD_PFLU_CD)
  PFLU_CH => GET_HOST_DATA_RDONLY (YD_PFLU_CH)
  PKCLS => GET_HOST_DATA_RDWR (YD_PKCLS)
  PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
  PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
  PKUROV2 => GET_HOST_DATA_RDWR (YD_PKUROV2)
  PMSC_LSCPE => GET_HOST_DATA_RDONLY (YD_PMSC_LSCPE)
  PNBVNO => GET_HOST_DATA_RDWR (YD_PNBVNO)
  PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
  PPFL_FPLCH => GET_HOST_DATA_RDONLY (YD_PPFL_FPLCH)
  PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
  PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
  PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
  PPRODTH_CVPP => GET_HOST_DATA_RDONLY (YD_PPRODTH_CVPP)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQIC => GET_HOST_DATA_RDONLY (YD_PQIC)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PQLC => GET_HOST_DATA_RDONLY (YD_PQLC)
  PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
  PQV => GET_HOST_DATA_RDONLY (YD_PQV)
  PTKE1 => GET_HOST_DATA_RDWR (YD_PTKE1)
  PUSLE => GET_HOST_DATA_RDWR (YD_PUSLE)
  PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
  PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
  ZCDROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCDROV_SAVE)
  ZCHROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCHROV_SAVE)
  ZKTROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKTROV_SAVE)
  ZKUROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKUROV_SAVE)
  ZNLAB => GET_HOST_DATA_RDWR (YL_ZNLAB)
  ZNLABCVP => GET_HOST_DATA_RDWR (YL_ZNLABCVP)
  ZTPRDY => GET_HOST_DATA_RDWR (YL_ZTPRDY)
  Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDCPG_MISC_QS => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
  Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
  Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
  Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      Z_YDCPG_MISC_QICE (JLON,:, JBLK)=PQI (JLON,:, JBLK)
      Z_YDCPG_MISC_QLI (JLON,:, JBLK)=PQL (JLON,:, JBLK)
      ZNLABCVP (JLON,:, JBLK)=1.0_JPRB

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          ZNLABCVP (JLON, JLEV, JBLK)=ZNLABCVP (JLON, JLEV, JBLK)*MAX (0.0_JPRB, SIGN (1.0_JPRB&
          &, PPFL_FPLCH (JLON, JLEV, JBLK)-PPFL_FPLCH (JLON, JLEV-1, JBLK)-PEPS))
          ZNLAB (JLON, JLEV, JBLK)=REAL (KNLAB_CVPP (JLON, JLEV, JBLK), JPRB)
        
        ENDDO

      ENDIF


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        ZNLAB (JLON, JLEV, JBLK)=REAL (KNLAB_CVPP (JLON, JLEV, JBLK), JPRB)
      
      ENDDO


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LECTPRODCVP) THEN
        CALL ACTKE1_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_DIAG%YRLDDH, YDMODEL%YRML_DIAG%YRMDDH, YDMODEL&
        &%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF&
        &, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOET, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,&
        &:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK&
        &), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PQV(:,:, JBLK), PMSC_LSCPE&
        &(:,:, JBLK), PFLU_CD(:, JBLK), PFLU_CH(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
        &(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK)&
        &, Z_YDMF_PHYS_BASE_STATE_TKE(:,:, JBLK), PPRODTH_CVPP(:,:, JBLK), ZNLAB(:,:, JBLK), ZNLABCVP(:&
        &,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), PXTROV&
        &(:,:, JBLK), PXUROV(:,:, JBLK), PNBVNO(:,:, JBLK), PNEBS(:,:, JBLK), PQLIS(:,:, JBLK), PNEBS0(&
        &:,:, JBLK), PQLIS0(:,:, JBLK), PCOEFN(:,:, JBLK), PUSLE(:,:, JBLK), PKCLS(:, JBLK), PECTCLS(:,&
        & JBLK), PPRODTH(:,:, JBLK),YDSTACK=YLSTACK)
        PKUROV2 (JLON,:, JBLK)=PKUROV (JLON,:, JBLK)
      ELSE
        CALL ACTKE_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_DIAG%YRLDDH, YDMODEL%YRML_DIAG%YRMDDH, YDMODEL%YRML_PHY_MF&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF, YDMODEL%YRML_PHY_MF&
        &%YRTOPH%NTCOET, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
        &(:,:, JBLK), PQV(:,:, JBLK), PQIC(:,:, JBLK), PQLC(:,:, JBLK), PMSC_LSCPE(:,:, JBLK), PFLU_CD(:, JBLK&
        &), PFLU_CH(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDCPG_MISC_QS&
        &(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_TKE(:,:&
        &, JBLK), PPRODTH_CVPP(:,:, JBLK), ZNLAB(:,:, JBLK), ZNLABCVP(:,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:&
        &,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), PXTROV(:,:, JBLK), PXUROV(:,:, JBLK), PNBVNO(:,:, JBLK&
        &), PNEBS(:,:, JBLK), PQLIS(:,:, JBLK), PNEBS0(:,:, JBLK), PQLIS0(:,:, JBLK), PCOEFN(:,:, JBLK), PPFL_FTKE&
        &(:,:, JBLK), PPFL_FTKEI(:,:, JBLK), PTKE1(:,:, JBLK), ZTPRDY(:,:, JBLK), Z_YDMF_PHYS_OUT_EDR(:,:, JBLK&
        &), YDDDH,YDSTACK=YLSTACK)
      ENDIF

      
      Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)=MIN (YDMODEL%YRML_PHY_MF%YRPHY0%XMAXLM, MAX&
      & (YDMODEL%YRML_PHY_MF%YRPHY0%XMINLM, Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)))
      
      ZKTROV_SAVE (JLON,:, JBLK)=PKTROV (JLON,:, JBLK)
      ZKUROV_SAVE (JLON,:, JBLK)=PKUROV (JLON,:, JBLK)
      ZCDROV_SAVE (JLON, JBLK)=PCDROV (JLON, JBLK)
      ZCHROV_SAVE (JLON, JBLK)=PCHROV (JLON, JBLK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL:ACTKE')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
    &:ACTKE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
    PCDROV => GET_HOST_DATA_RDWR (YD_PCDROV)
    PCHROV => GET_HOST_DATA_RDWR (YD_PCHROV)
    PCOEFN => GET_HOST_DATA_RDWR (YD_PCOEFN)
    PECTCLS => GET_HOST_DATA_RDWR (YD_PECTCLS)
    PFLU_CD => GET_HOST_DATA_RDWR (YD_PFLU_CD)
    PFLU_CH => GET_HOST_DATA_RDWR (YD_PFLU_CH)
    PKCLS => GET_HOST_DATA_RDWR (YD_PKCLS)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PKUROV2 => GET_HOST_DATA_RDWR (YD_PKUROV2)
    PMSC_LSCPE => GET_HOST_DATA_RDWR (YD_PMSC_LSCPE)
    PNBVNO => GET_HOST_DATA_RDWR (YD_PNBVNO)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
    PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
    PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
    PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PTKE1 => GET_HOST_DATA_RDWR (YD_PTKE1)
    PUSLE => GET_HOST_DATA_RDWR (YD_PUSLE)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    ZCDROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCDROV_SAVE)
    ZCHROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCHROV_SAVE)
    ZKTROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKTROV_SAVE)
    ZKUROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKUROV_SAVE)
    ZNLAB => GET_HOST_DATA_RDWR (YL_ZNLAB)
    ZNLABCVP => GET_HOST_DATA_RDWR (YL_ZNLABCVP)
    ZTPRDY => GET_HOST_DATA_RDWR (YL_ZTPRDY)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
    &:ACTKE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => NULL ()
  PCDROV => NULL ()
  PCHROV => NULL ()
  PCOEFN => NULL ()
  PECTCLS => NULL ()
  PFLU_CD => NULL ()
  PFLU_CH => NULL ()
  PKCLS => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PKUROV2 => NULL ()
  PMSC_LSCPE => NULL ()
  PNBVNO => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PPFL_FPLCH => NULL ()
  PPFL_FTKE => NULL ()
  PPFL_FTKEI => NULL ()
  PPRODTH => NULL ()
  PPRODTH_CVPP => NULL ()
  PQI => NULL ()
  PQIC => NULL ()
  PQL => NULL ()
  PQLC => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQV => NULL ()
  PTKE1 => NULL ()
  PUSLE => NULL ()
  PXTROV => NULL ()
  PXUROV => NULL ()
  ZCDROV_SAVE => NULL ()
  ZCHROV_SAVE => NULL ()
  ZKTROV_SAVE => NULL ()
  ZKUROV_SAVE => NULL ()
  ZNLAB => NULL ()
  ZNLABCVP => NULL ()
  ZTPRDY => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_TKE => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLPH => NULL ()
  Z_YDMF_PHYS_OUT_EDR => NULL ()
  Z_YDMF_PHYS_OUT_GZ0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => GET_DEVICE_DATA_RDONLY (YD_KNLAB_CVPP)
  PCDROV => GET_DEVICE_DATA_RDONLY (YD_PCDROV)
  PCHROV => GET_DEVICE_DATA_RDONLY (YD_PCHROV)
  PCOEFN => GET_DEVICE_DATA_RDWR (YD_PCOEFN)
  PECTCLS => GET_DEVICE_DATA_RDWR (YD_PECTCLS)
  PFLU_CD => GET_DEVICE_DATA_RDONLY (YD_PFLU_CD)
  PFLU_CH => GET_DEVICE_DATA_RDONLY (YD_PFLU_CH)
  PKCLS => GET_DEVICE_DATA_RDWR (YD_PKCLS)
  PKQLROV => GET_DEVICE_DATA_RDWR (YD_PKQLROV)
  PKQROV => GET_DEVICE_DATA_RDWR (YD_PKQROV)
  PKTROV => GET_DEVICE_DATA_RDWR (YD_PKTROV)
  PKUROV => GET_DEVICE_DATA_RDWR (YD_PKUROV)
  PKUROV2 => GET_DEVICE_DATA_RDWR (YD_PKUROV2)
  PMSC_LSCPE => GET_DEVICE_DATA_RDONLY (YD_PMSC_LSCPE)
  PNBVNO => GET_DEVICE_DATA_RDWR (YD_PNBVNO)
  PNEBS => GET_DEVICE_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_DEVICE_DATA_RDWR (YD_PNEBS0)
  PPFL_FPLCH => GET_DEVICE_DATA_RDONLY (YD_PPFL_FPLCH)
  PPFL_FTKE => GET_DEVICE_DATA_RDWR (YD_PPFL_FTKE)
  PPFL_FTKEI => GET_DEVICE_DATA_RDWR (YD_PPFL_FTKEI)
  PPRODTH => GET_DEVICE_DATA_RDWR (YD_PPRODTH)
  PPRODTH_CVPP => GET_DEVICE_DATA_RDONLY (YD_PPRODTH_CVPP)
  PQI => GET_DEVICE_DATA_RDONLY (YD_PQI)
  PQIC => GET_DEVICE_DATA_RDONLY (YD_PQIC)
  PQL => GET_DEVICE_DATA_RDONLY (YD_PQL)
  PQLC => GET_DEVICE_DATA_RDONLY (YD_PQLC)
  PQLIS => GET_DEVICE_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_DEVICE_DATA_RDWR (YD_PQLIS0)
  PQV => GET_DEVICE_DATA_RDONLY (YD_PQV)
  PTKE1 => GET_DEVICE_DATA_RDWR (YD_PTKE1)
  PUSLE => GET_DEVICE_DATA_RDWR (YD_PUSLE)
  PXTROV => GET_DEVICE_DATA_RDWR (YD_PXTROV)
  PXUROV => GET_DEVICE_DATA_RDWR (YD_PXUROV)
  ZCDROV_SAVE => GET_DEVICE_DATA_RDWR (YL_ZCDROV_SAVE)
  ZCHROV_SAVE => GET_DEVICE_DATA_RDWR (YL_ZCHROV_SAVE)
  ZKTROV_SAVE => GET_DEVICE_DATA_RDWR (YL_ZKTROV_SAVE)
  ZKUROV_SAVE => GET_DEVICE_DATA_RDWR (YL_ZKUROV_SAVE)
  ZNLAB => GET_DEVICE_DATA_RDWR (YL_ZNLAB)
  ZNLABCVP => GET_DEVICE_DATA_RDWR (YL_ZNLABCVP)
  ZTPRDY => GET_DEVICE_DATA_RDWR (YL_ZTPRDY)
  Z_YDCPG_MISC_QICE => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QICE)
  Z_YDCPG_MISC_QLI => GET_DEVICE_DATA_RDWR (YDCPG_MISC%F_QLI)
  Z_YDCPG_MISC_QS => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_QS)
  Z_YDMF_PHYS_BASE_STATE_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_T)
  Z_YDMF_PHYS_BASE_STATE_TKE => GET_DEVICE_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
  Z_YDMF_PHYS_BASE_STATE_U => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_U)
  Z_YDMF_PHYS_BASE_STATE_V => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_V)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
  Z_YDMF_PHYS_OUT_CLPH => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
  Z_YDMF_PHYS_OUT_EDR => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
  Z_YDMF_PHYS_OUT_GZ0 => GET_DEVICE_DATA_RDONLY (YDMF_PHYS%OUT%F_GZ0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (KNLAB_CVPP, PCDROV, PCHROV, PCOEFN, PECTCLS, PFLU_CD, PFLU_CH, PKCLS, &
    !$ACC&         PKQLROV, PKQROV, PKTROV, PKUROV, PKUROV2, PMSC_LSCPE, PNBVNO, PNEBS, &
    !$ACC&         PNEBS0, PPFL_FPLCH, PPFL_FTKE, PPFL_FTKEI, PPRODTH, PPRODTH_CVPP, &
    !$ACC&         PQI, PQIC, PQL, PQLC, PQLIS, PQLIS0, PQV, PTKE1, PUSLE, PXTROV, PXUROV, YDCPG_OPTS, &
    !$ACC&         YDMODEL, YFXTRAN_ACDC_STACK, ZCDROV_SAVE, ZCHROV_SAVE, ZKTROV_SAVE, &
    !$ACC&         ZKUROV_SAVE, ZNLAB, ZNLABCVP, ZTPRDY, Z_YDCPG_MISC_QICE, Z_YDCPG_MISC_QLI, &
    !$ACC&         Z_YDCPG_MISC_QS, Z_YDMF_PHYS_BASE_STATE_T, Z_YDMF_PHYS_BASE_STATE_TKE, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_U, Z_YDMF_PHYS_BASE_STATE_V, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T, &
    !$ACC&         Z_YDMF_PHYS_OUT_CLPH, Z_YDMF_PHYS_OUT_EDR, Z_YDMF_PHYS_OUT_GZ0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_MISC_QICE (:,:, JBLK), PQI (:,:, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, Z_YDCPG_MISC_QLI (:,:, JBLK), PQL (:,:, JBLK))
      ZNLABCVP (JLON,:, JBLK)=1.0_JPRB

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST) THEN

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          ZNLABCVP (JLON, JLEV, JBLK)=ZNLABCVP (JLON, JLEV, JBLK)*MAX (0.0_JPRB, SIGN (1.0_JPRB&
          &, PPFL_FPLCH (JLON, JLEV, JBLK)-PPFL_FPLCH (JLON, JLEV-1, JBLK)-PEPS))
          ZNLAB (JLON, JLEV, JBLK)=REAL (KNLAB_CVPP (JLON, JLEV, JBLK), JPRB)
        
        ENDDO

      ENDIF


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        ZNLAB (JLON, JLEV, JBLK)=REAL (KNLAB_CVPP (JLON, JLEV, JBLK), JPRB)
      
      ENDDO


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LECTPRODCVP) THEN
        CALL ACTKE1_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_DIAG%YRLDDH, YDMODEL%YRML_DIAG%YRMDDH, YDMODEL&
        &%YRML_PHY_MF, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF&
        &, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOET, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,&
        &:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK&
        &), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V(:,:, JBLK), PQV(:,:, JBLK), PMSC_LSCPE&
        &(:,:, JBLK), PFLU_CD(:, JBLK), PFLU_CH(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T&
        &(:, JBLK), Z_YDCPG_MISC_QS(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK)&
        &, Z_YDMF_PHYS_BASE_STATE_TKE(:,:, JBLK), PPRODTH_CVPP(:,:, JBLK), ZNLAB(:,:, JBLK), ZNLABCVP(:&
        &,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), PXTROV&
        &(:,:, JBLK), PXUROV(:,:, JBLK), PNBVNO(:,:, JBLK), PNEBS(:,:, JBLK), PQLIS(:,:, JBLK), PNEBS0(&
        &:,:, JBLK), PQLIS0(:,:, JBLK), PCOEFN(:,:, JBLK), PUSLE(:,:, JBLK), PKCLS(:, JBLK), PECTCLS(:,&
        & JBLK), PPRODTH(:,:, JBLK),YDSTACK=YLSTACK)
        CALL FXTRAN_ACDC_ARRAY_COPY (JLON, PKUROV2 (:,:, JBLK), PKUROV (:,:, JBLK))
      ELSE
        CALL ACTKE_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_DIAG%YRLDDH, YDMODEL%YRML_DIAG%YRMDDH, YDMODEL%YRML_PHY_MF&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRTOPH%NTCOEF, YDMODEL%YRML_PHY_MF&
        &%YRTOPH%NTCOET, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R&
        &(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_T(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_U(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_V&
        &(:,:, JBLK), PQV(:,:, JBLK), PQIC(:,:, JBLK), PQLC(:,:, JBLK), PMSC_LSCPE(:,:, JBLK), PFLU_CD(:, JBLK&
        &), PFLU_CH(:, JBLK), Z_YDMF_PHYS_OUT_GZ0(:, JBLK), Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T(:, JBLK), Z_YDCPG_MISC_QS&
        &(:, JBLK), Z_YDCPG_MISC_QICE(:,:, JBLK), Z_YDCPG_MISC_QLI(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_TKE(:,:&
        &, JBLK), PPRODTH_CVPP(:,:, JBLK), ZNLAB(:,:, JBLK), ZNLABCVP(:,:, JBLK), PKTROV(:,:, JBLK), PKQROV(:&
        &,:, JBLK), PKQLROV(:,:, JBLK), PKUROV(:,:, JBLK), PXTROV(:,:, JBLK), PXUROV(:,:, JBLK), PNBVNO(:,:, JBLK&
        &), PNEBS(:,:, JBLK), PQLIS(:,:, JBLK), PNEBS0(:,:, JBLK), PQLIS0(:,:, JBLK), PCOEFN(:,:, JBLK), PPFL_FTKE&
        &(:,:, JBLK), PPFL_FTKEI(:,:, JBLK), PTKE1(:,:, JBLK), ZTPRDY(:,:, JBLK), Z_YDMF_PHYS_OUT_EDR(:,:, JBLK&
        &), YDDDH,YDSTACK=YLSTACK)
      ENDIF

      
      Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)=MIN (YDMODEL%YRML_PHY_MF%YRPHY0%XMAXLM, MAX&
      & (YDMODEL%YRML_PHY_MF%YRPHY0%XMINLM, Z_YDMF_PHYS_OUT_CLPH (JLON, JBLK)))
      
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZKTROV_SAVE (:,:, JBLK), PKTROV (:,:, JBLK))
      CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZKUROV_SAVE (:,:, JBLK), PKUROV (:,:, JBLK))
      ZCDROV_SAVE (JLON, JBLK)=PCDROV (JLON, JBLK)
      ZCHROV_SAVE (JLON, JBLK)=PCHROV (JLON, JBLK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL:ACTKE')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
    &:ACTKE:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
    PCDROV => GET_HOST_DATA_RDWR (YD_PCDROV)
    PCHROV => GET_HOST_DATA_RDWR (YD_PCHROV)
    PCOEFN => GET_HOST_DATA_RDWR (YD_PCOEFN)
    PECTCLS => GET_HOST_DATA_RDWR (YD_PECTCLS)
    PFLU_CD => GET_HOST_DATA_RDWR (YD_PFLU_CD)
    PFLU_CH => GET_HOST_DATA_RDWR (YD_PFLU_CH)
    PKCLS => GET_HOST_DATA_RDWR (YD_PKCLS)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PKUROV2 => GET_HOST_DATA_RDWR (YD_PKUROV2)
    PMSC_LSCPE => GET_HOST_DATA_RDWR (YD_PMSC_LSCPE)
    PNBVNO => GET_HOST_DATA_RDWR (YD_PNBVNO)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PPFL_FTKE => GET_HOST_DATA_RDWR (YD_PPFL_FTKE)
    PPFL_FTKEI => GET_HOST_DATA_RDWR (YD_PPFL_FTKEI)
    PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
    PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    PTKE1 => GET_HOST_DATA_RDWR (YD_PTKE1)
    PUSLE => GET_HOST_DATA_RDWR (YD_PUSLE)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    ZCDROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCDROV_SAVE)
    ZCHROV_SAVE => GET_HOST_DATA_RDWR (YL_ZCHROV_SAVE)
    ZKTROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKTROV_SAVE)
    ZKUROV_SAVE => GET_HOST_DATA_RDWR (YL_ZKUROV_SAVE)
    ZNLAB => GET_HOST_DATA_RDWR (YL_ZNLAB)
    ZNLABCVP => GET_HOST_DATA_RDWR (YL_ZNLABCVP)
    ZTPRDY => GET_HOST_DATA_RDWR (YL_ZTPRDY)
    Z_YDCPG_MISC_QICE => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QICE)
    Z_YDCPG_MISC_QLI => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QLI)
    Z_YDCPG_MISC_QS => GET_HOST_DATA_RDWR (YDCPG_MISC%F_QS)
    Z_YDMF_PHYS_BASE_STATE_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_T)
    Z_YDMF_PHYS_BASE_STATE_TKE => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_TKE)
    Z_YDMF_PHYS_BASE_STATE_U => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_U)
    Z_YDMF_PHYS_BASE_STATE_V => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_V)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%F_PHIF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YCPG_DYN%RCP%F_R)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYDF)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%YGSP_RR%F_T)
    Z_YDMF_PHYS_OUT_CLPH => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_CLPH)
    Z_YDMF_PHYS_OUT_EDR => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_EDR)
    Z_YDMF_PHYS_OUT_GZ0 => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_GZ0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
    &:ACTKE:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => NULL ()
  PCDROV => NULL ()
  PCHROV => NULL ()
  PCOEFN => NULL ()
  PECTCLS => NULL ()
  PFLU_CD => NULL ()
  PFLU_CH => NULL ()
  PKCLS => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PKUROV2 => NULL ()
  PMSC_LSCPE => NULL ()
  PNBVNO => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PPFL_FPLCH => NULL ()
  PPFL_FTKE => NULL ()
  PPFL_FTKEI => NULL ()
  PPRODTH => NULL ()
  PPRODTH_CVPP => NULL ()
  PQI => NULL ()
  PQIC => NULL ()
  PQL => NULL ()
  PQLC => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQV => NULL ()
  PTKE1 => NULL ()
  PUSLE => NULL ()
  PXTROV => NULL ()
  PXUROV => NULL ()
  ZCDROV_SAVE => NULL ()
  ZCHROV_SAVE => NULL ()
  ZKTROV_SAVE => NULL ()
  ZKUROV_SAVE => NULL ()
  ZNLAB => NULL ()
  ZNLABCVP => NULL ()
  ZTPRDY => NULL ()
  Z_YDCPG_MISC_QICE => NULL ()
  Z_YDCPG_MISC_QLI => NULL ()
  Z_YDCPG_MISC_QS => NULL ()
  Z_YDMF_PHYS_BASE_STATE_T => NULL ()
  Z_YDMF_PHYS_BASE_STATE_TKE => NULL ()
  Z_YDMF_PHYS_BASE_STATE_U => NULL ()
  Z_YDMF_PHYS_BASE_STATE_V => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_PHIF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_DYN_RCP_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYDF => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YGSP_RR_T => NULL ()
  Z_YDMF_PHYS_OUT_CLPH => NULL ()
  Z_YDMF_PHYS_OUT_EDR => NULL ()
  Z_YDMF_PHYS_OUT_GZ0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
  &:ACTKE:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL&
&:ACTKE',1,ZHOOK_HANDLE_PARALLEL)


CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_INND)) CALL FIELD_DELETE (YL_INND)
IF (ASSOCIATED (YL_ZCDROV_SAVE)) CALL FIELD_DELETE (YL_ZCDROV_SAVE)
IF (ASSOCIATED (YL_ZCHROV_SAVE)) CALL FIELD_DELETE (YL_ZCHROV_SAVE)
IF (ASSOCIATED (YL_ZKTROV_SAVE)) CALL FIELD_DELETE (YL_ZKTROV_SAVE)
IF (ASSOCIATED (YL_ZKUROV_SAVE)) CALL FIELD_DELETE (YL_ZKUROV_SAVE)
IF (ASSOCIATED (YL_ZNLAB)) CALL FIELD_DELETE (YL_ZNLAB)
IF (ASSOCIATED (YL_ZNLABCVP)) CALL FIELD_DELETE (YL_ZNLABCVP)
IF (ASSOCIATED (YL_ZTPRDY)) CALL FIELD_DELETE (YL_ZTPRDY)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_SHALLOW_CONVECTION_AND_TURBULENCE_PARALLEL
