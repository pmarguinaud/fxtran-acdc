
SUBROUTINE ACVPPKF_PARALLEL (YDCST, YDML_PHY_MF, YDCPG_BNDS, YDCPG_OPTS, KTDIA, YD_PAPRSF, YD_PAPHIF&
&, YD_PDELP, YD_PR, YD_PT, YD_PQ, YD_PQL, YD_PQI, YD_PU, YD_PV, YD_PCP, YD_PTKE, YD_PDIFCQ, YD_PDIFCS&
&, YD_PFCCQL, YD_PFCCQN, YD_PPRODTH, YD_KNLAB, YD_PQCPP, YD_PNEBPP, YD_KNND)
USE MODEL_PHYSICS_MF_MOD,ONLY:MODEL_PHYSICS_MF_TYPE

USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE YOMCST,ONLY:TCST
USE YOMLSFORC,ONLY:LMUSCLFA, NMUSCLFA
USE MODD_CONVPAR_SHAL,ONLY:CONVPAR_SHAL
USE MODD_DIMPHYEX,ONLY:DIMPHYEX_T
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE MODI_SHALLOW_CONVECTION_PART1
USE MODI_SHALLOW_CONVECTION_PART1_OPENACC
USE MODI_SHALLOW_CONVECTION_PART2
USE MODI_SHALLOW_CONVECTION_PART2_OPENACC
USE MODI_SHALLOW_CONVECTION_PART2_SELECT
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FIELD_GATHSCAT_MODULE
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
TYPE (MODEL_PHYSICS_MF_TYPE), INTENT (IN)::YDML_PHY_MF
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
INTEGER (KIND=JPIM), INTENT (IN)::KTDIA
CLASS (FIELD_3RB), POINTER :: YD_PAPRSF
REAL (KIND=JPRB), POINTER::PAPRSF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAPHIF
REAL (KIND=JPRB), POINTER::PAPHIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDELP
REAL (KIND=JPRB), POINTER::PDELP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PR
REAL (KIND=JPRB), POINTER::PR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PT
REAL (KIND=JPRB), POINTER::PT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQ
REAL (KIND=JPRB), POINTER::PQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQL
REAL (KIND=JPRB), POINTER::PQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQI
REAL (KIND=JPRB), POINTER::PQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PU
REAL (KIND=JPRB), POINTER::PU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PV
REAL (KIND=JPRB), POINTER::PV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCP
REAL (KIND=JPRB), POINTER::PCP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTKE
REAL (KIND=JPRB), POINTER::PTKE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCQ
REAL (KIND=JPRB), POINTER::PDIFCQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCS
REAL (KIND=JPRB), POINTER::PDIFCS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFCCQL
REAL (KIND=JPRB), POINTER::PFCCQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PFCCQN
REAL (KIND=JPRB), POINTER::PFCCQN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPRODTH
REAL (KIND=JPRB), POINTER::PPRODTH (:,:,:)
CLASS (FIELD_3IM), POINTER :: YD_KNLAB
INTEGER (KIND=JPIM), POINTER::KNLAB (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQCPP
REAL (KIND=JPRB), POINTER::PQCPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBPP
REAL (KIND=JPRB), POINTER::PNEBPP (:,:,:)
CLASS (FIELD_2IM), POINTER :: YD_KNND
INTEGER (KIND=JPIM), POINTER::KNND (:,:)
#include "fcttrm.func.h"
#include "abor1.intfb.h"
INTEGER (KIND=JPIM), PARAMETER::I_KCH1=0
LOGICAL::LLCONDWT
LOGICAL::LLOCHTRANS
LOGICAL::LLUVTRANS
LOGICAL::LLDOWN
LOGICAL::LLREFRESH_ALL
REAL (KIND=JPRB)::ZDTLDT
REAL (KIND=JPRB)::ZDQCDT
REAL (KIND=JPRB)::ZEPS
REAL (KIND=JPRB)::ZTDCP
REAL (KIND=JPRB)::ZSMD
REAL (KIND=JPRB)::ZWMD
REAL (KIND=JPRB)::ZVMD
REAL (KIND=JPRB)::ZDTCONV
INTEGER (KIND=JPIM)::IKICE
INTEGER (KIND=JPIM)::I_KBDIA
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
CLASS (FIELD_2IM), POINTER :: YL_I_KCOUNT
INTEGER (KIND=JPIM), POINTER::I_KCOUNT (:,:)
CLASS (FIELD_2IM), POINTER :: YL_I_KCLTOP
INTEGER (KIND=JPIM), POINTER::I_KCLTOP (:,:)
CLASS (FIELD_2IM), POINTER :: YL_I_KCLBAS
INTEGER (KIND=JPIM), POINTER::I_KCLBAS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZCAPE
REAL (KIND=JPRB), POINTER::ZCAPE (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZW
REAL (KIND=JPRB), POINTER::ZW (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDTDT
REAL (KIND=JPRB), POINTER::ZDTDT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDQVDT
REAL (KIND=JPRB), POINTER::ZDQVDT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDQLDT
REAL (KIND=JPRB), POINTER::ZDQLDT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDQIDT
REAL (KIND=JPRB), POINTER::ZDQIDT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDUDT
REAL (KIND=JPRB), POINTER::ZDUDT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDVDT
REAL (KIND=JPRB), POINTER::ZDVDT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUMF
REAL (KIND=JPRB), POINTER::ZUMF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUQV
REAL (KIND=JPRB), POINTER::ZUQV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUQL
REAL (KIND=JPRB), POINTER::ZUQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDPSG
REAL (KIND=JPRB), POINTER::ZDPSG (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLV
REAL (KIND=JPRB), POINTER::ZLV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLS
REAL (KIND=JPRB), POINTER::ZLS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZQC
REAL (KIND=JPRB), POINTER::ZQC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZBETA
REAL (KIND=JPRB), POINTER::ZBETA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZAPHIF
REAL (KIND=JPRB), POINTER::ZAPHIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTHETA
REAL (KIND=JPRB), POINTER::ZTHETA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRHO
REAL (KIND=JPRB), POINTER::ZRHO (:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZCH1
REAL (KIND=JPRB), POINTER::ZCH1 (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZCH1TEN
REAL (KIND=JPRB), POINTER::ZCH1TEN (:,:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZTKECLS
REAL (KIND=JPRB), POINTER::ZTKECLS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZUMFMAX
REAL (KIND=JPRB), POINTER::ZUMFMAX (:,:)
INTEGER::JN
INTEGER::JKP
CLASS (FIELD_3RB), POINTER :: YL_ZT
REAL (KIND=JPRB), POINTER::ZT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRV
REAL (KIND=JPRB), POINTER::ZRV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRC
REAL (KIND=JPRB), POINTER::ZRC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRI
REAL (KIND=JPRB), POINTER::ZRI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZU
REAL (KIND=JPRB), POINTER::ZU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZV
REAL (KIND=JPRB), POINTER::ZV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZZW
REAL (KIND=JPRB), POINTER::ZZW (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZPABS
REAL (KIND=JPRB), POINTER::ZPABS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZZZ
REAL (KIND=JPRB), POINTER::ZZZ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZTTEN
REAL (KIND=JPRB), POINTER::ZTTEN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRVTEN
REAL (KIND=JPRB), POINTER::ZRVTEN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRCTEN
REAL (KIND=JPRB), POINTER::ZRCTEN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZRITEN
REAL (KIND=JPRB), POINTER::ZRITEN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZUTEN
REAL (KIND=JPRB), POINTER::ZUTEN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZVTEN
REAL (KIND=JPRB), POINTER::ZVTEN (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZZUMF
REAL (KIND=JPRB), POINTER::ZZUMF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZURV
REAL (KIND=JPRB), POINTER::ZURV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZURCI
REAL (KIND=JPRB), POINTER::ZURCI (:,:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICLTOP
INTEGER (KIND=JPIM), POINTER::ICLTOP (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICLBAS
INTEGER (KIND=JPIM), POINTER::ICLBAS (:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZSHAL_ZCH1
REAL (KIND=JPRB), POINTER::ZSHAL_ZCH1 (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZSHAL_ZCH1TEN
REAL (KIND=JPRB), POINTER::ZSHAL_ZCH1TEN (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YL_ZSHAL_ZCH1TENS
REAL (KIND=JPRB), POINTER::ZSHAL_ZCH1TENS (:,:,:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICLTOPS
INTEGER (KIND=JPIM), POINTER::ICLTOPS (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ICLBASS
INTEGER (KIND=JPIM), POINTER::ICLBASS (:,:)
REAL (KIND=JPRB)::ZRDOCP
CLASS (FIELD_3RB), POINTER :: YL_ZTHT
REAL (KIND=JPRB), POINTER::ZTHT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTHV
REAL (KIND=JPRB), POINTER::ZSTHV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTHES
REAL (KIND=JPRB), POINTER::ZSTHES (:,:,:)
CLASS (FIELD_2IM), POINTER :: YL_ISDPL
INTEGER (KIND=JPIM), POINTER::ISDPL (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ISPBL
INTEGER (KIND=JPIM), POINTER::ISPBL (:,:)
CLASS (FIELD_2IM), POINTER :: YL_ISLCL
INTEGER (KIND=JPIM), POINTER::ISLCL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSTHLCL
REAL (KIND=JPRB), POINTER::ZSTHLCL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSTLCL
REAL (KIND=JPRB), POINTER::ZSTLCL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSRVLCL
REAL (KIND=JPRB), POINTER::ZSRVLCL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSWLCL
REAL (KIND=JPRB), POINTER::ZSWLCL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSZLCL
REAL (KIND=JPRB), POINTER::ZSZLCL (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZSTHVELCL
REAL (KIND=JPRB), POINTER::ZSTHVELCL (:,:)
CLASS (FIELD_2LM), POINTER :: YL_LLTRIG1
LOGICAL, POINTER::LLTRIG1 (:,:)
TYPE (DIMPHYEX_T)::D
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
TYPE (DIMPHYEX_T) :: DD
TYPE(FIELD_GATHSCAT) :: YL_FGS
IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZZZ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZZW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZZUMF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZW, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVTEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUTEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZURV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZURCI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUQV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUQL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUMFMAX, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUMF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTTEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTKECLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTHT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZTHETA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG+1, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSZLCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSWLCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTLCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTHVELCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTHV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTHLCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTHES, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSRVLCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSHAL_ZCH1TENS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, I_KCH1&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSHAL_ZCH1TEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, I_KCH1&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSHAL_ZCH1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, I_KCH1,&
& YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRVTEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRITEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRHO, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG+1, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRCTEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZRC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZQC, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZPABS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDVDT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDUDT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDTDT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDQVDT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDQLDT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDQIDT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDPSG, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCH1TEN, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, I_KCH1, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCH1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, I_KCH1, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZCAPE, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZBETA, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZAPHIF, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_LLTRIG1, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_I_KCOUNT, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_I_KCLTOP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_I_KCLBAS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ISPBL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ISLCL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ISDPL, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICLTOPS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICLTOP, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICLBASS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ICLBAS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)


D%NIT=YDCPG_OPTS%KLON
D%NIB=YDCPG_BNDS%KIDIA
D%NIE=YDCPG_BNDS%KFDIA
D%NKT=YDCPG_OPTS%KFLEVG
ZVMD=YDCST%RCPV-YDCST%RCPD
ZWMD=YDCST%RCW-YDCST%RCPD
ZSMD=YDCST%RCS-YDCST%RCPD
I_KBDIA=1
IKICE=1
LLREFRESH_ALL=.TRUE.
LLDOWN=YDML_PHY_MF%YRPHY%LCVDD
LLUVTRANS=.FALSE.
LLOCHTRANS=.FALSE.
ZDTCONV=YDML_PHY_MF%YRPHY2%TSPHY
ZEPS=1.E-12_JPRB
ZRDOCP=YDML_PHY_MF%YRCVMNH%YRCST_MNH%XRD/YDML_PHY_MF%YRCVMNH%YRCST_MNH%XCPD
LLCONDWT=.FALSE.

IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','ACVPPKF_PARALLEL:PART0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
  ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
  ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
  ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
  I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
  I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
  I_KCOUNT => GET_HOST_DATA_RDWR (YL_I_KCOUNT)
  PAPHIF => GET_HOST_DATA_RDONLY (YD_PAPHIF)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
  PQ => GET_HOST_DATA_RDONLY (YD_PQ)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  PTKE => GET_HOST_DATA_RDONLY (YD_PTKE)
  PU => GET_HOST_DATA_RDONLY (YD_PU)
  PV => GET_HOST_DATA_RDONLY (YD_PV)
  ZAPHIF => GET_HOST_DATA_RDWR (YL_ZAPHIF)
  ZCAPE => GET_HOST_DATA_RDWR (YL_ZCAPE)
  ZCH1 => GET_HOST_DATA_RDONLY (YL_ZCH1)
  ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
  ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
  ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
  ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
  ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
  ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
  ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
  ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
  ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
  ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
  ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
  ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
  ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
  ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
  ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
  ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
  ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
  ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
  ZT => GET_HOST_DATA_RDWR (YL_ZT)
  ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
  ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
  ZU => GET_HOST_DATA_RDWR (YL_ZU)
  ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
  ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
  ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
  ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
  ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
  ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
  ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
  ZV => GET_HOST_DATA_RDWR (YL_ZV)
  ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
  ZW => GET_HOST_DATA_RDWR (YL_ZW)
  ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
  ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
  ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JKP, JLEV, JLON, JN) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    ZUMFMAX (:, JBLK)=1.E-12_JPRB
    ZW (:,:, JBLK)=0.0_JPRB
    ZTKECLS (:, JBLK)=0.0_JPRB

    IF (YDML_PHY_MF%YRPHY%LECT) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZW (JLON, JLEV, JBLK)=SQRT (MIN (3.0_JPRB, MAX (YDML_PHY_MF%YRPHY0&
          &%ECTMIN, PTKE (JLON, JLEV, JBLK)))/YDML_PHY_MF%YRPHY0%AECLS4)
        ENDDO

      ENDDO


      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZTKECLS (JLON, JBLK)=PTKE (JLON, YDCPG_OPTS%KFLEVG, JBLK)
      ENDDO

    ENDIF


    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZDPSG (JLON, JLEV, JBLK)=PDELP (JLON, JLEV, JBLK)/YDCST%RG
        ZAPHIF (JLON, JLEV, JBLK)=PAPHIF (JLON, JLEV, JBLK)/YDCST%RG
      ENDDO

    ENDDO


    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZDTDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQVDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQLDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQIDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDUDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDVDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZUMF (JLON, JLEV, JBLK)=0.0_JPRB
        ZUQV (JLON, JLEV, JBLK)=0.0_JPRB
        ZUQL (JLON, JLEV, JBLK)=0.0_JPRB
        ZLV (JLON, JLEV, JBLK)=FOLH (PT (JLON, JLEV, JBLK), 0.0_JPRB)
        ZLS (JLON, JLEV, JBLK)=FOLH (PT (JLON, JLEV, JBLK), 1.0_JPRB)
        ZQC (JLON, JLEV, JBLK)=PQL (JLON, JLEV, JBLK)+PQI (JLON, JLEV, JBLK)
      ENDDO

    ENDDO


    DO JLON=1, YLCPG_BNDS%KFDIA
      I_KCOUNT (JLON, JBLK)=0
      ZCAPE (JLON, JBLK)=0.0_JPRB
    ENDDO

    I_KCLTOP (:, JBLK)=1
    I_KCLBAS (:, JBLK)=1
    ICLTOP (:, JBLK)=1
    ICLBAS (:, JBLK)=1
    ICLTOPS (:, JBLK)=1
    ICLBASS (:, JBLK)=1

    DO JLEV=1, YDCPG_OPTS%KFLEVG
      JKP=YDCPG_OPTS%KFLEVG-JLEV+1

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZPABS (JLON, JKP, JBLK)=PAPRSF (JLON, JLEV, JBLK)
        ZZZ (JLON, JKP, JBLK)=ZAPHIF (JLON, JLEV, JBLK)
        ZT (JLON, JKP, JBLK)=PT (JLON, JLEV, JBLK)
        ZRV (JLON, JKP, JBLK)=PQ (JLON, JLEV, JBLK)/(1.0-PQ (JLON, JLEV, JBLK))
        ZRC (JLON, JKP, JBLK)=PQL (JLON, JLEV, JBLK)/(1.0-PQL (JLON, JLEV, JBLK))
        ZRI (JLON, JKP, JBLK)=PQI (JLON, JLEV, JBLK)/(1.0-PQI (JLON, JLEV, JBLK))
        ZU (JLON, JKP, JBLK)=PU (JLON, JLEV, JBLK)
        ZV (JLON, JKP, JBLK)=PV (JLON, JLEV, JBLK)
        ZZW (JLON, JKP, JBLK)=ZW (JLON, JLEV, JBLK)
      ENDDO

    ENDDO


    IF (LLOCHTRANS) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        JKP=YDCPG_OPTS%KFLEVG-JLEV+1

        DO JN=1, I_KCH1

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZSHAL_ZCH1 (JLON, JKP, JN, JBLK)=ZCH1 (JLON, JLEV, JN, JBLK)
          ENDDO

        ENDDO

      ENDDO

    ENDIF

    I_KCOUNT (:, JBLK)=0
    ZTTEN (:,:, JBLK)=0.0
    ZRVTEN (:,:, JBLK)=0.0
    ZRCTEN (:,:, JBLK)=0.0
    ZRITEN (:,:, JBLK)=0.0
    ZUTEN (:,:, JBLK)=0.0
    ZVTEN (:,:, JBLK)=0.0
    ZZUMF (:,:, JBLK)=0.0
    ZURV (:,:, JBLK)=0.0
    ZURCI (:,:, JBLK)=0.0
    ZSHAL_ZCH1TEN (:,:,:, JBLK)=0.0
    ZCAPE (:, JBLK)=0.0
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART0')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
    I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
    I_KCOUNT => GET_HOST_DATA_RDWR (YL_I_KCOUNT)
    PAPHIF => GET_HOST_DATA_RDWR (YD_PAPHIF)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTKE => GET_HOST_DATA_RDWR (YD_PTKE)
    PU => GET_HOST_DATA_RDWR (YD_PU)
    PV => GET_HOST_DATA_RDWR (YD_PV)
    ZAPHIF => GET_HOST_DATA_RDWR (YL_ZAPHIF)
    ZCAPE => GET_HOST_DATA_RDWR (YL_ZCAPE)
    ZCH1 => GET_HOST_DATA_RDWR (YL_ZCH1)
    ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
    ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
    ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
    ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
    ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
    ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
    ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
    ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
    ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZU => GET_HOST_DATA_RDWR (YL_ZU)
    ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
    ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
    ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
    ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
    ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
    ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
    ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
    ZV => GET_HOST_DATA_RDWR (YL_ZV)
    ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
    ZW => GET_HOST_DATA_RDWR (YL_ZW)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => NULL ()
  ICLBASS => NULL ()
  ICLTOP => NULL ()
  ICLTOPS => NULL ()
  I_KCLBAS => NULL ()
  I_KCLTOP => NULL ()
  I_KCOUNT => NULL ()
  PAPHIF => NULL ()
  PAPRSF => NULL ()
  PDELP => NULL ()
  PQ => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PT => NULL ()
  PTKE => NULL ()
  PU => NULL ()
  PV => NULL ()
  ZAPHIF => NULL ()
  ZCAPE => NULL ()
  ZCH1 => NULL ()
  ZDPSG => NULL ()
  ZDQIDT => NULL ()
  ZDQLDT => NULL ()
  ZDQVDT => NULL ()
  ZDTDT => NULL ()
  ZDUDT => NULL ()
  ZDVDT => NULL ()
  ZLS => NULL ()
  ZLV => NULL ()
  ZPABS => NULL ()
  ZQC => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TEN => NULL ()
  ZT => NULL ()
  ZTKECLS => NULL ()
  ZTTEN => NULL ()
  ZU => NULL ()
  ZUMF => NULL ()
  ZUMFMAX => NULL ()
  ZUQL => NULL ()
  ZUQV => NULL ()
  ZURCI => NULL ()
  ZURV => NULL ()
  ZUTEN => NULL ()
  ZV => NULL ()
  ZVTEN => NULL ()
  ZW => NULL ()
  ZZUMF => NULL ()
  ZZW => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','ACVPPKF_PARALLEL:PART0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
  ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
  ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
  ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
  I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
  I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
  I_KCOUNT => GET_HOST_DATA_RDWR (YL_I_KCOUNT)
  PAPHIF => GET_HOST_DATA_RDONLY (YD_PAPHIF)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PDELP => GET_HOST_DATA_RDONLY (YD_PDELP)
  PQ => GET_HOST_DATA_RDONLY (YD_PQ)
  PQI => GET_HOST_DATA_RDONLY (YD_PQI)
  PQL => GET_HOST_DATA_RDONLY (YD_PQL)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  PTKE => GET_HOST_DATA_RDONLY (YD_PTKE)
  PU => GET_HOST_DATA_RDONLY (YD_PU)
  PV => GET_HOST_DATA_RDONLY (YD_PV)
  ZAPHIF => GET_HOST_DATA_RDWR (YL_ZAPHIF)
  ZCAPE => GET_HOST_DATA_RDWR (YL_ZCAPE)
  ZCH1 => GET_HOST_DATA_RDONLY (YL_ZCH1)
  ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
  ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
  ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
  ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
  ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
  ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
  ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
  ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
  ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
  ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
  ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
  ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
  ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
  ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
  ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
  ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
  ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
  ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
  ZT => GET_HOST_DATA_RDWR (YL_ZT)
  ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
  ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
  ZU => GET_HOST_DATA_RDWR (YL_ZU)
  ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
  ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
  ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
  ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
  ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
  ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
  ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
  ZV => GET_HOST_DATA_RDWR (YL_ZV)
  ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
  ZW => GET_HOST_DATA_RDWR (YL_ZW)
  ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
  ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
  ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JKP, JLEV, JLON, JN, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      ZUMFMAX (JLON, JBLK)=1.E-12_JPRB
      ZW (JLON,:, JBLK)=0.0_JPRB
      ZTKECLS (JLON, JBLK)=0.0_JPRB

      IF (YDML_PHY_MF%YRPHY%LECT) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZW (JLON, JLEV, JBLK)=SQRT (MIN (3.0_JPRB, MAX (YDML_PHY_MF%YRPHY0&
          &%ECTMIN, PTKE (JLON, JLEV, JBLK)))/YDML_PHY_MF%YRPHY0%AECLS4)
        
        ENDDO

        
        ZTKECLS (JLON, JBLK)=PTKE (JLON, YDCPG_OPTS%KFLEVG, JBLK)
      
      ENDIF


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZDPSG (JLON, JLEV, JBLK)=PDELP (JLON, JLEV, JBLK)/YDCST%RG
        ZAPHIF (JLON, JLEV, JBLK)=PAPHIF (JLON, JLEV, JBLK)/YDCST%RG
      
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZDTDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQVDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQLDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQIDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDUDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDVDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZUMF (JLON, JLEV, JBLK)=0.0_JPRB
        ZUQV (JLON, JLEV, JBLK)=0.0_JPRB
        ZUQL (JLON, JLEV, JBLK)=0.0_JPRB
        ZLV (JLON, JLEV, JBLK)=FOLH (PT (JLON, JLEV, JBLK), 0.0_JPRB)
        ZLS (JLON, JLEV, JBLK)=FOLH (PT (JLON, JLEV, JBLK), 1.0_JPRB)
        ZQC (JLON, JLEV, JBLK)=PQL (JLON, JLEV, JBLK)+PQI (JLON, JLEV, JBLK)
      
      ENDDO

      
      I_KCOUNT (JLON, JBLK)=0
      ZCAPE (JLON, JBLK)=0.0_JPRB
      
      I_KCLTOP (JLON, JBLK)=1
      I_KCLBAS (JLON, JBLK)=1
      ICLTOP (JLON, JBLK)=1
      ICLBAS (JLON, JBLK)=1
      ICLTOPS (JLON, JBLK)=1
      ICLBASS (JLON, JBLK)=1

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        JKP=YDCPG_OPTS%KFLEVG-JLEV+1
        
        ZPABS (JLON, JKP, JBLK)=PAPRSF (JLON, JLEV, JBLK)
        ZZZ (JLON, JKP, JBLK)=ZAPHIF (JLON, JLEV, JBLK)
        ZT (JLON, JKP, JBLK)=PT (JLON, JLEV, JBLK)
        ZRV (JLON, JKP, JBLK)=PQ (JLON, JLEV, JBLK)/(1.0-PQ (JLON, JLEV, JBLK))
        ZRC (JLON, JKP, JBLK)=PQL (JLON, JLEV, JBLK)/(1.0-PQL (JLON, JLEV, JBLK))
        ZRI (JLON, JKP, JBLK)=PQI (JLON, JLEV, JBLK)/(1.0-PQI (JLON, JLEV, JBLK))
        ZU (JLON, JKP, JBLK)=PU (JLON, JLEV, JBLK)
        ZV (JLON, JKP, JBLK)=PV (JLON, JLEV, JBLK)
        ZZW (JLON, JKP, JBLK)=ZW (JLON, JLEV, JBLK)
      
      ENDDO


      IF (LLOCHTRANS) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          JKP=YDCPG_OPTS%KFLEVG-JLEV+1

          DO JN=1, I_KCH1
            
            ZSHAL_ZCH1 (JLON, JKP, JN, JBLK)=ZCH1 (JLON, JLEV, JN, JBLK)
          
          ENDDO

        ENDDO

      ENDIF

      I_KCOUNT (JLON, JBLK)=0
      ZTTEN (JLON,:, JBLK)=0.0
      ZRVTEN (JLON,:, JBLK)=0.0
      ZRCTEN (JLON,:, JBLK)=0.0
      ZRITEN (JLON,:, JBLK)=0.0
      ZUTEN (JLON,:, JBLK)=0.0
      ZVTEN (JLON,:, JBLK)=0.0
      ZZUMF (JLON,:, JBLK)=0.0
      ZURV (JLON,:, JBLK)=0.0
      ZURCI (JLON,:, JBLK)=0.0
      ZSHAL_ZCH1TEN (JLON,:,:, JBLK)=0.0
      ZCAPE (JLON, JBLK)=0.0
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART0')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
    I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
    I_KCOUNT => GET_HOST_DATA_RDWR (YL_I_KCOUNT)
    PAPHIF => GET_HOST_DATA_RDWR (YD_PAPHIF)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTKE => GET_HOST_DATA_RDWR (YD_PTKE)
    PU => GET_HOST_DATA_RDWR (YD_PU)
    PV => GET_HOST_DATA_RDWR (YD_PV)
    ZAPHIF => GET_HOST_DATA_RDWR (YL_ZAPHIF)
    ZCAPE => GET_HOST_DATA_RDWR (YL_ZCAPE)
    ZCH1 => GET_HOST_DATA_RDWR (YL_ZCH1)
    ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
    ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
    ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
    ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
    ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
    ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
    ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
    ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
    ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZU => GET_HOST_DATA_RDWR (YL_ZU)
    ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
    ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
    ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
    ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
    ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
    ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
    ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
    ZV => GET_HOST_DATA_RDWR (YL_ZV)
    ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
    ZW => GET_HOST_DATA_RDWR (YL_ZW)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => NULL ()
  ICLBASS => NULL ()
  ICLTOP => NULL ()
  ICLTOPS => NULL ()
  I_KCLBAS => NULL ()
  I_KCLTOP => NULL ()
  I_KCOUNT => NULL ()
  PAPHIF => NULL ()
  PAPRSF => NULL ()
  PDELP => NULL ()
  PQ => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PT => NULL ()
  PTKE => NULL ()
  PU => NULL ()
  PV => NULL ()
  ZAPHIF => NULL ()
  ZCAPE => NULL ()
  ZCH1 => NULL ()
  ZDPSG => NULL ()
  ZDQIDT => NULL ()
  ZDQLDT => NULL ()
  ZDQVDT => NULL ()
  ZDTDT => NULL ()
  ZDUDT => NULL ()
  ZDVDT => NULL ()
  ZLS => NULL ()
  ZLV => NULL ()
  ZPABS => NULL ()
  ZQC => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TEN => NULL ()
  ZT => NULL ()
  ZTKECLS => NULL ()
  ZTTEN => NULL ()
  ZU => NULL ()
  ZUMF => NULL ()
  ZUMFMAX => NULL ()
  ZUQL => NULL ()
  ZUQV => NULL ()
  ZURCI => NULL ()
  ZURV => NULL ()
  ZUTEN => NULL ()
  ZV => NULL ()
  ZVTEN => NULL ()
  ZW => NULL ()
  ZZUMF => NULL ()
  ZZW => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','ACVPPKF_PARALLEL:PART0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => GET_DEVICE_DATA_RDWR (YL_ICLBAS)
  ICLBASS => GET_DEVICE_DATA_RDWR (YL_ICLBASS)
  ICLTOP => GET_DEVICE_DATA_RDWR (YL_ICLTOP)
  ICLTOPS => GET_DEVICE_DATA_RDWR (YL_ICLTOPS)
  I_KCLBAS => GET_DEVICE_DATA_RDWR (YL_I_KCLBAS)
  I_KCLTOP => GET_DEVICE_DATA_RDWR (YL_I_KCLTOP)
  I_KCOUNT => GET_DEVICE_DATA_RDWR (YL_I_KCOUNT)
  PAPHIF => GET_DEVICE_DATA_RDONLY (YD_PAPHIF)
  PAPRSF => GET_DEVICE_DATA_RDONLY (YD_PAPRSF)
  PDELP => GET_DEVICE_DATA_RDONLY (YD_PDELP)
  PQ => GET_DEVICE_DATA_RDONLY (YD_PQ)
  PQI => GET_DEVICE_DATA_RDONLY (YD_PQI)
  PQL => GET_DEVICE_DATA_RDONLY (YD_PQL)
  PT => GET_DEVICE_DATA_RDONLY (YD_PT)
  PTKE => GET_DEVICE_DATA_RDONLY (YD_PTKE)
  PU => GET_DEVICE_DATA_RDONLY (YD_PU)
  PV => GET_DEVICE_DATA_RDONLY (YD_PV)
  ZAPHIF => GET_DEVICE_DATA_RDWR (YL_ZAPHIF)
  ZCAPE => GET_DEVICE_DATA_RDWR (YL_ZCAPE)
  ZCH1 => GET_DEVICE_DATA_RDONLY (YL_ZCH1)
  ZDPSG => GET_DEVICE_DATA_RDWR (YL_ZDPSG)
  ZDQIDT => GET_DEVICE_DATA_RDWR (YL_ZDQIDT)
  ZDQLDT => GET_DEVICE_DATA_RDWR (YL_ZDQLDT)
  ZDQVDT => GET_DEVICE_DATA_RDWR (YL_ZDQVDT)
  ZDTDT => GET_DEVICE_DATA_RDWR (YL_ZDTDT)
  ZDUDT => GET_DEVICE_DATA_RDWR (YL_ZDUDT)
  ZDVDT => GET_DEVICE_DATA_RDWR (YL_ZDVDT)
  ZLS => GET_DEVICE_DATA_RDWR (YL_ZLS)
  ZLV => GET_DEVICE_DATA_RDWR (YL_ZLV)
  ZPABS => GET_DEVICE_DATA_RDWR (YL_ZPABS)
  ZQC => GET_DEVICE_DATA_RDWR (YL_ZQC)
  ZRC => GET_DEVICE_DATA_RDWR (YL_ZRC)
  ZRCTEN => GET_DEVICE_DATA_RDWR (YL_ZRCTEN)
  ZRI => GET_DEVICE_DATA_RDWR (YL_ZRI)
  ZRITEN => GET_DEVICE_DATA_RDWR (YL_ZRITEN)
  ZRV => GET_DEVICE_DATA_RDWR (YL_ZRV)
  ZRVTEN => GET_DEVICE_DATA_RDWR (YL_ZRVTEN)
  ZSHAL_ZCH1 => GET_DEVICE_DATA_RDWR (YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TEN => GET_DEVICE_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
  ZT => GET_DEVICE_DATA_RDWR (YL_ZT)
  ZTKECLS => GET_DEVICE_DATA_RDWR (YL_ZTKECLS)
  ZTTEN => GET_DEVICE_DATA_RDWR (YL_ZTTEN)
  ZU => GET_DEVICE_DATA_RDWR (YL_ZU)
  ZUMF => GET_DEVICE_DATA_RDWR (YL_ZUMF)
  ZUMFMAX => GET_DEVICE_DATA_RDWR (YL_ZUMFMAX)
  ZUQL => GET_DEVICE_DATA_RDWR (YL_ZUQL)
  ZUQV => GET_DEVICE_DATA_RDWR (YL_ZUQV)
  ZURCI => GET_DEVICE_DATA_RDWR (YL_ZURCI)
  ZURV => GET_DEVICE_DATA_RDWR (YL_ZURV)
  ZUTEN => GET_DEVICE_DATA_RDWR (YL_ZUTEN)
  ZV => GET_DEVICE_DATA_RDWR (YL_ZV)
  ZVTEN => GET_DEVICE_DATA_RDWR (YL_ZVTEN)
  ZW => GET_DEVICE_DATA_RDWR (YL_ZW)
  ZZUMF => GET_DEVICE_DATA_RDWR (YL_ZZUMF)
  ZZW => GET_DEVICE_DATA_RDWR (YL_ZZW)
  ZZZ => GET_DEVICE_DATA_RDWR (YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (ICLBAS, ICLBASS, ICLTOP, ICLTOPS, I_KCLBAS, I_KCLTOP, I_KCOUNT, PAPHIF, &
    !$ACC&         PAPRSF, PDELP, PQ, PQI, PQL, PT, PTKE, PU, PV, YDCPG_OPTS, YDCST, YDML_PHY_MF, &
    !$ACC&         YFXTRAN_ACDC_STACK, ZAPHIF, ZCAPE, ZCH1, ZDPSG, ZDQIDT, ZDQLDT, ZDQVDT, &
    !$ACC&         ZDTDT, ZDUDT, ZDVDT, ZLS, ZLV, ZPABS, ZQC, ZRC, ZRCTEN, ZRI, ZRITEN, ZRV, ZRVTEN, &
    !$ACC&         ZSHAL_ZCH1, ZSHAL_ZCH1TEN, ZT, ZTKECLS, ZTTEN, ZU, ZUMF, ZUMFMAX, ZUQL, &
    !$ACC&         ZUQV, ZURCI, ZURV, ZUTEN, ZV, ZVTEN, ZW, ZZUMF, ZZW, ZZZ) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JKP, JLEV, JLON, JN, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      ZUMFMAX (JLON, JBLK)=1.E-12_JPRB
      ZW (JLON,:, JBLK)=0.0_JPRB
      ZTKECLS (JLON, JBLK)=0.0_JPRB

      IF (YDML_PHY_MF%YRPHY%LECT) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZW (JLON, JLEV, JBLK)=SQRT (MIN (3.0_JPRB, MAX (YDML_PHY_MF%YRPHY0&
          &%ECTMIN, PTKE (JLON, JLEV, JBLK)))/YDML_PHY_MF%YRPHY0%AECLS4)
        
        ENDDO

        
        ZTKECLS (JLON, JBLK)=PTKE (JLON, YDCPG_OPTS%KFLEVG, JBLK)
      
      ENDIF


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZDPSG (JLON, JLEV, JBLK)=PDELP (JLON, JLEV, JBLK)/YDCST%RG
        ZAPHIF (JLON, JLEV, JBLK)=PAPHIF (JLON, JLEV, JBLK)/YDCST%RG
      
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        ZDTDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQVDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQLDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDQIDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDUDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZDVDT (JLON, JLEV, JBLK)=0.0_JPRB
        ZUMF (JLON, JLEV, JBLK)=0.0_JPRB
        ZUQV (JLON, JLEV, JBLK)=0.0_JPRB
        ZUQL (JLON, JLEV, JBLK)=0.0_JPRB
        ZLV (JLON, JLEV, JBLK)=FOLH (PT (JLON, JLEV, JBLK), 0.0_JPRB)
        ZLS (JLON, JLEV, JBLK)=FOLH (PT (JLON, JLEV, JBLK), 1.0_JPRB)
        ZQC (JLON, JLEV, JBLK)=PQL (JLON, JLEV, JBLK)+PQI (JLON, JLEV, JBLK)
      
      ENDDO

      
      I_KCOUNT (JLON, JBLK)=0
      ZCAPE (JLON, JBLK)=0.0_JPRB
      
      I_KCLTOP (JLON, JBLK)=1
      I_KCLBAS (JLON, JBLK)=1
      ICLTOP (JLON, JBLK)=1
      ICLBAS (JLON, JBLK)=1
      ICLTOPS (JLON, JBLK)=1
      ICLBASS (JLON, JBLK)=1

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        JKP=YDCPG_OPTS%KFLEVG-JLEV+1
        
        ZPABS (JLON, JKP, JBLK)=PAPRSF (JLON, JLEV, JBLK)
        ZZZ (JLON, JKP, JBLK)=ZAPHIF (JLON, JLEV, JBLK)
        ZT (JLON, JKP, JBLK)=PT (JLON, JLEV, JBLK)
        ZRV (JLON, JKP, JBLK)=PQ (JLON, JLEV, JBLK)/(1.0-PQ (JLON, JLEV, JBLK))
        ZRC (JLON, JKP, JBLK)=PQL (JLON, JLEV, JBLK)/(1.0-PQL (JLON, JLEV, JBLK))
        ZRI (JLON, JKP, JBLK)=PQI (JLON, JLEV, JBLK)/(1.0-PQI (JLON, JLEV, JBLK))
        ZU (JLON, JKP, JBLK)=PU (JLON, JLEV, JBLK)
        ZV (JLON, JKP, JBLK)=PV (JLON, JLEV, JBLK)
        ZZW (JLON, JKP, JBLK)=ZW (JLON, JLEV, JBLK)
      
      ENDDO


      IF (LLOCHTRANS) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          JKP=YDCPG_OPTS%KFLEVG-JLEV+1

          DO JN=1, I_KCH1
            
            ZSHAL_ZCH1 (JLON, JKP, JN, JBLK)=ZCH1 (JLON, JLEV, JN, JBLK)
          
          ENDDO

        ENDDO

      ENDIF

      I_KCOUNT (JLON, JBLK)=0
      ZTTEN (JLON,:, JBLK)=0.0
      ZRVTEN (JLON,:, JBLK)=0.0
      ZRCTEN (JLON,:, JBLK)=0.0
      ZRITEN (JLON,:, JBLK)=0.0
      ZUTEN (JLON,:, JBLK)=0.0
      ZVTEN (JLON,:, JBLK)=0.0
      ZZUMF (JLON,:, JBLK)=0.0
      ZURV (JLON,:, JBLK)=0.0
      ZURCI (JLON,:, JBLK)=0.0
      ZSHAL_ZCH1TEN (JLON,:,:, JBLK)=0.0
      ZCAPE (JLON, JBLK)=0.0
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART0')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
    I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
    I_KCOUNT => GET_HOST_DATA_RDWR (YL_I_KCOUNT)
    PAPHIF => GET_HOST_DATA_RDWR (YD_PAPHIF)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PDELP => GET_HOST_DATA_RDWR (YD_PDELP)
    PQ => GET_HOST_DATA_RDWR (YD_PQ)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    PTKE => GET_HOST_DATA_RDWR (YD_PTKE)
    PU => GET_HOST_DATA_RDWR (YD_PU)
    PV => GET_HOST_DATA_RDWR (YD_PV)
    ZAPHIF => GET_HOST_DATA_RDWR (YL_ZAPHIF)
    ZCAPE => GET_HOST_DATA_RDWR (YL_ZCAPE)
    ZCH1 => GET_HOST_DATA_RDWR (YL_ZCH1)
    ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
    ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
    ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
    ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
    ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
    ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
    ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
    ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
    ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZU => GET_HOST_DATA_RDWR (YL_ZU)
    ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
    ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
    ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
    ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
    ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
    ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
    ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
    ZV => GET_HOST_DATA_RDWR (YL_ZV)
    ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
    ZW => GET_HOST_DATA_RDWR (YL_ZW)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => NULL ()
  ICLBASS => NULL ()
  ICLTOP => NULL ()
  ICLTOPS => NULL ()
  I_KCLBAS => NULL ()
  I_KCLTOP => NULL ()
  I_KCOUNT => NULL ()
  PAPHIF => NULL ()
  PAPRSF => NULL ()
  PDELP => NULL ()
  PQ => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PT => NULL ()
  PTKE => NULL ()
  PU => NULL ()
  PV => NULL ()
  ZAPHIF => NULL ()
  ZCAPE => NULL ()
  ZCH1 => NULL ()
  ZDPSG => NULL ()
  ZDQIDT => NULL ()
  ZDQLDT => NULL ()
  ZDQVDT => NULL ()
  ZDTDT => NULL ()
  ZDUDT => NULL ()
  ZDVDT => NULL ()
  ZLS => NULL ()
  ZLV => NULL ()
  ZPABS => NULL ()
  ZQC => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TEN => NULL ()
  ZT => NULL ()
  ZTKECLS => NULL ()
  ZTTEN => NULL ()
  ZU => NULL ()
  ZUMF => NULL ()
  ZUMFMAX => NULL ()
  ZUQL => NULL ()
  ZUQV => NULL ()
  ZURCI => NULL ()
  ZURV => NULL ()
  ZUTEN => NULL ()
  ZV => NULL ()
  ZVTEN => NULL ()
  ZW => NULL ()
  ZZUMF => NULL ()
  ZZW => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('ACVPPKF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART0',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','ACVPPKF_PARALLEL:PART1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
  ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
  ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
  ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
  ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
  LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
  ZPABS => GET_HOST_DATA_RDONLY (YL_ZPABS)
  ZRC => GET_HOST_DATA_RDONLY (YL_ZRC)
  ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
  ZRI => GET_HOST_DATA_RDONLY (YL_ZRI)
  ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
  ZRV => GET_HOST_DATA_RDONLY (YL_ZRV)
  ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
  ZSHAL_ZCH1 => GET_HOST_DATA_RDONLY (YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
  ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
  ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
  ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
  ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
  ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
  ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
  ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
  ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
  ZT => GET_HOST_DATA_RDONLY (YL_ZT)
  ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
  ZTKECLS => GET_HOST_DATA_RDONLY (YL_ZTKECLS)
  ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
  ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
  ZZW => GET_HOST_DATA_RDONLY (YL_ZZW)
  ZZZ => GET_HOST_DATA_RDONLY (YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS, D)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    D%NIJB = YLCPG_BNDS%KIDIA
    D%NIJE = YLCPG_BNDS%KFDIA
    D%NIB = YLCPG_BNDS%KIDIA
    D%NIE = YLCPG_BNDS%KFDIA
    
    CALL SHALLOW_CONVECTION_PART1 (YDML_PHY_MF%YRCVMNH%YRCVPEXT, YDML_PHY_MF%YRCVMNH%YRCVP_SHAL, YDML_PHY_MF&
    &%YRCVMNH%YRCST_MNH, D, YDML_PHY_MF%YRCVMNH%YRNSV, YDML_PHY_MF%YRCVMNH%YRCONVPAR, I_KBDIA, KTDIA&
    &, IKICE, YDML_PHY_MF%YRCVMNH%LSETTADJ, YDML_PHY_MF%YRCVMNH%OTADJS, ZPABS(:,:, JBLK), ZZZ(:,:&
    &, JBLK), ZTKECLS(:, JBLK), ZT(:,:, JBLK), ZRV(:,:, JBLK), ZRC(:,:, JBLK), ZRI(:,:, JBLK), ZZW&
    &(:,:, JBLK), ZTTEN(:,:, JBLK), ZRVTEN(:,:, JBLK), ZRCTEN(:,:, JBLK), ZRITEN(:,:, JBLK), ICLTOPS&
    &(:, JBLK), ICLBASS(:, JBLK), ZZUMF(:,:, JBLK), LLOCHTRANS, I_KCH1, ZSHAL_ZCH1(:,:,:, JBLK), ZSHAL_ZCH1TENS&
    &(:,:,:, JBLK), ZTHT(:,:, JBLK), ZSTHV(:,:, JBLK), ZSTHES(:,:, JBLK), ISDPL(:, JBLK), ISPBL(:&
    &, JBLK), ISLCL(:, JBLK), ZSTHLCL(:, JBLK), ZSTLCL(:, JBLK), ZSRVLCL(:, JBLK), ZSWLCL(:, JBLK&
    &), ZSZLCL(:, JBLK), ZSTHVELCL(:, JBLK), LLTRIG1(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART1')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
    ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
    ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
    LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
    ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
    ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
    ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
    ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
    ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
    ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
    ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
    ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
    ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => NULL ()
  ICLTOPS => NULL ()
  ISDPL => NULL ()
  ISLCL => NULL ()
  ISPBL => NULL ()
  LLTRIG1 => NULL ()
  ZPABS => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TENS => NULL ()
  ZSRVLCL => NULL ()
  ZSTHES => NULL ()
  ZSTHLCL => NULL ()
  ZSTHV => NULL ()
  ZSTHVELCL => NULL ()
  ZSTLCL => NULL ()
  ZSWLCL => NULL ()
  ZSZLCL => NULL ()
  ZT => NULL ()
  ZTHT => NULL ()
  ZTKECLS => NULL ()
  ZTTEN => NULL ()
  ZZUMF => NULL ()
  ZZW => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','ACVPPKF_PARALLEL:PART1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
  ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
  ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
  ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
  ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
  LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
  ZPABS => GET_HOST_DATA_RDONLY (YL_ZPABS)
  ZRC => GET_HOST_DATA_RDONLY (YL_ZRC)
  ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
  ZRI => GET_HOST_DATA_RDONLY (YL_ZRI)
  ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
  ZRV => GET_HOST_DATA_RDONLY (YL_ZRV)
  ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
  ZSHAL_ZCH1 => GET_HOST_DATA_RDONLY (YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
  ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
  ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
  ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
  ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
  ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
  ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
  ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
  ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
  ZT => GET_HOST_DATA_RDONLY (YL_ZT)
  ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
  ZTKECLS => GET_HOST_DATA_RDONLY (YL_ZTKECLS)
  ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
  ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
  ZZW => GET_HOST_DATA_RDONLY (YL_ZZW)
  ZZZ => GET_HOST_DATA_RDONLY (YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK) FIRSTPRIVATE (D)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      D%NIJB = YLCPG_BNDS%KIDIA
      D%NIJE = YLCPG_BNDS%KFDIA
      D%NIB = YLCPG_BNDS%KIDIA
      D%NIE = YLCPG_BNDS%KFDIA
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL SHALLOW_CONVECTION_PART1_OPENACC (YDML_PHY_MF%YRCVMNH%YRCVPEXT, YDML_PHY_MF%YRCVMNH%YRCVP_SHAL&
      &, YDML_PHY_MF%YRCVMNH%YRCST_MNH, D, YDML_PHY_MF%YRCVMNH%YRNSV, YDML_PHY_MF%YRCVMNH%YRCONVPAR, I_KBDIA&
      &, KTDIA, IKICE, YDML_PHY_MF%YRCVMNH%LSETTADJ, YDML_PHY_MF%YRCVMNH%OTADJS, ZPABS(:,:, JBLK), ZZZ&
      &(:,:, JBLK), ZTKECLS(:, JBLK), ZT(:,:, JBLK), ZRV(:,:, JBLK), ZRC(:,:, JBLK), ZRI(:,:, JBLK), ZZW&
      &(:,:, JBLK), ZTTEN(:,:, JBLK), ZRVTEN(:,:, JBLK), ZRCTEN(:,:, JBLK), ZRITEN(:,:, JBLK), ICLTOPS&
      &(:, JBLK), ICLBASS(:, JBLK), ZZUMF(:,:, JBLK), LLOCHTRANS, I_KCH1, ZSHAL_ZCH1(:,:,:, JBLK), ZSHAL_ZCH1TENS&
      &(:,:,:, JBLK), ZTHT(:,:, JBLK), ZSTHV(:,:, JBLK), ZSTHES(:,:, JBLK), ISDPL(:, JBLK), ISPBL(:, JBLK&
      &), ISLCL(:, JBLK), ZSTHLCL(:, JBLK), ZSTLCL(:, JBLK), ZSRVLCL(:, JBLK), ZSWLCL(:, JBLK), ZSZLCL&
      &(:, JBLK), ZSTHVELCL(:, JBLK), LLTRIG1(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART1')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
    ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
    ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
    LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
    ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
    ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
    ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
    ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
    ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
    ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
    ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
    ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
    ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => NULL ()
  ICLTOPS => NULL ()
  ISDPL => NULL ()
  ISLCL => NULL ()
  ISPBL => NULL ()
  LLTRIG1 => NULL ()
  ZPABS => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TENS => NULL ()
  ZSRVLCL => NULL ()
  ZSTHES => NULL ()
  ZSTHLCL => NULL ()
  ZSTHV => NULL ()
  ZSTHVELCL => NULL ()
  ZSTLCL => NULL ()
  ZSWLCL => NULL ()
  ZSZLCL => NULL ()
  ZT => NULL ()
  ZTHT => NULL ()
  ZTKECLS => NULL ()
  ZTTEN => NULL ()
  ZZUMF => NULL ()
  ZZW => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','ACVPPKF_PARALLEL:PART1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => GET_DEVICE_DATA_RDWR (YL_ICLBASS)
  ICLTOPS => GET_DEVICE_DATA_RDWR (YL_ICLTOPS)
  ISDPL => GET_DEVICE_DATA_RDWR (YL_ISDPL)
  ISLCL => GET_DEVICE_DATA_RDWR (YL_ISLCL)
  ISPBL => GET_DEVICE_DATA_RDWR (YL_ISPBL)
  LLTRIG1 => GET_DEVICE_DATA_RDWR (YL_LLTRIG1)
  ZPABS => GET_DEVICE_DATA_RDONLY (YL_ZPABS)
  ZRC => GET_DEVICE_DATA_RDONLY (YL_ZRC)
  ZRCTEN => GET_DEVICE_DATA_RDWR (YL_ZRCTEN)
  ZRI => GET_DEVICE_DATA_RDONLY (YL_ZRI)
  ZRITEN => GET_DEVICE_DATA_RDWR (YL_ZRITEN)
  ZRV => GET_DEVICE_DATA_RDONLY (YL_ZRV)
  ZRVTEN => GET_DEVICE_DATA_RDWR (YL_ZRVTEN)
  ZSHAL_ZCH1 => GET_DEVICE_DATA_RDONLY (YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TENS => GET_DEVICE_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
  ZSRVLCL => GET_DEVICE_DATA_RDWR (YL_ZSRVLCL)
  ZSTHES => GET_DEVICE_DATA_RDWR (YL_ZSTHES)
  ZSTHLCL => GET_DEVICE_DATA_RDWR (YL_ZSTHLCL)
  ZSTHV => GET_DEVICE_DATA_RDWR (YL_ZSTHV)
  ZSTHVELCL => GET_DEVICE_DATA_RDWR (YL_ZSTHVELCL)
  ZSTLCL => GET_DEVICE_DATA_RDWR (YL_ZSTLCL)
  ZSWLCL => GET_DEVICE_DATA_RDWR (YL_ZSWLCL)
  ZSZLCL => GET_DEVICE_DATA_RDWR (YL_ZSZLCL)
  ZT => GET_DEVICE_DATA_RDONLY (YL_ZT)
  ZTHT => GET_DEVICE_DATA_RDWR (YL_ZTHT)
  ZTKECLS => GET_DEVICE_DATA_RDONLY (YL_ZTKECLS)
  ZTTEN => GET_DEVICE_DATA_RDWR (YL_ZTTEN)
  ZZUMF => GET_DEVICE_DATA_RDWR (YL_ZZUMF)
  ZZW => GET_DEVICE_DATA_RDONLY (YL_ZZW)
  ZZZ => GET_DEVICE_DATA_RDONLY (YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (ICLBASS, ICLTOPS, ISDPL, ISLCL, ISPBL, LLTRIG1, YDCPG_OPTS, YDML_PHY_MF, &
    !$ACC&         YFXTRAN_ACDC_STACK, ZPABS, ZRC, ZRCTEN, ZRI, ZRITEN, ZRV, ZRVTEN, ZSHAL_ZCH1, &
    !$ACC&         ZSHAL_ZCH1TENS, ZSRVLCL, ZSTHES, ZSTHLCL, ZSTHV, ZSTHVELCL, ZSTLCL, &
    !$ACC&         ZSWLCL, ZSZLCL, ZT, ZTHT, ZTKECLS, ZTTEN, ZZUMF, ZZW, ZZZ) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (DD, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      DD = D
      DD%NIJB = YLCPG_BNDS%KIDIA
      DD%NIJE = YLCPG_BNDS%KFDIA
      DD%NIB = YLCPG_BNDS%KIDIA
      DD%NIE = YLCPG_BNDS%KFDIA
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL SHALLOW_CONVECTION_PART1_OPENACC (YDML_PHY_MF%YRCVMNH%YRCVPEXT, YDML_PHY_MF%YRCVMNH%YRCVP_SHAL&
      &, YDML_PHY_MF%YRCVMNH%YRCST_MNH, DD, YDML_PHY_MF%YRCVMNH%YRNSV, YDML_PHY_MF%YRCVMNH%YRCONVPAR, I_KBDIA&
      &, KTDIA, IKICE, YDML_PHY_MF%YRCVMNH%LSETTADJ, YDML_PHY_MF%YRCVMNH%OTADJS, ZPABS(:,:, JBLK), ZZZ&
      &(:,:, JBLK), ZTKECLS(:, JBLK), ZT(:,:, JBLK), ZRV(:,:, JBLK), ZRC(:,:, JBLK), ZRI(:,:, JBLK), ZZW&
      &(:,:, JBLK), ZTTEN(:,:, JBLK), ZRVTEN(:,:, JBLK), ZRCTEN(:,:, JBLK), ZRITEN(:,:, JBLK), ICLTOPS&
      &(:, JBLK), ICLBASS(:, JBLK), ZZUMF(:,:, JBLK), LLOCHTRANS, I_KCH1, ZSHAL_ZCH1(:,:,:, JBLK), ZSHAL_ZCH1TENS&
      &(:,:,:, JBLK), ZTHT(:,:, JBLK), ZSTHV(:,:, JBLK), ZSTHES(:,:, JBLK), ISDPL(:, JBLK), ISPBL(:, JBLK&
      &), ISLCL(:, JBLK), ZSTHLCL(:, JBLK), ZSTLCL(:, JBLK), ZSRVLCL(:, JBLK), ZSWLCL(:, JBLK), ZSZLCL&
      &(:, JBLK), ZSTHVELCL(:, JBLK), LLTRIG1(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART1')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
    ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
    ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
    LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
    ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
    ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
    ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
    ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
    ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
    ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
    ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
    ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
    ZTKECLS => GET_HOST_DATA_RDWR (YL_ZTKECLS)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZW => GET_HOST_DATA_RDWR (YL_ZZW)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => NULL ()
  ICLTOPS => NULL ()
  ISDPL => NULL ()
  ISLCL => NULL ()
  ISPBL => NULL ()
  LLTRIG1 => NULL ()
  ZPABS => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TENS => NULL ()
  ZSRVLCL => NULL ()
  ZSTHES => NULL ()
  ZSTHLCL => NULL ()
  ZSTHV => NULL ()
  ZSTHVELCL => NULL ()
  ZSTLCL => NULL ()
  ZSWLCL => NULL ()
  ZSZLCL => NULL ()
  ZT => NULL ()
  ZTHT => NULL ()
  ZTKECLS => NULL ()
  ZTTEN => NULL ()
  ZZUMF => NULL ()
  ZZW => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('ACVPPKF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART1',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','ACVPPKF_PARALLEL:PART2')) THEN
  
  CALL YL_FGS%INIT (YL_LLTRIG1, YDCPG_OPTS%KGPTOTB)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ICLBASS)
  ICLTOPS => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ICLTOPS)
  ISDPL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ISDPL)
  ISLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ISLCL)
  ISPBL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ISPBL)
  LLTRIG1 => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_LLTRIG1)
  ZPABS => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZPABS)
  ZRC => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZRC)
  ZRCTEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZRCTEN)
  ZRI => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZRI)
  ZRITEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZRITEN)
  ZRV => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZRV)
  ZRVTEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZRVTEN)
  ZSHAL_ZCH1 => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TENS => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZSHAL_ZCH1TENS)
  ZSRVLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSRVLCL)
  ZSTHES => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHES)
  ZSTHLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHLCL)
  ZSTHV => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHV)
  ZSTHVELCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHVELCL)
  ZSTLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTLCL)
  ZSWLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSWLCL)
  ZSZLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSZLCL)
  ZT => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZT)
  ZTHT => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZTHT)
  ZTTEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZTTEN)
  ZZUMF => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZZUMF)
  ZZZ => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YL_FGS%KLON, YL_FGS%KGPTOT)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS, D)

  DO JBLK = 1, YL_FGS%KGPBLKS
    CALL YLCPG_BNDS%UPDATE (JBLK)
    D%NIJB = YLCPG_BNDS%KIDIA
    D%NIJE = YLCPG_BNDS%KFDIA
    D%NIB = YLCPG_BNDS%KIDIA
    D%NIE = YLCPG_BNDS%KFDIA
    
    CALL SHALLOW_CONVECTION_PART2 (YDML_PHY_MF%YRCVMNH%YRCVP_SHAL, YDML_PHY_MF%YRCVMNH%YRCVPEXT, YDML_PHY_MF&
    &%YRCVMNH%YRCST_MNH, D, YDML_PHY_MF%YRCVMNH%YRNSV, YDML_PHY_MF%YRCVMNH%YRCONVPAR, IKICE, YDML_PHY_MF&
    &%YRCVMNH%LSETTADJ, YDML_PHY_MF%YRCVMNH%OTADJS, ZPABS(:,:, JBLK), ZZZ(:,:, JBLK), ZT(:,:, JBLK), ZRV&
    &(:,:, JBLK), ZRC(:,:, JBLK), ZRI(:,:, JBLK), LLOCHTRANS, I_KCH1, ZSHAL_ZCH1(:,:,:, JBLK), ZRDOCP, ZTHT&
    &(:,:, JBLK), ZSTHV(:,:, JBLK), ZSTHES(:,:, JBLK), ISDPL(:, JBLK), ISPBL(:, JBLK), ISLCL(:, JBLK), ZSTHLCL&
    &(:, JBLK), ZSTLCL(:, JBLK), ZSRVLCL(:, JBLK), ZSWLCL(:, JBLK), ZSZLCL(:, JBLK), ZSTHVELCL(:, JBLK),&
    & LLTRIG1(:, JBLK), ZZUMF(:,:, JBLK), ZTTEN(:,:, JBLK), ZRVTEN(:,:, JBLK), ZRCTEN(:,:, JBLK), ZRITEN&
    &(:,:, JBLK), ICLTOPS(:, JBLK), ICLBASS(:, JBLK), ZSHAL_ZCH1TENS(:,:,:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  CALL YL_FGS%SCATTER ()

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART2')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
    ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
    ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
    LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
    ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
    ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
    ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
    ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
    ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
    ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
    ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
    ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => NULL ()
  ICLTOPS => NULL ()
  ISDPL => NULL ()
  ISLCL => NULL ()
  ISPBL => NULL ()
  LLTRIG1 => NULL ()
  ZPABS => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TENS => NULL ()
  ZSRVLCL => NULL ()
  ZSTHES => NULL ()
  ZSTHLCL => NULL ()
  ZSTHV => NULL ()
  ZSTHVELCL => NULL ()
  ZSTLCL => NULL ()
  ZSWLCL => NULL ()
  ZSZLCL => NULL ()
  ZT => NULL ()
  ZTHT => NULL ()
  ZTTEN => NULL ()
  ZZUMF => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','ACVPPKF_PARALLEL:PART2')) THEN
  
  CALL YL_FGS%INIT (YL_LLTRIG1, YDCPG_OPTS%KGPTOTB)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ICLBASS)
  ICLTOPS => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ICLTOPS)
  ISDPL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ISDPL)
  ISLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ISLCL)
  ISPBL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ISPBL)
  LLTRIG1 => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_LLTRIG1)
  ZPABS => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZPABS)
  ZRC => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZRC)
  ZRCTEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZRCTEN)
  ZRI => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZRI)
  ZRITEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZRITEN)
  ZRV => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZRV)
  ZRVTEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZRVTEN)
  ZSHAL_ZCH1 => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TENS => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZSHAL_ZCH1TENS)
  ZSRVLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSRVLCL)
  ZSTHES => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHES)
  ZSTHLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHLCL)
  ZSTHV => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHV)
  ZSTHVELCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTHVELCL)
  ZSTLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSTLCL)
  ZSWLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSWLCL)
  ZSZLCL => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZSZLCL)
  ZT => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZT)
  ZTHT => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZTHT)
  ZTTEN => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZTTEN)
  ZZUMF => GATHER_HOST_DATA_RDWR (YL_FGS, YL_ZZUMF)
  ZZZ => GATHER_HOST_DATA_RDONLY (YL_FGS, YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK) FIRSTPRIVATE (D)

  DO JBLK = 1, YL_FGS%KGPBLKS

    

    

    DO JLON = 1, MIN (YL_FGS%KLON, YL_FGS%KGPTOT - (JBLK - 1) * YL_FGS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      D%NIJB = YLCPG_BNDS%KIDIA
      D%NIJE = YLCPG_BNDS%KFDIA
      D%NIB = YLCPG_BNDS%KIDIA
      D%NIE = YLCPG_BNDS%KFDIA
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      
      CALL SHALLOW_CONVECTION_PART2_OPENACC (YDML_PHY_MF%YRCVMNH%YRCVP_SHAL, YDML_PHY_MF%YRCVMNH%YRCVPEXT&
      &, YDML_PHY_MF%YRCVMNH%YRCST_MNH, D, YDML_PHY_MF%YRCVMNH%YRNSV, YDML_PHY_MF%YRCVMNH%YRCONVPAR&
      &, IKICE, YDML_PHY_MF%YRCVMNH%LSETTADJ, YDML_PHY_MF%YRCVMNH%OTADJS, ZPABS(:,:, JBLK), ZZZ(:&
      &,:, JBLK), ZT(:,:, JBLK), ZRV(:,:, JBLK), ZRC(:,:, JBLK), ZRI(:,:, JBLK), LLOCHTRANS, I_KCH1&
      &, ZSHAL_ZCH1(:,:,:, JBLK), ZRDOCP, ZTHT(:,:, JBLK), ZSTHV(:,:, JBLK), ZSTHES(:,:, JBLK), ISDPL&
      &(:, JBLK), ISPBL(:, JBLK), ISLCL(:, JBLK), ZSTHLCL(:, JBLK), ZSTLCL(:, JBLK), ZSRVLCL(:, JBLK&
      &), ZSWLCL(:, JBLK), ZSZLCL(:, JBLK), ZSTHVELCL(:, JBLK), LLTRIG1(:, JBLK), ZZUMF(:,:, JBLK&
      &), ZTTEN(:,:, JBLK), ZRVTEN(:,:, JBLK), ZRCTEN(:,:, JBLK), ZRITEN(:,:, JBLK), ICLTOPS(:, JBLK&
      &), ICLBASS(:, JBLK), ZSHAL_ZCH1TENS(:,:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  CALL YL_FGS%SCATTER ()

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART2')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
    ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
    ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
    LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
    ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
    ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
    ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
    ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
    ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
    ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
    ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
    ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => NULL ()
  ICLTOPS => NULL ()
  ISDPL => NULL ()
  ISLCL => NULL ()
  ISPBL => NULL ()
  LLTRIG1 => NULL ()
  ZPABS => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TENS => NULL ()
  ZSRVLCL => NULL ()
  ZSTHES => NULL ()
  ZSTHLCL => NULL ()
  ZSTHV => NULL ()
  ZSTHVELCL => NULL ()
  ZSTLCL => NULL ()
  ZSWLCL => NULL ()
  ZSZLCL => NULL ()
  ZT => NULL ()
  ZTHT => NULL ()
  ZTTEN => NULL ()
  ZZUMF => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','ACVPPKF_PARALLEL:PART2')) THEN
  
  CALL YL_FGS%INIT (YL_LLTRIG1, YDCPG_OPTS%KGPTOTB)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ICLBASS)
  ICLTOPS => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ICLTOPS)
  ISDPL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ISDPL)
  ISLCL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ISLCL)
  ISPBL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ISPBL)
  LLTRIG1 => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_LLTRIG1)
  ZPABS => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZPABS)
  ZRC => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZRC)
  ZRCTEN => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ZRCTEN)
  ZRI => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZRI)
  ZRITEN => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ZRITEN)
  ZRV => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZRV)
  ZRVTEN => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ZRVTEN)
  ZSHAL_ZCH1 => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSHAL_ZCH1)
  ZSHAL_ZCH1TENS => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ZSHAL_ZCH1TENS)
  ZSRVLCL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSRVLCL)
  ZSTHES => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSTHES)
  ZSTHLCL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSTHLCL)
  ZSTHV => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSTHV)
  ZSTHVELCL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSTHVELCL)
  ZSTLCL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSTLCL)
  ZSWLCL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSWLCL)
  ZSZLCL => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZSZLCL)
  ZT => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZT)
  ZTHT => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZTHT)
  ZTTEN => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ZTTEN)
  ZZUMF => GATHER_DEVICE_DATA_RDWR (YL_FGS, YL_ZZUMF)
  ZZZ => GATHER_DEVICE_DATA_RDONLY (YL_FGS, YL_ZZZ)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&COPYIN (YL_FGS) &
    !$ACC&PRESENT (ICLBASS, ICLTOPS, ISDPL, ISLCL, ISPBL, LLTRIG1, YDML_PHY_MF, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZPABS, ZRC, ZRCTEN, ZRI, ZRITEN, ZRV, ZRVTEN, ZSHAL_ZCH1, ZSHAL_ZCH1TENS, &
    !$ACC&         ZSRVLCL, ZSTHES, ZSTHLCL, ZSTHV, ZSTHVELCL, ZSTLCL, ZSWLCL, ZSZLCL, &
    !$ACC&         ZT, ZTHT, ZTTEN, ZZUMF, ZZZ) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = 1, YL_FGS%KGPBLKS
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (DD, JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YL_FGS%KLON, YL_FGS%KGPTOT - (JBLK - 1) * YL_FGS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      DD = D
      DD%NIJB = YLCPG_BNDS%KIDIA
      DD%NIJE = YLCPG_BNDS%KFDIA
      DD%NIB = YLCPG_BNDS%KIDIA
      DD%NIE = YLCPG_BNDS%KFDIA
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-1)+1, YL_FGS%KGPBLKS)
      
      CALL SHALLOW_CONVECTION_PART2_OPENACC (YDML_PHY_MF%YRCVMNH%YRCVP_SHAL, YDML_PHY_MF%YRCVMNH%YRCVPEXT&
      &, YDML_PHY_MF%YRCVMNH%YRCST_MNH, DD, YDML_PHY_MF%YRCVMNH%YRNSV, YDML_PHY_MF%YRCVMNH%YRCONVPAR&
      &, IKICE, YDML_PHY_MF%YRCVMNH%LSETTADJ, YDML_PHY_MF%YRCVMNH%OTADJS, ZPABS(:,:, JBLK), ZZZ(:&
      &,:, JBLK), ZT(:,:, JBLK), ZRV(:,:, JBLK), ZRC(:,:, JBLK), ZRI(:,:, JBLK), LLOCHTRANS, I_KCH1&
      &, ZSHAL_ZCH1(:,:,:, JBLK), ZRDOCP, ZTHT(:,:, JBLK), ZSTHV(:,:, JBLK), ZSTHES(:,:, JBLK), ISDPL&
      &(:, JBLK), ISPBL(:, JBLK), ISLCL(:, JBLK), ZSTHLCL(:, JBLK), ZSTLCL(:, JBLK), ZSRVLCL(:, JBLK&
      &), ZSWLCL(:, JBLK), ZSZLCL(:, JBLK), ZSTHVELCL(:, JBLK), LLTRIG1(:, JBLK), ZZUMF(:,:, JBLK&
      &), ZTTEN(:,:, JBLK), ZRVTEN(:,:, JBLK), ZRCTEN(:,:, JBLK), ZRITEN(:,:, JBLK), ICLTOPS(:, JBLK&
      &), ICLBASS(:, JBLK), ZSHAL_ZCH1TENS(:,:,:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)
  CALL YL_FGS%SCATTER ()

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART2')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    ISDPL => GET_HOST_DATA_RDWR (YL_ISDPL)
    ISLCL => GET_HOST_DATA_RDWR (YL_ISLCL)
    ISPBL => GET_HOST_DATA_RDWR (YL_ISPBL)
    LLTRIG1 => GET_HOST_DATA_RDWR (YL_LLTRIG1)
    ZPABS => GET_HOST_DATA_RDWR (YL_ZPABS)
    ZRC => GET_HOST_DATA_RDWR (YL_ZRC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRI => GET_HOST_DATA_RDWR (YL_ZRI)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRV => GET_HOST_DATA_RDWR (YL_ZRV)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1 => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1)
    ZSHAL_ZCH1TENS => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TENS)
    ZSRVLCL => GET_HOST_DATA_RDWR (YL_ZSRVLCL)
    ZSTHES => GET_HOST_DATA_RDWR (YL_ZSTHES)
    ZSTHLCL => GET_HOST_DATA_RDWR (YL_ZSTHLCL)
    ZSTHV => GET_HOST_DATA_RDWR (YL_ZSTHV)
    ZSTHVELCL => GET_HOST_DATA_RDWR (YL_ZSTHVELCL)
    ZSTLCL => GET_HOST_DATA_RDWR (YL_ZSTLCL)
    ZSWLCL => GET_HOST_DATA_RDWR (YL_ZSWLCL)
    ZSZLCL => GET_HOST_DATA_RDWR (YL_ZSZLCL)
    ZT => GET_HOST_DATA_RDWR (YL_ZT)
    ZTHT => GET_HOST_DATA_RDWR (YL_ZTHT)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    ZZZ => GET_HOST_DATA_RDWR (YL_ZZZ)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBASS => NULL ()
  ICLTOPS => NULL ()
  ISDPL => NULL ()
  ISLCL => NULL ()
  ISPBL => NULL ()
  LLTRIG1 => NULL ()
  ZPABS => NULL ()
  ZRC => NULL ()
  ZRCTEN => NULL ()
  ZRI => NULL ()
  ZRITEN => NULL ()
  ZRV => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1 => NULL ()
  ZSHAL_ZCH1TENS => NULL ()
  ZSRVLCL => NULL ()
  ZSTHES => NULL ()
  ZSTHLCL => NULL ()
  ZSTHV => NULL ()
  ZSTHVELCL => NULL ()
  ZSTLCL => NULL ()
  ZSWLCL => NULL ()
  ZSZLCL => NULL ()
  ZT => NULL ()
  ZTHT => NULL ()
  ZTTEN => NULL ()
  ZZUMF => NULL ()
  ZZZ => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('ACVPPKF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART2',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','ACVPPKF_PARALLEL:PART3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
  ICLBASS => GET_HOST_DATA_RDONLY (YL_ICLBASS)
  ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
  ICLTOPS => GET_HOST_DATA_RDONLY (YL_ICLTOPS)
  I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
  I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
  KNLAB => GET_HOST_DATA_RDWR (YD_KNLAB)
  KNND => GET_HOST_DATA_RDWR (YD_KNND)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PCP => GET_HOST_DATA_RDONLY (YD_PCP)
  PDIFCQ => GET_HOST_DATA_RDWR (YD_PDIFCQ)
  PDIFCS => GET_HOST_DATA_RDWR (YD_PDIFCS)
  PFCCQL => GET_HOST_DATA_RDWR (YD_PFCCQL)
  PFCCQN => GET_HOST_DATA_RDWR (YD_PFCCQN)
  PNEBPP => GET_HOST_DATA_RDWR (YD_PNEBPP)
  PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
  PQCPP => GET_HOST_DATA_RDWR (YD_PQCPP)
  PR => GET_HOST_DATA_RDONLY (YD_PR)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  ZBETA => GET_HOST_DATA_RDWR (YL_ZBETA)
  ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZCH1TEN)
  ZDPSG => GET_HOST_DATA_RDONLY (YL_ZDPSG)
  ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
  ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
  ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
  ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
  ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
  ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
  ZLS => GET_HOST_DATA_RDONLY (YL_ZLS)
  ZLV => GET_HOST_DATA_RDONLY (YL_ZLV)
  ZQC => GET_HOST_DATA_RDONLY (YL_ZQC)
  ZRCTEN => GET_HOST_DATA_RDONLY (YL_ZRCTEN)
  ZRHO => GET_HOST_DATA_RDWR (YL_ZRHO)
  ZRITEN => GET_HOST_DATA_RDONLY (YL_ZRITEN)
  ZRVTEN => GET_HOST_DATA_RDONLY (YL_ZRVTEN)
  ZSHAL_ZCH1TEN => GET_HOST_DATA_RDONLY (YL_ZSHAL_ZCH1TEN)
  ZTHETA => GET_HOST_DATA_RDWR (YL_ZTHETA)
  ZTTEN => GET_HOST_DATA_RDONLY (YL_ZTTEN)
  ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
  ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
  ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
  ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
  ZURCI => GET_HOST_DATA_RDONLY (YL_ZURCI)
  ZURV => GET_HOST_DATA_RDONLY (YL_ZURV)
  ZUTEN => GET_HOST_DATA_RDONLY (YL_ZUTEN)
  ZVTEN => GET_HOST_DATA_RDONLY (YL_ZVTEN)
  ZZUMF => GET_HOST_DATA_RDONLY (YL_ZZUMF)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JKP, JLEV, JLON, JN, ZDQCDT, ZDTLDT, ZTDCP) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      ICLTOP (JLON, JBLK)=MAX (ICLTOP (JLON, JBLK), ICLTOPS (JLON, JBLK))
      ICLBAS (JLON, JBLK)=MAX (ICLBAS (JLON, JBLK), ICLBASS (JLON, JBLK))
    ENDDO


    DO JLEV=1, YDCPG_OPTS%KFLEVG
      JKP=YDCPG_OPTS%KFLEVG-JLEV+1

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZDTDT (JLON, JLEV, JBLK)=ZTTEN (JLON, JKP, JBLK)
        ZDQVDT (JLON, JLEV, JBLK)=ZRVTEN (JLON, JKP, JBLK)
        ZDQLDT (JLON, JLEV, JBLK)=ZRCTEN (JLON, JKP, JBLK)
        ZDQIDT (JLON, JLEV, JBLK)=ZRITEN (JLON, JKP, JBLK)
        ZDUDT (JLON, JLEV, JBLK)=ZUTEN (JLON, JKP, JBLK)
        ZDVDT (JLON, JLEV, JBLK)=ZVTEN (JLON, JKP, JBLK)
        ZUMF (JLON, JLEV, JBLK)=ZZUMF (JLON, JKP, JBLK)
        ZUQV (JLON, JLEV, JBLK)=ZURV (JLON, JKP, JBLK)/(1.0+ZURV (JLON, JKP, JBLK))
        ZUQL (JLON, JLEV, JBLK)=ZURCI (JLON, JKP, JBLK)/(1.0+ZURCI (JLON, JKP, JBLK))
      ENDDO

    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      JLEV=ICLTOP (JLON, JBLK)
      I_KCLTOP (JLON, JBLK)=YDCPG_OPTS%KFLEVG-JLEV+1
      JLEV=ICLBAS (JLON, JBLK)
      I_KCLBAS (JLON, JBLK)=YDCPG_OPTS%KFLEVG-JLEV+1

      IF (ICLTOP (JLON, JBLK)==1)  THEN
        I_KCLTOP (JLON, JBLK)=1
      ENDIF


      IF (ICLBAS (JLON, JBLK)==1)  THEN
        I_KCLBAS (JLON, JBLK)=1
      ENDIF

    ENDDO


    IF (LLOCHTRANS) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        JKP=YDCPG_OPTS%KFLEVG-JLEV+1

        DO JN=1, I_KCH1

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            ZCH1TEN (JLON, JLEV, JN, JBLK)=ZSHAL_ZCH1TEN (JLON, JKP, JN, JBLK)
          ENDDO

        ENDDO

      ENDDO

    ENDIF

    PPRODTH (:,:, JBLK)=0.0_JPRB

    IF (YDML_PHY_MF%YRPHY0%RPRTH>0._JPRB) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZBETA (JLON, JLEV, JBLK)=(YDCST%RATM/PAPRSF (JLON, JLEV, JBLK))**(YDCST%RKAPPA)
          ZTHETA (JLON, JLEV, JBLK)=PT (JLON, JLEV, JBLK)*ZBETA (JLON, JLEV, JBLK)
          ZRHO (JLON, JLEV, JBLK)=PAPRSF (JLON, JLEV, JBLK)/(PR (JLON, JLEV, JBLK)*PT (JLON, JLEV, JBLK))
        ENDDO

      ENDDO


      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        ZTHETA (JLON, 0, JBLK)=ZTHETA (JLON, 1, JBLK)
        ZRHO (JLON, 0, JBLK)=ZRHO (JLON, 1, JBLK)
        ZTHETA (JLON, YDCPG_OPTS%KFLEVG+1, JBLK)=ZTHETA (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZRHO (JLON, YDCPG_OPTS%KFLEVG+1, JBLK)=ZRHO (JLON, YDCPG_OPTS%KFLEVG, JBLK)
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZTDCP=ZVMD*ZDQVDT (JLON, JLEV, JBLK)+ZWMD*ZDQLDT (JLON, JLEV, JBLK)+ZSMD*ZDQIDT (JLON, JLEV, JBLK)
          ZDQCDT=ZDQLDT (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK)
          ZDTLDT=ZBETA (JLON, JLEV, JBLK)*(ZDTDT (JLON, JLEV, JBLK)+ZLV (JLON, JLEV, JBLK)/PCP&
          & (JLON, JLEV, JBLK)*(ZQC (JLON, JLEV, JBLK)*ZTDCP/PCP (JLON, JLEV, JBLK)-ZDQCDT))
          PPRODTH (JLON, JLEV, JBLK)=PPRODTH (JLON, JLEV-1, JBLK)-ZDPSG (JLON, JLEV, JBLK)*ZDTLDT
        ENDDO

      ENDDO


      DO JLEV=0, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PPRODTH (JLON, JLEV, JBLK)=PPRODTH (JLON, JLEV, JBLK)*YDCST%RG*4._JPRB/(ZRHO (JLON, JLEV, JBLK&
          &)+ZRHO (JLON, JLEV+1, JBLK))/(ZTHETA (JLON, JLEV, JBLK)+ZTHETA (JLON, JLEV+1, JBLK))
        ENDDO

      ENDDO

    ENDIF


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        KNLAB (JLON, JLEV, JBLK)=1-MAX (0, MIN (1,(I_KCLTOP &
        &(JLON, JBLK)-JLEV)*(I_KCLBAS (JLON, JBLK)-JLEV)))
      ENDDO

      KNND (JLON, JBLK)=MIN (1, I_KCLTOP (JLON, JBLK)-1)
    ENDDO


    IF (YDML_PHY_MF%YRPHY0%RKFBTAU>0._JPRB) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZDQCDT=MAX (0.0_JPRB, ZDQLDT (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK))
          PQCPP (JLON, JLEV, JBLK)=YDML_PHY_MF%YRPHY0%RKFBTAU*ZDQCDT*FLOAT (KNLAB (JLON, JLEV, JBLK))
          PNEBPP (JLON, JLEV, JBLK)=MAX (ZEPS, MIN (YDML_PHY_MF%YRPHY0%RKFBNBX&
          &, PQCPP (JLON, JLEV, JBLK)/YDML_PHY_MF%YRPHY0%RQLCR))
          ZUMFMAX (JLON, JBLK)=MAX (ZUMFMAX (JLON, JBLK), ZUMF (JLON, JLEV, JBLK))
        ENDDO

      ENDDO


      IF (.NOT.YDML_PHY_MF%YRCVMNH%LSMOOTH) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            PQCPP (JLON, JLEV, JBLK)=PQCPP (JLON, JLEV, JBLK)*MIN (1.0_JPRB&
            &, ZUMF (JLON, JLEV, JBLK)/ZUMFMAX (JLON, JBLK))
            PNEBPP (JLON, JLEV, JBLK)=MAX (ZEPS, MIN (YDML_PHY_MF%YRPHY0%RKFBNBX&
            &, PQCPP (JLON, JLEV, JBLK)/YDML_PHY_MF%YRPHY0%RQLCR))
          ENDDO

        ENDDO

      ENDIF

    ENDIF


    IF (.NOT.LLCONDWT) THEN

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          ZDQVDT (JLON, JLEV, JBLK)=ZDQVDT (JLON, JLEV, JBLK)+ZDQLDT&
          & (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK)
          ZDTDT (JLON, JLEV, JBLK)=ZDTDT (JLON, JLEV, JBLK)-(ZLV (JLON, JLEV, JBLK)*ZDQLDT (JLON, JLEV&
          &, JBLK)+ZLS (JLON, JLEV, JBLK)*ZDQIDT (JLON, JLEV, JBLK))/PCP (JLON, JLEV, JBLK)
          ZDQLDT (JLON, JLEV, JBLK)=0.0_JPRB
          ZDQIDT (JLON, JLEV, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

    ELSE

      DO JLEV=1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PFCCQL (JLON, JLEV, JBLK)=PFCCQL (JLON, JLEV-1, JBLK)+ZDPSG&
          & (JLON, JLEV, JBLK)*ZDQLDT (JLON, JLEV, JBLK)
          PFCCQN (JLON, JLEV, JBLK)=PFCCQN (JLON, JLEV-1, JBLK)+ZDPSG&
          & (JLON, JLEV, JBLK)*ZDQIDT (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF


    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PDIFCQ (JLON, JLEV, JBLK)=PDIFCQ (JLON, JLEV-1, JBLK)-ZDPSG&
        & (JLON, JLEV, JBLK)*ZDQVDT (JLON, JLEV, JBLK)
        ZTDCP=ZVMD*ZDQVDT (JLON, JLEV, JBLK)+ZWMD*ZDQLDT (JLON, JLEV, JBLK)+ZSMD*ZDQIDT (JLON, JLEV, JBLK)
        PDIFCS (JLON, JLEV, JBLK)=PDIFCS (JLON, JLEV-1, JBLK)-ZDPSG (JLON, JLEV, JBLK)*(ZDTDT (JLON, JLEV&
        &, JBLK)*(PCP (JLON, JLEV, JBLK)+YDML_PHY_MF%YRPHY2%TSPHY*ZTDCP)+PT (JLON, JLEV, JBLK)*ZTDCP)
      ENDDO

    ENDDO


    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PDIFCQ (JLON, JLEV, JBLK)=PDIFCQ (JLON, JLEV, JBLK)-PFCCQL&
        & (JLON, JLEV, JBLK)-PFCCQN (JLON, JLEV, JBLK)
        PDIFCS (JLON, JLEV, JBLK)=PDIFCS (JLON, JLEV, JBLK)+YDCST%RLVZER*PFCCQL&
        & (JLON, JLEV, JBLK)+YDCST%RLSZER*PFCCQN (JLON, JLEV, JBLK)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART3')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
    I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
    KNLAB => GET_HOST_DATA_RDWR (YD_KNLAB)
    KNND => GET_HOST_DATA_RDWR (YD_KNND)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PCP => GET_HOST_DATA_RDWR (YD_PCP)
    PDIFCQ => GET_HOST_DATA_RDWR (YD_PDIFCQ)
    PDIFCS => GET_HOST_DATA_RDWR (YD_PDIFCS)
    PFCCQL => GET_HOST_DATA_RDWR (YD_PFCCQL)
    PFCCQN => GET_HOST_DATA_RDWR (YD_PFCCQN)
    PNEBPP => GET_HOST_DATA_RDWR (YD_PNEBPP)
    PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
    PQCPP => GET_HOST_DATA_RDWR (YD_PQCPP)
    PR => GET_HOST_DATA_RDWR (YD_PR)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    ZBETA => GET_HOST_DATA_RDWR (YL_ZBETA)
    ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZCH1TEN)
    ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
    ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
    ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
    ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
    ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
    ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
    ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
    ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
    ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
    ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRHO => GET_HOST_DATA_RDWR (YL_ZRHO)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
    ZTHETA => GET_HOST_DATA_RDWR (YL_ZTHETA)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
    ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
    ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
    ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
    ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
    ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
    ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
    ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => NULL ()
  ICLBASS => NULL ()
  ICLTOP => NULL ()
  ICLTOPS => NULL ()
  I_KCLBAS => NULL ()
  I_KCLTOP => NULL ()
  KNLAB => NULL ()
  KNND => NULL ()
  PAPRSF => NULL ()
  PCP => NULL ()
  PDIFCQ => NULL ()
  PDIFCS => NULL ()
  PFCCQL => NULL ()
  PFCCQN => NULL ()
  PNEBPP => NULL ()
  PPRODTH => NULL ()
  PQCPP => NULL ()
  PR => NULL ()
  PT => NULL ()
  ZBETA => NULL ()
  ZCH1TEN => NULL ()
  ZDPSG => NULL ()
  ZDQIDT => NULL ()
  ZDQLDT => NULL ()
  ZDQVDT => NULL ()
  ZDTDT => NULL ()
  ZDUDT => NULL ()
  ZDVDT => NULL ()
  ZLS => NULL ()
  ZLV => NULL ()
  ZQC => NULL ()
  ZRCTEN => NULL ()
  ZRHO => NULL ()
  ZRITEN => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1TEN => NULL ()
  ZTHETA => NULL ()
  ZTTEN => NULL ()
  ZUMF => NULL ()
  ZUMFMAX => NULL ()
  ZUQL => NULL ()
  ZUQV => NULL ()
  ZURCI => NULL ()
  ZURV => NULL ()
  ZUTEN => NULL ()
  ZVTEN => NULL ()
  ZZUMF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','ACVPPKF_PARALLEL:PART3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
  ICLBASS => GET_HOST_DATA_RDONLY (YL_ICLBASS)
  ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
  ICLTOPS => GET_HOST_DATA_RDONLY (YL_ICLTOPS)
  I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
  I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
  KNLAB => GET_HOST_DATA_RDWR (YD_KNLAB)
  KNND => GET_HOST_DATA_RDWR (YD_KNND)
  PAPRSF => GET_HOST_DATA_RDONLY (YD_PAPRSF)
  PCP => GET_HOST_DATA_RDONLY (YD_PCP)
  PDIFCQ => GET_HOST_DATA_RDWR (YD_PDIFCQ)
  PDIFCS => GET_HOST_DATA_RDWR (YD_PDIFCS)
  PFCCQL => GET_HOST_DATA_RDWR (YD_PFCCQL)
  PFCCQN => GET_HOST_DATA_RDWR (YD_PFCCQN)
  PNEBPP => GET_HOST_DATA_RDWR (YD_PNEBPP)
  PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
  PQCPP => GET_HOST_DATA_RDWR (YD_PQCPP)
  PR => GET_HOST_DATA_RDONLY (YD_PR)
  PT => GET_HOST_DATA_RDONLY (YD_PT)
  ZBETA => GET_HOST_DATA_RDWR (YL_ZBETA)
  ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZCH1TEN)
  ZDPSG => GET_HOST_DATA_RDONLY (YL_ZDPSG)
  ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
  ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
  ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
  ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
  ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
  ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
  ZLS => GET_HOST_DATA_RDONLY (YL_ZLS)
  ZLV => GET_HOST_DATA_RDONLY (YL_ZLV)
  ZQC => GET_HOST_DATA_RDONLY (YL_ZQC)
  ZRCTEN => GET_HOST_DATA_RDONLY (YL_ZRCTEN)
  ZRHO => GET_HOST_DATA_RDWR (YL_ZRHO)
  ZRITEN => GET_HOST_DATA_RDONLY (YL_ZRITEN)
  ZRVTEN => GET_HOST_DATA_RDONLY (YL_ZRVTEN)
  ZSHAL_ZCH1TEN => GET_HOST_DATA_RDONLY (YL_ZSHAL_ZCH1TEN)
  ZTHETA => GET_HOST_DATA_RDWR (YL_ZTHETA)
  ZTTEN => GET_HOST_DATA_RDONLY (YL_ZTTEN)
  ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
  ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
  ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
  ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
  ZURCI => GET_HOST_DATA_RDONLY (YL_ZURCI)
  ZURV => GET_HOST_DATA_RDONLY (YL_ZURV)
  ZUTEN => GET_HOST_DATA_RDONLY (YL_ZUTEN)
  ZVTEN => GET_HOST_DATA_RDONLY (YL_ZVTEN)
  ZZUMF => GET_HOST_DATA_RDONLY (YL_ZZUMF)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JKP, JLEV, JLON, JN, YLCPG_BNDS, ZDQCDT, ZDTLDT, ZTDCP)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      ICLTOP (JLON, JBLK)=MAX (ICLTOP (JLON, JBLK), ICLTOPS (JLON, JBLK))
      ICLBAS (JLON, JBLK)=MAX (ICLBAS (JLON, JBLK), ICLBASS (JLON, JBLK))

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        JKP=YDCPG_OPTS%KFLEVG-JLEV+1
        
        ZDTDT (JLON, JLEV, JBLK)=ZTTEN (JLON, JKP, JBLK)
        ZDQVDT (JLON, JLEV, JBLK)=ZRVTEN (JLON, JKP, JBLK)
        ZDQLDT (JLON, JLEV, JBLK)=ZRCTEN (JLON, JKP, JBLK)
        ZDQIDT (JLON, JLEV, JBLK)=ZRITEN (JLON, JKP, JBLK)
        ZDUDT (JLON, JLEV, JBLK)=ZUTEN (JLON, JKP, JBLK)
        ZDVDT (JLON, JLEV, JBLK)=ZVTEN (JLON, JKP, JBLK)
        ZUMF (JLON, JLEV, JBLK)=ZZUMF (JLON, JKP, JBLK)
        ZUQV (JLON, JLEV, JBLK)=ZURV (JLON, JKP, JBLK)/(1.0+ZURV (JLON, JKP, JBLK))
        ZUQL (JLON, JLEV, JBLK)=ZURCI (JLON, JKP, JBLK)/(1.0+ZURCI (JLON, JKP, JBLK))
      
      ENDDO

      
      JLEV=ICLTOP (JLON, JBLK)
      I_KCLTOP (JLON, JBLK)=YDCPG_OPTS%KFLEVG-JLEV+1
      JLEV=ICLBAS (JLON, JBLK)
      I_KCLBAS (JLON, JBLK)=YDCPG_OPTS%KFLEVG-JLEV+1

      IF (ICLTOP (JLON, JBLK)==1)  THEN
        I_KCLTOP (JLON, JBLK)=1
      ENDIF


      IF (ICLBAS (JLON, JBLK)==1)  THEN
        I_KCLBAS (JLON, JBLK)=1
      ENDIF


      

      IF (LLOCHTRANS) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          JKP=YDCPG_OPTS%KFLEVG-JLEV+1

          DO JN=1, I_KCH1
            
            ZCH1TEN (JLON, JLEV, JN, JBLK)=ZSHAL_ZCH1TEN (JLON, JKP, JN, JBLK)
          
          ENDDO

        ENDDO

      ENDIF

      PPRODTH (JLON,:, JBLK)=0.0_JPRB

      IF (YDML_PHY_MF%YRPHY0%RPRTH>0._JPRB) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZBETA (JLON, JLEV, JBLK)=(YDCST%RATM/PAPRSF (JLON, JLEV, JBLK))**(YDCST%RKAPPA)
          ZTHETA (JLON, JLEV, JBLK)=PT (JLON, JLEV, JBLK)*ZBETA (JLON, JLEV, JBLK)
          ZRHO (JLON, JLEV, JBLK)=PAPRSF (JLON, JLEV, JBLK)/(PR (JLON, JLEV, JBLK)*PT (JLON, JLEV, JBLK))
        
        ENDDO

        
        ZTHETA (JLON, 0, JBLK)=ZTHETA (JLON, 1, JBLK)
        ZRHO (JLON, 0, JBLK)=ZRHO (JLON, 1, JBLK)
        ZTHETA (JLON, YDCPG_OPTS%KFLEVG+1, JBLK)=ZTHETA (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZRHO (JLON, YDCPG_OPTS%KFLEVG+1, JBLK)=ZRHO (JLON, YDCPG_OPTS%KFLEVG, JBLK)

        

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZTDCP=ZVMD*ZDQVDT (JLON, JLEV, JBLK)+ZWMD*ZDQLDT (JLON, JLEV, JBLK)+ZSMD*ZDQIDT (JLON, JLEV, JBLK)
          ZDQCDT=ZDQLDT (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK)
          ZDTLDT=ZBETA (JLON, JLEV, JBLK)*(ZDTDT (JLON, JLEV, JBLK)+ZLV (JLON, JLEV, JBLK)/PCP&
          & (JLON, JLEV, JBLK)*(ZQC (JLON, JLEV, JBLK)*ZTDCP/PCP (JLON, JLEV, JBLK)-ZDQCDT))
          PPRODTH (JLON, JLEV, JBLK)=PPRODTH (JLON, JLEV-1, JBLK)-ZDPSG (JLON, JLEV, JBLK)*ZDTLDT
        
        ENDDO


        DO JLEV=0, YDCPG_OPTS%KFLEVG
          
          PPRODTH (JLON, JLEV, JBLK)=PPRODTH (JLON, JLEV, JBLK)*YDCST%RG*4._JPRB/(ZRHO (JLON, JLEV, JBLK&
          &)+ZRHO (JLON, JLEV+1, JBLK))/(ZTHETA (JLON, JLEV, JBLK)+ZTHETA (JLON, JLEV+1, JBLK))
        
        ENDDO

      ENDIF


      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        KNLAB (JLON, JLEV, JBLK)=1-MAX (0, MIN (1,(I_KCLTOP &
        &(JLON, JBLK)-JLEV)*(I_KCLBAS (JLON, JBLK)-JLEV)))
      ENDDO

      KNND (JLON, JBLK)=MIN (1, I_KCLTOP (JLON, JBLK)-1)

      

      IF (YDML_PHY_MF%YRPHY0%RKFBTAU>0._JPRB) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZDQCDT=MAX (0.0_JPRB, ZDQLDT (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK))
          PQCPP (JLON, JLEV, JBLK)=YDML_PHY_MF%YRPHY0%RKFBTAU*ZDQCDT*FLOAT (KNLAB (JLON, JLEV, JBLK))
          PNEBPP (JLON, JLEV, JBLK)=MAX (ZEPS, MIN (YDML_PHY_MF%YRPHY0%RKFBNBX&
          &, PQCPP (JLON, JLEV, JBLK)/YDML_PHY_MF%YRPHY0%RQLCR))
          ZUMFMAX (JLON, JBLK)=MAX (ZUMFMAX (JLON, JBLK), ZUMF (JLON, JLEV, JBLK))
        
        ENDDO


        IF (.NOT.YDML_PHY_MF%YRCVMNH%LSMOOTH) THEN

          DO JLEV=1, YDCPG_OPTS%KFLEVG
            
            PQCPP (JLON, JLEV, JBLK)=PQCPP (JLON, JLEV, JBLK)*MIN (1.0_JPRB&
            &, ZUMF (JLON, JLEV, JBLK)/ZUMFMAX (JLON, JBLK))
            PNEBPP (JLON, JLEV, JBLK)=MAX (ZEPS, MIN (YDML_PHY_MF%YRPHY0%RKFBNBX&
            &, PQCPP (JLON, JLEV, JBLK)/YDML_PHY_MF%YRPHY0%RQLCR))
          
          ENDDO

        ENDIF

      ENDIF


      IF (.NOT.LLCONDWT) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZDQVDT (JLON, JLEV, JBLK)=ZDQVDT (JLON, JLEV, JBLK)+ZDQLDT&
          & (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK)
          ZDTDT (JLON, JLEV, JBLK)=ZDTDT (JLON, JLEV, JBLK)-(ZLV (JLON, JLEV, JBLK)*ZDQLDT (JLON, JLEV&
          &, JBLK)+ZLS (JLON, JLEV, JBLK)*ZDQIDT (JLON, JLEV, JBLK))/PCP (JLON, JLEV, JBLK)
          ZDQLDT (JLON, JLEV, JBLK)=0.0_JPRB
          ZDQIDT (JLON, JLEV, JBLK)=0.0_JPRB
        
        ENDDO

      ELSE

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          PFCCQL (JLON, JLEV, JBLK)=PFCCQL (JLON, JLEV-1, JBLK)+ZDPSG&
          & (JLON, JLEV, JBLK)*ZDQLDT (JLON, JLEV, JBLK)
          PFCCQN (JLON, JLEV, JBLK)=PFCCQN (JLON, JLEV-1, JBLK)+ZDPSG&
          & (JLON, JLEV, JBLK)*ZDQIDT (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        PDIFCQ (JLON, JLEV, JBLK)=PDIFCQ (JLON, JLEV-1, JBLK)-ZDPSG&
        & (JLON, JLEV, JBLK)*ZDQVDT (JLON, JLEV, JBLK)
        ZTDCP=ZVMD*ZDQVDT (JLON, JLEV, JBLK)+ZWMD*ZDQLDT (JLON, JLEV, JBLK)+ZSMD*ZDQIDT (JLON, JLEV, JBLK)
        PDIFCS (JLON, JLEV, JBLK)=PDIFCS (JLON, JLEV-1, JBLK)-ZDPSG (JLON, JLEV, JBLK)*(ZDTDT (JLON, JLEV&
        &, JBLK)*(PCP (JLON, JLEV, JBLK)+YDML_PHY_MF%YRPHY2%TSPHY*ZTDCP)+PT (JLON, JLEV, JBLK)*ZTDCP)
      
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        PDIFCQ (JLON, JLEV, JBLK)=PDIFCQ (JLON, JLEV, JBLK)-PFCCQL&
        & (JLON, JLEV, JBLK)-PFCCQN (JLON, JLEV, JBLK)
        PDIFCS (JLON, JLEV, JBLK)=PDIFCS (JLON, JLEV, JBLK)+YDCST%RLVZER*PFCCQL&
        & (JLON, JLEV, JBLK)+YDCST%RLSZER*PFCCQN (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART3')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
    I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
    KNLAB => GET_HOST_DATA_RDWR (YD_KNLAB)
    KNND => GET_HOST_DATA_RDWR (YD_KNND)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PCP => GET_HOST_DATA_RDWR (YD_PCP)
    PDIFCQ => GET_HOST_DATA_RDWR (YD_PDIFCQ)
    PDIFCS => GET_HOST_DATA_RDWR (YD_PDIFCS)
    PFCCQL => GET_HOST_DATA_RDWR (YD_PFCCQL)
    PFCCQN => GET_HOST_DATA_RDWR (YD_PFCCQN)
    PNEBPP => GET_HOST_DATA_RDWR (YD_PNEBPP)
    PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
    PQCPP => GET_HOST_DATA_RDWR (YD_PQCPP)
    PR => GET_HOST_DATA_RDWR (YD_PR)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    ZBETA => GET_HOST_DATA_RDWR (YL_ZBETA)
    ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZCH1TEN)
    ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
    ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
    ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
    ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
    ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
    ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
    ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
    ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
    ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
    ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRHO => GET_HOST_DATA_RDWR (YL_ZRHO)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
    ZTHETA => GET_HOST_DATA_RDWR (YL_ZTHETA)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
    ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
    ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
    ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
    ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
    ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
    ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
    ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => NULL ()
  ICLBASS => NULL ()
  ICLTOP => NULL ()
  ICLTOPS => NULL ()
  I_KCLBAS => NULL ()
  I_KCLTOP => NULL ()
  KNLAB => NULL ()
  KNND => NULL ()
  PAPRSF => NULL ()
  PCP => NULL ()
  PDIFCQ => NULL ()
  PDIFCS => NULL ()
  PFCCQL => NULL ()
  PFCCQN => NULL ()
  PNEBPP => NULL ()
  PPRODTH => NULL ()
  PQCPP => NULL ()
  PR => NULL ()
  PT => NULL ()
  ZBETA => NULL ()
  ZCH1TEN => NULL ()
  ZDPSG => NULL ()
  ZDQIDT => NULL ()
  ZDQLDT => NULL ()
  ZDQVDT => NULL ()
  ZDTDT => NULL ()
  ZDUDT => NULL ()
  ZDVDT => NULL ()
  ZLS => NULL ()
  ZLV => NULL ()
  ZQC => NULL ()
  ZRCTEN => NULL ()
  ZRHO => NULL ()
  ZRITEN => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1TEN => NULL ()
  ZTHETA => NULL ()
  ZTTEN => NULL ()
  ZUMF => NULL ()
  ZUMFMAX => NULL ()
  ZUQL => NULL ()
  ZUQV => NULL ()
  ZURCI => NULL ()
  ZURV => NULL ()
  ZUTEN => NULL ()
  ZVTEN => NULL ()
  ZZUMF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','ACVPPKF_PARALLEL:PART3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => GET_DEVICE_DATA_RDWR (YL_ICLBAS)
  ICLBASS => GET_DEVICE_DATA_RDONLY (YL_ICLBASS)
  ICLTOP => GET_DEVICE_DATA_RDWR (YL_ICLTOP)
  ICLTOPS => GET_DEVICE_DATA_RDONLY (YL_ICLTOPS)
  I_KCLBAS => GET_DEVICE_DATA_RDWR (YL_I_KCLBAS)
  I_KCLTOP => GET_DEVICE_DATA_RDWR (YL_I_KCLTOP)
  KNLAB => GET_DEVICE_DATA_RDWR (YD_KNLAB)
  KNND => GET_DEVICE_DATA_RDWR (YD_KNND)
  PAPRSF => GET_DEVICE_DATA_RDONLY (YD_PAPRSF)
  PCP => GET_DEVICE_DATA_RDONLY (YD_PCP)
  PDIFCQ => GET_DEVICE_DATA_RDWR (YD_PDIFCQ)
  PDIFCS => GET_DEVICE_DATA_RDWR (YD_PDIFCS)
  PFCCQL => GET_DEVICE_DATA_RDWR (YD_PFCCQL)
  PFCCQN => GET_DEVICE_DATA_RDWR (YD_PFCCQN)
  PNEBPP => GET_DEVICE_DATA_RDWR (YD_PNEBPP)
  PPRODTH => GET_DEVICE_DATA_RDWR (YD_PPRODTH)
  PQCPP => GET_DEVICE_DATA_RDWR (YD_PQCPP)
  PR => GET_DEVICE_DATA_RDONLY (YD_PR)
  PT => GET_DEVICE_DATA_RDONLY (YD_PT)
  ZBETA => GET_DEVICE_DATA_RDWR (YL_ZBETA)
  ZCH1TEN => GET_DEVICE_DATA_RDWR (YL_ZCH1TEN)
  ZDPSG => GET_DEVICE_DATA_RDONLY (YL_ZDPSG)
  ZDQIDT => GET_DEVICE_DATA_RDWR (YL_ZDQIDT)
  ZDQLDT => GET_DEVICE_DATA_RDWR (YL_ZDQLDT)
  ZDQVDT => GET_DEVICE_DATA_RDWR (YL_ZDQVDT)
  ZDTDT => GET_DEVICE_DATA_RDWR (YL_ZDTDT)
  ZDUDT => GET_DEVICE_DATA_RDWR (YL_ZDUDT)
  ZDVDT => GET_DEVICE_DATA_RDWR (YL_ZDVDT)
  ZLS => GET_DEVICE_DATA_RDONLY (YL_ZLS)
  ZLV => GET_DEVICE_DATA_RDONLY (YL_ZLV)
  ZQC => GET_DEVICE_DATA_RDONLY (YL_ZQC)
  ZRCTEN => GET_DEVICE_DATA_RDONLY (YL_ZRCTEN)
  ZRHO => GET_DEVICE_DATA_RDWR (YL_ZRHO)
  ZRITEN => GET_DEVICE_DATA_RDONLY (YL_ZRITEN)
  ZRVTEN => GET_DEVICE_DATA_RDONLY (YL_ZRVTEN)
  ZSHAL_ZCH1TEN => GET_DEVICE_DATA_RDONLY (YL_ZSHAL_ZCH1TEN)
  ZTHETA => GET_DEVICE_DATA_RDWR (YL_ZTHETA)
  ZTTEN => GET_DEVICE_DATA_RDONLY (YL_ZTTEN)
  ZUMF => GET_DEVICE_DATA_RDWR (YL_ZUMF)
  ZUMFMAX => GET_DEVICE_DATA_RDWR (YL_ZUMFMAX)
  ZUQL => GET_DEVICE_DATA_RDWR (YL_ZUQL)
  ZUQV => GET_DEVICE_DATA_RDWR (YL_ZUQV)
  ZURCI => GET_DEVICE_DATA_RDONLY (YL_ZURCI)
  ZURV => GET_DEVICE_DATA_RDONLY (YL_ZURV)
  ZUTEN => GET_DEVICE_DATA_RDONLY (YL_ZUTEN)
  ZVTEN => GET_DEVICE_DATA_RDONLY (YL_ZVTEN)
  ZZUMF => GET_DEVICE_DATA_RDONLY (YL_ZZUMF)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (ICLBAS, ICLBASS, ICLTOP, ICLTOPS, I_KCLBAS, I_KCLTOP, KNLAB, KNND, &
    !$ACC&         PAPRSF, PCP, PDIFCQ, PDIFCS, PFCCQL, PFCCQN, PNEBPP, PPRODTH, PQCPP, &
    !$ACC&         PR, PT, YDCPG_OPTS, YDCST, YDML_PHY_MF, YFXTRAN_ACDC_STACK, ZBETA, &
    !$ACC&         ZCH1TEN, ZDPSG, ZDQIDT, ZDQLDT, ZDQVDT, ZDTDT, ZDUDT, ZDVDT, ZLS, ZLV, &
    !$ACC&         ZQC, ZRCTEN, ZRHO, ZRITEN, ZRVTEN, ZSHAL_ZCH1TEN, ZTHETA, ZTTEN, ZUMF, &
    !$ACC&         ZUMFMAX, ZUQL, ZUQV, ZURCI, ZURV, ZUTEN, ZVTEN, ZZUMF) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JKP, JLEV, JLON, JN, YLCPG_BNDS, ZDQCDT, ZDTLDT, ZTDCP) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      
      ICLTOP (JLON, JBLK)=MAX (ICLTOP (JLON, JBLK), ICLTOPS (JLON, JBLK))
      ICLBAS (JLON, JBLK)=MAX (ICLBAS (JLON, JBLK), ICLBASS (JLON, JBLK))

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        JKP=YDCPG_OPTS%KFLEVG-JLEV+1
        
        ZDTDT (JLON, JLEV, JBLK)=ZTTEN (JLON, JKP, JBLK)
        ZDQVDT (JLON, JLEV, JBLK)=ZRVTEN (JLON, JKP, JBLK)
        ZDQLDT (JLON, JLEV, JBLK)=ZRCTEN (JLON, JKP, JBLK)
        ZDQIDT (JLON, JLEV, JBLK)=ZRITEN (JLON, JKP, JBLK)
        ZDUDT (JLON, JLEV, JBLK)=ZUTEN (JLON, JKP, JBLK)
        ZDVDT (JLON, JLEV, JBLK)=ZVTEN (JLON, JKP, JBLK)
        ZUMF (JLON, JLEV, JBLK)=ZZUMF (JLON, JKP, JBLK)
        ZUQV (JLON, JLEV, JBLK)=ZURV (JLON, JKP, JBLK)/(1.0+ZURV (JLON, JKP, JBLK))
        ZUQL (JLON, JLEV, JBLK)=ZURCI (JLON, JKP, JBLK)/(1.0+ZURCI (JLON, JKP, JBLK))
      
      ENDDO

      
      JLEV=ICLTOP (JLON, JBLK)
      I_KCLTOP (JLON, JBLK)=YDCPG_OPTS%KFLEVG-JLEV+1
      JLEV=ICLBAS (JLON, JBLK)
      I_KCLBAS (JLON, JBLK)=YDCPG_OPTS%KFLEVG-JLEV+1

      IF (ICLTOP (JLON, JBLK)==1)  THEN
        I_KCLTOP (JLON, JBLK)=1
      ENDIF


      IF (ICLBAS (JLON, JBLK)==1)  THEN
        I_KCLBAS (JLON, JBLK)=1
      ENDIF


      

      IF (LLOCHTRANS) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          JKP=YDCPG_OPTS%KFLEVG-JLEV+1

          DO JN=1, I_KCH1
            
            ZCH1TEN (JLON, JLEV, JN, JBLK)=ZSHAL_ZCH1TEN (JLON, JKP, JN, JBLK)
          
          ENDDO

        ENDDO

      ENDIF

      PPRODTH (JLON,:, JBLK)=0.0_JPRB

      IF (YDML_PHY_MF%YRPHY0%RPRTH>0._JPRB) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZBETA (JLON, JLEV, JBLK)=(YDCST%RATM/PAPRSF (JLON, JLEV, JBLK))**(YDCST%RKAPPA)
          ZTHETA (JLON, JLEV, JBLK)=PT (JLON, JLEV, JBLK)*ZBETA (JLON, JLEV, JBLK)
          ZRHO (JLON, JLEV, JBLK)=PAPRSF (JLON, JLEV, JBLK)/(PR (JLON, JLEV, JBLK)*PT (JLON, JLEV, JBLK))
        
        ENDDO

        
        ZTHETA (JLON, 0, JBLK)=ZTHETA (JLON, 1, JBLK)
        ZRHO (JLON, 0, JBLK)=ZRHO (JLON, 1, JBLK)
        ZTHETA (JLON, YDCPG_OPTS%KFLEVG+1, JBLK)=ZTHETA (JLON, YDCPG_OPTS%KFLEVG, JBLK)
        ZRHO (JLON, YDCPG_OPTS%KFLEVG+1, JBLK)=ZRHO (JLON, YDCPG_OPTS%KFLEVG, JBLK)

        

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZTDCP=ZVMD*ZDQVDT (JLON, JLEV, JBLK)+ZWMD*ZDQLDT (JLON, JLEV, JBLK)+ZSMD*ZDQIDT (JLON, JLEV, JBLK)
          ZDQCDT=ZDQLDT (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK)
          ZDTLDT=ZBETA (JLON, JLEV, JBLK)*(ZDTDT (JLON, JLEV, JBLK)+ZLV (JLON, JLEV, JBLK)/PCP&
          & (JLON, JLEV, JBLK)*(ZQC (JLON, JLEV, JBLK)*ZTDCP/PCP (JLON, JLEV, JBLK)-ZDQCDT))
          PPRODTH (JLON, JLEV, JBLK)=PPRODTH (JLON, JLEV-1, JBLK)-ZDPSG (JLON, JLEV, JBLK)*ZDTLDT
        
        ENDDO


        DO JLEV=0, YDCPG_OPTS%KFLEVG
          
          PPRODTH (JLON, JLEV, JBLK)=PPRODTH (JLON, JLEV, JBLK)*YDCST%RG*4._JPRB/(ZRHO (JLON, JLEV, JBLK&
          &)+ZRHO (JLON, JLEV+1, JBLK))/(ZTHETA (JLON, JLEV, JBLK)+ZTHETA (JLON, JLEV+1, JBLK))
        
        ENDDO

      ENDIF


      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        KNLAB (JLON, JLEV, JBLK)=1-MAX (0, MIN (1,(I_KCLTOP &
        &(JLON, JBLK)-JLEV)*(I_KCLBAS (JLON, JBLK)-JLEV)))
      ENDDO

      KNND (JLON, JBLK)=MIN (1, I_KCLTOP (JLON, JBLK)-1)

      

      IF (YDML_PHY_MF%YRPHY0%RKFBTAU>0._JPRB) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZDQCDT=MAX (0.0_JPRB, ZDQLDT (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK))
          PQCPP (JLON, JLEV, JBLK)=YDML_PHY_MF%YRPHY0%RKFBTAU*ZDQCDT*FLOAT (KNLAB (JLON, JLEV, JBLK))
          PNEBPP (JLON, JLEV, JBLK)=MAX (ZEPS, MIN (YDML_PHY_MF%YRPHY0%RKFBNBX&
          &, PQCPP (JLON, JLEV, JBLK)/YDML_PHY_MF%YRPHY0%RQLCR))
          ZUMFMAX (JLON, JBLK)=MAX (ZUMFMAX (JLON, JBLK), ZUMF (JLON, JLEV, JBLK))
        
        ENDDO


        IF (.NOT.YDML_PHY_MF%YRCVMNH%LSMOOTH) THEN

          DO JLEV=1, YDCPG_OPTS%KFLEVG
            
            PQCPP (JLON, JLEV, JBLK)=PQCPP (JLON, JLEV, JBLK)*MIN (1.0_JPRB&
            &, ZUMF (JLON, JLEV, JBLK)/ZUMFMAX (JLON, JBLK))
            PNEBPP (JLON, JLEV, JBLK)=MAX (ZEPS, MIN (YDML_PHY_MF%YRPHY0%RKFBNBX&
            &, PQCPP (JLON, JLEV, JBLK)/YDML_PHY_MF%YRPHY0%RQLCR))
          
          ENDDO

        ENDIF

      ENDIF


      IF (.NOT.LLCONDWT) THEN

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          ZDQVDT (JLON, JLEV, JBLK)=ZDQVDT (JLON, JLEV, JBLK)+ZDQLDT&
          & (JLON, JLEV, JBLK)+ZDQIDT (JLON, JLEV, JBLK)
          ZDTDT (JLON, JLEV, JBLK)=ZDTDT (JLON, JLEV, JBLK)-(ZLV (JLON, JLEV, JBLK)*ZDQLDT (JLON, JLEV&
          &, JBLK)+ZLS (JLON, JLEV, JBLK)*ZDQIDT (JLON, JLEV, JBLK))/PCP (JLON, JLEV, JBLK)
          ZDQLDT (JLON, JLEV, JBLK)=0.0_JPRB
          ZDQIDT (JLON, JLEV, JBLK)=0.0_JPRB
        
        ENDDO

      ELSE

        DO JLEV=1, YDCPG_OPTS%KFLEVG
          
          PFCCQL (JLON, JLEV, JBLK)=PFCCQL (JLON, JLEV-1, JBLK)+ZDPSG&
          & (JLON, JLEV, JBLK)*ZDQLDT (JLON, JLEV, JBLK)
          PFCCQN (JLON, JLEV, JBLK)=PFCCQN (JLON, JLEV-1, JBLK)+ZDPSG&
          & (JLON, JLEV, JBLK)*ZDQIDT (JLON, JLEV, JBLK)
        
        ENDDO

      ENDIF


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        PDIFCQ (JLON, JLEV, JBLK)=PDIFCQ (JLON, JLEV-1, JBLK)-ZDPSG&
        & (JLON, JLEV, JBLK)*ZDQVDT (JLON, JLEV, JBLK)
        ZTDCP=ZVMD*ZDQVDT (JLON, JLEV, JBLK)+ZWMD*ZDQLDT (JLON, JLEV, JBLK)+ZSMD*ZDQIDT (JLON, JLEV, JBLK)
        PDIFCS (JLON, JLEV, JBLK)=PDIFCS (JLON, JLEV-1, JBLK)-ZDPSG (JLON, JLEV, JBLK)*(ZDTDT (JLON, JLEV&
        &, JBLK)*(PCP (JLON, JLEV, JBLK)+YDML_PHY_MF%YRPHY2%TSPHY*ZTDCP)+PT (JLON, JLEV, JBLK)*ZTDCP)
      
      ENDDO


      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        PDIFCQ (JLON, JLEV, JBLK)=PDIFCQ (JLON, JLEV, JBLK)-PFCCQL&
        & (JLON, JLEV, JBLK)-PFCCQN (JLON, JLEV, JBLK)
        PDIFCS (JLON, JLEV, JBLK)=PDIFCS (JLON, JLEV, JBLK)+YDCST%RLVZER*PFCCQL&
        & (JLON, JLEV, JBLK)+YDCST%RLSZER*PFCCQN (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('ACVPPKF_PARALLEL:PART3')) THEN
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ICLBAS => GET_HOST_DATA_RDWR (YL_ICLBAS)
    ICLBASS => GET_HOST_DATA_RDWR (YL_ICLBASS)
    ICLTOP => GET_HOST_DATA_RDWR (YL_ICLTOP)
    ICLTOPS => GET_HOST_DATA_RDWR (YL_ICLTOPS)
    I_KCLBAS => GET_HOST_DATA_RDWR (YL_I_KCLBAS)
    I_KCLTOP => GET_HOST_DATA_RDWR (YL_I_KCLTOP)
    KNLAB => GET_HOST_DATA_RDWR (YD_KNLAB)
    KNND => GET_HOST_DATA_RDWR (YD_KNND)
    PAPRSF => GET_HOST_DATA_RDWR (YD_PAPRSF)
    PCP => GET_HOST_DATA_RDWR (YD_PCP)
    PDIFCQ => GET_HOST_DATA_RDWR (YD_PDIFCQ)
    PDIFCS => GET_HOST_DATA_RDWR (YD_PDIFCS)
    PFCCQL => GET_HOST_DATA_RDWR (YD_PFCCQL)
    PFCCQN => GET_HOST_DATA_RDWR (YD_PFCCQN)
    PNEBPP => GET_HOST_DATA_RDWR (YD_PNEBPP)
    PPRODTH => GET_HOST_DATA_RDWR (YD_PPRODTH)
    PQCPP => GET_HOST_DATA_RDWR (YD_PQCPP)
    PR => GET_HOST_DATA_RDWR (YD_PR)
    PT => GET_HOST_DATA_RDWR (YD_PT)
    ZBETA => GET_HOST_DATA_RDWR (YL_ZBETA)
    ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZCH1TEN)
    ZDPSG => GET_HOST_DATA_RDWR (YL_ZDPSG)
    ZDQIDT => GET_HOST_DATA_RDWR (YL_ZDQIDT)
    ZDQLDT => GET_HOST_DATA_RDWR (YL_ZDQLDT)
    ZDQVDT => GET_HOST_DATA_RDWR (YL_ZDQVDT)
    ZDTDT => GET_HOST_DATA_RDWR (YL_ZDTDT)
    ZDUDT => GET_HOST_DATA_RDWR (YL_ZDUDT)
    ZDVDT => GET_HOST_DATA_RDWR (YL_ZDVDT)
    ZLS => GET_HOST_DATA_RDWR (YL_ZLS)
    ZLV => GET_HOST_DATA_RDWR (YL_ZLV)
    ZQC => GET_HOST_DATA_RDWR (YL_ZQC)
    ZRCTEN => GET_HOST_DATA_RDWR (YL_ZRCTEN)
    ZRHO => GET_HOST_DATA_RDWR (YL_ZRHO)
    ZRITEN => GET_HOST_DATA_RDWR (YL_ZRITEN)
    ZRVTEN => GET_HOST_DATA_RDWR (YL_ZRVTEN)
    ZSHAL_ZCH1TEN => GET_HOST_DATA_RDWR (YL_ZSHAL_ZCH1TEN)
    ZTHETA => GET_HOST_DATA_RDWR (YL_ZTHETA)
    ZTTEN => GET_HOST_DATA_RDWR (YL_ZTTEN)
    ZUMF => GET_HOST_DATA_RDWR (YL_ZUMF)
    ZUMFMAX => GET_HOST_DATA_RDWR (YL_ZUMFMAX)
    ZUQL => GET_HOST_DATA_RDWR (YL_ZUQL)
    ZUQV => GET_HOST_DATA_RDWR (YL_ZUQV)
    ZURCI => GET_HOST_DATA_RDWR (YL_ZURCI)
    ZURV => GET_HOST_DATA_RDWR (YL_ZURV)
    ZUTEN => GET_HOST_DATA_RDWR (YL_ZUTEN)
    ZVTEN => GET_HOST_DATA_RDWR (YL_ZVTEN)
    ZZUMF => GET_HOST_DATA_RDWR (YL_ZZUMF)
    IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ICLBAS => NULL ()
  ICLBASS => NULL ()
  ICLTOP => NULL ()
  ICLTOPS => NULL ()
  I_KCLBAS => NULL ()
  I_KCLTOP => NULL ()
  KNLAB => NULL ()
  KNND => NULL ()
  PAPRSF => NULL ()
  PCP => NULL ()
  PDIFCQ => NULL ()
  PDIFCS => NULL ()
  PFCCQL => NULL ()
  PFCCQN => NULL ()
  PNEBPP => NULL ()
  PPRODTH => NULL ()
  PQCPP => NULL ()
  PR => NULL ()
  PT => NULL ()
  ZBETA => NULL ()
  ZCH1TEN => NULL ()
  ZDPSG => NULL ()
  ZDQIDT => NULL ()
  ZDQLDT => NULL ()
  ZDQVDT => NULL ()
  ZDTDT => NULL ()
  ZDUDT => NULL ()
  ZDVDT => NULL ()
  ZLS => NULL ()
  ZLV => NULL ()
  ZQC => NULL ()
  ZRCTEN => NULL ()
  ZRHO => NULL ()
  ZRITEN => NULL ()
  ZRVTEN => NULL ()
  ZSHAL_ZCH1TEN => NULL ()
  ZTHETA => NULL ()
  ZTTEN => NULL ()
  ZUMF => NULL ()
  ZUMFMAX => NULL ()
  ZUQL => NULL ()
  ZUQV => NULL ()
  ZURCI => NULL ()
  ZURV => NULL ()
  ZUTEN => NULL ()
  ZVTEN => NULL ()
  ZZUMF => NULL ()
  IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('ACVPPKF_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL:PART3',1,ZHOOK_HANDLE_PARALLEL)



CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ICLBAS)) CALL FIELD_DELETE (YL_ICLBAS)
IF (ASSOCIATED (YL_ICLBASS)) CALL FIELD_DELETE (YL_ICLBASS)
IF (ASSOCIATED (YL_ICLTOP)) CALL FIELD_DELETE (YL_ICLTOP)
IF (ASSOCIATED (YL_ICLTOPS)) CALL FIELD_DELETE (YL_ICLTOPS)
IF (ASSOCIATED (YL_ISDPL)) CALL FIELD_DELETE (YL_ISDPL)
IF (ASSOCIATED (YL_ISLCL)) CALL FIELD_DELETE (YL_ISLCL)
IF (ASSOCIATED (YL_ISPBL)) CALL FIELD_DELETE (YL_ISPBL)
IF (ASSOCIATED (YL_I_KCLBAS)) CALL FIELD_DELETE (YL_I_KCLBAS)
IF (ASSOCIATED (YL_I_KCLTOP)) CALL FIELD_DELETE (YL_I_KCLTOP)
IF (ASSOCIATED (YL_I_KCOUNT)) CALL FIELD_DELETE (YL_I_KCOUNT)
IF (ASSOCIATED (YL_LLTRIG1)) CALL FIELD_DELETE (YL_LLTRIG1)
IF (ASSOCIATED (YL_ZAPHIF)) CALL FIELD_DELETE (YL_ZAPHIF)
IF (ASSOCIATED (YL_ZBETA)) CALL FIELD_DELETE (YL_ZBETA)
IF (ASSOCIATED (YL_ZCAPE)) CALL FIELD_DELETE (YL_ZCAPE)
IF (ASSOCIATED (YL_ZCH1)) CALL FIELD_DELETE (YL_ZCH1)
IF (ASSOCIATED (YL_ZCH1TEN)) CALL FIELD_DELETE (YL_ZCH1TEN)
IF (ASSOCIATED (YL_ZDPSG)) CALL FIELD_DELETE (YL_ZDPSG)
IF (ASSOCIATED (YL_ZDQIDT)) CALL FIELD_DELETE (YL_ZDQIDT)
IF (ASSOCIATED (YL_ZDQLDT)) CALL FIELD_DELETE (YL_ZDQLDT)
IF (ASSOCIATED (YL_ZDQVDT)) CALL FIELD_DELETE (YL_ZDQVDT)
IF (ASSOCIATED (YL_ZDTDT)) CALL FIELD_DELETE (YL_ZDTDT)
IF (ASSOCIATED (YL_ZDUDT)) CALL FIELD_DELETE (YL_ZDUDT)
IF (ASSOCIATED (YL_ZDVDT)) CALL FIELD_DELETE (YL_ZDVDT)
IF (ASSOCIATED (YL_ZLS)) CALL FIELD_DELETE (YL_ZLS)
IF (ASSOCIATED (YL_ZLV)) CALL FIELD_DELETE (YL_ZLV)
IF (ASSOCIATED (YL_ZPABS)) CALL FIELD_DELETE (YL_ZPABS)
IF (ASSOCIATED (YL_ZQC)) CALL FIELD_DELETE (YL_ZQC)
IF (ASSOCIATED (YL_ZRC)) CALL FIELD_DELETE (YL_ZRC)
IF (ASSOCIATED (YL_ZRCTEN)) CALL FIELD_DELETE (YL_ZRCTEN)
IF (ASSOCIATED (YL_ZRHO)) CALL FIELD_DELETE (YL_ZRHO)
IF (ASSOCIATED (YL_ZRI)) CALL FIELD_DELETE (YL_ZRI)
IF (ASSOCIATED (YL_ZRITEN)) CALL FIELD_DELETE (YL_ZRITEN)
IF (ASSOCIATED (YL_ZRV)) CALL FIELD_DELETE (YL_ZRV)
IF (ASSOCIATED (YL_ZRVTEN)) CALL FIELD_DELETE (YL_ZRVTEN)
IF (ASSOCIATED (YL_ZSHAL_ZCH1)) CALL FIELD_DELETE (YL_ZSHAL_ZCH1)
IF (ASSOCIATED (YL_ZSHAL_ZCH1TEN)) CALL FIELD_DELETE (YL_ZSHAL_ZCH1TEN)
IF (ASSOCIATED (YL_ZSHAL_ZCH1TENS)) CALL FIELD_DELETE (YL_ZSHAL_ZCH1TENS)
IF (ASSOCIATED (YL_ZSRVLCL)) CALL FIELD_DELETE (YL_ZSRVLCL)
IF (ASSOCIATED (YL_ZSTHES)) CALL FIELD_DELETE (YL_ZSTHES)
IF (ASSOCIATED (YL_ZSTHLCL)) CALL FIELD_DELETE (YL_ZSTHLCL)
IF (ASSOCIATED (YL_ZSTHV)) CALL FIELD_DELETE (YL_ZSTHV)
IF (ASSOCIATED (YL_ZSTHVELCL)) CALL FIELD_DELETE (YL_ZSTHVELCL)
IF (ASSOCIATED (YL_ZSTLCL)) CALL FIELD_DELETE (YL_ZSTLCL)
IF (ASSOCIATED (YL_ZSWLCL)) CALL FIELD_DELETE (YL_ZSWLCL)
IF (ASSOCIATED (YL_ZSZLCL)) CALL FIELD_DELETE (YL_ZSZLCL)
IF (ASSOCIATED (YL_ZT)) CALL FIELD_DELETE (YL_ZT)
IF (ASSOCIATED (YL_ZTHETA)) CALL FIELD_DELETE (YL_ZTHETA)
IF (ASSOCIATED (YL_ZTHT)) CALL FIELD_DELETE (YL_ZTHT)
IF (ASSOCIATED (YL_ZTKECLS)) CALL FIELD_DELETE (YL_ZTKECLS)
IF (ASSOCIATED (YL_ZTTEN)) CALL FIELD_DELETE (YL_ZTTEN)
IF (ASSOCIATED (YL_ZU)) CALL FIELD_DELETE (YL_ZU)
IF (ASSOCIATED (YL_ZUMF)) CALL FIELD_DELETE (YL_ZUMF)
IF (ASSOCIATED (YL_ZUMFMAX)) CALL FIELD_DELETE (YL_ZUMFMAX)
IF (ASSOCIATED (YL_ZUQL)) CALL FIELD_DELETE (YL_ZUQL)
IF (ASSOCIATED (YL_ZUQV)) CALL FIELD_DELETE (YL_ZUQV)
IF (ASSOCIATED (YL_ZURCI)) CALL FIELD_DELETE (YL_ZURCI)
IF (ASSOCIATED (YL_ZURV)) CALL FIELD_DELETE (YL_ZURV)
IF (ASSOCIATED (YL_ZUTEN)) CALL FIELD_DELETE (YL_ZUTEN)
IF (ASSOCIATED (YL_ZV)) CALL FIELD_DELETE (YL_ZV)
IF (ASSOCIATED (YL_ZVTEN)) CALL FIELD_DELETE (YL_ZVTEN)
IF (ASSOCIATED (YL_ZW)) CALL FIELD_DELETE (YL_ZW)
IF (ASSOCIATED (YL_ZZUMF)) CALL FIELD_DELETE (YL_ZZUMF)
IF (ASSOCIATED (YL_ZZW)) CALL FIELD_DELETE (YL_ZZW)
IF (ASSOCIATED (YL_ZZZ)) CALL FIELD_DELETE (YL_ZZZ)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('ACVPPKF_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE ACVPPKF_PARALLEL
