SUBROUTINE LASCAW_CLATURB_OPENACC (YDSL, KFLEV, KPROMA, KST&
&, KEND, KILA, PKHTURB, P3DTW, PCLA, PCLASLD, YDSTACK)
!$ACC ROUTINE (LASCAW_CLATURB_OPENACC) SEQ
USE PARKIND1,ONLY:JPIB, JPIM, JPRB

USE EINT_MOD,ONLY:SL_STRUCT
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (SL_STRUCT), INTENT (IN)::YDSL
INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
INTEGER (KIND=JPIM), INTENT (IN)::KILA (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PKHTURB (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::P3DTW (3, 3, YDSL%NDGSAH:YDSL%NDGENH)
REAL (KIND=JPRB), INTENT (INOUT)::PCLA (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (INOUT)::PCLASLD (KPROMA, KFLEV, 3)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIB)::ILA64
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPRB)::ZWDS3
REAL (KIND=JPRB)::ZWDS2
REAL (KIND=JPRB)::ZWDS1
REAL (KIND=JPRB)::ZKH


JROF = KST



DO JLEV=1, KFLEV
  
  ILA64=KILA (JROF, JLEV)+1
  ZWDS1=P3DTW (1, 1, ILA64)*PCLA (JROF, JLEV, 1)+P3DTW (1, 2, ILA64)&
  &*PCLA (JROF, JLEV, 2)+P3DTW (1, 3, ILA64)*PCLA (JROF, JLEV, 3)
  ZWDS2=P3DTW (2, 1, ILA64)*PCLA (JROF, JLEV, 1)+P3DTW (2, 2, ILA64)&
  &*PCLA (JROF, JLEV, 2)+P3DTW (2, 3, ILA64)*PCLA (JROF, JLEV, 3)
  ZWDS3=P3DTW (3, 1, ILA64)*PCLA (JROF, JLEV, 1)+P3DTW (3, 2, ILA64)&
  &*PCLA (JROF, JLEV, 2)+P3DTW (3, 3, ILA64)*PCLA (JROF, JLEV, 3)
  ZKH=2._JPRB*PKHTURB (JROF, JLEV)
  PCLA (JROF, JLEV, 1)=PCLA (JROF, JLEV, 1)+ZKH*(ZWDS1-PCLA (JROF, JLEV, 1))
  PCLA (JROF, JLEV, 2)=PCLA (JROF, JLEV, 2)+ZKH*(ZWDS2-PCLA (JROF, JLEV, 2))
  PCLA (JROF, JLEV, 3)=PCLA (JROF, JLEV, 3)+ZKH*(ZWDS3-PCLA (JROF, JLEV, 3))
  ZWDS1=P3DTW (1, 1, ILA64)*PCLASLD (JROF, JLEV, 1)+P3DTW (1, 2, ILA64)*PCLASLD&
  & (JROF, JLEV, 2)+P3DTW (1, 3, ILA64)*PCLASLD (JROF, JLEV, 3)
  ZWDS2=P3DTW (2, 1, ILA64)*PCLASLD (JROF, JLEV, 1)+P3DTW (2, 2, ILA64)*PCLASLD&
  & (JROF, JLEV, 2)+P3DTW (2, 3, ILA64)*PCLASLD (JROF, JLEV, 3)
  ZWDS3=P3DTW (3, 1, ILA64)*PCLASLD (JROF, JLEV, 1)+P3DTW (3, 2, ILA64)*PCLASLD&
  & (JROF, JLEV, 2)+P3DTW (3, 3, ILA64)*PCLASLD (JROF, JLEV, 3)
  PCLASLD (JROF, JLEV, 1)=PCLASLD (JROF, JLEV, 1)+ZKH*(ZWDS1-PCLASLD (JROF, JLEV, 1))
  PCLASLD (JROF, JLEV, 2)=PCLASLD (JROF, JLEV, 2)+ZKH*(ZWDS2-PCLASLD (JROF, JLEV, 2))
  PCLASLD (JROF, JLEV, 3)=PCLASLD (JROF, JLEV, 3)+ZKH*(ZWDS3-PCLASLD (JROF, JLEV, 3))
  
ENDDO


END SUBROUTINE LASCAW_CLATURB_OPENACC
