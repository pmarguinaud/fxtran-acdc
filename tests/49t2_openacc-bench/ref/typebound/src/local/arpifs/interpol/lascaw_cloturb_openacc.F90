SUBROUTINE LASCAW_CLOTURB_OPENACC (KFLEV, KPROMA, KST, KEND, PKHTURB, PCLO, PCLOSLD, YDSTACK)
!$ACC ROUTINE (LASCAW_CLOTURB_OPENACC) SEQ
USE PARKIND1,ONLY:JPIB, JPIM, JPRB

#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PKHTURB (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (INOUT)::PCLO (KPROMA, KFLEV, 3)
REAL (KIND=JPRB), INTENT (INOUT)::PCLOSLD (KPROMA, KFLEV, 3)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
REAL (KIND=JPRB)::ZWDS1
REAL (KIND=JPRB)::ZKH


JROF = KST



DO JLEV=1, KFLEV
  
  ZKH=1._JPRB-2._JPRB*PKHTURB (JROF, JLEV)
  PCLO (JROF, JLEV, 3)=PKHTURB (JROF, JLEV)*PCLO (JROF, JLEV, 2)+PCLO (JROF, JLEV, 3)
  ZWDS1=ZKH*PCLO (JROF, JLEV, 1)+PKHTURB (JROF, JLEV)*PCLO (JROF, JLEV, 2)
  PCLO (JROF, JLEV, 2)=ZKH*PCLO (JROF, JLEV, 2)+PKHTURB (JROF, JLEV)*PCLO (JROF, JLEV, 1)
  PCLO (JROF, JLEV, 1)=ZWDS1
  PCLOSLD (JROF, JLEV, 3)=PKHTURB (JROF, JLEV)*PCLOSLD (JROF, JLEV, 2)+PCLOSLD (JROF, JLEV, 3)
  ZWDS1=ZKH*PCLOSLD (JROF, JLEV, 1)+PKHTURB (JROF, JLEV)*PCLOSLD (JROF, JLEV, 2)
  PCLOSLD (JROF, JLEV, 2)=ZKH*PCLOSLD (JROF, JLEV, 2)+PKHTURB (JROF, JLEV)*PCLOSLD (JROF, JLEV, 1)
  PCLOSLD (JROF, JLEV, 1)=ZWDS1
  
ENDDO


END SUBROUTINE LASCAW_CLOTURB_OPENACC
