MODULE UTIL_TERAD_MOD

USE YOERAD, ONLY : TERAD

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TERAD
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TERAD
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TERAD
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TERAD
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TERAD
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TERAD
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TERAD
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TERAD (SELF, KLUN)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
WRITE (KLUN) SELF%NAER
WRITE (KLUN) SELF%NMODE
WRITE (KLUN) SELF%NOZOCL
WRITE (KLUN) SELF%NRADFR
WRITE (KLUN) SELF%NRADPFR
WRITE (KLUN) SELF%NRADPLA
WRITE (KLUN) SELF%NRADINT
WRITE (KLUN) SELF%NRADRES
WRITE (KLUN) SELF%NRADNFR
WRITE (KLUN) SELF%NRADSFR
WRITE (KLUN) SELF%NRADE1H
WRITE (KLUN) SELF%NRADE3H
WRITE (KLUN) SELF%NRADELG
WRITE (KLUN) SELF%NOVLP
WRITE (KLUN) SELF%NRPROMA
WRITE (KLUN) SELF%NLW
WRITE (KLUN) SELF%NSWNL
WRITE (KLUN) SELF%NSWTL
WRITE (KLUN) SELF%NTLW
WRITE (KLUN) SELF%NTSW
WRITE (KLUN) SELF%NUV
WRITE (KLUN) SELF%NCSRADF
WRITE (KLUN) SELF%NINHOM
WRITE (KLUN) SELF%NLAYINH
WRITE (KLUN) SELF%NLNGR1H
WRITE (KLUN) SELF%NPERTAER
WRITE (KLUN) SELF%NPERTOZ
WRITE (KLUN) SELF%NSCEN
WRITE (KLUN) SELF%NHINCSOL
WRITE (KLUN) SELF%NMCICA
WRITE (KLUN) SELF%NGHGRAD
WRITE (KLUN) SELF%NVOLCVERT
WRITE (KLUN) SELF%NREDGLW
WRITE (KLUN) SELF%NREDGSW
WRITE (KLUN) SELF%NSPMAPL
WRITE (KLUN) SELF%NSPMAPS
WRITE (KLUN) SELF%NSW
WRITE (KLUN) SELF%NLWEMISS
WRITE (KLUN) SELF%NICEOPT
WRITE (KLUN) SELF%NLIQOPT
WRITE (KLUN) SELF%NRADIP
WRITE (KLUN) SELF%NRADLP
WRITE (KLUN) SELF%NLWOUT
WRITE (KLUN) SELF%NDECOLAT
WRITE (KLUN) SELF%NMINICE
WRITE (KLUN) SELF%NAERMACC
WRITE (KLUN) SELF%NMCVAR
WRITE (KLUN) SELF%NLWSCATTERING
WRITE (KLUN) SELF%NSWSOLVER
WRITE (KLUN) SELF%NLWSOLVER
WRITE (KLUN) SELF%NSOLARSPECTRUM
WRITE (KLUN) SELF%NDUMPBADINPUTS
WRITE (KLUN) SELF%NDUMPINPUTS
WRITE (KLUN) SELF%NCLOUDOVERLAP
WRITE (KLUN) SELF%RCLOUD_FRAC_STD
WRITE (KLUN) SELF%RCLOUD_SEPARATION_SCALE_TOA
WRITE (KLUN) SELF%RCLOUD_SEPARATION_SCALE_SURF
WRITE (KLUN) SELF%LFU_LW_ICE_OPTICS_BUG
WRITE (KLUN) SELF%LDIAGFORCING
WRITE (KLUN) SELF%LAPPROXLWUPDATE
WRITE (KLUN) SELF%LAPPROXSWUPDATE
WRITE (KLUN) SELF%NSWICEOPT
WRITE (KLUN) SELF%NSWLIQOPT
WRITE (KLUN) SELF%NLWICEOPT
WRITE (KLUN) SELF%NLWLIQOPT
WRITE (KLUN) SELF%LCCNL
WRITE (KLUN) SELF%LCCNO
WRITE (KLUN) SELF%RCCNLND
WRITE (KLUN) SELF%RCCNSEA
WRITE (KLUN) SELF%RRE2DE
WRITE (KLUN) SELF%RMINICE
WRITE (KLUN) SELF%NMCLAT
WRITE (KLUN) SELF%NMCLON
WRITE (KLUN) SELF%NMCLEV
WRITE (KLUN) SELF%NSWGASOPTICS
WRITE (KLUN) SELF%NLWGASOPTICS
WRITE (KLUN) SELF%NGASOPTICSSCHEME
WRITE (KLUN) SELF%KMODTS
WRITE (KLUN) SELF%NSWWVCONTINUUM
WRITE (KLUN) SELF%NRTCALL
WRITE (KLUN) SELF%IRTCALLREF
WRITE (KLUN) SELF%IRTCALLCLN
WRITE (KLUN) SELF%LINTERPINCLOUDMEAN
WRITE (KLUN) SELF%LERAD1H
WRITE (KLUN) SELF%LEPO3RA
WRITE (KLUN) SELF%LONEWSW
WRITE (KLUN) SELF%LECSRAD
WRITE (KLUN) SELF%LRRTM
WRITE (KLUN) SELF%LSRTM
WRITE (KLUN) SELF%LDIFFC
WRITE (KLUN) SELF%LHVOLCA
WRITE (KLUN) SELF%LNEWAER
WRITE (KLUN) SELF%LNOTROAER
WRITE (KLUN) SELF%LRAYL
WRITE (KLUN) SELF%LOPTRPROMA
WRITE (KLUN) SELF%LECO2VAR
WRITE (KLUN) SELF%LHGHG
WRITE (KLUN) SELF%LESO4HIS
WRITE (KLUN) SELF%LETRACGMS
WRITE (KLUN) SELF%LAERCLIM
WRITE (KLUN) SELF%LAERVISI
WRITE (KLUN) SELF%LAER3D
WRITE (KLUN) SELF%LVOLCSPEC
WRITE (KLUN) SELF%LVOLCDAMP
WRITE (KLUN) SELF%LAERADCLI
WRITE (KLUN) SELF%LAERADJDU
WRITE (KLUN) SELF%LMANNERSSWUPDATE
WRITE (KLUN) SELF%LCENTREDTIMESZA
WRITE (KLUN) SELF%LAVERAGESZA
WRITE (KLUN) SELF%LECOMPGRID
WRITE (KLUN) SELF%LUSEPRE2017RAD
WRITE (KLUN) SELF%LDUSEASON
WRITE (KLUN) SELF%LPERPET
WRITE (KLUN) SELF%LCLEAN
WRITE (KLUN) SELF%RAOVLP
WRITE (KLUN) SELF%RBOVLP
WRITE (KLUN) SELF%LEDBUG
WRITE (KLUN) SELF%RPERTOZ
WRITE (KLUN) SELF%RLWINHF
WRITE (KLUN) SELF%RSWINHF
WRITE (KLUN) SELF%RVOLCSPEC
WRITE (KLUN) SELF%RNS
WRITE (KLUN) SELF%RSIGAIR
WRITE (KLUN) SELF%RAESHSS
WRITE (KLUN) SELF%RAESHDU
WRITE (KLUN) SELF%RAESHOM
WRITE (KLUN) SELF%RAESHBC
WRITE (KLUN) SELF%RAESHSU
WRITE (KLUN) SELF%TRBKG
WRITE (KLUN) SELF%STBKG
WRITE (KLUN) SELF%CGHGCLIMFILE
WRITE (KLUN) SELF%CGHGTIMESERIESFILE
WRITE (KLUN) SELF%CSOLARIRRADIANCEFILE
WRITE (KLUN) SELF%RRATSEA
WRITE (KLUN) SELF%RRATLAND
WRITE (KLUN) SELF%RRATDRI
WRITE (KLUN) SELF%RCADECOR
WRITE (KLUN) SELF%RCBDECOR
WRITE (KLUN) SELF%RFACDICE
LCVDAESS = ALLOCATED (SELF%CVDAESS)
WRITE (KLUN) LCVDAESS
IF (LCVDAESS) THEN
  WRITE (KLUN) LBOUND (SELF%CVDAESS)
  WRITE (KLUN) UBOUND (SELF%CVDAESS)
  WRITE (KLUN) SELF%CVDAESS
ENDIF
LCVDAEDU = ALLOCATED (SELF%CVDAEDU)
WRITE (KLUN) LCVDAEDU
IF (LCVDAEDU) THEN
  WRITE (KLUN) LBOUND (SELF%CVDAEDU)
  WRITE (KLUN) UBOUND (SELF%CVDAEDU)
  WRITE (KLUN) SELF%CVDAEDU
ENDIF
LCVDAEOM = ALLOCATED (SELF%CVDAEOM)
WRITE (KLUN) LCVDAEOM
IF (LCVDAEOM) THEN
  WRITE (KLUN) LBOUND (SELF%CVDAEOM)
  WRITE (KLUN) UBOUND (SELF%CVDAEOM)
  WRITE (KLUN) SELF%CVDAEOM
ENDIF
LCVDAEBC = ALLOCATED (SELF%CVDAEBC)
WRITE (KLUN) LCVDAEBC
IF (LCVDAEBC) THEN
  WRITE (KLUN) LBOUND (SELF%CVDAEBC)
  WRITE (KLUN) UBOUND (SELF%CVDAEBC)
  WRITE (KLUN) SELF%CVDAEBC
ENDIF
LCVDAESU = ALLOCATED (SELF%CVDAESU)
WRITE (KLUN) LCVDAESU
IF (LCVDAESU) THEN
  WRITE (KLUN) LBOUND (SELF%CVDAESU)
  WRITE (KLUN) UBOUND (SELF%CVDAESU)
  WRITE (KLUN) SELF%CVDAESU
ENDIF
WRITE (KLUN) SELF%CECRADARCH
WRITE (KLUN) SELF%LECRADACC
WRITE (KLUN) SELF%NECRADLEN
CALL ACDC_SAVE_TSPECTRALPLANCK (SELF%YSPECTPLANCK, KLUN)
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TERAD (SELF, KLUN)
USE UTIL_TSPECTRALPLANCK_MOD
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TERAD), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) SELF%NAER
READ (KLUN) SELF%NMODE
READ (KLUN) SELF%NOZOCL
READ (KLUN) SELF%NRADFR
READ (KLUN) SELF%NRADPFR
READ (KLUN) SELF%NRADPLA
READ (KLUN) SELF%NRADINT
READ (KLUN) SELF%NRADRES
READ (KLUN) SELF%NRADNFR
READ (KLUN) SELF%NRADSFR
READ (KLUN) SELF%NRADE1H
READ (KLUN) SELF%NRADE3H
READ (KLUN) SELF%NRADELG
READ (KLUN) SELF%NOVLP
READ (KLUN) SELF%NRPROMA
READ (KLUN) SELF%NLW
READ (KLUN) SELF%NSWNL
READ (KLUN) SELF%NSWTL
READ (KLUN) SELF%NTLW
READ (KLUN) SELF%NTSW
READ (KLUN) SELF%NUV
READ (KLUN) SELF%NCSRADF
READ (KLUN) SELF%NINHOM
READ (KLUN) SELF%NLAYINH
READ (KLUN) SELF%NLNGR1H
READ (KLUN) SELF%NPERTAER
READ (KLUN) SELF%NPERTOZ
READ (KLUN) SELF%NSCEN
READ (KLUN) SELF%NHINCSOL
READ (KLUN) SELF%NMCICA
READ (KLUN) SELF%NGHGRAD
READ (KLUN) SELF%NVOLCVERT
READ (KLUN) SELF%NREDGLW
READ (KLUN) SELF%NREDGSW
READ (KLUN) SELF%NSPMAPL
READ (KLUN) SELF%NSPMAPS
READ (KLUN) SELF%NSW
READ (KLUN) SELF%NLWEMISS
READ (KLUN) SELF%NICEOPT
READ (KLUN) SELF%NLIQOPT
READ (KLUN) SELF%NRADIP
READ (KLUN) SELF%NRADLP
READ (KLUN) SELF%NLWOUT
READ (KLUN) SELF%NDECOLAT
READ (KLUN) SELF%NMINICE
READ (KLUN) SELF%NAERMACC
READ (KLUN) SELF%NMCVAR
READ (KLUN) SELF%NLWSCATTERING
READ (KLUN) SELF%NSWSOLVER
READ (KLUN) SELF%NLWSOLVER
READ (KLUN) SELF%NSOLARSPECTRUM
READ (KLUN) SELF%NDUMPBADINPUTS
READ (KLUN) SELF%NDUMPINPUTS
READ (KLUN) SELF%NCLOUDOVERLAP
READ (KLUN) ZTMP0
SELF%RCLOUD_FRAC_STD = ZTMP0
READ (KLUN) ZTMP0
SELF%RCLOUD_SEPARATION_SCALE_TOA = ZTMP0
READ (KLUN) ZTMP0
SELF%RCLOUD_SEPARATION_SCALE_SURF = ZTMP0
READ (KLUN) SELF%LFU_LW_ICE_OPTICS_BUG
READ (KLUN) SELF%LDIAGFORCING
READ (KLUN) SELF%LAPPROXLWUPDATE
READ (KLUN) SELF%LAPPROXSWUPDATE
READ (KLUN) SELF%NSWICEOPT
READ (KLUN) SELF%NSWLIQOPT
READ (KLUN) SELF%NLWICEOPT
READ (KLUN) SELF%NLWLIQOPT
READ (KLUN) SELF%LCCNL
READ (KLUN) SELF%LCCNO
READ (KLUN) ZTMP0
SELF%RCCNLND = ZTMP0
READ (KLUN) ZTMP0
SELF%RCCNSEA = ZTMP0
READ (KLUN) ZTMP0
SELF%RRE2DE = ZTMP0
READ (KLUN) ZTMP0
SELF%RMINICE = ZTMP0
READ (KLUN) SELF%NMCLAT
READ (KLUN) SELF%NMCLON
READ (KLUN) SELF%NMCLEV
READ (KLUN) SELF%NSWGASOPTICS
READ (KLUN) SELF%NLWGASOPTICS
READ (KLUN) SELF%NGASOPTICSSCHEME
READ (KLUN) SELF%KMODTS
READ (KLUN) SELF%NSWWVCONTINUUM
READ (KLUN) SELF%NRTCALL
READ (KLUN) SELF%IRTCALLREF
READ (KLUN) SELF%IRTCALLCLN
READ (KLUN) SELF%LINTERPINCLOUDMEAN
READ (KLUN) SELF%LERAD1H
READ (KLUN) SELF%LEPO3RA
READ (KLUN) SELF%LONEWSW
READ (KLUN) SELF%LECSRAD
READ (KLUN) SELF%LRRTM
READ (KLUN) SELF%LSRTM
READ (KLUN) SELF%LDIFFC
READ (KLUN) SELF%LHVOLCA
READ (KLUN) SELF%LNEWAER
READ (KLUN) SELF%LNOTROAER
READ (KLUN) SELF%LRAYL
READ (KLUN) SELF%LOPTRPROMA
READ (KLUN) SELF%LECO2VAR
READ (KLUN) SELF%LHGHG
READ (KLUN) SELF%LESO4HIS
READ (KLUN) SELF%LETRACGMS
READ (KLUN) SELF%LAERCLIM
READ (KLUN) SELF%LAERVISI
READ (KLUN) SELF%LAER3D
READ (KLUN) SELF%LVOLCSPEC
READ (KLUN) SELF%LVOLCDAMP
READ (KLUN) SELF%LAERADCLI
READ (KLUN) SELF%LAERADJDU
READ (KLUN) SELF%LMANNERSSWUPDATE
READ (KLUN) SELF%LCENTREDTIMESZA
READ (KLUN) SELF%LAVERAGESZA
READ (KLUN) SELF%LECOMPGRID
READ (KLUN) SELF%LUSEPRE2017RAD
READ (KLUN) SELF%LDUSEASON
READ (KLUN) SELF%LPERPET
READ (KLUN) SELF%LCLEAN
READ (KLUN) ZTMP0
SELF%RAOVLP = ZTMP0
READ (KLUN) ZTMP0
SELF%RBOVLP = ZTMP0
READ (KLUN) SELF%LEDBUG
READ (KLUN) ZTMP0
SELF%RPERTOZ = ZTMP0
READ (KLUN) ZTMP0
SELF%RLWINHF = ZTMP0
READ (KLUN) ZTMP0
SELF%RSWINHF = ZTMP0
ALLOCATE (ZTMP1(LBOUND(SELF%RVOLCSPEC,1):UBOUND(SELF%RVOLCSPEC,1)))
READ (KLUN) ZTMP1
SELF%RVOLCSPEC = ZTMP1
DEALLOCATE (ZTMP1)
READ (KLUN) ZTMP0
SELF%RNS = ZTMP0
READ (KLUN) ZTMP0
SELF%RSIGAIR = ZTMP0
READ (KLUN) ZTMP0
SELF%RAESHSS = ZTMP0
READ (KLUN) ZTMP0
SELF%RAESHDU = ZTMP0
READ (KLUN) ZTMP0
SELF%RAESHOM = ZTMP0
READ (KLUN) ZTMP0
SELF%RAESHBC = ZTMP0
READ (KLUN) ZTMP0
SELF%RAESHSU = ZTMP0
READ (KLUN) ZTMP0
SELF%TRBKG = ZTMP0
READ (KLUN) ZTMP0
SELF%STBKG = ZTMP0
READ (KLUN) SELF%CGHGCLIMFILE
READ (KLUN) SELF%CGHGTIMESERIESFILE
READ (KLUN) SELF%CSOLARIRRADIANCEFILE
READ (KLUN) ZTMP0
SELF%RRATSEA = ZTMP0
READ (KLUN) ZTMP0
SELF%RRATLAND = ZTMP0
READ (KLUN) ZTMP0
SELF%RRATDRI = ZTMP0
READ (KLUN) ZTMP0
SELF%RCADECOR = ZTMP0
READ (KLUN) ZTMP0
SELF%RCBDECOR = ZTMP0
READ (KLUN) ZTMP0
SELF%RFACDICE = ZTMP0
READ (KLUN) LCVDAESS
IF (LCVDAESS) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%CVDAESS (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%CVDAESS,1):UBOUND(SELF%CVDAESS,1)))
  READ (KLUN) ZTMP1
  SELF%CVDAESS = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAEDU
IF (LCVDAEDU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%CVDAEDU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%CVDAEDU,1):UBOUND(SELF%CVDAEDU,1)))
  READ (KLUN) ZTMP1
  SELF%CVDAEDU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAEOM
IF (LCVDAEOM) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%CVDAEOM (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%CVDAEOM,1):UBOUND(SELF%CVDAEOM,1)))
  READ (KLUN) ZTMP1
  SELF%CVDAEOM = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAEBC
IF (LCVDAEBC) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%CVDAEBC (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%CVDAEBC,1):UBOUND(SELF%CVDAEBC,1)))
  READ (KLUN) ZTMP1
  SELF%CVDAEBC = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LCVDAESU
IF (LCVDAESU) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%CVDAESU (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%CVDAESU,1):UBOUND(SELF%CVDAESU,1)))
  READ (KLUN) ZTMP1
  SELF%CVDAESU = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) SELF%CECRADARCH
READ (KLUN) SELF%LECRADACC
READ (KLUN) SELF%NECRADLEN
CALL ACDC_LOAD_TSPECTRALPLANCK (SELF%YSPECTPLANCK, KLUN)
END SUBROUTINE

SUBROUTINE ACDC_COPY_TERAD (SELF, LDCREATED, LDFIELDAPI)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

LCVDAESS = ALLOCATED (SELF%CVDAESS)
IF (LCVDAESS) THEN
  !$ACC ENTER DATA CREATE (SELF%CVDAESS)
  !$ACC UPDATE DEVICE (SELF%CVDAESS)
  !$ACC ENTER DATA ATTACH (SELF%CVDAESS)
ENDIF

LCVDAEDU = ALLOCATED (SELF%CVDAEDU)
IF (LCVDAEDU) THEN
  !$ACC ENTER DATA CREATE (SELF%CVDAEDU)
  !$ACC UPDATE DEVICE (SELF%CVDAEDU)
  !$ACC ENTER DATA ATTACH (SELF%CVDAEDU)
ENDIF

LCVDAEOM = ALLOCATED (SELF%CVDAEOM)
IF (LCVDAEOM) THEN
  !$ACC ENTER DATA CREATE (SELF%CVDAEOM)
  !$ACC UPDATE DEVICE (SELF%CVDAEOM)
  !$ACC ENTER DATA ATTACH (SELF%CVDAEOM)
ENDIF

LCVDAEBC = ALLOCATED (SELF%CVDAEBC)
IF (LCVDAEBC) THEN
  !$ACC ENTER DATA CREATE (SELF%CVDAEBC)
  !$ACC UPDATE DEVICE (SELF%CVDAEBC)
  !$ACC ENTER DATA ATTACH (SELF%CVDAEBC)
ENDIF

LCVDAESU = ALLOCATED (SELF%CVDAESU)
IF (LCVDAESU) THEN
  !$ACC ENTER DATA CREATE (SELF%CVDAESU)
  !$ACC UPDATE DEVICE (SELF%CVDAESU)
  !$ACC ENTER DATA ATTACH (SELF%CVDAESU)
ENDIF

CALL ACDC_COPY_TSPECTRALPLANCK (SELF%YSPECTPLANCK, LDCREATED=.TRUE., LDFIELDAPI=LDFIELDAPI)

END SUBROUTINE

SUBROUTINE ACDC_HOST_TERAD (SELF)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD), TARGET :: SELF
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU

CALL ACDC_HOST_TSPECTRALPLANCK (SELF%YSPECTPLANCK)

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TERAD (SELF, KLUN, CDPATH)
USE UTIL_TSPECTRALPLANCK_MOD
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TERAD), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NAER), CDPATH//'%NAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NMODE), CDPATH//'%NMODE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NOZOCL), CDPATH//'%NOZOCL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADFR), CDPATH//'%NRADFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADPFR), CDPATH//'%NRADPFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADPLA), CDPATH//'%NRADPLA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADINT), CDPATH//'%NRADINT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADRES), CDPATH//'%NRADRES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADNFR), CDPATH//'%NRADNFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADSFR), CDPATH//'%NRADSFR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADE1H), CDPATH//'%NRADE1H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADE3H), CDPATH//'%NRADE3H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADELG), CDPATH//'%NRADELG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NOVLP), CDPATH//'%NOVLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRPROMA), CDPATH//'%NRPROMA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLW), CDPATH//'%NLW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSWNL), CDPATH//'%NSWNL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSWTL), CDPATH//'%NSWTL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTLW), CDPATH//'%NTLW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NTSW), CDPATH//'%NTSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NUV), CDPATH//'%NUV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCSRADF), CDPATH//'%NCSRADF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NINHOM), CDPATH//'%NINHOM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLAYINH), CDPATH//'%NLAYINH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLNGR1H), CDPATH//'%NLNGR1H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NPERTAER), CDPATH//'%NPERTAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NPERTOZ), CDPATH//'%NPERTOZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSCEN), CDPATH//'%NSCEN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NHINCSOL), CDPATH//'%NHINCSOL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NMCICA), CDPATH//'%NMCICA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NGHGRAD), CDPATH//'%NGHGRAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NVOLCVERT), CDPATH//'%NVOLCVERT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NREDGLW), CDPATH//'%NREDGLW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NREDGSW), CDPATH//'%NREDGSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSPMAPL), CDPATH//'%NSPMAPL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSPMAPS), CDPATH//'%NSPMAPS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSW), CDPATH//'%NSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLWEMISS), CDPATH//'%NLWEMISS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NICEOPT), CDPATH//'%NICEOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLIQOPT), CDPATH//'%NLIQOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADIP), CDPATH//'%NRADIP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRADLP), CDPATH//'%NRADLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLWOUT), CDPATH//'%NLWOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDECOLAT), CDPATH//'%NDECOLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NMINICE), CDPATH//'%NMINICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NAERMACC), CDPATH//'%NAERMACC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NMCVAR), CDPATH//'%NMCVAR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLWSCATTERING), CDPATH//'%NLWSCATTERING'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSWSOLVER), CDPATH//'%NSWSOLVER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLWSOLVER), CDPATH//'%NLWSOLVER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSOLARSPECTRUM), CDPATH//'%NSOLARSPECTRUM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDUMPBADINPUTS), CDPATH//'%NDUMPBADINPUTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NDUMPINPUTS), CDPATH//'%NDUMPINPUTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCLOUDOVERLAP), CDPATH//'%NCLOUDOVERLAP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCLOUD_FRAC_STD), CDPATH//'%RCLOUD_FRAC_STD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCLOUD_SEPARATION_SCALE_TOA), CDPATH//'%RCLOUD_SEPARATION_SCALE_TOA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCLOUD_SEPARATION_SCALE_SURF), CDPATH//'%RCLOUD_SEPARATION_SCALE_SURF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LFU_LW_ICE_OPTICS_BUG), CDPATH//'%LFU_LW_ICE_OPTICS_BUG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LDIAGFORCING), CDPATH//'%LDIAGFORCING'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAPPROXLWUPDATE), CDPATH//'%LAPPROXLWUPDATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAPPROXSWUPDATE), CDPATH//'%LAPPROXSWUPDATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSWICEOPT), CDPATH//'%NSWICEOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSWLIQOPT), CDPATH//'%NSWLIQOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLWICEOPT), CDPATH//'%NLWICEOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLWLIQOPT), CDPATH//'%NLWLIQOPT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCCNL), CDPATH//'%LCCNL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCCNO), CDPATH//'%LCCNO'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCNLND), CDPATH//'%RCCNLND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCCNSEA), CDPATH//'%RCCNSEA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RRE2DE), CDPATH//'%RRE2DE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RMINICE), CDPATH//'%RMINICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NMCLAT), CDPATH//'%NMCLAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NMCLON), CDPATH//'%NMCLON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NMCLEV), CDPATH//'%NMCLEV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSWGASOPTICS), CDPATH//'%NSWGASOPTICS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLWGASOPTICS), CDPATH//'%NLWGASOPTICS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NGASOPTICSSCHEME), CDPATH//'%NGASOPTICSSCHEME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KMODTS), CDPATH//'%KMODTS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSWWVCONTINUUM), CDPATH//'%NSWWVCONTINUUM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NRTCALL), CDPATH//'%NRTCALL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IRTCALLREF), CDPATH//'%IRTCALLREF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IRTCALLCLN), CDPATH//'%IRTCALLCLN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LINTERPINCLOUDMEAN), CDPATH//'%LINTERPINCLOUDMEAN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LERAD1H), CDPATH//'%LERAD1H'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LEPO3RA), CDPATH//'%LEPO3RA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LONEWSW), CDPATH//'%LONEWSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LECSRAD), CDPATH//'%LECSRAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRRTM), CDPATH//'%LRRTM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LSRTM), CDPATH//'%LSRTM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LDIFFC), CDPATH//'%LDIFFC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LHVOLCA), CDPATH//'%LHVOLCA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LNEWAER), CDPATH//'%LNEWAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LNOTROAER), CDPATH//'%LNOTROAER'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LRAYL), CDPATH//'%LRAYL'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LOPTRPROMA), CDPATH//'%LOPTRPROMA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LECO2VAR), CDPATH//'%LECO2VAR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LHGHG), CDPATH//'%LHGHG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LESO4HIS), CDPATH//'%LESO4HIS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LETRACGMS), CDPATH//'%LETRACGMS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAERCLIM), CDPATH//'%LAERCLIM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAERVISI), CDPATH//'%LAERVISI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAER3D), CDPATH//'%LAER3D'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVOLCSPEC), CDPATH//'%LVOLCSPEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LVOLCDAMP), CDPATH//'%LVOLCDAMP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAERADCLI), CDPATH//'%LAERADCLI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAERADJDU), CDPATH//'%LAERADJDU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LMANNERSSWUPDATE), CDPATH//'%LMANNERSSWUPDATE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCENTREDTIMESZA), CDPATH//'%LCENTREDTIMESZA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LAVERAGESZA), CDPATH//'%LAVERAGESZA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LECOMPGRID), CDPATH//'%LECOMPGRID'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LUSEPRE2017RAD), CDPATH//'%LUSEPRE2017RAD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LDUSEASON), CDPATH//'%LDUSEASON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LPERPET), CDPATH//'%LPERPET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LCLEAN), CDPATH//'%LCLEAN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAOVLP), CDPATH//'%RAOVLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RBOVLP), CDPATH//'%RBOVLP'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LEDBUG), CDPATH//'%LEDBUG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RPERTOZ), CDPATH//'%RPERTOZ'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RLWINHF), CDPATH//'%RLWINHF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSWINHF), CDPATH//'%RSWINHF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RVOLCSPEC), CDPATH//'%RVOLCSPEC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RNS), CDPATH//'%RNS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSIGAIR), CDPATH//'%RSIGAIR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAESHSS), CDPATH//'%RAESHSS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAESHDU), CDPATH//'%RAESHDU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAESHOM), CDPATH//'%RAESHOM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAESHBC), CDPATH//'%RAESHBC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAESHSU), CDPATH//'%RAESHSU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%TRBKG), CDPATH//'%TRBKG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%STBKG), CDPATH//'%STBKG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CGHGCLIMFILE), CDPATH//'%CGHGCLIMFILE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CGHGTIMESERIESFILE), CDPATH//'%CGHGTIMESERIESFILE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CSOLARIRRADIANCEFILE), CDPATH//'%CSOLARIRRADIANCEFILE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RRATSEA), CDPATH//'%RRATSEA'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RRATLAND), CDPATH//'%RRATLAND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RRATDRI), CDPATH//'%RRATDRI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCADECOR), CDPATH//'%RCADECOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RCBDECOR), CDPATH//'%RCBDECOR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RFACDICE), CDPATH//'%RFACDICE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CVDAESS), CDPATH//'%CVDAESS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CVDAEDU), CDPATH//'%CVDAEDU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CVDAEOM), CDPATH//'%CVDAEOM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CVDAEBC), CDPATH//'%CVDAEBC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CVDAESU), CDPATH//'%CVDAESU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CECRADARCH), CDPATH//'%CECRADARCH'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LECRADACC), CDPATH//'%LECRADACC'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NECRADLEN), CDPATH//'%NECRADLEN'

CLIND = ''
CALL ACDC_CRC64_TSPECTRALPLANCK (SELF%YSPECTPLANCK, KLUN, CDPATH//'%YSPECTPLANCK'//TRIM(CLIND))

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TERAD (SELF, LDDELETED, LDFIELDAPI)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LCVDAESS = ALLOCATED (SELF%CVDAESS)
IF (LCVDAESS) THEN
  !$ACC EXIT DATA DETACH (SELF%CVDAESS)
  !$ACC EXIT DATA DELETE (SELF%CVDAESS)
ENDIF

LCVDAEDU = ALLOCATED (SELF%CVDAEDU)
IF (LCVDAEDU) THEN
  !$ACC EXIT DATA DETACH (SELF%CVDAEDU)
  !$ACC EXIT DATA DELETE (SELF%CVDAEDU)
ENDIF

LCVDAEOM = ALLOCATED (SELF%CVDAEOM)
IF (LCVDAEOM) THEN
  !$ACC EXIT DATA DETACH (SELF%CVDAEOM)
  !$ACC EXIT DATA DELETE (SELF%CVDAEOM)
ENDIF

LCVDAEBC = ALLOCATED (SELF%CVDAEBC)
IF (LCVDAEBC) THEN
  !$ACC EXIT DATA DETACH (SELF%CVDAEBC)
  !$ACC EXIT DATA DELETE (SELF%CVDAEBC)
ENDIF

LCVDAESU = ALLOCATED (SELF%CVDAESU)
IF (LCVDAESU) THEN
  !$ACC EXIT DATA DETACH (SELF%CVDAESU)
  !$ACC EXIT DATA DELETE (SELF%CVDAESU)
ENDIF

CALL ACDC_WIPE_TSPECTRALPLANCK (SELF%YSPECTPLANCK, LDDELETED=.TRUE., LDFIELDAPI=LDFIELDAPI)

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TERAD (SELF, CDPATH, LDPRINT) RESULT (KSIZE)
USE UTIL_TSPECTRALPLANCK_MOD
IMPLICIT NONE
TYPE (TERAD),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LCVDAEBC, LCVDAEDU, LCVDAEOM, LCVDAESS, LCVDAESU
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%NAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMODE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMODE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NOZOCL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NOZOCL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADPFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADPFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADPLA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADPLA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADINT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADINT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADRES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADRES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADNFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADNFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADSFR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADSFR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADE1H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADE1H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADE3H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADE3H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADELG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADELG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NOVLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NOVLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRPROMA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRPROMA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSWNL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWNL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSWTL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWTL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTLW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTLW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NTSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NTSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NUV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NUV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NCSRADF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCSRADF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NINHOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NINHOM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLAYINH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLAYINH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLNGR1H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLNGR1H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NPERTAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPERTAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NPERTOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NPERTOZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSCEN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSCEN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NHINCSOL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NHINCSOL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMCICA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCICA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NGHGRAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGHGRAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NVOLCVERT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NVOLCVERT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NREDGLW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NREDGLW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NREDGSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NREDGSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSPMAPL) * SIZE (SELF%NSPMAPL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSPMAPL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSPMAPS) * SIZE (SELF%NSPMAPS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSPMAPS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLWEMISS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWEMISS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NICEOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NICEOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLIQOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLIQOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADIP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADIP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRADLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRADLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLWOUT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWOUT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDECOLAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDECOLAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMINICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMINICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NAERMACC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NAERMACC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMCVAR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCVAR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLWSCATTERING)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWSCATTERING'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSWSOLVER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWSOLVER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLWSOLVER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWSOLVER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSOLARSPECTRUM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSOLARSPECTRUM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDUMPBADINPUTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDUMPBADINPUTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NDUMPINPUTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NDUMPINPUTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NCLOUDOVERLAP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCLOUDOVERLAP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCLOUD_FRAC_STD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCLOUD_FRAC_STD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCLOUD_SEPARATION_SCALE_TOA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCLOUD_SEPARATION_SCALE_TOA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCLOUD_SEPARATION_SCALE_SURF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCLOUD_SEPARATION_SCALE_SURF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LFU_LW_ICE_OPTICS_BUG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LFU_LW_ICE_OPTICS_BUG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LDIAGFORCING)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDIAGFORCING'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAPPROXLWUPDATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAPPROXLWUPDATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAPPROXSWUPDATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAPPROXSWUPDATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSWICEOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWICEOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSWLIQOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWLIQOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLWICEOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWICEOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLWLIQOPT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWLIQOPT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCCNL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCCNL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCCNO)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCCNO'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCNLND)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCNLND'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCCNSEA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCCNSEA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RRE2DE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRE2DE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RMINICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RMINICE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMCLAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCLAT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMCLON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCLON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NMCLEV)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NMCLEV'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSWGASOPTICS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWGASOPTICS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLWGASOPTICS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLWGASOPTICS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NGASOPTICSSCHEME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGASOPTICSSCHEME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%KMODTS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KMODTS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSWWVCONTINUUM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSWWVCONTINUUM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NRTCALL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NRTCALL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IRTCALLREF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IRTCALLREF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%IRTCALLCLN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%IRTCALLCLN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LINTERPINCLOUDMEAN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LINTERPINCLOUDMEAN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LERAD1H)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LERAD1H'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LEPO3RA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LEPO3RA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LONEWSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LONEWSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LECSRAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECSRAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRRTM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRRTM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LSRTM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LSRTM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LDIFFC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDIFFC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LHVOLCA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LHVOLCA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LNEWAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNEWAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LNOTROAER)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LNOTROAER'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LRAYL)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LRAYL'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LOPTRPROMA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LOPTRPROMA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LECO2VAR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECO2VAR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LHGHG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LHGHG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LESO4HIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LESO4HIS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LETRACGMS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LETRACGMS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAERCLIM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERCLIM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAERVISI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERVISI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAER3D)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAER3D'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVOLCSPEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVOLCSPEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LVOLCDAMP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LVOLCDAMP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAERADCLI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERADCLI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAERADJDU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAERADJDU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LMANNERSSWUPDATE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LMANNERSSWUPDATE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCENTREDTIMESZA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCENTREDTIMESZA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LAVERAGESZA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LAVERAGESZA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LECOMPGRID)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECOMPGRID'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LUSEPRE2017RAD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LUSEPRE2017RAD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LDUSEASON)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LDUSEASON'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LPERPET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LPERPET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LCLEAN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LCLEAN'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAOVLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAOVLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RBOVLP)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RBOVLP'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LEDBUG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LEDBUG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RPERTOZ)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RPERTOZ'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RLWINHF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RLWINHF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSWINHF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSWINHF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RVOLCSPEC) * SIZE (SELF%RVOLCSPEC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RVOLCSPEC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RNS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSIGAIR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSIGAIR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAESHSS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHSS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAESHDU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHDU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAESHOM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHOM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAESHBC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHBC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RAESHSU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RAESHSU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%TRBKG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TRBKG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%STBKG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%STBKG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CGHGCLIMFILE) * LEN (SELF%CGHGCLIMFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CGHGCLIMFILE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CGHGTIMESERIESFILE) * LEN (SELF%CGHGTIMESERIESFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CGHGTIMESERIESFILE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CSOLARIRRADIANCEFILE) * LEN (SELF%CSOLARIRRADIANCEFILE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CSOLARIRRADIANCEFILE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RRATSEA)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRATSEA'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RRATLAND)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRATLAND'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RRATDRI)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RRATDRI'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCADECOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCADECOR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RCBDECOR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RCBDECOR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RFACDICE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RFACDICE'
ENDIF
KSIZE = KSIZE + ISIZE
LCVDAESS = ALLOCATED (SELF%CVDAESS)
IF (LCVDAESS) THEN
  ISIZE = KIND (SELF%CVDAESS) * SIZE (SELF%CVDAESS)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAESS'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAEDU = ALLOCATED (SELF%CVDAEDU)
IF (LCVDAEDU) THEN
  ISIZE = KIND (SELF%CVDAEDU) * SIZE (SELF%CVDAEDU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAEDU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAEOM = ALLOCATED (SELF%CVDAEOM)
IF (LCVDAEOM) THEN
  ISIZE = KIND (SELF%CVDAEOM) * SIZE (SELF%CVDAEOM)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAEOM'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAEBC = ALLOCATED (SELF%CVDAEBC)
IF (LCVDAEBC) THEN
  ISIZE = KIND (SELF%CVDAEBC) * SIZE (SELF%CVDAEBC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAEBC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LCVDAESU = ALLOCATED (SELF%CVDAESU)
IF (LCVDAESU) THEN
  ISIZE = KIND (SELF%CVDAESU) * SIZE (SELF%CVDAESU)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%CVDAESU'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (SELF%CECRADARCH) * LEN (SELF%CECRADARCH)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CECRADARCH'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LECRADACC)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LECRADACC'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NECRADLEN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NECRADLEN'
ENDIF
KSIZE = KSIZE + ISIZE
JSIZE = 0
ISIZE = ACDC_SIZE_TSPECTRALPLANCK (SELF%YSPECTPLANCK, CLPATH//'%YSPECTPLANCK', .FALSE.)
JSIZE = JSIZE + ISIZE
KSIZE = KSIZE + ISIZE
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') JSIZE
  WRITE (*, *) TRIM (CLPATH)//'%YSPECTPLANCK'
ENDIF
END FUNCTION

END MODULE
