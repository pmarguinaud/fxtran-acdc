SUBMODULE (YOMTDDH) YOMTDDH_TTDDH_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TTDDH (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TTDDH), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LCFLDNAMES2D, LCFLDNAMES3D, LCFLDTYPES2D, LCFLDTYPES3D, LHDCS0, LHDCS1, LHDCVB0, LHDCVB1, LPDDHFSVI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LHDCVB0 = ALLOCATED (SELF%HDCVB0)
IF (LHDCVB0) THEN
  !$ACC EXIT DATA DETACH (SELF%HDCVB0)
  !$ACC EXIT DATA DELETE (SELF%HDCVB0)
ENDIF

LHDCVB1 = ALLOCATED (SELF%HDCVB1)
IF (LHDCVB1) THEN
  !$ACC EXIT DATA DETACH (SELF%HDCVB1)
  !$ACC EXIT DATA DELETE (SELF%HDCVB1)
ENDIF

LHDCS0 = ALLOCATED (SELF%HDCS0)
IF (LHDCS0) THEN
  !$ACC EXIT DATA DETACH (SELF%HDCS0)
  !$ACC EXIT DATA DELETE (SELF%HDCS0)
ENDIF

LHDCS1 = ALLOCATED (SELF%HDCS1)
IF (LHDCS1) THEN
  !$ACC EXIT DATA DETACH (SELF%HDCS1)
  !$ACC EXIT DATA DELETE (SELF%HDCS1)
ENDIF

LPDDHFSVI = ALLOCATED (SELF%PDDHFSVI)
IF (LPDDHFSVI) THEN
  !$ACC EXIT DATA DETACH (SELF%PDDHFSVI)
  !$ACC EXIT DATA DELETE (SELF%PDDHFSVI)
ENDIF

LCFLDNAMES3D = ALLOCATED (SELF%CFLDNAMES3D)
IF (LCFLDNAMES3D) THEN
  !$ACC EXIT DATA DETACH (SELF%CFLDNAMES3D)
  !$ACC EXIT DATA DELETE (SELF%CFLDNAMES3D)
ENDIF

LCFLDTYPES3D = ALLOCATED (SELF%CFLDTYPES3D)
IF (LCFLDTYPES3D) THEN
  !$ACC EXIT DATA DETACH (SELF%CFLDTYPES3D)
  !$ACC EXIT DATA DELETE (SELF%CFLDTYPES3D)
ENDIF

LCFLDNAMES2D = ALLOCATED (SELF%CFLDNAMES2D)
IF (LCFLDNAMES2D) THEN
  !$ACC EXIT DATA DETACH (SELF%CFLDNAMES2D)
  !$ACC EXIT DATA DELETE (SELF%CFLDNAMES2D)
ENDIF

LCFLDTYPES2D = ALLOCATED (SELF%CFLDTYPES2D)
IF (LCFLDTYPES2D) THEN
  !$ACC EXIT DATA DETACH (SELF%CFLDTYPES2D)
  !$ACC EXIT DATA DELETE (SELF%CFLDTYPES2D)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
