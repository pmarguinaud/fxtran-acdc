SUBROUTINE APL_ARPEGE_INIT_PARALLEL (YDCST, YDMF_PHYS_BASE_STATE, YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC&
&, YDMF_PHYS, YDMF_PHYS_SURF, YDVARS, YDMODEL, YD_KMOC_CLPH, YD_KNLAB_CVPP, YD_PAER, YD_PAERINDS&
&, YD_PAIPCMT, YD_PALBD, YD_PALBP, YD_PALPHA1, YD_PCEMTR, YD_PCFATH, YD_PCFAU, YD_PCFBTH, YD_PCFBU&
&, YD_PCFBV, YD_PCOEFA, YD_PCONDCVPPI, YD_PCONDCVPPL, YD_PCTRSO, YD_PDECRD, YD_PDIFCVPPQ, YD_PDIFCVPPS&
&, YD_PDIFCVPPU, YD_PDIFCVPPV, YD_PDIFWQ, YD_PDIFWS, YD_PEDMFQ, YD_PEDMFS, YD_PEDMFU, YD_PEDMFV&
&, PEPS0, PEPSNEB, YD_PFPCOR, YD_PKQLROV, YD_PKQROV, YD_PKTROV, YD_PKUROV, YD_PLVT, YD_PMF_UP, YD_PMRIPP&
&, YD_PNEBC0, YD_PNEBCH, YD_PNEBDIFF, YD_PNEBS, YD_PNEBS0, YD_PNEB_CVPP, YD_PPFL_FPLCH, YD_PPFL_FPLSH&
&, YD_PPOID, YD_PPRODTH_CVPP, YD_PQC_DET_PCMT, YD_PQI, YD_PQIC, YD_PQICE, YD_PQL, YD_PQLC, YD_PQLIS&
&, YD_PQLIS0, YD_PQLI_CVP, YD_PQLI_CVPP, YD_PQO3, YD_PQR, YD_PQS, YD_PQV, YD_PSC_FCLL, YD_PSC_FCLN&
&, YD_PSC_FEVI, YD_PSC_FEVN, YD_PSEDIQI, YD_PSEDIQL, YD_PSFSWDIF, YD_PSFSWDIR, YD_PSUDU, YD_PTENHA&
&, YD_PTENQVA, YD_PTENT, YD_PTRSOD, YD_PTRSODIF, YD_PTRSODIR, YD_PUNEBH, YD_PXDROV, YD_PXHROV, YD_PXQRO&
&, YD_PXTRO, YD_PXTROV, YD_PXURO, YD_PXUROV)
USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK

USE GEOMETRY_MOD,ONLY:GEOMETRY
USE MF_PHYS_BASE_STATE_TYPE_MOD,ONLY:MF_PHYS_BASE_STATE_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_MISC_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE TYPE_MODEL,ONLY:MODEL
USE YOMCST,ONLY:TCST
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (TCST), INTENT (IN)::YDCST
TYPE (MF_PHYS_BASE_STATE_TYPE), INTENT (IN)::YDMF_PHYS_BASE_STATE
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (INOUT)::YDCPG_MISC
TYPE (MF_PHYS_TYPE), INTENT (INOUT)::YDMF_PHYS
TYPE (MF_PHYS_SURF_TYPE), INTENT (INOUT)::YDMF_PHYS_SURF
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL), INTENT (IN)::YDMODEL
CLASS (FIELD_2IM), POINTER :: YD_KMOC_CLPH
INTEGER (KIND=JPIM), POINTER::KMOC_CLPH (:,:)
CLASS (FIELD_3IM), POINTER :: YD_KNLAB_CVPP
INTEGER (KIND=JPIM), POINTER::KNLAB_CVPP (:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PAER
REAL (KIND=JPRB), POINTER::PAER (:,:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PAERINDS
REAL (KIND=JPRB), POINTER::PAERINDS (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PAIPCMT
REAL (KIND=JPRB), POINTER::PAIPCMT (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALBD
REAL (KIND=JPRB), POINTER::PALBD (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALBP
REAL (KIND=JPRB), POINTER::PALBP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PALPHA1
REAL (KIND=JPRB), POINTER::PALPHA1 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCEMTR
REAL (KIND=JPRB), POINTER::PCEMTR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFATH
REAL (KIND=JPRB), POINTER::PCFATH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFAU
REAL (KIND=JPRB), POINTER::PCFAU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFBTH
REAL (KIND=JPRB), POINTER::PCFBTH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFBU
REAL (KIND=JPRB), POINTER::PCFBU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCFBV
REAL (KIND=JPRB), POINTER::PCFBV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCOEFA
REAL (KIND=JPRB), POINTER::PCOEFA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCONDCVPPI
REAL (KIND=JPRB), POINTER::PCONDCVPPI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCONDCVPPL
REAL (KIND=JPRB), POINTER::PCONDCVPPL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCTRSO
REAL (KIND=JPRB), POINTER::PCTRSO (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDECRD
REAL (KIND=JPRB), POINTER::PDECRD (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCVPPQ
REAL (KIND=JPRB), POINTER::PDIFCVPPQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCVPPS
REAL (KIND=JPRB), POINTER::PDIFCVPPS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCVPPU
REAL (KIND=JPRB), POINTER::PDIFCVPPU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PDIFCVPPV
REAL (KIND=JPRB), POINTER::PDIFCVPPV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDIFWQ
REAL (KIND=JPRB), POINTER::PDIFWQ (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDIFWS
REAL (KIND=JPRB), POINTER::PDIFWS (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFQ
REAL (KIND=JPRB), POINTER::PEDMFQ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFS
REAL (KIND=JPRB), POINTER::PEDMFS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFU
REAL (KIND=JPRB), POINTER::PEDMFU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PEDMFV
REAL (KIND=JPRB), POINTER::PEDMFV (:,:,:)
REAL (KIND=JPRB), INTENT (OUT)::PEPS0
REAL (KIND=JPRB), INTENT (OUT)::PEPSNEB
CLASS (FIELD_3RB), POINTER :: YD_PFPCOR
REAL (KIND=JPRB), POINTER::PFPCOR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKQLROV
REAL (KIND=JPRB), POINTER::PKQLROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKQROV
REAL (KIND=JPRB), POINTER::PKQROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKTROV
REAL (KIND=JPRB), POINTER::PKTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PKUROV
REAL (KIND=JPRB), POINTER::PKUROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PLVT
REAL (KIND=JPRB), POINTER::PLVT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMF_UP
REAL (KIND=JPRB), POINTER::PMF_UP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PMRIPP
REAL (KIND=JPRB), POINTER::PMRIPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBC0
REAL (KIND=JPRB), POINTER::PNEBC0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBCH
REAL (KIND=JPRB), POINTER::PNEBCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBDIFF
REAL (KIND=JPRB), POINTER::PNEBDIFF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBS
REAL (KIND=JPRB), POINTER::PNEBS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEBS0
REAL (KIND=JPRB), POINTER::PNEBS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PNEB_CVPP
REAL (KIND=JPRB), POINTER::PNEB_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FPLCH
REAL (KIND=JPRB), POINTER::PPFL_FPLCH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPFL_FPLSH
REAL (KIND=JPRB), POINTER::PPFL_FPLSH (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPOID
REAL (KIND=JPRB), POINTER::PPOID (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PPRODTH_CVPP
REAL (KIND=JPRB), POINTER::PPRODTH_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQC_DET_PCMT
REAL (KIND=JPRB), POINTER::PQC_DET_PCMT (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQI
REAL (KIND=JPRB), POINTER::PQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQIC
REAL (KIND=JPRB), POINTER::PQIC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQICE
REAL (KIND=JPRB), POINTER::PQICE (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQL
REAL (KIND=JPRB), POINTER::PQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLC
REAL (KIND=JPRB), POINTER::PQLC (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLIS
REAL (KIND=JPRB), POINTER::PQLIS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLIS0
REAL (KIND=JPRB), POINTER::PQLIS0 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLI_CVP
REAL (KIND=JPRB), POINTER::PQLI_CVP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQLI_CVPP
REAL (KIND=JPRB), POINTER::PQLI_CVPP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQO3
REAL (KIND=JPRB), POINTER::PQO3 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQR
REAL (KIND=JPRB), POINTER::PQR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQS
REAL (KIND=JPRB), POINTER::PQS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PQV
REAL (KIND=JPRB), POINTER::PQV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSC_FCLL
REAL (KIND=JPRB), POINTER::PSC_FCLL (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSC_FCLN
REAL (KIND=JPRB), POINTER::PSC_FCLN (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSC_FEVI
REAL (KIND=JPRB), POINTER::PSC_FEVI (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSC_FEVN
REAL (KIND=JPRB), POINTER::PSC_FEVN (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSEDIQI
REAL (KIND=JPRB), POINTER::PSEDIQI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSEDIQL
REAL (KIND=JPRB), POINTER::PSEDIQL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIF
REAL (KIND=JPRB), POINTER::PSFSWDIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PSFSWDIR
REAL (KIND=JPRB), POINTER::PSFSWDIR (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PSUDU
REAL (KIND=JPRB), POINTER::PSUDU (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENHA
REAL (KIND=JPRB), POINTER::PTENHA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENQVA
REAL (KIND=JPRB), POINTER::PTENQVA (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTENT
REAL (KIND=JPRB), POINTER::PTENT (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PTRSOD
REAL (KIND=JPRB), POINTER::PTRSOD (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTRSODIF
REAL (KIND=JPRB), POINTER::PTRSODIF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTRSODIR
REAL (KIND=JPRB), POINTER::PTRSODIR (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PUNEBH
REAL (KIND=JPRB), POINTER::PUNEBH (:,:,:)
CLASS (FIELD_2RB), POINTER :: YD_PXDROV
REAL (KIND=JPRB), POINTER::PXDROV (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PXHROV
REAL (KIND=JPRB), POINTER::PXHROV (:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXQRO
REAL (KIND=JPRB), POINTER::PXQRO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXTRO
REAL (KIND=JPRB), POINTER::PXTRO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXTROV
REAL (KIND=JPRB), POINTER::PXTROV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXURO
REAL (KIND=JPRB), POINTER::PXURO (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PXUROV
REAL (KIND=JPRB), POINTER::PXUROV (:,:,:)
#include "radozcmf.intfb.h"
#include "abor1.intfb.h"
#include "radozcmf_openacc.intfb.h"
#include "suozon.intfb.h"
#include "suozon_openacc.intfb.h"
REAL (KIND=JPRB)::ZDQC
REAL (KIND=JPRB)::ZDQI
REAL (KIND=JPRB)::ZDQL
REAL (KIND=JPRB)::ZDQR
REAL (KIND=JPRB)::ZDQS
REAL (KIND=JPRB)::ZDQV
REAL (KIND=JPRB)::ZEPSO3
REAL (KIND=JPRB)::ZGDT
REAL (KIND=JPRB)::ZGDTI
CLASS (FIELD_3RB), POINTER :: YL_ZIPOI
REAL (KIND=JPRB), POINTER::ZIPOI (:,:,:)
REAL (KIND=JPRB)::ZQV0
CLASS (FIELD_3RB), POINTER :: YL_ZROZ
REAL (KIND=JPRB), POINTER::ZROZ (:,:,:)
INTEGER (KIND=JPIM)::JCHA
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JLON
INTEGER (KIND=JPIM)::JSG
REAL (KIND=JPHOOK)::ZHOOK_HANDLE_1
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDCPG_MISC_KOZO(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_I(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_L(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_Q(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_R(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_S(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQLNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQNNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQRNG(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_FCQSNG(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VC_PA(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VC_PB(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_VC_PC(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_T0(:,:)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZROZ, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZIPOI, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART1', 0, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_INIT_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
  PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    PAIPCMT (:, JBLK)=0._JPRB

    IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD<=0._JPRB.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRNUEXP) THEN

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PDECRD (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD1+YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD2&
        &*EXP (-((ASIN (Z_YDVARS_GEOMETRY_GEMU_T0 (JLON, JBLK))-YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD3&
        &*YDMODEL%YRML_GCONF%YRRIP%RDECLI)/YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD4)**2)
      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
    PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => NULL ()
  PDECRD => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
  PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      PAIPCMT (JLON, JBLK)=0._JPRB

      IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD<=0._JPRB.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRNUEXP) THEN
        
        PDECRD (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD1+YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD2&
        &*EXP (-((ASIN (Z_YDVARS_GEOMETRY_GEMU_T0 (JLON, JBLK))-YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD3&
        &*YDMODEL%YRML_GCONF%YRRIP%RDECLI)/YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD4)**2)
      
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
    PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => NULL ()
  PDECRD => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:0')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => GET_DEVICE_DATA_RDWR (YD_PAIPCMT)
  PDECRD => GET_DEVICE_DATA_RDWR (YD_PDECRD)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PAIPCMT, PDECRD, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, Z_YDVARS_GEOMETRY_GEMU_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      PAIPCMT (JLON, JBLK)=0._JPRB

      IF (YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD<=0._JPRB.OR.YDMODEL%YRML_PHY_MF%YRPHY%LRNUEXP) THEN
        
        PDECRD (JLON, JBLK)=YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD1+YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD2&
        &*EXP (-((ASIN (Z_YDVARS_GEOMETRY_GEMU_T0 (JLON, JBLK))-YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD3&
        &*YDMODEL%YRML_GCONF%YRRIP%RDECLI)/YDMODEL%YRML_PHY_MF%YRPHY0%RDECRD4)**2)
      
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:0')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PAIPCMT => GET_HOST_DATA_RDWR (YD_PAIPCMT)
    PDECRD => GET_HOST_DATA_RDWR (YD_PDECRD)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PAIPCMT => NULL ()
  PDECRD => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_INIT_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART1', 1, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART2', 0, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_INIT_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
  ZROZ => GET_HOST_DATA_RDWR (YL_ZROZ)
  Z_YDCPG_MISC_KOZO => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_KOZO)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_SURF_GSD_VC_PA => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_A)
  Z_YDMF_PHYS_SURF_GSD_VC_PB => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_B)
  Z_YDMF_PHYS_SURF_GSD_VC_PC => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_C)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, ZEPSO3) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF (YDMODEL%YRML_PHY_G%YRDPHY%NVCLIS==1) THEN
      ZEPSO3=1.E-11_JPRB

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PQO3 (JLON, 0, JBLK)=1.E-9_JPRB
      ENDDO


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PQO3 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_KOZO (JLON, JLEV, 1, JBLK)
        ENDDO

      ENDDO

    ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LO3FL.AND.(YDMODEL%YRML_PHY_RAD&
      &%YRERAD%NOZOCL==1).AND.YDMODEL%YRML_PHY_MF%YRPHY%LRAYFM) THEN

      IF (MOD (YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_RAD%YRERAD%NRADFR)==0) THEN
        CALL RADOZCMF (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP%YREOZOC, YLCPG_BNDS%KIDIA,&
        & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
        &(:,:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), ZROZ(:,:, JBLK))

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PQO3 (JLON, 0, JBLK)=1.E-9_JPRB
        ENDDO


        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

          DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            PQO3 (JLON, JLEV, JBLK)=ZROZ (JLON, JLEV, JBLK)*Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
            & (JLON, JLEV, JBLK)
          ENDDO

        ENDDO

      ENDIF

    ELSE
      CALL SUOZON (YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, PQO3(:&
      &,:, JBLK),.FALSE., Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
      &(:,:, JBLK), YDMODEL%YRML_PHY_MF%YRPHY%LO3ABC, Z_YDMF_PHYS_SURF_GSD_VC_PA(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VC_PB&
      &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VC_PC(:, JBLK))
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    ZROZ => GET_HOST_DATA_RDWR (YL_ZROZ)
    Z_YDCPG_MISC_KOZO => GET_HOST_DATA_RDWR (YDCPG_MISC%F_KOZO)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_SURF_GSD_VC_PA => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_A)
    Z_YDMF_PHYS_SURF_GSD_VC_PB => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_B)
    Z_YDMF_PHYS_SURF_GSD_VC_PC => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_C)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PQO3 => NULL ()
  ZROZ => NULL ()
  Z_YDCPG_MISC_KOZO => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PA => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PB => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PC => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
  ZROZ => GET_HOST_DATA_RDWR (YL_ZROZ)
  Z_YDCPG_MISC_KOZO => GET_HOST_DATA_RDONLY (YDCPG_MISC%F_KOZO)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_SURF_GSD_VC_PA => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_A)
  Z_YDMF_PHYS_SURF_GSD_VC_PB => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_B)
  Z_YDMF_PHYS_SURF_GSD_VC_PC => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_C)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, YLSTACK, ZEPSO3)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (YDMODEL%YRML_PHY_G%YRDPHY%NVCLIS==1) THEN
        ZEPSO3=1.E-11_JPRB
        
        PQO3 (JLON, 0, JBLK)=1.E-9_JPRB

        

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          PQO3 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_KOZO (JLON, JLEV, 1, JBLK)
        
        ENDDO

      ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LO3FL.AND.(YDMODEL%YRML_PHY_RAD&
        &%YRERAD%NOZOCL==1).AND.YDMODEL%YRML_PHY_MF%YRPHY%LRAYFM) THEN

        IF (MOD (YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_RAD%YRERAD%NRADFR)==0) THEN
          CALL RADOZCMF_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP%YREOZOC, YLCPG_BNDS%KIDIA,&
          & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
          &(:,:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), ZROZ(:,:, JBLK),YDSTACK=YLSTACK)
          
          PQO3 (JLON, 0, JBLK)=1.E-9_JPRB

          

          DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
            
            PQO3 (JLON, JLEV, JBLK)=ZROZ (JLON, JLEV, JBLK)*Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
            & (JLON, JLEV, JBLK)
          
          ENDDO

        ENDIF

      ELSE
        CALL SUOZON_OPENACC (YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, PQO3&
        &(:,:, JBLK),.FALSE., Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
        &(:,:, JBLK), YDMODEL%YRML_PHY_MF%YRPHY%LO3ABC, Z_YDMF_PHYS_SURF_GSD_VC_PA(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VC_PB&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VC_PC(:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    ZROZ => GET_HOST_DATA_RDWR (YL_ZROZ)
    Z_YDCPG_MISC_KOZO => GET_HOST_DATA_RDWR (YDCPG_MISC%F_KOZO)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_SURF_GSD_VC_PA => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_A)
    Z_YDMF_PHYS_SURF_GSD_VC_PB => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_B)
    Z_YDMF_PHYS_SURF_GSD_VC_PC => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_C)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PQO3 => NULL ()
  ZROZ => NULL ()
  Z_YDCPG_MISC_KOZO => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PA => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PB => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PC => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PQO3 => GET_DEVICE_DATA_RDWR (YD_PQO3)
  ZROZ => GET_DEVICE_DATA_RDWR (YL_ZROZ)
  Z_YDCPG_MISC_KOZO => GET_DEVICE_DATA_RDONLY (YDCPG_MISC%F_KOZO)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  Z_YDMF_PHYS_SURF_GSD_VC_PA => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_A)
  Z_YDMF_PHYS_SURF_GSD_VC_PB => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_B)
  Z_YDMF_PHYS_SURF_GSD_VC_PC => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_VC%F_C)
  Z_YDVARS_GEOMETRY_GEMU_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PQO3, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZROZ, Z_YDCPG_MISC_KOZO, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP, &
    !$ACC&         Z_YDMF_PHYS_SURF_GSD_VC_PA, Z_YDMF_PHYS_SURF_GSD_VC_PB, &
    !$ACC&         Z_YDMF_PHYS_SURF_GSD_VC_PC, Z_YDVARS_GEOMETRY_GEMU_T0) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, YLSTACK, ZEPSO3) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

      

      IF (YDMODEL%YRML_PHY_G%YRDPHY%NVCLIS==1) THEN
        ZEPSO3=1.E-11_JPRB
        
        PQO3 (JLON, 0, JBLK)=1.E-9_JPRB

        

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          PQO3 (JLON, JLEV, JBLK)=Z_YDCPG_MISC_KOZO (JLON, JLEV, 1, JBLK)
        
        ENDDO

      ELSEIF (YDMODEL%YRML_PHY_MF%YRPHY%LO3FL.AND.(YDMODEL%YRML_PHY_RAD&
        &%YRERAD%NOZOCL==1).AND.YDMODEL%YRML_PHY_MF%YRPHY%LRAYFM) THEN

        IF (MOD (YDCPG_OPTS%NSTEP, YDMODEL%YRML_PHY_RAD%YRERAD%NRADFR)==0) THEN
          CALL RADOZCMF_OPENACC (YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP%YREOZOC, YLCPG_BNDS%KIDIA,&
          & YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD&
          &(:,:, JBLK), Z_YDVARS_GEOMETRY_GEMU_T0(:, JBLK), ZROZ(:,:, JBLK),YDSTACK=YLSTACK)
          
          PQO3 (JLON, 0, JBLK)=1.E-9_JPRB

          

          DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
            
            PQO3 (JLON, JLEV, JBLK)=ZROZ (JLON, JLEV, JBLK)*Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
            & (JLON, JLEV, JBLK)
          
          ENDDO

        ENDIF

      ELSE
        CALL SUOZON_OPENACC (YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, PQO3&
        &(:,:, JBLK),.FALSE., Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD(:,:, JBLK), Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP&
        &(:,:, JBLK), YDMODEL%YRML_PHY_MF%YRPHY%LO3ABC, Z_YDMF_PHYS_SURF_GSD_VC_PA(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VC_PB&
        &(:, JBLK), Z_YDMF_PHYS_SURF_GSD_VC_PC(:, JBLK),YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PQO3 => GET_HOST_DATA_RDWR (YD_PQO3)
    ZROZ => GET_HOST_DATA_RDWR (YL_ZROZ)
    Z_YDCPG_MISC_KOZO => GET_HOST_DATA_RDWR (YDCPG_MISC%F_KOZO)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%F_PREHYD)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    Z_YDMF_PHYS_SURF_GSD_VC_PA => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_A)
    Z_YDMF_PHYS_SURF_GSD_VC_PB => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_B)
    Z_YDMF_PHYS_SURF_GSD_VC_PC => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_VC%F_C)
    Z_YDVARS_GEOMETRY_GEMU_T0 => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PQO3 => NULL ()
  ZROZ => NULL ()
  Z_YDCPG_MISC_KOZO => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_PREHYD => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PA => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PB => NULL ()
  Z_YDMF_PHYS_SURF_GSD_VC_PC => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_T0 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_INIT_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART2', 1, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART3', 0, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_INIT_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
  PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
  ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, ZGDT, ZGDTI) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    PPRODTH_CVPP (:,:, JBLK)=0.0_JPRB
    ZGDT=YDCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY
    ZGDTI=1.0_JPRB/ZGDT

    DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PPOID (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP (JLON, JLEV, JBLK)*ZGDTI
        ZIPOI (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP (JLON, JLEV, JBLK)*ZGDT
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:2')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
    ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => NULL ()
  PPRODTH_CVPP => NULL ()
  ZIPOI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
  PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
  ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, ZGDT, ZGDTI)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      PPRODTH_CVPP (JLON,:, JBLK)=0.0_JPRB
      ZGDT=YDCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY
      ZGDTI=1.0_JPRB/ZGDT

      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        PPOID (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP (JLON, JLEV, JBLK)*ZGDTI
        ZIPOI (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP (JLON, JLEV, JBLK)*ZGDT
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:2')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
    ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => NULL ()
  PPRODTH_CVPP => NULL ()
  ZIPOI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:2')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => GET_DEVICE_DATA_RDWR (YD_PPOID)
  PPRODTH_CVPP => GET_DEVICE_DATA_RDWR (YD_PPRODTH_CVPP)
  ZIPOI => GET_DEVICE_DATA_RDWR (YL_ZIPOI)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_DEVICE_DATA_RDONLY&
  & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PPOID, PPRODTH_CVPP, YDCPG_OPTS, YDCST, YDMODEL, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZIPOI, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP, Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, ZGDT, ZGDTI) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      PPRODTH_CVPP (JLON,:, JBLK)=0.0_JPRB
      ZGDT=YDCST%RG*YDMODEL%YRML_PHY_MF%YRPHY2%TSPHY
      ZGDTI=1.0_JPRB/ZGDT

      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        PPOID (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP (JLON, JLEV, JBLK)*ZGDTI
        ZIPOI (JLON, JLEV, JBLK)=Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP (JLON, JLEV, JBLK)*ZGDT
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:2')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PPRODTH_CVPP => GET_HOST_DATA_RDWR (YD_PPRODTH_CVPP)
    ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_DELP)
    Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => GET_HOST_DATA_RDWR&
    & (YDMF_PHYS_BASE_STATE%YCPG_PHY%XYB%F_RDELP)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => NULL ()
  PPRODTH_CVPP => NULL ()
  ZIPOI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_DELP => NULL ()
  Z_YDMF_PHYS_BASE_STATE_YCPG_PHY_XYB_RDELP => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_INIT_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:2',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART3', 1, ZHOOK_HANDLE_1)
PEPS0=1.E-12_JPRB
PEPSNEB=1.E-10_JPRB
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART4', 0, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_INIT_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
  PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
  PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
  PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
  PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
  PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
  PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
  PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
  PCONDCVPPI => GET_HOST_DATA_RDWR (YD_PCONDCVPPI)
  PCONDCVPPL => GET_HOST_DATA_RDWR (YD_PCONDCVPPL)
  PDIFCVPPQ => GET_HOST_DATA_RDWR (YD_PDIFCVPPQ)
  PDIFCVPPS => GET_HOST_DATA_RDWR (YD_PDIFCVPPS)
  PDIFCVPPU => GET_HOST_DATA_RDWR (YD_PDIFCVPPU)
  PDIFCVPPV => GET_HOST_DATA_RDWR (YD_PDIFCVPPV)
  PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
  PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
  PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
  PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
  PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
  PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
  PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
  PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
  PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
  PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
  PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
  PMRIPP => GET_HOST_DATA_RDWR (YD_PMRIPP)
  PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
  PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
  PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
  PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
  PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
  PQC_DET_PCMT => GET_HOST_DATA_RDWR (YD_PQC_DET_PCMT)
  PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
  PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
  PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
  PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
  PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
  PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
  PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
  PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
  PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
  PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
  PSEDIQI => GET_HOST_DATA_RDWR (YD_PSEDIQI)
  PSEDIQL => GET_HOST_DATA_RDWR (YD_PSEDIQL)
  PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
  PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
  PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
  PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
  PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
  PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
  PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
  PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
  PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    PFPCOR (:,:, JBLK)=0.0_JPRB
    PXTROV (:,:, JBLK)=1.0_JPRB
    PXUROV (:,:, JBLK)=1.0_JPRB
    PKTROV (:,:, JBLK)=0.0_JPRB
    PKQROV (:,:, JBLK)=0.0_JPRB
    PKQLROV (:,:, JBLK)=0.0_JPRB
    PKUROV (:,:, JBLK)=0.0_JPRB
    PDIFCVPPQ (:,:, JBLK)=0.0_JPRB
    PDIFCVPPS (:,:, JBLK)=0.0_JPRB
    PDIFCVPPU (:,:, JBLK)=0.0_JPRB
    PDIFCVPPV (:,:, JBLK)=0.0_JPRB
    PCONDCVPPL (:,:, JBLK)=0.0_JPRB
    PCONDCVPPI (:,:, JBLK)=0.0_JPRB
    PSEDIQL (:,:, JBLK)=0.0_JPRB
    PSEDIQI (:,:, JBLK)=0.0_JPRB
    PXURO (:,:, JBLK)=0.0_JPRB
    PXQRO (:,:, JBLK)=0.0_JPRB
    PXTRO (:,:, JBLK)=0.0_JPRB
    PALPHA1 (:,:, JBLK)=0.0_JPRB
    PCOEFA (:,:, JBLK)=0.0_JPRB
    PLVT (:,:, JBLK)=0.0_JPRB
    PQICE (:,:, JBLK)=0.0_JPRB
    PMRIPP (:,:, JBLK)=1.E-12_JPRB
    PDIFWQ (:, JBLK)=0.0_JPRB
    PDIFWS (:, JBLK)=0.0_JPRB
    PSC_FEVI (:, JBLK)=1.0_JPRB
    PSC_FEVN (:, JBLK)=1.0_JPRB
    PSC_FCLL (:, JBLK)=1.0_JPRB
    PSC_FCLN (:, JBLK)=1.0_JPRB
    PTENT (:,:, JBLK)=0.0_JPRB
    PNEBS (:,:, JBLK)=PEPS0
    PNEBS0 (:,:, JBLK)=PEPS0
    PNEBC0 (:,:, JBLK)=PEPS0
    PNEBCH (:,:, JBLK)=0.0_JPRB
    PUNEBH (:,:, JBLK)=0.0_JPRB
    PNEBDIFF (:,:, JBLK)=0.0_JPRB
    PQLIS (:,:, JBLK)=0.0_JPRB
    PQLIS0 (:,:, JBLK)=0.0_JPRB
    PCFATH (:,:, JBLK)=0.0_JPRB
    PCFAU (:,:, JBLK)=0.0_JPRB
    PCFBTH (:,:, JBLK)=0.0_JPRB
    PCFBU (:,:, JBLK)=0.0_JPRB
    PCFBV (:,:, JBLK)=0.0_JPRB
    KNLAB_CVPP (:,:, JBLK)=0
    PQLI_CVPP (:,:, JBLK)=0.0_JPRB
    PNEB_CVPP (:,:, JBLK)=PEPS0
    PEDMFQ (:,:, JBLK)=0.0_JPRB
    PEDMFS (:,:, JBLK)=0.0_JPRB
    PEDMFU (:,:, JBLK)=0.0_JPRB
    PEDMFV (:,:, JBLK)=0.0_JPRB
    PMF_UP (:,:, JBLK)=0.0_JPRB
    PQLI_CVP (:,:, JBLK)=0.0_JPRB
    PQC_DET_PCMT (:,:, JBLK)=0.0_JPRB
    PTENHA (:,:, JBLK)=0.0_JPRB
    PTENQVA (:,:, JBLK)=0.0_JPRB
    PQIC (:,:, JBLK)=0.0_JPRB
    PQLC (:,:, JBLK)=0.0_JPRB
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:3')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PCONDCVPPI => GET_HOST_DATA_RDWR (YD_PCONDCVPPI)
    PCONDCVPPL => GET_HOST_DATA_RDWR (YD_PCONDCVPPL)
    PDIFCVPPQ => GET_HOST_DATA_RDWR (YD_PDIFCVPPQ)
    PDIFCVPPS => GET_HOST_DATA_RDWR (YD_PDIFCVPPS)
    PDIFCVPPU => GET_HOST_DATA_RDWR (YD_PDIFCVPPU)
    PDIFCVPPV => GET_HOST_DATA_RDWR (YD_PDIFCVPPV)
    PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
    PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
    PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
    PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
    PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
    PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
    PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
    PMRIPP => GET_HOST_DATA_RDWR (YD_PMRIPP)
    PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
    PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
    PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
    PQC_DET_PCMT => GET_HOST_DATA_RDWR (YD_PQC_DET_PCMT)
    PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
    PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
    PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
    PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
    PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
    PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
    PSEDIQI => GET_HOST_DATA_RDWR (YD_PSEDIQI)
    PSEDIQL => GET_HOST_DATA_RDWR (YD_PSEDIQL)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
    PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
    PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => NULL ()
  PALPHA1 => NULL ()
  PCFATH => NULL ()
  PCFAU => NULL ()
  PCFBTH => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCOEFA => NULL ()
  PCONDCVPPI => NULL ()
  PCONDCVPPL => NULL ()
  PDIFCVPPQ => NULL ()
  PDIFCVPPS => NULL ()
  PDIFCVPPU => NULL ()
  PDIFCVPPV => NULL ()
  PDIFWQ => NULL ()
  PDIFWS => NULL ()
  PEDMFQ => NULL ()
  PEDMFS => NULL ()
  PEDMFU => NULL ()
  PEDMFV => NULL ()
  PFPCOR => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PLVT => NULL ()
  PMF_UP => NULL ()
  PMRIPP => NULL ()
  PNEBC0 => NULL ()
  PNEBCH => NULL ()
  PNEBDIFF => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PNEB_CVPP => NULL ()
  PQC_DET_PCMT => NULL ()
  PQIC => NULL ()
  PQICE => NULL ()
  PQLC => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQLI_CVP => NULL ()
  PQLI_CVPP => NULL ()
  PSC_FCLL => NULL ()
  PSC_FCLN => NULL ()
  PSC_FEVI => NULL ()
  PSC_FEVN => NULL ()
  PSEDIQI => NULL ()
  PSEDIQL => NULL ()
  PTENHA => NULL ()
  PTENQVA => NULL ()
  PTENT => NULL ()
  PUNEBH => NULL ()
  PXQRO => NULL ()
  PXTRO => NULL ()
  PXTROV => NULL ()
  PXURO => NULL ()
  PXUROV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
  PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
  PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
  PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
  PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
  PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
  PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
  PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
  PCONDCVPPI => GET_HOST_DATA_RDWR (YD_PCONDCVPPI)
  PCONDCVPPL => GET_HOST_DATA_RDWR (YD_PCONDCVPPL)
  PDIFCVPPQ => GET_HOST_DATA_RDWR (YD_PDIFCVPPQ)
  PDIFCVPPS => GET_HOST_DATA_RDWR (YD_PDIFCVPPS)
  PDIFCVPPU => GET_HOST_DATA_RDWR (YD_PDIFCVPPU)
  PDIFCVPPV => GET_HOST_DATA_RDWR (YD_PDIFCVPPV)
  PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
  PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
  PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
  PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
  PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
  PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
  PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
  PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
  PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
  PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
  PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
  PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
  PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
  PMRIPP => GET_HOST_DATA_RDWR (YD_PMRIPP)
  PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
  PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
  PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
  PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
  PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
  PQC_DET_PCMT => GET_HOST_DATA_RDWR (YD_PQC_DET_PCMT)
  PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
  PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
  PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
  PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
  PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
  PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
  PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
  PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
  PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
  PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
  PSEDIQI => GET_HOST_DATA_RDWR (YD_PSEDIQI)
  PSEDIQL => GET_HOST_DATA_RDWR (YD_PSEDIQL)
  PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
  PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
  PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
  PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
  PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
  PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
  PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
  PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
  PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      PFPCOR (JLON,:, JBLK)=0.0_JPRB
      PXTROV (JLON,:, JBLK)=1.0_JPRB
      PXUROV (JLON,:, JBLK)=1.0_JPRB
      PKTROV (JLON,:, JBLK)=0.0_JPRB
      PKQROV (JLON,:, JBLK)=0.0_JPRB
      PKQLROV (JLON,:, JBLK)=0.0_JPRB
      PKUROV (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPQ (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPS (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPU (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPV (JLON,:, JBLK)=0.0_JPRB
      PCONDCVPPL (JLON,:, JBLK)=0.0_JPRB
      PCONDCVPPI (JLON,:, JBLK)=0.0_JPRB
      PSEDIQL (JLON,:, JBLK)=0.0_JPRB
      PSEDIQI (JLON,:, JBLK)=0.0_JPRB
      PXURO (JLON,:, JBLK)=0.0_JPRB
      PXQRO (JLON,:, JBLK)=0.0_JPRB
      PXTRO (JLON,:, JBLK)=0.0_JPRB
      PALPHA1 (JLON,:, JBLK)=0.0_JPRB
      PCOEFA (JLON,:, JBLK)=0.0_JPRB
      PLVT (JLON,:, JBLK)=0.0_JPRB
      PQICE (JLON,:, JBLK)=0.0_JPRB
      PMRIPP (JLON,:, JBLK)=1.E-12_JPRB
      PDIFWQ (JLON, JBLK)=0.0_JPRB
      PDIFWS (JLON, JBLK)=0.0_JPRB
      PSC_FEVI (JLON, JBLK)=1.0_JPRB
      PSC_FEVN (JLON, JBLK)=1.0_JPRB
      PSC_FCLL (JLON, JBLK)=1.0_JPRB
      PSC_FCLN (JLON, JBLK)=1.0_JPRB
      PTENT (JLON,:, JBLK)=0.0_JPRB
      PNEBS (JLON,:, JBLK)=PEPS0
      PNEBS0 (JLON,:, JBLK)=PEPS0
      PNEBC0 (JLON,:, JBLK)=PEPS0
      PNEBCH (JLON,:, JBLK)=0.0_JPRB
      PUNEBH (JLON,:, JBLK)=0.0_JPRB
      PNEBDIFF (JLON,:, JBLK)=0.0_JPRB
      PQLIS (JLON,:, JBLK)=0.0_JPRB
      PQLIS0 (JLON,:, JBLK)=0.0_JPRB
      PCFATH (JLON,:, JBLK)=0.0_JPRB
      PCFAU (JLON,:, JBLK)=0.0_JPRB
      PCFBTH (JLON,:, JBLK)=0.0_JPRB
      PCFBU (JLON,:, JBLK)=0.0_JPRB
      PCFBV (JLON,:, JBLK)=0.0_JPRB
      KNLAB_CVPP (JLON,:, JBLK)=0
      PQLI_CVPP (JLON,:, JBLK)=0.0_JPRB
      PNEB_CVPP (JLON,:, JBLK)=PEPS0
      PEDMFQ (JLON,:, JBLK)=0.0_JPRB
      PEDMFS (JLON,:, JBLK)=0.0_JPRB
      PEDMFU (JLON,:, JBLK)=0.0_JPRB
      PEDMFV (JLON,:, JBLK)=0.0_JPRB
      PMF_UP (JLON,:, JBLK)=0.0_JPRB
      PQLI_CVP (JLON,:, JBLK)=0.0_JPRB
      PQC_DET_PCMT (JLON,:, JBLK)=0.0_JPRB
      PTENHA (JLON,:, JBLK)=0.0_JPRB
      PTENQVA (JLON,:, JBLK)=0.0_JPRB
      PQIC (JLON,:, JBLK)=0.0_JPRB
      PQLC (JLON,:, JBLK)=0.0_JPRB
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:3')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PCONDCVPPI => GET_HOST_DATA_RDWR (YD_PCONDCVPPI)
    PCONDCVPPL => GET_HOST_DATA_RDWR (YD_PCONDCVPPL)
    PDIFCVPPQ => GET_HOST_DATA_RDWR (YD_PDIFCVPPQ)
    PDIFCVPPS => GET_HOST_DATA_RDWR (YD_PDIFCVPPS)
    PDIFCVPPU => GET_HOST_DATA_RDWR (YD_PDIFCVPPU)
    PDIFCVPPV => GET_HOST_DATA_RDWR (YD_PDIFCVPPV)
    PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
    PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
    PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
    PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
    PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
    PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
    PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
    PMRIPP => GET_HOST_DATA_RDWR (YD_PMRIPP)
    PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
    PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
    PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
    PQC_DET_PCMT => GET_HOST_DATA_RDWR (YD_PQC_DET_PCMT)
    PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
    PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
    PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
    PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
    PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
    PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
    PSEDIQI => GET_HOST_DATA_RDWR (YD_PSEDIQI)
    PSEDIQL => GET_HOST_DATA_RDWR (YD_PSEDIQL)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
    PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
    PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => NULL ()
  PALPHA1 => NULL ()
  PCFATH => NULL ()
  PCFAU => NULL ()
  PCFBTH => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCOEFA => NULL ()
  PCONDCVPPI => NULL ()
  PCONDCVPPL => NULL ()
  PDIFCVPPQ => NULL ()
  PDIFCVPPS => NULL ()
  PDIFCVPPU => NULL ()
  PDIFCVPPV => NULL ()
  PDIFWQ => NULL ()
  PDIFWS => NULL ()
  PEDMFQ => NULL ()
  PEDMFS => NULL ()
  PEDMFU => NULL ()
  PEDMFV => NULL ()
  PFPCOR => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PLVT => NULL ()
  PMF_UP => NULL ()
  PMRIPP => NULL ()
  PNEBC0 => NULL ()
  PNEBCH => NULL ()
  PNEBDIFF => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PNEB_CVPP => NULL ()
  PQC_DET_PCMT => NULL ()
  PQIC => NULL ()
  PQICE => NULL ()
  PQLC => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQLI_CVP => NULL ()
  PQLI_CVPP => NULL ()
  PSC_FCLL => NULL ()
  PSC_FCLN => NULL ()
  PSC_FEVI => NULL ()
  PSC_FEVN => NULL ()
  PSEDIQI => NULL ()
  PSEDIQL => NULL ()
  PTENHA => NULL ()
  PTENQVA => NULL ()
  PTENT => NULL ()
  PUNEBH => NULL ()
  PXQRO => NULL ()
  PXTRO => NULL ()
  PXTROV => NULL ()
  PXURO => NULL ()
  PXUROV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:3')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => GET_DEVICE_DATA_RDWR (YD_KNLAB_CVPP)
  PALPHA1 => GET_DEVICE_DATA_RDWR (YD_PALPHA1)
  PCFATH => GET_DEVICE_DATA_RDWR (YD_PCFATH)
  PCFAU => GET_DEVICE_DATA_RDWR (YD_PCFAU)
  PCFBTH => GET_DEVICE_DATA_RDWR (YD_PCFBTH)
  PCFBU => GET_DEVICE_DATA_RDWR (YD_PCFBU)
  PCFBV => GET_DEVICE_DATA_RDWR (YD_PCFBV)
  PCOEFA => GET_DEVICE_DATA_RDWR (YD_PCOEFA)
  PCONDCVPPI => GET_DEVICE_DATA_RDWR (YD_PCONDCVPPI)
  PCONDCVPPL => GET_DEVICE_DATA_RDWR (YD_PCONDCVPPL)
  PDIFCVPPQ => GET_DEVICE_DATA_RDWR (YD_PDIFCVPPQ)
  PDIFCVPPS => GET_DEVICE_DATA_RDWR (YD_PDIFCVPPS)
  PDIFCVPPU => GET_DEVICE_DATA_RDWR (YD_PDIFCVPPU)
  PDIFCVPPV => GET_DEVICE_DATA_RDWR (YD_PDIFCVPPV)
  PDIFWQ => GET_DEVICE_DATA_RDWR (YD_PDIFWQ)
  PDIFWS => GET_DEVICE_DATA_RDWR (YD_PDIFWS)
  PEDMFQ => GET_DEVICE_DATA_RDWR (YD_PEDMFQ)
  PEDMFS => GET_DEVICE_DATA_RDWR (YD_PEDMFS)
  PEDMFU => GET_DEVICE_DATA_RDWR (YD_PEDMFU)
  PEDMFV => GET_DEVICE_DATA_RDWR (YD_PEDMFV)
  PFPCOR => GET_DEVICE_DATA_RDWR (YD_PFPCOR)
  PKQLROV => GET_DEVICE_DATA_RDWR (YD_PKQLROV)
  PKQROV => GET_DEVICE_DATA_RDWR (YD_PKQROV)
  PKTROV => GET_DEVICE_DATA_RDWR (YD_PKTROV)
  PKUROV => GET_DEVICE_DATA_RDWR (YD_PKUROV)
  PLVT => GET_DEVICE_DATA_RDWR (YD_PLVT)
  PMF_UP => GET_DEVICE_DATA_RDWR (YD_PMF_UP)
  PMRIPP => GET_DEVICE_DATA_RDWR (YD_PMRIPP)
  PNEBC0 => GET_DEVICE_DATA_RDWR (YD_PNEBC0)
  PNEBCH => GET_DEVICE_DATA_RDWR (YD_PNEBCH)
  PNEBDIFF => GET_DEVICE_DATA_RDWR (YD_PNEBDIFF)
  PNEBS => GET_DEVICE_DATA_RDWR (YD_PNEBS)
  PNEBS0 => GET_DEVICE_DATA_RDWR (YD_PNEBS0)
  PNEB_CVPP => GET_DEVICE_DATA_RDWR (YD_PNEB_CVPP)
  PQC_DET_PCMT => GET_DEVICE_DATA_RDWR (YD_PQC_DET_PCMT)
  PQIC => GET_DEVICE_DATA_RDWR (YD_PQIC)
  PQICE => GET_DEVICE_DATA_RDWR (YD_PQICE)
  PQLC => GET_DEVICE_DATA_RDWR (YD_PQLC)
  PQLIS => GET_DEVICE_DATA_RDWR (YD_PQLIS)
  PQLIS0 => GET_DEVICE_DATA_RDWR (YD_PQLIS0)
  PQLI_CVP => GET_DEVICE_DATA_RDWR (YD_PQLI_CVP)
  PQLI_CVPP => GET_DEVICE_DATA_RDWR (YD_PQLI_CVPP)
  PSC_FCLL => GET_DEVICE_DATA_RDWR (YD_PSC_FCLL)
  PSC_FCLN => GET_DEVICE_DATA_RDWR (YD_PSC_FCLN)
  PSC_FEVI => GET_DEVICE_DATA_RDWR (YD_PSC_FEVI)
  PSC_FEVN => GET_DEVICE_DATA_RDWR (YD_PSC_FEVN)
  PSEDIQI => GET_DEVICE_DATA_RDWR (YD_PSEDIQI)
  PSEDIQL => GET_DEVICE_DATA_RDWR (YD_PSEDIQL)
  PTENHA => GET_DEVICE_DATA_RDWR (YD_PTENHA)
  PTENQVA => GET_DEVICE_DATA_RDWR (YD_PTENQVA)
  PTENT => GET_DEVICE_DATA_RDWR (YD_PTENT)
  PUNEBH => GET_DEVICE_DATA_RDWR (YD_PUNEBH)
  PXQRO => GET_DEVICE_DATA_RDWR (YD_PXQRO)
  PXTRO => GET_DEVICE_DATA_RDWR (YD_PXTRO)
  PXTROV => GET_DEVICE_DATA_RDWR (YD_PXTROV)
  PXURO => GET_DEVICE_DATA_RDWR (YD_PXURO)
  PXUROV => GET_DEVICE_DATA_RDWR (YD_PXUROV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (KNLAB_CVPP, PALPHA1, PCFATH, PCFAU, PCFBTH, PCFBU, PCFBV, PCOEFA, PCONDCVPPI, &
    !$ACC&         PCONDCVPPL, PDIFCVPPQ, PDIFCVPPS, PDIFCVPPU, PDIFCVPPV, PDIFWQ, &
    !$ACC&         PDIFWS, PEDMFQ, PEDMFS, PEDMFU, PEDMFV, PFPCOR, PKQLROV, PKQROV, PKTROV, &
    !$ACC&         PKUROV, PLVT, PMF_UP, PMRIPP, PNEBC0, PNEBCH, PNEBDIFF, PNEBS, PNEBS0, &
    !$ACC&         PNEB_CVPP, PQC_DET_PCMT, PQIC, PQICE, PQLC, PQLIS, PQLIS0, PQLI_CVP, &
    !$ACC&         PQLI_CVPP, PSC_FCLL, PSC_FCLN, PSC_FEVI, PSC_FEVN, PSEDIQI, PSEDIQL, &
    !$ACC&         PTENHA, PTENQVA, PTENT, PUNEBH, PXQRO, PXTRO, PXTROV, PXURO, PXUROV, &
    !$ACC&         YDCPG_OPTS, YFXTRAN_ACDC_STACK) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      
      PFPCOR (JLON,:, JBLK)=0.0_JPRB
      PXTROV (JLON,:, JBLK)=1.0_JPRB
      PXUROV (JLON,:, JBLK)=1.0_JPRB
      PKTROV (JLON,:, JBLK)=0.0_JPRB
      PKQROV (JLON,:, JBLK)=0.0_JPRB
      PKQLROV (JLON,:, JBLK)=0.0_JPRB
      PKUROV (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPQ (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPS (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPU (JLON,:, JBLK)=0.0_JPRB
      PDIFCVPPV (JLON,:, JBLK)=0.0_JPRB
      PCONDCVPPL (JLON,:, JBLK)=0.0_JPRB
      PCONDCVPPI (JLON,:, JBLK)=0.0_JPRB
      PSEDIQL (JLON,:, JBLK)=0.0_JPRB
      PSEDIQI (JLON,:, JBLK)=0.0_JPRB
      PXURO (JLON,:, JBLK)=0.0_JPRB
      PXQRO (JLON,:, JBLK)=0.0_JPRB
      PXTRO (JLON,:, JBLK)=0.0_JPRB
      PALPHA1 (JLON,:, JBLK)=0.0_JPRB
      PCOEFA (JLON,:, JBLK)=0.0_JPRB
      PLVT (JLON,:, JBLK)=0.0_JPRB
      PQICE (JLON,:, JBLK)=0.0_JPRB
      PMRIPP (JLON,:, JBLK)=1.E-12_JPRB
      PDIFWQ (JLON, JBLK)=0.0_JPRB
      PDIFWS (JLON, JBLK)=0.0_JPRB
      PSC_FEVI (JLON, JBLK)=1.0_JPRB
      PSC_FEVN (JLON, JBLK)=1.0_JPRB
      PSC_FCLL (JLON, JBLK)=1.0_JPRB
      PSC_FCLN (JLON, JBLK)=1.0_JPRB
      PTENT (JLON,:, JBLK)=0.0_JPRB
      PNEBS (JLON,:, JBLK)=PEPS0
      PNEBS0 (JLON,:, JBLK)=PEPS0
      PNEBC0 (JLON,:, JBLK)=PEPS0
      PNEBCH (JLON,:, JBLK)=0.0_JPRB
      PUNEBH (JLON,:, JBLK)=0.0_JPRB
      PNEBDIFF (JLON,:, JBLK)=0.0_JPRB
      PQLIS (JLON,:, JBLK)=0.0_JPRB
      PQLIS0 (JLON,:, JBLK)=0.0_JPRB
      PCFATH (JLON,:, JBLK)=0.0_JPRB
      PCFAU (JLON,:, JBLK)=0.0_JPRB
      PCFBTH (JLON,:, JBLK)=0.0_JPRB
      PCFBU (JLON,:, JBLK)=0.0_JPRB
      PCFBV (JLON,:, JBLK)=0.0_JPRB
      KNLAB_CVPP (JLON,:, JBLK)=0
      PQLI_CVPP (JLON,:, JBLK)=0.0_JPRB
      PNEB_CVPP (JLON,:, JBLK)=PEPS0
      PEDMFQ (JLON,:, JBLK)=0.0_JPRB
      PEDMFS (JLON,:, JBLK)=0.0_JPRB
      PEDMFU (JLON,:, JBLK)=0.0_JPRB
      PEDMFV (JLON,:, JBLK)=0.0_JPRB
      PMF_UP (JLON,:, JBLK)=0.0_JPRB
      PQLI_CVP (JLON,:, JBLK)=0.0_JPRB
      PQC_DET_PCMT (JLON,:, JBLK)=0.0_JPRB
      PTENHA (JLON,:, JBLK)=0.0_JPRB
      PTENQVA (JLON,:, JBLK)=0.0_JPRB
      PQIC (JLON,:, JBLK)=0.0_JPRB
      PQLC (JLON,:, JBLK)=0.0_JPRB
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:3')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KNLAB_CVPP => GET_HOST_DATA_RDWR (YD_KNLAB_CVPP)
    PALPHA1 => GET_HOST_DATA_RDWR (YD_PALPHA1)
    PCFATH => GET_HOST_DATA_RDWR (YD_PCFATH)
    PCFAU => GET_HOST_DATA_RDWR (YD_PCFAU)
    PCFBTH => GET_HOST_DATA_RDWR (YD_PCFBTH)
    PCFBU => GET_HOST_DATA_RDWR (YD_PCFBU)
    PCFBV => GET_HOST_DATA_RDWR (YD_PCFBV)
    PCOEFA => GET_HOST_DATA_RDWR (YD_PCOEFA)
    PCONDCVPPI => GET_HOST_DATA_RDWR (YD_PCONDCVPPI)
    PCONDCVPPL => GET_HOST_DATA_RDWR (YD_PCONDCVPPL)
    PDIFCVPPQ => GET_HOST_DATA_RDWR (YD_PDIFCVPPQ)
    PDIFCVPPS => GET_HOST_DATA_RDWR (YD_PDIFCVPPS)
    PDIFCVPPU => GET_HOST_DATA_RDWR (YD_PDIFCVPPU)
    PDIFCVPPV => GET_HOST_DATA_RDWR (YD_PDIFCVPPV)
    PDIFWQ => GET_HOST_DATA_RDWR (YD_PDIFWQ)
    PDIFWS => GET_HOST_DATA_RDWR (YD_PDIFWS)
    PEDMFQ => GET_HOST_DATA_RDWR (YD_PEDMFQ)
    PEDMFS => GET_HOST_DATA_RDWR (YD_PEDMFS)
    PEDMFU => GET_HOST_DATA_RDWR (YD_PEDMFU)
    PEDMFV => GET_HOST_DATA_RDWR (YD_PEDMFV)
    PFPCOR => GET_HOST_DATA_RDWR (YD_PFPCOR)
    PKQLROV => GET_HOST_DATA_RDWR (YD_PKQLROV)
    PKQROV => GET_HOST_DATA_RDWR (YD_PKQROV)
    PKTROV => GET_HOST_DATA_RDWR (YD_PKTROV)
    PKUROV => GET_HOST_DATA_RDWR (YD_PKUROV)
    PLVT => GET_HOST_DATA_RDWR (YD_PLVT)
    PMF_UP => GET_HOST_DATA_RDWR (YD_PMF_UP)
    PMRIPP => GET_HOST_DATA_RDWR (YD_PMRIPP)
    PNEBC0 => GET_HOST_DATA_RDWR (YD_PNEBC0)
    PNEBCH => GET_HOST_DATA_RDWR (YD_PNEBCH)
    PNEBDIFF => GET_HOST_DATA_RDWR (YD_PNEBDIFF)
    PNEBS => GET_HOST_DATA_RDWR (YD_PNEBS)
    PNEBS0 => GET_HOST_DATA_RDWR (YD_PNEBS0)
    PNEB_CVPP => GET_HOST_DATA_RDWR (YD_PNEB_CVPP)
    PQC_DET_PCMT => GET_HOST_DATA_RDWR (YD_PQC_DET_PCMT)
    PQIC => GET_HOST_DATA_RDWR (YD_PQIC)
    PQICE => GET_HOST_DATA_RDWR (YD_PQICE)
    PQLC => GET_HOST_DATA_RDWR (YD_PQLC)
    PQLIS => GET_HOST_DATA_RDWR (YD_PQLIS)
    PQLIS0 => GET_HOST_DATA_RDWR (YD_PQLIS0)
    PQLI_CVP => GET_HOST_DATA_RDWR (YD_PQLI_CVP)
    PQLI_CVPP => GET_HOST_DATA_RDWR (YD_PQLI_CVPP)
    PSC_FCLL => GET_HOST_DATA_RDWR (YD_PSC_FCLL)
    PSC_FCLN => GET_HOST_DATA_RDWR (YD_PSC_FCLN)
    PSC_FEVI => GET_HOST_DATA_RDWR (YD_PSC_FEVI)
    PSC_FEVN => GET_HOST_DATA_RDWR (YD_PSC_FEVN)
    PSEDIQI => GET_HOST_DATA_RDWR (YD_PSEDIQI)
    PSEDIQL => GET_HOST_DATA_RDWR (YD_PSEDIQL)
    PTENHA => GET_HOST_DATA_RDWR (YD_PTENHA)
    PTENQVA => GET_HOST_DATA_RDWR (YD_PTENQVA)
    PTENT => GET_HOST_DATA_RDWR (YD_PTENT)
    PUNEBH => GET_HOST_DATA_RDWR (YD_PUNEBH)
    PXQRO => GET_HOST_DATA_RDWR (YD_PXQRO)
    PXTRO => GET_HOST_DATA_RDWR (YD_PXTRO)
    PXTROV => GET_HOST_DATA_RDWR (YD_PXTROV)
    PXURO => GET_HOST_DATA_RDWR (YD_PXURO)
    PXUROV => GET_HOST_DATA_RDWR (YD_PXUROV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KNLAB_CVPP => NULL ()
  PALPHA1 => NULL ()
  PCFATH => NULL ()
  PCFAU => NULL ()
  PCFBTH => NULL ()
  PCFBU => NULL ()
  PCFBV => NULL ()
  PCOEFA => NULL ()
  PCONDCVPPI => NULL ()
  PCONDCVPPL => NULL ()
  PDIFCVPPQ => NULL ()
  PDIFCVPPS => NULL ()
  PDIFCVPPU => NULL ()
  PDIFCVPPV => NULL ()
  PDIFWQ => NULL ()
  PDIFWS => NULL ()
  PEDMFQ => NULL ()
  PEDMFS => NULL ()
  PEDMFU => NULL ()
  PEDMFV => NULL ()
  PFPCOR => NULL ()
  PKQLROV => NULL ()
  PKQROV => NULL ()
  PKTROV => NULL ()
  PKUROV => NULL ()
  PLVT => NULL ()
  PMF_UP => NULL ()
  PMRIPP => NULL ()
  PNEBC0 => NULL ()
  PNEBCH => NULL ()
  PNEBDIFF => NULL ()
  PNEBS => NULL ()
  PNEBS0 => NULL ()
  PNEB_CVPP => NULL ()
  PQC_DET_PCMT => NULL ()
  PQIC => NULL ()
  PQICE => NULL ()
  PQLC => NULL ()
  PQLIS => NULL ()
  PQLIS0 => NULL ()
  PQLI_CVP => NULL ()
  PQLI_CVPP => NULL ()
  PSC_FCLL => NULL ()
  PSC_FCLN => NULL ()
  PSC_FEVI => NULL ()
  PSC_FEVN => NULL ()
  PSEDIQI => NULL ()
  PSEDIQL => NULL ()
  PTENHA => NULL ()
  PTENQVA => NULL ()
  PTENT => NULL ()
  PUNEBH => NULL ()
  PXQRO => NULL ()
  PXTRO => NULL ()
  PXTROV => NULL ()
  PXURO => NULL ()
  PXUROV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_INIT_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:3',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART4', 1, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART5', 0, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_INIT_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => GET_HOST_DATA_RDONLY (YD_PPOID)
  PQI => GET_HOST_DATA_RDWR (YD_PQI)
  PQL => GET_HOST_DATA_RDWR (YD_PQL)
  PQR => GET_HOST_DATA_RDWR (YD_PQR)
  PQS => GET_HOST_DATA_RDWR (YD_PQS)
  PQV => GET_HOST_DATA_RDWR (YD_PQV)
  ZIPOI => GET_HOST_DATA_RDONLY (YL_ZIPOI)
  Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_R)
  Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_S)
  Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
  Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
  Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
  Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, ZDQC, ZDQI, ZDQL, ZDQR, ZDQS, ZDQV, ZQV0) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JLEV=1, YDCPG_OPTS%KFLEVG

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PQI (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_I (JLON, JLEV, JBLK))
        PQL (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_L (JLON, JLEV, JBLK))
        PQR (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_R (JLON, JLEV, JBLK))
        PQS (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_S (JLON, JLEV, JBLK))
        ZDQI=PQI (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_I (JLON, JLEV, JBLK)
        ZDQL=PQL (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_L (JLON, JLEV, JBLK)
        ZDQR=PQR (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_R (JLON, JLEV, JBLK)
        ZDQS=PQS (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_S (JLON, JLEV, JBLK)
        ZDQC=ZDQI+ZDQL+ZDQR+ZDQS
        ZQV0=Z_YDMF_PHYS_BASE_STATE_Q (JLON, JLEV, JBLK)-ZIPOI (JLON, JLEV, JBLK)*(0.0_JPRB&
        &-Z_YDMF_PHYS_OUT_FCQNG (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQNNG (JLON, JLEV&
        &-1, JBLK)-Z_YDMF_PHYS_OUT_FCQLNG (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQRNG&
        & (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQSNG (JLON, JLEV-1, JBLK))
        PQV (JLON, JLEV, JBLK)=MAX (0.0_JPRB, ZQV0-ZDQC)
        ZDQV=MAX (0.0_JPRB, ZQV0-ZDQC)-Z_YDMF_PHYS_BASE_STATE_Q (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQNG&
        & (JLON, JLEV-1, JBLK)-ZDQV*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQNNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQNNG&
        & (JLON, JLEV-1, JBLK)-ZDQI*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQLNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQLNG&
        & (JLON, JLEV-1, JBLK)-ZDQL*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQRNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQRNG&
        & (JLON, JLEV-1, JBLK)-ZDQR*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQSNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQSNG&
        & (JLON, JLEV-1, JBLK)-ZDQS*PPOID (JLON, JLEV, JBLK)
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:4')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQR => GET_HOST_DATA_RDWR (YD_PQR)
    PQS => GET_HOST_DATA_RDWR (YD_PQS)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_R)
    Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_S)
    Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
    Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
    Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQR => NULL ()
  PQS => NULL ()
  PQV => NULL ()
  ZIPOI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_S => NULL ()
  Z_YDMF_PHYS_OUT_FCQLNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQRNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQSNG => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => GET_HOST_DATA_RDONLY (YD_PPOID)
  PQI => GET_HOST_DATA_RDWR (YD_PQI)
  PQL => GET_HOST_DATA_RDWR (YD_PQL)
  PQR => GET_HOST_DATA_RDWR (YD_PQR)
  PQS => GET_HOST_DATA_RDWR (YD_PQS)
  PQV => GET_HOST_DATA_RDWR (YD_PQV)
  ZIPOI => GET_HOST_DATA_RDONLY (YL_ZIPOI)
  Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_R)
  Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_S)
  Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
  Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
  Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
  Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS, ZDQC, ZDQI, ZDQL, ZDQR, ZDQS, ZDQV, ZQV0)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        PQI (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_I (JLON, JLEV, JBLK))
        PQL (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_L (JLON, JLEV, JBLK))
        PQR (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_R (JLON, JLEV, JBLK))
        PQS (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_S (JLON, JLEV, JBLK))
        ZDQI=PQI (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_I (JLON, JLEV, JBLK)
        ZDQL=PQL (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_L (JLON, JLEV, JBLK)
        ZDQR=PQR (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_R (JLON, JLEV, JBLK)
        ZDQS=PQS (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_S (JLON, JLEV, JBLK)
        ZDQC=ZDQI+ZDQL+ZDQR+ZDQS
        ZQV0=Z_YDMF_PHYS_BASE_STATE_Q (JLON, JLEV, JBLK)-ZIPOI (JLON, JLEV, JBLK)*(0.0_JPRB&
        &-Z_YDMF_PHYS_OUT_FCQNG (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQNNG (JLON, JLEV&
        &-1, JBLK)-Z_YDMF_PHYS_OUT_FCQLNG (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQRNG&
        & (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQSNG (JLON, JLEV-1, JBLK))
        PQV (JLON, JLEV, JBLK)=MAX (0.0_JPRB, ZQV0-ZDQC)
        ZDQV=MAX (0.0_JPRB, ZQV0-ZDQC)-Z_YDMF_PHYS_BASE_STATE_Q (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQNG&
        & (JLON, JLEV-1, JBLK)-ZDQV*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQNNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQNNG&
        & (JLON, JLEV-1, JBLK)-ZDQI*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQLNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQLNG&
        & (JLON, JLEV-1, JBLK)-ZDQL*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQRNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQRNG&
        & (JLON, JLEV-1, JBLK)-ZDQR*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQSNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQSNG&
        & (JLON, JLEV-1, JBLK)-ZDQS*PPOID (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:4')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQR => GET_HOST_DATA_RDWR (YD_PQR)
    PQS => GET_HOST_DATA_RDWR (YD_PQS)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_R)
    Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_S)
    Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
    Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
    Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQR => NULL ()
  PQS => NULL ()
  PQV => NULL ()
  ZIPOI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_S => NULL ()
  Z_YDMF_PHYS_OUT_FCQLNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQRNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQSNG => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:4')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => GET_DEVICE_DATA_RDONLY (YD_PPOID)
  PQI => GET_DEVICE_DATA_RDWR (YD_PQI)
  PQL => GET_DEVICE_DATA_RDWR (YD_PQL)
  PQR => GET_DEVICE_DATA_RDWR (YD_PQR)
  PQS => GET_DEVICE_DATA_RDWR (YD_PQS)
  PQV => GET_DEVICE_DATA_RDWR (YD_PQV)
  ZIPOI => GET_DEVICE_DATA_RDONLY (YL_ZIPOI)
  Z_YDMF_PHYS_BASE_STATE_I => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_I)
  Z_YDMF_PHYS_BASE_STATE_L => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_L)
  Z_YDMF_PHYS_BASE_STATE_Q => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_Q)
  Z_YDMF_PHYS_BASE_STATE_R => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_R)
  Z_YDMF_PHYS_BASE_STATE_S => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_BASE_STATE%F_S)
  Z_YDMF_PHYS_OUT_FCQLNG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
  Z_YDMF_PHYS_OUT_FCQNG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
  Z_YDMF_PHYS_OUT_FCQNNG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
  Z_YDMF_PHYS_OUT_FCQRNG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
  Z_YDMF_PHYS_OUT_FCQSNG => GET_DEVICE_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PPOID, PQI, PQL, PQR, PQS, PQV, YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZIPOI, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_I, Z_YDMF_PHYS_BASE_STATE_L, Z_YDMF_PHYS_BASE_STATE_Q, &
    !$ACC&         Z_YDMF_PHYS_BASE_STATE_R, Z_YDMF_PHYS_BASE_STATE_S, Z_YDMF_PHYS_OUT_FCQLNG, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCQNG, Z_YDMF_PHYS_OUT_FCQNNG, Z_YDMF_PHYS_OUT_FCQRNG, &
    !$ACC&         Z_YDMF_PHYS_OUT_FCQSNG) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS, ZDQC, ZDQI, ZDQL, ZDQR, ZDQS, ZDQV, ZQV0) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JLEV=1, YDCPG_OPTS%KFLEVG
        
        PQI (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_I (JLON, JLEV, JBLK))
        PQL (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_L (JLON, JLEV, JBLK))
        PQR (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_R (JLON, JLEV, JBLK))
        PQS (JLON, JLEV, JBLK)=MAX (0.0_JPRB, Z_YDMF_PHYS_BASE_STATE_S (JLON, JLEV, JBLK))
        ZDQI=PQI (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_I (JLON, JLEV, JBLK)
        ZDQL=PQL (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_L (JLON, JLEV, JBLK)
        ZDQR=PQR (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_R (JLON, JLEV, JBLK)
        ZDQS=PQS (JLON, JLEV, JBLK)-Z_YDMF_PHYS_BASE_STATE_S (JLON, JLEV, JBLK)
        ZDQC=ZDQI+ZDQL+ZDQR+ZDQS
        ZQV0=Z_YDMF_PHYS_BASE_STATE_Q (JLON, JLEV, JBLK)-ZIPOI (JLON, JLEV, JBLK)*(0.0_JPRB&
        &-Z_YDMF_PHYS_OUT_FCQNG (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQNNG (JLON, JLEV&
        &-1, JBLK)-Z_YDMF_PHYS_OUT_FCQLNG (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQRNG&
        & (JLON, JLEV-1, JBLK)-Z_YDMF_PHYS_OUT_FCQSNG (JLON, JLEV-1, JBLK))
        PQV (JLON, JLEV, JBLK)=MAX (0.0_JPRB, ZQV0-ZDQC)
        ZDQV=MAX (0.0_JPRB, ZQV0-ZDQC)-Z_YDMF_PHYS_BASE_STATE_Q (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQNG&
        & (JLON, JLEV-1, JBLK)-ZDQV*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQNNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQNNG&
        & (JLON, JLEV-1, JBLK)-ZDQI*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQLNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQLNG&
        & (JLON, JLEV-1, JBLK)-ZDQL*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQRNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQRNG&
        & (JLON, JLEV-1, JBLK)-ZDQR*PPOID (JLON, JLEV, JBLK)
        Z_YDMF_PHYS_OUT_FCQSNG (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_FCQSNG&
        & (JLON, JLEV-1, JBLK)-ZDQS*PPOID (JLON, JLEV, JBLK)
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:4')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPOID => GET_HOST_DATA_RDWR (YD_PPOID)
    PQI => GET_HOST_DATA_RDWR (YD_PQI)
    PQL => GET_HOST_DATA_RDWR (YD_PQL)
    PQR => GET_HOST_DATA_RDWR (YD_PQR)
    PQS => GET_HOST_DATA_RDWR (YD_PQS)
    PQV => GET_HOST_DATA_RDWR (YD_PQV)
    ZIPOI => GET_HOST_DATA_RDWR (YL_ZIPOI)
    Z_YDMF_PHYS_BASE_STATE_I => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_I)
    Z_YDMF_PHYS_BASE_STATE_L => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_L)
    Z_YDMF_PHYS_BASE_STATE_Q => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_Q)
    Z_YDMF_PHYS_BASE_STATE_R => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_R)
    Z_YDMF_PHYS_BASE_STATE_S => GET_HOST_DATA_RDWR (YDMF_PHYS_BASE_STATE%F_S)
    Z_YDMF_PHYS_OUT_FCQLNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQLNG)
    Z_YDMF_PHYS_OUT_FCQNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNG)
    Z_YDMF_PHYS_OUT_FCQNNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQNNG)
    Z_YDMF_PHYS_OUT_FCQRNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQRNG)
    Z_YDMF_PHYS_OUT_FCQSNG => GET_HOST_DATA_RDWR (YDMF_PHYS%OUT%F_FCQSNG)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPOID => NULL ()
  PQI => NULL ()
  PQL => NULL ()
  PQR => NULL ()
  PQS => NULL ()
  PQV => NULL ()
  ZIPOI => NULL ()
  Z_YDMF_PHYS_BASE_STATE_I => NULL ()
  Z_YDMF_PHYS_BASE_STATE_L => NULL ()
  Z_YDMF_PHYS_BASE_STATE_Q => NULL ()
  Z_YDMF_PHYS_BASE_STATE_R => NULL ()
  Z_YDMF_PHYS_BASE_STATE_S => NULL ()
  Z_YDMF_PHYS_OUT_FCQLNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQNNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQRNG => NULL ()
  Z_YDMF_PHYS_OUT_FCQSNG => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_INIT_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:4',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART5', 1, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART6', 0, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_INIT_PARALLEL:5')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KMOC_CLPH => GET_HOST_DATA_RDWR (YD_KMOC_CLPH)
  PAER => GET_HOST_DATA_RDWR (YD_PAER)
  PAERINDS => GET_HOST_DATA_RDWR (YD_PAERINDS)
  PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
  PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
  PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
  PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
  PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
  PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
  PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
  PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
  PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
  PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
  PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
  PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JCHA, JLEV, JLON, JSG) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    DO JCHA=1, 6

      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

        DO JLON=1, YDCPG_OPTS%KLON
          PAER (JLON, JLEV, JCHA, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

    ENDDO


    DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG

      DO JLON=1, YDCPG_OPTS%KLON
        PAERINDS (JLON, JLEV, JBLK)=0.0_JPRB
      ENDDO

    ENDDO


    DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
      PCEMTR (JLON, 0, JBLK)=0.0_JPRB
      PCEMTR (JLON, 1, JBLK)=0.0_JPRB
      PCTRSO (JLON, 0, JBLK)=0.0_JPRB
      PCTRSO (JLON, 1, JBLK)=0.0_JPRB
      PTRSOD (JLON, JBLK)=0.0_JPRB
      PSUDU (JLON, JBLK)=0.0_JPRB
      PXDROV (JLON, JBLK)=1.0_JPRB
      PXHROV (JLON, JBLK)=1.0_JPRB
      KMOC_CLPH (JLON, JBLK)=YDCPG_OPTS%KFLEVG
    ENDDO


    DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW

      DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
        PALBD (JLON, JSG, JBLK)=0.0_JPRB
        PALBP (JLON, JSG, JBLK)=0.0_JPRB
        PSFSWDIF (JLON, JSG, JBLK)=0.0_JPRB
        PSFSWDIR (JLON, JSG, JBLK)=0.0_JPRB
        PTRSODIF (JLON, JSG, JBLK)=0.0_JPRB
        PTRSODIR (JLON, JSG, JBLK)=0.0_JPRB
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:5')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KMOC_CLPH => GET_HOST_DATA_RDWR (YD_KMOC_CLPH)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PAERINDS => GET_HOST_DATA_RDWR (YD_PAERINDS)
    PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
    PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
    PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
    PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
    PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KMOC_CLPH => NULL ()
  PAER => NULL ()
  PAERINDS => NULL ()
  PALBD => NULL ()
  PALBP => NULL ()
  PCEMTR => NULL ()
  PCTRSO => NULL ()
  PSFSWDIF => NULL ()
  PSFSWDIR => NULL ()
  PSUDU => NULL ()
  PTRSOD => NULL ()
  PTRSODIF => NULL ()
  PTRSODIR => NULL ()
  PXDROV => NULL ()
  PXHROV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:5')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KMOC_CLPH => GET_HOST_DATA_RDWR (YD_KMOC_CLPH)
  PAER => GET_HOST_DATA_RDWR (YD_PAER)
  PAERINDS => GET_HOST_DATA_RDWR (YD_PAERINDS)
  PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
  PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
  PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
  PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
  PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
  PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
  PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
  PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
  PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
  PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
  PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
  PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JCHA, JLEV, JLON, JSG, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JCHA=1, 6

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          PAER (JLON, JLEV, JCHA, JBLK)=0.0_JPRB
        
        ENDDO

      ENDDO


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        PAERINDS (JLON, JLEV, JBLK)=0.0_JPRB
      
      ENDDO

      
      PCEMTR (JLON, 0, JBLK)=0.0_JPRB
      PCEMTR (JLON, 1, JBLK)=0.0_JPRB
      PCTRSO (JLON, 0, JBLK)=0.0_JPRB
      PCTRSO (JLON, 1, JBLK)=0.0_JPRB
      PTRSOD (JLON, JBLK)=0.0_JPRB
      PSUDU (JLON, JBLK)=0.0_JPRB
      PXDROV (JLON, JBLK)=1.0_JPRB
      PXHROV (JLON, JBLK)=1.0_JPRB
      KMOC_CLPH (JLON, JBLK)=YDCPG_OPTS%KFLEVG

      

      DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
        
        PALBD (JLON, JSG, JBLK)=0.0_JPRB
        PALBP (JLON, JSG, JBLK)=0.0_JPRB
        PSFSWDIF (JLON, JSG, JBLK)=0.0_JPRB
        PSFSWDIR (JLON, JSG, JBLK)=0.0_JPRB
        PTRSODIF (JLON, JSG, JBLK)=0.0_JPRB
        PTRSODIR (JLON, JSG, JBLK)=0.0_JPRB
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:5')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KMOC_CLPH => GET_HOST_DATA_RDWR (YD_KMOC_CLPH)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PAERINDS => GET_HOST_DATA_RDWR (YD_PAERINDS)
    PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
    PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
    PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
    PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
    PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KMOC_CLPH => NULL ()
  PAER => NULL ()
  PAERINDS => NULL ()
  PALBD => NULL ()
  PALBP => NULL ()
  PCEMTR => NULL ()
  PCTRSO => NULL ()
  PSFSWDIF => NULL ()
  PSFSWDIR => NULL ()
  PSUDU => NULL ()
  PTRSOD => NULL ()
  PTRSODIF => NULL ()
  PTRSODIR => NULL ()
  PXDROV => NULL ()
  PXHROV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:5')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KMOC_CLPH => GET_DEVICE_DATA_RDWR (YD_KMOC_CLPH)
  PAER => GET_DEVICE_DATA_RDWR (YD_PAER)
  PAERINDS => GET_DEVICE_DATA_RDWR (YD_PAERINDS)
  PALBD => GET_DEVICE_DATA_RDWR (YD_PALBD)
  PALBP => GET_DEVICE_DATA_RDWR (YD_PALBP)
  PCEMTR => GET_DEVICE_DATA_RDWR (YD_PCEMTR)
  PCTRSO => GET_DEVICE_DATA_RDWR (YD_PCTRSO)
  PSFSWDIF => GET_DEVICE_DATA_RDWR (YD_PSFSWDIF)
  PSFSWDIR => GET_DEVICE_DATA_RDWR (YD_PSFSWDIR)
  PSUDU => GET_DEVICE_DATA_RDWR (YD_PSUDU)
  PTRSOD => GET_DEVICE_DATA_RDWR (YD_PTRSOD)
  PTRSODIF => GET_DEVICE_DATA_RDWR (YD_PTRSODIF)
  PTRSODIR => GET_DEVICE_DATA_RDWR (YD_PTRSODIR)
  PXDROV => GET_DEVICE_DATA_RDWR (YD_PXDROV)
  PXHROV => GET_DEVICE_DATA_RDWR (YD_PXHROV)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (KMOC_CLPH, PAER, PAERINDS, PALBD, PALBP, PCEMTR, PCTRSO, PSFSWDIF, &
    !$ACC&         PSFSWDIR, PSUDU, PTRSOD, PTRSODIF, PTRSODIR, PXDROV, PXHROV, YDCPG_OPTS, &
    !$ACC&         YDMODEL, YFXTRAN_ACDC_STACK) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JCHA, JLEV, JLON, JSG, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      DO JCHA=1, 6

        DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
          
          PAER (JLON, JLEV, JCHA, JBLK)=0.0_JPRB
        
        ENDDO

      ENDDO


      DO JLEV=YDCPG_OPTS%KTDIA, YDCPG_OPTS%KFLEVG
        
        PAERINDS (JLON, JLEV, JBLK)=0.0_JPRB
      
      ENDDO

      
      PCEMTR (JLON, 0, JBLK)=0.0_JPRB
      PCEMTR (JLON, 1, JBLK)=0.0_JPRB
      PCTRSO (JLON, 0, JBLK)=0.0_JPRB
      PCTRSO (JLON, 1, JBLK)=0.0_JPRB
      PTRSOD (JLON, JBLK)=0.0_JPRB
      PSUDU (JLON, JBLK)=0.0_JPRB
      PXDROV (JLON, JBLK)=1.0_JPRB
      PXHROV (JLON, JBLK)=1.0_JPRB
      KMOC_CLPH (JLON, JBLK)=YDCPG_OPTS%KFLEVG

      

      DO JSG=1, YDMODEL%YRML_PHY_RAD%YRERAD%NSW
        
        PALBD (JLON, JSG, JBLK)=0.0_JPRB
        PALBP (JLON, JSG, JBLK)=0.0_JPRB
        PSFSWDIF (JLON, JSG, JBLK)=0.0_JPRB
        PSFSWDIR (JLON, JSG, JBLK)=0.0_JPRB
        PTRSODIF (JLON, JSG, JBLK)=0.0_JPRB
        PTRSODIR (JLON, JSG, JBLK)=0.0_JPRB
      
      ENDDO

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:5')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KMOC_CLPH => GET_HOST_DATA_RDWR (YD_KMOC_CLPH)
    PAER => GET_HOST_DATA_RDWR (YD_PAER)
    PAERINDS => GET_HOST_DATA_RDWR (YD_PAERINDS)
    PALBD => GET_HOST_DATA_RDWR (YD_PALBD)
    PALBP => GET_HOST_DATA_RDWR (YD_PALBP)
    PCEMTR => GET_HOST_DATA_RDWR (YD_PCEMTR)
    PCTRSO => GET_HOST_DATA_RDWR (YD_PCTRSO)
    PSFSWDIF => GET_HOST_DATA_RDWR (YD_PSFSWDIF)
    PSFSWDIR => GET_HOST_DATA_RDWR (YD_PSFSWDIR)
    PSUDU => GET_HOST_DATA_RDWR (YD_PSUDU)
    PTRSOD => GET_HOST_DATA_RDWR (YD_PTRSOD)
    PTRSODIF => GET_HOST_DATA_RDWR (YD_PTRSODIF)
    PTRSODIR => GET_HOST_DATA_RDWR (YD_PTRSODIR)
    PXDROV => GET_HOST_DATA_RDWR (YD_PXDROV)
    PXHROV => GET_HOST_DATA_RDWR (YD_PXHROV)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KMOC_CLPH => NULL ()
  PAER => NULL ()
  PAERINDS => NULL ()
  PALBD => NULL ()
  PALBP => NULL ()
  PCEMTR => NULL ()
  PCTRSO => NULL ()
  PSFSWDIF => NULL ()
  PSFSWDIR => NULL ()
  PSUDU => NULL ()
  PTRSOD => NULL ()
  PTRSODIF => NULL ()
  PTRSODIR => NULL ()
  PXDROV => NULL ()
  PXHROV => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_INIT_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:5',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART6', 1, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART7', 0, ZHOOK_HANDLE_1)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','APL_ARPEGE_INIT_PARALLEL:6')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
  PPFL_FPLSH => GET_HOST_DATA_RDWR (YD_PPFL_FPLSH)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)

    

    IF ((YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF&
      &%YRPHY%LRRGUST).AND.YDCPG_OPTS%NSTEP==0) THEN

      DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PPFL_FPLCH (JLON, JLEV, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

    ENDIF


    IF (YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST.AND.YDCPG_OPTS%NSTEP==0) THEN

      DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG

        DO JLON=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          PPFL_FPLSH (JLON, JLEV, JBLK)=0.0_JPRB
        ENDDO

      ENDDO

    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:6')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PPFL_FPLSH => GET_HOST_DATA_RDWR (YD_PPFL_FPLSH)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPFL_FPLCH => NULL ()
  PPFL_FPLSH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:6')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
  PPFL_FPLSH => GET_HOST_DATA_RDWR (YD_PPFL_FPLSH)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF ((YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF&
        &%YRPHY%LRRGUST).AND.YDCPG_OPTS%NSTEP==0) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          PPFL_FPLCH (JLON, JLEV, JBLK)=0.0_JPRB
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST.AND.YDCPG_OPTS%NSTEP==0) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          PPFL_FPLSH (JLON, JLEV, JBLK)=0.0_JPRB
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:6')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PPFL_FPLSH => GET_HOST_DATA_RDWR (YD_PPFL_FPLSH)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPFL_FPLCH => NULL ()
  PPFL_FPLSH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','APL_ARPEGE_INIT_PARALLEL:6')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  PPFL_FPLCH => GET_DEVICE_DATA_RDWR (YD_PPFL_FPLCH)
  PPFL_FPLSH => GET_DEVICE_DATA_RDWR (YD_PPFL_FPLSH)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (PPFL_FPLCH, PPFL_FPLSH, YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON

      

      IF ((YDMODEL%YRML_PHY_MF%YRPHY%LNEBN.OR.YDMODEL%YRML_PHY_MF&
        &%YRPHY%LRRGUST).AND.YDCPG_OPTS%NSTEP==0) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          PPFL_FPLCH (JLON, JLEV, JBLK)=0.0_JPRB
        
        ENDDO

      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LRRGUST.AND.YDCPG_OPTS%NSTEP==0) THEN

        DO JLEV=YDCPG_OPTS%KTDIA-1, YDCPG_OPTS%KFLEVG
          
          PPFL_FPLSH (JLON, JLEV, JBLK)=0.0_JPRB
        
        ENDDO

      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('APL_ARPEGE_INIT_PARALLEL:6')) THEN
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    PPFL_FPLCH => GET_HOST_DATA_RDWR (YD_PPFL_FPLCH)
    PPFL_FPLSH => GET_HOST_DATA_RDWR (YD_PPFL_FPLSH)
    IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  PPFL_FPLCH => NULL ()
  PPFL_FPLSH => NULL ()
  IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('APL_ARPEGE_INIT_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:6',1,ZHOOK_HANDLE_PARALLEL)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL:PART7', 1, ZHOOK_HANDLE_1)


CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZIPOI)) CALL FIELD_DELETE (YL_ZIPOI)
IF (ASSOCIATED (YL_ZROZ)) CALL FIELD_DELETE (YL_ZROZ)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('APL_ARPEGE_INIT_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE APL_ARPEGE_INIT_PARALLEL
