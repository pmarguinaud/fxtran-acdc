SUBMODULE (YEMDYN) YEMDYN_TEDYN_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TEDYN (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TEDYN), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LRDIVORE = ALLOCATED (SELF%RDIVORE)
IF (LRDIVORE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIVORE)
  !$ACC EXIT DATA DELETE (SELF%RDIVORE)
ENDIF

LRDIDIVE = ALLOCATED (SELF%RDIDIVE)
IF (LRDIDIVE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIDIVE)
  !$ACC EXIT DATA DELETE (SELF%RDIDIVE)
ENDIF

LRDITE = ALLOCATED (SELF%RDITE)
IF (LRDITE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDITE)
  !$ACC EXIT DATA DELETE (SELF%RDITE)
ENDIF

LRDIGFLE = ALLOCATED (SELF%RDIGFLE)
IF (LRDIGFLE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIGFLE)
  !$ACC EXIT DATA DELETE (SELF%RDIGFLE)
ENDIF

LRDIPDE = ALLOCATED (SELF%RDIPDE)
IF (LRDIPDE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIPDE)
  !$ACC EXIT DATA DELETE (SELF%RDIPDE)
ENDIF

LRDIVDE = ALLOCATED (SELF%RDIVDE)
IF (LRDIVDE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIVDE)
  !$ACC EXIT DATA DELETE (SELF%RDIVDE)
ENDIF

LRDISPE = ALLOCATED (SELF%RDISPE)
IF (LRDISPE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDISPE)
  !$ACC EXIT DATA DELETE (SELF%RDISPE)
ENDIF

LRDSVORE = ALLOCATED (SELF%RDSVORE)
IF (LRDSVORE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDSVORE)
  !$ACC EXIT DATA DELETE (SELF%RDSVORE)
ENDIF

LRDSDIVE = ALLOCATED (SELF%RDSDIVE)
IF (LRDSDIVE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDSDIVE)
  !$ACC EXIT DATA DELETE (SELF%RDSDIVE)
ENDIF

LRDSVDE = ALLOCATED (SELF%RDSVDE)
IF (LRDSVDE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDSVDE)
  !$ACC EXIT DATA DELETE (SELF%RDSVDE)
ENDIF

LREFILV = ALLOCATED (SELF%REFILV)
IF (LREFILV) THEN
  !$ACC EXIT DATA DETACH (SELF%REFILV)
  !$ACC EXIT DATA DELETE (SELF%REFILV)
ENDIF

LREFILD = ALLOCATED (SELF%REFILD)
IF (LREFILD) THEN
  !$ACC EXIT DATA DETACH (SELF%REFILD)
  !$ACC EXIT DATA DELETE (SELF%REFILD)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
