
SUBROUTINE LARCINB_PARALLEL (YDGEOMETRY, YDVARS, YDLDDH, YDMDDH, YDML_GCONF, YDML_DYN&
&, YDCPG_OPTS, YDCPG_BNDS, KASLB1, KHVI, LDSLPHY, LD2TLFF1, YD_KL0, YD_KLH0, YD_PLSCAW&
&, YD_PRSCAW, YDCPG_SL1, YD_KNOWENO, YDCPG_DDH_TND, YDCPG_GMVF, YDCPG_GMVF_SI, YDCPG_GMVF_NL&
&, YDCPG_GFLF, YD_PDP, YD_PCF, YD_PCF_SI, YD_PCF_NL, YD_PUFZ, YD_PVFZ, YD_PUPF, YD_PVPF&
&, YD_PTPF, YDCPG_GFLPF, YD_PDBBCF, YD_PDPHIF, YD_PGWSF)
USE MODEL_DYNAMICS_MOD,ONLY:MODEL_DYNAMICS_TYPE
USE MODEL_GENERAL_CONF_MOD,ONLY:MODEL_GENERAL_CONF_TYPE
USE GEOMETRY_MOD,ONLY:GEOMETRY

USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE YOMLDDH,ONLY:TLDDH
USE YOMMDDH,ONLY:TMDDH
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1F_TYPE
USE CPG_DDH_TND_TYPE_MOD,ONLY:CPG_DDH_TND_TYPE
USE CPG_GMV_TYPE_MOD,ONLY:CPG_GMV_TYPE
USE CPG_GFL_TYPE_MOD,ONLY:CPG_GFL_TYPE, CPG_GFLSL_TYPE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (TLDDH), INTENT (IN)::YDLDDH
TYPE (TMDDH), INTENT (IN)::YDMDDH
TYPE (MODEL_DYNAMICS_TYPE), INTENT (IN)::YDML_DYN
TYPE (MODEL_GENERAL_CONF_TYPE), INTENT (IN)::YDML_GCONF
INTEGER (KIND=JPIM), INTENT (IN)::KHVI
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
INTEGER (KIND=JPIM), INTENT (IN)::KASLB1
LOGICAL, INTENT (IN)::LDSLPHY
LOGICAL, INTENT (IN)::LD2TLFF1
CLASS (FIELD_4IM), POINTER :: YD_KL0
INTEGER (KIND=JPIM), POINTER::KL0 (:,:,:,:)
CLASS (FIELD_4IM), POINTER :: YD_KLH0
INTEGER (KIND=JPIM), POINTER::KLH0 (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PLSCAW
REAL (KIND=JPRB), POINTER::PLSCAW (:,:,:,:)
CLASS (FIELD_4RB), POINTER :: YD_PRSCAW
REAL (KIND=JPRB), POINTER::PRSCAW (:,:,:,:)
TYPE (CPG_SL1F_TYPE), INTENT (IN)::YDCPG_SL1
CLASS (FIELD_3IM), POINTER :: YD_KNOWENO
INTEGER (KIND=JPIM), POINTER::KNOWENO (:,:,:)
TYPE (CPG_DDH_TND_TYPE), INTENT (INOUT)::YDCPG_DDH_TND
TYPE (CPG_GMV_TYPE), INTENT (INOUT)::YDCPG_GMVF
TYPE (CPG_GMV_TYPE), INTENT (INOUT)::YDCPG_GMVF_SI
TYPE (CPG_GMV_TYPE), INTENT (INOUT)::YDCPG_GMVF_NL
TYPE (CPG_GFL_TYPE), INTENT (INOUT)::YDCPG_GFLF
CLASS (FIELD_3RB), POINTER :: YD_PDP
REAL (KIND=JPRB), POINTER::PDP (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCF
REAL (KIND=JPRB), POINTER::PCF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCF_SI
REAL (KIND=JPRB), POINTER::PCF_SI (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PCF_NL
REAL (KIND=JPRB), POINTER::PCF_NL (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PUFZ
REAL (KIND=JPRB), POINTER::PUFZ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PVFZ
REAL (KIND=JPRB), POINTER::PVFZ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PUPF
REAL (KIND=JPRB), POINTER::PUPF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PVPF
REAL (KIND=JPRB), POINTER::PVPF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YD_PTPF
REAL (KIND=JPRB), POINTER::PTPF (:,:,:)
TYPE (CPG_GFLSL_TYPE), INTENT (INOUT)::YDCPG_GFLPF
CLASS (FIELD_2RB), POINTER :: YD_PDBBCF
REAL (KIND=JPRB), POINTER::PDBBCF (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PDPHIF
REAL (KIND=JPRB), POINTER::PDPHIF (:,:)
CLASS (FIELD_2RB), POINTER :: YD_PGWSF
REAL (KIND=JPRB), POINTER::PGWSF (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGMVF
REAL (KIND=JPRB), POINTER::ZGMVF (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGMVU
REAL (KIND=JPRB), POINTER::ZGMVU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGMVV
REAL (KIND=JPRB), POINTER::ZGMVV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGMVZ
REAL (KIND=JPRB), POINTER::ZGMVZ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGMVFU
REAL (KIND=JPRB), POINTER::ZGMVFU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGMVFV
REAL (KIND=JPRB), POINTER::ZGMVFV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGMVFZ
REAL (KIND=JPRB), POINTER::ZGMVFZ (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZGFLF
REAL (KIND=JPRB), POINTER::ZGFLF (:,:,:)
INTEGER (KIND=JPIM)::IFLDX
INTEGER (KIND=JPIM)::IFLDN
INTEGER (KIND=JPIM)::IPSPL
INTEGER (KIND=JPIM)::IP
INTEGER (KIND=JPIM)::JFLD
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::ICLA
INTEGER (KIND=JPIM)::ICLO
INTEGER (KIND=JPIM)::IDLO
INTEGER (KIND=JPIM)::IQM
INTEGER (KIND=JPIM)::IWKGFL
INTEGER (KIND=JPIM)::IWKH
INTEGER (KIND=JPIM)::IWKM
INTEGER (KIND=JPIM)::IWNT
INTEGER (KIND=JPIM)::IWK
CHARACTER (LEN=12)::CLINT
LOGICAL::LLCOMAD
LOGICAL::LLHOI2
LOGICAL::LLNOSLHD
LOGICAL::LL_LIN
LOGICAL::LLMOM
LOGICAL::LL3
LOGICAL::LL2
LOGICAL::LL1
#include "laitlif.intfb.h"
#include "abor1.intfb.h"
#include "laitlif_openacc.intfb.h"
#include "laiddi.intfb.h"
#include "laiddi_openacc.intfb.h"
#include "laidli.intfb.h"
#include "laidli_openacc.intfb.h"
#include "laitre_gmv.intfb.h"
#include "laitre_gmv_openacc.intfb.h"
#include "laitre_gfl.intfb.h"
#include "laitre_gfl_openacc.intfb.h"
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL(KIND=JPRB), POINTER :: Z_YDCPG_DDH_TND_YSI_T_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_DDH_TND_YSI_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDCPG_DDH_TND_YSI_V_T0(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DDH_TND_YSL_GFL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DDH_TND_YSL_T_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DDH_TND_YSL_U_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_DDH_TND_YSL_V_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GFLF_GFL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GFLPF_GFL_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_NL_T_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_NL_U_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_NL_V_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_SI_T_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_SI_U_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_SI_V_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_T_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_U_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_GMVF_V_P(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_C9_NL_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_C9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_C9_SI_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_GFL_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_GFL_P_F(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_GFL_P_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_GFL_P_SP(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_GFL_P_SPF(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_SP9_P(:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T0_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T9_NL_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_T9_SI_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_TF9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_TP9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U0_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U9_NL_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_U9_SI_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_UF9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_UP9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_UR9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V0_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V9_NL_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_V9_SI_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VF9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VP9_P(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL1_VR9_P(:,:)
IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZGMVZ, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMVV, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMVU, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMVFZ, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMVFV, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMVFU, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMVF, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGFLF, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)


LLNOSLHD=.FALSE.
IWNT=1
IWKGFL=1

IF (YDML_DYN%YRDYNA%L3DTURB) THEN
  IWKM=2
  IWKH=3
ELSE
  IWKM=1
  IWKH=1
ENDIF


IF (YDML_DYN%YRDYNA%LPC_FULL.AND.YDML_DYN%YRDYNA%LPC_CHEAP2.AND&
  &.(YDML_DYN%YRDYN%NCURRENT_ITER<YDML_DYN%YRDYN%NSITER)) THEN
  LL_LIN=.TRUE.
ELSE
  LL_LIN=YDML_DYN%YRDYNA%NQMGMV==-4
ENDIF

IFLDN=YDGEOMETRY%YRDIMV%NFLSA
IFLDX=YDGEOMETRY%YRDIMV%NFLEN

IF (YDML_DYN%YRDYN%LRHS_CURV) THEN
  
  
  
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSE
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LRHS_CURV_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
    PUFZ => GET_HOST_DATA_RDWR (YD_PUFZ)
    PUPF => GET_HOST_DATA_RDWR (YD_PUPF)
    PVFZ => GET_HOST_DATA_RDWR (YD_PVFZ)
    PVPF => GET_HOST_DATA_RDWR (YD_PVPF)
    Z_YDCPG_DDH_TND_YSI_U_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%U%FT0)
    Z_YDCPG_DDH_TND_YSI_V_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%V%FT0)
    Z_YDCPG_DDH_TND_YSL_U_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%U%F_P)
    Z_YDCPG_DDH_TND_YSL_V_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%V%F_P)
    Z_YDCPG_GMVF_NL_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%U%F_P)
    Z_YDCPG_GMVF_NL_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%V%F_P)
    Z_YDCPG_GMVF_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%U%F_P)
    Z_YDCPG_GMVF_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%V%F_P)
    Z_YDCPG_GMVF_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%U%F_P)
    Z_YDCPG_GMVF_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%V%F_P)
    Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U9_NL%F_P)
    Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UF9%F_P)
    Z_YDCPG_SL1_UP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UP9%F_P)
    Z_YDCPG_SL1_UR9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UR9%F_P)
    Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V9_NL%F_P)
    Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VF9%F_P)
    Z_YDCPG_SL1_VP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VP9%F_P)
    Z_YDCPG_SL1_VR9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VR9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (IWK, JBLK, JLEV, JROF, LLHOI2, LLMOM) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      LLMOM=.TRUE.
      CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
      &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN%YRDYNA&
      &%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
      &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:&
      &, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK))

      IF (YDLDDH%LRSLDDH) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDCPG_DDH_TND_YSL_U_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_U_P&
            & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_U_P (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

      ENDIF


      IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NWLAG<4)) THEN

        IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
          LLHOI2=LLNOSLHD
          IWK=YDML_DYN%YRDYN%NSLDIMK
        ELSE
          LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
          IWK=IWKM
        ENDIF

        CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
        & YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_W, LLHOI2, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM, YDML_DYN&
        &%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW&
        &(:,:,:, JBLK), Z_YDCPG_SL1_UF9_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK), LDADD=.TRUE.)
      ENDIF


      IF (YDML_DYN%YRDYN%NWLAG>=3) THEN

        IF (LD2TLFF1) THEN
          CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
          &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W&
          &, LLMOM, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW&
          &(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_UR9_P(:,:), PUFZ(:,:, JBLK))
        ELSE
          PUFZ (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDCPG_GMVF_U_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
        ENDIF

        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW&
        &(:,:,:, JBLK), Z_YDCPG_SL1_U0_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK), LDADD=.TRUE.)

        IF (YDLDDH%LRSIDDH) THEN
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
          & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,&
          &:,:, JBLK), Z_YDCPG_SL1_U9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_U_T0(:,:, JBLK), LDADD=.TRUE.)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW&
          &(:,:,:, JBLK), Z_YDCPG_SL1_U9_SI_P(:,:), Z_YDCPG_GMVF_SI_U_P(:,:, JBLK))
        ENDIF


        IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW&
          &(:,:,:, JBLK), Z_YDCPG_SL1_U9_NL_P(:,:), Z_YDCPG_GMVF_NL_U_P(:,:, JBLK))
        ENDIF

      ENDIF


      IF (LDSLPHY) THEN
        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA&
        &%LCOMAD_W, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_UP9_P(:,:), PUPF(:,:, JBLK))
      ENDIF

      LLMOM=.TRUE.
      CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
      &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN%YRDYNA&
      &%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
      &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:&
      &, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK))

      IF (YDLDDH%LRSLDDH) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

          DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
            Z_YDCPG_DDH_TND_YSL_V_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_V_P&
            & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_V_P (JROF, JLEV, JBLK)
          ENDDO

        ENDDO

      ENDIF


      IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NWLAG<4)) THEN

        IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
          LLHOI2=LLNOSLHD
          IWK=YDML_DYN%YRDYN%NSLDIMK
        ELSE
          LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
          IWK=IWKM
        ENDIF

        CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
        & YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_W, LLHOI2, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM, YDML_DYN&
        &%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW&
        &(:,:,:, JBLK), Z_YDCPG_SL1_VF9_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK), LDADD=.TRUE.)
      ENDIF


      IF (YDML_DYN%YRDYN%NWLAG>=3) THEN

        IF (LD2TLFF1) THEN
          CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
          &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W&
          &, LLMOM, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW&
          &(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_VR9_P(:,:), PVFZ(:,:, JBLK))
        ELSE
          PVFZ (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDCPG_GMVF_V_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
        ENDIF

        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW&
        &(:,:,:, JBLK), Z_YDCPG_SL1_V0_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK), LDADD=.TRUE.)

        IF (YDLDDH%LRSIDDH) THEN
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
          & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,&
          &:,:, JBLK), Z_YDCPG_SL1_V9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_V_T0(:,:, JBLK), LDADD=.TRUE.)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW&
          &(:,:,:, JBLK), Z_YDCPG_SL1_V9_SI_P(:,:), Z_YDCPG_GMVF_SI_V_P(:,:, JBLK))
        ENDIF


        IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW&
          &(:,:,:, JBLK), Z_YDCPG_SL1_V9_NL_P(:,:), Z_YDCPG_GMVF_NL_V_P(:,:, JBLK))
        ENDIF

      ENDIF


      IF (LDSLPHY) THEN
        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA&
        &%LCOMAD_W, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_VP9_P(:,:), PVPF(:,:, JBLK))
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LRHS_CURV_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      PUFZ => GET_HOST_DATA_RDWR (YD_PUFZ)
      PUPF => GET_HOST_DATA_RDWR (YD_PUPF)
      PVFZ => GET_HOST_DATA_RDWR (YD_PVFZ)
      PVPF => GET_HOST_DATA_RDWR (YD_PVPF)
      Z_YDCPG_DDH_TND_YSI_U_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%U%FT0)
      Z_YDCPG_DDH_TND_YSI_V_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%V%FT0)
      Z_YDCPG_DDH_TND_YSL_U_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%U%F_P)
      Z_YDCPG_DDH_TND_YSL_V_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%V%F_P)
      Z_YDCPG_GMVF_NL_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%U%F_P)
      Z_YDCPG_GMVF_NL_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%V%F_P)
      Z_YDCPG_GMVF_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%U%F_P)
      Z_YDCPG_GMVF_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%V%F_P)
      Z_YDCPG_GMVF_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%U%F_P)
      Z_YDCPG_GMVF_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%V%F_P)
      Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
      Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
      Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
      Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
      Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
      Z_YDCPG_SL1_UP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UP9%F_P)
      Z_YDCPG_SL1_UR9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UR9%F_P)
      Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
      Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
      Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
      Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
      Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
      Z_YDCPG_SL1_VP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VP9%F_P)
      Z_YDCPG_SL1_VR9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VR9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    KNOWENO => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    PUFZ => NULL ()
    PUPF => NULL ()
    PVFZ => NULL ()
    PVPF => NULL ()
    Z_YDCPG_DDH_TND_YSI_U_T0 => NULL ()
    Z_YDCPG_DDH_TND_YSI_V_T0 => NULL ()
    Z_YDCPG_DDH_TND_YSL_U_P => NULL ()
    Z_YDCPG_DDH_TND_YSL_V_P => NULL ()
    Z_YDCPG_GMVF_NL_U_P => NULL ()
    Z_YDCPG_GMVF_NL_V_P => NULL ()
    Z_YDCPG_GMVF_SI_U_P => NULL ()
    Z_YDCPG_GMVF_SI_V_P => NULL ()
    Z_YDCPG_GMVF_U_P => NULL ()
    Z_YDCPG_GMVF_V_P => NULL ()
    Z_YDCPG_SL1_U0_P => NULL ()
    Z_YDCPG_SL1_U9_NL_P => NULL ()
    Z_YDCPG_SL1_U9_P => NULL ()
    Z_YDCPG_SL1_U9_SI_P => NULL ()
    Z_YDCPG_SL1_UF9_P => NULL ()
    Z_YDCPG_SL1_UP9_P => NULL ()
    Z_YDCPG_SL1_UR9_P => NULL ()
    Z_YDCPG_SL1_V0_P => NULL ()
    Z_YDCPG_SL1_V9_NL_P => NULL ()
    Z_YDCPG_SL1_V9_P => NULL ()
    Z_YDCPG_SL1_V9_SI_P => NULL ()
    Z_YDCPG_SL1_VF9_P => NULL ()
    Z_YDCPG_SL1_VP9_P => NULL ()
    Z_YDCPG_SL1_VR9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LRHS_CURV_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
    PUFZ => GET_HOST_DATA_RDWR (YD_PUFZ)
    PUPF => GET_HOST_DATA_RDWR (YD_PUPF)
    PVFZ => GET_HOST_DATA_RDWR (YD_PVFZ)
    PVPF => GET_HOST_DATA_RDWR (YD_PVPF)
    Z_YDCPG_DDH_TND_YSI_U_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%U%FT0)
    Z_YDCPG_DDH_TND_YSI_V_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%V%FT0)
    Z_YDCPG_DDH_TND_YSL_U_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%U%F_P)
    Z_YDCPG_DDH_TND_YSL_V_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%V%F_P)
    Z_YDCPG_GMVF_NL_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%U%F_P)
    Z_YDCPG_GMVF_NL_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%V%F_P)
    Z_YDCPG_GMVF_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%U%F_P)
    Z_YDCPG_GMVF_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%V%F_P)
    Z_YDCPG_GMVF_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%U%F_P)
    Z_YDCPG_GMVF_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%V%F_P)
    Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U9_NL%F_P)
    Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UF9%F_P)
    Z_YDCPG_SL1_UP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UP9%F_P)
    Z_YDCPG_SL1_UR9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%UR9%F_P)
    Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V9_NL%F_P)
    Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VF9%F_P)
    Z_YDCPG_SL1_VP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VP9%F_P)
    Z_YDCPG_SL1_VR9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%VR9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (IWK, JBLK, JLEV, JROF, LLHOI2, LLMOM, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        LLMOM=.TRUE.
        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
        &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
        &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDLDDH%LRSLDDH) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDCPG_DDH_TND_YSL_U_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_U_P&
            & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_U_P (JROF, JLEV, JBLK)
          
          ENDDO

        ENDIF


        IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NWLAG<4)) THEN

          IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
            LLHOI2=LLNOSLHD
            IWK=YDML_DYN%YRDYN%NSLDIMK
          ELSE
            LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
            IWK=IWKM
          ENDIF

          CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
          &%YRDYNA%LCOMAD_W, LLHOI2, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM, YDML_DYN%YRDYN&
          &%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
          &:, JBLK), Z_YDCPG_SL1_UF9_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYN%NWLAG>=3) THEN

          IF (LD2TLFF1) THEN
            CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
            &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
            &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
            &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
            &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_UR9_P(:,:), PUFZ(:,:, JBLK),YDSTACK=YLSTACK)
          ELSE
            PUFZ (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDCPG_GMVF_U_P&
            & (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
          ENDIF

          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:,&
          & JBLK), Z_YDCPG_SL1_U0_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)

          IF (YDLDDH%LRSIDDH) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
            & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_U9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_U_T0(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_U9_SI_P(:,:), Z_YDCPG_GMVF_SI_U_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_U9_NL_P(:,:), Z_YDCPG_GMVF_NL_U_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF

        ENDIF


        IF (LDSLPHY) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_UP9_P(:,:), PUPF(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

        LLMOM=.TRUE.
        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
        &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
        &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDLDDH%LRSLDDH) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDCPG_DDH_TND_YSL_V_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_V_P&
            & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_V_P (JROF, JLEV, JBLK)
          
          ENDDO

        ENDIF


        IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NWLAG<4)) THEN

          IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
            LLHOI2=LLNOSLHD
            IWK=YDML_DYN%YRDYN%NSLDIMK
          ELSE
            LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
            IWK=IWKM
          ENDIF

          CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
          &%YRDYNA%LCOMAD_W, LLHOI2, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM, YDML_DYN%YRDYN&
          &%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
          &:, JBLK), Z_YDCPG_SL1_VF9_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYN%NWLAG>=3) THEN

          IF (LD2TLFF1) THEN
            CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
            &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
            &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
            &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
            &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_VR9_P(:,:), PVFZ(:,:, JBLK),YDSTACK=YLSTACK)
          ELSE
            PVFZ (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)=Z_YDCPG_GMVF_V_P&
            & (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK)
          ENDIF

          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:,&
          & JBLK), Z_YDCPG_SL1_V0_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)

          IF (YDLDDH%LRSIDDH) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
            & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_V9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_V_T0(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_V9_SI_P(:,:), Z_YDCPG_GMVF_SI_V_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_V9_NL_P(:,:), Z_YDCPG_GMVF_NL_V_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF

        ENDIF


        IF (LDSLPHY) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_VP9_P(:,:), PVPF(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LRHS_CURV_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      PUFZ => GET_HOST_DATA_RDWR (YD_PUFZ)
      PUPF => GET_HOST_DATA_RDWR (YD_PUPF)
      PVFZ => GET_HOST_DATA_RDWR (YD_PVFZ)
      PVPF => GET_HOST_DATA_RDWR (YD_PVPF)
      Z_YDCPG_DDH_TND_YSI_U_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%U%FT0)
      Z_YDCPG_DDH_TND_YSI_V_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%V%FT0)
      Z_YDCPG_DDH_TND_YSL_U_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%U%F_P)
      Z_YDCPG_DDH_TND_YSL_V_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%V%F_P)
      Z_YDCPG_GMVF_NL_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%U%F_P)
      Z_YDCPG_GMVF_NL_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%V%F_P)
      Z_YDCPG_GMVF_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%U%F_P)
      Z_YDCPG_GMVF_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%V%F_P)
      Z_YDCPG_GMVF_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%U%F_P)
      Z_YDCPG_GMVF_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%V%F_P)
      Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
      Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
      Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
      Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
      Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
      Z_YDCPG_SL1_UP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UP9%F_P)
      Z_YDCPG_SL1_UR9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UR9%F_P)
      Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
      Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
      Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
      Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
      Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
      Z_YDCPG_SL1_VP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VP9%F_P)
      Z_YDCPG_SL1_VR9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VR9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    KNOWENO => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    PUFZ => NULL ()
    PUPF => NULL ()
    PVFZ => NULL ()
    PVPF => NULL ()
    Z_YDCPG_DDH_TND_YSI_U_T0 => NULL ()
    Z_YDCPG_DDH_TND_YSI_V_T0 => NULL ()
    Z_YDCPG_DDH_TND_YSL_U_P => NULL ()
    Z_YDCPG_DDH_TND_YSL_V_P => NULL ()
    Z_YDCPG_GMVF_NL_U_P => NULL ()
    Z_YDCPG_GMVF_NL_V_P => NULL ()
    Z_YDCPG_GMVF_SI_U_P => NULL ()
    Z_YDCPG_GMVF_SI_V_P => NULL ()
    Z_YDCPG_GMVF_U_P => NULL ()
    Z_YDCPG_GMVF_V_P => NULL ()
    Z_YDCPG_SL1_U0_P => NULL ()
    Z_YDCPG_SL1_U9_NL_P => NULL ()
    Z_YDCPG_SL1_U9_P => NULL ()
    Z_YDCPG_SL1_U9_SI_P => NULL ()
    Z_YDCPG_SL1_UF9_P => NULL ()
    Z_YDCPG_SL1_UP9_P => NULL ()
    Z_YDCPG_SL1_UR9_P => NULL ()
    Z_YDCPG_SL1_V0_P => NULL ()
    Z_YDCPG_SL1_V9_NL_P => NULL ()
    Z_YDCPG_SL1_V9_P => NULL ()
    Z_YDCPG_SL1_V9_SI_P => NULL ()
    Z_YDCPG_SL1_VF9_P => NULL ()
    Z_YDCPG_SL1_VP9_P => NULL ()
    Z_YDCPG_SL1_VR9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LRHS_CURV_F')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
    KNOWENO => GET_DEVICE_DATA_RDONLY (YD_KNOWENO)
    PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_DEVICE_DATA_RDONLY (YD_PRSCAW)
    PUFZ => GET_DEVICE_DATA_RDWR (YD_PUFZ)
    PUPF => GET_DEVICE_DATA_RDWR (YD_PUPF)
    PVFZ => GET_DEVICE_DATA_RDWR (YD_PVFZ)
    PVPF => GET_DEVICE_DATA_RDWR (YD_PVPF)
    Z_YDCPG_DDH_TND_YSI_U_T0 => GET_DEVICE_DATA_RDWR (YDCPG_DDH_TND%YSI%U%FT0)
    Z_YDCPG_DDH_TND_YSI_V_T0 => GET_DEVICE_DATA_RDWR (YDCPG_DDH_TND%YSI%V%FT0)
    Z_YDCPG_DDH_TND_YSL_U_P => GET_DEVICE_DATA_RDWR (YDCPG_DDH_TND%YSL%U%F_P)
    Z_YDCPG_DDH_TND_YSL_V_P => GET_DEVICE_DATA_RDWR (YDCPG_DDH_TND%YSL%V%F_P)
    Z_YDCPG_GMVF_NL_U_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF_NL%U%F_P)
    Z_YDCPG_GMVF_NL_V_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF_NL%V%F_P)
    Z_YDCPG_GMVF_SI_U_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF_SI%U%F_P)
    Z_YDCPG_GMVF_SI_V_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF_SI%V%F_P)
    Z_YDCPG_GMVF_U_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF%U%F_P)
    Z_YDCPG_GMVF_V_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF%V%F_P)
    Z_YDCPG_SL1_U0_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%U0%F_P)
    Z_YDCPG_SL1_U9_NL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%U9_NL%F_P)
    Z_YDCPG_SL1_U9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%U9%F_P)
    Z_YDCPG_SL1_U9_SI_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%U9_SI%F_P)
    Z_YDCPG_SL1_UF9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%UF9%F_P)
    Z_YDCPG_SL1_UP9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%UP9%F_P)
    Z_YDCPG_SL1_UR9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%UR9%F_P)
    Z_YDCPG_SL1_V0_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%V0%F_P)
    Z_YDCPG_SL1_V9_NL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%V9_NL%F_P)
    Z_YDCPG_SL1_V9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%V9%F_P)
    Z_YDCPG_SL1_V9_SI_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%V9_SI%F_P)
    Z_YDCPG_SL1_VF9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%VF9%F_P)
    Z_YDCPG_SL1_VP9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%VP9%F_P)
    Z_YDCPG_SL1_VR9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%VR9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (KL0, KNOWENO, PLSCAW, PRSCAW, PUFZ, PUPF, PVFZ, PVPF, YDCPG_OPTS, YDGEOMETRY, &
      !$ACC&         YDLDDH, YDML_DYN, YFXTRAN_ACDC_STACK, Z_YDCPG_DDH_TND_YSI_U_T0, &
      !$ACC&         Z_YDCPG_DDH_TND_YSI_V_T0, Z_YDCPG_DDH_TND_YSL_U_P, Z_YDCPG_DDH_TND_YSL_V_P, &
      !$ACC&         Z_YDCPG_GMVF_NL_U_P, Z_YDCPG_GMVF_NL_V_P, Z_YDCPG_GMVF_SI_U_P, &
      !$ACC&         Z_YDCPG_GMVF_SI_V_P, Z_YDCPG_GMVF_U_P, Z_YDCPG_GMVF_V_P, &
      !$ACC&         Z_YDCPG_SL1_U0_P, Z_YDCPG_SL1_U9_NL_P, Z_YDCPG_SL1_U9_P, &
      !$ACC&         Z_YDCPG_SL1_U9_SI_P, Z_YDCPG_SL1_UF9_P, Z_YDCPG_SL1_UP9_P, &
      !$ACC&         Z_YDCPG_SL1_UR9_P, Z_YDCPG_SL1_V0_P, Z_YDCPG_SL1_V9_NL_P, &
      !$ACC&         Z_YDCPG_SL1_V9_P, Z_YDCPG_SL1_V9_SI_P, Z_YDCPG_SL1_VF9_P, &
      !$ACC&         Z_YDCPG_SL1_VP9_P, Z_YDCPG_SL1_VR9_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (IWK, JLEV, JROF, LLHOI2, LLMOM, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        LLMOM=.TRUE.
        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
        &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
        &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_U9_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDLDDH%LRSLDDH) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDCPG_DDH_TND_YSL_U_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_U_P&
            & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_U_P (JROF, JLEV, JBLK)
          
          ENDDO

        ENDIF


        IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NWLAG<4)) THEN

          IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
            LLHOI2=LLNOSLHD
            IWK=YDML_DYN%YRDYN%NSLDIMK
          ELSE
            LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
            IWK=IWKM
          ENDIF

          CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
          &%YRDYNA%LCOMAD_W, LLHOI2, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM, YDML_DYN%YRDYN&
          &%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
          &:, JBLK), Z_YDCPG_SL1_UF9_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYN%NWLAG>=3) THEN

          IF (LD2TLFF1) THEN
            CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
            &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
            &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
            &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
            &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_UR9_P(:,:), PUFZ(:,:, JBLK),YDSTACK=YLSTACK)
          ELSE
            CALL FXTRAN_ACDC_ARRAY_COPY (JROF, PUFZ (:, 1:YDGEOMETRY%YRDIMV%NFLEVG&
            &, JBLK), Z_YDCPG_GMVF_U_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
          ENDIF

          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:,&
          & JBLK), Z_YDCPG_SL1_U0_P(:,:), Z_YDCPG_GMVF_U_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)

          IF (YDLDDH%LRSIDDH) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
            & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_U9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_U_T0(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_U9_SI_P(:,:), Z_YDCPG_GMVF_SI_U_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_U9_NL_P(:,:), Z_YDCPG_GMVF_NL_U_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF

        ENDIF


        IF (LDSLPHY) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_UP9_P(:,:), PUPF(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

        LLMOM=.TRUE.
        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
        &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
        &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_V9_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDLDDH%LRSLDDH) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
            
            Z_YDCPG_DDH_TND_YSL_V_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_V_P&
            & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_V_P (JROF, JLEV, JBLK)
          
          ENDDO

        ENDIF


        IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NWLAG<4)) THEN

          IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
            LLHOI2=LLNOSLHD
            IWK=YDML_DYN%YRDYN%NSLDIMK
          ELSE
            LLHOI2=YDML_DYN%YRDYNA%LSLHD_W
            IWK=IWKM
          ENDIF

          CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
          &%YRDYNA%LCOMAD_W, LLHOI2, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM, YDML_DYN%YRDYN&
          &%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
          &:, JBLK), Z_YDCPG_SL1_VF9_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYN%NWLAG>=3) THEN

          IF (LD2TLFF1) THEN
            CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
            &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKM, LL_LIN, YDML_DYN&
            &%YRDYNA%LCOMAD_W, YDML_DYN%YRDYNA%LSLHD_W, YDML_DYN%YRDYN%LVWENO_W, YDML_DYN%YRDYN%WENO_ALPHA_W, LLMOM&
            &, YDML_DYN%YRDYN%LQMW, YDML_DYN%YRDYN%LQMHW, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
            &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_VR9_P(:,:), PVFZ(:,:, JBLK),YDSTACK=YLSTACK)
          ELSE
            CALL FXTRAN_ACDC_ARRAY_COPY (JROF, PVFZ (:, 1:YDGEOMETRY%YRDIMV%NFLEVG&
            &, JBLK), Z_YDCPG_GMVF_V_P (:, 1:YDGEOMETRY%YRDIMV%NFLEVG, JBLK))
          ENDIF

          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:,&
          & JBLK), Z_YDCPG_SL1_V0_P(:,:), Z_YDCPG_GMVF_V_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)

          IF (YDLDDH%LRSIDDH) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
            & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_V9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_V_T0(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_V9_SI_P(:,:), Z_YDCPG_GMVF_SI_V_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF


          IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W, PLSCAW(:,:&
            &,:, JBLK), Z_YDCPG_SL1_V9_NL_P(:,:), Z_YDCPG_GMVF_NL_V_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDIF

        ENDIF


        IF (LDSLPHY) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_W&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_VP9_P(:,:), PVPF(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LRHS_CURV_F')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      PUFZ => GET_HOST_DATA_RDWR (YD_PUFZ)
      PUPF => GET_HOST_DATA_RDWR (YD_PUPF)
      PVFZ => GET_HOST_DATA_RDWR (YD_PVFZ)
      PVPF => GET_HOST_DATA_RDWR (YD_PVPF)
      Z_YDCPG_DDH_TND_YSI_U_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%U%FT0)
      Z_YDCPG_DDH_TND_YSI_V_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%V%FT0)
      Z_YDCPG_DDH_TND_YSL_U_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%U%F_P)
      Z_YDCPG_DDH_TND_YSL_V_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%V%F_P)
      Z_YDCPG_GMVF_NL_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%U%F_P)
      Z_YDCPG_GMVF_NL_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%V%F_P)
      Z_YDCPG_GMVF_SI_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%U%F_P)
      Z_YDCPG_GMVF_SI_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%V%F_P)
      Z_YDCPG_GMVF_U_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%U%F_P)
      Z_YDCPG_GMVF_V_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%V%F_P)
      Z_YDCPG_SL1_U0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U0%F_P)
      Z_YDCPG_SL1_U9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_NL%F_P)
      Z_YDCPG_SL1_U9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9%F_P)
      Z_YDCPG_SL1_U9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%U9_SI%F_P)
      Z_YDCPG_SL1_UF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UF9%F_P)
      Z_YDCPG_SL1_UP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UP9%F_P)
      Z_YDCPG_SL1_UR9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%UR9%F_P)
      Z_YDCPG_SL1_V0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V0%F_P)
      Z_YDCPG_SL1_V9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_NL%F_P)
      Z_YDCPG_SL1_V9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9%F_P)
      Z_YDCPG_SL1_V9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%V9_SI%F_P)
      Z_YDCPG_SL1_VF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VF9%F_P)
      Z_YDCPG_SL1_VP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VP9%F_P)
      Z_YDCPG_SL1_VR9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%VR9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    KNOWENO => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    PUFZ => NULL ()
    PUPF => NULL ()
    PVFZ => NULL ()
    PVPF => NULL ()
    Z_YDCPG_DDH_TND_YSI_U_T0 => NULL ()
    Z_YDCPG_DDH_TND_YSI_V_T0 => NULL ()
    Z_YDCPG_DDH_TND_YSL_U_P => NULL ()
    Z_YDCPG_DDH_TND_YSL_V_P => NULL ()
    Z_YDCPG_GMVF_NL_U_P => NULL ()
    Z_YDCPG_GMVF_NL_V_P => NULL ()
    Z_YDCPG_GMVF_SI_U_P => NULL ()
    Z_YDCPG_GMVF_SI_V_P => NULL ()
    Z_YDCPG_GMVF_U_P => NULL ()
    Z_YDCPG_GMVF_V_P => NULL ()
    Z_YDCPG_SL1_U0_P => NULL ()
    Z_YDCPG_SL1_U9_NL_P => NULL ()
    Z_YDCPG_SL1_U9_P => NULL ()
    Z_YDCPG_SL1_U9_SI_P => NULL ()
    Z_YDCPG_SL1_UF9_P => NULL ()
    Z_YDCPG_SL1_UP9_P => NULL ()
    Z_YDCPG_SL1_UR9_P => NULL ()
    Z_YDCPG_SL1_V0_P => NULL ()
    Z_YDCPG_SL1_V9_NL_P => NULL ()
    Z_YDCPG_SL1_V9_P => NULL ()
    Z_YDCPG_SL1_V9_SI_P => NULL ()
    Z_YDCPG_SL1_VF9_P => NULL ()
    Z_YDCPG_SL1_VP9_P => NULL ()
    Z_YDCPG_SL1_VR9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LRHS_CURV_F',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

LLMOM=.NOT.YDML_DYN%YRDYN%LSLHDHEAT
IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LAITRE_GMV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
  KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
  PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
  PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
  Z_YDCPG_DDH_TND_YSL_T_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%T%F_P)
  Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
  Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T9%F_P)
  Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%TF9%F_P)
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (IWK, JBLK, JLEV, JROF, LLHOI2) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
    &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKH, LL_LIN, YDML_DYN%YRDYNA&
    &%LCOMAD_T, YDML_DYN%YRDYNA%LSLHD_T, YDML_DYN%YRDYN%LVWENO_T, YDML_DYN%YRDYN%WENO_ALPHA_T, LLMOM&
    &, YDML_DYN%YRDYN%LQMT, YDML_DYN%YRDYN%LQMHT, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:&
    &, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK))

    IF (YDLDDH%LRSLDDH) THEN

      DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

        DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
          Z_YDCPG_DDH_TND_YSL_T_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_T_P&
          & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_T_P (JROF, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDIF


    IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NTLAG<4)) THEN

      IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
        LLHOI2=LLNOSLHD
        IWK=YDML_DYN%YRDYN%NSLDIMK
      ELSE
        LLHOI2=YDML_DYN%YRDYNA%LSLHD_T
        IWK=IWKH
      ENDIF

      CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
      & YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
      &%YRDYNA%LCOMAD_T, LLHOI2, YDML_DYN%YRDYN%LVWENO_T, YDML_DYN%YRDYN%WENO_ALPHA_T, LLMOM, YDML_DYN&
      &%YRDYN%LQMT, YDML_DYN%YRDYN%LQMHT, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW&
      &(:,:,:, JBLK), Z_YDCPG_SL1_TF9_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK), LDADD=.TRUE.)
    ENDIF

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITRE_GMV')) THEN
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDWR (YD_KL0)
    KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
    PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
    Z_YDCPG_DDH_TND_YSL_T_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%T%F_P)
    Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
    Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
    Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KL0 => NULL ()
  KNOWENO => NULL ()
  PLSCAW => NULL ()
  PRSCAW => NULL ()
  Z_YDCPG_DDH_TND_YSL_T_P => NULL ()
  Z_YDCPG_GMVF_T_P => NULL ()
  Z_YDCPG_SL1_T9_P => NULL ()
  Z_YDCPG_SL1_TF9_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LAITRE_GMV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
  KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
  PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
  PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
  Z_YDCPG_DDH_TND_YSL_T_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%T%F_P)
  Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
  Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T9%F_P)
  Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%TF9%F_P)
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (IWK, JBLK, JLEV, JROF, LLHOI2, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKH, LL_LIN, YDML_DYN&
      &%YRDYNA%LCOMAD_T, YDML_DYN%YRDYNA%LSLHD_T, YDML_DYN%YRDYN%LVWENO_T, YDML_DYN%YRDYN%WENO_ALPHA_T, LLMOM&
      &, YDML_DYN%YRDYN%LQMT, YDML_DYN%YRDYN%LQMHT, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
      &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDLDDH%LRSLDDH) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_DDH_TND_YSL_T_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_T_P&
          & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_T_P (JROF, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NTLAG<4)) THEN

        IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
          LLHOI2=LLNOSLHD
          IWK=YDML_DYN%YRDYN%NSLDIMK
        ELSE
          LLHOI2=YDML_DYN%YRDYNA%LSLHD_T
          IWK=IWKH
        ENDIF

        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_T, LLHOI2, YDML_DYN%YRDYN%LVWENO_T, YDML_DYN%YRDYN%WENO_ALPHA_T, LLMOM, YDML_DYN%YRDYN&
        &%LQMT, YDML_DYN%YRDYN%LQMHT, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
        &:, JBLK), Z_YDCPG_SL1_TF9_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITRE_GMV')) THEN
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDWR (YD_KL0)
    KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
    PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
    Z_YDCPG_DDH_TND_YSL_T_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%T%F_P)
    Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
    Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
    Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KL0 => NULL ()
  KNOWENO => NULL ()
  PLSCAW => NULL ()
  PRSCAW => NULL ()
  Z_YDCPG_DDH_TND_YSL_T_P => NULL ()
  Z_YDCPG_GMVF_T_P => NULL ()
  Z_YDCPG_SL1_T9_P => NULL ()
  Z_YDCPG_SL1_TF9_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LAITRE_GMV')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
  KNOWENO => GET_DEVICE_DATA_RDONLY (YD_KNOWENO)
  PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
  PRSCAW => GET_DEVICE_DATA_RDONLY (YD_PRSCAW)
  Z_YDCPG_DDH_TND_YSL_T_P => GET_DEVICE_DATA_RDWR (YDCPG_DDH_TND%YSL%T%F_P)
  Z_YDCPG_GMVF_T_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF%T%F_P)
  Z_YDCPG_SL1_T9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%T9%F_P)
  Z_YDCPG_SL1_TF9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%TF9%F_P)
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (KL0, KNOWENO, PLSCAW, PRSCAW, YDCPG_OPTS, YDGEOMETRY, YDLDDH, YDML_DYN, &
    !$ACC&         YFXTRAN_ACDC_STACK, Z_YDCPG_DDH_TND_YSL_T_P, Z_YDCPG_GMVF_T_P, &
    !$ACC&         Z_YDCPG_SL1_T9_P, Z_YDCPG_SL1_TF9_P) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (IWK, JLEV, JROF, LLHOI2, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWKH, LL_LIN, YDML_DYN&
      &%YRDYNA%LCOMAD_T, YDML_DYN%YRDYNA%LSLHD_T, YDML_DYN%YRDYN%LVWENO_T, YDML_DYN%YRDYN%WENO_ALPHA_T, LLMOM&
      &, YDML_DYN%YRDYN%LQMT, YDML_DYN%YRDYN%LQMHT, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
      &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_T9_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK),YDSTACK=YLSTACK)

      IF (YDLDDH%LRSLDDH) THEN

        DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
          
          Z_YDCPG_DDH_TND_YSL_T_P (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_T_P&
          & (JROF, JLEV, JBLK)+Z_YDCPG_GMVF_T_P (JROF, JLEV, JBLK)
        
        ENDDO

      ENDIF


      IF ((YDML_DYN%YRDYN%NSPLTHOI/=0).AND.(YDML_DYN%YRDYN%NTLAG<4)) THEN

        IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN
          LLHOI2=LLNOSLHD
          IWK=YDML_DYN%YRDYN%NSLDIMK
        ELSE
          LLHOI2=YDML_DYN%YRDYNA%LSLHD_T
          IWK=IWKH
        ENDIF

        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWK, LL_LIN, YDML_DYN&
        &%YRDYNA%LCOMAD_T, LLHOI2, YDML_DYN%YRDYN%LVWENO_T, YDML_DYN%YRDYN%WENO_ALPHA_T, LLMOM, YDML_DYN%YRDYN&
        &%LQMT, YDML_DYN%YRDYN%LQMHT, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,&
        &:, JBLK), Z_YDCPG_SL1_TF9_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
      ENDIF

    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITRE_GMV')) THEN
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDWR (YD_KL0)
    KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
    PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
    Z_YDCPG_DDH_TND_YSL_T_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%T%F_P)
    Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
    Z_YDCPG_SL1_T9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9%F_P)
    Z_YDCPG_SL1_TF9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TF9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  KL0 => NULL ()
  KNOWENO => NULL ()
  PLSCAW => NULL ()
  PRSCAW => NULL ()
  Z_YDCPG_DDH_TND_YSL_T_P => NULL ()
  Z_YDCPG_GMVF_T_P => NULL ()
  Z_YDCPG_SL1_T9_P => NULL ()
  Z_YDCPG_SL1_TF9_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GMV',1,ZHOOK_HANDLE_PARALLEL)

IF (YDML_DYN%YRDYN%NTLAG>=3) THEN
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:NTLAG_3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_DDH_TND_YSI_T_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%T%FT0)
    Z_YDCPG_GMVF_NL_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%T%F_P)
    Z_YDCPG_GMVF_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%T%F_P)
    Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
    Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T0%F_P)
    Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T9_NL%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T9_SI%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
      &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW&
      &(:,:,:, JBLK), Z_YDCPG_SL1_T0_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK), LDADD=.TRUE.)

      IF (YDLDDH%LRSIDDH) THEN
        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
        & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,&
        &:,:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_T_T0(:,:, JBLK), LDADD=.TRUE.)
      ENDIF


      IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW&
        &(:,:,:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:), Z_YDCPG_GMVF_SI_T_P(:,:, JBLK))
      ENDIF


      IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW&
        &(:,:,:, JBLK), Z_YDCPG_SL1_T9_NL_P(:,:), Z_YDCPG_GMVF_NL_T_P(:,:, JBLK))
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NTLAG_3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_DDH_TND_YSI_T_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%T%FT0)
      Z_YDCPG_GMVF_NL_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%T%F_P)
      Z_YDCPG_GMVF_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%T%F_P)
      Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
      Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
      Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
      Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_DDH_TND_YSI_T_T0 => NULL ()
    Z_YDCPG_GMVF_NL_T_P => NULL ()
    Z_YDCPG_GMVF_SI_T_P => NULL ()
    Z_YDCPG_GMVF_T_P => NULL ()
    Z_YDCPG_SL1_T0_P => NULL ()
    Z_YDCPG_SL1_T9_NL_P => NULL ()
    Z_YDCPG_SL1_T9_SI_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:NTLAG_3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_DDH_TND_YSI_T_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%T%FT0)
    Z_YDCPG_GMVF_NL_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%T%F_P)
    Z_YDCPG_GMVF_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%T%F_P)
    Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
    Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T0%F_P)
    Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T9_NL%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%T9_SI%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:,:,&
        & JBLK), Z_YDCPG_SL1_T0_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)

        IF (YDLDDH%LRSIDDH) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
          & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:,:, JBLK&
          &), Z_YDCPG_SL1_T9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_T_T0(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:&
          &,:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:), Z_YDCPG_GMVF_SI_T_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:&
          &,:, JBLK), Z_YDCPG_SL1_T9_NL_P(:,:), Z_YDCPG_GMVF_NL_T_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NTLAG_3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_DDH_TND_YSI_T_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%T%FT0)
      Z_YDCPG_GMVF_NL_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%T%F_P)
      Z_YDCPG_GMVF_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%T%F_P)
      Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
      Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
      Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
      Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_DDH_TND_YSI_T_T0 => NULL ()
    Z_YDCPG_GMVF_NL_T_P => NULL ()
    Z_YDCPG_GMVF_SI_T_P => NULL ()
    Z_YDCPG_GMVF_T_P => NULL ()
    Z_YDCPG_SL1_T0_P => NULL ()
    Z_YDCPG_SL1_T9_NL_P => NULL ()
    Z_YDCPG_SL1_T9_SI_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:NTLAG_3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
    PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_DDH_TND_YSI_T_T0 => GET_DEVICE_DATA_RDWR (YDCPG_DDH_TND%YSI%T%FT0)
    Z_YDCPG_GMVF_NL_T_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF_NL%T%F_P)
    Z_YDCPG_GMVF_SI_T_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF_SI%T%F_P)
    Z_YDCPG_GMVF_T_P => GET_DEVICE_DATA_RDWR (YDCPG_GMVF%T%F_P)
    Z_YDCPG_SL1_T0_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%T0%F_P)
    Z_YDCPG_SL1_T9_NL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%T9_NL%F_P)
    Z_YDCPG_SL1_T9_SI_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%T9_SI%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (KL0, PLSCAW, YDCPG_OPTS, YDGEOMETRY, YDLDDH, YDML_DYN, YFXTRAN_ACDC_STACK, &
      !$ACC&         Z_YDCPG_DDH_TND_YSI_T_T0, Z_YDCPG_GMVF_NL_T_P, Z_YDCPG_GMVF_SI_T_P, &
      !$ACC&         Z_YDCPG_GMVF_T_P, Z_YDCPG_SL1_T0_P, Z_YDCPG_SL1_T9_NL_P, &
      !$ACC&         Z_YDCPG_SL1_T9_SI_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
        &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:,:,&
        & JBLK), Z_YDCPG_SL1_T0_P(:,:), Z_YDCPG_GMVF_T_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)

        IF (YDLDDH%LRSIDDH) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG,&
          & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:,:, JBLK&
          &), Z_YDCPG_SL1_T9_SI_P(:,:), Z_YDCPG_DDH_TND_YSI_T_T0(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSLINL.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:&
          &,:, JBLK), Z_YDCPG_SL1_T9_SI_P(:,:), Z_YDCPG_GMVF_SI_T_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T, PLSCAW(:,:&
          &,:, JBLK), Z_YDCPG_SL1_T9_NL_P(:,:), Z_YDCPG_GMVF_NL_T_P(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NTLAG_3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_DDH_TND_YSI_T_T0 => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSI%T%FT0)
      Z_YDCPG_GMVF_NL_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_NL%T%F_P)
      Z_YDCPG_GMVF_SI_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF_SI%T%F_P)
      Z_YDCPG_GMVF_T_P => GET_HOST_DATA_RDWR (YDCPG_GMVF%T%F_P)
      Z_YDCPG_SL1_T0_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T0%F_P)
      Z_YDCPG_SL1_T9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_NL%F_P)
      Z_YDCPG_SL1_T9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%T9_SI%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_DDH_TND_YSI_T_T0 => NULL ()
    Z_YDCPG_GMVF_NL_T_P => NULL ()
    Z_YDCPG_GMVF_SI_T_P => NULL ()
    Z_YDCPG_GMVF_T_P => NULL ()
    Z_YDCPG_SL1_T0_P => NULL ()
    Z_YDCPG_SL1_T9_NL_P => NULL ()
    Z_YDCPG_SL1_T9_SI_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NTLAG_3',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (LDSLPHY) THEN
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LDSLPHY')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PTPF => GET_HOST_DATA_RDWR (YD_PTPF)
    Z_YDCPG_SL1_TP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%TP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
      &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA&
      &%LCOMAD_T, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_TP9_P(:,:), PTPF(:,:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LDSLPHY')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PTPF => GET_HOST_DATA_RDWR (YD_PTPF)
      Z_YDCPG_SL1_TP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PLSCAW => NULL ()
    PTPF => NULL ()
    Z_YDCPG_SL1_TP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LDSLPHY')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PTPF => GET_HOST_DATA_RDWR (YD_PTPF)
    Z_YDCPG_SL1_TP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%TP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T&
        &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_TP9_P(:,:), PTPF(:,:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LDSLPHY')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PTPF => GET_HOST_DATA_RDWR (YD_PTPF)
      Z_YDCPG_SL1_TP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PLSCAW => NULL ()
    PTPF => NULL ()
    Z_YDCPG_SL1_TP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LDSLPHY')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
    PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
    PTPF => GET_DEVICE_DATA_RDWR (YD_PTPF)
    Z_YDCPG_SL1_TP9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%TP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (KL0, PLSCAW, PTPF, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YFXTRAN_ACDC_STACK, &
      !$ACC&         Z_YDCPG_SL1_TP9_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_T&
        &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_TP9_P(:,:), PTPF(:,:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LDSLPHY')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PTPF => GET_HOST_DATA_RDWR (YD_PTPF)
      Z_YDCPG_SL1_TP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%TP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PLSCAW => NULL ()
    PTPF => NULL ()
    Z_YDCPG_SL1_TP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LDSLPHY',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDML_DYN%YRDYNA%LNHDYN) THEN
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDML_DYN%YRDYNA%LNHDYN) THEN
  
  
  
  
  
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


DO JFLD=1, SIZE (YDVARS%GFL_PTR)

  IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LADV.AND.(.NOT.YDVARS%GFL_PTR (JFLD)%YCOMP%LMGRID)) THEN
    LLMOM=TRIM (YDVARS%GFL_PTR (JFLD)%YCOMP%CNAME)=='TKE'.OR..NOT.YDML_DYN%YRDYN%LSLHDHEAT

    IF (YDML_DYN%YRDYNA%L3DTURB.AND.YDVARS%GFL_PTR (JFLD)%YCOMP%LHORTURB) THEN
      IWKGFL=IWKH

      IF (TRIM (YDVARS%GFL_PTR (JFLD)%YCOMP%CNAME)=='TKE')  THEN
        IWKGFL=IWKM
      ENDIF

    ELSE
      IWKGFL=1
    ENDIF


    IF (YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT (1:3)=="LIN") THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LIN')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK, LLCOMAD) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          LLCOMAD=YDML_GCONF%YGFL%YCOMP(JFLD)%CSLINT=="LIN(MAD)"
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW&
          &(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK))
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LIN')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LIN')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JROF, LLCOMAD, YLCPG_BNDS, YLSTACK)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            LLCOMAD=YDML_GCONF%YGFL%YCOMP(JFLD)%CSLINT=="LIN(MAD)"
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
            &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LIN')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LIN')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (KL0, PLSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YDML_GCONF, YFXTRAN_ACDC_STACK, &
          !$ACC&         Z_YDCPG_GFLF_GFL_P, Z_YDCPG_SL1_GFL_P) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JROF, LLCOMAD, YLCPG_BNDS, YLSTACK) 

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            LLCOMAD=YDML_GCONF%YGFL%YCOMP(JFLD)%CSLINT=="LIN(MAD)"
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
            &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LIN')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LIN',1,ZHOOK_HANDLE_PARALLEL)
    ELSEIF (YDML_GCONF%YGFL%NUMFLDS_SL1>0.AND.YDML_GCONF%YGFL%NUMFLDS_SPL&
      &>0.AND.YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT=='LAITVSPCQM  ') THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LAITVSPCQM')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_SP => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_SP)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL LAITRE_GFL (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
          &%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV&
          &%NFLEN, KHVI, IWKGFL, YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT, YDVARS%GFL_PTR (JFLD)%YCOMP%WENO_ALPHA&
          &, LLMOM, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P&
          & (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK), PXSPSL=Z_YDCPG_SL1_GFL_P_SP (:,:))
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITVSPCQM')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_SP => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_SP)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_SP => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LAITVSPCQM')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_SP => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_SP)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITRE_GFL_OPENACC (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
            &%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN&
            &, KHVI, IWKGFL, YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT, YDVARS%GFL_PTR (JFLD)%YCOMP%WENO_ALPHA, LLMOM, KNOWENO&
            &(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P&
            &(:,:, JBLK), PXSPSL=Z_YDCPG_SL1_GFL_P_SP (:,:),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITVSPCQM')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_SP => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_SP)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_SP => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LAITVSPCQM')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_DEVICE_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_DEVICE_DATA_RDONLY (YD_PRSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_SP => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_SP)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (KL0, KNOWENO, PLSCAW, PRSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YDML_GCONF, &
          !$ACC&         YDVARS, YFXTRAN_ACDC_STACK, Z_YDCPG_GFLF_GFL_P, Z_YDCPG_SL1_GFL_P, &
          !$ACC&         Z_YDCPG_SL1_GFL_P_SP) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITRE_GFL_OPENACC (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS&
            &%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN&
            &, KHVI, IWKGFL, YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT, YDVARS%GFL_PTR (JFLD)%YCOMP%WENO_ALPHA, LLMOM, KNOWENO&
            &(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P&
            &(:,:, JBLK), PXSPSL=Z_YDCPG_SL1_GFL_P_SP (:,:),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITVSPCQM')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_SP => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_SP)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_SP => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITVSPCQM',1,ZHOOK_HANDLE_PARALLEL)
    ELSE
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LAITRE_GFL')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL LAITRE_GFL (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA,&
          & YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA,&
          & YDGEOMETRY%YRDIMV%NFLEN, KHVI, IWKGFL, YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT, YDVARS%GFL_PTR&
          & (JFLD)%YCOMP%WENO_ALPHA, LLMOM, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK&
          &), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK))
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITRE_GFL')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LAITRE_GFL')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITRE_GFL_OPENACC (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY&
            &%YRDIMV%NFLEN, KHVI, IWKGFL, YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT, YDVARS%GFL_PTR (JFLD)%YCOMP&
            &%WENO_ALPHA, LLMOM, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:,&
            & JBLK), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITRE_GFL')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LAITRE_GFL')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_DEVICE_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_DEVICE_DATA_RDONLY (YD_PRSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (KL0, KNOWENO, PLSCAW, PRSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YDML_GCONF, &
          !$ACC&         YDVARS, YFXTRAN_ACDC_STACK, Z_YDCPG_GFLF_GFL_P, Z_YDCPG_SL1_GFL_P) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITRE_GFL_OPENACC (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY&
            &%YRDIMV%NFLEN, KHVI, IWKGFL, YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT, YDVARS%GFL_PTR (JFLD)%YCOMP&
            &%WENO_ALPHA, LLMOM, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:,&
            & JBLK), Z_YDCPG_SL1_GFL_P (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LAITRE_GFL')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LAITRE_GFL',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:RRINTOPT')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_DDH_TND_YSL_GFL_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%GFL (JFLD)%F_P)
      Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        IF (YDML_DYN%YRDYN%RRINTOPT/=1._JPRB) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_GFLF_GFL_P&
              &  (JROF, JLEV, JBLK)*YDML_DYN%YRDYN%RRINTOPT
            ENDDO

          ENDDO

        ENDIF


        IF (YDLDDH%LRSLDDH) THEN

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDCPG_DDH_TND_YSL_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_GFL_P&
              &  (JROF, JLEV, JBLK)+Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)
            ENDDO

          ENDDO

        ENDIF

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:RRINTOPT')) THEN
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_DDH_TND_YSL_GFL_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%GFL (JFLD)%F_P)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_DDH_TND_YSL_GFL_P => NULL ()
      Z_YDCPG_GFLF_GFL_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:RRINTOPT')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_DDH_TND_YSL_GFL_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%GFL (JFLD)%F_P)
      Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          IF (YDML_DYN%YRDYN%RRINTOPT/=1._JPRB) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_GFLF_GFL_P&
              &  (JROF, JLEV, JBLK)*YDML_DYN%YRDYN%RRINTOPT
            
            ENDDO

          ENDIF


          IF (YDLDDH%LRSLDDH) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDCPG_DDH_TND_YSL_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_GFL_P&
              &  (JROF, JLEV, JBLK)+Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:RRINTOPT')) THEN
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_DDH_TND_YSL_GFL_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%GFL (JFLD)%F_P)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_DDH_TND_YSL_GFL_P => NULL ()
      Z_YDCPG_GFLF_GFL_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:RRINTOPT')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_DDH_TND_YSL_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_DDH_TND%YSL%GFL (JFLD)%F_P)
      Z_YDCPG_GFLF_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YDGEOMETRY, YDLDDH, YDML_DYN, YFXTRAN_ACDC_STACK, &
        !$ACC&         Z_YDCPG_DDH_TND_YSL_GFL_P, Z_YDCPG_GFLF_GFL_P) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

        

        DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JROF
          YLCPG_BNDS%KFDIA = JROF

          

          IF (YDML_DYN%YRDYN%RRINTOPT/=1._JPRB) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_GFLF_GFL_P&
              &  (JROF, JLEV, JBLK)*YDML_DYN%YRDYN%RRINTOPT
            
            ENDDO

          ENDIF


          IF (YDLDDH%LRSLDDH) THEN

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDCPG_DDH_TND_YSL_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_DDH_TND_YSL_GFL_P&
              &  (JROF, JLEV, JBLK)+Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)
            
            ENDDO

          ENDIF

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:RRINTOPT')) THEN
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        Z_YDCPG_DDH_TND_YSL_GFL_P => GET_HOST_DATA_RDWR (YDCPG_DDH_TND%YSL%GFL (JFLD)%F_P)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      Z_YDCPG_DDH_TND_YSL_GFL_P => NULL ()
      Z_YDCPG_GFLF_GFL_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:RRINTOPT',1,ZHOOK_HANDLE_PARALLEL)

    IF (.NOT.(YDML_DYN%YRDYN%NSPLTHOI==0.OR.YDVARS%GFL_PTR (JFLD)%YCOMP%LTDIABLIN)) THEN

      IF (YDML_DYN%YRDYN%NSPLTHOI==1) THEN

        SELECTCASE (YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT)
        CASE ('LAITQM(SLD) ')
          CLINT='LAITQM      '
        CASE ('LAITQMH(SLD)')
          CLINT='LAITQMH     '
        CASE ('LAITRI(SLD) ')
          CLINT='LAITRI      '
        CASE DEFAULT
          CLINT=YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT
        ENDSELECT

        IWK=YDML_DYN%YRDYN%NSLDIMK
      ELSE
        CLINT=YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT
        IWK=IWKGFL
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LTDIABLIN')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
        ZGFLF => GET_HOST_DATA_RDWR (YL_ZGFLF)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_SPF => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_SPF)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL LAITRE_GFL (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA&
          &, YDGEOMETRY%YRDIMV%NFLEN, KHVI, IWK, CLINT, YDVARS%GFL_PTR (JFLD)%YCOMP%WENO_ALPHA,&
          & LLMOM, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:, JBLK&
          &), Z_YDCPG_SL1_GFL_P (:,:), ZGFLF(:,:, JBLK), Z_YDCPG_SL1_GFL_P_SPF (:,:))

          DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG

            DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
              Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_GFLF_GFL_P&
              &  (JROF, JLEV, JBLK)+ZGFLF (JROF, JLEV, JBLK)
            ENDDO

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LTDIABLIN')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          ZGFLF => GET_HOST_DATA_RDWR (YL_ZGFLF)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_SPF => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_SPF)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        ZGFLF => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_SPF => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LTDIABLIN')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
        ZGFLF => GET_HOST_DATA_RDWR (YL_ZGFLF)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_SPF => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_SPF)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS, YLSTACK)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITRE_GFL_OPENACC (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY&
            &%YRDIMV%NFLEN, KHVI, IWK, CLINT, YDVARS%GFL_PTR (JFLD)%YCOMP%WENO_ALPHA, LLMOM, KNOWENO(:&
            &,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P &
            &(:,:), ZGFLF(:,:, JBLK), Z_YDCPG_SL1_GFL_P_SPF (:,:),YDSTACK=YLSTACK)

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_GFLF_GFL_P&
              &  (JROF, JLEV, JBLK)+ZGFLF (JROF, JLEV, JBLK)
            
            ENDDO

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LTDIABLIN')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          ZGFLF => GET_HOST_DATA_RDWR (YL_ZGFLF)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_SPF => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_SPF)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        ZGFLF => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_SPF => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LTDIABLIN')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
        KNOWENO => GET_DEVICE_DATA_RDONLY (YD_KNOWENO)
        PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
        PRSCAW => GET_DEVICE_DATA_RDONLY (YD_PRSCAW)
        ZGFLF => GET_DEVICE_DATA_RDWR (YL_ZGFLF)
        Z_YDCPG_GFLF_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_SPF => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_SPF)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (KL0, KNOWENO, PLSCAW, PRSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YDML_GCONF, &
          !$ACC&         YDVARS, YFXTRAN_ACDC_STACK, ZGFLF, Z_YDCPG_GFLF_GFL_P, Z_YDCPG_SL1_GFL_P, &
          !$ACC&         Z_YDCPG_SL1_GFL_P_SPF) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS, YLSTACK) 

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITRE_GFL_OPENACC (YDGEOMETRY, YDML_GCONF%YGFL, YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY&
            &%YRDIMV%NFLEN, KHVI, IWK, CLINT, YDVARS%GFL_PTR (JFLD)%YCOMP%WENO_ALPHA, LLMOM, KNOWENO(:&
            &,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P &
            &(:,:), ZGFLF(:,:, JBLK), Z_YDCPG_SL1_GFL_P_SPF (:,:),YDSTACK=YLSTACK)

            DO JLEV=1, YDGEOMETRY%YRDIMV%NFLEVG
              
              Z_YDCPG_GFLF_GFL_P  (JROF, JLEV, JBLK)=Z_YDCPG_GFLF_GFL_P&
              &  (JROF, JLEV, JBLK)+ZGFLF (JROF, JLEV, JBLK)
            
            ENDDO

          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LTDIABLIN')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
          ZGFLF => GET_HOST_DATA_RDWR (YL_ZGFLF)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_SPF => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_SPF)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        KNOWENO => NULL ()
        PLSCAW => NULL ()
        PRSCAW => NULL ()
        ZGFLF => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_SPF => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LTDIABLIN',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF


    IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LTDIABLIN) THEN
      LLCOMAD=YDML_GCONF%YGFL%YCOMP(JFLD)%CSLINT=='LIN(MAD)    '.OR.YDML_GCONF%YGFL&
      &%YCOMP(JFLD)%CSLINT=='LAITQM(MAD) '.OR.YDML_GCONF%YGFL%YCOMP(JFLD)%CSLINT=&
      &='LAITQMH(MAD)'.OR.YDML_GCONF%YGFL%YCOMP(JFLD)%CSLINT=='LAITRI(MAD) '
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LLCOMAD')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_F => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_F)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
          &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(:,:,:, JBLK&
          &), Z_YDCPG_SL1_GFL_P_F (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK), LDADD=.TRUE.)
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LLCOMAD')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_F => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_F)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_F => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LLCOMAD')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_F => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_F)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P_F&
            & (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LLCOMAD')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_F => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_F)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_F => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LLCOMAD')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLF_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_F => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_F)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (KL0, PLSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YFXTRAN_ACDC_STACK, &
          !$ACC&         Z_YDCPG_GFLF_GFL_P, Z_YDCPG_SL1_GFL_P_F) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
            &, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_GFL_P_F&
            & (:,:), Z_YDCPG_GFLF_GFL_P(:,:, JBLK), LDADD=.TRUE.,YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LLCOMAD')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_F => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_F)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_F => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

  ENDIF


  IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LADV) THEN

    IF (YDVARS%GFL_PTR (JFLD)%YCOMP%LPHY.AND.LDSLPHY) THEN
      LLCOMAD=(YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT=='LIN(MAD)    ').OR.(YDVARS%GFL_PTR&
      & (JFLD)%YCOMP%CSLINT=='LAITQM(MAD) ').OR.(YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT=&
      &='LAITQMH(MAD)').OR.(YDVARS%GFL_PTR (JFLD)%YCOMP%CSLINT=='LAITRI(MAD) ')
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2',0,ZHOOK_HANDLE_PARALLEL)

      IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LLCOMAD_2')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLPF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLPF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
        !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          CALL YLCPG_BNDS%UPDATE (JBLK)
          
          CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(&
          &:,:,:, JBLK), Z_YDCPG_SL1_GFL_P_P (:,:), Z_YDCPG_GFLPF_GFL_P(:,:, JBLK))
        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LLCOMAD_2')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLPF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLPF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLPF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LLCOMAD_2')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLPF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLPF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

          

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
            &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_GFL_P_P (:,:), Z_YDCPG_GFLPF_GFL_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LLCOMAD_2')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLPF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLPF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLPF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LLCOMAD_2')) THEN
        
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
        PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
        Z_YDCPG_GFLPF_GFL_P => GET_DEVICE_DATA_RDWR (YDCPG_GFLPF%GFL (JFLD)%F_P)
        Z_YDCPG_SL1_GFL_P_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%GFL (JFLD)%F_P_P)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
        
        
          !$ACC PARALLEL LOOP GANG &
          !$ACC&PRESENT (KL0, PLSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YFXTRAN_ACDC_STACK, &
          !$ACC&         Z_YDCPG_GFLPF_GFL_P, Z_YDCPG_SL1_GFL_P_P) &
          !$ACC&PRIVATE (JBLK) &
          !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
          
          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
          
          
          
          !$ACC LOOP VECTOR &
          !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

          

          DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
            YLCPG_BNDS%KIDIA = JROF
            YLCPG_BNDS%KFDIA = JROF
            YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
            
            CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
            &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), LLCOMAD, PLSCAW(:,:,:, JBLK&
            &), Z_YDCPG_SL1_GFL_P_P (:,:), Z_YDCPG_GFLPF_GFL_P(:,:, JBLK),YDSTACK=YLSTACK)
          ENDDO

        ENDDO

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

        IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LLCOMAD_2')) THEN
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
          KL0 => GET_HOST_DATA_RDWR (YD_KL0)
          PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
          Z_YDCPG_GFLPF_GFL_P => GET_HOST_DATA_RDWR (YDCPG_GFLPF%GFL (JFLD)%F_P)
          Z_YDCPG_SL1_GFL_P_P => GET_HOST_DATA_RDWR (YDCPG_SL1%GFL (JFLD)%F_P_P)
          IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
        KL0 => NULL ()
        PLSCAW => NULL ()
        Z_YDCPG_GFLPF_GFL_P => NULL ()
        Z_YDCPG_SL1_GFL_P_P => NULL ()
        IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ELSE
          CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LLCOMAD_2',1,ZHOOK_HANDLE_PARALLEL)
    ENDIF

  ENDIF

ENDDO

LLMOM=.TRUE.

IF (YDML_DYN%YRDYN%NVLAG==2) THEN
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:NVLAG_2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
    PCF => GET_HOST_DATA_RDWR (YD_PCF)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
    Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL LAITRE_GMV (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWNT, LL_LIN&
      &, YDML_DYN%YRDYNA%LCOMAD_SP, LLNOSLHD, YDML_DYN%YRDYN%LVWENO_SP, YDML_DYN%YRDYN%WENO_ALPHA_SP&
      &, LLMOM, YDML_DYN%YRDYN%LQMP, YDML_DYN%YRDYN%LQMHP, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW&
      &(:,:,:, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_P(:,:), PCF(:,:, JBLK))
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NVLAG_2')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
      PCF => GET_HOST_DATA_RDWR (YD_PCF)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    KNOWENO => NULL ()
    PCF => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    Z_YDCPG_SL1_C9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:NVLAG_2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    KNOWENO => GET_HOST_DATA_RDONLY (YD_KNOWENO)
    PCF => GET_HOST_DATA_RDWR (YD_PCF)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
    Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWNT, LL_LIN&
        &, YDML_DYN%YRDYNA%LCOMAD_SP, LLNOSLHD, YDML_DYN%YRDYN%LVWENO_SP, YDML_DYN%YRDYN%WENO_ALPHA_SP, LLMOM&
        &, YDML_DYN%YRDYN%LQMP, YDML_DYN%YRDYN%LQMHP, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:&
        &, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_P(:,:), PCF(:,:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NVLAG_2')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
      PCF => GET_HOST_DATA_RDWR (YD_PCF)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    KNOWENO => NULL ()
    PCF => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    Z_YDCPG_SL1_C9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:NVLAG_2')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
    KNOWENO => GET_DEVICE_DATA_RDONLY (YD_KNOWENO)
    PCF => GET_DEVICE_DATA_RDWR (YD_PCF)
    PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_DEVICE_DATA_RDONLY (YD_PRSCAW)
    Z_YDCPG_SL1_C9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%C9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (KL0, KNOWENO, PCF, PLSCAW, PRSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, &
      !$ACC&         YFXTRAN_ACDC_STACK, Z_YDCPG_SL1_C9_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITRE_GMV_OPENACC (YDML_DYN, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
        &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IWNT, LL_LIN&
        &, YDML_DYN%YRDYNA%LCOMAD_SP, LLNOSLHD, YDML_DYN%YRDYN%LVWENO_SP, YDML_DYN%YRDYN%WENO_ALPHA_SP, LLMOM&
        &, YDML_DYN%YRDYN%LQMP, YDML_DYN%YRDYN%LQMHP, KNOWENO(:,:, JBLK), KL0(:,:,:, JBLK), PLSCAW(:,:,:&
        &, JBLK), PRSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_P(:,:), PCF(:,:, JBLK),YDSTACK=YLSTACK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NVLAG_2')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      KNOWENO => GET_HOST_DATA_RDWR (YD_KNOWENO)
      PCF => GET_HOST_DATA_RDWR (YD_PCF)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    KNOWENO => NULL ()
    PCF => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    Z_YDCPG_SL1_C9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_2',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDML_DYN%YRDYN%NVLAG==3) THEN
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:NVLAG_3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    PCF => GET_HOST_DATA_RDWR (YD_PCF)
    PCF_NL => GET_HOST_DATA_RDWR (YD_PCF_NL)
    PCF_SI => GET_HOST_DATA_RDWR (YD_PCF_SI)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9_NL%F_P)
    Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9%F_P)
    Z_YDCPG_SL1_C9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9_SI%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
      &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA&
      &%LCOMAD_SP, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_P(:,:), PCF(:,:, JBLK))

      IF (YDML_DYN%YRDYNA%LSLINLC2.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
        &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_SI_P(:,:), PCF_SI(:,:, JBLK))
      ENDIF


      IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
        CALL LAITLIF (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
        &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_NL_P(:,:), PCF_NL(:,:, JBLK))
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NVLAG_3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PCF => GET_HOST_DATA_RDWR (YD_PCF)
      PCF_NL => GET_HOST_DATA_RDWR (YD_PCF_NL)
      PCF_SI => GET_HOST_DATA_RDWR (YD_PCF_SI)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
      Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
      Z_YDCPG_SL1_C9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_SI%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PCF => NULL ()
    PCF_NL => NULL ()
    PCF_SI => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_SL1_C9_NL_P => NULL ()
    Z_YDCPG_SL1_C9_P => NULL ()
    Z_YDCPG_SL1_C9_SI_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:NVLAG_3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_HOST_DATA_RDONLY (YD_KL0)
    PCF => GET_HOST_DATA_RDWR (YD_PCF)
    PCF_NL => GET_HOST_DATA_RDWR (YD_PCF_NL)
    PCF_SI => GET_HOST_DATA_RDWR (YD_PCF_SI)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9_NL%F_P)
    Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9%F_P)
    Z_YDCPG_SL1_C9_SI_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%C9_SI%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
        &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_P(:,:), PCF(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDML_DYN%YRDYNA%LSLINLC2.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_SI_P(:,:), PCF_SI(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_NL_P(:,:), PCF_NL(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NVLAG_3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PCF => GET_HOST_DATA_RDWR (YD_PCF)
      PCF_NL => GET_HOST_DATA_RDWR (YD_PCF_NL)
      PCF_SI => GET_HOST_DATA_RDWR (YD_PCF_SI)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
      Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
      Z_YDCPG_SL1_C9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_SI%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PCF => NULL ()
    PCF_NL => NULL ()
    PCF_SI => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_SL1_C9_NL_P => NULL ()
    Z_YDCPG_SL1_C9_P => NULL ()
    Z_YDCPG_SL1_C9_SI_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:NVLAG_3')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => GET_DEVICE_DATA_RDONLY (YD_KL0)
    PCF => GET_DEVICE_DATA_RDWR (YD_PCF)
    PCF_NL => GET_DEVICE_DATA_RDWR (YD_PCF_NL)
    PCF_SI => GET_DEVICE_DATA_RDWR (YD_PCF_SI)
    PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_SL1_C9_NL_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%C9_NL%F_P)
    Z_YDCPG_SL1_C9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%C9%F_P)
    Z_YDCPG_SL1_C9_SI_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%C9_SI%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (KL0, PCF, PCF_NL, PCF_SI, PLSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, &
      !$ACC&         YFXTRAN_ACDC_STACK, Z_YDCPG_SL1_C9_NL_P, Z_YDCPG_SL1_C9_P, &
      !$ACC&         Z_YDCPG_SL1_C9_SI_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        
        CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
        &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_P(:,:), PCF(:,:, JBLK),YDSTACK=YLSTACK)

        IF (YDML_DYN%YRDYNA%LSLINLC2.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_SI_P(:,:), PCF_SI(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF


        IF (YDML_DYN%YRDYNA%LSETTLS.AND.YDML_DYN%YRDYNA%LPC_CHEAP.AND.YDML_DYN%YRDYN%NCURRENT_ITER==0) THEN
          CALL LAITLIF_OPENACC (YDML_DYN%YYTLSCAW, KASLB1, YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV&
          &%NFLEVG, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, KL0(:,:,:, JBLK), YDML_DYN%YRDYNA%LCOMAD_SP&
          &, PLSCAW(:,:,:, JBLK), Z_YDCPG_SL1_C9_NL_P(:,:), PCF_NL(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NVLAG_3')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KL0 => GET_HOST_DATA_RDWR (YD_KL0)
      PCF => GET_HOST_DATA_RDWR (YD_PCF)
      PCF_NL => GET_HOST_DATA_RDWR (YD_PCF_NL)
      PCF_SI => GET_HOST_DATA_RDWR (YD_PCF_SI)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_SL1_C9_NL_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_NL%F_P)
      Z_YDCPG_SL1_C9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9%F_P)
      Z_YDCPG_SL1_C9_SI_P => GET_HOST_DATA_RDWR (YDCPG_SL1%C9_SI%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KL0 => NULL ()
    PCF => NULL ()
    PCF_NL => NULL ()
    PCF_SI => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_SL1_C9_NL_P => NULL ()
    Z_YDCPG_SL1_C9_P => NULL ()
    Z_YDCPG_SL1_C9_SI_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NVLAG_3',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDML_DYN%YRDYNA%NQMGMV==-4) THEN
  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:NQMGMV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => GET_HOST_DATA_RDONLY (YD_KLH0)
    PDP => GET_HOST_DATA_RDWR (YD_PDP)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%SP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
        CALL LAIDLI (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA,&
        & YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW&
        & (:,:, YDML_DYN%YYTLSCAW%M_WDLAMAD, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLOMAD&
        &+1, JBLK), KLH0 (:,:, 1:2, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK))
      ELSE
        CALL LAIDLI (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
        &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW&
        & (:,:, YDML_DYN%YYTLSCAW%M_WDLAT, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO+1&
        &, JBLK), KLH0 (:,:, 1:2, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK))
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NQMGMV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
      PDP => GET_HOST_DATA_RDWR (YD_PDP)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => NULL ()
    PDP => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_SL1_SP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:NQMGMV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => GET_HOST_DATA_RDONLY (YD_KLH0)
    PDP => GET_HOST_DATA_RDWR (YD_PDP)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%SP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
          CALL LAIDLI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW (&
          &:,:, YDML_DYN%YYTLSCAW%M_WDLAMAD, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLOMAD+1, JBLK&
          &), KLH0 (:,:, 1:2, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ELSE
          CALL LAIDLI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW &
          &(:,:, YDML_DYN%YYTLSCAW%M_WDLAT, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO+1, JBLK&
          &), KLH0 (:,:, 1:2, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NQMGMV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
      PDP => GET_HOST_DATA_RDWR (YD_PDP)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => NULL ()
    PDP => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_SL1_SP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:NQMGMV')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => GET_DEVICE_DATA_RDONLY (YD_KLH0)
    PDP => GET_DEVICE_DATA_RDWR (YD_PDP)
    PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
    Z_YDCPG_SL1_SP9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%SP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (KLH0, PDP, PLSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YFXTRAN_ACDC_STACK, &
      !$ACC&         Z_YDCPG_SL1_SP9_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
          CALL LAIDLI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW (&
          &:,:, YDML_DYN%YYTLSCAW%M_WDLAMAD, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLOMAD+1, JBLK&
          &), KLH0 (:,:, 1:2, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ELSE
          CALL LAIDLI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
          &, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, PLSCAW &
          &(:,:, YDML_DYN%YYTLSCAW%M_WDLAT, JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO+1, JBLK&
          &), KLH0 (:,:, 1:2, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:NQMGMV')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
      PDP => GET_HOST_DATA_RDWR (YD_PDP)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => NULL ()
    PDP => NULL ()
    PLSCAW => NULL ()
    Z_YDCPG_SL1_SP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:NQMGMV',1,ZHOOK_HANDLE_PARALLEL)
ELSE

  IF (YDML_DYN%YRDYN%LQMP.OR.YDML_DYN%YRDYN%LQMHP) THEN
    IQM=1
  ELSE
    IQM=0
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LARCINB_PARALLEL:LCOMAD_SP')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => GET_HOST_DATA_RDONLY (YD_KLH0)
    PDP => GET_HOST_DATA_RDWR (YD_PDP)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
    Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%SP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
        CALL LAIDDI (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IQM, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLAMAD&
        & (IWNT), JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLOMAD, JBLK), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOMAD&
        & (IWNT), JBLK), KLH0(:,:,:, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK))
      ELSE
        CALL LAIDDI (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY%YRDIMV&
        &%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IQM, PRSCAW (:,:, YDML_DYN%YYTRSCAW&
        &%M_WCLA (IWNT), JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO, JBLK), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
        &%M_WCLO (IWNT), JBLK), KLH0(:,:,:, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK))
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LCOMAD_SP')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
      PDP => GET_HOST_DATA_RDWR (YD_PDP)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => NULL ()
    PDP => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    Z_YDCPG_SL1_SP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LARCINB_PARALLEL:LCOMAD_SP')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => GET_HOST_DATA_RDONLY (YD_KLH0)
    PDP => GET_HOST_DATA_RDWR (YD_PDP)
    PLSCAW => GET_HOST_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_HOST_DATA_RDONLY (YD_PRSCAW)
    Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDONLY (YDCPG_SL1%SP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
          CALL LAIDDI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN&
          &, IQM, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLAMAD (IWNT), JBLK), PLSCAW (:,:, YDML_DYN&
          &%YYTLSCAW%M_WDLOMAD, JBLK), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOMAD (IWNT), JBLK&
          &), KLH0(:,:,:, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ELSE
          CALL LAIDDI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IQM, PRSCAW (:,:, YDML_DYN%YYTRSCAW&
          &%M_WCLA (IWNT), JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO, JBLK), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
          &%M_WCLO (IWNT), JBLK), KLH0(:,:,:, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LCOMAD_SP')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
      PDP => GET_HOST_DATA_RDWR (YD_PDP)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => NULL ()
    PDP => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    Z_YDCPG_SL1_SP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LARCINB_PARALLEL:LCOMAD_SP')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => GET_DEVICE_DATA_RDONLY (YD_KLH0)
    PDP => GET_DEVICE_DATA_RDWR (YD_PDP)
    PLSCAW => GET_DEVICE_DATA_RDONLY (YD_PLSCAW)
    PRSCAW => GET_DEVICE_DATA_RDONLY (YD_PRSCAW)
    Z_YDCPG_SL1_SP9_P => GET_DEVICE_DATA_RDONLY (YDCPG_SL1%SP9%F_P)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (KLH0, PDP, PLSCAW, PRSCAW, YDCPG_OPTS, YDGEOMETRY, YDML_DYN, YFXTRAN_ACDC_STACK, &
      !$ACC&         Z_YDCPG_SL1_SP9_P) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

      

      DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JROF
        YLCPG_BNDS%KFDIA = JROF
        YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
        YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)

        

        IF (YDML_DYN%YRDYNA%LCOMAD_SP) THEN
          CALL LAIDDI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS&
          &%KFDIA, YDGEOMETRY%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN&
          &, IQM, PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLAMAD (IWNT), JBLK), PLSCAW (:,:, YDML_DYN&
          &%YYTLSCAW%M_WDLOMAD, JBLK), PRSCAW (:,:, YDML_DYN%YYTRSCAW%M_WCLOMAD (IWNT), JBLK&
          &), KLH0(:,:,:, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ELSE
          CALL LAIDDI_OPENACC (KASLB1, YDGEOMETRY%YRDIM%NPROMA, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDGEOMETRY&
          &%YRDIMV%NFLEVG, YDGEOMETRY%YRDIMV%NFLSA, YDGEOMETRY%YRDIMV%NFLEN, IQM, PRSCAW (:,:, YDML_DYN%YYTRSCAW&
          &%M_WCLA (IWNT), JBLK), PLSCAW (:,:, YDML_DYN%YYTLSCAW%M_WDLO, JBLK), PRSCAW (:,:, YDML_DYN%YYTRSCAW&
          &%M_WCLO (IWNT), JBLK), KLH0(:,:,:, JBLK), Z_YDCPG_SL1_SP9_P(:), PDP(:,:, JBLK),YDSTACK=YLSTACK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('LARCINB_PARALLEL:LCOMAD_SP')) THEN
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      KLH0 => GET_HOST_DATA_RDWR (YD_KLH0)
      PDP => GET_HOST_DATA_RDWR (YD_PDP)
      PLSCAW => GET_HOST_DATA_RDWR (YD_PLSCAW)
      PRSCAW => GET_HOST_DATA_RDWR (YD_PRSCAW)
      Z_YDCPG_SL1_SP9_P => GET_HOST_DATA_RDWR (YDCPG_SL1%SP9%F_P)
      IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    KLH0 => NULL ()
    PDP => NULL ()
    PLSCAW => NULL ()
    PRSCAW => NULL ()
    Z_YDCPG_SL1_SP9_P => NULL ()
    IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('LARCINB_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL:LCOMAD_SP',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDML_DYN%YRDYNA%LNHDYN.AND.YDML_DYN%YRDYNA%LRDBBC) THEN
  
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF




CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZGFLF)) CALL FIELD_DELETE (YL_ZGFLF)
IF (ASSOCIATED (YL_ZGMVF)) CALL FIELD_DELETE (YL_ZGMVF)
IF (ASSOCIATED (YL_ZGMVFU)) CALL FIELD_DELETE (YL_ZGMVFU)
IF (ASSOCIATED (YL_ZGMVFV)) CALL FIELD_DELETE (YL_ZGMVFV)
IF (ASSOCIATED (YL_ZGMVFZ)) CALL FIELD_DELETE (YL_ZGMVFZ)
IF (ASSOCIATED (YL_ZGMVU)) CALL FIELD_DELETE (YL_ZGMVU)
IF (ASSOCIATED (YL_ZGMVV)) CALL FIELD_DELETE (YL_ZGMVV)
IF (ASSOCIATED (YL_ZGMVZ)) CALL FIELD_DELETE (YL_ZGMVZ)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('LARCINB_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE LARCINB_PARALLEL
