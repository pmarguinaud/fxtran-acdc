SUBROUTINE CPG_DIA_FLU_PARALLEL (YDCPG_BNDS, YDCPG_OPTS, YDCPG_MISC, YDMF_PHYS_OUT&
&, YDCPG_DYN0, YDMF_PHYS_SURF, YDVARS, YDCFU, YDXFU, YDMODEL)
USE YOMHOOK,ONLY:DR_HOOK, LHOOK, JPHOOK

USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE CPG_TYPE_MOD,ONLY:CPG_DYN_TYPE, CPG_MISC_TYPE
USE MF_PHYS_TYPE_MOD,ONLY:MF_PHYS_OUT_TYPE
USE MF_PHYS_SURFACE_TYPE_MOD,ONLY:MF_PHYS_SURF_TYPE
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE YOMCFU,ONLY:TCFU
USE YOMXFU,ONLY:TXFU
USE TYPE_MODEL,ONLY:MODEL
USE YOMXIOS,ONLY:LXIOS
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_MISC_TYPE), INTENT (IN)::YDCPG_MISC
TYPE (MF_PHYS_OUT_TYPE), INTENT (IN)::YDMF_PHYS_OUT
TYPE (CPG_DYN_TYPE), INTENT (IN)::YDCPG_DYN0
TYPE (MF_PHYS_SURF_TYPE), INTENT (IN)::YDMF_PHYS_SURF
TYPE (FIELD_VARIABLES), INTENT (IN)::YDVARS
TYPE (TCFU), INTENT (INOUT)::YDCFU
TYPE (TXFU), INTENT (INOUT)::YDXFU
TYPE (MODEL), INTENT (IN)::YDMODEL
#include "cpcfu_parallel.intfb.h"
#include "abor1.intfb.h"
#include "cpxfu_parallel.intfb.h"
LOGICAL::LLCALL_CPCFU
LOGICAL::LLCALL_CPXFU
LOGICAL::LLCALL_CUMCPLDM
CLASS (FIELD_3RB), POINTER :: YL_ZDPRECIPS
REAL (KIND=JPRB), POINTER::ZDPRECIPS (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZDPRECIPS2
REAL (KIND=JPRB), POINTER::ZDPRECIPS2 (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTRCU
REAL (KIND=JPRB), POINTER::ZSTRCU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTRCV
REAL (KIND=JPRB), POINTER::ZSTRCV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTRDU
REAL (KIND=JPRB), POINTER::ZSTRDU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTRDV
REAL (KIND=JPRB), POINTER::ZSTRDV (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTRTU
REAL (KIND=JPRB), POINTER::ZSTRTU (:,:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZSTRTV
REAL (KIND=JPRB), POINTER::ZSTRTV (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZUGST
REAL (KIND=JPRB), POINTER::ZUGST (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZVGST
REAL (KIND=JPRB), POINTER::ZVGST (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZUCLS
REAL (KIND=JPRB), POINTER::ZUCLS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZNUCLS
REAL (KIND=JPRB), POINTER::ZNUCLS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZVCLS
REAL (KIND=JPRB), POINTER::ZVCLS (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZNVCLS
REAL (KIND=JPRB), POINTER::ZNVCLS (:,:)
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER (KIND=JPIM) :: JLON
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NUCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_NVCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRCV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRDV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_STRTV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_UGST(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VCLS(:,:)
REAL (KIND=JPRB), POINTER :: Z_YDMF_PHYS_OUT_VGST(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GM_P(:,:)
IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZVGST, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZVCLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUGST, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZUCLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTRTV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTRTU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTRDV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTRDU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTRCV, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZSTRCU, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, 0, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNVCLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZNUCLS, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDPRECIPS2, UBOUNDS=[YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS&
&%NDTPREC2, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZDPRECIPS, UBOUNDS=[YDCPG_OPTS%KLON, YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS&
&%NDTPREC, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
LLCALL_CPCFU=YDCFU%LCUMFU.AND.(.NOT.YDCPG_OPTS%LINITER).AND.(.NOT.YDCPG_OPTS&
&%LCONFX).AND.(.NOT.YDMODEL%YRML_PHY_EC%YREPHY%LAGPHY)
LLCALL_CPXFU=YDXFU%LXFU.AND.YDCPG_OPTS%LDIAB.AND.(.NOT&
&.YDCPG_OPTS%LINITER).AND..NOT.YDCPG_OPTS%L_DFISTEP
LLCALL_CUMCPLDM=(YDMODEL%YRML_AOC%YRMCC%NFRCPL/=0).AND.(YDMODEL%YRML_AOC%YRMCC&
&%NFRCPL<=YDMODEL%YRML_GCONF%YRRIP%NSTOP).AND.(.NOT.YDCPG_OPTS%LCONFX).AND.&
&(.NOT.YDMODEL%YRML_PHY_EC%YREPHY%LAGPHY).AND.(.NOT.YDCPG_OPTS%LAROME)

IF (LLCALL_CPCFU.OR.LLCALL_CPXFU.OR.LLCALL_CUMCPLDM) THEN
  IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_DIA_FLU_PARALLEL:0')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
    ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
    ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
    ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
    ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
    ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRDV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRTV)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      DO JLEV=0, YDCPG_OPTS%KFLEVG
        ZSTRCU (:, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRCU (:, JLEV, JBLK)
        ZSTRCV (:, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRCV (:, JLEV, JBLK)
        ZSTRDU (:, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRDU (:, JLEV, JBLK)
        ZSTRDV (:, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRDV (:, JLEV, JBLK)
        ZSTRTU (:, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU (:, JLEV, JBLK)
        ZSTRTV (:, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV (:, JLEV, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:0')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
      ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
      ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
      ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
      ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
      ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
      Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRCU)
      Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRCV)
      Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRDU)
      Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRDV)
      Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRTU)
      Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRTV)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZSTRCU => NULL ()
    ZSTRCV => NULL ()
    ZSTRDU => NULL ()
    ZSTRDV => NULL ()
    ZSTRTU => NULL ()
    ZSTRTV => NULL ()
    Z_YDMF_PHYS_OUT_STRCU => NULL ()
    Z_YDMF_PHYS_OUT_STRCV => NULL ()
    Z_YDMF_PHYS_OUT_STRDU => NULL ()
    Z_YDMF_PHYS_OUT_STRDV => NULL ()
    Z_YDMF_PHYS_OUT_STRTU => NULL ()
    Z_YDMF_PHYS_OUT_STRTV => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:0')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
    ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
    ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
    ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
    ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
    ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
    Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRDV)
    Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_STRTV)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        DO JLEV=0, YDCPG_OPTS%KFLEVG
          ZSTRCU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRCU (JLON, JLEV, JBLK)
          ZSTRCV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRCV (JLON, JLEV, JBLK)
          ZSTRDU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRDU (JLON, JLEV, JBLK)
          ZSTRDV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRDV (JLON, JLEV, JBLK)
          ZSTRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)
          ZSTRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:0')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
      ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
      ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
      ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
      ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
      ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
      Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRCU)
      Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRCV)
      Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRDU)
      Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRDV)
      Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRTU)
      Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRTV)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZSTRCU => NULL ()
    ZSTRCV => NULL ()
    ZSTRDU => NULL ()
    ZSTRDV => NULL ()
    ZSTRTU => NULL ()
    ZSTRTV => NULL ()
    Z_YDMF_PHYS_OUT_STRCU => NULL ()
    Z_YDMF_PHYS_OUT_STRCV => NULL ()
    Z_YDMF_PHYS_OUT_STRDU => NULL ()
    Z_YDMF_PHYS_OUT_STRDV => NULL ()
    Z_YDMF_PHYS_OUT_STRTU => NULL ()
    Z_YDMF_PHYS_OUT_STRTV => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:0')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZSTRCU => GET_DEVICE_DATA_RDWR (YL_ZSTRCU)
    ZSTRCV => GET_DEVICE_DATA_RDWR (YL_ZSTRCV)
    ZSTRDU => GET_DEVICE_DATA_RDWR (YL_ZSTRDU)
    ZSTRDV => GET_DEVICE_DATA_RDWR (YL_ZSTRDV)
    ZSTRTU => GET_DEVICE_DATA_RDWR (YL_ZSTRTU)
    ZSTRTV => GET_DEVICE_DATA_RDWR (YL_ZSTRTV)
    Z_YDMF_PHYS_OUT_STRCU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_STRCU)
    Z_YDMF_PHYS_OUT_STRCV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_STRCV)
    Z_YDMF_PHYS_OUT_STRDU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_STRDU)
    Z_YDMF_PHYS_OUT_STRDV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_STRDV)
    Z_YDMF_PHYS_OUT_STRTU => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_STRTU)
    Z_YDMF_PHYS_OUT_STRTV => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_STRTV)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZSTRCU, ZSTRCV, ZSTRDU, ZSTRDV, &
      !$ACC&         ZSTRTU, ZSTRTV, Z_YDMF_PHYS_OUT_STRCU, Z_YDMF_PHYS_OUT_STRCV, &
      !$ACC&         Z_YDMF_PHYS_OUT_STRDU, Z_YDMF_PHYS_OUT_STRDV, Z_YDMF_PHYS_OUT_STRTU, &
      !$ACC&         Z_YDMF_PHYS_OUT_STRTV) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        DO JLEV=0, YDCPG_OPTS%KFLEVG
          ZSTRCU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRCU (JLON, JLEV, JBLK)
          ZSTRCV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRCV (JLON, JLEV, JBLK)
          ZSTRDU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRDU (JLON, JLEV, JBLK)
          ZSTRDV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRDV (JLON, JLEV, JBLK)
          ZSTRTU (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTU (JLON, JLEV, JBLK)
          ZSTRTV (JLON, JLEV, JBLK)=Z_YDMF_PHYS_OUT_STRTV (JLON, JLEV, JBLK)
        ENDDO

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:0')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
      ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
      ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
      ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
      ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
      ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
      Z_YDMF_PHYS_OUT_STRCU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRCU)
      Z_YDMF_PHYS_OUT_STRCV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRCV)
      Z_YDMF_PHYS_OUT_STRDU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRDU)
      Z_YDMF_PHYS_OUT_STRDV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRDV)
      Z_YDMF_PHYS_OUT_STRTU => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRTU)
      Z_YDMF_PHYS_OUT_STRTV => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_STRTV)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZSTRCU => NULL ()
    ZSTRCV => NULL ()
    ZSTRDU => NULL ()
    ZSTRDV => NULL ()
    ZSTRTU => NULL ()
    ZSTRTV => NULL ()
    Z_YDMF_PHYS_OUT_STRCU => NULL ()
    Z_YDMF_PHYS_OUT_STRCV => NULL ()
    Z_YDMF_PHYS_OUT_STRDU => NULL ()
    Z_YDMF_PHYS_OUT_STRDV => NULL ()
    Z_YDMF_PHYS_OUT_STRTU => NULL ()
    Z_YDMF_PHYS_OUT_STRTV => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('CPG_DIA_FLU_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (LLCALL_CPXFU.OR.YDMODEL%YRML_PHY_G%YRDPHY%LDIRCLSMOD) THEN
  IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_DIA_FLU_PARALLEL:1')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
    ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
    ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
    ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
    ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
    ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
    Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_NUCLS)
    Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_NVCLS)
    Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_VGST)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      ZUCLS (:, JBLK)=Z_YDMF_PHYS_OUT_UCLS (:, JBLK)
      ZVCLS (:, JBLK)=Z_YDMF_PHYS_OUT_VCLS (:, JBLK)
      ZNUCLS (:, JBLK)=Z_YDMF_PHYS_OUT_NUCLS (:, JBLK)
      ZNVCLS (:, JBLK)=Z_YDMF_PHYS_OUT_NVCLS (:, JBLK)
      ZUGST (:, JBLK)=Z_YDMF_PHYS_OUT_UGST (:, JBLK)
      ZVGST (:, JBLK)=Z_YDMF_PHYS_OUT_VGST (:, JBLK)
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:1')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
      ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
      ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
      ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
      ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
      ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_NVCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_VGST)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZNUCLS => NULL ()
    ZNVCLS => NULL ()
    ZUCLS => NULL ()
    ZUGST => NULL ()
    ZVCLS => NULL ()
    ZVGST => NULL ()
    Z_YDMF_PHYS_OUT_NUCLS => NULL ()
    Z_YDMF_PHYS_OUT_NVCLS => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:1')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
    ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
    ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
    ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
    ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
    ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
    Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_NUCLS)
    Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_NVCLS)
    Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDONLY (YDMF_PHYS_OUT%F_VGST)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZUCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_UCLS (JLON, JBLK)
        ZVCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_VCLS (JLON, JBLK)
        ZNUCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_NUCLS (JLON, JBLK)
        ZNVCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_NVCLS (JLON, JBLK)
        ZUGST (JLON, JBLK)=Z_YDMF_PHYS_OUT_UGST (JLON, JBLK)
        ZVGST (JLON, JBLK)=Z_YDMF_PHYS_OUT_VGST (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:1')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
      ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
      ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
      ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
      ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
      ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_NVCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_VGST)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZNUCLS => NULL ()
    ZNVCLS => NULL ()
    ZUCLS => NULL ()
    ZUGST => NULL ()
    ZVCLS => NULL ()
    ZVGST => NULL ()
    Z_YDMF_PHYS_OUT_NUCLS => NULL ()
    Z_YDMF_PHYS_OUT_NVCLS => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:1')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZNUCLS => GET_DEVICE_DATA_RDWR (YL_ZNUCLS)
    ZNVCLS => GET_DEVICE_DATA_RDWR (YL_ZNVCLS)
    ZUCLS => GET_DEVICE_DATA_RDWR (YL_ZUCLS)
    ZUGST => GET_DEVICE_DATA_RDWR (YL_ZUGST)
    ZVCLS => GET_DEVICE_DATA_RDWR (YL_ZVCLS)
    ZVGST => GET_DEVICE_DATA_RDWR (YL_ZVGST)
    Z_YDMF_PHYS_OUT_NUCLS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_NUCLS)
    Z_YDMF_PHYS_OUT_NVCLS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_NVCLS)
    Z_YDMF_PHYS_OUT_UCLS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_UCLS)
    Z_YDMF_PHYS_OUT_UGST => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_UGST)
    Z_YDMF_PHYS_OUT_VCLS => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_VCLS)
    Z_YDMF_PHYS_OUT_VGST => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_OUT%F_VGST)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZNUCLS, ZNVCLS, ZUCLS, ZUGST, ZVCLS, &
      !$ACC&         ZVGST, Z_YDMF_PHYS_OUT_NUCLS, Z_YDMF_PHYS_OUT_NVCLS, Z_YDMF_PHYS_OUT_UCLS, &
      !$ACC&         Z_YDMF_PHYS_OUT_UGST, Z_YDMF_PHYS_OUT_VCLS, Z_YDMF_PHYS_OUT_VGST) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZUCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_UCLS (JLON, JBLK)
        ZVCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_VCLS (JLON, JBLK)
        ZNUCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_NUCLS (JLON, JBLK)
        ZNVCLS (JLON, JBLK)=Z_YDMF_PHYS_OUT_NVCLS (JLON, JBLK)
        ZUGST (JLON, JBLK)=Z_YDMF_PHYS_OUT_UGST (JLON, JBLK)
        ZVGST (JLON, JBLK)=Z_YDMF_PHYS_OUT_VGST (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:1')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
      ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
      ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
      ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
      ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
      ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
      Z_YDMF_PHYS_OUT_NUCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_NUCLS)
      Z_YDMF_PHYS_OUT_NVCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_NVCLS)
      Z_YDMF_PHYS_OUT_UCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_UCLS)
      Z_YDMF_PHYS_OUT_UGST => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_UGST)
      Z_YDMF_PHYS_OUT_VCLS => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_VCLS)
      Z_YDMF_PHYS_OUT_VGST => GET_HOST_DATA_RDWR (YDMF_PHYS_OUT%F_VGST)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZNUCLS => NULL ()
    ZNVCLS => NULL ()
    ZUCLS => NULL ()
    ZUGST => NULL ()
    ZVCLS => NULL ()
    ZVGST => NULL ()
    Z_YDMF_PHYS_OUT_NUCLS => NULL ()
    Z_YDMF_PHYS_OUT_NVCLS => NULL ()
    Z_YDMF_PHYS_OUT_UCLS => NULL ()
    Z_YDMF_PHYS_OUT_UGST => NULL ()
    Z_YDMF_PHYS_OUT_VCLS => NULL ()
    Z_YDMF_PHYS_OUT_VGST => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('CPG_DIA_FLU_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
ENDIF


IF (YDCPG_OPTS%LDIAB.OR.(YDMODEL%YRML_PHY_MF%YRSIMPHL%LSIMPH&
  &.AND.(.NOT.YDMODEL%YRML_PHY_MF%YRSIMPHL%LTRAJPS))) THEN

  IF (LLCALL_CPCFU.OR.LLCALL_CPXFU.OR.LLCALL_CUMCPLDM) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_DIA_FLU_PARALLEL:2')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
      ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
      ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
      ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
      ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
      ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
      Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)

        

        DO JLEV=0, YDCPG_OPTS%KFLEVG
          ZSTRCU (:, JLEV, JBLK)=ZSTRCU (:, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
          ZSTRCV (:, JLEV, JBLK)=ZSTRCV (:, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
          ZSTRDU (:, JLEV, JBLK)=ZSTRDU (:, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
          ZSTRDV (:, JLEV, JBLK)=ZSTRDV (:, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
          ZSTRTU (:, JLEV, JBLK)=ZSTRTU (:, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
          ZSTRTV (:, JLEV, JBLK)=ZSTRTV (:, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:2')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
        ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
        ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
        ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
        ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
        ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
        Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => NULL ()
      ZSTRCV => NULL ()
      ZSTRDU => NULL ()
      ZSTRDV => NULL ()
      ZSTRTU => NULL ()
      ZSTRTV => NULL ()
      Z_YDVARS_GEOMETRY_GM_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:2')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
      ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
      ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
      ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
      ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
      ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
      Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JLON, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON

          

          DO JLEV=0, YDCPG_OPTS%KFLEVG
            ZSTRCU (JLON, JLEV, JBLK)=ZSTRCU (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRCV (JLON, JLEV, JBLK)=ZSTRCV (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRDU (JLON, JLEV, JBLK)=ZSTRDU (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRDV (JLON, JLEV, JBLK)=ZSTRDV (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRTU (JLON, JLEV, JBLK)=ZSTRTU (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRTV (JLON, JLEV, JBLK)=ZSTRTV (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ENDDO

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:2')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
        ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
        ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
        ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
        ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
        ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
        Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => NULL ()
      ZSTRCV => NULL ()
      ZSTRDU => NULL ()
      ZSTRDV => NULL ()
      ZSTRTU => NULL ()
      ZSTRTV => NULL ()
      Z_YDVARS_GEOMETRY_GM_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:2')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => GET_DEVICE_DATA_RDWR (YL_ZSTRCU)
      ZSTRCV => GET_DEVICE_DATA_RDWR (YL_ZSTRCV)
      ZSTRDU => GET_DEVICE_DATA_RDWR (YL_ZSTRDU)
      ZSTRDV => GET_DEVICE_DATA_RDWR (YL_ZSTRDV)
      ZSTRTU => GET_DEVICE_DATA_RDWR (YL_ZSTRTU)
      ZSTRTV => GET_DEVICE_DATA_RDWR (YL_ZSTRTV)
      Z_YDVARS_GEOMETRY_GM_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZSTRCU, ZSTRCV, ZSTRDU, ZSTRDV, &
        !$ACC&         ZSTRTU, ZSTRTV, Z_YDVARS_GEOMETRY_GM_P) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLEV, JLON, YLCPG_BNDS) 

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON

          

          DO JLEV=0, YDCPG_OPTS%KFLEVG
            ZSTRCU (JLON, JLEV, JBLK)=ZSTRCU (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRCV (JLON, JLEV, JBLK)=ZSTRCV (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRDU (JLON, JLEV, JBLK)=ZSTRDU (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRDV (JLON, JLEV, JBLK)=ZSTRDV (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRTU (JLON, JLEV, JBLK)=ZSTRTU (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
            ZSTRTV (JLON, JLEV, JBLK)=ZSTRTV (JLON, JLEV, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ENDDO

        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:2')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZSTRCU => GET_HOST_DATA_RDWR (YL_ZSTRCU)
        ZSTRCV => GET_HOST_DATA_RDWR (YL_ZSTRCV)
        ZSTRDU => GET_HOST_DATA_RDWR (YL_ZSTRDU)
        ZSTRDV => GET_HOST_DATA_RDWR (YL_ZSTRDV)
        ZSTRTU => GET_HOST_DATA_RDWR (YL_ZSTRTU)
        ZSTRTV => GET_HOST_DATA_RDWR (YL_ZSTRTV)
        Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZSTRCU => NULL ()
      ZSTRCV => NULL ()
      ZSTRDU => NULL ()
      ZSTRDV => NULL ()
      ZSTRTU => NULL ()
      ZSTRTV => NULL ()
      Z_YDVARS_GEOMETRY_GM_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('CPG_DIA_FLU_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:2',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF


  IF (LLCALL_CPXFU.OR.YDMODEL%YRML_PHY_G%YRDPHY%LDIRCLSMOD) THEN
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3',0,ZHOOK_HANDLE_PARALLEL)

    IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_DIA_FLU_PARALLEL:3')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
      ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
      ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
      ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
      ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
      ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
      Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
      !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        CALL YLCPG_BNDS%UPDATE (JBLK)
        
        ZUCLS (:, JBLK)=ZUCLS (:, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
        ZVCLS (:, JBLK)=ZVCLS (:, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
        ZNUCLS (:, JBLK)=ZNUCLS (:, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
        ZNVCLS (:, JBLK)=ZNVCLS (:, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
        ZUGST (:, JBLK)=ZUGST (:, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
        ZVGST (:, JBLK)=ZVGST (:, JBLK)/Z_YDVARS_GEOMETRY_GM_P (:, JBLK)
      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:3')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
        ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
        ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
        ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
        ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
        ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
        Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => NULL ()
      ZNVCLS => NULL ()
      ZUCLS => NULL ()
      ZUGST => NULL ()
      ZVCLS => NULL ()
      ZVGST => NULL ()
      Z_YDVARS_GEOMETRY_GM_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:3')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
      ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
      ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
      ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
      ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
      ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
      Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

        

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          
          ZUCLS (JLON, JBLK)=ZUCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZVCLS (JLON, JBLK)=ZVCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZNUCLS (JLON, JBLK)=ZNUCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZNVCLS (JLON, JBLK)=ZNVCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZUGST (JLON, JBLK)=ZUGST (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZVGST (JLON, JBLK)=ZVGST (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:3')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
        ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
        ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
        ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
        ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
        ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
        Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => NULL ()
      ZNVCLS => NULL ()
      ZUCLS => NULL ()
      ZUGST => NULL ()
      ZVCLS => NULL ()
      ZVGST => NULL ()
      Z_YDVARS_GEOMETRY_GM_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:3')) THEN
      
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => GET_DEVICE_DATA_RDWR (YL_ZNUCLS)
      ZNVCLS => GET_DEVICE_DATA_RDWR (YL_ZNVCLS)
      ZUCLS => GET_DEVICE_DATA_RDWR (YL_ZUCLS)
      ZUGST => GET_DEVICE_DATA_RDWR (YL_ZUGST)
      ZVCLS => GET_DEVICE_DATA_RDWR (YL_ZVCLS)
      ZVGST => GET_DEVICE_DATA_RDWR (YL_ZVGST)
      Z_YDVARS_GEOMETRY_GM_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GM%FT0)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
      
      
        !$ACC PARALLEL LOOP GANG &
        !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZNUCLS, ZNVCLS, ZUCLS, ZUGST, ZVCLS, &
        !$ACC&         ZVGST, Z_YDVARS_GEOMETRY_GM_P) &
        !$ACC&PRIVATE (JBLK) &
        !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
        
        DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
        
        
        
        !$ACC LOOP VECTOR &
        !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

        

        DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
          YLCPG_BNDS%KIDIA = JLON
          YLCPG_BNDS%KFDIA = JLON
          
          ZUCLS (JLON, JBLK)=ZUCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZVCLS (JLON, JBLK)=ZVCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZNUCLS (JLON, JBLK)=ZNUCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZNVCLS (JLON, JBLK)=ZNVCLS (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZUGST (JLON, JBLK)=ZUGST (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
          ZVGST (JLON, JBLK)=ZVGST (JLON, JBLK)/Z_YDVARS_GEOMETRY_GM_P (JLON, JBLK)
        ENDDO

      ENDDO

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

      IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:3')) THEN
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
        ZNUCLS => GET_HOST_DATA_RDWR (YL_ZNUCLS)
        ZNVCLS => GET_HOST_DATA_RDWR (YL_ZNVCLS)
        ZUCLS => GET_HOST_DATA_RDWR (YL_ZUCLS)
        ZUGST => GET_HOST_DATA_RDWR (YL_ZUGST)
        ZVCLS => GET_HOST_DATA_RDWR (YL_ZVCLS)
        ZVGST => GET_HOST_DATA_RDWR (YL_ZVGST)
        Z_YDVARS_GEOMETRY_GM_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GM%FT0)
        IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
        
        
      ENDIF

      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
      ZNUCLS => NULL ()
      ZNVCLS => NULL ()
      ZUCLS => NULL ()
      ZUGST => NULL ()
      ZVCLS => NULL ()
      ZVGST => NULL ()
      Z_YDVARS_GEOMETRY_GM_P => NULL ()
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ELSE
        CALL ABOR1 ('CPG_DIA_FLU_PARALLEL: NOT METHOD WAS FOUND')
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:3',1,ZHOOK_HANDLE_PARALLEL)
  ENDIF

ENDIF


IF (LLCALL_CPCFU) THEN
  CALL CPCFU_PARALLEL (YDMODEL%YRCST, YDCFU, YDMODEL%YRML_GCONF%YRRIP, YDCPG_OPTS&
  &, YDCPG_BNDS, YDMF_PHYS_OUT, YDCPG_MISC, YDCPG_DYN0, YDVARS, YDMF_PHYS_SURF&
  &, YL_ZSTRCU, YL_ZSTRCV, YL_ZSTRDU, YL_ZSTRDV, YL_ZSTRTU, YL_ZSTRTV)
ENDIF


IF (LLCALL_CUMCPLDM) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (LLCALL_CPXFU) THEN
  IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','CPG_DIA_FLU_PARALLEL:4')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDPRECIPS => GET_HOST_DATA_RDWR (YL_ZDPRECIPS)
    ZDPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZDPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)

      

      IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS) THEN
        ZDPRECIPS (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC, JBLK)=Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP&
        & (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC, JBLK)
      ENDIF


      IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS2) THEN
        ZDPRECIPS2 (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC2, JBLK)=Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2&
        & (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC2, JBLK)
      ENDIF

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:4')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDPRECIPS => GET_HOST_DATA_RDWR (YL_ZDPRECIPS)
      ZDPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZDPRECIPS2)
      Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
      Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDPRECIPS => NULL ()
    ZDPRECIPS2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:4')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDPRECIPS => GET_HOST_DATA_RDWR (YL_ZDPRECIPS)
    ZDPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZDPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDONLY (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS) THEN
          ZDPRECIPS (JLON, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC, JBLK)=Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP&
          & (JLON, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC, JBLK)
        ENDIF


        IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS2) THEN
          ZDPRECIPS2 (JLON, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC2, JBLK)=Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2&
          & (JLON, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC2, JBLK)
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:4')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDPRECIPS => GET_HOST_DATA_RDWR (YL_ZDPRECIPS)
      ZDPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZDPRECIPS2)
      Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
      Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDPRECIPS => NULL ()
    ZDPRECIPS2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','CPG_DIA_FLU_PARALLEL:4')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    ZDPRECIPS => GET_DEVICE_DATA_RDWR (YL_ZDPRECIPS)
    ZDPRECIPS2 => GET_DEVICE_DATA_RDWR (YL_ZDPRECIPS2)
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_DEVICE_DATA_RDONLY (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (YDCPG_OPTS, YDMODEL, YFXTRAN_ACDC_STACK, ZDPRECIPS, ZDPRECIPS2, &
      !$ACC&         Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2, Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON

        

        IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZDPRECIPS (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC, JBLK&
          &), Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC, JBLK))
        ENDIF


        IF (YDMODEL%YRML_PHY_MF%YRPHY%LDPRECIPS2) THEN
          CALL FXTRAN_ACDC_ARRAY_COPY (JLON, ZDPRECIPS2 (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC2, JBLK&
          &), Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 (:, 1:YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS%NDTPREC2, JBLK))
        ENDIF

      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('CPG_DIA_FLU_PARALLEL:4')) THEN
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      ZDPRECIPS => GET_HOST_DATA_RDWR (YL_ZDPRECIPS)
      ZDPRECIPS2 => GET_HOST_DATA_RDWR (YL_ZDPRECIPS2)
      Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP2%F_PRECIP2)
      Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => GET_HOST_DATA_RDWR (YDMF_PHYS_SURF%GSD_XP%F_PRECIP)
      IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    ZDPRECIPS => NULL ()
    ZDPRECIPS2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_XP2_PPRECIP2 => NULL ()
    Z_YDMF_PHYS_SURF_GSD_XP_PPRECIP => NULL ()
    IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('CPG_DIA_FLU_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL:4',1,ZHOOK_HANDLE_PARALLEL)
  CALL CPXFU_PARALLEL (YDXFU, YDMODEL%YRML_PHY_MF%YRPHY%YRDPRECIPS, YDCPG_OPTS, YDCPG_BNDS, YDMF_PHYS_OUT&
  &, YDCPG_MISC, YL_ZSTRCU, YL_ZSTRCV, YL_ZSTRDU, YL_ZSTRDV, YL_ZSTRTU, YL_ZSTRTV, YL_ZUCLS, YL_ZVCLS&
  &, YL_ZNUCLS, YL_ZNVCLS, YL_ZUGST, YL_ZVGST, YL_ZDPRECIPS, YL_ZDPRECIPS2)
ENDIF


IF (YDMODEL%YRML_PHY_G%YRDPHY%LDIRCLSMOD) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (LXIOS) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZDPRECIPS)) CALL FIELD_DELETE (YL_ZDPRECIPS)
IF (ASSOCIATED (YL_ZDPRECIPS2)) CALL FIELD_DELETE (YL_ZDPRECIPS2)
IF (ASSOCIATED (YL_ZNUCLS)) CALL FIELD_DELETE (YL_ZNUCLS)
IF (ASSOCIATED (YL_ZNVCLS)) CALL FIELD_DELETE (YL_ZNVCLS)
IF (ASSOCIATED (YL_ZSTRCU)) CALL FIELD_DELETE (YL_ZSTRCU)
IF (ASSOCIATED (YL_ZSTRCV)) CALL FIELD_DELETE (YL_ZSTRCV)
IF (ASSOCIATED (YL_ZSTRDU)) CALL FIELD_DELETE (YL_ZSTRDU)
IF (ASSOCIATED (YL_ZSTRDV)) CALL FIELD_DELETE (YL_ZSTRDV)
IF (ASSOCIATED (YL_ZSTRTU)) CALL FIELD_DELETE (YL_ZSTRTU)
IF (ASSOCIATED (YL_ZSTRTV)) CALL FIELD_DELETE (YL_ZSTRTV)
IF (ASSOCIATED (YL_ZUCLS)) CALL FIELD_DELETE (YL_ZUCLS)
IF (ASSOCIATED (YL_ZUGST)) CALL FIELD_DELETE (YL_ZUGST)
IF (ASSOCIATED (YL_ZVCLS)) CALL FIELD_DELETE (YL_ZVCLS)
IF (ASSOCIATED (YL_ZVGST)) CALL FIELD_DELETE (YL_ZVGST)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('CPG_DIA_FLU_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE CPG_DIA_FLU_PARALLEL
