MODULE UTIL_TEWCOU_MOD

USE YOEWCOU, ONLY : TEWCOU

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TEWCOU
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TEWCOU
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TEWCOU
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TEWCOU
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TEWCOU
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TEWCOU
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TEWCOU
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TEWCOU (SELF, KLUN)

IMPLICIT NONE
TYPE (TEWCOU), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
WRITE (KLUN) SELF%NATMFLX
WRITE (KLUN) SELF%NGAUSSW
WRITE (KLUN) SELF%NLONW
WRITE (KLUN) SELF%NLATW
WRITE (KLUN) SELF%NLON1W
WRITE (KLUN) SELF%NLAT1W
WRITE (KLUN) SELF%NNORXW
WRITE (KLUN) SELF%NSTPW
WRITE (KLUN) SELF%NGRIB_HANDLE_FOR_WAM
WRITE (KLUN) SELF%RSOUTW
WRITE (KLUN) SELF%RNORTW
WRITE (KLUN) SELF%RDEGREW
WRITE (KLUN) SELF%RMISSW
WRITE (KLUN) SELF%LWCOU
WRITE (KLUN) SELF%LWCOU2W
WRITE (KLUN) SELF%LWCOUNORMS
WRITE (KLUN) SELF%LWCUR
WRITE (KLUN) SELF%LWCOURNW
WRITE (KLUN) SELF%LWCOUHMF
WRITE (KLUN) SELF%LWSTOKES
WRITE (KLUN) SELF%LWFLUX
WRITE (KLUN) SELF%CBEGDAT
LMASK_WAVE_IN = ALLOCATED (SELF%MASK_WAVE_IN)
WRITE (KLUN) LMASK_WAVE_IN
IF (LMASK_WAVE_IN) THEN
  WRITE (KLUN) LBOUND (SELF%MASK_WAVE_IN)
  WRITE (KLUN) UBOUND (SELF%MASK_WAVE_IN)
  WRITE (KLUN) SELF%MASK_WAVE_IN
ENDIF
LMASK_WAVE_OUT = ALLOCATED (SELF%MASK_WAVE_OUT)
WRITE (KLUN) LMASK_WAVE_OUT
IF (LMASK_WAVE_OUT) THEN
  WRITE (KLUN) LBOUND (SELF%MASK_WAVE_OUT)
  WRITE (KLUN) UBOUND (SELF%MASK_WAVE_OUT)
  WRITE (KLUN) SELF%MASK_WAVE_OUT
ENDIF
WRITE (KLUN) SELF%LWVIN_MASK_NOT_SET
WRITE (KLUN) SELF%LWVOUT_MASK_NOT_SET
WRITE (KLUN) SELF%LWVIN_UNINITIALISED
WRITE (KLUN) SELF%MWVIN_SENDTOT
WRITE (KLUN) SELF%MWVIN_RECVTOT
LMWVIN_SENDCNT = ALLOCATED (SELF%MWVIN_SENDCNT)
WRITE (KLUN) LMWVIN_SENDCNT
IF (LMWVIN_SENDCNT) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDCNT)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDCNT)
  WRITE (KLUN) SELF%MWVIN_SENDCNT
ENDIF
LMWVIN_RECVCNT = ALLOCATED (SELF%MWVIN_RECVCNT)
WRITE (KLUN) LMWVIN_RECVCNT
IF (LMWVIN_RECVCNT) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_RECVCNT)
  WRITE (KLUN) UBOUND (SELF%MWVIN_RECVCNT)
  WRITE (KLUN) SELF%MWVIN_RECVCNT
ENDIF
LMWVIN_SENDOFF = ALLOCATED (SELF%MWVIN_SENDOFF)
WRITE (KLUN) LMWVIN_SENDOFF
IF (LMWVIN_SENDOFF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDOFF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDOFF)
  WRITE (KLUN) SELF%MWVIN_SENDOFF
ENDIF
LMWVIN_RECVOFF = ALLOCATED (SELF%MWVIN_RECVOFF)
WRITE (KLUN) LMWVIN_RECVOFF
IF (LMWVIN_RECVOFF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_RECVOFF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_RECVOFF)
  WRITE (KLUN) SELF%MWVIN_RECVOFF
ENDIF
LMWVIN_SENDBUF = ALLOCATED (SELF%MWVIN_SENDBUF)
WRITE (KLUN) LMWVIN_SENDBUF
IF (LMWVIN_SENDBUF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDBUF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDBUF)
  WRITE (KLUN) SELF%MWVIN_SENDBUF
ENDIF
LMWVIN_RECVBUF = ALLOCATED (SELF%MWVIN_RECVBUF)
WRITE (KLUN) LMWVIN_RECVBUF
IF (LMWVIN_RECVBUF) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_RECVBUF)
  WRITE (KLUN) UBOUND (SELF%MWVIN_RECVBUF)
  WRITE (KLUN) SELF%MWVIN_RECVBUF
ENDIF
LMWVIN_SENDIND = ALLOCATED (SELF%MWVIN_SENDIND)
WRITE (KLUN) LMWVIN_SENDIND
IF (LMWVIN_SENDIND) THEN
  WRITE (KLUN) LBOUND (SELF%MWVIN_SENDIND)
  WRITE (KLUN) UBOUND (SELF%MWVIN_SENDIND)
  WRITE (KLUN) SELF%MWVIN_SENDIND
ENDIF
WRITE (KLUN) SELF%LWFRSTIME
WRITE (KLUN) SELF%LWINIT
WRITE (KLUN) SELF%NADV_WAVE
WRITE (KLUN) SELF%NWV_W2IWGHT
LIWV_LON = ALLOCATED (SELF%IWV_LON)
WRITE (KLUN) LIWV_LON
IF (LIWV_LON) THEN
  WRITE (KLUN) LBOUND (SELF%IWV_LON)
  WRITE (KLUN) UBOUND (SELF%IWV_LON)
  WRITE (KLUN) SELF%IWV_LON
ENDIF
LIWV_LAT = ALLOCATED (SELF%IWV_LAT)
WRITE (KLUN) LIWV_LAT
IF (LIWV_LAT) THEN
  WRITE (KLUN) LBOUND (SELF%IWV_LAT)
  WRITE (KLUN) UBOUND (SELF%IWV_LAT)
  WRITE (KLUN) SELF%IWV_LAT
ENDIF
LWV_W2IWGHT = ALLOCATED (SELF%WV_W2IWGHT)
WRITE (KLUN) LWV_W2IWGHT
IF (LWV_W2IWGHT) THEN
  WRITE (KLUN) LBOUND (SELF%WV_W2IWGHT)
  WRITE (KLUN) UBOUND (SELF%WV_W2IWGHT)
  WRITE (KLUN) SELF%WV_W2IWGHT
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TEWCOU (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TEWCOU), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2)
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
READ (KLUN) SELF%NATMFLX
READ (KLUN) SELF%NGAUSSW
READ (KLUN) SELF%NLONW
READ (KLUN) SELF%NLATW
READ (KLUN) SELF%NLON1W
READ (KLUN) SELF%NLAT1W
READ (KLUN) SELF%NNORXW
READ (KLUN) SELF%NSTPW
READ (KLUN) SELF%NGRIB_HANDLE_FOR_WAM
READ (KLUN) ZTMP0
SELF%RSOUTW = ZTMP0
READ (KLUN) ZTMP0
SELF%RNORTW = ZTMP0
READ (KLUN) ZTMP0
SELF%RDEGREW = ZTMP0
READ (KLUN) ZTMP0
SELF%RMISSW = ZTMP0
READ (KLUN) SELF%LWCOU
READ (KLUN) SELF%LWCOU2W
READ (KLUN) SELF%LWCOUNORMS
READ (KLUN) SELF%LWCUR
READ (KLUN) SELF%LWCOURNW
READ (KLUN) SELF%LWCOUHMF
READ (KLUN) SELF%LWSTOKES
READ (KLUN) SELF%LWFLUX
READ (KLUN) SELF%CBEGDAT
READ (KLUN) LMASK_WAVE_IN
IF (LMASK_WAVE_IN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MASK_WAVE_IN (IL1(1):IU1(1)))
  READ (KLUN) SELF%MASK_WAVE_IN
ENDIF
READ (KLUN) LMASK_WAVE_OUT
IF (LMASK_WAVE_OUT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%MASK_WAVE_OUT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%MASK_WAVE_OUT
ENDIF
READ (KLUN) SELF%LWVIN_MASK_NOT_SET
READ (KLUN) SELF%LWVOUT_MASK_NOT_SET
READ (KLUN) SELF%LWVIN_UNINITIALISED
READ (KLUN) SELF%MWVIN_SENDTOT
READ (KLUN) SELF%MWVIN_RECVTOT
READ (KLUN) LMWVIN_SENDCNT
IF (LMWVIN_SENDCNT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDCNT (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDCNT
ENDIF
READ (KLUN) LMWVIN_RECVCNT
IF (LMWVIN_RECVCNT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_RECVCNT (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_RECVCNT
ENDIF
READ (KLUN) LMWVIN_SENDOFF
IF (LMWVIN_SENDOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDOFF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDOFF
ENDIF
READ (KLUN) LMWVIN_RECVOFF
IF (LMWVIN_RECVOFF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_RECVOFF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_RECVOFF
ENDIF
READ (KLUN) LMWVIN_SENDBUF
IF (LMWVIN_SENDBUF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDBUF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDBUF
ENDIF
READ (KLUN) LMWVIN_RECVBUF
IF (LMWVIN_RECVBUF) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_RECVBUF (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_RECVBUF
ENDIF
READ (KLUN) LMWVIN_SENDIND
IF (LMWVIN_SENDIND) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%MWVIN_SENDIND (IL1(1):IU1(1)))
  READ (KLUN) SELF%MWVIN_SENDIND
ENDIF
READ (KLUN) SELF%LWFRSTIME
READ (KLUN) SELF%LWINIT
READ (KLUN) SELF%NADV_WAVE
READ (KLUN) SELF%NWV_W2IWGHT
READ (KLUN) LIWV_LON
IF (LIWV_LON) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%IWV_LON (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%IWV_LON
ENDIF
READ (KLUN) LIWV_LAT
IF (LIWV_LAT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%IWV_LAT (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%IWV_LAT
ENDIF
READ (KLUN) LWV_W2IWGHT
IF (LWV_W2IWGHT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%WV_W2IWGHT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%WV_W2IWGHT,1):UBOUND(SELF%WV_W2IWGHT,1), LBOUND(SELF%WV_W2IWGHT,2):UBOUND(SELF%WV_W2IWGHT,2)))
  READ (KLUN) ZTMP2
  SELF%WV_W2IWGHT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TEWCOU (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TEWCOU), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

LMASK_WAVE_IN = ALLOCATED (SELF%MASK_WAVE_IN)
IF (LMASK_WAVE_IN) THEN
  !$ACC ENTER DATA CREATE (SELF%MASK_WAVE_IN)
  !$ACC UPDATE DEVICE (SELF%MASK_WAVE_IN)
  !$ACC ENTER DATA ATTACH (SELF%MASK_WAVE_IN)
ENDIF

LMASK_WAVE_OUT = ALLOCATED (SELF%MASK_WAVE_OUT)
IF (LMASK_WAVE_OUT) THEN
  !$ACC ENTER DATA CREATE (SELF%MASK_WAVE_OUT)
  !$ACC UPDATE DEVICE (SELF%MASK_WAVE_OUT)
  !$ACC ENTER DATA ATTACH (SELF%MASK_WAVE_OUT)
ENDIF

LMWVIN_SENDCNT = ALLOCATED (SELF%MWVIN_SENDCNT)
IF (LMWVIN_SENDCNT) THEN
  !$ACC ENTER DATA CREATE (SELF%MWVIN_SENDCNT)
  !$ACC UPDATE DEVICE (SELF%MWVIN_SENDCNT)
  !$ACC ENTER DATA ATTACH (SELF%MWVIN_SENDCNT)
ENDIF

LMWVIN_RECVCNT = ALLOCATED (SELF%MWVIN_RECVCNT)
IF (LMWVIN_RECVCNT) THEN
  !$ACC ENTER DATA CREATE (SELF%MWVIN_RECVCNT)
  !$ACC UPDATE DEVICE (SELF%MWVIN_RECVCNT)
  !$ACC ENTER DATA ATTACH (SELF%MWVIN_RECVCNT)
ENDIF

LMWVIN_SENDOFF = ALLOCATED (SELF%MWVIN_SENDOFF)
IF (LMWVIN_SENDOFF) THEN
  !$ACC ENTER DATA CREATE (SELF%MWVIN_SENDOFF)
  !$ACC UPDATE DEVICE (SELF%MWVIN_SENDOFF)
  !$ACC ENTER DATA ATTACH (SELF%MWVIN_SENDOFF)
ENDIF

LMWVIN_RECVOFF = ALLOCATED (SELF%MWVIN_RECVOFF)
IF (LMWVIN_RECVOFF) THEN
  !$ACC ENTER DATA CREATE (SELF%MWVIN_RECVOFF)
  !$ACC UPDATE DEVICE (SELF%MWVIN_RECVOFF)
  !$ACC ENTER DATA ATTACH (SELF%MWVIN_RECVOFF)
ENDIF

LMWVIN_SENDBUF = ALLOCATED (SELF%MWVIN_SENDBUF)
IF (LMWVIN_SENDBUF) THEN
  !$ACC ENTER DATA CREATE (SELF%MWVIN_SENDBUF)
  !$ACC UPDATE DEVICE (SELF%MWVIN_SENDBUF)
  !$ACC ENTER DATA ATTACH (SELF%MWVIN_SENDBUF)
ENDIF

LMWVIN_RECVBUF = ALLOCATED (SELF%MWVIN_RECVBUF)
IF (LMWVIN_RECVBUF) THEN
  !$ACC ENTER DATA CREATE (SELF%MWVIN_RECVBUF)
  !$ACC UPDATE DEVICE (SELF%MWVIN_RECVBUF)
  !$ACC ENTER DATA ATTACH (SELF%MWVIN_RECVBUF)
ENDIF

LMWVIN_SENDIND = ALLOCATED (SELF%MWVIN_SENDIND)
IF (LMWVIN_SENDIND) THEN
  !$ACC ENTER DATA CREATE (SELF%MWVIN_SENDIND)
  !$ACC UPDATE DEVICE (SELF%MWVIN_SENDIND)
  !$ACC ENTER DATA ATTACH (SELF%MWVIN_SENDIND)
ENDIF

LIWV_LON = ALLOCATED (SELF%IWV_LON)
IF (LIWV_LON) THEN
  !$ACC ENTER DATA CREATE (SELF%IWV_LON)
  !$ACC UPDATE DEVICE (SELF%IWV_LON)
  !$ACC ENTER DATA ATTACH (SELF%IWV_LON)
ENDIF

LIWV_LAT = ALLOCATED (SELF%IWV_LAT)
IF (LIWV_LAT) THEN
  !$ACC ENTER DATA CREATE (SELF%IWV_LAT)
  !$ACC UPDATE DEVICE (SELF%IWV_LAT)
  !$ACC ENTER DATA ATTACH (SELF%IWV_LAT)
ENDIF

LWV_W2IWGHT = ALLOCATED (SELF%WV_W2IWGHT)
IF (LWV_W2IWGHT) THEN
  !$ACC ENTER DATA CREATE (SELF%WV_W2IWGHT)
  !$ACC UPDATE DEVICE (SELF%WV_W2IWGHT)
  !$ACC ENTER DATA ATTACH (SELF%WV_W2IWGHT)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TEWCOU (SELF)

IMPLICIT NONE
TYPE (TEWCOU), TARGET :: SELF
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TEWCOU (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TEWCOU), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NATMFLX), CDPATH//'%NATMFLX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NGAUSSW), CDPATH//'%NGAUSSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLONW), CDPATH//'%NLONW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLATW), CDPATH//'%NLATW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLON1W), CDPATH//'%NLON1W'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NLAT1W), CDPATH//'%NLAT1W'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NNORXW), CDPATH//'%NNORXW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NSTPW), CDPATH//'%NSTPW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NGRIB_HANDLE_FOR_WAM), CDPATH//'%NGRIB_HANDLE_FOR_WAM'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RSOUTW), CDPATH//'%RSOUTW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RNORTW), CDPATH//'%RNORTW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDEGREW), CDPATH//'%RDEGREW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RMISSW), CDPATH//'%RMISSW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWCOU), CDPATH//'%LWCOU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWCOU2W), CDPATH//'%LWCOU2W'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWCOUNORMS), CDPATH//'%LWCOUNORMS'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWCUR), CDPATH//'%LWCUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWCOURNW), CDPATH//'%LWCOURNW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWCOUHMF), CDPATH//'%LWCOUHMF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWSTOKES), CDPATH//'%LWSTOKES'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWFLUX), CDPATH//'%LWFLUX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%CBEGDAT), CDPATH//'%CBEGDAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MASK_WAVE_IN), CDPATH//'%MASK_WAVE_IN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MASK_WAVE_OUT), CDPATH//'%MASK_WAVE_OUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWVIN_MASK_NOT_SET), CDPATH//'%LWVIN_MASK_NOT_SET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWVOUT_MASK_NOT_SET), CDPATH//'%LWVOUT_MASK_NOT_SET'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWVIN_UNINITIALISED), CDPATH//'%LWVIN_UNINITIALISED'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_SENDTOT), CDPATH//'%MWVIN_SENDTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_RECVTOT), CDPATH//'%MWVIN_RECVTOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_SENDCNT), CDPATH//'%MWVIN_SENDCNT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_RECVCNT), CDPATH//'%MWVIN_RECVCNT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_SENDOFF), CDPATH//'%MWVIN_SENDOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_RECVOFF), CDPATH//'%MWVIN_RECVOFF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_SENDBUF), CDPATH//'%MWVIN_SENDBUF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_RECVBUF), CDPATH//'%MWVIN_RECVBUF'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%MWVIN_SENDIND), CDPATH//'%MWVIN_SENDIND'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWFRSTIME), CDPATH//'%LWFRSTIME'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LWINIT), CDPATH//'%LWINIT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NADV_WAVE), CDPATH//'%NADV_WAVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NWV_W2IWGHT), CDPATH//'%NWV_W2IWGHT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IWV_LON), CDPATH//'%IWV_LON'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%IWV_LAT), CDPATH//'%IWV_LAT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%WV_W2IWGHT), CDPATH//'%WV_W2IWGHT'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TEWCOU (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TEWCOU), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LMASK_WAVE_IN = ALLOCATED (SELF%MASK_WAVE_IN)
IF (LMASK_WAVE_IN) THEN
  !$ACC EXIT DATA DETACH (SELF%MASK_WAVE_IN)
  !$ACC EXIT DATA DELETE (SELF%MASK_WAVE_IN)
ENDIF

LMASK_WAVE_OUT = ALLOCATED (SELF%MASK_WAVE_OUT)
IF (LMASK_WAVE_OUT) THEN
  !$ACC EXIT DATA DETACH (SELF%MASK_WAVE_OUT)
  !$ACC EXIT DATA DELETE (SELF%MASK_WAVE_OUT)
ENDIF

LMWVIN_SENDCNT = ALLOCATED (SELF%MWVIN_SENDCNT)
IF (LMWVIN_SENDCNT) THEN
  !$ACC EXIT DATA DETACH (SELF%MWVIN_SENDCNT)
  !$ACC EXIT DATA DELETE (SELF%MWVIN_SENDCNT)
ENDIF

LMWVIN_RECVCNT = ALLOCATED (SELF%MWVIN_RECVCNT)
IF (LMWVIN_RECVCNT) THEN
  !$ACC EXIT DATA DETACH (SELF%MWVIN_RECVCNT)
  !$ACC EXIT DATA DELETE (SELF%MWVIN_RECVCNT)
ENDIF

LMWVIN_SENDOFF = ALLOCATED (SELF%MWVIN_SENDOFF)
IF (LMWVIN_SENDOFF) THEN
  !$ACC EXIT DATA DETACH (SELF%MWVIN_SENDOFF)
  !$ACC EXIT DATA DELETE (SELF%MWVIN_SENDOFF)
ENDIF

LMWVIN_RECVOFF = ALLOCATED (SELF%MWVIN_RECVOFF)
IF (LMWVIN_RECVOFF) THEN
  !$ACC EXIT DATA DETACH (SELF%MWVIN_RECVOFF)
  !$ACC EXIT DATA DELETE (SELF%MWVIN_RECVOFF)
ENDIF

LMWVIN_SENDBUF = ALLOCATED (SELF%MWVIN_SENDBUF)
IF (LMWVIN_SENDBUF) THEN
  !$ACC EXIT DATA DETACH (SELF%MWVIN_SENDBUF)
  !$ACC EXIT DATA DELETE (SELF%MWVIN_SENDBUF)
ENDIF

LMWVIN_RECVBUF = ALLOCATED (SELF%MWVIN_RECVBUF)
IF (LMWVIN_RECVBUF) THEN
  !$ACC EXIT DATA DETACH (SELF%MWVIN_RECVBUF)
  !$ACC EXIT DATA DELETE (SELF%MWVIN_RECVBUF)
ENDIF

LMWVIN_SENDIND = ALLOCATED (SELF%MWVIN_SENDIND)
IF (LMWVIN_SENDIND) THEN
  !$ACC EXIT DATA DETACH (SELF%MWVIN_SENDIND)
  !$ACC EXIT DATA DELETE (SELF%MWVIN_SENDIND)
ENDIF

LIWV_LON = ALLOCATED (SELF%IWV_LON)
IF (LIWV_LON) THEN
  !$ACC EXIT DATA DETACH (SELF%IWV_LON)
  !$ACC EXIT DATA DELETE (SELF%IWV_LON)
ENDIF

LIWV_LAT = ALLOCATED (SELF%IWV_LAT)
IF (LIWV_LAT) THEN
  !$ACC EXIT DATA DETACH (SELF%IWV_LAT)
  !$ACC EXIT DATA DELETE (SELF%IWV_LAT)
ENDIF

LWV_W2IWGHT = ALLOCATED (SELF%WV_W2IWGHT)
IF (LWV_W2IWGHT) THEN
  !$ACC EXIT DATA DETACH (SELF%WV_W2IWGHT)
  !$ACC EXIT DATA DELETE (SELF%WV_W2IWGHT)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TEWCOU (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TEWCOU),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LIWV_LAT, LIWV_LON, LMASK_WAVE_IN, LMASK_WAVE_OUT, LMWVIN_RECVBUF, LMWVIN_RECVCNT, LMWVIN_RECVOFF, LMWVIN_SENDBUF, LMWVIN_SENDCNT, LMWVIN_SENDIND
LOGICAL :: LMWVIN_SENDOFF, LWV_W2IWGHT
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%NATMFLX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NATMFLX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NGAUSSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGAUSSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLONW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLONW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLATW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLATW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLON1W)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLON1W'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NLAT1W)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NLAT1W'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NNORXW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NNORXW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NSTPW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NSTPW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NGRIB_HANDLE_FOR_WAM)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NGRIB_HANDLE_FOR_WAM'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RSOUTW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RSOUTW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RNORTW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RNORTW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RDEGREW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RDEGREW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RMISSW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RMISSW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWCOU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWCOU2W)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOU2W'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWCOUNORMS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOUNORMS'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWCUR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCUR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWCOURNW)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOURNW'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWCOUHMF)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWCOUHMF'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWSTOKES)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWSTOKES'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWFLUX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWFLUX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%CBEGDAT) * LEN (SELF%CBEGDAT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%CBEGDAT'
ENDIF
KSIZE = KSIZE + ISIZE
LMASK_WAVE_IN = ALLOCATED (SELF%MASK_WAVE_IN)
IF (LMASK_WAVE_IN) THEN
  ISIZE = KIND (SELF%MASK_WAVE_IN) * SIZE (SELF%MASK_WAVE_IN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MASK_WAVE_IN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMASK_WAVE_OUT = ALLOCATED (SELF%MASK_WAVE_OUT)
IF (LMASK_WAVE_OUT) THEN
  ISIZE = KIND (SELF%MASK_WAVE_OUT) * SIZE (SELF%MASK_WAVE_OUT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MASK_WAVE_OUT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (SELF%LWVIN_MASK_NOT_SET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWVIN_MASK_NOT_SET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWVOUT_MASK_NOT_SET)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWVOUT_MASK_NOT_SET'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWVIN_UNINITIALISED)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWVIN_UNINITIALISED'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%MWVIN_SENDTOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDTOT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%MWVIN_RECVTOT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVTOT'
ENDIF
KSIZE = KSIZE + ISIZE
LMWVIN_SENDCNT = ALLOCATED (SELF%MWVIN_SENDCNT)
IF (LMWVIN_SENDCNT) THEN
  ISIZE = KIND (SELF%MWVIN_SENDCNT) * SIZE (SELF%MWVIN_SENDCNT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDCNT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_RECVCNT = ALLOCATED (SELF%MWVIN_RECVCNT)
IF (LMWVIN_RECVCNT) THEN
  ISIZE = KIND (SELF%MWVIN_RECVCNT) * SIZE (SELF%MWVIN_RECVCNT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVCNT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_SENDOFF = ALLOCATED (SELF%MWVIN_SENDOFF)
IF (LMWVIN_SENDOFF) THEN
  ISIZE = KIND (SELF%MWVIN_SENDOFF) * SIZE (SELF%MWVIN_SENDOFF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDOFF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_RECVOFF = ALLOCATED (SELF%MWVIN_RECVOFF)
IF (LMWVIN_RECVOFF) THEN
  ISIZE = KIND (SELF%MWVIN_RECVOFF) * SIZE (SELF%MWVIN_RECVOFF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVOFF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_SENDBUF = ALLOCATED (SELF%MWVIN_SENDBUF)
IF (LMWVIN_SENDBUF) THEN
  ISIZE = KIND (SELF%MWVIN_SENDBUF) * SIZE (SELF%MWVIN_SENDBUF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDBUF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_RECVBUF = ALLOCATED (SELF%MWVIN_RECVBUF)
IF (LMWVIN_RECVBUF) THEN
  ISIZE = KIND (SELF%MWVIN_RECVBUF) * SIZE (SELF%MWVIN_RECVBUF)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_RECVBUF'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LMWVIN_SENDIND = ALLOCATED (SELF%MWVIN_SENDIND)
IF (LMWVIN_SENDIND) THEN
  ISIZE = KIND (SELF%MWVIN_SENDIND) * SIZE (SELF%MWVIN_SENDIND)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%MWVIN_SENDIND'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (SELF%LWFRSTIME)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWFRSTIME'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%LWINIT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LWINIT'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NADV_WAVE)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NADV_WAVE'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NWV_W2IWGHT)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NWV_W2IWGHT'
ENDIF
KSIZE = KSIZE + ISIZE
LIWV_LON = ALLOCATED (SELF%IWV_LON)
IF (LIWV_LON) THEN
  ISIZE = KIND (SELF%IWV_LON) * SIZE (SELF%IWV_LON)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%IWV_LON'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LIWV_LAT = ALLOCATED (SELF%IWV_LAT)
IF (LIWV_LAT) THEN
  ISIZE = KIND (SELF%IWV_LAT) * SIZE (SELF%IWV_LAT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%IWV_LAT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LWV_W2IWGHT = ALLOCATED (SELF%WV_W2IWGHT)
IF (LWV_W2IWGHT) THEN
  ISIZE = KIND (SELF%WV_W2IWGHT) * SIZE (SELF%WV_W2IWGHT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%WV_W2IWGHT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
