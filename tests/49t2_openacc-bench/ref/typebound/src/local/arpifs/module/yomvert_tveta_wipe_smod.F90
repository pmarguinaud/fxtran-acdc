SUBMODULE (YOMVERT) YOMVERT_TVETA_WIPE_SMOD

IMPLICIT NONE

CONTAINS

MODULE SUBROUTINE ACDC_WIPE_TVETA (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
CLASS (TVETA), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LVDETA_RATIO, LVETAF, LVETAH, LVETA_H, LVETA_LAITRIQM3D, LVFE_ETAF, LVFE_ETAH, LVFE_RDETAH, LVRDETAH, LVWEI
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LVETAH = ALLOCATED (SELF%VETAH)
IF (LVETAH) THEN
  !$ACC EXIT DATA DETACH (SELF%VETAH)
  !$ACC EXIT DATA DELETE (SELF%VETAH)
ENDIF

LVFE_ETAH = ALLOCATED (SELF%VFE_ETAH)
IF (LVFE_ETAH) THEN
  !$ACC EXIT DATA DETACH (SELF%VFE_ETAH)
  !$ACC EXIT DATA DELETE (SELF%VFE_ETAH)
ENDIF

LVETAF = ALLOCATED (SELF%VETAF)
IF (LVETAF) THEN
  !$ACC EXIT DATA DETACH (SELF%VETAF)
  !$ACC EXIT DATA DELETE (SELF%VETAF)
ENDIF

LVFE_ETAF = ALLOCATED (SELF%VFE_ETAF)
IF (LVFE_ETAF) THEN
  !$ACC EXIT DATA DETACH (SELF%VFE_ETAF)
  !$ACC EXIT DATA DELETE (SELF%VFE_ETAF)
ENDIF

LVFE_RDETAH = ALLOCATED (SELF%VFE_RDETAH)
IF (LVFE_RDETAH) THEN
  !$ACC EXIT DATA DETACH (SELF%VFE_RDETAH)
  !$ACC EXIT DATA DELETE (SELF%VFE_RDETAH)
ENDIF

LVDETA_RATIO = ALLOCATED (SELF%VDETA_RATIO)
IF (LVDETA_RATIO) THEN
  !$ACC EXIT DATA DETACH (SELF%VDETA_RATIO)
  !$ACC EXIT DATA DELETE (SELF%VDETA_RATIO)
ENDIF

LVRDETAH = ALLOCATED (SELF%VRDETAH)
IF (LVRDETAH) THEN
  !$ACC EXIT DATA DETACH (SELF%VRDETAH)
  !$ACC EXIT DATA DELETE (SELF%VRDETAH)
ENDIF

LVWEI = ALLOCATED (SELF%VWEI)
IF (LVWEI) THEN
  !$ACC EXIT DATA DETACH (SELF%VWEI)
  !$ACC EXIT DATA DELETE (SELF%VWEI)
ENDIF

LVETA_H = ALLOCATED (SELF%VETA_H)
IF (LVETA_H) THEN
  !$ACC EXIT DATA DETACH (SELF%VETA_H)
  !$ACC EXIT DATA DELETE (SELF%VETA_H)
ENDIF

LVETA_LAITRIQM3D = ALLOCATED (SELF%VETA_LAITRIQM3D)
IF (LVETA_LAITRIQM3D) THEN
  !$ACC EXIT DATA DETACH (SELF%VETA_LAITRIQM3D)
  !$ACC EXIT DATA DELETE (SELF%VETA_LAITRIQM3D)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

END SUBMODULE
