MODULE UTIL_TEDYN_MOD

USE YEMDYN, ONLY : TEDYN

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TEDYN
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TEDYN
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TEDYN
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TEDYN
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TEDYN
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TEDYN
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TEDYN
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TEDYN (SELF, KLUN)

IMPLICIT NONE
TYPE (TEDYN), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
LRDIVORE = ALLOCATED (SELF%RDIVORE)
WRITE (KLUN) LRDIVORE
IF (LRDIVORE) THEN
  WRITE (KLUN) LBOUND (SELF%RDIVORE)
  WRITE (KLUN) UBOUND (SELF%RDIVORE)
  WRITE (KLUN) SELF%RDIVORE
ENDIF
LRDIDIVE = ALLOCATED (SELF%RDIDIVE)
WRITE (KLUN) LRDIDIVE
IF (LRDIDIVE) THEN
  WRITE (KLUN) LBOUND (SELF%RDIDIVE)
  WRITE (KLUN) UBOUND (SELF%RDIDIVE)
  WRITE (KLUN) SELF%RDIDIVE
ENDIF
LRDITE = ALLOCATED (SELF%RDITE)
WRITE (KLUN) LRDITE
IF (LRDITE) THEN
  WRITE (KLUN) LBOUND (SELF%RDITE)
  WRITE (KLUN) UBOUND (SELF%RDITE)
  WRITE (KLUN) SELF%RDITE
ENDIF
LRDIGFLE = ALLOCATED (SELF%RDIGFLE)
WRITE (KLUN) LRDIGFLE
IF (LRDIGFLE) THEN
  WRITE (KLUN) LBOUND (SELF%RDIGFLE)
  WRITE (KLUN) UBOUND (SELF%RDIGFLE)
  WRITE (KLUN) SELF%RDIGFLE
ENDIF
LRDIPDE = ALLOCATED (SELF%RDIPDE)
WRITE (KLUN) LRDIPDE
IF (LRDIPDE) THEN
  WRITE (KLUN) LBOUND (SELF%RDIPDE)
  WRITE (KLUN) UBOUND (SELF%RDIPDE)
  WRITE (KLUN) SELF%RDIPDE
ENDIF
LRDIVDE = ALLOCATED (SELF%RDIVDE)
WRITE (KLUN) LRDIVDE
IF (LRDIVDE) THEN
  WRITE (KLUN) LBOUND (SELF%RDIVDE)
  WRITE (KLUN) UBOUND (SELF%RDIVDE)
  WRITE (KLUN) SELF%RDIVDE
ENDIF
LRDISPE = ALLOCATED (SELF%RDISPE)
WRITE (KLUN) LRDISPE
IF (LRDISPE) THEN
  WRITE (KLUN) LBOUND (SELF%RDISPE)
  WRITE (KLUN) UBOUND (SELF%RDISPE)
  WRITE (KLUN) SELF%RDISPE
ENDIF
LRDSVORE = ALLOCATED (SELF%RDSVORE)
WRITE (KLUN) LRDSVORE
IF (LRDSVORE) THEN
  WRITE (KLUN) LBOUND (SELF%RDSVORE)
  WRITE (KLUN) UBOUND (SELF%RDSVORE)
  WRITE (KLUN) SELF%RDSVORE
ENDIF
LRDSDIVE = ALLOCATED (SELF%RDSDIVE)
WRITE (KLUN) LRDSDIVE
IF (LRDSDIVE) THEN
  WRITE (KLUN) LBOUND (SELF%RDSDIVE)
  WRITE (KLUN) UBOUND (SELF%RDSDIVE)
  WRITE (KLUN) SELF%RDSDIVE
ENDIF
LRDSVDE = ALLOCATED (SELF%RDSVDE)
WRITE (KLUN) LRDSVDE
IF (LRDSVDE) THEN
  WRITE (KLUN) LBOUND (SELF%RDSVDE)
  WRITE (KLUN) UBOUND (SELF%RDSVDE)
  WRITE (KLUN) SELF%RDSVDE
ENDIF
LREFILV = ALLOCATED (SELF%REFILV)
WRITE (KLUN) LREFILV
IF (LREFILV) THEN
  WRITE (KLUN) LBOUND (SELF%REFILV)
  WRITE (KLUN) UBOUND (SELF%REFILV)
  WRITE (KLUN) SELF%REFILV
ENDIF
LREFILD = ALLOCATED (SELF%REFILD)
WRITE (KLUN) LREFILD
IF (LREFILD) THEN
  WRITE (KLUN) LBOUND (SELF%REFILD)
  WRITE (KLUN) UBOUND (SELF%REFILD)
  WRITE (KLUN) SELF%REFILD
ENDIF
WRITE (KLUN) SELF%LESIDG
WRITE (KLUN) SELF%RTHRESIDG
WRITE (KLUN) SELF%XMALD
WRITE (KLUN) SELF%TCDIS
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TEDYN (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TEDYN), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL3(3), IU3(3)
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP3 (:,:,:)
READ (KLUN) LRDIVORE
IF (LRDIVORE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDIVORE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDIVORE,1):UBOUND(SELF%RDIVORE,1), LBOUND(SELF%RDIVORE,2):UBOUND(SELF%RDIVORE,2)))
  READ (KLUN) ZTMP2
  SELF%RDIVORE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRDIDIVE
IF (LRDIDIVE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDIDIVE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDIDIVE,1):UBOUND(SELF%RDIDIVE,1), LBOUND(SELF%RDIDIVE,2):UBOUND(SELF%RDIDIVE,2)))
  READ (KLUN) ZTMP2
  SELF%RDIDIVE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRDITE
IF (LRDITE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDITE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDITE,1):UBOUND(SELF%RDITE,1), LBOUND(SELF%RDITE,2):UBOUND(SELF%RDITE,2)))
  READ (KLUN) ZTMP2
  SELF%RDITE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRDIGFLE
IF (LRDIGFLE) THEN
  READ (KLUN) IL3
  READ (KLUN) IU3
  ALLOCATE (SELF%RDIGFLE (IL3(1):IU3(1), IL3(2):IU3(2), IL3(3):IU3(3)))
  ALLOCATE (ZTMP3(LBOUND(SELF%RDIGFLE,1):UBOUND(SELF%RDIGFLE,1), LBOUND(SELF%RDIGFLE,2):UBOUND(SELF%RDIGFLE,2), LBOUND(SELF%RDIGFLE,3):UBOUND(SELF%RDIGFLE,3)))
  READ (KLUN) ZTMP3
  SELF%RDIGFLE = ZTMP3
  DEALLOCATE (ZTMP3)
ENDIF
READ (KLUN) LRDIPDE
IF (LRDIPDE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDIPDE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDIPDE,1):UBOUND(SELF%RDIPDE,1), LBOUND(SELF%RDIPDE,2):UBOUND(SELF%RDIPDE,2)))
  READ (KLUN) ZTMP2
  SELF%RDIPDE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRDIVDE
IF (LRDIVDE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDIVDE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDIVDE,1):UBOUND(SELF%RDIVDE,1), LBOUND(SELF%RDIVDE,2):UBOUND(SELF%RDIVDE,2)))
  READ (KLUN) ZTMP2
  SELF%RDIVDE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRDISPE
IF (LRDISPE) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RDISPE (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%RDISPE,1):UBOUND(SELF%RDISPE,1)))
  READ (KLUN) ZTMP1
  SELF%RDISPE = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRDSVORE
IF (LRDSVORE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDSVORE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDSVORE,1):UBOUND(SELF%RDSVORE,1), LBOUND(SELF%RDSVORE,2):UBOUND(SELF%RDSVORE,2)))
  READ (KLUN) ZTMP2
  SELF%RDSVORE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRDSDIVE
IF (LRDSDIVE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDSDIVE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDSDIVE,1):UBOUND(SELF%RDSDIVE,1), LBOUND(SELF%RDSDIVE,2):UBOUND(SELF%RDSDIVE,2)))
  READ (KLUN) ZTMP2
  SELF%RDSDIVE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRDSVDE
IF (LRDSVDE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDSVDE (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RDSVDE,1):UBOUND(SELF%RDSVDE,1), LBOUND(SELF%RDSVDE,2):UBOUND(SELF%RDSVDE,2)))
  READ (KLUN) ZTMP2
  SELF%RDSVDE = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LREFILV
IF (LREFILV) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%REFILV (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%REFILV,1):UBOUND(SELF%REFILV,1), LBOUND(SELF%REFILV,2):UBOUND(SELF%REFILV,2)))
  READ (KLUN) ZTMP2
  SELF%REFILV = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LREFILD
IF (LREFILD) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%REFILD (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%REFILD,1):UBOUND(SELF%REFILD,1), LBOUND(SELF%REFILD,2):UBOUND(SELF%REFILD,2)))
  READ (KLUN) ZTMP2
  SELF%REFILD = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) SELF%LESIDG
READ (KLUN) ZTMP0
SELF%RTHRESIDG = ZTMP0
READ (KLUN) ZTMP0
SELF%XMALD = ZTMP0
READ (KLUN) ZTMP0
SELF%TCDIS = ZTMP0
END SUBROUTINE

SUBROUTINE ACDC_COPY_TEDYN (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TEDYN), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LRDIVORE = ALLOCATED (SELF%RDIVORE)
IF (LRDIVORE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIVORE)
  !$ACC UPDATE DEVICE (SELF%RDIVORE)
  !$ACC ENTER DATA ATTACH (SELF%RDIVORE)
ENDIF

LRDIDIVE = ALLOCATED (SELF%RDIDIVE)
IF (LRDIDIVE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIDIVE)
  !$ACC UPDATE DEVICE (SELF%RDIDIVE)
  !$ACC ENTER DATA ATTACH (SELF%RDIDIVE)
ENDIF

LRDITE = ALLOCATED (SELF%RDITE)
IF (LRDITE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDITE)
  !$ACC UPDATE DEVICE (SELF%RDITE)
  !$ACC ENTER DATA ATTACH (SELF%RDITE)
ENDIF

LRDIGFLE = ALLOCATED (SELF%RDIGFLE)
IF (LRDIGFLE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIGFLE)
  !$ACC UPDATE DEVICE (SELF%RDIGFLE)
  !$ACC ENTER DATA ATTACH (SELF%RDIGFLE)
ENDIF

LRDIPDE = ALLOCATED (SELF%RDIPDE)
IF (LRDIPDE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIPDE)
  !$ACC UPDATE DEVICE (SELF%RDIPDE)
  !$ACC ENTER DATA ATTACH (SELF%RDIPDE)
ENDIF

LRDIVDE = ALLOCATED (SELF%RDIVDE)
IF (LRDIVDE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDIVDE)
  !$ACC UPDATE DEVICE (SELF%RDIVDE)
  !$ACC ENTER DATA ATTACH (SELF%RDIVDE)
ENDIF

LRDISPE = ALLOCATED (SELF%RDISPE)
IF (LRDISPE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDISPE)
  !$ACC UPDATE DEVICE (SELF%RDISPE)
  !$ACC ENTER DATA ATTACH (SELF%RDISPE)
ENDIF

LRDSVORE = ALLOCATED (SELF%RDSVORE)
IF (LRDSVORE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDSVORE)
  !$ACC UPDATE DEVICE (SELF%RDSVORE)
  !$ACC ENTER DATA ATTACH (SELF%RDSVORE)
ENDIF

LRDSDIVE = ALLOCATED (SELF%RDSDIVE)
IF (LRDSDIVE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDSDIVE)
  !$ACC UPDATE DEVICE (SELF%RDSDIVE)
  !$ACC ENTER DATA ATTACH (SELF%RDSDIVE)
ENDIF

LRDSVDE = ALLOCATED (SELF%RDSVDE)
IF (LRDSVDE) THEN
  !$ACC ENTER DATA CREATE (SELF%RDSVDE)
  !$ACC UPDATE DEVICE (SELF%RDSVDE)
  !$ACC ENTER DATA ATTACH (SELF%RDSVDE)
ENDIF

LREFILV = ALLOCATED (SELF%REFILV)
IF (LREFILV) THEN
  !$ACC ENTER DATA CREATE (SELF%REFILV)
  !$ACC UPDATE DEVICE (SELF%REFILV)
  !$ACC ENTER DATA ATTACH (SELF%REFILV)
ENDIF

LREFILD = ALLOCATED (SELF%REFILD)
IF (LREFILD) THEN
  !$ACC ENTER DATA CREATE (SELF%REFILD)
  !$ACC UPDATE DEVICE (SELF%REFILD)
  !$ACC ENTER DATA ATTACH (SELF%REFILD)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TEDYN (SELF)

IMPLICIT NONE
TYPE (TEDYN), TARGET :: SELF
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TEDYN (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TEDYN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDIVORE), CDPATH//'%RDIVORE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDIDIVE), CDPATH//'%RDIDIVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDITE), CDPATH//'%RDITE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDIGFLE), CDPATH//'%RDIGFLE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDIPDE), CDPATH//'%RDIPDE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDIVDE), CDPATH//'%RDIVDE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDISPE), CDPATH//'%RDISPE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSVORE), CDPATH//'%RDSVORE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSDIVE), CDPATH//'%RDSDIVE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDSVDE), CDPATH//'%RDSVDE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%REFILV), CDPATH//'%REFILV'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%REFILD), CDPATH//'%REFILD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%LESIDG), CDPATH//'%LESIDG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RTHRESIDG), CDPATH//'%RTHRESIDG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%XMALD), CDPATH//'%XMALD'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%TCDIS), CDPATH//'%TCDIS'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TEDYN (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TEDYN), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LRDIVORE = ALLOCATED (SELF%RDIVORE)
IF (LRDIVORE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIVORE)
  !$ACC EXIT DATA DELETE (SELF%RDIVORE)
ENDIF

LRDIDIVE = ALLOCATED (SELF%RDIDIVE)
IF (LRDIDIVE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIDIVE)
  !$ACC EXIT DATA DELETE (SELF%RDIDIVE)
ENDIF

LRDITE = ALLOCATED (SELF%RDITE)
IF (LRDITE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDITE)
  !$ACC EXIT DATA DELETE (SELF%RDITE)
ENDIF

LRDIGFLE = ALLOCATED (SELF%RDIGFLE)
IF (LRDIGFLE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIGFLE)
  !$ACC EXIT DATA DELETE (SELF%RDIGFLE)
ENDIF

LRDIPDE = ALLOCATED (SELF%RDIPDE)
IF (LRDIPDE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIPDE)
  !$ACC EXIT DATA DELETE (SELF%RDIPDE)
ENDIF

LRDIVDE = ALLOCATED (SELF%RDIVDE)
IF (LRDIVDE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDIVDE)
  !$ACC EXIT DATA DELETE (SELF%RDIVDE)
ENDIF

LRDISPE = ALLOCATED (SELF%RDISPE)
IF (LRDISPE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDISPE)
  !$ACC EXIT DATA DELETE (SELF%RDISPE)
ENDIF

LRDSVORE = ALLOCATED (SELF%RDSVORE)
IF (LRDSVORE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDSVORE)
  !$ACC EXIT DATA DELETE (SELF%RDSVORE)
ENDIF

LRDSDIVE = ALLOCATED (SELF%RDSDIVE)
IF (LRDSDIVE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDSDIVE)
  !$ACC EXIT DATA DELETE (SELF%RDSDIVE)
ENDIF

LRDSVDE = ALLOCATED (SELF%RDSVDE)
IF (LRDSVDE) THEN
  !$ACC EXIT DATA DETACH (SELF%RDSVDE)
  !$ACC EXIT DATA DELETE (SELF%RDSVDE)
ENDIF

LREFILV = ALLOCATED (SELF%REFILV)
IF (LREFILV) THEN
  !$ACC EXIT DATA DETACH (SELF%REFILV)
  !$ACC EXIT DATA DELETE (SELF%REFILV)
ENDIF

LREFILD = ALLOCATED (SELF%REFILD)
IF (LREFILD) THEN
  !$ACC EXIT DATA DETACH (SELF%REFILD)
  !$ACC EXIT DATA DELETE (SELF%REFILD)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TEDYN (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TEDYN),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LRDIDIVE, LRDIGFLE, LRDIPDE, LRDISPE, LRDITE, LRDIVDE, LRDIVORE, LRDSDIVE, LRDSVDE, LRDSVORE
LOGICAL :: LREFILD, LREFILV
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LRDIVORE = ALLOCATED (SELF%RDIVORE)
IF (LRDIVORE) THEN
  ISIZE = KIND (SELF%RDIVORE) * SIZE (SELF%RDIVORE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDIVORE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDIDIVE = ALLOCATED (SELF%RDIDIVE)
IF (LRDIDIVE) THEN
  ISIZE = KIND (SELF%RDIDIVE) * SIZE (SELF%RDIDIVE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDIDIVE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDITE = ALLOCATED (SELF%RDITE)
IF (LRDITE) THEN
  ISIZE = KIND (SELF%RDITE) * SIZE (SELF%RDITE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDITE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDIGFLE = ALLOCATED (SELF%RDIGFLE)
IF (LRDIGFLE) THEN
  ISIZE = KIND (SELF%RDIGFLE) * SIZE (SELF%RDIGFLE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDIGFLE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDIPDE = ALLOCATED (SELF%RDIPDE)
IF (LRDIPDE) THEN
  ISIZE = KIND (SELF%RDIPDE) * SIZE (SELF%RDIPDE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDIPDE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDIVDE = ALLOCATED (SELF%RDIVDE)
IF (LRDIVDE) THEN
  ISIZE = KIND (SELF%RDIVDE) * SIZE (SELF%RDIVDE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDIVDE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDISPE = ALLOCATED (SELF%RDISPE)
IF (LRDISPE) THEN
  ISIZE = KIND (SELF%RDISPE) * SIZE (SELF%RDISPE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDISPE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDSVORE = ALLOCATED (SELF%RDSVORE)
IF (LRDSVORE) THEN
  ISIZE = KIND (SELF%RDSVORE) * SIZE (SELF%RDSVORE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDSVORE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDSDIVE = ALLOCATED (SELF%RDSDIVE)
IF (LRDSDIVE) THEN
  ISIZE = KIND (SELF%RDSDIVE) * SIZE (SELF%RDSDIVE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDSDIVE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDSVDE = ALLOCATED (SELF%RDSVDE)
IF (LRDSVDE) THEN
  ISIZE = KIND (SELF%RDSVDE) * SIZE (SELF%RDSVDE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDSVDE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LREFILV = ALLOCATED (SELF%REFILV)
IF (LREFILV) THEN
  ISIZE = KIND (SELF%REFILV) * SIZE (SELF%REFILV)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%REFILV'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LREFILD = ALLOCATED (SELF%REFILD)
IF (LREFILD) THEN
  ISIZE = KIND (SELF%REFILD) * SIZE (SELF%REFILD)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%REFILD'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
ISIZE = KIND (SELF%LESIDG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%LESIDG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%RTHRESIDG)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%RTHRESIDG'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%XMALD)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%XMALD'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%TCDIS)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%TCDIS'
ENDIF
KSIZE = KSIZE + ISIZE
END FUNCTION

END MODULE
