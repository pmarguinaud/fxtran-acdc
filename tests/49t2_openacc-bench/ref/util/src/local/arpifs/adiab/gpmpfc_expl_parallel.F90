SUBROUTINE GPMPFC_EXPL_PARALLEL (YDVARS, YDML_GCONF, YDDYN&
&, YDDYNA, YDCPG_OPTS, YDCPG_BNDS, KFLAG, YD_PGM)
USE MODEL_GENERAL_CONF_MOD,ONLY:MODEL_GENERAL_CONF_TYPE

USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK
USE YOMDYN,ONLY:TDYN
USE YOMDYNA,ONLY:TDYNA
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (MODEL_GENERAL_CONF_TYPE), INTENT (IN)::YDML_GCONF
TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
INTEGER (KIND=JPIM), INTENT (IN)::KFLAG
CLASS (FIELD_2RB), POINTER :: YD_PGM
REAL (KIND=JPRB), POINTER::PGM (:,:)
#include "abor1.intfb.h"
#include "gpmpfc_expl_part1.intfb.h"
#include "gpmpfc_expl_part1_openacc.intfb.h"
#include "gpmpfc_expl_part2_parallel.intfb.h"
CLASS (FIELD_2RB), POINTER :: YL_ZGM
REAL (KIND=JPRB), POINTER::ZGM (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGM0
REAL (KIND=JPRB), POINTER::ZGM0 (:,:)
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER (KIND=JPIM) :: JLON
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL(KIND=JPRB), POINTER :: Z_YDVARS_DIV_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_DIV_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_NHX_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_NHX_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_DL9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SPD_DM9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DL(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DL9(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DM(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SP_DM9(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_DL9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_SVD_DM9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DL9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DM(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_T_DM9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_U_T9(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_VOR_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_DL(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_V_T9(:,:,:)
IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZGM0, UBOUNDS=[YDCPG_OPTS%KLON, YDCPG_OPTS%JBLKMAX&
&], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)

IF (KFLAG==0) THEN
  YL_ZGM => YD_PGM
ELSEIF (KFLAG==1) THEN
  YL_ZGM => YL_ZGM0
ELSE
  CALL ABOR1 ('GPMPFC_EXPL: ILLEGAL KFLAG')
ENDIF


IF (KFLAG==1) THEN
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

  IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPMPFC_EXPL_PARALLEL:0')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PGM => GET_HOST_DATA_RDONLY (YD_PGM)
    ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
    !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      CALL YLCPG_BNDS%UPDATE (JBLK)
      
      ZGM (:, JBLK)=1.0_JPRB/PGM (:, JBLK)
    ENDDO

    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('GPMPFC_EXPL_PARALLEL:0')) THEN
      IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PGM => GET_HOST_DATA_RDWR (YD_PGM)
      ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
      IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PGM => NULL ()
    ZGM => NULL ()
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPMPFC_EXPL_PARALLEL:0')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PGM => GET_HOST_DATA_RDONLY (YD_PGM)
    ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS)

    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

      

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZGM (JLON, JBLK)=1.0_JPRB/PGM (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('GPMPFC_EXPL_PARALLEL:0')) THEN
      IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PGM => GET_HOST_DATA_RDWR (YD_PGM)
      ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
      IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PGM => NULL ()
    ZGM => NULL ()
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPMPFC_EXPL_PARALLEL:0')) THEN
    
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
    PGM => GET_DEVICE_DATA_RDONLY (YD_PGM)
    ZGM => GET_DEVICE_DATA_RDWR (YL_ZGM)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
    
    
      !$ACC PARALLEL LOOP GANG &
      !$ACC&PRESENT (PGM, YDCPG_OPTS, YFXTRAN_ACDC_STACK, ZGM) &
      !$ACC&PRIVATE (JBLK) &
      !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
      
      DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
      
      
      
      !$ACC LOOP VECTOR &
      !$ACC&PRIVATE (JLON, YLCPG_BNDS) 

      

      DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
        YLCPG_BNDS%KIDIA = JLON
        YLCPG_BNDS%KFDIA = JLON
        
        ZGM (JLON, JBLK)=1.0_JPRB/PGM (JLON, JBLK)
      ENDDO

    ENDDO

    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

    IF (FXTRAN_ACDC_LSYNCHOST ('GPMPFC_EXPL_PARALLEL:0')) THEN
      IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
      PGM => GET_HOST_DATA_RDWR (YD_PGM)
      ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
      IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
      
      
    ENDIF

    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
    PGM => NULL ()
    ZGM => NULL ()
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ELSE
      CALL ABOR1 ('GPMPFC_EXPL_PARALLEL: NOT METHOD WAS FOUND')
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)
ENDIF

IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPMPFC_EXPL_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZGM => GET_HOST_DATA_RDONLY (YL_ZGM)
  Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
  Z_YDVARS_DIV_T9 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT9)
  Z_YDVARS_NHX_DL => GET_HOST_DATA_RDWR (YDVARS%NHX%FDL)
  Z_YDVARS_NHX_DM => GET_HOST_DATA_RDWR (YDVARS%NHX%FDM)
  Z_YDVARS_SPD_DL => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL)
  Z_YDVARS_SPD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL9)
  Z_YDVARS_SPD_DM => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM)
  Z_YDVARS_SPD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM9)
  Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
  Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
  Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
  Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
  Z_YDVARS_SVD_DL => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL)
  Z_YDVARS_SVD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL9)
  Z_YDVARS_SVD_DM => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM)
  Z_YDVARS_SVD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM9)
  Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
  Z_YDVARS_T_DL9 => GET_HOST_DATA_RDWR (YDVARS%T%FDL9)
  Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
  Z_YDVARS_T_DM9 => GET_HOST_DATA_RDWR (YDVARS%T%FDM9)
  Z_YDVARS_U_DL => GET_HOST_DATA_RDWR (YDVARS%U%FDL)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
  Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
  Z_YDVARS_VOR_T0 => GET_HOST_DATA_RDWR (YDVARS%VOR%FT0)
  Z_YDVARS_V_DL => GET_HOST_DATA_RDWR (YDVARS%V%FDL)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
  Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL GPMPFC_EXPL_PART1 (YDML_GCONF, YDDYN, YDDYNA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YLCPG_BNDS&
    &%KIDIA, YLCPG_BNDS%KFDIA, ZGM(:, JBLK), P0U=Z_YDVARS_U_T0(:,:, JBLK), P0V=Z_YDVARS_V_T0(:,:, JBLK&
    &), P0DIV=Z_YDVARS_DIV_T0(:,:, JBLK), P0TL=Z_YDVARS_T_DL(:,:, JBLK), P0TM=Z_YDVARS_T_DM(:,:, JBLK&
    &), P9U=Z_YDVARS_U_T9(:,:, JBLK), P9V=Z_YDVARS_V_T9(:,:, JBLK), P0UL=Z_YDVARS_U_DL(:,:, JBLK), P0VL&
    &=Z_YDVARS_V_DL(:,:, JBLK), P0VOR=Z_YDVARS_VOR_T0(:,:, JBLK), P0SPDL=Z_YDVARS_SPD_DL(:,:, JBLK)&
    &, P0SPDM=Z_YDVARS_SPD_DM(:,:, JBLK), P0SVDL=Z_YDVARS_SVD_DL(:,:, JBLK), P0SVDM=Z_YDVARS_SVD_DM&
    &(:,:, JBLK), P0NHXL=Z_YDVARS_NHX_DL(:,:, JBLK), P0NHXM=Z_YDVARS_NHX_DM(:,:, JBLK), P9DIV=Z_YDVARS_DIV_T9&
    &(:,:, JBLK), P9TL=Z_YDVARS_T_DL9(:,:, JBLK), P9TM=Z_YDVARS_T_DM9(:,:, JBLK), P9SPDL=Z_YDVARS_SPD_DL9&
    &(:,:, JBLK), P9SPDM=Z_YDVARS_SPD_DM9(:,:, JBLK), P9SVDL=Z_YDVARS_SVD_DL9(:,:, JBLK), P9SVDM=Z_YDVARS_SVD_DM9&
    &(:,:, JBLK), P0SPL=Z_YDVARS_SP_DL(:, JBLK), P0SPM=Z_YDVARS_SP_DM(:, JBLK), P9SPL=Z_YDVARS_SP_DL9&
    &(:, JBLK), P9SPM=Z_YDVARS_SP_DM9(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPMPFC_EXPL_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_DIV_T9 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT9)
    Z_YDVARS_NHX_DL => GET_HOST_DATA_RDWR (YDVARS%NHX%FDL)
    Z_YDVARS_NHX_DM => GET_HOST_DATA_RDWR (YDVARS%NHX%FDM)
    Z_YDVARS_SPD_DL => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL)
    Z_YDVARS_SPD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL9)
    Z_YDVARS_SPD_DM => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM)
    Z_YDVARS_SPD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM9)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
    Z_YDVARS_SVD_DL => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL)
    Z_YDVARS_SVD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL9)
    Z_YDVARS_SVD_DM => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM)
    Z_YDVARS_SVD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM9)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DL9 => GET_HOST_DATA_RDWR (YDVARS%T%FDL9)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_T_DM9 => GET_HOST_DATA_RDWR (YDVARS%T%FDM9)
    Z_YDVARS_U_DL => GET_HOST_DATA_RDWR (YDVARS%U%FDL)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_VOR_T0 => GET_HOST_DATA_RDWR (YDVARS%VOR%FT0)
    Z_YDVARS_V_DL => GET_HOST_DATA_RDWR (YDVARS%V%FDL)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZGM => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_DIV_T9 => NULL ()
  Z_YDVARS_NHX_DL => NULL ()
  Z_YDVARS_NHX_DM => NULL ()
  Z_YDVARS_SPD_DL => NULL ()
  Z_YDVARS_SPD_DL9 => NULL ()
  Z_YDVARS_SPD_DM => NULL ()
  Z_YDVARS_SPD_DM9 => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DL9 => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_DM9 => NULL ()
  Z_YDVARS_SVD_DL => NULL ()
  Z_YDVARS_SVD_DL9 => NULL ()
  Z_YDVARS_SVD_DM => NULL ()
  Z_YDVARS_SVD_DM9 => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DL9 => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_T_DM9 => NULL ()
  Z_YDVARS_U_DL => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_VOR_T0 => NULL ()
  Z_YDVARS_V_DL => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPMPFC_EXPL_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZGM => GET_HOST_DATA_RDONLY (YL_ZGM)
  Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
  Z_YDVARS_DIV_T9 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT9)
  Z_YDVARS_NHX_DL => GET_HOST_DATA_RDWR (YDVARS%NHX%FDL)
  Z_YDVARS_NHX_DM => GET_HOST_DATA_RDWR (YDVARS%NHX%FDM)
  Z_YDVARS_SPD_DL => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL)
  Z_YDVARS_SPD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL9)
  Z_YDVARS_SPD_DM => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM)
  Z_YDVARS_SPD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM9)
  Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
  Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
  Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
  Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
  Z_YDVARS_SVD_DL => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL)
  Z_YDVARS_SVD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL9)
  Z_YDVARS_SVD_DM => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM)
  Z_YDVARS_SVD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM9)
  Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
  Z_YDVARS_T_DL9 => GET_HOST_DATA_RDWR (YDVARS%T%FDL9)
  Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
  Z_YDVARS_T_DM9 => GET_HOST_DATA_RDWR (YDVARS%T%FDM9)
  Z_YDVARS_U_DL => GET_HOST_DATA_RDWR (YDVARS%U%FDL)
  Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
  Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
  Z_YDVARS_VOR_T0 => GET_HOST_DATA_RDWR (YDVARS%VOR%FT0)
  Z_YDVARS_V_DL => GET_HOST_DATA_RDWR (YDVARS%V%FDL)
  Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
  Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JLON, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GPMPFC_EXPL_PART1_OPENACC (YDML_GCONF, YDDYN, YDDYNA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, ZGM(:, JBLK), P0U=Z_YDVARS_U_T0(:,:, JBLK), P0V=Z_YDVARS_V_T0(:,:, JBLK&
      &), P0DIV=Z_YDVARS_DIV_T0(:,:, JBLK), P0TL=Z_YDVARS_T_DL(:,:, JBLK), P0TM=Z_YDVARS_T_DM(:,:, JBLK&
      &), P9U=Z_YDVARS_U_T9(:,:, JBLK), P9V=Z_YDVARS_V_T9(:,:, JBLK), P0UL=Z_YDVARS_U_DL(:,:, JBLK), P0VL&
      &=Z_YDVARS_V_DL(:,:, JBLK), P0VOR=Z_YDVARS_VOR_T0(:,:, JBLK), P0SPDL=Z_YDVARS_SPD_DL(:,:, JBLK), P0SPDM&
      &=Z_YDVARS_SPD_DM(:,:, JBLK), P0SVDL=Z_YDVARS_SVD_DL(:,:, JBLK), P0SVDM=Z_YDVARS_SVD_DM(:,:, JBLK&
      &), P0NHXL=Z_YDVARS_NHX_DL(:,:, JBLK), P0NHXM=Z_YDVARS_NHX_DM(:,:, JBLK), P9DIV=Z_YDVARS_DIV_T9(:&
      &,:, JBLK), P9TL=Z_YDVARS_T_DL9(:,:, JBLK), P9TM=Z_YDVARS_T_DM9(:,:, JBLK), P9SPDL=Z_YDVARS_SPD_DL9&
      &(:,:, JBLK), P9SPDM=Z_YDVARS_SPD_DM9(:,:, JBLK), P9SVDL=Z_YDVARS_SVD_DL9(:,:, JBLK), P9SVDM=Z_YDVARS_SVD_DM9&
      &(:,:, JBLK), P0SPL=Z_YDVARS_SP_DL(:, JBLK), P0SPM=Z_YDVARS_SP_DM(:, JBLK), P9SPL=Z_YDVARS_SP_DL9&
      &(:, JBLK), P9SPM=Z_YDVARS_SP_DM9(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPMPFC_EXPL_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_DIV_T9 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT9)
    Z_YDVARS_NHX_DL => GET_HOST_DATA_RDWR (YDVARS%NHX%FDL)
    Z_YDVARS_NHX_DM => GET_HOST_DATA_RDWR (YDVARS%NHX%FDM)
    Z_YDVARS_SPD_DL => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL)
    Z_YDVARS_SPD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL9)
    Z_YDVARS_SPD_DM => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM)
    Z_YDVARS_SPD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM9)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
    Z_YDVARS_SVD_DL => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL)
    Z_YDVARS_SVD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL9)
    Z_YDVARS_SVD_DM => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM)
    Z_YDVARS_SVD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM9)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DL9 => GET_HOST_DATA_RDWR (YDVARS%T%FDL9)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_T_DM9 => GET_HOST_DATA_RDWR (YDVARS%T%FDM9)
    Z_YDVARS_U_DL => GET_HOST_DATA_RDWR (YDVARS%U%FDL)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_VOR_T0 => GET_HOST_DATA_RDWR (YDVARS%VOR%FT0)
    Z_YDVARS_V_DL => GET_HOST_DATA_RDWR (YDVARS%V%FDL)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZGM => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_DIV_T9 => NULL ()
  Z_YDVARS_NHX_DL => NULL ()
  Z_YDVARS_NHX_DM => NULL ()
  Z_YDVARS_SPD_DL => NULL ()
  Z_YDVARS_SPD_DL9 => NULL ()
  Z_YDVARS_SPD_DM => NULL ()
  Z_YDVARS_SPD_DM9 => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DL9 => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_DM9 => NULL ()
  Z_YDVARS_SVD_DL => NULL ()
  Z_YDVARS_SVD_DL9 => NULL ()
  Z_YDVARS_SVD_DM => NULL ()
  Z_YDVARS_SVD_DM9 => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DL9 => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_T_DM9 => NULL ()
  Z_YDVARS_U_DL => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_VOR_T0 => NULL ()
  Z_YDVARS_V_DL => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPMPFC_EXPL_PARALLEL:1')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  ZGM => GET_DEVICE_DATA_RDONLY (YL_ZGM)
  Z_YDVARS_DIV_T0 => GET_DEVICE_DATA_RDWR (YDVARS%DIV%FT0)
  Z_YDVARS_DIV_T9 => GET_DEVICE_DATA_RDWR (YDVARS%DIV%FT9)
  Z_YDVARS_NHX_DL => GET_DEVICE_DATA_RDWR (YDVARS%NHX%FDL)
  Z_YDVARS_NHX_DM => GET_DEVICE_DATA_RDWR (YDVARS%NHX%FDM)
  Z_YDVARS_SPD_DL => GET_DEVICE_DATA_RDWR (YDVARS%SPD%FDL)
  Z_YDVARS_SPD_DL9 => GET_DEVICE_DATA_RDWR (YDVARS%SPD%FDL9)
  Z_YDVARS_SPD_DM => GET_DEVICE_DATA_RDWR (YDVARS%SPD%FDM)
  Z_YDVARS_SPD_DM9 => GET_DEVICE_DATA_RDWR (YDVARS%SPD%FDM9)
  Z_YDVARS_SP_DL => GET_DEVICE_DATA_RDWR (YDVARS%SP%FDL)
  Z_YDVARS_SP_DL9 => GET_DEVICE_DATA_RDWR (YDVARS%SP%FDL9)
  Z_YDVARS_SP_DM => GET_DEVICE_DATA_RDWR (YDVARS%SP%FDM)
  Z_YDVARS_SP_DM9 => GET_DEVICE_DATA_RDWR (YDVARS%SP%FDM9)
  Z_YDVARS_SVD_DL => GET_DEVICE_DATA_RDWR (YDVARS%SVD%FDL)
  Z_YDVARS_SVD_DL9 => GET_DEVICE_DATA_RDWR (YDVARS%SVD%FDL9)
  Z_YDVARS_SVD_DM => GET_DEVICE_DATA_RDWR (YDVARS%SVD%FDM)
  Z_YDVARS_SVD_DM9 => GET_DEVICE_DATA_RDWR (YDVARS%SVD%FDM9)
  Z_YDVARS_T_DL => GET_DEVICE_DATA_RDWR (YDVARS%T%FDL)
  Z_YDVARS_T_DL9 => GET_DEVICE_DATA_RDWR (YDVARS%T%FDL9)
  Z_YDVARS_T_DM => GET_DEVICE_DATA_RDWR (YDVARS%T%FDM)
  Z_YDVARS_T_DM9 => GET_DEVICE_DATA_RDWR (YDVARS%T%FDM9)
  Z_YDVARS_U_DL => GET_DEVICE_DATA_RDWR (YDVARS%U%FDL)
  Z_YDVARS_U_T0 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT0)
  Z_YDVARS_U_T9 => GET_DEVICE_DATA_RDWR (YDVARS%U%FT9)
  Z_YDVARS_VOR_T0 => GET_DEVICE_DATA_RDWR (YDVARS%VOR%FT0)
  Z_YDVARS_V_DL => GET_DEVICE_DATA_RDWR (YDVARS%V%FDL)
  Z_YDVARS_V_T0 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT0)
  Z_YDVARS_V_T9 => GET_DEVICE_DATA_RDWR (YDVARS%V%FT9)
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (YDCPG_OPTS, YDDYN, YDDYNA, YDML_GCONF, YFXTRAN_ACDC_STACK, ZGM, &
    !$ACC&         Z_YDVARS_DIV_T0, Z_YDVARS_DIV_T9, Z_YDVARS_NHX_DL, Z_YDVARS_NHX_DM, &
    !$ACC&         Z_YDVARS_SPD_DL, Z_YDVARS_SPD_DL9, Z_YDVARS_SPD_DM, Z_YDVARS_SPD_DM9, &
    !$ACC&         Z_YDVARS_SP_DL, Z_YDVARS_SP_DL9, Z_YDVARS_SP_DM, Z_YDVARS_SP_DM9, &
    !$ACC&         Z_YDVARS_SVD_DL, Z_YDVARS_SVD_DL9, Z_YDVARS_SVD_DM, Z_YDVARS_SVD_DM9, &
    !$ACC&         Z_YDVARS_T_DL, Z_YDVARS_T_DL9, Z_YDVARS_T_DM, Z_YDVARS_T_DM9, &
    !$ACC&         Z_YDVARS_U_DL, Z_YDVARS_U_T0, Z_YDVARS_U_T9, Z_YDVARS_VOR_T0, &
    !$ACC&         Z_YDVARS_V_DL, Z_YDVARS_V_T0, Z_YDVARS_V_T9) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JLON, YLCPG_BNDS, YLSTACK) 

    

    DO JLON = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JLON
      YLCPG_BNDS%KFDIA = JLON
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL GPMPFC_EXPL_PART1_OPENACC (YDML_GCONF, YDDYN, YDDYNA, YDCPG_OPTS%KLON, YDCPG_OPTS%KFLEVG, YLCPG_BNDS&
      &%KIDIA, YLCPG_BNDS%KFDIA, ZGM(:, JBLK), P0U=Z_YDVARS_U_T0(:,:, JBLK), P0V=Z_YDVARS_V_T0(:,:, JBLK&
      &), P0DIV=Z_YDVARS_DIV_T0(:,:, JBLK), P0TL=Z_YDVARS_T_DL(:,:, JBLK), P0TM=Z_YDVARS_T_DM(:,:, JBLK&
      &), P9U=Z_YDVARS_U_T9(:,:, JBLK), P9V=Z_YDVARS_V_T9(:,:, JBLK), P0UL=Z_YDVARS_U_DL(:,:, JBLK), P0VL&
      &=Z_YDVARS_V_DL(:,:, JBLK), P0VOR=Z_YDVARS_VOR_T0(:,:, JBLK), P0SPDL=Z_YDVARS_SPD_DL(:,:, JBLK), P0SPDM&
      &=Z_YDVARS_SPD_DM(:,:, JBLK), P0SVDL=Z_YDVARS_SVD_DL(:,:, JBLK), P0SVDM=Z_YDVARS_SVD_DM(:,:, JBLK&
      &), P0NHXL=Z_YDVARS_NHX_DL(:,:, JBLK), P0NHXM=Z_YDVARS_NHX_DM(:,:, JBLK), P9DIV=Z_YDVARS_DIV_T9(:&
      &,:, JBLK), P9TL=Z_YDVARS_T_DL9(:,:, JBLK), P9TM=Z_YDVARS_T_DM9(:,:, JBLK), P9SPDL=Z_YDVARS_SPD_DL9&
      &(:,:, JBLK), P9SPDM=Z_YDVARS_SPD_DM9(:,:, JBLK), P9SVDL=Z_YDVARS_SVD_DL9(:,:, JBLK), P9SVDM=Z_YDVARS_SVD_DM9&
      &(:,:, JBLK), P0SPL=Z_YDVARS_SP_DL(:, JBLK), P0SPM=Z_YDVARS_SP_DM(:, JBLK), P9SPL=Z_YDVARS_SP_DL9&
      &(:, JBLK), P9SPM=Z_YDVARS_SP_DM9(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('GPMPFC_EXPL_PARALLEL:1')) THEN
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    ZGM => GET_HOST_DATA_RDWR (YL_ZGM)
    Z_YDVARS_DIV_T0 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT0)
    Z_YDVARS_DIV_T9 => GET_HOST_DATA_RDWR (YDVARS%DIV%FT9)
    Z_YDVARS_NHX_DL => GET_HOST_DATA_RDWR (YDVARS%NHX%FDL)
    Z_YDVARS_NHX_DM => GET_HOST_DATA_RDWR (YDVARS%NHX%FDM)
    Z_YDVARS_SPD_DL => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL)
    Z_YDVARS_SPD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDL9)
    Z_YDVARS_SPD_DM => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM)
    Z_YDVARS_SPD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SPD%FDM9)
    Z_YDVARS_SP_DL => GET_HOST_DATA_RDWR (YDVARS%SP%FDL)
    Z_YDVARS_SP_DL9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDL9)
    Z_YDVARS_SP_DM => GET_HOST_DATA_RDWR (YDVARS%SP%FDM)
    Z_YDVARS_SP_DM9 => GET_HOST_DATA_RDWR (YDVARS%SP%FDM9)
    Z_YDVARS_SVD_DL => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL)
    Z_YDVARS_SVD_DL9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDL9)
    Z_YDVARS_SVD_DM => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM)
    Z_YDVARS_SVD_DM9 => GET_HOST_DATA_RDWR (YDVARS%SVD%FDM9)
    Z_YDVARS_T_DL => GET_HOST_DATA_RDWR (YDVARS%T%FDL)
    Z_YDVARS_T_DL9 => GET_HOST_DATA_RDWR (YDVARS%T%FDL9)
    Z_YDVARS_T_DM => GET_HOST_DATA_RDWR (YDVARS%T%FDM)
    Z_YDVARS_T_DM9 => GET_HOST_DATA_RDWR (YDVARS%T%FDM9)
    Z_YDVARS_U_DL => GET_HOST_DATA_RDWR (YDVARS%U%FDL)
    Z_YDVARS_U_T0 => GET_HOST_DATA_RDWR (YDVARS%U%FT0)
    Z_YDVARS_U_T9 => GET_HOST_DATA_RDWR (YDVARS%U%FT9)
    Z_YDVARS_VOR_T0 => GET_HOST_DATA_RDWR (YDVARS%VOR%FT0)
    Z_YDVARS_V_DL => GET_HOST_DATA_RDWR (YDVARS%V%FDL)
    Z_YDVARS_V_T0 => GET_HOST_DATA_RDWR (YDVARS%V%FT0)
    Z_YDVARS_V_T9 => GET_HOST_DATA_RDWR (YDVARS%V%FT9)
    IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  ZGM => NULL ()
  Z_YDVARS_DIV_T0 => NULL ()
  Z_YDVARS_DIV_T9 => NULL ()
  Z_YDVARS_NHX_DL => NULL ()
  Z_YDVARS_NHX_DM => NULL ()
  Z_YDVARS_SPD_DL => NULL ()
  Z_YDVARS_SPD_DL9 => NULL ()
  Z_YDVARS_SPD_DM => NULL ()
  Z_YDVARS_SPD_DM9 => NULL ()
  Z_YDVARS_SP_DL => NULL ()
  Z_YDVARS_SP_DL9 => NULL ()
  Z_YDVARS_SP_DM => NULL ()
  Z_YDVARS_SP_DM9 => NULL ()
  Z_YDVARS_SVD_DL => NULL ()
  Z_YDVARS_SVD_DL9 => NULL ()
  Z_YDVARS_SVD_DM => NULL ()
  Z_YDVARS_SVD_DM9 => NULL ()
  Z_YDVARS_T_DL => NULL ()
  Z_YDVARS_T_DL9 => NULL ()
  Z_YDVARS_T_DM => NULL ()
  Z_YDVARS_T_DM9 => NULL ()
  Z_YDVARS_U_DL => NULL ()
  Z_YDVARS_U_T0 => NULL ()
  Z_YDVARS_U_T9 => NULL ()
  Z_YDVARS_VOR_T0 => NULL ()
  Z_YDVARS_V_DL => NULL ()
  Z_YDVARS_V_T0 => NULL ()
  Z_YDVARS_V_T9 => NULL ()
  IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('GPMPFC_EXPL_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
CALL GPMPFC_EXPL_PART2_PARALLEL (YDVARS, YDCPG_OPTS, YDCPG_BNDS, YL_ZGM)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_ZGM0)) CALL FIELD_DELETE (YL_ZGM0)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('GPMPFC_EXPL_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE GPMPFC_EXPL_PARALLEL
