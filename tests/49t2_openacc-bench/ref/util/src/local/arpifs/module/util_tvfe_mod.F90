MODULE UTIL_TVFE_MOD

USE YOMVERT, ONLY : TVFE

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TVFE
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TVFE
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TVFE
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TVFE
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TVFE
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TVFE
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TVFE
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TVFE (SELF, KLUN)

IMPLICIT NONE
TYPE (TVFE), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LRDDERBF01, LRDDERI, LRDERB, LRDERBF00, LRDERBF01, LRDERBF10, LRDERBF11, LRDERBH00, LRDERBH01, LRDERGW
LOGICAL :: LRDERI, LRINTBF00, LRINTBF11, LRINTC, LRINTE, LRINTG, LRINTGW, LVFE_KNOT
LVFE_KNOT = ALLOCATED (SELF%VFE_KNOT)
WRITE (KLUN) LVFE_KNOT
IF (LVFE_KNOT) THEN
  WRITE (KLUN) LBOUND (SELF%VFE_KNOT)
  WRITE (KLUN) UBOUND (SELF%VFE_KNOT)
  WRITE (KLUN) SELF%VFE_KNOT
ENDIF
LRINTE = ALLOCATED (SELF%RINTE)
WRITE (KLUN) LRINTE
IF (LRINTE) THEN
  WRITE (KLUN) LBOUND (SELF%RINTE)
  WRITE (KLUN) UBOUND (SELF%RINTE)
  WRITE (KLUN) SELF%RINTE
ENDIF
LRINTBF00 = ALLOCATED (SELF%RINTBF00)
WRITE (KLUN) LRINTBF00
IF (LRINTBF00) THEN
  WRITE (KLUN) LBOUND (SELF%RINTBF00)
  WRITE (KLUN) UBOUND (SELF%RINTBF00)
  WRITE (KLUN) SELF%RINTBF00
ENDIF
LRINTBF11 = ALLOCATED (SELF%RINTBF11)
WRITE (KLUN) LRINTBF11
IF (LRINTBF11) THEN
  WRITE (KLUN) LBOUND (SELF%RINTBF11)
  WRITE (KLUN) UBOUND (SELF%RINTBF11)
  WRITE (KLUN) SELF%RINTBF11
ENDIF
LRDERI = ALLOCATED (SELF%RDERI)
WRITE (KLUN) LRDERI
IF (LRDERI) THEN
  WRITE (KLUN) LBOUND (SELF%RDERI)
  WRITE (KLUN) UBOUND (SELF%RDERI)
  WRITE (KLUN) SELF%RDERI
ENDIF
LRDERB = ALLOCATED (SELF%RDERB)
WRITE (KLUN) LRDERB
IF (LRDERB) THEN
  WRITE (KLUN) LBOUND (SELF%RDERB)
  WRITE (KLUN) UBOUND (SELF%RDERB)
  WRITE (KLUN) SELF%RDERB
ENDIF
LRDERBF00 = ALLOCATED (SELF%RDERBF00)
WRITE (KLUN) LRDERBF00
IF (LRDERBF00) THEN
  WRITE (KLUN) LBOUND (SELF%RDERBF00)
  WRITE (KLUN) UBOUND (SELF%RDERBF00)
  WRITE (KLUN) SELF%RDERBF00
ENDIF
LRDERBF01 = ALLOCATED (SELF%RDERBF01)
WRITE (KLUN) LRDERBF01
IF (LRDERBF01) THEN
  WRITE (KLUN) LBOUND (SELF%RDERBF01)
  WRITE (KLUN) UBOUND (SELF%RDERBF01)
  WRITE (KLUN) SELF%RDERBF01
ENDIF
LRDERBF10 = ALLOCATED (SELF%RDERBF10)
WRITE (KLUN) LRDERBF10
IF (LRDERBF10) THEN
  WRITE (KLUN) LBOUND (SELF%RDERBF10)
  WRITE (KLUN) UBOUND (SELF%RDERBF10)
  WRITE (KLUN) SELF%RDERBF10
ENDIF
LRDERBF11 = ALLOCATED (SELF%RDERBF11)
WRITE (KLUN) LRDERBF11
IF (LRDERBF11) THEN
  WRITE (KLUN) LBOUND (SELF%RDERBF11)
  WRITE (KLUN) UBOUND (SELF%RDERBF11)
  WRITE (KLUN) SELF%RDERBF11
ENDIF
LRDERBH00 = ALLOCATED (SELF%RDERBH00)
WRITE (KLUN) LRDERBH00
IF (LRDERBH00) THEN
  WRITE (KLUN) LBOUND (SELF%RDERBH00)
  WRITE (KLUN) UBOUND (SELF%RDERBH00)
  WRITE (KLUN) SELF%RDERBH00
ENDIF
LRDERBH01 = ALLOCATED (SELF%RDERBH01)
WRITE (KLUN) LRDERBH01
IF (LRDERBH01) THEN
  WRITE (KLUN) LBOUND (SELF%RDERBH01)
  WRITE (KLUN) UBOUND (SELF%RDERBH01)
  WRITE (KLUN) SELF%RDERBH01
ENDIF
LRDDERI = ALLOCATED (SELF%RDDERI)
WRITE (KLUN) LRDDERI
IF (LRDDERI) THEN
  WRITE (KLUN) LBOUND (SELF%RDDERI)
  WRITE (KLUN) UBOUND (SELF%RDDERI)
  WRITE (KLUN) SELF%RDDERI
ENDIF
LRDDERBF01 = ALLOCATED (SELF%RDDERBF01)
WRITE (KLUN) LRDDERBF01
IF (LRDDERBF01) THEN
  WRITE (KLUN) LBOUND (SELF%RDDERBF01)
  WRITE (KLUN) UBOUND (SELF%RDDERBF01)
  WRITE (KLUN) SELF%RDDERBF01
ENDIF
LRINTGW = ALLOCATED (SELF%RINTGW)
WRITE (KLUN) LRINTGW
IF (LRINTGW) THEN
  WRITE (KLUN) LBOUND (SELF%RINTGW)
  WRITE (KLUN) UBOUND (SELF%RINTGW)
  WRITE (KLUN) SELF%RINTGW
ENDIF
LRDERGW = ALLOCATED (SELF%RDERGW)
WRITE (KLUN) LRDERGW
IF (LRDERGW) THEN
  WRITE (KLUN) LBOUND (SELF%RDERGW)
  WRITE (KLUN) UBOUND (SELF%RDERGW)
  WRITE (KLUN) SELF%RDERGW
ENDIF
LRINTG = ALLOCATED (SELF%RINTG)
WRITE (KLUN) LRINTG
IF (LRINTG) THEN
  WRITE (KLUN) LBOUND (SELF%RINTG)
  WRITE (KLUN) UBOUND (SELF%RINTG)
  WRITE (KLUN) SELF%RINTG
ENDIF
LRINTC = ALLOCATED (SELF%RINTC)
WRITE (KLUN) LRINTC
IF (LRINTC) THEN
  WRITE (KLUN) LBOUND (SELF%RINTC)
  WRITE (KLUN) UBOUND (SELF%RINTC)
  WRITE (KLUN) SELF%RINTC
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TVFE (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TVFE), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2)
LOGICAL :: LRDDERBF01, LRDDERI, LRDERB, LRDERBF00, LRDERBF01, LRDERBF10, LRDERBF11, LRDERBH00, LRDERBH01, LRDERGW
LOGICAL :: LRDERI, LRINTBF00, LRINTBF11, LRINTC, LRINTE, LRINTG, LRINTGW, LVFE_KNOT
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) LVFE_KNOT
IF (LVFE_KNOT) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%VFE_KNOT (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%VFE_KNOT,1):UBOUND(SELF%VFE_KNOT,1)))
  READ (KLUN) ZTMP1
  SELF%VFE_KNOT = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LRINTE
IF (LRINTE) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RINTE (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RINTE
ENDIF
READ (KLUN) LRINTBF00
IF (LRINTBF00) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RINTBF00 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RINTBF00
ENDIF
READ (KLUN) LRINTBF11
IF (LRINTBF11) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RINTBF11 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RINTBF11
ENDIF
READ (KLUN) LRDERI
IF (LRDERI) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERI (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERI
ENDIF
READ (KLUN) LRDERB
IF (LRDERB) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERB (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERB
ENDIF
READ (KLUN) LRDERBF00
IF (LRDERBF00) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERBF00 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERBF00
ENDIF
READ (KLUN) LRDERBF01
IF (LRDERBF01) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERBF01 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERBF01
ENDIF
READ (KLUN) LRDERBF10
IF (LRDERBF10) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERBF10 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERBF10
ENDIF
READ (KLUN) LRDERBF11
IF (LRDERBF11) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERBF11 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERBF11
ENDIF
READ (KLUN) LRDERBH00
IF (LRDERBH00) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERBH00 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERBH00
ENDIF
READ (KLUN) LRDERBH01
IF (LRDERBH01) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERBH01 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERBH01
ENDIF
READ (KLUN) LRDDERI
IF (LRDDERI) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDDERI (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDDERI
ENDIF
READ (KLUN) LRDDERBF01
IF (LRDDERBF01) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDDERBF01 (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDDERBF01
ENDIF
READ (KLUN) LRINTGW
IF (LRINTGW) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RINTGW (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RINTGW
ENDIF
READ (KLUN) LRDERGW
IF (LRDERGW) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RDERGW (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RDERGW
ENDIF
READ (KLUN) LRINTG
IF (LRINTG) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RINTG (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%RINTG
ENDIF
READ (KLUN) LRINTC
IF (LRINTC) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%RINTC (IL1(1):IU1(1)))
  READ (KLUN) SELF%RINTC
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TVFE (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TVFE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRDDERBF01, LRDDERI, LRDERB, LRDERBF00, LRDERBF01, LRDERBF10, LRDERBF11, LRDERBH00, LRDERBH01, LRDERGW
LOGICAL :: LRDERI, LRINTBF00, LRINTBF11, LRINTC, LRINTE, LRINTG, LRINTGW, LVFE_KNOT
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF
LVFE_KNOT = ALLOCATED (SELF%VFE_KNOT)
IF (LVFE_KNOT) THEN
  !$ACC ENTER DATA CREATE (SELF%VFE_KNOT)
  !$ACC UPDATE DEVICE (SELF%VFE_KNOT)
  !$ACC ENTER DATA ATTACH (SELF%VFE_KNOT)
ENDIF

LRINTE = ALLOCATED (SELF%RINTE)
IF (LRINTE) THEN
  !$ACC ENTER DATA CREATE (SELF%RINTE)
  !$ACC UPDATE DEVICE (SELF%RINTE)
  !$ACC ENTER DATA ATTACH (SELF%RINTE)
ENDIF

LRINTBF00 = ALLOCATED (SELF%RINTBF00)
IF (LRINTBF00) THEN
  !$ACC ENTER DATA CREATE (SELF%RINTBF00)
  !$ACC UPDATE DEVICE (SELF%RINTBF00)
  !$ACC ENTER DATA ATTACH (SELF%RINTBF00)
ENDIF

LRINTBF11 = ALLOCATED (SELF%RINTBF11)
IF (LRINTBF11) THEN
  !$ACC ENTER DATA CREATE (SELF%RINTBF11)
  !$ACC UPDATE DEVICE (SELF%RINTBF11)
  !$ACC ENTER DATA ATTACH (SELF%RINTBF11)
ENDIF

LRDERI = ALLOCATED (SELF%RDERI)
IF (LRDERI) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERI)
  !$ACC UPDATE DEVICE (SELF%RDERI)
  !$ACC ENTER DATA ATTACH (SELF%RDERI)
ENDIF

LRDERB = ALLOCATED (SELF%RDERB)
IF (LRDERB) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERB)
  !$ACC UPDATE DEVICE (SELF%RDERB)
  !$ACC ENTER DATA ATTACH (SELF%RDERB)
ENDIF

LRDERBF00 = ALLOCATED (SELF%RDERBF00)
IF (LRDERBF00) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERBF00)
  !$ACC UPDATE DEVICE (SELF%RDERBF00)
  !$ACC ENTER DATA ATTACH (SELF%RDERBF00)
ENDIF

LRDERBF01 = ALLOCATED (SELF%RDERBF01)
IF (LRDERBF01) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERBF01)
  !$ACC UPDATE DEVICE (SELF%RDERBF01)
  !$ACC ENTER DATA ATTACH (SELF%RDERBF01)
ENDIF

LRDERBF10 = ALLOCATED (SELF%RDERBF10)
IF (LRDERBF10) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERBF10)
  !$ACC UPDATE DEVICE (SELF%RDERBF10)
  !$ACC ENTER DATA ATTACH (SELF%RDERBF10)
ENDIF

LRDERBF11 = ALLOCATED (SELF%RDERBF11)
IF (LRDERBF11) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERBF11)
  !$ACC UPDATE DEVICE (SELF%RDERBF11)
  !$ACC ENTER DATA ATTACH (SELF%RDERBF11)
ENDIF

LRDERBH00 = ALLOCATED (SELF%RDERBH00)
IF (LRDERBH00) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERBH00)
  !$ACC UPDATE DEVICE (SELF%RDERBH00)
  !$ACC ENTER DATA ATTACH (SELF%RDERBH00)
ENDIF

LRDERBH01 = ALLOCATED (SELF%RDERBH01)
IF (LRDERBH01) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERBH01)
  !$ACC UPDATE DEVICE (SELF%RDERBH01)
  !$ACC ENTER DATA ATTACH (SELF%RDERBH01)
ENDIF

LRDDERI = ALLOCATED (SELF%RDDERI)
IF (LRDDERI) THEN
  !$ACC ENTER DATA CREATE (SELF%RDDERI)
  !$ACC UPDATE DEVICE (SELF%RDDERI)
  !$ACC ENTER DATA ATTACH (SELF%RDDERI)
ENDIF

LRDDERBF01 = ALLOCATED (SELF%RDDERBF01)
IF (LRDDERBF01) THEN
  !$ACC ENTER DATA CREATE (SELF%RDDERBF01)
  !$ACC UPDATE DEVICE (SELF%RDDERBF01)
  !$ACC ENTER DATA ATTACH (SELF%RDDERBF01)
ENDIF

LRINTGW = ALLOCATED (SELF%RINTGW)
IF (LRINTGW) THEN
  !$ACC ENTER DATA CREATE (SELF%RINTGW)
  !$ACC UPDATE DEVICE (SELF%RINTGW)
  !$ACC ENTER DATA ATTACH (SELF%RINTGW)
ENDIF

LRDERGW = ALLOCATED (SELF%RDERGW)
IF (LRDERGW) THEN
  !$ACC ENTER DATA CREATE (SELF%RDERGW)
  !$ACC UPDATE DEVICE (SELF%RDERGW)
  !$ACC ENTER DATA ATTACH (SELF%RDERGW)
ENDIF

LRINTG = ALLOCATED (SELF%RINTG)
IF (LRINTG) THEN
  !$ACC ENTER DATA CREATE (SELF%RINTG)
  !$ACC UPDATE DEVICE (SELF%RINTG)
  !$ACC ENTER DATA ATTACH (SELF%RINTG)
ENDIF

LRINTC = ALLOCATED (SELF%RINTC)
IF (LRINTC) THEN
  !$ACC ENTER DATA CREATE (SELF%RINTC)
  !$ACC UPDATE DEVICE (SELF%RINTC)
  !$ACC ENTER DATA ATTACH (SELF%RINTC)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TVFE (SELF)

IMPLICIT NONE
TYPE (TVFE), TARGET :: SELF
LOGICAL :: LRDDERBF01, LRDDERI, LRDERB, LRDERBF00, LRDERBF01, LRDERBF10, LRDERBF11, LRDERBH00, LRDERBH01, LRDERGW
LOGICAL :: LRDERI, LRINTBF00, LRINTBF11, LRINTC, LRINTE, LRINTG, LRINTGW, LVFE_KNOT

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TVFE (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TVFE), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LRDDERBF01, LRDDERI, LRDERB, LRDERBF00, LRDERBF01, LRDERBF10, LRDERBF11, LRDERBH00, LRDERBH01, LRDERGW
LOGICAL :: LRDERI, LRINTBF00, LRINTBF11, LRINTC, LRINTE, LRINTG, LRINTGW, LVFE_KNOT
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%VFE_KNOT), CDPATH//'%VFE_KNOT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RINTE), CDPATH//'%RINTE'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RINTBF00), CDPATH//'%RINTBF00'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RINTBF11), CDPATH//'%RINTBF11'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERI), CDPATH//'%RDERI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERB), CDPATH//'%RDERB'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERBF00), CDPATH//'%RDERBF00'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERBF01), CDPATH//'%RDERBF01'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERBF10), CDPATH//'%RDERBF10'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERBF11), CDPATH//'%RDERBF11'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERBH00), CDPATH//'%RDERBH00'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERBH01), CDPATH//'%RDERBH01'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDDERI), CDPATH//'%RDDERI'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDDERBF01), CDPATH//'%RDDERBF01'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RINTGW), CDPATH//'%RINTGW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RDERGW), CDPATH//'%RDERGW'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RINTG), CDPATH//'%RINTG'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RINTC), CDPATH//'%RINTC'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TVFE (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TVFE), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LRDDERBF01, LRDDERI, LRDERB, LRDERBF00, LRDERBF01, LRDERBF10, LRDERBF11, LRDERBH00, LRDERBH01, LRDERGW
LOGICAL :: LRDERI, LRINTBF00, LRINTBF11, LRINTC, LRINTE, LRINTG, LRINTGW, LVFE_KNOT
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LVFE_KNOT = ALLOCATED (SELF%VFE_KNOT)
IF (LVFE_KNOT) THEN
  !$ACC EXIT DATA DETACH (SELF%VFE_KNOT)
  !$ACC EXIT DATA DELETE (SELF%VFE_KNOT)
ENDIF

LRINTE = ALLOCATED (SELF%RINTE)
IF (LRINTE) THEN
  !$ACC EXIT DATA DETACH (SELF%RINTE)
  !$ACC EXIT DATA DELETE (SELF%RINTE)
ENDIF

LRINTBF00 = ALLOCATED (SELF%RINTBF00)
IF (LRINTBF00) THEN
  !$ACC EXIT DATA DETACH (SELF%RINTBF00)
  !$ACC EXIT DATA DELETE (SELF%RINTBF00)
ENDIF

LRINTBF11 = ALLOCATED (SELF%RINTBF11)
IF (LRINTBF11) THEN
  !$ACC EXIT DATA DETACH (SELF%RINTBF11)
  !$ACC EXIT DATA DELETE (SELF%RINTBF11)
ENDIF

LRDERI = ALLOCATED (SELF%RDERI)
IF (LRDERI) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERI)
  !$ACC EXIT DATA DELETE (SELF%RDERI)
ENDIF

LRDERB = ALLOCATED (SELF%RDERB)
IF (LRDERB) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERB)
  !$ACC EXIT DATA DELETE (SELF%RDERB)
ENDIF

LRDERBF00 = ALLOCATED (SELF%RDERBF00)
IF (LRDERBF00) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERBF00)
  !$ACC EXIT DATA DELETE (SELF%RDERBF00)
ENDIF

LRDERBF01 = ALLOCATED (SELF%RDERBF01)
IF (LRDERBF01) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERBF01)
  !$ACC EXIT DATA DELETE (SELF%RDERBF01)
ENDIF

LRDERBF10 = ALLOCATED (SELF%RDERBF10)
IF (LRDERBF10) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERBF10)
  !$ACC EXIT DATA DELETE (SELF%RDERBF10)
ENDIF

LRDERBF11 = ALLOCATED (SELF%RDERBF11)
IF (LRDERBF11) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERBF11)
  !$ACC EXIT DATA DELETE (SELF%RDERBF11)
ENDIF

LRDERBH00 = ALLOCATED (SELF%RDERBH00)
IF (LRDERBH00) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERBH00)
  !$ACC EXIT DATA DELETE (SELF%RDERBH00)
ENDIF

LRDERBH01 = ALLOCATED (SELF%RDERBH01)
IF (LRDERBH01) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERBH01)
  !$ACC EXIT DATA DELETE (SELF%RDERBH01)
ENDIF

LRDDERI = ALLOCATED (SELF%RDDERI)
IF (LRDDERI) THEN
  !$ACC EXIT DATA DETACH (SELF%RDDERI)
  !$ACC EXIT DATA DELETE (SELF%RDDERI)
ENDIF

LRDDERBF01 = ALLOCATED (SELF%RDDERBF01)
IF (LRDDERBF01) THEN
  !$ACC EXIT DATA DETACH (SELF%RDDERBF01)
  !$ACC EXIT DATA DELETE (SELF%RDDERBF01)
ENDIF

LRINTGW = ALLOCATED (SELF%RINTGW)
IF (LRINTGW) THEN
  !$ACC EXIT DATA DETACH (SELF%RINTGW)
  !$ACC EXIT DATA DELETE (SELF%RINTGW)
ENDIF

LRDERGW = ALLOCATED (SELF%RDERGW)
IF (LRDERGW) THEN
  !$ACC EXIT DATA DETACH (SELF%RDERGW)
  !$ACC EXIT DATA DELETE (SELF%RDERGW)
ENDIF

LRINTG = ALLOCATED (SELF%RINTG)
IF (LRINTG) THEN
  !$ACC EXIT DATA DETACH (SELF%RINTG)
  !$ACC EXIT DATA DELETE (SELF%RINTG)
ENDIF

LRINTC = ALLOCATED (SELF%RINTC)
IF (LRINTC) THEN
  !$ACC EXIT DATA DETACH (SELF%RINTC)
  !$ACC EXIT DATA DELETE (SELF%RINTC)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TVFE (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TVFE),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LRDDERBF01, LRDDERI, LRDERB, LRDERBF00, LRDERBF01, LRDERBF10, LRDERBF11, LRDERBH00, LRDERBH01, LRDERGW
LOGICAL :: LRDERI, LRINTBF00, LRINTBF11, LRINTC, LRINTE, LRINTG, LRINTGW, LVFE_KNOT
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
LVFE_KNOT = ALLOCATED (SELF%VFE_KNOT)
IF (LVFE_KNOT) THEN
  ISIZE = KIND (SELF%VFE_KNOT) * SIZE (SELF%VFE_KNOT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%VFE_KNOT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRINTE = ALLOCATED (SELF%RINTE)
IF (LRINTE) THEN
  ISIZE = KIND (SELF%RINTE) * SIZE (SELF%RINTE)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RINTE'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRINTBF00 = ALLOCATED (SELF%RINTBF00)
IF (LRINTBF00) THEN
  ISIZE = KIND (SELF%RINTBF00) * SIZE (SELF%RINTBF00)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RINTBF00'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRINTBF11 = ALLOCATED (SELF%RINTBF11)
IF (LRINTBF11) THEN
  ISIZE = KIND (SELF%RINTBF11) * SIZE (SELF%RINTBF11)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RINTBF11'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERI = ALLOCATED (SELF%RDERI)
IF (LRDERI) THEN
  ISIZE = KIND (SELF%RDERI) * SIZE (SELF%RDERI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERB = ALLOCATED (SELF%RDERB)
IF (LRDERB) THEN
  ISIZE = KIND (SELF%RDERB) * SIZE (SELF%RDERB)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERB'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERBF00 = ALLOCATED (SELF%RDERBF00)
IF (LRDERBF00) THEN
  ISIZE = KIND (SELF%RDERBF00) * SIZE (SELF%RDERBF00)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERBF00'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERBF01 = ALLOCATED (SELF%RDERBF01)
IF (LRDERBF01) THEN
  ISIZE = KIND (SELF%RDERBF01) * SIZE (SELF%RDERBF01)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERBF01'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERBF10 = ALLOCATED (SELF%RDERBF10)
IF (LRDERBF10) THEN
  ISIZE = KIND (SELF%RDERBF10) * SIZE (SELF%RDERBF10)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERBF10'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERBF11 = ALLOCATED (SELF%RDERBF11)
IF (LRDERBF11) THEN
  ISIZE = KIND (SELF%RDERBF11) * SIZE (SELF%RDERBF11)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERBF11'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERBH00 = ALLOCATED (SELF%RDERBH00)
IF (LRDERBH00) THEN
  ISIZE = KIND (SELF%RDERBH00) * SIZE (SELF%RDERBH00)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERBH00'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERBH01 = ALLOCATED (SELF%RDERBH01)
IF (LRDERBH01) THEN
  ISIZE = KIND (SELF%RDERBH01) * SIZE (SELF%RDERBH01)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERBH01'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDDERI = ALLOCATED (SELF%RDDERI)
IF (LRDDERI) THEN
  ISIZE = KIND (SELF%RDDERI) * SIZE (SELF%RDDERI)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDDERI'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDDERBF01 = ALLOCATED (SELF%RDDERBF01)
IF (LRDDERBF01) THEN
  ISIZE = KIND (SELF%RDDERBF01) * SIZE (SELF%RDDERBF01)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDDERBF01'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRINTGW = ALLOCATED (SELF%RINTGW)
IF (LRINTGW) THEN
  ISIZE = KIND (SELF%RINTGW) * SIZE (SELF%RINTGW)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RINTGW'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRDERGW = ALLOCATED (SELF%RDERGW)
IF (LRDERGW) THEN
  ISIZE = KIND (SELF%RDERGW) * SIZE (SELF%RDERGW)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RDERGW'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRINTG = ALLOCATED (SELF%RINTG)
IF (LRINTG) THEN
  ISIZE = KIND (SELF%RINTG) * SIZE (SELF%RINTG)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RINTG'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRINTC = ALLOCATED (SELF%RINTC)
IF (LRINTC) THEN
  ISIZE = KIND (SELF%RINTC) * SIZE (SELF%RINTC)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RINTC'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
