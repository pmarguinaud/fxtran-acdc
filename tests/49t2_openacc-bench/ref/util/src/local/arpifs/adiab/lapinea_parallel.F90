
SUBROUTINE LAPINEA_PARALLEL (YDMODEL, YDGEOMETRY, YDCPG_OPTS, YDCPG_BNDS, YDSL, YDCPG_SL1, YDCPG_SL2,&
& YDA_PWRL9, YDMASK_SL2, YDA_KVSEPC, YDA_KVSEPL, YDA_RSAVEDP, YDA_PCCO, YDA_PUF, YDA_PVF, YDA_KL0, YDA_KLH0&
&, YDA_PLSCAW, YDA_PRSCAW, YDA_KL0H, YDA_PLSCAWH, YDA_PRSCAWH, YDA_PSCO, YDVARS, YDA_KNOWENO)
USE TYPE_MODEL,ONLY:MODEL
USE GEOMETRY_MOD,ONLY:GEOMETRY

USE YOMHOOK,ONLY:LHOOK, DR_HOOK, JPHOOK
USE EINT_MOD,ONLY:SL_STRUCT
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_SL1_TYPE_MOD,ONLY:CPG_SL1F_TYPE
USE CPG_SL2_TYPE_MOD,ONLY:CPG_SL2_TYPE
USE CPG_SL_MASK_TYPE_MOD,ONLY:CPG_SL_MASK_TYPE
USE FIELD_ARRAY_MODULE
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_OPTS_TYPE, CPG_BNDS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (MODEL), INTENT (IN)::YDMODEL
TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (SL_STRUCT), INTENT (IN)::YDSL
TYPE (CPG_SL1F_TYPE), INTENT (IN)::YDCPG_SL1
TYPE (CPG_SL2_TYPE), INTENT (IN)::YDCPG_SL2
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PWRL9
TYPE (CPG_SL_MASK_TYPE), INTENT (INOUT)::YDMASK_SL2
TYPE (FIELD_2IM_ARRAY), INTENT (INOUT)::YDA_KVSEPC
TYPE (FIELD_2IM_ARRAY), INTENT (INOUT)::YDA_KVSEPL
TYPE (FIELD_4RB_ARRAY), INTENT (INOUT)::YDA_RSAVEDP
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PCCO
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PUF
TYPE (FIELD_3RB_ARRAY), INTENT (IN)::YDA_PVF
TYPE (FIELD_4IM_ARRAY), INTENT (IN)::YDA_KL0
TYPE (FIELD_4IM_ARRAY), INTENT (IN)::YDA_KLH0
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PLSCAW
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PRSCAW
TYPE (FIELD_4IM_ARRAY), INTENT (IN)::YDA_KL0H
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PLSCAWH
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PRSCAWH
TYPE (FIELD_4RB_ARRAY), INTENT (IN)::YDA_PSCO
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
TYPE (FIELD_3IM_ARRAY), INTENT (IN)::YDA_KNOWENO
CLASS (FIELD_3IM), POINTER :: YL_ILEV
INTEGER (KIND=JPIM), POINTER::ILEV (:,:,:)
INTEGER (KIND=JPIM)::IGLGLO
INTEGER (KIND=JPIM)::IHVI
INTEGER (KIND=JPIM)::IROT
INTEGER (KIND=JPIM)::ITIP
INTEGER (KIND=JPIM)::JGL
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JGFL
CLASS (FIELD_3IM), POINTER :: YL_IDEP
INTEGER (KIND=JPIM), POINTER::IDEP (:,:,:)
INTEGER (KIND=JPIM)::I_DPDETA0
INTEGER (KIND=JPIM)::I_UTRAJ
INTEGER (KIND=JPIM)::I_VTRAJ
INTEGER (KIND=JPIM)::I_WTRAJ
INTEGER (KIND=JPIM)::I_LAMBDA0
INTEGER (KIND=JPIM)::I_THETA0
INTEGER (KIND=JPIM)::I_ETA0
LOGICAL::LLINTV
REAL (KIND=JPRB)::ZZRL0 (1)
REAL (KIND=JPRB)::ZVF0 (1)
REAL (KIND=JPRB)::ZURL0 (1)
REAL (KIND=JPRB)::ZUF0 (1)
REAL (KIND=JPRB)::ZWRL0 (1)
REAL (KIND=JPRB)::ZWFSM (1)
REAL (KIND=JPRB)::ZWF0 (1)
REAL (KIND=JPRB)::ZZF0 (1)
REAL (KIND=JPRB)::ZVRL0 (1)
CLASS (FIELD_3RB), POINTER :: YL_ZWF
REAL (KIND=JPRB), POINTER::ZWF (:,:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGMDTX
REAL (KIND=JPRB), POINTER::ZGMDTX (:,:)
CLASS (FIELD_2RB), POINTER :: YL_ZGMDTY
REAL (KIND=JPRB), POINTER::ZGMDTY (:,:)
CLASS (FIELD_3RB), POINTER :: YL_ZLEV
REAL (KIND=JPRB), POINTER::ZLEV (:,:,:)
#include "larcina.intfb.h"
#include "larcina_openacc.intfb.h"
#include "larmes_parallel.intfb.h"
#include "abor1.intfb.h"
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
INTEGER(KIND=JPIM), POINTER :: Z_YDA_KL0_P(:,:,:,:)
INTEGER(KIND=JPIM), POINTER :: Z_YDA_KLH0_P(:,:,:,:)
INTEGER(KIND=JPIM), POINTER :: Z_YDA_KNOWENO_P(:,:,:)
INTEGER(KIND=JPIM), POINTER :: Z_YDA_KVSEPC_P(:,:)
INTEGER(KIND=JPIM), POINTER :: Z_YDA_KVSEPL_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDA_PCCO_P(:,:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDA_PLSCAW_P(:,:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDA_PRSCAW_P(:,:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDA_PSCO_P(:,:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_KAPPA(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_KAPPAH(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_KAPPAM(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_KAPPAT(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_STDDISU(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_STDDISV(:,:,:)
REAL (KIND=JPRB), POINTER :: Z_YDCPG_SL2_STDDISW(:,:,:)
INTEGER (KIND=JPIM), POINTER :: Z_YDMASK_SL2_P(:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GECLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GEMU_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GESLO_P(:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GEOMETRY_GSQM2_P(:,:)
REAL(KIND=JPRD), POINTER :: Z_YDVARS_GEOMETRY_RCOLON_P(:,:)
REAL(KIND=JPRD), POINTER :: Z_YDVARS_GEOMETRY_RSILON_P(:,:)
IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
CALL FIELD_NEW (YL_ZWF, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZLEV, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMDTY, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ZGMDTX, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDCPG_OPTS&
&%JBLKMAX], LBOUNDS=[1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_ILEV, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
CALL FIELD_NEW (YL_IDEP, UBOUNDS=[YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG&
&, YDCPG_OPTS%JBLKMAX], LBOUNDS=[1, 1, YDCPG_OPTS%JBLKMIN], PERSISTENT=.TRUE.)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)


I_DPDETA0=-1
I_UTRAJ=-1
I_VTRAJ=-1
I_WTRAJ=-1
I_LAMBDA0=-1
I_THETA0=-1
I_ETA0=-1

DO JGFL=1, SIZE (YDVARS%SLDIA)

  IF (TRIM (YDVARS%SLDIA (JGFL)%CNAME)=='DPDETA0') THEN
    I_DPDETA0=JGFL
  ELSEIF (TRIM (YDVARS%SLDIA (JGFL)%CNAME)=='UTRAJ') THEN
    I_UTRAJ=JGFL
  ELSEIF (TRIM (YDVARS%SLDIA (JGFL)%CNAME)=='VTRAJ') THEN
    I_VTRAJ=JGFL
  ELSEIF (TRIM (YDVARS%SLDIA (JGFL)%CNAME)=='WTRAJ') THEN
    I_WTRAJ=JGFL
  ELSEIF (TRIM (YDVARS%SLDIA (JGFL)%CNAME)=='LAMBDA0') THEN
    I_LAMBDA0=JGFL
  ELSEIF (TRIM (YDVARS%SLDIA (JGFL)%CNAME)=='THETA0') THEN
    I_THETA0=JGFL
  ELSEIF (TRIM (YDVARS%SLDIA (JGFL)%CNAME)=='ETA0') THEN
    I_ETA0=JGFL
  ENDIF

ENDDO

IHVI=0

DO JGFL=1, YDMODEL%YRML_GCONF%YGFL%NUMFLDS

  IF (YDMODEL%YRML_GCONF%YGFL%YCOMP(JGFL)%CSLINT=='LAIHVT      '.OR.YDMODEL%YRML_GCONF%YGFL%YCOMP(JGFL&
    &)%CSLINT=='LAIHVTQM    '.OR.YDMODEL%YRML_GCONF%YGFL%YCOMP(JGFL)%CSLINT=='LAIHVTQMH   ') THEN
    IHVI=1
  ENDIF

ENDDO


IF (YDCPG_OPTS%LRPLANE) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDCPG_OPTS%LRPLANE) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ELSE

  IF (YDMODEL%YRML_DYN%YRDYN%LSLDP_RK) THEN
    
    
    CALL ABOR1 ("ERROR: WRONG SETTINGS")
    
  ELSEIF (YDMODEL%YRML_DYN%YRDYN%LSLDP_XYZ) THEN
    
    
    CALL ABOR1 ("ERROR: WRONG SETTINGS")
    
  ELSE
    CALL LARMES_PARALLEL (YDGEOMETRY, YDVARS%GEOMETRY, YDMODEL%YRCST, YDMODEL%YRML_GCONF%YRRIP&
    &, YDMODEL%YRML_DYN, YDCPG_OPTS, YDCPG_BNDS, YDSL, YDCPG_SL1, YDCPG_SL2, YDMASK_SL2, YDA_KVSEPC&
    &, YDA_KVSEPL, YDA_PSCO%F_P, YL_ZLEV, YDA_PCCO%F_P, YDA_PUF%F_P, YDA_PVF%F_P, YL_ZWF, YDA_KL0&
    &%F_P, YDA_KLH0%F_P, YL_ILEV, YDA_PLSCAW%F_P, YDA_PRSCAW%F_P)
  ENDIF


  IF (YDMODEL%YRML_DYN%YRDYNA%LSLDIA.AND.(YDMODEL%YRML_DYN%YRDYNA%LPC_CHEAP.OR.(YDMODEL&
    &%YRML_DYN%YRDYN%NCURRENT_ITER==YDMODEL%YRML_DYN%YRDYN%NSITER))) THEN
    
    
    
    
    
    
    
    CALL ABOR1 ("ERROR: WRONG SETTINGS")
    
  ENDIF

ENDIF


IF (YDMODEL%YRML_DYN%YRDYN%LRHS_CURV) THEN
  IROT=0
ELSE
  IROT=1
ENDIF

ITIP=2
LLINTV=.FALSE.
IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA',0,ZHOOK_HANDLE_PARALLEL)

IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','LAPINEA_PARALLEL:LARCINA')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
  ILEV => GET_HOST_DATA_RDWR (YL_ILEV)
  ZLEV => GET_HOST_DATA_RDONLY (YL_ZLEV)
  Z_YDA_KL0_P => GET_HOST_DATA_RDWR (YDA_KL0%F_P)
  Z_YDA_KLH0_P => GET_HOST_DATA_RDWR (YDA_KLH0%F_P)
  Z_YDA_KNOWENO_P => GET_HOST_DATA_RDWR (YDA_KNOWENO%F_P)
  Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
  Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
  Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
  Z_YDA_PLSCAW_P => GET_HOST_DATA_RDWR (YDA_PLSCAW%F_P)
  Z_YDA_PRSCAW_P => GET_HOST_DATA_RDWR (YDA_PRSCAW%F_P)
  Z_YDA_PSCO_P => GET_HOST_DATA_RDONLY (YDA_PSCO%F_P)
  Z_YDCPG_SL2_KAPPA => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPA)
  Z_YDCPG_SL2_KAPPAH => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPAH)
  Z_YDCPG_SL2_KAPPAM => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPAM)
  Z_YDCPG_SL2_KAPPAT => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPAT)
  Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISU)
  Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISV)
  Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISW)
  Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
  Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
  Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
  Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
  Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCOLON%FT0)
  Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RSILON%FT0)
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
  !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    CALL YLCPG_BNDS%UPDATE (JBLK)
    
    CALL LARCINA (YDGEOMETRY, YDMODEL%YRCST, YDMODEL%YRML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA, YDSL&
    &, IHVI, YDMODEL%YRML_DYN%YRDYN%LFINDVSEP, YDMODEL%YRML_DYN%YRDYNA%LSLHD, YDMODEL%YRML_DYN%YRDYNA&
    &%LSLHDQUAD, LLINTV, ITIP, IROT, YDCPG_OPTS%LRPLANE, Z_YDA_PSCO_P(:,:,:, JBLK), ZLEV(:,:, JBLK), Z_YDCPG_SL2_KAPPA&
    &(:,:, JBLK), Z_YDCPG_SL2_KAPPAT(:,:, JBLK), Z_YDCPG_SL2_KAPPAM(:,:, JBLK), Z_YDCPG_SL2_KAPPAH(:,&
    &:, JBLK), Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,&
    &:, JBLK), ZURL0, ZVRL0, ZZRL0, ZWRL0, Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P&
    &(:, JBLK), Z_YDA_PCCO_P(:,:,:, JBLK), ZUF0, ZVF0, ZZF0, ZWF0, ZWFSM, Z_YDA_KL0_P(:,:,:, JBLK), Z_YDA_KLH0_P&
    &(:,:,:, JBLK), ILEV(:,:, JBLK), Z_YDA_PLSCAW_P(:,:,:, JBLK), Z_YDA_PRSCAW_P(:,:,:, JBLK), IDEP(:&
    &,:, JBLK), Z_YDA_KNOWENO_P(:,:, JBLK), Z_YDVARS_GEOMETRY_RCOLON_P(:, JBLK), Z_YDVARS_GEOMETRY_RSILON_P&
    &(:, JBLK), Z_YDVARS_GEOMETRY_GECLO_P(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_P(:, JBLK), Z_YDVARS_GEOMETRY_GESLO_P&
    &(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P(:, JBLK))
  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEA_PARALLEL:LARCINA')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
    ILEV => GET_HOST_DATA_RDWR (YL_ILEV)
    ZLEV => GET_HOST_DATA_RDWR (YL_ZLEV)
    Z_YDA_KL0_P => GET_HOST_DATA_RDWR (YDA_KL0%F_P)
    Z_YDA_KLH0_P => GET_HOST_DATA_RDWR (YDA_KLH0%F_P)
    Z_YDA_KNOWENO_P => GET_HOST_DATA_RDWR (YDA_KNOWENO%F_P)
    Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
    Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDA_PLSCAW_P => GET_HOST_DATA_RDWR (YDA_PLSCAW%F_P)
    Z_YDA_PRSCAW_P => GET_HOST_DATA_RDWR (YDA_PRSCAW%F_P)
    Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
    Z_YDCPG_SL2_KAPPA => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPA)
    Z_YDCPG_SL2_KAPPAH => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAH)
    Z_YDCPG_SL2_KAPPAM => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAM)
    Z_YDCPG_SL2_KAPPAT => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAT)
    Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISU)
    Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISV)
    Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISW)
    Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
    Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
    Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
    Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
    Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCOLON%FT0)
    Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RSILON%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => NULL ()
  ILEV => NULL ()
  ZLEV => NULL ()
  Z_YDA_KL0_P => NULL ()
  Z_YDA_KLH0_P => NULL ()
  Z_YDA_KNOWENO_P => NULL ()
  Z_YDA_KVSEPC_P => NULL ()
  Z_YDA_KVSEPL_P => NULL ()
  Z_YDA_PCCO_P => NULL ()
  Z_YDA_PLSCAW_P => NULL ()
  Z_YDA_PRSCAW_P => NULL ()
  Z_YDA_PSCO_P => NULL ()
  Z_YDCPG_SL2_KAPPA => NULL ()
  Z_YDCPG_SL2_KAPPAH => NULL ()
  Z_YDCPG_SL2_KAPPAM => NULL ()
  Z_YDCPG_SL2_KAPPAT => NULL ()
  Z_YDCPG_SL2_STDDISU => NULL ()
  Z_YDCPG_SL2_STDDISV => NULL ()
  Z_YDCPG_SL2_STDDISW => NULL ()
  Z_YDMASK_SL2_P => NULL ()
  Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
  Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
  Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
  Z_YDVARS_GEOMETRY_RCOLON_P => NULL ()
  Z_YDVARS_GEOMETRY_RSILON_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','LAPINEA_PARALLEL:LARCINA')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
  ILEV => GET_HOST_DATA_RDWR (YL_ILEV)
  ZLEV => GET_HOST_DATA_RDONLY (YL_ZLEV)
  Z_YDA_KL0_P => GET_HOST_DATA_RDWR (YDA_KL0%F_P)
  Z_YDA_KLH0_P => GET_HOST_DATA_RDWR (YDA_KLH0%F_P)
  Z_YDA_KNOWENO_P => GET_HOST_DATA_RDWR (YDA_KNOWENO%F_P)
  Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
  Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
  Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
  Z_YDA_PLSCAW_P => GET_HOST_DATA_RDWR (YDA_PLSCAW%F_P)
  Z_YDA_PRSCAW_P => GET_HOST_DATA_RDWR (YDA_PRSCAW%F_P)
  Z_YDA_PSCO_P => GET_HOST_DATA_RDONLY (YDA_PSCO%F_P)
  Z_YDCPG_SL2_KAPPA => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPA)
  Z_YDCPG_SL2_KAPPAH => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPAH)
  Z_YDCPG_SL2_KAPPAM => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPAM)
  Z_YDCPG_SL2_KAPPAT => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_KAPPAT)
  Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISU)
  Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISV)
  Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDONLY (YDCPG_SL2%F_STDDISW)
  Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
  Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
  Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
  Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
  Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RCOLON%FT0)
  Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDONLY (YDVARS%GEOMETRY%RSILON%FT0)
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS, YLSTACK)

  DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

    

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL LARCINA_OPENACC (YDGEOMETRY, YDMODEL%YRCST, YDMODEL%YRML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDSL, IHVI, YDMODEL%YRML_DYN%YRDYN%LFINDVSEP, YDMODEL%YRML_DYN%YRDYNA%LSLHD, YDMODEL%YRML_DYN%YRDYNA&
      &%LSLHDQUAD, LLINTV, ITIP, IROT, YDCPG_OPTS%LRPLANE, Z_YDA_PSCO_P(:,:,:, JBLK), ZLEV(:,:, JBLK), Z_YDCPG_SL2_KAPPA&
      &(:,:, JBLK), Z_YDCPG_SL2_KAPPAT(:,:, JBLK), Z_YDCPG_SL2_KAPPAM(:,:, JBLK), Z_YDCPG_SL2_KAPPAH(:,:, JBLK&
      &), Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), ZURL0&
      &, ZVRL0, ZZRL0, ZWRL0, Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK), Z_YDA_PCCO_P&
      &(:,:,:, JBLK), ZUF0, ZVF0, ZZF0, ZWF0, ZWFSM, Z_YDA_KL0_P(:,:,:, JBLK), Z_YDA_KLH0_P(:,:,:, JBLK), ILEV&
      &(:,:, JBLK), Z_YDA_PLSCAW_P(:,:,:, JBLK), Z_YDA_PRSCAW_P(:,:,:, JBLK), IDEP(:,:, JBLK), Z_YDA_KNOWENO_P&
      &(:,:, JBLK), Z_YDVARS_GEOMETRY_RCOLON_P(:, JBLK), Z_YDVARS_GEOMETRY_RSILON_P(:, JBLK), Z_YDVARS_GEOMETRY_GECLO_P&
      &(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_P(:, JBLK), Z_YDVARS_GEOMETRY_GESLO_P(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P&
      &(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEA_PARALLEL:LARCINA')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
    ILEV => GET_HOST_DATA_RDWR (YL_ILEV)
    ZLEV => GET_HOST_DATA_RDWR (YL_ZLEV)
    Z_YDA_KL0_P => GET_HOST_DATA_RDWR (YDA_KL0%F_P)
    Z_YDA_KLH0_P => GET_HOST_DATA_RDWR (YDA_KLH0%F_P)
    Z_YDA_KNOWENO_P => GET_HOST_DATA_RDWR (YDA_KNOWENO%F_P)
    Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
    Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDA_PLSCAW_P => GET_HOST_DATA_RDWR (YDA_PLSCAW%F_P)
    Z_YDA_PRSCAW_P => GET_HOST_DATA_RDWR (YDA_PRSCAW%F_P)
    Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
    Z_YDCPG_SL2_KAPPA => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPA)
    Z_YDCPG_SL2_KAPPAH => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAH)
    Z_YDCPG_SL2_KAPPAM => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAM)
    Z_YDCPG_SL2_KAPPAT => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAT)
    Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISU)
    Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISV)
    Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISW)
    Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
    Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
    Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
    Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
    Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCOLON%FT0)
    Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RSILON%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => NULL ()
  ILEV => NULL ()
  ZLEV => NULL ()
  Z_YDA_KL0_P => NULL ()
  Z_YDA_KLH0_P => NULL ()
  Z_YDA_KNOWENO_P => NULL ()
  Z_YDA_KVSEPC_P => NULL ()
  Z_YDA_KVSEPL_P => NULL ()
  Z_YDA_PCCO_P => NULL ()
  Z_YDA_PLSCAW_P => NULL ()
  Z_YDA_PRSCAW_P => NULL ()
  Z_YDA_PSCO_P => NULL ()
  Z_YDCPG_SL2_KAPPA => NULL ()
  Z_YDCPG_SL2_KAPPAH => NULL ()
  Z_YDCPG_SL2_KAPPAM => NULL ()
  Z_YDCPG_SL2_KAPPAT => NULL ()
  Z_YDCPG_SL2_STDDISU => NULL ()
  Z_YDCPG_SL2_STDDISV => NULL ()
  Z_YDCPG_SL2_STDDISW => NULL ()
  Z_YDMASK_SL2_P => NULL ()
  Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
  Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
  Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
  Z_YDVARS_GEOMETRY_RCOLON_P => NULL ()
  Z_YDVARS_GEOMETRY_RSILON_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','LAPINEA_PARALLEL:LARCINA')) THEN
  
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => GET_DEVICE_DATA_RDWR (YL_IDEP)
  ILEV => GET_DEVICE_DATA_RDWR (YL_ILEV)
  ZLEV => GET_DEVICE_DATA_RDONLY (YL_ZLEV)
  Z_YDA_KL0_P => GET_DEVICE_DATA_RDWR (YDA_KL0%F_P)
  Z_YDA_KLH0_P => GET_DEVICE_DATA_RDWR (YDA_KLH0%F_P)
  Z_YDA_KNOWENO_P => GET_DEVICE_DATA_RDWR (YDA_KNOWENO%F_P)
  Z_YDA_KVSEPC_P => GET_DEVICE_DATA_RDWR (YDA_KVSEPC%F_P)
  Z_YDA_KVSEPL_P => GET_DEVICE_DATA_RDWR (YDA_KVSEPL%F_P)
  Z_YDA_PCCO_P => GET_DEVICE_DATA_RDWR (YDA_PCCO%F_P)
  Z_YDA_PLSCAW_P => GET_DEVICE_DATA_RDWR (YDA_PLSCAW%F_P)
  Z_YDA_PRSCAW_P => GET_DEVICE_DATA_RDWR (YDA_PRSCAW%F_P)
  Z_YDA_PSCO_P => GET_DEVICE_DATA_RDONLY (YDA_PSCO%F_P)
  Z_YDCPG_SL2_KAPPA => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_KAPPA)
  Z_YDCPG_SL2_KAPPAH => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_KAPPAH)
  Z_YDCPG_SL2_KAPPAM => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_KAPPAM)
  Z_YDCPG_SL2_KAPPAT => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_KAPPAT)
  Z_YDCPG_SL2_STDDISU => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_STDDISU)
  Z_YDCPG_SL2_STDDISV => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_STDDISV)
  Z_YDCPG_SL2_STDDISW => GET_DEVICE_DATA_RDONLY (YDCPG_SL2%F_STDDISW)
  Z_YDMASK_SL2_P => GET_DEVICE_DATA_RDWR (YDMASK_SL2%F_P)
  Z_YDVARS_GEOMETRY_GECLO_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GECLO%FT0)
  Z_YDVARS_GEOMETRY_GEMU_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GEMU%FT0)
  Z_YDVARS_GEOMETRY_GESLO_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GESLO%FT0)
  Z_YDVARS_GEOMETRY_GSQM2_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%GSQM2%FT0)
  Z_YDVARS_GEOMETRY_RCOLON_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RCOLON%FT0)
  Z_YDVARS_GEOMETRY_RSILON_P => GET_DEVICE_DATA_RDONLY (YDVARS%GEOMETRY%RSILON%FT0)
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
  
  
    !$ACC PARALLEL LOOP GANG &
    !$ACC&PRESENT (IDEP, ILEV, YDCPG_OPTS, YDGEOMETRY, YDMODEL, YDSL, YFXTRAN_ACDC_STACK, &
    !$ACC&         ZLEV, Z_YDA_KL0_P, Z_YDA_KLH0_P, Z_YDA_KNOWENO_P, Z_YDA_KVSEPC_P, &
    !$ACC&         Z_YDA_KVSEPL_P, Z_YDA_PCCO_P, Z_YDA_PLSCAW_P, Z_YDA_PRSCAW_P, &
    !$ACC&         Z_YDA_PSCO_P, Z_YDCPG_SL2_KAPPA, Z_YDCPG_SL2_KAPPAH, Z_YDCPG_SL2_KAPPAM, &
    !$ACC&         Z_YDCPG_SL2_KAPPAT, Z_YDCPG_SL2_STDDISU, Z_YDCPG_SL2_STDDISV, &
    !$ACC&         Z_YDCPG_SL2_STDDISW, Z_YDMASK_SL2_P, Z_YDVARS_GEOMETRY_GECLO_P, &
    !$ACC&         Z_YDVARS_GEOMETRY_GEMU_P, Z_YDVARS_GEOMETRY_GESLO_P, Z_YDVARS_GEOMETRY_GSQM2_P, &
    !$ACC&         Z_YDVARS_GEOMETRY_RCOLON_P, Z_YDVARS_GEOMETRY_RSILON_P) &
    !$ACC&PRIVATE (JBLK) &
    !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
    
    DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
    
    
    
    !$ACC LOOP VECTOR &
    !$ACC&PRIVATE (JROF, YLCPG_BNDS, YLSTACK) 

    

    DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
      YLCPG_BNDS%KIDIA = JROF
      YLCPG_BNDS%KFDIA = JROF
      YLSTACK%L8 = fxtran_acdc_stack_l8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U8 = fxtran_acdc_stack_u8 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%L4 = fxtran_acdc_stack_l4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      YLSTACK%U4 = fxtran_acdc_stack_u4 (YFXTRAN_ACDC_STACK, (JBLK-YDCPG_OPTS%JBLKMIN)+1, YDCPG_OPTS%KGPBLKS)
      
      CALL LARCINA_OPENACC (YDGEOMETRY, YDMODEL%YRCST, YDMODEL%YRML_DYN, YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA&
      &, YDSL, IHVI, YDMODEL%YRML_DYN%YRDYN%LFINDVSEP, YDMODEL%YRML_DYN%YRDYNA%LSLHD, YDMODEL%YRML_DYN%YRDYNA&
      &%LSLHDQUAD, LLINTV, ITIP, IROT, YDCPG_OPTS%LRPLANE, Z_YDA_PSCO_P(:,:,:, JBLK), ZLEV(:,:, JBLK), Z_YDCPG_SL2_KAPPA&
      &(:,:, JBLK), Z_YDCPG_SL2_KAPPAT(:,:, JBLK), Z_YDCPG_SL2_KAPPAM(:,:, JBLK), Z_YDCPG_SL2_KAPPAH(:,:, JBLK&
      &), Z_YDCPG_SL2_STDDISU(:,:, JBLK), Z_YDCPG_SL2_STDDISV(:,:, JBLK), Z_YDCPG_SL2_STDDISW(:,:, JBLK), ZURL0&
      &, ZVRL0, ZZRL0, ZWRL0, Z_YDMASK_SL2_P(:), Z_YDA_KVSEPC_P(:, JBLK), Z_YDA_KVSEPL_P(:, JBLK), Z_YDA_PCCO_P&
      &(:,:,:, JBLK), ZUF0, ZVF0, ZZF0, ZWF0, ZWFSM, Z_YDA_KL0_P(:,:,:, JBLK), Z_YDA_KLH0_P(:,:,:, JBLK), ILEV&
      &(:,:, JBLK), Z_YDA_PLSCAW_P(:,:,:, JBLK), Z_YDA_PRSCAW_P(:,:,:, JBLK), IDEP(:,:, JBLK), Z_YDA_KNOWENO_P&
      &(:,:, JBLK), Z_YDVARS_GEOMETRY_RCOLON_P(:, JBLK), Z_YDVARS_GEOMETRY_RSILON_P(:, JBLK), Z_YDVARS_GEOMETRY_GECLO_P&
      &(:, JBLK), Z_YDVARS_GEOMETRY_GEMU_P(:, JBLK), Z_YDVARS_GEOMETRY_GESLO_P(:, JBLK), Z_YDVARS_GEOMETRY_GSQM2_P&
      &(:, JBLK),YDSTACK=YLSTACK)
    ENDDO

  ENDDO

  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

  IF (FXTRAN_ACDC_LSYNCHOST ('LAPINEA_PARALLEL:LARCINA')) THEN
    IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
    IDEP => GET_HOST_DATA_RDWR (YL_IDEP)
    ILEV => GET_HOST_DATA_RDWR (YL_ILEV)
    ZLEV => GET_HOST_DATA_RDWR (YL_ZLEV)
    Z_YDA_KL0_P => GET_HOST_DATA_RDWR (YDA_KL0%F_P)
    Z_YDA_KLH0_P => GET_HOST_DATA_RDWR (YDA_KLH0%F_P)
    Z_YDA_KNOWENO_P => GET_HOST_DATA_RDWR (YDA_KNOWENO%F_P)
    Z_YDA_KVSEPC_P => GET_HOST_DATA_RDWR (YDA_KVSEPC%F_P)
    Z_YDA_KVSEPL_P => GET_HOST_DATA_RDWR (YDA_KVSEPL%F_P)
    Z_YDA_PCCO_P => GET_HOST_DATA_RDWR (YDA_PCCO%F_P)
    Z_YDA_PLSCAW_P => GET_HOST_DATA_RDWR (YDA_PLSCAW%F_P)
    Z_YDA_PRSCAW_P => GET_HOST_DATA_RDWR (YDA_PRSCAW%F_P)
    Z_YDA_PSCO_P => GET_HOST_DATA_RDWR (YDA_PSCO%F_P)
    Z_YDCPG_SL2_KAPPA => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPA)
    Z_YDCPG_SL2_KAPPAH => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAH)
    Z_YDCPG_SL2_KAPPAM => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAM)
    Z_YDCPG_SL2_KAPPAT => GET_HOST_DATA_RDWR (YDCPG_SL2%F_KAPPAT)
    Z_YDCPG_SL2_STDDISU => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISU)
    Z_YDCPG_SL2_STDDISV => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISV)
    Z_YDCPG_SL2_STDDISW => GET_HOST_DATA_RDWR (YDCPG_SL2%F_STDDISW)
    Z_YDMASK_SL2_P => GET_HOST_DATA_RDWR (YDMASK_SL2%F_P)
    Z_YDVARS_GEOMETRY_GECLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GECLO%FT0)
    Z_YDVARS_GEOMETRY_GEMU_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GEMU%FT0)
    Z_YDVARS_GEOMETRY_GESLO_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GESLO%FT0)
    Z_YDVARS_GEOMETRY_GSQM2_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%GSQM2%FT0)
    Z_YDVARS_GEOMETRY_RCOLON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RCOLON%FT0)
    Z_YDVARS_GEOMETRY_RSILON_P => GET_HOST_DATA_RDWR (YDVARS%GEOMETRY%RSILON%FT0)
    IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
    
    
  ENDIF

  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
  IDEP => NULL ()
  ILEV => NULL ()
  ZLEV => NULL ()
  Z_YDA_KL0_P => NULL ()
  Z_YDA_KLH0_P => NULL ()
  Z_YDA_KNOWENO_P => NULL ()
  Z_YDA_KVSEPC_P => NULL ()
  Z_YDA_KVSEPL_P => NULL ()
  Z_YDA_PCCO_P => NULL ()
  Z_YDA_PLSCAW_P => NULL ()
  Z_YDA_PRSCAW_P => NULL ()
  Z_YDA_PSCO_P => NULL ()
  Z_YDCPG_SL2_KAPPA => NULL ()
  Z_YDCPG_SL2_KAPPAH => NULL ()
  Z_YDCPG_SL2_KAPPAM => NULL ()
  Z_YDCPG_SL2_KAPPAT => NULL ()
  Z_YDCPG_SL2_STDDISU => NULL ()
  Z_YDCPG_SL2_STDDISV => NULL ()
  Z_YDCPG_SL2_STDDISW => NULL ()
  Z_YDMASK_SL2_P => NULL ()
  Z_YDVARS_GEOMETRY_GECLO_P => NULL ()
  Z_YDVARS_GEOMETRY_GEMU_P => NULL ()
  Z_YDVARS_GEOMETRY_GESLO_P => NULL ()
  Z_YDVARS_GEOMETRY_GSQM2_P => NULL ()
  Z_YDVARS_GEOMETRY_RCOLON_P => NULL ()
  Z_YDVARS_GEOMETRY_RSILON_P => NULL ()
  IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
  
  
ELSE
    CALL ABOR1 ('LAPINEA_PARALLEL: NOT METHOD WAS FOUND')
ENDIF

IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL:LARCINA',1,ZHOOK_HANDLE_PARALLEL)

IF (YDCPG_OPTS%LRPLANE) THEN
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF


IF (YDMODEL%YRML_DYN%YRDYNA%LNHDYN.AND.YDMODEL%YRML_DYN%YRDYNA%LGWADV&
  &.AND.(.NOT.YDGEOMETRY%YRVERT_GEOM%YRCVER%LVFE_GW)) THEN
  
  
  
  
  CALL ABOR1 ("ERROR: WRONG SETTINGS")
  
ENDIF




CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (ASSOCIATED (YL_IDEP)) CALL FIELD_DELETE (YL_IDEP)
IF (ASSOCIATED (YL_ILEV)) CALL FIELD_DELETE (YL_ILEV)
IF (ASSOCIATED (YL_ZGMDTX)) CALL FIELD_DELETE (YL_ZGMDTX)
IF (ASSOCIATED (YL_ZGMDTY)) CALL FIELD_DELETE (YL_ZGMDTY)
IF (ASSOCIATED (YL_ZLEV)) CALL FIELD_DELETE (YL_ZLEV)
IF (ASSOCIATED (YL_ZWF)) CALL FIELD_DELETE (YL_ZWF)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('LAPINEA_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE LAPINEA_PARALLEL
