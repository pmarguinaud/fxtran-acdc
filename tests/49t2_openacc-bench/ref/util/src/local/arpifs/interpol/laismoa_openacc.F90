SUBROUTINE LAISMOA_OPENACC (KSLB1, KPROMA, KST, KEND, KFLEV&
&, KFLDN, KFLDX, PDLO, KL0, PDVER, PXSL, PXF, YDSTACK)
!$ACC ROUTINE (LAISMOA_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB

#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


INTEGER (KIND=JPIM), INTENT (IN)::KSLB1
INTEGER (KIND=JPIM), INTENT (IN)::KPROMA
INTEGER (KIND=JPIM), INTENT (IN)::KFLEV
INTEGER (KIND=JPIM), INTENT (IN)::KFLDN
INTEGER (KIND=JPIM), INTENT (IN)::KFLDX
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PDLO (KPROMA, KFLEV, 0:3)
INTEGER (KIND=JPIM), INTENT (IN)::KL0 (KPROMA, KFLEV, 0:3)
REAL (KIND=JPRB), INTENT (IN)::PDVER (KPROMA, KFLEV)
REAL (KIND=JPRB), INTENT (IN)::PXSL (KSLB1*(KFLDX-KFLDN+1))
REAL (KIND=JPRB), INTENT (OUT)::PXF (KPROMA, KFLEV)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK
INTEGER (KIND=JPIM)::IL
INTEGER (KIND=JPIM)::IOFF
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JLEV
REAL (KIND=JPRB)::ZD
REAL (KIND=JPRB)::ZSILO2
REAL (KIND=JPRB)::ZSILO1
REAL (KIND=JPRB)::ZSILO


JROF = KST



DO JLEV=1, KFLEV

  

  IF (PDVER (JROF, JLEV)<0.5_JPRB) THEN
    IOFF=KPROMA
  ELSE
    IOFF=KPROMA+KPROMA
  ENDIF

  IL=KL0 (JROF, JLEV, 0)+IOFF
  ZD=PDLO (JROF, JLEV, 0)
  ZSILO=PXSL (IL)*(4-3*ZD)+PXSL (IL+1)*(3-ZD)+PXSL (IL+2)*(2+ZD)+PXSL (IL+3)*(1+3*ZD)
  IL=KL0 (JROF, JLEV, 2)+IOFF
  ZD=PDLO (JROF, JLEV, 2)
  ZSILO2=PXSL (IL)*(4-3*ZD)+PXSL (IL+1)*(3-ZD)+PXSL (IL+2)*(2+ZD)+PXSL (IL+3)*(1+3*ZD)
  IL=KL0 (JROF, JLEV, 1)+IOFF
  ZSILO1=(PXSL (IL)+PXSL (IL+1)+PXSL (IL+2))/3
  PXF (JROF, JLEV)=(ZSILO+ZSILO1+ZSILO2)/30._JPRB
  
ENDDO


END SUBROUTINE LAISMOA_OPENACC
