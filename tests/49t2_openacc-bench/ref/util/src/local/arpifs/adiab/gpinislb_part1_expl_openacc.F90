SUBROUTINE GPINISLB_PART1_EXPL_OPENACC (YDGEOMETRY, YGFL, YDDYN, YDDYNA, KST, KEND, PTE, PUT9, PVT9&
&, PTT9, PSPDT9, PSVDT9, PNHX9, PSPT9, PB2U1, PB2V1, PB2T1, PB2PD1, PB2VD1, PGMVNHX1, PB2SP1, PQICE&
&, PQLI, PQRAIN, PQSNOW, PQGRAUPEL, PL0, PL9, PI0, PI9, PR0, PR9, PS0, PS9, PG0, PG9, YDSTACK)
!$ACC ROUTINE (GPINISLB_PART1_EXPL_OPENACC) SEQ
USE PARKIND1,ONLY:JPIM, JPRB

USE GEOMETRY_MOD,ONLY:GEOMETRY
USE YOM_YGFL,ONLY:TYPE_GFLD
USE YOMDYN,ONLY:TDYN
USE YOMDYNA,ONLY:TDYNA
#include "fxtran_acdc_stack.h"
USE FXTRAN_ACDC_STACK_MOD
USE FXTRAN_ACDC_ABORT_MOD

IMPLICIT NONE


TYPE (GEOMETRY), INTENT (IN)::YDGEOMETRY
TYPE (TYPE_GFLD), INTENT (IN)::YGFL
TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TDYNA), INTENT (IN)::YDDYNA
INTEGER (KIND=JPIM), INTENT (IN)::KST
INTEGER (KIND=JPIM), INTENT (IN)::KEND
REAL (KIND=JPRB), INTENT (IN)::PTE
REAL (KIND=JPRB), INTENT (IN)::PUT9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PVT9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PTT9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSPDT9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSVDT9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PNHX9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN)::PSPT9 (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PB2U1 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PB2V1 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PB2T1 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PB2PD1 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PB2VD1 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PGMVNHX1 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PB2SP1 (YDGEOMETRY%YRDIM%NPROMA)
REAL (KIND=JPRB), INTENT (OUT)::PQICE (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PQLI (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PQRAIN (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PQSNOW (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (OUT)::PQGRAUPEL (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PL0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PL9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PI0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PI9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PR0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PR9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PS0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PS9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PG0 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
REAL (KIND=JPRB), INTENT (IN), OPTIONAL::PG9 (YDGEOMETRY%YRDIM%NPROMA, YDGEOMETRY%YRDIMV%NFLEVG)
TYPE(FXTRAN_ACDC_STACK), INTENT (IN) :: YDSTACK

INTEGER (KIND=JPIM) :: JROF

JROF = KST



IF (YDDYNA%LSLAG) THEN
  PB2U1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
  PB2V1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
  PB2T1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB

  IF (YDDYNA%LNHDYN) THEN
    PB2PD1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
    PB2VD1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB

    IF (YDDYNA%LNHX)  THEN
      PGMVNHX1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
    ENDIF

  ENDIF

ELSE

  IF (YDDYN%NCURRENT_ITER==0) THEN
    PB2U1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PUT9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)*PTE
    PB2V1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PVT9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)*PTE
    PB2T1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PTT9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)*PTE

    IF (YDDYNA%LNHDYN) THEN
      PB2PD1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PSPDT9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)*PTE
      PB2VD1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PSVDT9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)*PTE

      IF (YDDYNA%LNHX)  THEN
        PGMVNHX1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PNHX9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)*PTE
      ENDIF

    ENDIF

  ELSE
    PB2U1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
    PB2V1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
    PB2T1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB

    IF (YDDYNA%LNHDYN) THEN
      PB2PD1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
      PB2VD1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB

      IF (YDDYNA%LNHX)  THEN
        PGMVNHX1 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
      ENDIF

    ENDIF

  ENDIF

ENDIF


IF (YGFL%YL%LACTIVE) THEN

  IF (YDDYNA%LSLAG.AND.YDDYNA%LTWOTL) THEN
    PQLI (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PL0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ELSE
    PQLI (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PL9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ENDIF

ELSE
  PQLI (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
ENDIF


IF (YGFL%YI%LACTIVE) THEN

  IF (YDDYNA%LSLAG.AND.YDDYNA%LTWOTL) THEN
    PQICE (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PI0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ELSE
    PQICE (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PI9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ENDIF

ELSE
  PQICE (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
ENDIF


IF (YGFL%YR%LACTIVE) THEN

  IF (YDDYNA%LSLAG.AND.YDDYNA%LTWOTL) THEN
    PQRAIN (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PR0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ELSE
    PQRAIN (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PR9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ENDIF

ELSE
  PQRAIN (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
ENDIF


IF (YGFL%YS%LACTIVE) THEN

  IF (YDDYNA%LSLAG.AND.YDDYNA%LTWOTL) THEN
    PQSNOW (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PS0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ELSE
    PQSNOW (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PS9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ENDIF

ELSE
  PQSNOW (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
ENDIF


IF (YGFL%YG%LACTIVE) THEN

  IF (YDDYNA%LSLAG.AND.YDDYNA%LTWOTL) THEN
    PQGRAUPEL (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PG0 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ELSE
    PQGRAUPEL (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=PG9 (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)
  ENDIF

ELSE
  PQGRAUPEL (JROF, 1:YDGEOMETRY%YRDIMV%NFLEVG)=0.0_JPRB
ENDIF


IF (YDDYNA%LSLAG) THEN
  PB2SP1 (JROF)=0.0_JPRB
ELSE

  IF (YDDYN%NCURRENT_ITER==0) THEN
    PB2SP1 (JROF)=PSPT9 (JROF)*PTE
  ELSE
    PB2SP1 (JROF)=0.0_JPRB
  ENDIF

ENDIF



END SUBROUTINE GPINISLB_PART1_EXPL_OPENACC
