MODULE UTIL_TENEUR_MOD

USE YOENEUR, ONLY : TENEUR

INTERFACE ACDC_SAVE
MODULE PROCEDURE ACDC_SAVE_TENEUR
END INTERFACE

INTERFACE ACDC_LOAD
MODULE PROCEDURE ACDC_LOAD_TENEUR
END INTERFACE

INTERFACE ACDC_COPY
MODULE PROCEDURE ACDC_COPY_TENEUR
END INTERFACE

INTERFACE ACDC_HOST
MODULE PROCEDURE ACDC_HOST_TENEUR
END INTERFACE


INTERFACE ACDC_CRC64
MODULE PROCEDURE ACDC_CRC64_TENEUR
END INTERFACE

INTERFACE ACDC_WIPE
MODULE PROCEDURE ACDC_WIPE_TENEUR
END INTERFACE

INTERFACE ACDC_SIZE
MODULE PROCEDURE ACDC_SIZE_TENEUR
END INTERFACE

CONTAINS

SUBROUTINE ACDC_SAVE_TENEUR (SELF, KLUN)

IMPLICIT NONE
TYPE (TENEUR), INTENT (IN), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
WRITE (KLUN) SELF%NCOU
WRITE (KLUN) SELF%NBR
WRITE (KLUN) SELF%NBNEURMAX
WRITE (KLUN) SELF%KLEV_NN
LNBNEUR = ALLOCATED (SELF%NBNEUR)
WRITE (KLUN) LNBNEUR
IF (LNBNEUR) THEN
  WRITE (KLUN) LBOUND (SELF%NBNEUR)
  WRITE (KLUN) UBOUND (SELF%NBNEUR)
  WRITE (KLUN) SELF%NBNEUR
ENDIF
LWNELN = ALLOCATED (SELF%WNELN)
WRITE (KLUN) LWNELN
IF (LWNELN) THEN
  WRITE (KLUN) LBOUND (SELF%WNELN)
  WRITE (KLUN) UBOUND (SELF%WNELN)
  WRITE (KLUN) SELF%WNELN
ENDIF
LENTREEMOY = ALLOCATED (SELF%ENTREEMOY)
WRITE (KLUN) LENTREEMOY
IF (LENTREEMOY) THEN
  WRITE (KLUN) LBOUND (SELF%ENTREEMOY)
  WRITE (KLUN) UBOUND (SELF%ENTREEMOY)
  WRITE (KLUN) SELF%ENTREEMOY
ENDIF
LRAPIN = ALLOCATED (SELF%RAPIN)
WRITE (KLUN) LRAPIN
IF (LRAPIN) THEN
  WRITE (KLUN) LBOUND (SELF%RAPIN)
  WRITE (KLUN) UBOUND (SELF%RAPIN)
  WRITE (KLUN) SELF%RAPIN
ENDIF
LSORTIEMOY = ALLOCATED (SELF%SORTIEMOY)
WRITE (KLUN) LSORTIEMOY
IF (LSORTIEMOY) THEN
  WRITE (KLUN) LBOUND (SELF%SORTIEMOY)
  WRITE (KLUN) UBOUND (SELF%SORTIEMOY)
  WRITE (KLUN) SELF%SORTIEMOY
ENDIF
LRAPOUT = ALLOCATED (SELF%RAPOUT)
WRITE (KLUN) LRAPOUT
IF (LRAPOUT) THEN
  WRITE (KLUN) LBOUND (SELF%RAPOUT)
  WRITE (KLUN) UBOUND (SELF%RAPOUT)
  WRITE (KLUN) SELF%RAPOUT
ENDIF
LPDFSDX = ALLOCATED (SELF%PDFSDX)
WRITE (KLUN) LPDFSDX
IF (LPDFSDX) THEN
  WRITE (KLUN) LBOUND (SELF%PDFSDX)
  WRITE (KLUN) UBOUND (SELF%PDFSDX)
  WRITE (KLUN) SELF%PDFSDX
ENDIF
LAAM_NN = ALLOCATED (SELF%AAM_NN)
WRITE (KLUN) LAAM_NN
IF (LAAM_NN) THEN
  WRITE (KLUN) LBOUND (SELF%AAM_NN)
  WRITE (KLUN) UBOUND (SELF%AAM_NN)
  WRITE (KLUN) SELF%AAM_NN
ENDIF
LBBM_NN = ALLOCATED (SELF%BBM_NN)
WRITE (KLUN) LBBM_NN
IF (LBBM_NN) THEN
  WRITE (KLUN) LBOUND (SELF%BBM_NN)
  WRITE (KLUN) UBOUND (SELF%BBM_NN)
  WRITE (KLUN) SELF%BBM_NN
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_LOAD_TENEUR (SELF, KLUN)
USE PARKIND1, ONLY : JPRD
IMPLICIT NONE
TYPE (TENEUR), INTENT (OUT), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
INTEGER :: IL1(1), IU1(1), IL2(2), IU2(2), IL4(4), IU4(4)
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP2 (:,:)
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP4 (:,:,:,:)
READ (KLUN) SELF%NCOU
READ (KLUN) SELF%NBR
READ (KLUN) SELF%NBNEURMAX
READ (KLUN) SELF%KLEV_NN
READ (KLUN) LNBNEUR
IF (LNBNEUR) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%NBNEUR (IL2(1):IU2(1), IL2(2):IU2(2)))
  READ (KLUN) SELF%NBNEUR
ENDIF
READ (KLUN) LWNELN
IF (LWNELN) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%WNELN (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%WNELN,1):UBOUND(SELF%WNELN,1), LBOUND(SELF%WNELN,2):UBOUND(SELF%WNELN,2), LBOUND(SELF%WNELN,3):UBOUND(SELF%WNELN,3), LBOUND(SELF%WNELN,4):UBOUND(SELF%WNELN,4)))
  READ (KLUN) ZTMP4
  SELF%WNELN = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LENTREEMOY
IF (LENTREEMOY) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%ENTREEMOY (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%ENTREEMOY,1):UBOUND(SELF%ENTREEMOY,1), LBOUND(SELF%ENTREEMOY,2):UBOUND(SELF%ENTREEMOY,2)))
  READ (KLUN) ZTMP2
  SELF%ENTREEMOY = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRAPIN
IF (LRAPIN) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RAPIN (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RAPIN,1):UBOUND(SELF%RAPIN,1), LBOUND(SELF%RAPIN,2):UBOUND(SELF%RAPIN,2)))
  READ (KLUN) ZTMP2
  SELF%RAPIN = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LSORTIEMOY
IF (LSORTIEMOY) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%SORTIEMOY (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%SORTIEMOY,1):UBOUND(SELF%SORTIEMOY,1), LBOUND(SELF%SORTIEMOY,2):UBOUND(SELF%SORTIEMOY,2)))
  READ (KLUN) ZTMP2
  SELF%SORTIEMOY = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LRAPOUT
IF (LRAPOUT) THEN
  READ (KLUN) IL2
  READ (KLUN) IU2
  ALLOCATE (SELF%RAPOUT (IL2(1):IU2(1), IL2(2):IU2(2)))
  ALLOCATE (ZTMP2(LBOUND(SELF%RAPOUT,1):UBOUND(SELF%RAPOUT,1), LBOUND(SELF%RAPOUT,2):UBOUND(SELF%RAPOUT,2)))
  READ (KLUN) ZTMP2
  SELF%RAPOUT = ZTMP2
  DEALLOCATE (ZTMP2)
ENDIF
READ (KLUN) LPDFSDX
IF (LPDFSDX) THEN
  READ (KLUN) IL4
  READ (KLUN) IU4
  ALLOCATE (SELF%PDFSDX (IL4(1):IU4(1), IL4(2):IU4(2), IL4(3):IU4(3), IL4(4):IU4(4)))
  ALLOCATE (ZTMP4(LBOUND(SELF%PDFSDX,1):UBOUND(SELF%PDFSDX,1), LBOUND(SELF%PDFSDX,2):UBOUND(SELF%PDFSDX,2), LBOUND(SELF%PDFSDX,3):UBOUND(SELF%PDFSDX,3), LBOUND(SELF%PDFSDX,4):UBOUND(SELF%PDFSDX,4)))
  READ (KLUN) ZTMP4
  SELF%PDFSDX = ZTMP4
  DEALLOCATE (ZTMP4)
ENDIF
READ (KLUN) LAAM_NN
IF (LAAM_NN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%AAM_NN (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%AAM_NN,1):UBOUND(SELF%AAM_NN,1)))
  READ (KLUN) ZTMP1
  SELF%AAM_NN = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) LBBM_NN
IF (LBBM_NN) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (SELF%BBM_NN (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(SELF%BBM_NN,1):UBOUND(SELF%BBM_NN,1)))
  READ (KLUN) ZTMP1
  SELF%BBM_NN = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
END SUBROUTINE

SUBROUTINE ACDC_COPY_TENEUR (SELF, LDCREATED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TENEUR), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED, LDFIELDAPI
LOGICAL :: LLCREATED
LOGICAL :: LLFIELDAPI
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF
LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$ACC ENTER DATA CREATE (SELF)
  !$ACC UPDATE DEVICE (SELF)
ENDIF

LNBNEUR = ALLOCATED (SELF%NBNEUR)
IF (LNBNEUR) THEN
  !$ACC ENTER DATA CREATE (SELF%NBNEUR)
  !$ACC UPDATE DEVICE (SELF%NBNEUR)
  !$ACC ENTER DATA ATTACH (SELF%NBNEUR)
ENDIF

LWNELN = ALLOCATED (SELF%WNELN)
IF (LWNELN) THEN
  !$ACC ENTER DATA CREATE (SELF%WNELN)
  !$ACC UPDATE DEVICE (SELF%WNELN)
  !$ACC ENTER DATA ATTACH (SELF%WNELN)
ENDIF

LENTREEMOY = ALLOCATED (SELF%ENTREEMOY)
IF (LENTREEMOY) THEN
  !$ACC ENTER DATA CREATE (SELF%ENTREEMOY)
  !$ACC UPDATE DEVICE (SELF%ENTREEMOY)
  !$ACC ENTER DATA ATTACH (SELF%ENTREEMOY)
ENDIF

LRAPIN = ALLOCATED (SELF%RAPIN)
IF (LRAPIN) THEN
  !$ACC ENTER DATA CREATE (SELF%RAPIN)
  !$ACC UPDATE DEVICE (SELF%RAPIN)
  !$ACC ENTER DATA ATTACH (SELF%RAPIN)
ENDIF

LSORTIEMOY = ALLOCATED (SELF%SORTIEMOY)
IF (LSORTIEMOY) THEN
  !$ACC ENTER DATA CREATE (SELF%SORTIEMOY)
  !$ACC UPDATE DEVICE (SELF%SORTIEMOY)
  !$ACC ENTER DATA ATTACH (SELF%SORTIEMOY)
ENDIF

LRAPOUT = ALLOCATED (SELF%RAPOUT)
IF (LRAPOUT) THEN
  !$ACC ENTER DATA CREATE (SELF%RAPOUT)
  !$ACC UPDATE DEVICE (SELF%RAPOUT)
  !$ACC ENTER DATA ATTACH (SELF%RAPOUT)
ENDIF

LPDFSDX = ALLOCATED (SELF%PDFSDX)
IF (LPDFSDX) THEN
  !$ACC ENTER DATA CREATE (SELF%PDFSDX)
  !$ACC UPDATE DEVICE (SELF%PDFSDX)
  !$ACC ENTER DATA ATTACH (SELF%PDFSDX)
ENDIF

LAAM_NN = ALLOCATED (SELF%AAM_NN)
IF (LAAM_NN) THEN
  !$ACC ENTER DATA CREATE (SELF%AAM_NN)
  !$ACC UPDATE DEVICE (SELF%AAM_NN)
  !$ACC ENTER DATA ATTACH (SELF%AAM_NN)
ENDIF

LBBM_NN = ALLOCATED (SELF%BBM_NN)
IF (LBBM_NN) THEN
  !$ACC ENTER DATA CREATE (SELF%BBM_NN)
  !$ACC UPDATE DEVICE (SELF%BBM_NN)
  !$ACC ENTER DATA ATTACH (SELF%BBM_NN)
ENDIF

END SUBROUTINE

SUBROUTINE ACDC_HOST_TENEUR (SELF)

IMPLICIT NONE
TYPE (TENEUR), TARGET :: SELF
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN

END SUBROUTINE



SUBROUTINE ACDC_CRC64_TENEUR (SELF, KLUN, CDPATH)
USE FXTRAN_ACDC_CRC64_INTRINSIC_MOD, ONLY : FCRC64 => FXTRAN_ACDC_CRC64
IMPLICIT NONE
TYPE (TENEUR), TARGET :: SELF
INTEGER, INTENT (IN) :: KLUN
CHARACTER(LEN=*), INTENT (IN) :: CDPATH
CHARACTER(LEN=128) :: CLIND
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NCOU), CDPATH//'%NCOU'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBR), CDPATH//'%NBR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBNEURMAX), CDPATH//'%NBNEURMAX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%KLEV_NN), CDPATH//'%KLEV_NN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%NBNEUR), CDPATH//'%NBNEUR'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%WNELN), CDPATH//'%WNELN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%ENTREEMOY), CDPATH//'%ENTREEMOY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAPIN), CDPATH//'%RAPIN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%SORTIEMOY), CDPATH//'%SORTIEMOY'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%RAPOUT), CDPATH//'%RAPOUT'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%PDFSDX), CDPATH//'%PDFSDX'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%AAM_NN), CDPATH//'%AAM_NN'

WRITE (KLUN, '(Z16.16," ",A)') FCRC64 (SELF%BBM_NN), CDPATH//'%BBM_NN'

END SUBROUTINE

SUBROUTINE ACDC_WIPE_TENEUR (SELF, LDDELETED, LDFIELDAPI)

IMPLICIT NONE
TYPE (TENEUR), INTENT (IN), TARGET :: SELF
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED, LDFIELDAPI
LOGICAL :: LLDELETED
LOGICAL :: LLFIELDAPI
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
LLFIELDAPI = .FALSE.
IF (PRESENT (LDFIELDAPI)) THEN
  LLFIELDAPI = LDFIELDAPI
ENDIF

LNBNEUR = ALLOCATED (SELF%NBNEUR)
IF (LNBNEUR) THEN
  !$ACC EXIT DATA DETACH (SELF%NBNEUR)
  !$ACC EXIT DATA DELETE (SELF%NBNEUR)
ENDIF

LWNELN = ALLOCATED (SELF%WNELN)
IF (LWNELN) THEN
  !$ACC EXIT DATA DETACH (SELF%WNELN)
  !$ACC EXIT DATA DELETE (SELF%WNELN)
ENDIF

LENTREEMOY = ALLOCATED (SELF%ENTREEMOY)
IF (LENTREEMOY) THEN
  !$ACC EXIT DATA DETACH (SELF%ENTREEMOY)
  !$ACC EXIT DATA DELETE (SELF%ENTREEMOY)
ENDIF

LRAPIN = ALLOCATED (SELF%RAPIN)
IF (LRAPIN) THEN
  !$ACC EXIT DATA DETACH (SELF%RAPIN)
  !$ACC EXIT DATA DELETE (SELF%RAPIN)
ENDIF

LSORTIEMOY = ALLOCATED (SELF%SORTIEMOY)
IF (LSORTIEMOY) THEN
  !$ACC EXIT DATA DETACH (SELF%SORTIEMOY)
  !$ACC EXIT DATA DELETE (SELF%SORTIEMOY)
ENDIF

LRAPOUT = ALLOCATED (SELF%RAPOUT)
IF (LRAPOUT) THEN
  !$ACC EXIT DATA DETACH (SELF%RAPOUT)
  !$ACC EXIT DATA DELETE (SELF%RAPOUT)
ENDIF

LPDFSDX = ALLOCATED (SELF%PDFSDX)
IF (LPDFSDX) THEN
  !$ACC EXIT DATA DETACH (SELF%PDFSDX)
  !$ACC EXIT DATA DELETE (SELF%PDFSDX)
ENDIF

LAAM_NN = ALLOCATED (SELF%AAM_NN)
IF (LAAM_NN) THEN
  !$ACC EXIT DATA DETACH (SELF%AAM_NN)
  !$ACC EXIT DATA DELETE (SELF%AAM_NN)
ENDIF

LBBM_NN = ALLOCATED (SELF%BBM_NN)
IF (LBBM_NN) THEN
  !$ACC EXIT DATA DETACH (SELF%BBM_NN)
  !$ACC EXIT DATA DELETE (SELF%BBM_NN)
ENDIF

LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$ACC EXIT DATA DELETE (SELF)
ENDIF
END SUBROUTINE

FUNCTION ACDC_SIZE_TENEUR (SELF, CDPATH, LDPRINT) RESULT (KSIZE)

IMPLICIT NONE
TYPE (TENEUR),     INTENT (IN), TARGET :: SELF
CHARACTER(LEN=*), INTENT (IN), OPTIONAL :: CDPATH
LOGICAL,          INTENT (IN), OPTIONAL :: LDPRINT
INTEGER*8 :: KSIZE
INTEGER*8 :: ISIZE, JSIZE
LOGICAL :: LLPRINT
CHARACTER(LEN=128) :: CLPATH
LOGICAL :: LAAM_NN, LBBM_NN, LENTREEMOY, LNBNEUR, LPDFSDX, LRAPIN, LRAPOUT, LSORTIEMOY, LWNELN
LLPRINT = .FALSE.
IF (PRESENT (LDPRINT)) THEN
  LLPRINT = LDPRINT
ENDIF
CLPATH=''
IF (PRESENT (CDPATH)) THEN
  CLPATH = CDPATH
ENDIF
KSIZE = 0
ISIZE = KIND (SELF%NCOU)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NCOU'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NBR)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NBR'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%NBNEURMAX)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%NBNEURMAX'
ENDIF
KSIZE = KSIZE + ISIZE
ISIZE = KIND (SELF%KLEV_NN)
IF (LLPRINT) THEN
  WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
  WRITE (*, *) TRIM (CLPATH)//'%KLEV_NN'
ENDIF
KSIZE = KSIZE + ISIZE
LNBNEUR = ALLOCATED (SELF%NBNEUR)
IF (LNBNEUR) THEN
  ISIZE = KIND (SELF%NBNEUR) * SIZE (SELF%NBNEUR)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%NBNEUR'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LWNELN = ALLOCATED (SELF%WNELN)
IF (LWNELN) THEN
  ISIZE = KIND (SELF%WNELN) * SIZE (SELF%WNELN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%WNELN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LENTREEMOY = ALLOCATED (SELF%ENTREEMOY)
IF (LENTREEMOY) THEN
  ISIZE = KIND (SELF%ENTREEMOY) * SIZE (SELF%ENTREEMOY)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%ENTREEMOY'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRAPIN = ALLOCATED (SELF%RAPIN)
IF (LRAPIN) THEN
  ISIZE = KIND (SELF%RAPIN) * SIZE (SELF%RAPIN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RAPIN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LSORTIEMOY = ALLOCATED (SELF%SORTIEMOY)
IF (LSORTIEMOY) THEN
  ISIZE = KIND (SELF%SORTIEMOY) * SIZE (SELF%SORTIEMOY)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%SORTIEMOY'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LRAPOUT = ALLOCATED (SELF%RAPOUT)
IF (LRAPOUT) THEN
  ISIZE = KIND (SELF%RAPOUT) * SIZE (SELF%RAPOUT)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%RAPOUT'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LPDFSDX = ALLOCATED (SELF%PDFSDX)
IF (LPDFSDX) THEN
  ISIZE = KIND (SELF%PDFSDX) * SIZE (SELF%PDFSDX)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%PDFSDX'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LAAM_NN = ALLOCATED (SELF%AAM_NN)
IF (LAAM_NN) THEN
  ISIZE = KIND (SELF%AAM_NN) * SIZE (SELF%AAM_NN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%AAM_NN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
LBBM_NN = ALLOCATED (SELF%BBM_NN)
IF (LBBM_NN) THEN
  ISIZE = KIND (SELF%BBM_NN) * SIZE (SELF%BBM_NN)
  IF (LLPRINT) THEN
    WRITE (*, '(I10," ")', ADVANCE='NO') ISIZE
    WRITE (*, *) TRIM (CLPATH)//'%BBM_NN'
  ENDIF
  KSIZE = KSIZE + ISIZE
ENDIF
END FUNCTION

END MODULE
