SUBROUTINE GPINISLB_PART2_EXPL_PARALLEL (YDDYN, YDDYNA, YDCPG_BNDS, YDCPG_OPTS, YDVARS)

USE YOMHOOK,ONLY:LHOOK, JPHOOK, DR_HOOK
USE YOMDYN,ONLY:TDYN
USE YOMDYNA,ONLY:TDYNA
USE FIELD_VARIABLES_MOD,ONLY:FIELD_VARIABLES
USE CPG_OPTS_TYPE_MOD,ONLY:CPG_BNDS_TYPE, CPG_OPTS_TYPE
USE FIELD_MODULE
USE FIELD_FACTORY_MODULE
USE FIELD_ACCESS_MODULE
USE FXTRAN_ACDC_PARALLELMETHOD_MOD
USE FXTRAN_ACDC_STACK_MOD
USE PARKIND1
USE FXTRAN_ACDC_ARRAY_COPY_MOD
USE FXTRAN_ACDC_GPUMEM_MOD
#include "fxtran_acdc_stack.h"

IMPLICIT NONE


TYPE (TDYN), INTENT (IN)::YDDYN
TYPE (TDYNA), INTENT (IN)::YDDYNA
TYPE (CPG_BNDS_TYPE), INTENT (IN)::YDCPG_BNDS
TYPE (CPG_OPTS_TYPE), INTENT (IN)::YDCPG_OPTS
TYPE (FIELD_VARIABLES), INTENT (INOUT)::YDVARS
INTEGER (KIND=JPIM)::JLEV
INTEGER (KIND=JPIM)::JROF
INTEGER (KIND=JPIM)::JGFL
REAL (KIND=JPHOOK)::ZHOOK_HANDLE
INTEGER(KIND=JPIM) :: JBLK
TYPE(CPG_BNDS_TYPE) :: YLCPG_BNDS
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_FIELD_API
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_PARALLEL
REAL(KIND=JPHOOK) :: ZHOOK_HANDLE_COMPUTE
TYPE(FXTRAN_ACDC_STACK) :: YLSTACK
TYPE(FXTRAN_ACDC_STACK) :: YLOFFSET
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GFL_PTR_T0(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GFL_PTR_T1(:,:,:)
REAL(KIND=JPRB), POINTER :: Z_YDVARS_GFL_PTR_T9(:,:,:)
#include "abor1.intfb.h"
IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL', 0, ZHOOK_HANDLE)

CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "BEGIN")


IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('CREATE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)

IF (YDDYNA%LSLAG) THEN

  IF (YDDYNA%LTWOTL) THEN

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LADV) THEN
        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0',0,ZHOOK_HANDLE_PARALLEL)

        IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPINISLB_PART2_EXPL_PARALLEL:0')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
          !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            CALL YLCPG_BNDS%UPDATE (JBLK)
            
            Z_YDVARS_GFL_PTR_T1  (:,:, JBLK)=0._JPRB
          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:0')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:0')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

            

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF
              
              Z_YDVARS_GFL_PTR_T1  (JROF,:, JBLK)=0._JPRB
            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:0')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:0')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          
            !$ACC PARALLEL LOOP GANG &
            !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDVARS_GFL_PTR_T1) &
            !$ACC&PRIVATE (JBLK) &
            !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
            
            DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            
            
            
            !$ACC LOOP VECTOR &
            !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF
              
              Z_YDVARS_GFL_PTR_T1  (JROF,:, JBLK)=0._JPRB
            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:0')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSE
            CALL ABOR1 ('GPINISLB_PART2_EXPL_PARALLEL: NOT METHOD WAS FOUND')
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:0',1,ZHOOK_HANDLE_PARALLEL)
      ELSEIF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1',0,ZHOOK_HANDLE_PARALLEL)

        IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPINISLB_PART2_EXPL_PARALLEL:1')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT0)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
          !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            CALL YLCPG_BNDS%UPDATE (JBLK)

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T0  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:1')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT0)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T0 => NULL ()
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:1')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT0)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

            

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF

              

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T0  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:1')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT0)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T0 => NULL ()
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:1')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T0 => GET_DEVICE_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT0)
          Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          
            !$ACC PARALLEL LOOP GANG &
            !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDVARS_GFL_PTR_T0, Z_YDVARS_GFL_PTR_T1) &
            !$ACC&PRIVATE (JBLK) &
            !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
            
            DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            
            
            
            !$ACC LOOP VECTOR &
            !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF

              

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T0  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:1')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T0 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT0)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T0 => NULL ()
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSE
            CALL ABOR1 ('GPINISLB_PART2_EXPL_PARALLEL: NOT METHOD WAS FOUND')
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:1',1,ZHOOK_HANDLE_PARALLEL)
      ENDIF

    ENDDO

  ELSE

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LADV) THEN
        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2',0,ZHOOK_HANDLE_PARALLEL)

        IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPINISLB_PART2_EXPL_PARALLEL:2')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
          !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            CALL YLCPG_BNDS%UPDATE (JBLK)
            
            Z_YDVARS_GFL_PTR_T1  (:,:, JBLK)=0._JPRB
          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:2')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:2')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

            

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF
              
              Z_YDVARS_GFL_PTR_T1  (JROF,:, JBLK)=0._JPRB
            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:2')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:2')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          
            !$ACC PARALLEL LOOP GANG &
            !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDVARS_GFL_PTR_T1) &
            !$ACC&PRIVATE (JBLK) &
            !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
            
            DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            
            
            
            !$ACC LOOP VECTOR &
            !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF
              
              Z_YDVARS_GFL_PTR_T1  (JROF,:, JBLK)=0._JPRB
            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:2')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSE
            CALL ABOR1 ('GPINISLB_PART2_EXPL_PARALLEL: NOT METHOD WAS FOUND')
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:2',1,ZHOOK_HANDLE_PARALLEL)
      ELSEIF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3',0,ZHOOK_HANDLE_PARALLEL)

        IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPINISLB_PART2_EXPL_PARALLEL:3')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
          !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            CALL YLCPG_BNDS%UPDATE (JBLK)

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T9  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:3')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT9)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          Z_YDVARS_GFL_PTR_T9 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:3')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

            

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF

              

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T9  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:3')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT9)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          Z_YDVARS_GFL_PTR_T9 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:3')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          Z_YDVARS_GFL_PTR_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          
            !$ACC PARALLEL LOOP GANG &
            !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDVARS_GFL_PTR_T1, Z_YDVARS_GFL_PTR_T9) &
            !$ACC&PRIVATE (JBLK) &
            !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
            
            DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            
            
            
            !$ACC LOOP VECTOR &
            !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF

              

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T9  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:3')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT9)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          Z_YDVARS_GFL_PTR_T9 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSE
            CALL ABOR1 ('GPINISLB_PART2_EXPL_PARALLEL: NOT METHOD WAS FOUND')
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:3',1,ZHOOK_HANDLE_PARALLEL)
      ENDIF

    ENDDO

  ENDIF

ELSE

  IF (YDDYN%NCURRENT_ITER==0) THEN

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4',0,ZHOOK_HANDLE_PARALLEL)

        IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPINISLB_PART2_EXPL_PARALLEL:4')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
          !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF) FIRSTPRIVATE (YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            CALL YLCPG_BNDS%UPDATE (JBLK)

            

            DO JLEV=1, YDCPG_OPTS%KFLEVG

              DO JROF=YLCPG_BNDS%KIDIA, YLCPG_BNDS%KFDIA
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T9  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:4')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT9)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          Z_YDVARS_GFL_PTR_T9 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:4')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          !$OMP PARALLEL DO PRIVATE (JBLK, JLEV, JROF, YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

            

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF

              

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T9  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:4')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT9)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          Z_YDVARS_GFL_PTR_T9 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:4')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          Z_YDVARS_GFL_PTR_T9 => GET_DEVICE_DATA_RDONLY (YDVARS%GFL_PTR (JGFL)%FT9)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          
            !$ACC PARALLEL LOOP GANG &
            !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDVARS_GFL_PTR_T1, Z_YDVARS_GFL_PTR_T9) &
            !$ACC&PRIVATE (JBLK) &
            !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
            
            DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            
            
            
            !$ACC LOOP VECTOR &
            !$ACC&PRIVATE (JLEV, JROF, YLCPG_BNDS) 

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF

              

              DO JLEV=1, YDCPG_OPTS%KFLEVG
                
                Z_YDVARS_GFL_PTR_T1  (JROF, JLEV, JBLK)=Z_YDVARS_GFL_PTR_T9  (JROF, JLEV, JBLK)*YDCPG_OPTS%ZTE
              
              ENDDO

            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:4')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            Z_YDVARS_GFL_PTR_T9 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT9)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          Z_YDVARS_GFL_PTR_T9 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSE
            CALL ABOR1 ('GPINISLB_PART2_EXPL_PARALLEL: NOT METHOD WAS FOUND')
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:4',1,ZHOOK_HANDLE_PARALLEL)
      ENDIF

    ENDDO

  ELSE

    DO JGFL=1, SIZE (YDVARS%GFL_PTR)

      IF (YDVARS%GFL_PTR (JGFL)%LT1) THEN
        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5',0,ZHOOK_HANDLE_PARALLEL)

        IF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMP','GPINISLB_PART2_EXPL_PARALLEL:5')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          CALL YLCPG_BNDS%INIT (YDCPG_OPTS)
          !$OMP PARALLEL DO PRIVATE (JBLK) FIRSTPRIVATE (YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            CALL YLCPG_BNDS%UPDATE (JBLK)
            
            Z_YDVARS_GFL_PTR_T1  (:,:, JBLK)=0._JPRB
          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:5')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENMPSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:5')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          !$OMP PARALLEL DO PRIVATE (JBLK, JROF, YLCPG_BNDS)

          DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX

            

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF
              
              Z_YDVARS_GFL_PTR_T1  (JROF,:, JBLK)=0._JPRB
            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:5')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSEIF (FXTRAN_ACDC_LPARALLELMETHOD ('OPENACCSINGLECOLUMN','GPINISLB_PART2_EXPL_PARALLEL:5')) THEN
          
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:GET_DATA',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => GET_DEVICE_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:GET_DATA',1,ZHOOK_HANDLE_FIELD_API)
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:COMPUTE',0,ZHOOK_HANDLE_COMPUTE)
          
          
            !$ACC PARALLEL LOOP GANG &
            !$ACC&PRESENT (YDCPG_OPTS, YFXTRAN_ACDC_STACK, Z_YDVARS_GFL_PTR_T1) &
            !$ACC&PRIVATE (JBLK) &
            !$ACC&VECTOR_LENGTH (YDCPG_OPTS%KLON) 
            
            DO JBLK = YDCPG_OPTS%JBLKMIN, YDCPG_OPTS%JBLKMAX
            
            
            
            !$ACC LOOP VECTOR &
            !$ACC&PRIVATE (JROF, YLCPG_BNDS) 

            

            DO JROF = 1, MIN (YDCPG_OPTS%KLON, YDCPG_OPTS%KGPCOMP - (JBLK - 1) * YDCPG_OPTS%KLON)
              YLCPG_BNDS%KIDIA = JROF
              YLCPG_BNDS%KFDIA = JROF
              
              Z_YDVARS_GFL_PTR_T1  (JROF,:, JBLK)=0._JPRB
            ENDDO

          ENDDO

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:COMPUTE',1,ZHOOK_HANDLE_COMPUTE)

          IF (FXTRAN_ACDC_LSYNCHOST ('GPINISLB_PART2_EXPL_PARALLEL:5')) THEN
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:SYNCHOST',0,ZHOOK_HANDLE_FIELD_API)
            Z_YDVARS_GFL_PTR_T1 => GET_HOST_DATA_RDWR (YDVARS%GFL_PTR (JGFL)%FT1)
            IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:SYNCHOST',1,ZHOOK_HANDLE_FIELD_API)
            
            
          ENDIF

          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:NULLIFY',0,ZHOOK_HANDLE_FIELD_API)
          Z_YDVARS_GFL_PTR_T1 => NULL ()
          IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5:NULLIFY',1,ZHOOK_HANDLE_FIELD_API)
          
          
        ELSE
            CALL ABOR1 ('GPINISLB_PART2_EXPL_PARALLEL: NOT METHOD WAS FOUND')
        ENDIF

        IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL:5',1,ZHOOK_HANDLE_PARALLEL)
      ENDIF

    ENDDO

  ENDIF

ENDIF


CALL FXTRAN_ACDC_GPUMEMSTAT (__FILE__, __LINE__, "END")

IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',0,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('DELETE_TEMPORARIES',1,ZHOOK_HANDLE_FIELD_API)
IF (LHOOK) CALL DR_HOOK ('GPINISLB_PART2_EXPL_PARALLEL', 1, ZHOOK_HANDLE)
END SUBROUTINE GPINISLB_PART2_EXPL_PARALLEL
